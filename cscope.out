cscope 15 $HOME/programming/mia_vita/USB_Wifi_RT2501_TS-7500/sources/Module               0001597735
	@assoc.c

37 
	~"π_c⁄fig.h
"

38 
	~<√t/iw_h™dÀr.h
>

40 
UCHAR
 
	gCùhîW∑Tem∂©e
[] = {

51 
UCHAR
 
	gCùhîW∑2Tem∂©e
[] = {

62 
UCHAR
 
	gCùhîW∑2Tem∂©eLí
 = ((
CùhîW∑2Tem∂©e
) / (UCHAR));

88 
VOID
 
	$AssocSèãMachöeInô
(

89 
IN
 
PRTMP_ADAPTER
 
pAd
,

90 
IN
 
STATE_MACHINE
 *
S
,

91 
OUT
 
STATE_MACHINE_FUNC
 
Tøns
[])

93 
	`SèãMachöeInô
(
S
, (
STATE_MACHINE_FUNC
*)
Tøns
, 
MAX_ASSOC_STATE
, 
MAX_ASSOC_MSG
, (STATE_MACHINE_FUNC)
Dr›
, 
ASSOC_IDLE
, 
ASSOC_MACHINE_BASE
);

96 
	`SèãMachöeSëA˘i⁄
(
S
, 
ASSOC_IDLE
, 
MT2_MLME_ASSOC_REQ
, (
STATE_MACHINE_FUNC
)
MlmeAssocReqA˘i⁄
);

97 
	`SèãMachöeSëA˘i⁄
(
S
, 
ASSOC_IDLE
, 
MT2_MLME_REASSOC_REQ
, (
STATE_MACHINE_FUNC
)
MlmeRóssocReqA˘i⁄
);

98 
	`SèãMachöeSëA˘i⁄
(
S
, 
ASSOC_IDLE
, 
MT2_MLME_DISASSOC_REQ
, (
STATE_MACHINE_FUNC
)
MlmeDißssocReqA˘i⁄
);

99 
	`SèãMachöeSëA˘i⁄
(
S
, 
ASSOC_IDLE
, 
MT2_PEER_DISASSOC_REQ
, (
STATE_MACHINE_FUNC
)
PìrDißssocA˘i⁄
);

102 
	`SèãMachöeSëA˘i⁄
(
S
, 
ASSOC_WAIT_RSP
, 
MT2_MLME_ASSOC_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíAssoc
);

103 
	`SèãMachöeSëA˘i⁄
(
S
, 
ASSOC_WAIT_RSP
, 
MT2_MLME_REASSOC_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíRóssoc
);

104 
	`SèãMachöeSëA˘i⁄
(
S
, 
ASSOC_WAIT_RSP
, 
MT2_MLME_DISASSOC_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíDißssocüã
);

105 
	`SèãMachöeSëA˘i⁄
(
S
, 
ASSOC_WAIT_RSP
, 
MT2_PEER_DISASSOC_REQ
, (
STATE_MACHINE_FUNC
)
PìrDißssocA˘i⁄
);

106 
	`SèãMachöeSëA˘i⁄
(
S
, 
ASSOC_WAIT_RSP
, 
MT2_PEER_ASSOC_RSP
, (
STATE_MACHINE_FUNC
)
PìrAssocR•A˘i⁄
);

107 
	`SèãMachöeSëA˘i⁄
(
S
, 
ASSOC_WAIT_RSP
, 
MT2_ASSOC_TIMEOUT
, (
STATE_MACHINE_FUNC
)
AssocTimeoutA˘i⁄
);

110 
	`SèãMachöeSëA˘i⁄
(
S
, 
REASSOC_WAIT_RSP
, 
MT2_MLME_ASSOC_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíAssoc
);

111 
	`SèãMachöeSëA˘i⁄
(
S
, 
REASSOC_WAIT_RSP
, 
MT2_MLME_REASSOC_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíRóssoc
);

112 
	`SèãMachöeSëA˘i⁄
(
S
, 
REASSOC_WAIT_RSP
, 
MT2_MLME_DISASSOC_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíDißssocüã
);

113 
	`SèãMachöeSëA˘i⁄
(
S
, 
REASSOC_WAIT_RSP
, 
MT2_PEER_DISASSOC_REQ
, (
STATE_MACHINE_FUNC
)
PìrDißssocA˘i⁄
);

114 
	`SèãMachöeSëA˘i⁄
(
S
, 
REASSOC_WAIT_RSP
, 
MT2_PEER_REASSOC_RSP
, (
STATE_MACHINE_FUNC
)
PìrRóssocR•A˘i⁄
);

115 
	`SèãMachöeSëA˘i⁄
(
S
, 
REASSOC_WAIT_RSP
, 
MT2_REASSOC_TIMEOUT
, (
STATE_MACHINE_FUNC
)
RóssocTimeoutA˘i⁄
);

118 
	`SèãMachöeSëA˘i⁄
(
S
, 
DISASSOC_WAIT_RSP
, 
MT2_MLME_ASSOC_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíAssoc
);

119 
	`SèãMachöeSëA˘i⁄
(
S
, 
DISASSOC_WAIT_RSP
, 
MT2_MLME_REASSOC_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíRóssoc
);

120 
	`SèãMachöeSëA˘i⁄
(
S
, 
DISASSOC_WAIT_RSP
, 
MT2_MLME_DISASSOC_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíDißssocüã
);

121 
	`SèãMachöeSëA˘i⁄
(
S
, 
DISASSOC_WAIT_RSP
, 
MT2_PEER_DISASSOC_REQ
, (
STATE_MACHINE_FUNC
)
PìrDißssocA˘i⁄
);

122 
	`SèãMachöeSëA˘i⁄
(
S
, 
DISASSOC_WAIT_RSP
, 
MT2_DISASSOC_TIMEOUT
, (
STATE_MACHINE_FUNC
)
DißssocTimeoutA˘i⁄
);

125 
	`RTMPInôTimî
(
pAd
, &pAd->
MlmeAux
.
AssocTimî
, 
	`GET_TIMER_FUNCTION
(
AssocTimeout
),ÖAd, 
FALSE
);

126 
	`RTMPInôTimî
(
pAd
, &pAd->
MlmeAux
.
RóssocTimî
, 
	`GET_TIMER_FUNCTION
(
RóssocTimeout
),ÖAd, 
FALSE
);

127 
	`RTMPInôTimî
(
pAd
, &pAd->
MlmeAux
.
DißssocTimî
, 
	`GET_TIMER_FUNCTION
(
DißssocTimeout
),ÖAd, 
FALSE
);

129 
	}
}

140 
VOID
 
	$AssocTimeout
(

141 
IN
 
PVOID
 
Sy°emS≥cific1
,

142 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

143 
IN
 
PVOID
 
Sy°emS≥cific2
,

144 
IN
 
PVOID
 
Sy°emS≥cific3
)

146 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
Fun˘i⁄C⁄ãxt
;

147 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"ASSOC -Énqueue MT2_ASSOC_TIMEOUT \n");

148 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_ASSOC_TIMEOUT
, 0, 
NULL
);

149 
	`RTUSBMlmeUp
(
pAd
);

150 
	}
}

161 
VOID
 
	$RóssocTimeout
(

162 
IN
 
PVOID
 
Sy°emS≥cific1
,

163 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

164 
IN
 
PVOID
 
Sy°emS≥cific2
,

165 
IN
 
PVOID
 
Sy°emS≥cific3
)

167 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
Fun˘i⁄C⁄ãxt
;

168 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"ASSOC -Énqueue MT2_REASSOC_TIMEOUT \n");

169 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_REASSOC_TIMEOUT
, 0, 
NULL
);

170 
	`RTUSBMlmeUp
(
pAd
);

171 
	}
}

182 
VOID
 
	$DißssocTimeout
(

183 
IN
 
PVOID
 
Sy°emS≥cific1
,

184 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

185 
IN
 
PVOID
 
Sy°emS≥cific2
,

186 
IN
 
PVOID
 
Sy°emS≥cific3
)

188 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
Fun˘i⁄C⁄ãxt
;

189 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"ASSOC -Énqueue MT2_DISASSOC_TIMEOUT \n");

190 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_DISASSOC_TIMEOUT
, 0, 
NULL
);

191 
	`RTUSBMlmeUp
(
pAd
);

192 
	}
}

215 
VOID
 
	$MlmeAssocReqA˘i⁄
(

216 
IN
 
PRTMP_ADAPTER
 
pAd
,

217 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

219 
UCHAR
 
ApAddr
[6];

220 
HEADER_802_11
 
AssocHdr
;

221 
UCHAR
 
WmeIe
[9] = {
IE_VENDOR_SPECIFIC
, 0x07, 0x00, 0x50, 0xf2, 0x02, 0x00, 0x01, 
STA_QOS_CAPABILITY
};

222 
UCHAR
 
CùhîTmp
[64];

223 
UCHAR
 
CùhîTmpLí
;

224 
USHORT
 
Li°íI¡v
;

225 
ULONG
 
Timeout
;

226 
USHORT
 
C≠abûôyInfo
;

227 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

228 
ULONG
 
FømeLí
 = 0;

229 
ULONG
 
tmp
;

230 
UCHAR
 
V¨IesOff£t
;

231 
USHORT
 
Sètus
;

232 
ULONG
 
idx
;

233 
BOOLEAN
 
FoundPMK
 = 
FALSE
;

234 
USHORT
 
NSètus
;

235 
BOOLEAN
 
TimîC™˚Œed
;

238 i‡(
pAd
->
P‹tCfg
.
bBlockAssoc
 =
TRUE
)

240 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - Block AssocÑequest durning WPA blockÖeriod!\n");

241 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

242 
Sètus
 = 
MLME_STATE_MACHINE_REJECT
;

243 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_ASSOC_CONF
, 2, &
Sètus
);

246 i‡(
	`MlmeAssocReqS™ôy
(
pAd
, 
EÀm
->
Msg
, EÀm->
MsgLí
, 
ApAddr
, &
C≠abûôyInfo
, &
Timeout
, &
Li°íI¡v
))

248 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
AssocTimî
,&
TimîC™˚Œed
);

250 
	`COPY_MAC_ADDR
(
pAd
->
MlmeAux
.
Bssid
, 
ApAddr
);

253 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

254 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

256 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"ASSOC - MlmeAssocReqAction()állocate memory failed \n");

257 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

258 
Sètus
 = 
MLME_FAIL_NO_RESOURCE
;

259 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_ASSOC_CONF
, 2, &
Sètus
);

264 
pAd
->
P‹tCfg
.
AssocInfo
.
Lígth
 = (
NDIS_802_11_ASSOCIATION_INFORMATION
);

266 
pAd
->
P‹tCfg
.
AssocInfo
.
AvaûabÀReque°FixedIEs
 =

267 
NDIS_802_11_AI_REQFI_CAPABILITIES
 | 
NDIS_802_11_AI_REQFI_LISTENINTERVAL
;

268 
pAd
->
P‹tCfg
.
AssocInfo
.
Reque°FixedIEs
.
C≠abûôõs
 = 
C≠abûôyInfo
;

269 
pAd
->
P‹tCfg
.
AssocInfo
.
Reque°FixedIEs
.
Li°íI¡îvÆ
 = 
Li°íI¡v
;

272 
pAd
->
P‹tCfg
.
AssocInfo
.
Off£tReque°IEs
 = (
NDIS_802_11_ASSOCIATION_INFORMATION
);

275 
V¨IesOff£t
 = 0;

276 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
ReqV¨IEs
 + 
V¨IesOff£t
, &
SsidIe
, 1);

277 
V¨IesOff£t
 += 1;

278 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
ReqV¨IEs
 + 
V¨IesOff£t
, &pAd->
MlmeAux
.
SsidLí
, 1);

279 
V¨IesOff£t
 += 1;

280 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
ReqV¨IEs
 + 
V¨IesOff£t
,ÖAd->
MlmeAux
.
Ssid
,ÖAd->MlmeAux.
SsidLí
);

281 
V¨IesOff£t
 +
pAd
->
MlmeAux
.
SsidLí
;

284 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
ReqV¨IEs
 + 
V¨IesOff£t
, &
SupR©eIe
, 1);

285 
V¨IesOff£t
 += 1;

286 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
ReqV¨IEs
 + 
V¨IesOff£t
, &pAd->
MlmeAux
.
SupR©eLí
, 1);

287 
V¨IesOff£t
 += 1;

288 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
ReqV¨IEs
 + 
V¨IesOff£t
,ÖAd->
MlmeAux
.
SupR©e
,ÖAd->MlmeAux.
SupR©eLí
);

289 
V¨IesOff£t
 +
pAd
->
MlmeAux
.
SupR©eLí
;

292 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - Send ASSOCÑequest...\n");

293 
	`MgtMacHódîInô
(
pAd
, &
AssocHdr
, 
SUBTYPE_ASSOC_REQ
, 0, 
ApAddr
, ApAddr);

296 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

297 (
HEADER_802_11
), &
AssocHdr
,

298 2, &
C≠abûôyInfo
,

299 2, &
Li°íI¡v
,

300 1, &
SsidIe
,

301 1, &
pAd
->
MlmeAux
.
SsidLí
,

302 
pAd
->
MlmeAux
.
SsidLí
,ÖAd->MlmeAux.
Ssid
,

303 1, &
SupR©eIe
,

304 1, &
pAd
->
MlmeAux
.
SupR©eLí
,

305 
pAd
->
MlmeAux
.
SupR©eLí
,ÖAd->MlmeAux.
SupR©e
,

306 
END_OF_ARGS
);

308 i‡(
pAd
->
MlmeAux
.
ExtR©eLí
 != 0)

310 
	`MakeOutgoögFøme
(
pOutBuf„r
 + 
FømeLí
, &
tmp
,

311 1, &
ExtR©eIe
,

312 1, &
pAd
->
MlmeAux
.
ExtR©eLí
,

313 
pAd
->
MlmeAux
.
ExtR©eLí
,ÖAd->MlmeAux.
ExtR©e
,

314 
END_OF_ARGS
);

315 
FømeLí
 +
tmp
;

318 i‡(
pAd
->
MlmeAux
.
APEdˇP¨m
.
bVÆid
)

320 
WmeIe
[8] |(
pAd
->
MlmeAux
.
APEdˇP¨m
.
EdˇUpd©eCou¡
 & 0x0f);

321 
	`MakeOutgoögFøme
(
pOutBuf„r
 + 
FømeLí
, &
tmp
,

322 9, &
WmeIe
[0],

323 
END_OF_ARGS
);

324 
FømeLí
 +
tmp
;

329 i‡((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA
) ||

330 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAPSK
))

333 
CùhîTmpLí
 = (
CùhîW∑Tem∂©e
);

334 
	`NdisMoveMem‹y
(
CùhîTmp
, 
CùhîW∑Tem∂©e
, 
CùhîTmpLí
);

336 
CùhîTmp
[11] = ((
pAd
->
P‹tCfg
.
GroupCùhî
 =
Ndis802_11En¸y±i⁄2E«bÀd
) ? 0x2 : 0x4);

338 
CùhîTmp
[17] = ((
pAd
->
P‹tCfg
.
PaúCùhî
 =
Ndis802_11En¸y±i⁄2E«bÀd
) ? 0x2 : 0x4);

340 
CùhîTmp
[23] = ((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA
) ? 0x1 : 0x2);

342 
	`MakeOutgoögFøme
(
pOutBuf„r
 + 
FømeLí
, &
tmp
,

343 
CùhîTmpLí
, &
CùhîTmp
[0],

344 
END_OF_ARGS
);

345 
FømeLí
 +
tmp
;

348 
	`¥ötk
("%s(): WPA/WPAPSK, Fû»thêReqV¨IE†wôh CùhîTmp!\n", 
__FUNCTION__
);

349 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
ReqV¨IEs
 + 
V¨IesOff£t
, 
CùhîTmp
, 
CùhîTmpLí
);

350 
V¨IesOff£t
 +
CùhîTmpLí
;

353 
pAd
->
P‹tCfg
.
ReqV¨IELí
 = 
V¨IesOff£t
;

354 
pAd
->
P‹tCfg
.
AssocInfo
.
Reque°IELígth
 = 
V¨IesOff£t
;

356 
pAd
->
P‹tCfg
.
AssocInfo
.
Off£tRe•⁄£IEs
 = (
NDIS_802_11_ASSOCIATION_INFORMATION
Ë+ÖAd->P‹tCfg.
ReqV¨IELí
;

359 i‡((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2
) ||

360 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2PSK
))

363 
CùhîTmpLí
 = (
CùhîW∑2Tem∂©e
);

364 
	`NdisMoveMem‹y
(
CùhîTmp
, 
CùhîW∑2Tem∂©e
, 
CùhîTmpLí
);

366 
CùhîTmp
[7] = ((
pAd
->
P‹tCfg
.
GroupCùhî
 =
Ndis802_11En¸y±i⁄2E«bÀd
) ? 0x2 : 0x4);

368 
CùhîTmp
[13] = ((
pAd
->
P‹tCfg
.
PaúCùhî
 =
Ndis802_11En¸y±i⁄2E«bÀd
) ? 0x2 : 0x4);

370 
CùhîTmp
[19] = ((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2
) ? 0x1 : 0x2);

372 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2
)

375 
idx
 = 0; idx < 
PMKID_NO
; idx++)

377 i‡(
	`NdisEquÆMem‹y
(
ApAddr
, &
pAd
->
P‹tCfg
.
SavedPMK
[
idx
].
BSSID
, 6))

379 
FoundPMK
 = 
TRUE
;

384 i‡(
FoundPMK
)

387 
CùhîTmp
[1] += 18;

389 *(
PUSHORT
Ë&
CùhîTmp
[
CùhîTmpLí
] = 1;

390 
	`NdisMoveMem‹y
(&
CùhîTmp
[
CùhîTmpLí
 + 2], &
pAd
->
P‹tCfg
.
SavedPMK
[
idx
].
PMKID
, 16);

391 
CùhîTmpLí
 += 18;

396 
	`MakeOutgoögFøme
(
pOutBuf„r
 + 
FømeLí
, &
tmp
,

397 
CùhîTmpLí
, &
CùhîTmp
[0],

398 
END_OF_ARGS
);

399 
FømeLí
 +
tmp
;

402 
	`¥ötk
("%s(): WPA2/WPA2PSK fû»thêReqV¨IE†wôh CùhîTmp!\n", 
__FUNCTION__
);

403 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
ReqV¨IEs
 + 
V¨IesOff£t
, 
CùhîTmp
, 
CùhîTmpLí
);

404 
V¨IesOff£t
 +
CùhîTmpLí
;

407 
pAd
->
P‹tCfg
.
ReqV¨IELí
 = 
V¨IesOff£t
;

408 
pAd
->
P‹tCfg
.
AssocInfo
.
Reque°IELígth
 = 
V¨IesOff£t
;

410 
pAd
->
P‹tCfg
.
AssocInfo
.
Off£tRe•⁄£IEs
 = (
NDIS_802_11_ASSOCIATION_INFORMATION
Ë+ÖAd->P‹tCfg.
ReqV¨IELí
;

421 i‡(
pAd
->
P‹tCfg
.
bAggªg©i⁄C≠abÀ
 && (pAd->
MlmeAux
.
APRÆökIe
 & 0x00000001))

423 
ULONG
 
TmpLí
;

424 
UCHAR
 
RÆökIe
[9] = {
IE_VENDOR_SPECIFIC
, 7, 0x00, 0x0c, 0x43, 0x01, 0x00, 0x00, 0x00};

425 
	`MakeOutgoögFøme
(
pOutBuf„r
+
FømeLí
, &
TmpLí
,

426 9, 
RÆökIe
,

427 
END_OF_ARGS
);

428 
FømeLí
 +
TmpLí
;

432 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

435 
	`RTMPSëTimî
(&
pAd
->
MlmeAux
.
AssocTimî
, 
Timeout
);

437 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_WAIT_RSP
;

441 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"ASSOC - MlmeAssocReqAction() sanity check failed. BUG!!!!!! \n");

442 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

443 
Sètus
 = 
MLME_INVALID_FORMAT
;

444 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_ASSOC_CONF
, 2, &
Sètus
);

447 
	}
}

464 
VOID
 
	$MlmeRóssocReqA˘i⁄
(

465 
IN
 
PRTMP_ADAPTER
 
pAd
,

466 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

468 
UCHAR
 
ApAddr
[6];

469 
HEADER_802_11
 
RóssocHdr
;

470 
UCHAR
 
WmeIe
[9] = {
IE_VENDOR_SPECIFIC
, 0x07, 0x00, 0x50, 0xf2, 0x02, 0x00, 0x01, 
STA_QOS_CAPABILITY
};

471 
USHORT
 
C≠abûôyInfo
, 
Li°íI¡v
;

472 
ULONG
 
Timeout
;

473 
ULONG
 
FømeLí
 = 0;

474 
ULONG
 
tmp
;

475 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

476 
USHORT
 
Sètus
;

477 
USHORT
 
NSètus
;

478 
BOOLEAN
 
TimîC™˚Œed
;

481 i‡(
pAd
->
P‹tCfg
.
bBlockAssoc
 =
TRUE
)

483 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - Block ReAssocÑequest durning WPA blockÖeriod!\n");

484 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

485 
Sètus
 = 
MLME_STATE_MACHINE_REJECT
;

486 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_REASSOC_CONF
, 2, &
Sètus
);

489 if(
	`MlmeAssocReqS™ôy
(
pAd
, 
EÀm
->
Msg
, EÀm->
MsgLí
, 
ApAddr
, &
C≠abûôyInfo
, &
Timeout
, &
Li°íI¡v
))

491 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
RóssocTimî
,&
TimîC™˚Œed
);

494 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

495 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

497 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"ASSOC - MlmeReassocReqAction()állocate memory failed \n");

498 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

499 
Sètus
 = 
MLME_FAIL_NO_RESOURCE
;

500 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_REASSOC_CONF
, 2, &
Sètus
);

504 
	`COPY_MAC_ADDR
(
pAd
->
MlmeAux
.
Bssid
, 
ApAddr
);

507 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - Send RE-ASSOCÑequest...\n");

508 
	`MgtMacHódîInô
(
pAd
, &
RóssocHdr
, 
SUBTYPE_REASSOC_REQ
, 0, 
ApAddr
, ApAddr);

509 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

510 (
HEADER_802_11
), &
RóssocHdr
,

511 2, &
C≠abûôyInfo
,

512 2, &
Li°íI¡v
,

513 
MAC_ADDR_LEN
, 
ApAddr
,

514 1, &
SsidIe
,

515 1, &
pAd
->
MlmeAux
.
SsidLí
,

516 
pAd
->
MlmeAux
.
SsidLí
,ÖAd->MlmeAux.
Ssid
,

517 1, &
SupR©eIe
,

518 1, &
pAd
->
MlmeAux
.
SupR©eLí
,

519 
pAd
->
MlmeAux
.
SupR©eLí
,ÖAd->MlmeAux.
SupR©e
,

520 
END_OF_ARGS
);

522 i‡(
pAd
->
MlmeAux
.
ExtR©eLí
 != 0)

524 
	`MakeOutgoögFøme
(
pOutBuf„r
 + 
FømeLí
, &
tmp
,

525 1, &
ExtR©eIe
,

526 1, &
pAd
->
MlmeAux
.
ExtR©eLí
,

527 
pAd
->
MlmeAux
.
ExtR©eLí
,ÖAd->MlmeAux.
ExtR©e
,

528 
END_OF_ARGS
);

529 
FømeLí
 +
tmp
;

532 i‡(
pAd
->
MlmeAux
.
APEdˇP¨m
.
bVÆid
)

534 
WmeIe
[8] |(
pAd
->
MlmeAux
.
APEdˇP¨m
.
EdˇUpd©eCou¡
 & 0x0f);

535 
	`MakeOutgoögFøme
(
pOutBuf„r
 + 
FømeLí
, &
tmp
,

536 9, &
WmeIe
[0],

537 
END_OF_ARGS
);

538 
FømeLí
 +
tmp
;

544 i‡(
pAd
->
P‹tCfg
.
bAggªg©i⁄C≠abÀ
 && (pAd->
MlmeAux
.
APRÆökIe
 & 0x00000001))

546 
ULONG
 
TmpLí
;

547 
UCHAR
 
RÆökIe
[9] = {
IE_VENDOR_SPECIFIC
, 7, 0x00, 0x0c, 0x43, 0x01, 0x00, 0x00, 0x00};

548 
	`MakeOutgoögFøme
(
pOutBuf„r
+
FømeLí
, &
TmpLí
,

549 9, 
RÆökIe
,

550 
END_OF_ARGS
);

551 
FømeLí
 +
TmpLí
;

554 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

556 
	`RTMPSëTimî
(&
pAd
->
MlmeAux
.
RóssocTimî
, 
Timeout
);

557 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
REASSOC_WAIT_RSP
;

561 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"ASSOC - MlmeReassocReqAction() sanity check failed. BUG!!!! \n");

562 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

563 
Sètus
 = 
MLME_INVALID_FORMAT
;

564 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_REASSOC_CONF
, 2, &
Sètus
);

566 
	}
}

576 
VOID
 
	$MlmeDißssocReqA˘i⁄
(

577 
IN
 
PRTMP_ADAPTER
 
pAd
,

578 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

580 
PMLME_DISASSOC_REQ_STRUCT
 
pDißssocReq
;

581 
HEADER_802_11
 
DißssocHdr
;

582 
PCHAR
 
pOutBuf„r
 = 
NULL
;

583 
ULONG
 
FømeLí
 = 0;

584 
ULONG
 
Timeout
 = 0;

585 
USHORT
 
Sètus
;

586 
USHORT
 
NSètus
;

587 
BOOLEAN
 
TimîC™˚Œed
;

588 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


589 
iwªq_d©a
 
wrqu
;

593 
pDißssocReq
 = (
PMLME_DISASSOC_REQ_STRUCT
)(
EÀm
->
Msg
);

596 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

597 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

599 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - MlmeDisassocReqAction()állocate memory failed\n");

600 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

601 
Sètus
 = 
MLME_FAIL_NO_RESOURCE
;

602 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_DISASSOC_CONF
, 2, &
Sètus
);

606 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
DißssocTimî
,&
TimîC™˚Œed
);

608 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - Send DISASSOCÑequest\n");

609 
	`MgtMacHódîInô
(
pAd
, &
DißssocHdr
, 
SUBTYPE_DISASSOC
, 0, 
pDißssocReq
->
Addr
,ÖDisassocReq->Addr);

610 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

611 (
HEADER_802_11
),&
DißssocHdr
,

612 2, &
pDißssocReq
->
Rós⁄
,

613 
END_OF_ARGS
);

614 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

624 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


625 i‡(
pAd
->
P‹tCfg
.
WPA_Suµliˇ¡
 =
TRUE
) {

627 
	`mem£t
(&
wrqu
, 0, (wrqu));

628 
wrqu
.
d©a
.
Êags
 = 
RT_DISASSOC_EVENT_FLAG
;

629 
	`wúñess_£nd_evít
(
pAd
->
√t_dev
, 
IWEVCUSTOM
, &
wrqu
, 
NULL
);

633 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


634 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

635 
	`wext_nŸify_evít_assoc
(
pAd
, 
SIOCGIWAP
, 
FALSE
);

638 
pAd
->
P‹tCfg
.
DißssocRós⁄
 = 
REASON_DISASSOC_STA_LEAVING
;

639 
	`COPY_MAC_ADDR
(
pAd
->
P‹tCfg
.
DißssocSè
, 
pDißssocReq
->
Addr
);

641 
	`RTMPSëTimî
(&
pAd
->
MlmeAux
.
DißssocTimî
, 
Timeout
);

643 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
DISASSOC_WAIT_RSP
;

644 
	}
}

646 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


647 #ifde‡
DBG


648 
	$_πmp_hexdump
(
Àvñ
, c⁄° *
tôÀ
, c⁄° 
u8
 *
buf
,

649 
size_t
 
Àn
, 
show
)

651 
size_t
 
i
;

652 i‡(
Àvñ
 < 
RTDebugLevñ
)

654 
	`¥ötk
("%†- hexdump÷í=%lu):", 
tôÀ
, (Ë
Àn
);

655 i‡(
show
) {

656 
i
 = 0; i < 
Àn
; i++)

657 
	`¥ötk
(" %02x", 
buf
[
i
]);

659 
	`¥ötk
(" [REMOVED]");

661 
	`¥ötk
("\n");

662 
	}
}

664 
	$πmp_hexdump
(
Àvñ
, c⁄° *
tôÀ
, c⁄° 
u8
 *
buf
, 
size_t
 
Àn
)

666 
	`_πmp_hexdump
(
Àvñ
, 
tôÀ
, 
buf
, 
Àn
, 1);

667 
	}
}

670 
NDIS_STATUS
 
	$möù‹t_quîy_öfo
(

671 
IN
 
PRTMP_ADAPTER
 
pAd
,

672 
IN
 
USHORT
 
oid
,

673 
OUT
 *
buf
,

674 
OUT
 
ULONG
 
bufsize
)

677 
	`NdisMoveMem‹y
(
buf
, &
pAd
->
P‹tCfg
.
AssocInfo
, (
NDIS_802_11_ASSOCIATION_INFORMATION
));

679 
	`NdisMoveMem‹y
(
buf
 + (
NDIS_802_11_ASSOCIATION_INFORMATION
), 
pAd
->
P‹tCfg
.
ReqV¨IEs
,ÖAd->P‹tCfg.
ReqV¨IELí
);

681 
	`NdisMoveMem‹y
(
buf
 + (
NDIS_802_11_ASSOCIATION_INFORMATION
Ë+ 
pAd
->
P‹tCfg
.
ReqV¨IELí
,ÖAd->P‹tCfg.
ResV¨IEs
,ÖAd->P‹tCfg.
ResV¨IELí
);

684 
	}
}

686 
VOID
 
	$lök_°©us_h™dÀr
(

687 
IN
 
PRTMP_ADAPTER
 
pAd
)

689 
NDIS_802_11_ASSOCIATION_INFORMATION
 *
ndis_assoc_öfo
;

691 *
w∑_assoc_öfo_ªq
, *
w∑_assoc_öfo_ª•
, *
õs
;

692 *
p
;

693 
i
;

694 *
assoc_öfo
;

695 
iwªq_d©a
 
wrqu
;

696 
NDIS_STATUS
 
ªs
;

698 c⁄° 
assoc_size
 = (*
ndis_assoc_öfo
Ë+ 
IW_CUSTOM_MAX
;

699 
assoc_öfo
 = 
	`kmÆloc
(
assoc_size
, 
MEM_ALLOC_FLAG
);

701 i‡(!
assoc_öfo
)

703 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "couldn'tállocate memory\n");

707 
	`mem£t
(
assoc_öfo
, 0, 
assoc_size
);

708 
ndis_assoc_öfo
 = (
NDIS_802_11_ASSOCIATION_INFORMATION
 *)
assoc_öfo
;

710 
ªs
 = 
	`möù‹t_quîy_öfo
(
pAd
, 
OID_802_11_ASSOCIATION_INFORMATION
,

711 
assoc_öfo
, 
assoc_size
);

712 i‡(
ªs
)

714 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "queryássoc_info failed\n");

715 
	`k‰ì
(
assoc_öfo
);

726 #ifde‡
DBG


727 
	`πmp_hexdump
(
RT_DEBUG_TRACE
, "ASSOCINFO", (c⁄° 
u8
 *Ë
ndis_assoc_öfo
,

728 (
NDIS_802_11_ASSOCIATION_INFORMATION
));

731 
w∑_assoc_öfo_ªq
 = 
	`kmÆloc
(
IW_CUSTOM_MAX
, 
MEM_ALLOC_FLAG
);

733 i‡(!
w∑_assoc_öfo_ªq
)

735 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "couldn'tállocate memory\n");

740 
	`mem£t
(
w∑_assoc_öfo_ªq
, 0, 
IW_CUSTOM_MAX
);

741 
p
 = 
w∑_assoc_öfo_ªq
;

742 
p
 +
	`•rötf
(p, "ASSOCINFO_ReqIEs=");

743 
õs
 = ((*)
ndis_assoc_öfo
) +

744 
ndis_assoc_öfo
->
Off£tReque°IEs
;

746 
i
 = 0; i < 
ndis_assoc_öfo
->
Reque°IELígth
; i++)

747 
p
 +
	`•rötf
’, "%c", 
õs
[
i
]);

749 
p
 +
	`•rötf
(p, "\0");

750 
	`mem£t
(&
wrqu
, 0, (wrqu));

751 
wrqu
.
d©a
.
Àngth
 = 
p
 - 
w∑_assoc_öfo_ªq
;

752 
wrqu
.
d©a
.
Êags
 = 
RT_REQIE_EVENT_FLAG
;

753 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "addög %d byãs\n", 
wrqu
.
d©a
.
Àngth
);

754 
	`wúñess_£nd_evít
(
pAd
->
√t_dev
, 
IWEVCUSTOM
, &
wrqu
, 
w∑_assoc_öfo_ªq
);

756 
w∑_assoc_öfo_ª•
 = 
	`kmÆloc
(
IW_CUSTOM_MAX
, 
MEM_ALLOC_FLAG
);

757 i‡(!
w∑_assoc_öfo_ª•
)

759 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "couldn'tállocate memory\n");

764 
	`mem£t
(
w∑_assoc_öfo_ª•
, 0, 
IW_CUSTOM_MAX
);

765 
p
 = 
w∑_assoc_öfo_ª•
;

766 
p
 +
	`•rötf
(p, " RespIEs=");

767 
õs
 = ((*)
ndis_assoc_öfo
) +

768 
ndis_assoc_öfo
->
Off£tRe•⁄£IEs
;

770 
i
 = 0; i < 
ndis_assoc_öfo
->
Re•⁄£IELígth
; i++)

771 
p
 +
	`•rötf
’, "%c", 
õs
[
i
]);

773 
p
 +
	`•rötf
(p, "\0");

775 
	`mem£t
(&
wrqu
, 0, (wrqu));

776 
wrqu
.
d©a
.
Àngth
 = 
p
 - 
w∑_assoc_öfo_ª•
;

777 
wrqu
.
d©a
.
Êags
 = 
RT_RESPIE_EVENT_FLAG
;

778 
	`wúñess_£nd_evít
(
pAd
->
√t_dev
, 
IWEVCUSTOM
, &
wrqu
, 
w∑_assoc_öfo_ª•
);

780 
	`mem£t
(&
wrqu
, 0, (wrqu));

781 
wrqu
.
d©a
.
Êags
 = 
RT_ASSOCINFO_EVENT_FLAG
;

782 
	`wúñess_£nd_evít
(
pAd
->
√t_dev
, 
IWEVCUSTOM
, &
wrqu
, 
NULL
);

786 i‡((
ndis_assoc_öfo
->
Reque°IELígth
 +

787 
ndis_assoc_öfo
->
Re•⁄£IELígth
 + 28Ë> 
IW_CUSTOM_MAX
)

793 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "informationÉlement isÅooÜong! "

795 
	`k‰ì
(
assoc_öfo
);

799 
w∑_assoc_öfo
 = 
	`kmÆloc
(
IW_CUSTOM_MAX
, 
MEM_ALLOC_FLAG
);

800 i‡(!
w∑_assoc_öfo
)

802 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "couldn'tállocate memory\n");

803 
	`k‰ì
(
assoc_öfo
);

806 
p
 = 
w∑_assoc_öfo
;

807 
p
 +
	`•rötf
(p, "ASSOCINFO(ReqIEs=");

808 
õs
 = ((*)
ndis_assoc_öfo
) +

809 
ndis_assoc_öfo
->
Off£tReque°IEs
;

810 
i
 = 0; i < 
ndis_assoc_öfo
->
Reque°IELígth
; i++)

811 
p
 +
	`•rötf
’, "%02x", 
õs
[
i
]);

814 
p
 +
	`•rötf
(p, " RespIEs=");

815 
õs
 = ((*)
ndis_assoc_öfo
) +

816 
ndis_assoc_öfo
->
Off£tRe•⁄£IEs
;

817 
i
 = 0; i < 
ndis_assoc_öfo
->
Re•⁄£IELígth
; i++)

818 
p
 +
	`•rötf
’, "%02x", 
õs
[
i
]);

820 
p
 +
	`•rötf
(p, ")");

822 
	`mem£t
(&
wrqu
, 0, (wrqu));

823 
wrqu
.
d©a
.
Àngth
 = 
p
 - 
w∑_assoc_öfo
;

825 
	`wúñess_£nd_evít
(
pAd
->
√t_dev
, 
IWEVCUSTOM
, &
wrqu
, 
w∑_assoc_öfo
);

827 
	`k‰ì
(
w∑_assoc_öfo
);

829 
	`k‰ì
(
w∑_assoc_öfo_ªq
);

830 
	`k‰ì
(
w∑_assoc_öfo_ª•
);

831 
	`k‰ì
(
assoc_öfo
);

834 
	}
}

846 
VOID
 
	$PìrAssocR•A˘i⁄
(

847 
IN
 
PRTMP_ADAPTER
 
pAd
,

848 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

850 
USHORT
 
C≠abûôyInfo
, 
Sètus
, 
Aid
;

851 
UCHAR
 
SupR©e
[
MAX_LEN_OF_SUPPORTED_RATES
], 
SupR©eLí
;

852 
UCHAR
 
ExtR©e
[
MAX_LEN_OF_SUPPORTED_RATES
], 
ExtR©eLí
;

853 
UCHAR
 
Addr2
[
MAC_ADDR_LEN
];

854 
EDCA_PARM
 
EdˇP¨m
;

855 
BOOLEAN
 
TimîC™˚Œed
;

857 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


858 
iwªq_d©a
 
wrqu
;

861 i‡(
	`PìrAssocR•S™ôy
(
pAd
, 
EÀm
->
Msg
, EÀm->
MsgLí
, 
Addr2
, &
C≠abûôyInfo
, &
Sètus
, &
Aid
, 
SupR©e
, &
SupR©eLí
, 
ExtR©e
, &
ExtR©eLí
, &
EdˇP¨m
))

864 if(
	`MAC_ADDR_EQUAL
(
Addr2
, 
pAd
->
MlmeAux
.
Bssid
))

866 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC -Ñe˚ivêASSOC_RSPÅÿmê(°©us=%d)\n", 
Sètus
);

867 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
AssocTimî
,&
TimîC™˚Œed
);

869 if(
Sètus
 =
MLME_SUCCESS
)

878 i‡(
pAd
->
P‹tCfg
.
BssTy≥
 =
BSS_INFRA
)

880 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
);

885 
	`AssocPo°Proc
(
pAd
, 
Addr2
, 
C≠abûôyInfo
, 
Aid
, 
SupR©e
, 
SupR©eLí
, 
ExtR©e
, 
ExtR©eLí
, &
EdˇP¨m
);

887 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


888 i‡(
pAd
->
P‹tCfg
.
WPA_Suµliˇ¡
 =
TRUE
) {

890 
	`lök_°©us_h™dÀr
(
pAd
);

892 
	`mem£t
(&
wrqu
, 0, (wrqu));

893 
wrqu
.
d©a
.
Êags
 = 
RT_ASSOC_EVENT_FLAG
;

894 
	`wúñess_£nd_evít
(
pAd
->
√t_dev
, 
IWEVCUSTOM
, &
wrqu
, 
NULL
);

898 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


900 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

901 
	`wext_nŸify_evít_assoc
(
pAd
, 
SIOCGIWAP
, 
TRUE
);

905 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

906 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_ASSOC_CONF
, 2, &
Sètus
);

911 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - PeerAssocRspAction() sanity check fail\n");

913 
	}
}

923 
VOID
 
	$PìrRóssocR•A˘i⁄
(

924 
IN
 
PRTMP_ADAPTER
 
pAd
,

925 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

927 
USHORT
 
C≠abûôyInfo
;

928 
USHORT
 
Sètus
;

929 
USHORT
 
Aid
;

930 
UCHAR
 
SupR©e
[
MAX_LEN_OF_SUPPORTED_RATES
], 
SupR©eLí
;

931 
UCHAR
 
ExtR©e
[
MAX_LEN_OF_SUPPORTED_RATES
], 
ExtR©eLí
;

932 
UCHAR
 
Addr2
[
MAC_ADDR_LEN
];

933 
EDCA_PARM
 
EdˇP¨m
;

934 
BOOLEAN
 
TimîC™˚Œed
;

936 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


937 
iwªq_d©a
 
wrqu
;

940 if(
	`PìrAssocR•S™ôy
(
pAd
, 
EÀm
->
Msg
, EÀm->
MsgLí
, 
Addr2
, &
C≠abûôyInfo
, &
Sètus
, &
Aid
, 
SupR©e
, &
SupR©eLí
, 
ExtR©e
, &
ExtR©eLí
, &
EdˇP¨m
))

942 if(
	`MAC_ADDR_EQUAL
(
Addr2
, 
pAd
->
MlmeAux
.
Bssid
))

944 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC -Ñe˚ivêREASSOC_RSPÅÿmê(°©us=%d)\n", 
Sètus
);

945 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
RóssocTimî
,&
TimîC™˚Œed
);

947 if(
Sètus
 =
MLME_SUCCESS
)

950 
	`AssocPo°Proc
(
pAd
, 
Addr2
, 
C≠abûôyInfo
, 
Aid
, 
SupR©e
, 
SupR©eLí
, 
ExtR©e
, 
ExtR©eLí
, &
EdˇP¨m
);

952 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


953 i‡(
pAd
->
P‹tCfg
.
WPA_Suµliˇ¡
 =
TRUE
) {

955 
	`lök_°©us_h™dÀr
(
pAd
);

957 
	`mem£t
(&
wrqu
, 0, (wrqu));

958 
wrqu
.
d©a
.
Êags
 = 
RT_ASSOC_EVENT_FLAG
;

959 
	`wúñess_£nd_evít
(
pAd
->
√t_dev
, 
IWEVCUSTOM
, &
wrqu
, 
NULL
);

961 
	`DBGPRINT
(
RT_DEBUG_OFF
, "ASSOC -Ñe˚ivêREASSOC_RSPÅÿmê(°©us=%d)\n", 
Sètus
);

964 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


965 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

966 
	`wext_nŸify_evít_assoc
(
pAd
, 
SIOCGIWAP
, 
TRUE
);

971 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

972 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_REASSOC_CONF
, 2, &
Sètus
);

977 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - PeerReassocRspAction() sanity check fail\n");

980 
	}
}

989 
VOID
 
	$AssocPo°Proc
(

990 
IN
 
PRTMP_ADAPTER
 
pAd
,

991 
IN
 
PUCHAR
 
pAddr2
,

992 
IN
 
USHORT
 
C≠abûôyInfo
,

993 
IN
 
USHORT
 
Aid
,

994 
IN
 
UCHAR
 
SupR©e
[],

995 
IN
 
UCHAR
 
SupR©eLí
,

996 
IN
 
UCHAR
 
ExtR©e
[],

997 
IN
 
UCHAR
 
ExtR©eLí
,

998 
IN
 
PEDCA_PARM
 
pEdˇP¨m
)

1000 
ULONG
 
Idx
;

1001 
UCHAR
 
V¨IesOff£t
;

1003 
pAd
->
MlmeAux
.
BssTy≥
 = 
BSS_INFRA
;

1004 
	`COPY_MAC_ADDR
(
pAd
->
MlmeAux
.
Bssid
, 
pAddr2
);

1005 
pAd
->
MlmeAux
.
Aid
 = Aid;

1006 
pAd
->
MlmeAux
.
C≠abûôyInfo
 = C≠abûôyInfÿ& 
SUPPORTED_CAPABILITY_INFO
;

1007 
	`NdisMoveMem‹y
(&
pAd
->
MlmeAux
.
APEdˇP¨m
, 
pEdˇP¨m
, (
EDCA_PARM
));

1010 
pAd
->
MlmeAux
.
SupR©eLí
 = SupRateLen;

1011 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
SupR©e
, SupR©e, 
SupR©eLí
);

1012 
	`RTMPCheckR©es
(
pAd
,ÖAd->
MlmeAux
.
SupR©e
, &pAd->MlmeAux.
SupR©eLí
);

1015 
pAd
->
MlmeAux
.
ExtR©eLí
 = ExtRateLen;

1016 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
ExtR©e
, ExtR©e, 
ExtR©eLí
);

1017 
	`RTMPCheckR©es
(
pAd
,ÖAd->
MlmeAux
.
ExtR©e
, &pAd->MlmeAux.
ExtR©eLí
);

1020 
Idx
 = 
	`BssTabÀSórch
(&
pAd
->
SˇnTab
, 
pAddr2
,ÖAd->
MlmeAux
.
Ch™√l
);

1021 i‡(
Idx
 =
BSS_NOT_FOUND
)

1023 
	`DBGPRINT_ERR
("ASSOC - Can't find BSSáfterÑeceiving AssocÑesponse from[%02x:%02x:%02x:%02x:%02x:%02x]\n",

1024 
pAddr2
[0],ÖAddr2[1],ÖAddr2[2],ÖAddr2[3],ÖAddr2[4],ÖAddr2[5]);

1029 
pAd
->
P‹tCfg
.
AssocInfo
.
Lígth
 = (
NDIS_802_11_ASSOCIATION_INFORMATION
);

1030 
pAd
->
P‹tCfg
.
AssocInfo
.
AvaûabÀRe•⁄£FixedIEs
 =

1031 
NDIS_802_11_AI_RESFI_CAPABILITIES
 | 
NDIS_802_11_AI_RESFI_STATUSCODE
 | 
NDIS_802_11_AI_RESFI_ASSOCIATIONID
;

1032 
pAd
->
P‹tCfg
.
AssocInfo
.
Re•⁄£FixedIEs
.
C≠abûôõs
 = 
C≠abûôyInfo
;

1033 
pAd
->
P‹tCfg
.
AssocInfo
.
Re•⁄£FixedIEs
.
SètusCode
 = 
MLME_SUCCESS
;

1034 
pAd
->
P‹tCfg
.
AssocInfo
.
Re•⁄£FixedIEs
.
Assocüti⁄Id
 = 
Aid
;

1038 
V¨IesOff£t
 = 0;

1039 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
ResV¨IEs
 + 
V¨IesOff£t
, &
SupR©eIe
, 1);

1040 
V¨IesOff£t
 += 1;

1041 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
ResV¨IEs
 + 
V¨IesOff£t
, &
SupR©eLí
, 1);

1042 
V¨IesOff£t
 += 1;

1043 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
ResV¨IEs
 + 
V¨IesOff£t
, 
SupR©e
, 
SupR©eLí
);

1044 
V¨IesOff£t
 +
SupR©eLí
;

1053 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
ResV¨IEs
 + 
V¨IesOff£t
,ÖAd->
SˇnTab
.
BssE¡ry
[
Idx
].
V¨IEs
,ÖAd->SˇnTab.BssE¡ry[Idx].
V¨IELí
);

1054 
V¨IesOff£t
 +
pAd
->
SˇnTab
.
BssE¡ry
[
Idx
].
V¨IELí
;

1057 
pAd
->
P‹tCfg
.
ResV¨IELí
 = 
V¨IesOff£t
;

1058 
pAd
->
P‹tCfg
.
AssocInfo
.
Re•⁄£IELígth
 = 
V¨IesOff£t
;

1060 
	}
}

1070 
VOID
 
	$PìrDißssocA˘i⁄
(

1071 
IN
 
PRTMP_ADAPTER
 
pAd
,

1072 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1074 
UCHAR
 
Addr2
[
MAC_ADDR_LEN
];

1075 
USHORT
 
Rós⁄
;

1077 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


1078 
iwªq_d©a
 
wrqu
;

1081 if(
	`PìrDißssocS™ôy
(
pAd
, 
EÀm
->
Msg
, EÀm->
MsgLí
, 
Addr2
, &
Rós⁄
))

1083 i‡(
	`INFRA_ON
(
pAd
Ë&& 
	`MAC_ADDR_EQUAL
’Ad->
P‹tCfg
.
Bssid
, 
Addr2
))

1085 
	`LökDown
(
pAd
, 
TRUE
);

1086 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

1088 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


1089 i‡(
pAd
->
P‹tCfg
.
WPA_Suµliˇ¡
 =
TRUE
) {

1091 
	`mem£t
(&
wrqu
, 0, (wrqu));

1092 
wrqu
.
d©a
.
Êags
 = 
RT_DISASSOC_EVENT_FLAG
;

1093 
	`wúñess_£nd_evít
(
pAd
->
√t_dev
, 
IWEVCUSTOM
, &
wrqu
, 
NULL
);

1097 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


1098 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

1099 
	`wext_nŸify_evít_assoc
(
pAd
, 
SIOCGIWAP
, 
FALSE
);

1111 
pAd
->
RÆökCou¡îs
.
BìnDißssocüãdCou¡
 ++;

1113 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - Dißssocüãd by AP, AutÿRecovîyáâem± #%d\n", 
pAd
->
RÆökCou¡îs
.
BìnDißssocüãdCou¡
);

1114 
	`MlmeAutoRec⁄√˘La°SSID
(
pAd
);

1120 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - PeerDisassocAction() sanity check fail\n");

1123 
	}
}

1131 
VOID
 
	$AssocTimeoutA˘i⁄
(

1132 
IN
 
PRTMP_ADAPTER
 
pAd
,

1133 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1135 
USHORT
 
Sètus
;

1136 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - AssocTimeoutAction\n");

1137 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

1138 
Sètus
 = 
MLME_REJ_TIMEOUT
;

1139 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_ASSOC_CONF
, 2, &
Sètus
);

1141 
	}
}

1149 
VOID
 
	$RóssocTimeoutA˘i⁄
(

1150 
IN
 
PRTMP_ADAPTER
 
pAd
,

1151 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1153 
USHORT
 
Sètus
;

1154 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - ReassocTimeoutAction\n");

1155 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

1156 
Sètus
 = 
MLME_REJ_TIMEOUT
;

1157 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_REASSOC_CONF
, 2, &
Sètus
);

1158 
	}
}

1166 
VOID
 
	$DißssocTimeoutA˘i⁄
(

1167 
IN
 
PRTMP_ADAPTER
 
pAd
,

1168 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1170 
USHORT
 
Sètus
;

1171 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - DisassocTimeoutAction\n");

1172 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

1173 
Sètus
 = 
MLME_SUCCESS
;

1174 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_DISASSOC_CONF
, 2, &
Sètus
);

1175 
	}
}

1177 
VOID
 
	$InvÆidSèãWhíAssoc
(

1178 
IN
 
PRTMP_ADAPTER
 
pAd
,

1179 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1181 
USHORT
 
Sètus
;

1182 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - InvalidStateWhenAssoc(state=%d),Ñeset ASSOC state machine\n",

1183 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
);

1184 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

1185 
Sètus
 = 
MLME_STATE_MACHINE_REJECT
;

1186 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_ASSOC_CONF
, 2, &
Sètus
);

1187 
	}
}

1189 
VOID
 
	$InvÆidSèãWhíRóssoc
(

1190 
IN
 
PRTMP_ADAPTER
 
pAd
,

1191 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1193 
USHORT
 
Sètus
;

1194 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - InvalidStateWhenReassoc(state=%d),Ñeset ASSOC state machine\n",

1195 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
);

1196 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

1197 
Sètus
 = 
MLME_STATE_MACHINE_REJECT
;

1198 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_REASSOC_CONF
, 2, &
Sètus
);

1199 
	}
}

1201 
VOID
 
	$InvÆidSèãWhíDißssocüã
(

1202 
IN
 
PRTMP_ADAPTER
 
pAd
,

1203 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1205 
USHORT
 
Sètus
;

1206 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - InvalidStateWhenDisassoc(state=%d),Ñeset ASSOC state machine\n",

1207 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
);

1208 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

1209 
Sètus
 = 
MLME_STATE_MACHINE_REJECT
;

1210 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_DISASSOC_CONF
, 2, &
Sètus
);

1211 
	}
}

1223 
VOID
 
	$Cls3îrA˘i⁄
(

1224 
IN
 
PRTMP_ADAPTER
 
pAd
,

1225 
IN
 
PUCHAR
 
pAddr
)

1227 
HEADER_802_11
 
DißssocHdr
;

1228 
PCHAR
 
pOutBuf„r
 = 
NULL
;

1229 
ULONG
 
FømeLí
 = 0;

1230 
USHORT
 
Rós⁄
 = 
REASON_CLS3ERR
;

1231 
USHORT
 
NSètus
;

1234 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

1235 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

1238 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ASSOC - Class 3 Error, Send DISASSOC frame\n");

1240 
	`MgtMacHódîInô
(
pAd
, &
DißssocHdr
, 
SUBTYPE_DISASSOC
, 0, 
pAddr
,ÖAd->
P‹tCfg
.
Bssid
);

1241 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

1242 (
HEADER_802_11
), &
DißssocHdr
,

1243 2, &
Rós⁄
,

1244 
END_OF_ARGS
);

1246 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

1249 
pAd
->
P‹tCfg
.
DißssocRós⁄
 = 
REASON_CLS3ERR
;

1250 
	`COPY_MAC_ADDR
(
pAd
->
P‹tCfg
.
DißssocSè
, 
pAddr
);

1251 
	}
}

	@auth.c

37 
	~"π_c⁄fig.h
"

57 
VOID
 
	$AuthSèãMachöeInô
(

58 
IN
 
PRTMP_ADAPTER
 
pAd
,

59 
IN
 
PSTATE_MACHINE
 
Sm
,

60 
OUT
 
STATE_MACHINE_FUNC
 
Tøns
[])

62 
	`SèãMachöeInô
(
Sm
, (
STATE_MACHINE_FUNC
*)
Tøns
, 
MAX_AUTH_STATE
, 
MAX_AUTH_MSG
, (STATE_MACHINE_FUNC)
Dr›
, 
AUTH_REQ_IDLE
, 
AUTH_MACHINE_BASE
);

65 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
AUTH_REQ_IDLE
, 
MT2_MLME_AUTH_REQ
, (
STATE_MACHINE_FUNC
)
MlmeAuthReqA˘i⁄
);

68 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
AUTH_WAIT_SEQ2
, 
MT2_MLME_AUTH_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíAuth
);

69 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
AUTH_WAIT_SEQ2
, 
MT2_PEER_AUTH_EVEN
, (
STATE_MACHINE_FUNC
)
PìrAuthR•AtSeq2A˘i⁄
);

70 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
AUTH_WAIT_SEQ2
, 
MT2_AUTH_TIMEOUT
, (
STATE_MACHINE_FUNC
)
AuthTimeoutA˘i⁄
);

73 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
AUTH_WAIT_SEQ4
, 
MT2_MLME_AUTH_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíAuth
);

74 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
AUTH_WAIT_SEQ4
, 
MT2_PEER_AUTH_EVEN
, (
STATE_MACHINE_FUNC
)
PìrAuthR•AtSeq4A˘i⁄
);

75 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
AUTH_WAIT_SEQ4
, 
MT2_AUTH_TIMEOUT
, (
STATE_MACHINE_FUNC
)
AuthTimeoutA˘i⁄
);

78 
	`RTMPInôTimî
(
pAd
, &pAd->
MlmeAux
.
AuthTimî
, 
	`GET_TIMER_FUNCTION
(
AuthTimeout
),ÖAd, 
FALSE
);

80 
	}
}

88 
VOID
 
	$AuthTimeout
(

89 
IN
 
PVOID
 
Sy°emS≥cific1
,

90 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

91 
IN
 
PVOID
 
Sy°emS≥cific2
,

92 
IN
 
PVOID
 
Sy°emS≥cific3
)

94 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
Fun˘i⁄C⁄ãxt
;

96 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"AUTH - AuthTimeout\n");

97 
	`MlmeEnqueue
(
pAd
, 
AUTH_STATE_MACHINE
, 
MT2_AUTH_TIMEOUT
, 0, 
NULL
);

98 
	`RTUSBMlmeUp
(
pAd
);

99 
	}
}

106 
VOID
 
	$MlmeAuthReqA˘i⁄
(

107 
IN
 
PRTMP_ADAPTER
 
pAd
,

108 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

110 
UCHAR
 
Addr
[
MAC_ADDR_LEN
];

111 
USHORT
 
Alg
, 
Seq
, 
Sètus
;

112 
ULONG
 
Timeout
;

113 
HEADER_802_11
 
AuthHdr
;

114 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

115 
ULONG
 
FømeLí
 = 0;

116 
USHORT
 
NSètus
;

117 
BOOLEAN
 
TimîC™˚Œed
;

120 i‡(
pAd
->
P‹tCfg
.
bBlockAssoc
 =
TRUE
)

122 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AUTH - Block AuthÑequest durning WPA blockÖeriod!\n");

123 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_REQ_IDLE
;

124 
Sètus
 = 
MLME_STATE_MACHINE_REJECT
;

125 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_AUTH_CONF
, 2, &
Sètus
);

127 if(
	`MlmeAuthReqS™ôy
(
pAd
, 
EÀm
->
Msg
, EÀm->
MsgLí
, 
Addr
, &
Timeout
, &
Alg
))

130 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
AuthTimî
, &
TimîC™˚Œed
);

132 
	`COPY_MAC_ADDR
(
pAd
->
MlmeAux
.
Bssid
, 
Addr
);

133 
pAd
->
MlmeAux
.
Alg
 = Alg;

135 
Seq
 = 1;

136 
Sètus
 = 
MLME_SUCCESS
;

139 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

140 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

142 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AUTH - MlmeAuthReqAction()állocate memory failed\n");

143 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_REQ_IDLE
;

144 
Sètus
 = 
MLME_FAIL_NO_RESOURCE
;

145 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_AUTH_CONF
, 2, &
Sètus
);

149 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AUTH - Síd AUTHÑeque° seq#1 (Alg=%dË %d...\n", 
Alg
, 
pAd
->
L©chRfRegs
.
Ch™√l
);

150 
	`MgtMacHódîInô
(
pAd
, &
AuthHdr
, 
SUBTYPE_AUTH
, 0, 
Addr
,ÖAd->
MlmeAux
.
Bssid
);

152 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

153 (
HEADER_802_11
),&
AuthHdr
,

154 2, &
Alg
,

155 2, &
Seq
,

156 2, &
Sètus
,

157 
END_OF_ARGS
);

159 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

161 
	`RTMPSëTimî
(&
pAd
->
MlmeAux
.
AuthTimî
, 
AUTH_TIMEOUT
);

163 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_WAIT_SEQ2
;

167 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "AUTH - MlmeAuthReqAction() sanity check failed. BUG!!!!!\n");

168 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_REQ_IDLE
;

169 
Sètus
 = 
MLME_INVALID_FORMAT
;

170 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_AUTH_CONF
, 2, &
Sètus
);

172 
	}
}

179 
VOID
 
	$PìrAuthR•AtSeq2A˘i⁄
(

180 
IN
 
PRTMP_ADAPTER
 
pAd
,

181 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

183 
UCHAR
 
Addr2
[
MAC_ADDR_LEN
];

184 
USHORT
 
Seq
, 
Sètus
, 
RemŸeSètus
, 
Alg
;

185 
UCHAR
 
ChlgText
[
CIPHER_TEXT_LEN
];

186 
UCHAR
 
Cy≥rChlgText
[
CIPHER_TEXT_LEN
 + 8 + 8];

187 
UCHAR
 
EÀmít
[2];

188 
HEADER_802_11
 
AuthHdr
;

189 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

190 
ULONG
 
FømeLí
 = 0;

191 
USHORT
 
Sètus2
;

192 
USHORT
 
NSètus
;

193 
BOOLEAN
 
TimîC™˚Œed
;

195 i‡(
	`PìrAuthS™ôy
(
pAd
, 
EÀm
->
Msg
, EÀm->
MsgLí
, 
Addr2
, &
Alg
, &
Seq
, &
Sètus
, 
ChlgText
))

197 i‡(
	`MAC_ADDR_EQUAL
(&
pAd
->
MlmeAux
.
Bssid
, 
Addr2
Ë&& 
Seq
 == 2)

199 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AUTH - Re˚ivêAUTH_RSP seq#2Åÿmê(Alg=%d, Sètus=%d)\n", 
Alg
, 
Sètus
);

200 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
AuthTimî
,&
TimîC™˚Œed
);

202 i‡(
Sètus
 =
MLME_SUCCESS
)

204 i‡(
pAd
->
MlmeAux
.
Alg
 =
Ndis802_11AuthModeO≥n
)

206 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_REQ_IDLE
;

207 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_AUTH_CONF
, 2, &
Sètus
);

212 
Seq
++;

213 
RemŸeSètus
 = 
MLME_SUCCESS
;

215 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

216 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

218 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AUTH - PeerAuthRspAtSeq2Action()állocate memory fail\n");

219 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_REQ_IDLE
;

220 
Sètus2
 = 
MLME_FAIL_NO_RESOURCE
;

221 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_AUTH_CONF
, 2, &
Sètus2
);

225 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AUTH - Send AUTHÑequest seq#3...\n");

226 
	`MgtMacHódîInô
(
pAd
, &
AuthHdr
, 
SUBTYPE_AUTH
, 0, 
Addr2
,ÖAd->
MlmeAux
.
Bssid
);

227 
AuthHdr
.
FC
.
Wï
 = 1;

229 
	`RTMPInôWïEngöe
(

230 
pAd
,

231 
pAd
->
Sh¨edKey
[pAd->
P‹tCfg
.
DeÁu…KeyId
].
Key
,

232 
pAd
->
P‹tCfg
.
DeÁu…KeyId
,

233 
pAd
->
Sh¨edKey
[pAd->
P‹tCfg
.
DeÁu…KeyId
].
KeyLí
,

234 
Cy≥rChlgText
);

235 #ifde‡
BIG_ENDIAN


236 
Alg
 = 
	`SWAP16
(*(
USHORT
 *)&Alg);

237 
Seq
 = 
	`SWAP16
(*(
USHORT
 *)&Seq);

238 
RemŸeSètus

	`SWAP16
(*(
USHORT
 *)&RemoteStatus);

240 
	`RTMPEn¸y±D©a
(
pAd
, (
PUCHAR
Ë&
Alg
, 
Cy≥rChlgText
 + 4, 2);

241 
	`RTMPEn¸y±D©a
(
pAd
, (
PUCHAR
Ë&
Seq
, 
Cy≥rChlgText
 + 6, 2);

242 
	`RTMPEn¸y±D©a
(
pAd
, (
PUCHAR
Ë&
RemŸeSètus
, 
Cy≥rChlgText
 + 8, 2);

244 
EÀmít
[0] = 16;

245 
EÀmít
[1] = 128;

246 
	`RTMPEn¸y±D©a
(
pAd
, 
EÀmít
, 
Cy≥rChlgText
 + 10, 2);

247 
	`RTMPEn¸y±D©a
(
pAd
, 
ChlgText
, 
Cy≥rChlgText
 + 12, 128);

248 
	`RTMPSëICV
(
pAd
, 
Cy≥rChlgText
 + 140);

250 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

251 (
HEADER_802_11
), &
AuthHdr
,

252 
CIPHER_TEXT_LEN
 + 16, 
Cy≥rChlgText
,

253 
END_OF_ARGS
);

255 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

257 
	`RTMPSëTimî
(&
pAd
->
MlmeAux
.
AuthTimî
, 
AUTH_TIMEOUT
);

258 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_WAIT_SEQ4
;

263 
pAd
->
P‹tCfg
.
AuthFaûRós⁄
 = 
Sètus
;

264 
	`COPY_MAC_ADDR
(
pAd
->
P‹tCfg
.
AuthFaûSè
, 
Addr2
);

265 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_REQ_IDLE
;

266 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_AUTH_CONF
, 2, &
Sètus
);

272 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AUTH - PeerAuthSanity() sanity check fail\n");

274 
	}
}

281 
VOID
 
	$PìrAuthR•AtSeq4A˘i⁄
(

282 
IN
 
PRTMP_ADAPTER
 
pAd
,

283 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

285 
UCHAR
 
Addr2
[
MAC_ADDR_LEN
];

286 
USHORT
 
Alg
, 
Seq
, 
Sètus
;

287 
CHAR
 
ChlgText
[
CIPHER_TEXT_LEN
];

288 
BOOLEAN
 
TimîC™˚Œed
;

290 if(
	`PìrAuthS™ôy
(
pAd
, 
EÀm
->
Msg
, EÀm->
MsgLí
, 
Addr2
, &
Alg
, &
Seq
, &
Sètus
, 
ChlgText
))

292 if(
	`MAC_ADDR_EQUAL
(&(
pAd
->
MlmeAux
.
Bssid
), 
Addr2
Ë&& 
Seq
 == 4)

294 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AUTH - Receive AUTH_RSP seq#4Åo me\n");

295 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
AuthTimî
,&
TimîC™˚Œed
);

297 if(
Sètus
 !
MLME_SUCCESS
)

299 
pAd
->
P‹tCfg
.
AuthFaûRós⁄
 = 
Sètus
;

300 
	`COPY_MAC_ADDR
(
pAd
->
P‹tCfg
.
AuthFaûSè
, 
Addr2
);

303 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_REQ_IDLE
;

304 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_AUTH_CONF
, 2, &
Sètus
);

309 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AUTH - PeerAuthRspAtSeq4Action() sanity check fail\n");

311 
	}
}

318 
VOID
 
	$MlmeDóuthReqA˘i⁄
(

319 
IN
 
PRTMP_ADAPTER
 
pAd
,

320 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

322 
MLME_DEAUTH_REQ_STRUCT
 *
pInfo
;

323 
HEADER_802_11
 
DóuthHdr
;

324 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

325 
ULONG
 
FømeLí
 = 0;

326 
USHORT
 
Sètus
;

327 
USHORT
 
NSètus
;

329 
pInfo
 = (
MLME_DEAUTH_REQ_STRUCT
 *)
EÀm
->
Msg
;

332 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

333 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

335 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AUTH - MlmeDeauthReqAction()állocate memory fail\n");

336 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_REQ_IDLE
;

337 
Sètus
 = 
MLME_FAIL_NO_RESOURCE
;

338 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_DEAUTH_CONF
, 2, &
Sètus
);

342 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AUTH - Síd DE-AUTHÑeque° (Rós⁄=%d)...\n", 
pInfo
->
Rós⁄
);

343 
	`MgtMacHódîInô
(
pAd
, &
DóuthHdr
, 
SUBTYPE_DEAUTH
, 0, 
pInfo
->
Addr
,ÖAd->
MlmeAux
.
Bssid
);

345 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

346 (
HEADER_802_11
), &
DóuthHdr
,

347 2, &
pInfo
->
Rós⁄
,

348 
END_OF_ARGS
);

350 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

353 
pAd
->
P‹tCfg
.
DóuthRós⁄
 = 
pInfo
->
Rós⁄
;

354 
	`COPY_MAC_ADDR
(
pAd
->
P‹tCfg
.
DóuthSè
, 
pInfo
->
Addr
);

355 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_REQ_IDLE
;

356 
Sètus
 = 
MLME_SUCCESS
;

357 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_DEAUTH_CONF
, 2, &
Sètus
);

358 
	}
}

365 
VOID
 
	$AuthTimeoutA˘i⁄
(

366 
IN
 
PRTMP_ADAPTER
 
pAd
,

367 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

369 
USHORT
 
Sètus
;

371 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AUTH - AuthTimeoutAction\n");

372 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_REQ_IDLE
;

373 
Sètus
 = 
MLME_REJ_TIMEOUT
;

374 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_AUTH_CONF
, 2, &
Sètus
);

375 
	}
}

382 
VOID
 
	$InvÆidSèãWhíAuth
(

383 
IN
 
PRTMP_ADAPTER
 
pAd
,

384 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

386 
USHORT
 
Sètus
;

387 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AUTH - InvÆidSèãWhíAuth (°©e=%d),Ñe£àAUTH sèã machöe\n", 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
);

388 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_REQ_IDLE
;

389 
Sètus
 = 
MLME_STATE_MACHINE_REJECT
;

390 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_AUTH_CONF
, 2, &
Sètus
);

391 
	}
}

402 
VOID
 
	$Cls2îrA˘i⁄
(

403 
IN
 
PRTMP_ADAPTER
 
pAd
,

404 
IN
 
PUCHAR
 
pAddr
)

406 
HEADER_802_11
 
DóuthHdr
;

407 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

408 
ULONG
 
FømeLí
 = 0;

409 
USHORT
 
Rós⁄
 = 
REASON_CLS2ERR
;

410 
USHORT
 
NSètus
;

413 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

414 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

417 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AUTH - Class 2Érror, Send DEAUTH frame...\n");

418 
	`MgtMacHódîInô
(
pAd
, &
DóuthHdr
, 
SUBTYPE_DEAUTH
, 0, 
pAddr
,ÖAd->
MlmeAux
.
Bssid
);

419 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

420 (
HEADER_802_11
), &
DóuthHdr
,

421 2, &
Rós⁄
,

422 
END_OF_ARGS
);

423 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

426 
pAd
->
P‹tCfg
.
DóuthRós⁄
 = 
Rós⁄
;

427 
	`COPY_MAC_ADDR
(
pAd
->
P‹tCfg
.
DóuthSè
, 
pAddr
);

428 
	}
}

	@auth_rsp.c

27 
	~"π_c⁄fig.h
"

44 
VOID
 
	$AuthR•SèãMachöeInô
(

45 
IN
 
PRTMP_ADAPTER
 
pAd
,

46 
IN
 
PSTATE_MACHINE
 
Sm
,

47 
IN
 
STATE_MACHINE_FUNC
 
Tøns
[])

49 
ULONG
 
Now
;

51 
	`SèãMachöeInô
(
Sm
, (
STATE_MACHINE_FUNC
*)
Tøns
, 
MAX_AUTH_RSP_STATE
, 
MAX_AUTH_RSP_MSG
, (STATE_MACHINE_FUNC)
Dr›
, 
AUTH_RSP_IDLE
, 
AUTH_RSP_MACHINE_BASE
);

54 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
AUTH_RSP_IDLE
, 
MT2_PEER_DEAUTH
, (
STATE_MACHINE_FUNC
)
PìrDóuthA˘i⁄
);

57 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
AUTH_RSP_WAIT_CHAL
, 
MT2_PEER_DEAUTH
, (
STATE_MACHINE_FUNC
)
PìrDóuthA˘i⁄
);

61 
Now
 = 
jiffõs
;

62 
	`Lf§Inô
(
pAd
, 
Now
);

63 
	}
}

70 
VOID
 
	$PìrAuthSim∂eR•GíAndSíd
(

71 
IN
 
PRTMP_ADAPTER
 
pAd
,

72 
IN
 
PHEADER_802_11
 
pHdr80211
,

73 
IN
 
USHORT
 
Alg
,

74 
IN
 
USHORT
 
Seq
,

75 
IN
 
USHORT
 
Rós⁄
,

76 
IN
 
USHORT
 
Sètus
)

78 
HEADER_802_11
 
AuthHdr
;

79 
UINT
 
FømeLí
 = 0;

80 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

81 
USHORT
 
NSètus
;

84 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

85 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

88 i‡(
Rós⁄
 =
MLME_SUCCESS
)

90 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Send AUTHÑesponse (seq#2)...\n");

91 
	`MgtMacHódîInô
(
pAd
, &
AuthHdr
, 
SUBTYPE_AUTH
, 0, 
pHdr80211
->
Addr2
,ÖAd->
MlmeAux
.
Bssid
);

92 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

93 (
HEADER_802_11
), &
AuthHdr
,

94 2, &
Alg
,

95 2, &
Seq
,

96 2, &
Rós⁄
,

97 
END_OF_ARGS
);

98 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

102 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Peer AUTH fail...\n");

105 
	}
}

112 
VOID
 
	$PìrDóuthA˘i⁄
(

113 
IN
 
PRTMP_ADAPTER
 
pAd
,

114 
IN
 
PMLME_QUEUE_ELEM
 
EÀm
)

116 
UCHAR
 
Addr2
[
MAC_ADDR_LEN
];

117 
USHORT
 
Rós⁄
;

119 i‡(
	`PìrDóuthS™ôy
(
pAd
, 
EÀm
->
Msg
, EÀm->
MsgLí
, 
Addr2
, &
Rós⁄
))

121 i‡(
	`INFRA_ON
(
pAd
Ë&& 
	`MAC_ADDR_EQUAL
(
Addr2
, &pAd->
P‹tCfg
.
Bssid
))

123 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"AUTH_RSP -Ñeceive DE-AUTH from our AP\n");

124 
	`LökDown
(
pAd
, 
TRUE
);

129 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"AUTH_RSP - PeerDeauthAction() sanity check fail\n");

131 
	}
}

	@connect.c

37 
	~"π_c⁄fig.h
"

40 
UCHAR
 
	gCùhîSuôeW∑N⁄eTkù
[] = {

49 
UCHAR
 
	gCùhîSuôeW∑N⁄eTkùLí
 = ((
CùhîSuôeW∑N⁄eTkù
) / (UCHAR));

51 
UCHAR
 
	gCùhîSuôeW∑N⁄eAes
[] = {

60 
UCHAR
 
	gCùhîSuôeW∑N⁄eAesLí
 = ((
CùhîSuôeW∑N⁄eAes
) / (UCHAR));

67 
	#COPY_SETTINGS_FROM_MLME_AUX_TO_ACTIVE_CFG
(
_pAd
) \

69 
_pAd
->
P‹tCfg
.
SsidLí
 = _pAd->
MlmeAux
.SsidLen; \

70 
	`NdisMoveMem‹y
(
_pAd
->
P‹tCfg
.
Ssid
, _pAd->
MlmeAux
.Ssid, _pAd->MlmeAux.
SsidLí
); \

71 
	`COPY_MAC_ADDR
(
_pAd
->
P‹tCfg
.
Bssid
, _pAd->
MlmeAux
.Bssid); \

72 
_pAd
->
P‹tCfg
.
Ch™√l
 = _pAd->
MlmeAux
.Channel; \

73 
_pAd
->
A˘iveCfg
.
Aid
 = _pAd->
MlmeAux
.Aid; \

74 
_pAd
->
A˘iveCfg
.
AtimWö
 = _pAd->
MlmeAux
.AtimWin; \

75 
_pAd
->
A˘iveCfg
.
C≠abûôyInfo
 = _pAd->
MlmeAux
.CapabilityInfo; \

76 
_pAd
->
P‹tCfg
.
Bóc⁄Pîiod
 = _pAd->
MlmeAux
.BeaconPeriod; \

77 
_pAd
->
A˘iveCfg
.
CÂMaxDuøti⁄
 = _pAd->
MlmeAux
.CfpMaxDuration; \

78 
_pAd
->
A˘iveCfg
.
CÂPîiod
 = _pAd->
MlmeAux
.CfpPeriod; \

79 
_pAd
->
A˘iveCfg
.
SupR©eLí
 = _pAd->
MlmeAux
.SupRateLen; \

80 
	`NdisMoveMem‹y
(
_pAd
->
A˘iveCfg
.
SupR©e
, _pAd->
MlmeAux
.SupR©e, _pAd->MlmeAux.
SupR©eLí
); \

81 
_pAd
->
A˘iveCfg
.
ExtR©eLí
 = _pAd->
MlmeAux
.ExtRateLen; \

82 
	`NdisMoveMem‹y
(
_pAd
->
A˘iveCfg
.
ExtR©e
, _pAd->
MlmeAux
.ExtR©e, _pAd->MlmeAux.
ExtR©eLí
); \

83 
	`NdisMoveMem‹y
(&
_pAd
->
P‹tCfg
.
APEdˇP¨m
, &_pAd->
MlmeAux
.APEdˇP¨m, (
EDCA_PARM
)); \

84 
	`NdisMoveMem‹y
(&
_pAd
->
P‹tCfg
.
APQosC≠abûôy
, &_pAd->
MlmeAux
.APQosC≠abûôy, (
QOS_CAPABILITY_PARM
)); \

85 
	`NdisMoveMem‹y
(&
_pAd
->
P‹tCfg
.
APQbssLﬂd
, &_pAd->
MlmeAux
.APQbssLﬂd, (
QBSS_LOAD_PARM
)); \

86 }

	)

93 
VOID
 
	$MlmeC¡lInô
(

94 
IN
 
PRTMP_ADAPTER
 
pAd
,

95 
IN
 
STATE_MACHINE
 *
S
,

96 
OUT
 
STATE_MACHINE_FUNC
 
Tøns
[])

100 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

101 
	}
}

108 
VOID
 
	$MlmeC¡lMachöePîf‹mA˘i⁄
(

109 
IN
 
PRTMP_ADAPTER
 
pAd
,

110 
IN
 
STATE_MACHINE
 *
S
,

111 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

113 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
)

115 
CNTL_IDLE
:

116 
	`C¡lIdÀProc
(
pAd
, 
EÀm
);

118 
CNTL_WAIT_DISASSOC
:

119 
	`C¡lWaôDißssocProc
(
pAd
, 
EÀm
);

121 
CNTL_WAIT_JOIN
:

122 
	`C¡lWaôJoöProc
(
pAd
, 
EÀm
);

131 
CNTL_WAIT_REASSOC
:

132 
	`C¡lWaôRóssocProc
(
pAd
, 
EÀm
);

135 
CNTL_WAIT_START
:

136 
	`C¡lWaôSèπProc
(
pAd
, 
EÀm
);

138 
CNTL_WAIT_AUTH
:

139 
	`C¡lWaôAuthProc
(
pAd
, 
EÀm
);

141 
CNTL_WAIT_AUTH2
:

142 
	`C¡lWaôAuthProc2
(
pAd
, 
EÀm
);

144 
CNTL_WAIT_ASSOC
:

145 
	`C¡lWaôAssocProc
(
pAd
, 
EÀm
);

148 
CNTL_WAIT_OID_LIST_SCAN
:

149 if(
EÀm
->
MsgTy≥
 =
MT2_SCAN_CONF
)

153 
	`RTUSBResumeMsduTønsmissi⁄
(
pAd
);

155 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

156 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


157 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

159 
iwªq_d©a
 
wrqu
;

161 
wrqu
.
d©a
.
Àngth
 = 0;

162 
wrqu
.
d©a
.
Êags
 = 0;

164 
	`wúñess_£nd_evít
(
pAd
->
√t_dev
, 
SIOCGIWSCAN
, &
wrqu
, 
NULL
);

172 
CNTL_WAIT_OID_DISASSOC
:

173 i‡(
EÀm
->
MsgTy≥
 =
MT2_DISASSOC_CONF
)

175 
	`LökDown
(
pAd
, 
FALSE
);

176 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

181 
	`DBGPRINT_ERR
("!ERROR! CNTL - IŒegÆ mesßgêty≥(=%d)", 
EÀm
->
MsgTy≥
);

184 
	}
}

191 
VOID
 
	$C¡lIdÀProc
(

192 
IN
 
PRTMP_ADAPTER
 
pAd
,

193 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

195 
MLME_DISASSOC_REQ_STRUCT
 
DißssocReq
;

197 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
))

199 i‡(
pAd
->
MlmeAux
.
CuºReqIsFromNdis
)

200 
pAd
->
MlmeAux
.
CuºReqIsFromNdis
 = 
FALSE
;

204 
EÀm
->
MsgTy≥
)

206 
OID_802_11_SSID
:

207 
	`C¡lOidSsidProc
(
pAd
, 
EÀm
);

210 
OID_802_11_BSSID
:

211 
	`C¡lOidRTBssidProc
(
pAd
,
EÀm
);

214 
OID_802_11_BSSID_LIST_SCAN
:

215 
	`C¡lOidSˇnProc
(
pAd
,
EÀm
);

218 
OID_802_11_DISASSOCIATE
:

219 
	`DißssocP¨mFûl
(
pAd
, &
DißssocReq
,ÖAd->
P‹tCfg
.
Bssid
, 
REASON_DISASSOC_STA_LEAVING
);

220 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_MLME_DISASSOC_REQ
,

221 (
MLME_DISASSOC_REQ_STRUCT
), &
DißssocReq
);

222 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_OID_DISASSOC
;

225 
pAd
->
MlmeAux
.
AutoRec⁄√˘SsidLí
= 32;

226 
	`NdisZîoMem‹y
(
pAd
->
MlmeAux
.
AutoRec⁄√˘Ssid
,ÖAd->MlmeAux.
AutoRec⁄√˘SsidLí
);

229 
MT2_MLME_ROAMING_REQ
:

230 
	`C¡lMlmeRﬂmögProc
(
pAd
, 
EÀm
);

233 
OID_802_11_MIC_FAILURE_REPORT_FRAME
:

234 
	`W∑MicFaûuªRï‹tFøme
(
pAd
, 
EÀm
);

239 
MT2_DISASSOC_CONF
:

240 if(
	`INFRA_ON
(
pAd
Ë|| 
	`ADHOC_ON
(pAd))

241 
	`LökDown
(
pAd
, 
FALSE
);

244 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - IŒegÆ mesßgêö C¡lIdÀProc(MsgTy≥=%d)\n",
EÀm
->
MsgTy≥
);

247 
	}
}

249 
VOID
 
	$C¡lOidSˇnProc
(

250 
IN
 
PRTMP_ADAPTER
 
pAd
,

251 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

253 
MLME_SCAN_REQ_STRUCT
 
SˇnReq
;

254 
ULONG
 
BssIdx
 = 
BSS_NOT_FOUND
;

255 
BSS_ENTRY
 
CuºBss
;

257 
	`DBGPRINT
(
RT_DEBUG_INFO
, "CNTL - SCAN starts\n");

261 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

263 
BssIdx
 = 
	`BssSsidTabÀSórch
(&
pAd
->
SˇnTab
,ÖAd->
P‹tCfg
.
Bssid
,ÖAd->P‹tCfg.
Ssid
,ÖAd->P‹tCfg.
SsidLí
,ÖAd->P‹tCfg.
Ch™√l
);

264 i‡(
BssIdx
 !
BSS_NOT_FOUND
)

266 
	`NdisMoveMem‹y
(&
CuºBss
, &
pAd
->
SˇnTab
.
BssE¡ry
[
BssIdx
], (
BSS_ENTRY
));

276 
	`BssTabÀInô
(&
pAd
->
SˇnTab
);

278 i‡(
BssIdx
 !
BSS_NOT_FOUND
)

285 
	`NdisMoveMem‹y
(&
pAd
->
SˇnTab
.
BssE¡ry
[0], &
CuºBss
, (
BSS_ENTRY
));

286 
pAd
->
SˇnTab
.
BssNr
 = 1;

289 
	`SˇnP¨mFûl
(
pAd
, &
SˇnReq
, "", 0, 
BSS_ANY
, 
SCAN_ACTIVE
);

290 
	`MlmeEnqueue
(
pAd
, 
SYNC_STATE_MACHINE
, 
MT2_MLME_SCAN_REQ
,

291 (
MLME_SCAN_REQ_STRUCT
), &
SˇnReq
);

292 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_OID_LIST_SCAN
;

293 
	}
}

302 
VOID
 
	$C¡lOidSsidProc
(

303 
IN
 
PRTMP_ADAPTER
 
pAd
,

304 
IN
 
MLME_QUEUE_ELEM
 * 
EÀm
)

306 
PNDIS_802_11_SSID
 
pOidSsid
 = (
NDIS_802_11_SSID
 *)
EÀm
->
Msg
;

307 
MLME_DISASSOC_REQ_STRUCT
 
DißssocReq
;

308 
ULONG
 
Now
;

313 
	`NdisZîoMem‹y
(
pAd
->
MlmeAux
.
Ssid
, 
MAX_LEN_OF_SSID
+1);

314 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
Ssid
, 
pOidSsid
->Ssid,ÖOidSsid->
SsidLígth
);

315 
pAd
->
MlmeAux
.
SsidLí
 = (
UCHAR
)
pOidSsid
->
SsidLígth
;

316 
	`NdisZîoMem‹y
(
pAd
->
MlmeAux
.
Bssid
, 
MAC_ADDR_LEN
);

317 
pAd
->
MlmeAux
.
BssTy≥
 =ÖAd->
P‹tCfg
.BssType;

322 
	`NdisZîoMem‹y
(
pAd
->
MlmeAux
.
AutoRec⁄√˘Ssid
, 
MAX_LEN_OF_SSID
+1);

323 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
AutoRec⁄√˘Ssid
,ÖAd->MlmeAux.
Ssid
,ÖAd->MlmeAux.
SsidLí
);

324 
pAd
->
MlmeAux
.
AutoRec⁄√˘SsidLí
 =ÖAd->MlmeAux.
SsidLí
;

329 
	`BssTabÀSsidS‹t
(
pAd
, &pAd->
MlmeAux
.
SsidBssTab
,ÖAd->MlmeAux.
Ssid
,ÖAd->MlmeAux.
SsidLí
);

331 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - %d BSS m©chÅhêdesúêSSID - %s\n",
pAd
->
MlmeAux
.
SsidBssTab
.
BssNr
,ÖAd->MlmeAux.
Ssid
);

333 
Now
 = 
jiffõs
;

335 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
) &&

336 (
pAd
->
P‹tCfg
.
SsidLí
 =pAd->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[0].SsidLen) &&

337 
	`NdisEquÆMem‹y
(
pAd
->
P‹tCfg
.
Ssid
,ÖAd->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[0].Ssid,ÖAd->P‹tCfg.
SsidLí
) &&

338 
	`MAC_ADDR_EQUAL
(
pAd
->
P‹tCfg
.
Bssid
,ÖAd->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[0].Bssid))

343 i‡(((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA
) ||

344 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAPSK
) ||

345 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2
) ||

346 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2PSK
)

347 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


348 || (
pAd
->
P‹tCfg
.
IEEE8021X
 =
TRUE
)

351 (
pAd
->
P‹tCfg
.
P‹tSecuªd
 =
WPA_802_1X_PORT_NOT_SECURED
))

355 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - disassociate with current AP...\n");

356 
	`DißssocP¨mFûl
(
pAd
, &
DißssocReq
,ÖAd->
P‹tCfg
.
Bssid
, 
REASON_DISASSOC_STA_LEAVING
);

357 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_MLME_DISASSOC_REQ
,

358 (
MLME_DISASSOC_REQ_STRUCT
), &
DißssocReq
);

359 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_DISASSOC
;

361 i‡(
pAd
->
bC⁄figCh™ged
 =
TRUE
)

364 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - disassociate with current AP Because config changed...\n");

365 
	`DißssocP¨mFûl
(
pAd
, &
DißssocReq
,ÖAd->
P‹tCfg
.
Bssid
, 
REASON_DISASSOC_STA_LEAVING
);

366 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_MLME_DISASSOC_REQ
,

367 (
MLME_DISASSOC_REQ_STRUCT
), &
DißssocReq
);

368 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_DISASSOC
;

373 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL -álready withÅhis BSSID. ignoreÅhis SET_SSIDÑequest\n");

375 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

377 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


381 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - disassociate with current AP...\n");

382 
	`DißssocP¨mFûl
(
pAd
, &
DißssocReq
,ÖAd->
P‹tCfg
.
Bssid
, 
REASON_DISASSOC_STA_LEAVING
);

383 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_MLME_DISASSOC_REQ
,

384 (
MLME_DISASSOC_REQ_STRUCT
), &
DißssocReq
);

385 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_DISASSOC
;

387 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

388 
	`wext_nŸify_evít_assoc
(
pAd
, 
SIOCGIWAP
, 
TRUE
);

393 i‡(
	`INFRA_ON
(
pAd
))

395 i‡(!
	`SSID_EQUAL
(
pAd
->
P‹tCfg
.
Ssid
,ÖAd->P‹tCfg.
SsidLí
,ÖAd->
MlmeAux
.Ssid,ÖAd->MlmeAux.SsidLen))

400 
pAd
->
MlmeAux
.
CuºReqIsFromNdis
 = 
TRUE
;

409 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - disassociate with current AP...\n");

410 
	`DißssocP¨mFûl
(
pAd
, &
DißssocReq
,ÖAd->
P‹tCfg
.
Bssid
, 
REASON_DISASSOC_STA_LEAVING
);

411 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_MLME_DISASSOC_REQ
,

412 (
MLME_DISASSOC_REQ_STRUCT
), &
DißssocReq
);

413 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_DISASSOC
;

417 i‡(
	`ADHOC_ON
(
pAd
))

419 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - drop current ADHOC\n");

420 
	`LökDown
(
pAd
, 
FALSE
);

421 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
);

422 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "NDIS_STATUS_MEDIA_DISCONNECT Event C!\n");

425 i‡((
pAd
->
MlmeAux
.
SsidBssTab
.
BssNr
 == 0) &&

426 (
pAd
->
P‹tCfg
.
bAutoRec⁄√˘
 =
TRUE
) &&

427 (
pAd
->
MlmeAux
.
BssTy≥
 =
BSS_INFRA
) &&

428 (
	`MlmeVÆid©eSSID
(
pAd
->
MlmeAux
.
Ssid
,ÖAd->MlmeAux.
SsidLí
Ë=
TRUE
))

430 
MLME_SCAN_REQ_STRUCT
 
SˇnReq
;

432 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - No matching BSS, startáÇew scan\n");

435 
	`SˇnP¨mFûl
(
pAd
, &
SˇnReq
,ÖAd->
MlmeAux
.
Ssid
,ÖAd->MlmeAux.
SsidLí
, 
BSS_ANY
, 
SCAN_ACTIVE
);

436 
	`MlmeEnqueue
(
pAd
, 
SYNC_STATE_MACHINE
, 
MT2_MLME_SCAN_REQ
,

437 (
MLME_SCAN_REQ_STRUCT
), &
SˇnReq
);

438 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_OID_LIST_SCAN
;

441 
pAd
->
P‹tCfg
.
La°SˇnTime
 = 
Now
;

445 
pAd
->
MlmeAux
.
BssIdx
 = 0;

446 
	`IãøãOnBssTab
(
pAd
);

449 
	}
}

456 
VOID
 
	$C¡lOidRTBssidProc
(

457 
IN
 
PRTMP_ADAPTER
 
pAd
,

458 
IN
 
MLME_QUEUE_ELEM
 * 
EÀm
)

460 
ULONG
 
BssIdx
;

461 
PUCHAR
 
pOidBssid
 = (PUCHAR)
EÀm
->
Msg
;

462 
MLME_DISASSOC_REQ_STRUCT
 
DißssocReq
;

463 
MLME_JOIN_REQ_STRUCT
 
JoöReq
;

465 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - CntlOidRTBssidProc ...\n");

467 
	`COPY_MAC_ADDR
(
pAd
->
MlmeAux
.
Bssid
, 
pOidBssid
);

468 
pAd
->
MlmeAux
.
BssTy≥
 =ÖAd->
P‹tCfg
.BssType;

471 
BssIdx
 = 
	`BssTabÀSórch
(&
pAd
->
SˇnTab
, 
pOidBssid
,ÖAd->
MlmeAux
.
Ch™√l
);

472 i‡(
BssIdx
 =
BSS_NOT_FOUND
)

474 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - BSSIDÇot found.Ñeply NDIS_STATUS_NOT_ACCEPTED\n");

475 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

481 
pAd
->
MlmeAux
.
BssIdx
 = 0;

482 
pAd
->
MlmeAux
.
SsidBssTab
.
BssNr
 = 1;

483 
	`NdisMoveMem‹y
(&
pAd
->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[0], &pAd->
SˇnTab
.BssE¡ry[
BssIdx
], (
BSS_ENTRY
));

488 
pAd
->
MlmeAux
.
AutoRec⁄√˘SsidLí
 =ÖAd->
SˇnTab
.
BssE¡ry
[
BssIdx
].
SsidLí
;

489 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
AutoRec⁄√˘Ssid
,ÖAd->
SˇnTab
.
BssE¡ry
[
BssIdx
].
Ssid
,ÖAd->SˇnTab.BssE¡ry[BssIdx].
SsidLí
);

492 
pAd
->
MlmeAux
.
SsidLí
 =ÖAd->
SˇnTab
.
BssE¡ry
[
BssIdx
].SsidLen;

493 
	`NdisZîoMem‹y
(
pAd
->
MlmeAux
.
Ssid
, 
MAX_LEN_OF_SSID
);

494 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
Ssid
,ÖAd->
SˇnTab
.
BssE¡ry
[
BssIdx
].Ssid,ÖAd->MlmeAux.
SsidLí
);

503 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
) &&

504 
	`MAC_ADDR_EQUAL
(
pAd
->
P‹tCfg
.
Bssid
, 
pOidBssid
))

507 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL -álready inÅhis BSSID. ignoreÅhis SET_BSSIDÑequest\n");

508 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

510 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


514 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

515 
	`wext_nŸify_evít_assoc
(
pAd
, 
SIOCGIWAP
, 
TRUE
);

521 i‡(
	`INFRA_ON
(
pAd
))

524 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - disassociate with current AP ...\n");

525 
	`DißssocP¨mFûl
(
pAd
, &
DißssocReq
,ÖAd->
P‹tCfg
.
Bssid
, 
REASON_DISASSOC_STA_LEAVING
);

526 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_MLME_DISASSOC_REQ
,

527 (
MLME_DISASSOC_REQ_STRUCT
), &
DißssocReq
);

529 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_DISASSOC
;

533 i‡(
	`ADHOC_ON
(
pAd
))

535 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - drop current ADHOC\n");

536 
	`LökDown
(
pAd
, 
FALSE
);

537 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
);

538 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "NDIS_STATUS_MEDIA_DISCONNECT Event C!\n");

543 
pAd
->
P‹tCfg
.
WïSètus
 =ÖAd->P‹tCfg.
OrigWïSètus
;

544 
pAd
->
P‹tCfg
.
PaúCùhî
 =ÖAd->P‹tCfg.
OrigWïSètus
;

545 
pAd
->
P‹tCfg
.
GroupCùhî
 =ÖAd->P‹tCfg.
OrigWïSètus
;

550 i‡((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA
Ë|| (pAd->P‹tCfg.AuthModê=
Ndis802_11AuthModeWPAPSK
))

552 
pAd
->
P‹tCfg
.
GroupCùhî
 =ÖAd->
SˇnTab
.
BssE¡ry
[
BssIdx
].
WPA
.GroupCipher;

554 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =pAd->
SˇnTab
.
BssE¡ry
[
BssIdx
].
WPA
.
PaúCùhî
)

555 
pAd
->
P‹tCfg
.
PaúCùhî
 =ÖAd->
SˇnTab
.
BssE¡ry
[
BssIdx
].
WPA
.PairCipher;

556 i‡(
pAd
->
SˇnTab
.
BssE¡ry
[
BssIdx
].
WPA
.
PaúCùhîAux
 !
Ndis802_11WEPDißbÀd
)

557 
pAd
->
P‹tCfg
.
PaúCùhî
 =ÖAd->
SˇnTab
.
BssE¡ry
[
BssIdx
].
WPA
.
PaúCùhîAux
;

559 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

561 i‡((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2
Ë|| (pAd->P‹tCfg.AuthModê=
Ndis802_11AuthModeWPA2PSK
))

563 
pAd
->
P‹tCfg
.
GroupCùhî
 =ÖAd->
SˇnTab
.
BssE¡ry
[
BssIdx
].
WPA2
.GroupCipher;

565 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =pAd->
SˇnTab
.
BssE¡ry
[
BssIdx
].
WPA2
.
PaúCùhî
)

566 
pAd
->
P‹tCfg
.
PaúCùhî
 =ÖAd->
SˇnTab
.
BssE¡ry
[
BssIdx
].
WPA2
.PairCipher;

567 i‡(
pAd
->
SˇnTab
.
BssE¡ry
[
BssIdx
].
WPA2
.
PaúCùhîAux
 !
Ndis802_11WEPDißbÀd
)

568 
pAd
->
P‹tCfg
.
PaúCùhî
 =ÖAd->
SˇnTab
.
BssE¡ry
[
BssIdx
].
WPA2
.
PaúCùhîAux
;

570 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

573 
pAd
->
P‹tCfg
.
R¢C≠abûôy
 =ÖAd->
SˇnTab
.
BssE¡ry
[
BssIdx
].
WPA2
.RsnCapability;

576 i‡(
pAd
->
P‹tCfg
.
PaúCùhî
 !pAd->P‹tCfg.
GroupCùhî
)

577 
pAd
->
P‹tCfg
.
bMixCùhî
 = 
TRUE
;

581 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - joining %02x:%02x:%02x:%02x:%02x:%02x ...\n",

582 
pOidBssid
[0],pOidBssid[1],pOidBssid[2],pOidBssid[3],pOidBssid[4],pOidBssid[5]);

584 
	`JoöP¨mFûl
(
pAd
, &
JoöReq
,ÖAd->
MlmeAux
.
BssIdx
);

585 
	`MlmeEnqueue
(
pAd
, 
SYNC_STATE_MACHINE
, 
MT2_MLME_JOIN_REQ
,

586 (
MLME_JOIN_REQ_STRUCT
), &
JoöReq
);

588 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_JOIN
;

591 
	}
}

599 
VOID
 
	$C¡lMlmeRﬂmögProc
(

600 
IN
 
PRTMP_ADAPTER
 
pAd
,

601 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

606 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"CNTL - Roaming in MlmeAux.RoamTab...\n");

608 
	`NdisMoveMem‹y
(&
pAd
->
MlmeAux
.
SsidBssTab
, &pAd->MlmeAux.
RﬂmTab
, (pAd->MlmeAux.RoamTab));

609 
pAd
->
MlmeAux
.
SsidBssTab
.
BssNr
 =ÖAd->MlmeAux.
RﬂmTab
.BssNr;

611 
	`BssTabÀS‹tByRssi
(&
pAd
->
MlmeAux
.
SsidBssTab
);

612 
pAd
->
MlmeAux
.
BssIdx
 = 0;

613 
	`IãøãOnBssTab
(
pAd
);

614 
	}
}

621 
VOID
 
	$C¡lWaôDißssocProc
(

622 
IN
 
PRTMP_ADAPTER
 
pAd
,

623 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

625 
MLME_START_REQ_STRUCT
 
SèπReq
;

626 
	`¥ötk
("callingÜinkdown\n");

627 i‡(
EÀm
->
MsgTy≥
 =
MT2_DISASSOC_CONF
)

630 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - Dis-associate successful\n");

631 
	`LökDown
(
pAd
, 
FALSE
);

634 i‡((
pAd
->
MlmeAux
.
SsidBssTab
.
BssNr
==0Ë&& (pAd->
P‹tCfg
.
BssTy≥
 =
BSS_ADHOC
))

636 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - Nÿm©chög BSS, sèπáÇew ADHOC (Ssid=%s)...\n",
pAd
->
MlmeAux
.
Ssid
);

637 
	`SèπP¨mFûl
(
pAd
, &
SèπReq
,ÖAd->
MlmeAux
.
Ssid
,ÖAd->MlmeAux.
SsidLí
);

638 
	`MlmeEnqueue
(
pAd
, 
SYNC_STATE_MACHINE
, 
MT2_MLME_START_REQ
,

639 (
MLME_START_REQ_STRUCT
), &
SèπReq
);

640 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_START
;

645 
pAd
->
MlmeAux
.
BssIdx
 = 0;

646 
	`IãøãOnBssTab
(
pAd
);

649 
	}
}

656 
VOID
 
	$C¡lWaôJoöProc
(

657 
IN
 
PRTMP_ADAPTER
 
pAd
,

658 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

660 
USHORT
 
Rós⁄
;

661 
MLME_AUTH_REQ_STRUCT
 
AuthReq
;

663 i‡(
EÀm
->
MsgTy≥
 =
MT2_JOIN_CONF
)

665 
	`NdisMoveMem‹y
(&
Rós⁄
, 
EÀm
->
Msg
, (
USHORT
));

666 i‡(
Rós⁄
 =
MLME_SUCCESS
)

669 i‡(
pAd
->
MlmeAux
.
BssTy≥
 =
BSS_ADHOC
)

671 
	`LökUp
(
pAd
, 
BSS_ADHOC
);

672 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

673 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - joinÅhe IBSS = %02x:%02x:%02x:%02x:%02x:%02x ...\n",

674 
pAd
->
P‹tCfg
.
Bssid
[0],pAd->PortCfg.Bssid[1],pAd->PortCfg.Bssid[2],

675 
pAd
->
P‹tCfg
.
Bssid
[3],pAd->PortCfg.Bssid[4],pAd->PortCfg.Bssid[5]);

681 i‡((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeSh¨ed
) ||

682 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeAutoSwôch
))

684 
	`AuthP¨mFûl
(
pAd
, &
AuthReq
,ÖAd->
MlmeAux
.
Bssid
, 
Ndis802_11AuthModeSh¨ed
);

688 
	`AuthP¨mFûl
(
pAd
, &
AuthReq
,ÖAd->
MlmeAux
.
Bssid
, 
Ndis802_11AuthModeO≥n
);

691 
	`MlmeEnqueue
(
pAd
, 
AUTH_STATE_MACHINE
, 
MT2_MLME_AUTH_REQ
,

692 (
MLME_AUTH_REQ_STRUCT
), &
AuthReq
);

694 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_AUTH
;

700 
pAd
->
MlmeAux
.
BssIdx
++;

701 
	`IãøãOnBssTab
(
pAd
);

704 
	}
}

711 
VOID
 
	$C¡lWaôSèπProc
(

712 
IN
 
PRTMP_ADAPTER
 
pAd
,

713 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

715 
USHORT
 
Resu…
;

717 i‡(
EÀm
->
MsgTy≥
 =
MT2_START_CONF
)

719 
	`NdisMoveMem‹y
(&
Resu…
, 
EÀm
->
Msg
, (
USHORT
));

720 i‡(
Resu…
 =
MLME_SUCCESS
)

722 
	`LökUp
(
pAd
, 
BSS_ADHOC
);

723 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

726 i‡(((
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11A
Ë|| (pAd->P‹tCfg.PhyModê=
PHY_11ABG_MIXED
))&& (pAd->P‹tCfg.
bIEEE80211H
 =1Ë&& 
	`Rad¨Ch™√lCheck
’Ad,ÖAd->P‹tCfg.
Ch™√l
))

728 
pAd
->
P‹tCfg
.
Rad¨Dëe˘
.
RDMode
 = 
RD_SILENCE_MODE
;

729 
pAd
->
P‹tCfg
.
Rad¨Dëe˘
.
RDCou¡
 = 0;

730 
	`Rad¨Dëe˘i⁄Sèπ
(
pAd
);

733 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - startáÇew IBSS = %02x:%02x:%02x:%02x:%02x:%02x ...\n",

734 
pAd
->
P‹tCfg
.
Bssid
[0],pAd->PortCfg.Bssid[1],pAd->PortCfg.Bssid[2],

735 
pAd
->
P‹tCfg
.
Bssid
[3],pAd->PortCfg.Bssid[4],pAd->PortCfg.Bssid[5]);

739 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - Start IBSS fail. BUG!!!!!\n");

740 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

743 
	}
}

750 
VOID
 
	$C¡lWaôAuthProc
(

751 
IN
 
PRTMP_ADAPTER
 
pAd
,

752 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

754 
USHORT
 
Rós⁄
;

755 
MLME_ASSOC_REQ_STRUCT
 
AssocReq
;

756 
MLME_AUTH_REQ_STRUCT
 
AuthReq
;

758 i‡(
EÀm
->
MsgTy≥
 =
MT2_AUTH_CONF
)

760 
	`NdisMoveMem‹y
(&
Rós⁄
, 
EÀm
->
Msg
, (
USHORT
));

761 i‡(
Rós⁄
 =
MLME_SUCCESS
)

763 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - AUTH OK\n");

764 
	`AssocP¨mFûl
(
pAd
, &
AssocReq
,ÖAd->
MlmeAux
.
Bssid
,ÖAd->MlmeAux.
C≠abûôyInfo
,

765 
ASSOC_TIMEOUT
, 
pAd
->
P‹tCfg
.
DeÁu…Li°íCou¡
);

767 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_MLME_ASSOC_REQ
,

768 (
MLME_ASSOC_REQ_STRUCT
), &
AssocReq
);

770 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_ASSOC
;

778 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - AUTH FAIL,Åryágain...\n");

780 i‡((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeSh¨ed
) ||

781 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeAutoSwôch
))

784 
	`AuthP¨mFûl
(
pAd
, &
AuthReq
,ÖAd->
MlmeAux
.
Bssid
, 
Ndis802_11AuthModeSh¨ed
);

788 
	`AuthP¨mFûl
(
pAd
, &
AuthReq
,ÖAd->
MlmeAux
.
Bssid
, 
Ndis802_11AuthModeO≥n
);

791 
	`MlmeEnqueue
(
pAd
, 
AUTH_STATE_MACHINE
, 
MT2_MLME_AUTH_REQ
,

792 (
MLME_AUTH_REQ_STRUCT
), &
AuthReq
);

794 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_AUTH2
;

797 
	}
}

804 
VOID
 
	$C¡lWaôAuthProc2
(

805 
IN
 
PRTMP_ADAPTER
 
pAd
,

806 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

808 
USHORT
 
Rós⁄
;

809 
MLME_ASSOC_REQ_STRUCT
 
AssocReq
;

810 
MLME_AUTH_REQ_STRUCT
 
AuthReq
;

812 i‡(
EÀm
->
MsgTy≥
 =
MT2_AUTH_CONF
)

814 
	`NdisMoveMem‹y
(&
Rós⁄
, 
EÀm
->
Msg
, (
USHORT
));

815 i‡(
Rós⁄
 =
MLME_SUCCESS
)

817 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - AUTH OK\n");

818 
	`AssocP¨mFûl
(
pAd
, &
AssocReq
,ÖAd->
MlmeAux
.
Bssid
,ÖAd->MlmeAux.
C≠abûôyInfo
,

819 
ASSOC_TIMEOUT
, 
pAd
->
P‹tCfg
.
DeÁu…Li°íCou¡
);

820 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_MLME_ASSOC_REQ
,

821 (
MLME_ASSOC_REQ_STRUCT
), &
AssocReq
);

823 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_ASSOC
;

828 i‡((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeAutoSwôch
) &&

829 (
pAd
->
MlmeAux
.
Alg
 =
Ndis802_11AuthModeSh¨ed
))

831 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - AUTH FAIL,Åry OPEN system...\n");

832 
	`AuthP¨mFûl
(
pAd
, &
AuthReq
,ÖAd->
MlmeAux
.
Bssid
, 
Ndis802_11AuthModeO≥n
);

833 
	`MlmeEnqueue
(
pAd
, 
AUTH_STATE_MACHINE
, 
MT2_MLME_AUTH_REQ
,

834 (
MLME_AUTH_REQ_STRUCT
), &
AuthReq
);

836 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_AUTH2
;

841 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - AUTH FAIL, give up;ÅryÇext BSS\n");

844 
pAd
->
MlmeAux
.
BssIdx
++;

845 
	`IãøãOnBssTab
(
pAd
);

849 
	}
}

856 
VOID
 
	$C¡lWaôAssocProc
(

857 
IN
 
PRTMP_ADAPTER
 
pAd
,

858 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

860 
USHORT
 
Rós⁄
;

862 i‡(
EÀm
->
MsgTy≥
 =
MT2_ASSOC_CONF
)

864 
	`NdisMoveMem‹y
(&
Rós⁄
, 
EÀm
->
Msg
, (
USHORT
));

865 i‡(
Rós⁄
 =
MLME_SUCCESS
)

867 
	`LökUp
(
pAd
, 
BSS_INFRA
);

868 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

869 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - Assocüti⁄ suc˚ssfu»⁄ BSS #%d\n",
pAd
->
MlmeAux
.
BssIdx
);

874 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - Assocüti⁄ faû†⁄ BSS #%d\n",
pAd
->
MlmeAux
.
BssIdx
);

875 
pAd
->
MlmeAux
.
BssIdx
++;

876 
	`IãøãOnBssTab
(
pAd
);

879 
	}
}

886 
VOID
 
	$C¡lWaôRóssocProc
(

887 
IN
 
PRTMP_ADAPTER
 
pAd
,

888 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

890 
USHORT
 
Resu…
;

892 i‡(
EÀm
->
MsgTy≥
 =
MT2_REASSOC_CONF
)

894 
	`NdisMoveMem‹y
(&
Resu…
, 
EÀm
->
Msg
, (
USHORT
));

895 i‡(
Resu…
 =
MLME_SUCCESS
)

900 
	`LökUp
(
pAd
, 
BSS_INFRA
);

902 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

903 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - Re-assocôi⁄ suc˚ssfu»⁄ BSS #%d\n", 
pAd
->
MlmeAux
.
RﬂmIdx
);

908 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - Re-assocôi⁄ faû†⁄ BSS #%d\n", 
pAd
->
MlmeAux
.
RﬂmIdx
);

909 
pAd
->
MlmeAux
.
RﬂmIdx
++;

910 
	`IãøãOnBssTab2
(
pAd
);

913 
	}
}

920 
VOID
 
	$LökUp
(

921 
IN
 
PRTMP_ADAPTER
 
pAd
,

922 
IN
 
UCHAR
 
BssTy≥
)

924 
ULONG
 
Now
;

925 
BOOLEAN
 
C™˚Œed
;

926 
TXRX_CSR4_STRUC
 
NewTxRxC§4
, 
CurTxRxC§4
;

937 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
DißssocTimî
, &
C™˚Œed
);

939 
	`COPY_SETTINGS_FROM_MLME_AUX_TO_ACTIVE_CFG
(
pAd
);

940 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "!!! LINK UP !!! (Infra=%d, AID=%d, ssid=%s)\n",

941 
BssTy≥
, 
pAd
->
A˘iveCfg
.
Aid
,ÖAd->
P‹tCfg
.
Ssid
);

944 i‡(
BssTy≥
 =
BSS_ADHOC
)

946 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_ADHOC_ON
);

947 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_INFRA_ON
);

948 
	`AsicSëBssid
(
pAd
,ÖAd->
P‹tCfg
.
Bssid
);

952 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_INFRA_ON
);

953 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_ADHOC_ON
);

956 
	`AsicSëBssid
(
pAd
,ÖAd->
P‹tCfg
.
Bssid
);

959 
	`AsicSëSlŸTime
(
pAd
, (
BOOLEAN
ÌAd->
P‹tCfg
.
U£Sh‹tSlŸTime
);

960 
	`AsicSëEdˇP¨m
(
pAd
, &pAd->
P‹tCfg
.
APEdˇP¨m
);

962 
	`MlmeUpd©eTxR©es
(
pAd
, 
TRUE
);

963 
	`NdisZîoMem‹y
(&
pAd
->
DrsCou¡îs
, (
COUNTER_DRS
));

965 
Now
 = 
jiffõs
;

966 
pAd
->
P‹tCfg
.
La°Bóc⁄RxTime
 = 
Now
;

968 i‡((
pAd
->
P‹tCfg
.
TxPªambÀ
 !
Rt802_11PªambÀL⁄g
) &&

969 
	`CAP_IS_SHORT_PREAMBLE_ON
(
pAd
->
A˘iveCfg
.
C≠abûôyInfo
))

972 
	`DBGPRINT
(
RT_DEBUG_INFO
, "CNTL - !!! SetÅo shortÖreamble!!!\n");

973 
	`MlmeSëTxPªambÀ
(
pAd
, 
Rt802_11PªambÀSh‹t
);

976 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_AGGREGATION_INUSED
);

978 i‡(
pAd
->
P‹tCfg
.
Rad¨Dëe˘
.
RDMode
 =
RD_SILENCE_MODE
)

980 
	`Rad¨Dëe˘i⁄St›
(
pAd
);

982 
pAd
->
P‹tCfg
.
Rad¨Dëe˘
.
RDMode
 = 
RD_NORMAL_MODE
;

984 i‡(
BssTy≥
 =
BSS_ADHOC
)

991 
	`RTMPC™˚lTimî
(&
pAd
->
Mlme
.
LökDownTimî
, &
C™˚Œed
);

993 
	`MakeIbssBóc⁄
(
pAd
);

995 i‡(((
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11A
Ë|| (pAd->P‹tCfg.PhyModê=
PHY_11ABG_MIXED
))&& (pAd->P‹tCfg.
bIEEE80211H
 =1Ë&& 
	`Rad¨Ch™√lCheck
’Ad,ÖAd->P‹tCfg.
Ch™√l
))

1001 
	`AsicE«bÀIbssSync
(
pAd
);

1005 #ifdef 
SINGLE_ADHOC_LINKUP


1008 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
);

1011 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


1013 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

1014 
	`wext_nŸify_evít_assoc
(
pAd
, 
SIOCGIWAP
, 
TRUE
);

1021 
	`RTMPC™˚lTimî
(&
pAd
->
Mlme
.
LökDownTimî
, &
C™˚Œed
);

1024 i‡(
C™˚Œed
)

1026 i‡((
pAd
->
P‹tCfg
.
La°SsidLí
 !pAd->P‹tCfg.
SsidLí
) ||

1027 ((
pAd
->
P‹tCfg
.
La°SsidLí
 =pAd->P‹tCfg.
SsidLí
) &&

1028 (
	`RTMPCom∑ªMem‹y
(
pAd
->
P‹tCfg
.
La°Ssid
,ÖAd->P‹tCfg.
Ssid
,ÖAd->P‹tCfg.
La°SsidLí
) != 0)))

1031 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "NDIS_STATUS_MEDIA_DISCONNECT Event AA!\n");

1039 i‡((
pAd
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
) &&

1040 (!
	`RTMPEquÆMem‹y
(
pAd
->
P‹tCfg
.
La°Bssid
,ÖAd->P‹tCfg.
Bssid
, 
MAC_ADDR_LEN
)))

1043 
	`RTMPWPARemoveAŒKeys
(
pAd
);

1044 
pAd
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_NOT_SECURED
;

1047 
	`COPY_MAC_ADDR
(
pAd
->
P‹tCfg
.
La°Bssid
,ÖAd->P‹tCfg.
Bssid
);

1058 
	`Compo£PsPﬁl
(
pAd
);

1059 
	`Compo£NuŒFøme
(
pAd
);

1060 
	`AsicE«bÀBssSync
(
pAd
);

1064 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
);

1066 i‡(
pAd
->
P‹tCfg
.
bAggªg©i⁄C≠abÀ
 && (pAd->
MlmeAux
.
APRÆökIe
 & 0x00000001))

1067 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_AGGREGATION_INUSED
);

1070 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "NDIS_STATUS_MEDIA_CONNECT Event B!\n");

1073 
	`RTMPSëLED
(
pAd
, 
LED_LINK_UP
);

1078 
	`RTUSBRódMACRegi°î
(
pAd
, 
TXRX_CSR4
, &
CurTxRxC§4
.
w‹d
);

1079 
NewTxRxC§4
.
w‹d
 = 
CurTxRxC§4
.word;

1080 i‡((
pAd
->
P‹tCfg
.
Ch™√l
 <= 14) &&

1081 ((
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11B
) ||

1082 (
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11BG_MIXED
) ||

1083 (
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11ABG_MIXED
)))

1085 
NewTxRxC§4
.
fõld
.
OfdmTxFÆlbacktoCCK
 = 1;

1089 
NewTxRxC§4
.
fõld
.
OfdmTxFÆlbacktoCCK
 = 0;

1092 i‡(
NewTxRxC§4
.
w‹d
!
CurTxRxC§4
.word)

1093 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR4
, 
NewTxRxC§4
.
w‹d
);

1096 
pAd
->
Mlme
.
PîiodicRound
 = 0;

1097 
pAd
->
bC⁄figCh™ged
 = 
FALSE
;

1098 
pAd
->
ExåaInfo
 = 
GENERAL_LINK_UP
;

1100 
	}
}

1125 
VOID
 
	$LökDown
(

1126 
IN
 
PRTMP_ADAPTER
 
pAd
,

1127 
IN
 
BOOLEAN
 
IsReqFromAP
)

1129 
TXRX_CSR4_STRUC
 
CurTxRxC§4
;

1131 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "!!! LINK DOWN !!!\n");

1133 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_AGGREGATION_INUSED
);

1135 i‡(
	`ADHOC_ON
(
pAd
))

1137 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_ADHOC_ON
);

1139 #ifdef 
SINGLE_ADHOC_LINKUP


1140 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
);

1142 
	`BssTabÀDñëeE¡ry
(&
pAd
->
SˇnTab
, &’Ad->
P‹tCfg
.
Bssid
),ÖAd->P‹tCfg.
Ch™√l
);

1144 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
))

1146 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
);

1147 
	`BssTabÀDñëeE¡ry
(&
pAd
->
SˇnTab
,ÖAd->
P‹tCfg
.
Bssid
,ÖAd->P‹tCfg.
Ch™√l
);

1151 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


1152 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

1153 
	`wext_nŸify_evít_assoc
(
pAd
, 
SIOCGIWAP
, 
FALSE
);

1159 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_INFRA_ON
);

1160 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
);

1162 
pAd
->
P‹tCfg
.
La°SsidLí
 =ÖAd->P‹tCfg.
SsidLí
;

1163 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
La°Ssid
,ÖAd->P‹tCfg.
Ssid
,ÖAd->P‹tCfg.
La°SsidLí
);

1164 
	`COPY_MAC_ADDR
(
pAd
->
P‹tCfg
.
La°Bssid
,ÖAd->P‹tCfg.
Bssid
);

1165 i‡(
pAd
->
MlmeAux
.
CuºReqIsFromNdis
 =
TRUE
)

1167 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "NDIS_STATUS_MEDIA_DISCONNECT Event A!\n");

1168 
pAd
->
MlmeAux
.
CuºReqIsFromNdis
 = 
FALSE
;

1173 
	`RTMPSëTimî
(&
pAd
->
Mlme
.
LökDownTimî
, 10000);

1181 
	`BssTabÀDñëeE¡ry
(&
pAd
->
SˇnTab
,ÖAd->
P‹tCfg
.
Bssid
,ÖAd->P‹tCfg.
Ch™√l
);

1189 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_BG_PROTECTION_INUSED
);

1198 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR9
, 0x0704a414);

1199 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_SHORT_SLOT_INUSED
);

1201 
	`AsicSëSlŸTime
(
pAd
, (
BOOLEAN
ÌAd->
P‹tCfg
.
U£Sh‹tSlŸTime
);

1202 
	`AsicSëEdˇP¨m
(
pAd
, 
NULL
);

1205 
	`RTMPSëLED
(
pAd
, 
LED_LINK_DOWN
);

1207 
	`AsicDißbÀSync
(
pAd
);

1208 
pAd
->
Mlme
.
PîiodicRound
 = 0;

1211 
	`NdisZîoMem‹y
(
pAd
->
P‹tCfg
.
Bssid
, 
MAC_ADDR_LEN
);

1212 
	`NdisZîoMem‹y
(
pAd
->
P‹tCfg
.
Ssid
, 
MAX_LEN_OF_SSID
);

1213 
pAd
->
P‹tCfg
.
SsidLí
 = 0;

1216 i‡(
pAd
->
P‹tCfg
.
W∑Sèã
 !
SS_NOTUSE
)

1218 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_START
;

1220 
	`NdisZîoMem‹y
(
pAd
->
P‹tCfg
.
RïœyCou¡î
, 8);

1227 i‡((
IsReqFromAP
Ë&& (
pAd
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
))

1230 
	`RTMPWPARemoveAŒKeys
(
pAd
);

1234 
pAd
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_NOT_SECURED
;

1235 
pAd
->
P‹tCfg
.
MicEºC¡
 = 0;

1238 
pAd
->
ExåaInfo
 = 
GENERAL_LINK_DOWN
;

1241 
	`NdisZîoMem‹y
(&
pAd
->
P‹tCfg
.
AssocInfo
, (
NDIS_802_11_ASSOCIATION_INFORMATION
));

1242 
pAd
->
P‹tCfg
.
AssocInfo
.
Lígth
 = (
NDIS_802_11_ASSOCIATION_INFORMATION
);

1243 
pAd
->
P‹tCfg
.
ReqV¨IELí
 = 0;

1244 
pAd
->
P‹tCfg
.
ResV¨IELí
 = 0;

1248 
pAd
->
P‹tCfg
.
MlmeR©e
 =ÖAd->P‹tCfg.
BasicMlmeR©e
;

1249 
pAd
->
P‹tCfg
.
RtsR©e
 =ÖAd->P‹tCfg.
BasicMlmeR©e
;

1254 i‡(
pAd
->
MlmeAux
.
Ch™√l
 <= 14)

1256 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17,ÖAd->
BbpTunög
.
R17LowîBoundG
);

1260 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17,ÖAd->
BbpTunög
.
R17LowîBoundA
);

1263 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MAX_RETRY_ENABLED
))

1265 
	`RTUSBRódMACRegi°î
(
pAd
, 
TXRX_CSR4
, &
CurTxRxC§4
.
w‹d
);

1266 
CurTxRxC§4
.
fõld
.
Sh‹tRëryLimô
 = 0x07;

1267 
CurTxRxC§4
.
fõld
.
L⁄gRëryLimô
 = 0x04;

1268 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR4
, 
CurTxRxC§4
.
w‹d
);

1269 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_MAX_RETRY_ENABLED
);

1271 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_RTS_PROTECTION_ENABLE
);

1272 
	}
}

1279 
VOID
 
	$IãøãOnBssTab
(

1280 
IN
 
PRTMP_ADAPTER
 
pAd
)

1282 
MLME_START_REQ_STRUCT
 
SèπReq
;

1283 
MLME_JOIN_REQ_STRUCT
 
JoöReq
;

1284 
ULONG
 
BssIdx
;

1288 
pAd
->
P‹tCfg
.
WïSètus
 =ÖAd->P‹tCfg.
OrigWïSètus
;

1289 
pAd
->
P‹tCfg
.
PaúCùhî
 =ÖAd->P‹tCfg.
OrigWïSètus
;

1290 
pAd
->
P‹tCfg
.
GroupCùhî
 =ÖAd->P‹tCfg.
OrigWïSètus
;

1294 
BssIdx
 = 
pAd
->
MlmeAux
.BssIdx;

1295 i‡(
BssIdx
 < 
pAd
->
MlmeAux
.
SsidBssTab
.
BssNr
)

1300 i‡((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA
Ë|| (pAd->P‹tCfg.AuthModê=
Ndis802_11AuthModeWPAPSK
))

1302 
pAd
->
P‹tCfg
.
GroupCùhî
 =ÖAd->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
BssIdx
].
WPA
.GroupCipher;

1304 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =pAd->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
BssIdx
].
WPA
.
PaúCùhî
)

1305 
pAd
->
P‹tCfg
.
PaúCùhî
 =ÖAd->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
BssIdx
].
WPA
.PairCipher;

1306 i‡(
pAd
->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
BssIdx
].
WPA
.
PaúCùhîAux
 !
Ndis802_11WEPDißbÀd
)

1307 
pAd
->
P‹tCfg
.
PaúCùhî
 =ÖAd->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
BssIdx
].
WPA
.
PaúCùhîAux
;

1309 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

1311 i‡((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2
Ë|| (pAd->P‹tCfg.AuthModê=
Ndis802_11AuthModeWPA2PSK
))

1313 
pAd
->
P‹tCfg
.
GroupCùhî
 =ÖAd->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
BssIdx
].
WPA2
.GroupCipher;

1315 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =pAd->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
BssIdx
].
WPA2
.
PaúCùhî
)

1316 
pAd
->
P‹tCfg
.
PaúCùhî
 =ÖAd->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
BssIdx
].
WPA2
.PairCipher;

1317 i‡(
pAd
->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
BssIdx
].
WPA2
.
PaúCùhîAux
 !
Ndis802_11WEPDißbÀd
)

1318 
pAd
->
P‹tCfg
.
PaúCùhî
 =ÖAd->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
BssIdx
].
WPA2
.
PaúCùhîAux
;

1320 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

1323 
pAd
->
P‹tCfg
.
R¢C≠abûôy
 =ÖAd->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
BssIdx
].
WPA2
.RsnCapability;

1326 i‡(
pAd
->
P‹tCfg
.
PaúCùhî
 !pAd->P‹tCfg.
GroupCùhî
)

1327 
pAd
->
P‹tCfg
.
bMixCùhî
 = 
TRUE
;

1329 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - iãøã BSS %d o‡%d\n", 
BssIdx
, 
pAd
->
MlmeAux
.
SsidBssTab
.
BssNr
);

1330 
	`JoöP¨mFûl
(
pAd
, &
JoöReq
, 
BssIdx
);

1331 
	`MlmeEnqueue
(
pAd
, 
SYNC_STATE_MACHINE
, 
MT2_MLME_JOIN_REQ
, (
MLME_JOIN_REQ_STRUCT
), &
JoöReq
);

1332 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_JOIN
;

1334 i‡(
pAd
->
P‹tCfg
.
BssTy≥
 =
BSS_ADHOC
)

1336 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - AŒ BSS faû; sèπáÇew ADHOC (Ssid=%s)...\n",
pAd
->
MlmeAux
.
Ssid
);

1337 
	`SèπP¨mFûl
(
pAd
, &
SèπReq
,ÖAd->
MlmeAux
.
Ssid
,ÖAd->MlmeAux.
SsidLí
);

1338 
	`MlmeEnqueue
(
pAd
, 
SYNC_STATE_MACHINE
, 
MT2_MLME_START_REQ
, (
MLME_START_REQ_STRUCT
), &
SèπReq
);

1339 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_START
;

1343 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - AŒÑﬂmög faûed, sèy @ ch #%d\n", 
pAd
->
P‹tCfg
.
Ch™√l
);

1344 
	`AsicSwôchCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

1345 
	`AsicLockCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

1346 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

1348 
	}
}

1351 
VOID
 
	$IãøãOnBssTab2
(

1352 
IN
 
PRTMP_ADAPTER
 
pAd
)

1354 
MLME_REASSOC_REQ_STRUCT
 
RóssocReq
;

1355 
ULONG
 
BssIdx
;

1356 
BSS_ENTRY
 *
pBss
;

1358 
BssIdx
 = 
pAd
->
MlmeAux
.
RﬂmIdx
;

1359 
pBss
 = &
pAd
->
MlmeAux
.
RﬂmTab
.
BssE¡ry
[
BssIdx
];

1361 i‡(
BssIdx
 < 
pAd
->
MlmeAux
.
RﬂmTab
.
BssNr
)

1363 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - iãøã BSS %d o‡%d\n", 
BssIdx
, 
pAd
->
MlmeAux
.
RﬂmTab
.
BssNr
);

1365 
	`AsicSwôchCh™√l
(
pAd
, 
pBss
->
Ch™√l
);

1366 
	`AsicLockCh™√l
(
pAd
, 
pBss
->
Ch™√l
);

1369 
	`AssocP¨mFûl
(
pAd
, &
RóssocReq
, 
pBss
->
Bssid
,ÖBss->
C≠abûôyInfo
,

1370 
ASSOC_TIMEOUT
, 
pAd
->
P‹tCfg
.
DeÁu…Li°íCou¡
);

1371 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_MLME_REASSOC_REQ
,

1372 (
MLME_REASSOC_REQ_STRUCT
), &
RóssocReq
);

1374 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_REASSOC
;

1378 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - AŒ fa°Ñﬂmög faûed, backÅÿch #%d\n",
pAd
->
P‹tCfg
.
Ch™√l
);

1379 
	`AsicSwôchCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

1380 
	`AsicLockCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

1381 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

1383 
	}
}

1390 
VOID
 
	$JoöP¨mFûl
(

1391 
IN
 
PRTMP_ADAPTER
 
pAd
,

1392 
IN
 
OUT
 
MLME_JOIN_REQ_STRUCT
 *
JoöReq
,

1393 
IN
 
ULONG
 
BssIdx
)

1395 
JoöReq
->
BssIdx
 = BssIdx;

1396 
	}
}

1403 
VOID
 
	$AssocP¨mFûl
(

1404 
IN
 
PRTMP_ADAPTER
 
pAd
,

1405 
IN
 
OUT
 
MLME_ASSOC_REQ_STRUCT
 *
AssocReq
,

1406 
IN
 
PUCHAR
 
pAddr
,

1407 
IN
 
USHORT
 
C≠abûôyInfo
,

1408 
IN
 
ULONG
 
Timeout
,

1409 
IN
 
USHORT
 
Li°íI¡v
)

1411 
	`COPY_MAC_ADDR
(
AssocReq
->
Addr
, 
pAddr
);

1413 
AssocReq
->
C≠abûôyInfo
 = C≠abûôyInfÿ& 
SUPPORTED_CAPABILITY_INFO
;

1414 
AssocReq
->
Timeout
 = Timeout;

1415 
AssocReq
->
Li°íI¡v
 = ListenIntv;

1416 
	}
}

1423 
VOID
 
	$SˇnP¨mFûl
(

1424 
IN
 
PRTMP_ADAPTER
 
pAd
,

1425 
IN
 
OUT
 
MLME_SCAN_REQ_STRUCT
 *
SˇnReq
,

1426 
IN
 
CHAR
 
Ssid
[],

1427 
IN
 
UCHAR
 
SsidLí
,

1428 
IN
 
UCHAR
 
BssTy≥
,

1429 
IN
 
UCHAR
 
SˇnTy≥
)

1431 
SˇnReq
->
SsidLí
 = SsidLen;

1432 
	`NdisMoveMem‹y
(
SˇnReq
->
Ssid
, Ssid, 
SsidLí
);

1433 
SˇnReq
->
BssTy≥
 = BssType;

1434 
SˇnReq
->
SˇnTy≥
 = ScanType;

1435 
	}
}

1442 
VOID
 
	$DißssocP¨mFûl
(

1443 
IN
 
PRTMP_ADAPTER
 
pAd
,

1444 
IN
 
OUT
 
MLME_DISASSOC_REQ_STRUCT
 *
DißssocReq
,

1445 
IN
 
PUCHAR
 
pAddr
,

1446 
IN
 
USHORT
 
Rós⁄
)

1448 
	`COPY_MAC_ADDR
(
DißssocReq
->
Addr
, 
pAddr
);

1449 
DißssocReq
->
Rós⁄
 = Reason;

1450 
	}
}

1457 
VOID
 
	$SèπP¨mFûl
(

1458 
IN
 
PRTMP_ADAPTER
 
pAd
,

1459 
IN
 
OUT
 
MLME_START_REQ_STRUCT
 *
SèπReq
,

1460 
IN
 
CHAR
 
Ssid
[],

1461 
IN
 
UCHAR
 
SsidLí
)

1463 
	`NdisMoveMem‹y
(
SèπReq
->
Ssid
, Ssid, 
SsidLí
);

1464 
SèπReq
->
SsidLí
 = SsidLen;

1465 
	}
}

1472 
VOID
 
	$AuthP¨mFûl
(

1473 
IN
 
PRTMP_ADAPTER
 
pAd
,

1474 
IN
 
OUT
 
MLME_AUTH_REQ_STRUCT
 *
AuthReq
,

1475 
IN
 
PUCHAR
 
pAddr
,

1476 
IN
 
USHORT
 
Alg
)

1478 
	`COPY_MAC_ADDR
(
AuthReq
->
Addr
, 
pAddr
);

1479 
AuthReq
->
Alg
 = Alg;

1480 
AuthReq
->
Timeout
 = 
AUTH_TIMEOUT
;

1481 
	}
}

1488 
VOID
 
	$Compo£PsPﬁl
(

1489 
IN
 
PRTMP_ADAPTER
 
pAd
)

1491 
	`NdisZîoMem‹y
(&
pAd
->
PsPﬁlFøme
, (
PSPOLL_FRAME
));

1492 
pAd
->
PsPﬁlFøme
.
FC
.
Ty≥
 = 
BTYPE_CNTL
;

1493 
pAd
->
PsPﬁlFøme
.
FC
.
SubTy≥
 = 
SUBTYPE_PS_POLL
;

1494 
pAd
->
PsPﬁlFøme
.
Aid
 =ÖAd->
A˘iveCfg
.Aid | 0xC000;

1495 
	`COPY_MAC_ADDR
(
pAd
->
PsPﬁlFøme
.
Bssid
,ÖAd->
P‹tCfg
.Bssid);

1496 
	`COPY_MAC_ADDR
(
pAd
->
PsPﬁlFøme
.
Ta
,ÖAd->
CuºítAddªss
);

1497 
	}
}

1499 
VOID
 
	$Compo£NuŒFøme
(

1500 
IN
 
PRTMP_ADAPTER
 
pAd
)

1502 
	`NdisZîoMem‹y
(&
pAd
->
NuŒFøme
, (
HEADER_802_11
));

1503 
pAd
->
NuŒFøme
.
FC
.
Ty≥
 = 
BTYPE_DATA
;

1504 
pAd
->
NuŒFøme
.
FC
.
SubTy≥
 = 
SUBTYPE_NULL_FUNC
;

1505 
pAd
->
NuŒFøme
.
FC
.
ToDs
 = 1;

1506 
	`COPY_MAC_ADDR
(
pAd
->
NuŒFøme
.
Addr1
,ÖAd->
P‹tCfg
.
Bssid
);

1507 
	`COPY_MAC_ADDR
(
pAd
->
NuŒFøme
.
Addr2
,ÖAd->
CuºítAddªss
);

1508 
	`COPY_MAC_ADDR
(
pAd
->
NuŒFøme
.
Addr3
,ÖAd->
P‹tCfg
.
Bssid
);

1509 
	}
}

1517 
ULONG
 
	$MakeIbssBóc⁄
(

1518 
IN
 
PRTMP_ADAPTER
 
pAd
)

1520 
UCHAR
 
DsLí
 = 1, 
IbssLí
 = 2;

1521 
UCHAR
 
LoˇlEΩIe
[3] = {
IE_ERP
, 1, 0x04};

1522 
HEADER_802_11
 
B˙Hdr
;

1523 
USHORT
 
C≠abûôyInfo
;

1524 
LARGE_INTEGER
 
FakeTime°amp
;

1525 
ULONG
 
FømeLí
=0;

1526 
PTXD_STRUC
 
pTxD
 = &
pAd
->
Bóc⁄TxD
;

1527 
CHAR
 *
pBóc⁄Føme
 = 
pAd
->
Bóc⁄Buf
;

1528 
BOOLEAN
 
Privacy
;

1529 
UCHAR
 
SupR©e
[
MAX_LEN_OF_SUPPORTED_RATES
];

1530 
UCHAR
 
SupR©eLí
 = 0;

1531 
UCHAR
 
ExtR©e
[
MAX_LEN_OF_SUPPORTED_RATES
];

1532 
UCHAR
 
ExtR©eLí
 = 0;

1537 i‡(((
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11BG_MIXED
) ||

1538 (
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11ABG_MIXED
)) &&

1539 (
pAd
->
P‹tCfg
.
AdhocMode
 =
ADHOC_11B
))

1541 
SupR©e
[0] = 0x82;

1542 
SupR©e
[1] = 0x84;

1543 
SupR©e
[2] = 0x8b;

1544 
SupR©e
[3] = 0x96;

1545 
SupR©eLí
 = 4;

1546 
ExtR©eLí
 = 0;

1548 i‡(
pAd
->
P‹tCfg
.
AdhocMode
 =
ADHOC_11BG_MIXED
)

1550 
SupR©e
[0] = 0x82;

1551 
SupR©e
[1] = 0x84;

1552 
SupR©e
[2] = 0x8b;

1553 
SupR©e
[3] = 0x96;

1554 
SupR©eLí
 = 4;

1556 
ExtR©e
[0] = 0x0C;

1557 
ExtR©e
[1] = 0x12;

1558 
ExtR©e
[2] = 0x18;

1559 
ExtR©e
[3] = 0x24;

1560 
ExtR©e
[4] = 0x30;

1561 
ExtR©e
[5] = 0x48;

1562 
ExtR©e
[6] = 0x60;

1563 
ExtR©e
[7] = 0x6c;

1564 
ExtR©eLí
 = 8;

1566 i‡((
pAd
->
P‹tCfg
.
AdhocMode
 =
ADHOC_11G
Ë|| (pAd->P‹tCfg.AdhocModê=
ADHOC_11A
) ||

1567 ((
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11ABG_MIXED
Ë&& (pAd->P‹tCfg.
Ch™√l
 > 14)))

1569 
SupR©e
[0] = 0x8C;

1570 
SupR©e
[1] = 0x12;

1571 
SupR©e
[2] = 0x98;

1572 
SupR©e
[3] = 0x24;

1573 
SupR©e
[4] = 0xb0;

1574 
SupR©e
[5] = 0x48;

1575 
SupR©e
[6] = 0x60;

1576 
SupR©e
[7] = 0x6c;

1577 
SupR©eLí
 = 8;

1578 
ExtR©eLí
 = 0;

1583 
pAd
->
P‹tCfg
.
MlmeR©e
 = 
RATE_6
;

1584 
pAd
->
P‹tCfg
.
RtsR©e
 = 
RATE_6
;

1588 
SupR©eLí
 = 
pAd
->
P‹tCfg
.SupRateLen;

1589 
	`NdisMoveMem‹y
(
SupR©e
, 
pAd
->
P‹tCfg
.SupR©e, 
SupR©eLí
);

1590 
ExtR©eLí
 = 
pAd
->
P‹tCfg
.ExtRateLen;

1591 
	`NdisMoveMem‹y
(
ExtR©e
, 
pAd
->
P‹tCfg
.ExtR©e, 
ExtR©eLí
);

1594 
pAd
->
A˘iveCfg
.
SupR©eLí
 = SupRateLen;

1595 
	`NdisMoveMem‹y
(
pAd
->
A˘iveCfg
.
SupR©e
, SupR©e, 
SupR©eLí
);

1596 
pAd
->
A˘iveCfg
.
ExtR©eLí
 = ExtRateLen;

1597 
	`NdisMoveMem‹y
(
pAd
->
A˘iveCfg
.
ExtR©e
, ExtR©e, 
ExtR©eLí
);

1600 
	`MgtMacHódîInô
(
pAd
, &
B˙Hdr
, 
SUBTYPE_BEACON
, 0, 
BROADCAST_ADDR
,ÖAd->
P‹tCfg
.
Bssid
);

1601 
Privacy
 = (
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄1E«bÀd
) ||

1602 (
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
) ||

1603 (
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
);

1604 
C≠abûôyInfo
 = 
	`CAP_GENERATE
(0, 1, 
Privacy
, (
pAd
->
P‹tCfg
.
TxPªambÀ
 =
Rt802_11PªambÀSh‹t
), 0);

1606 
	`MakeOutgoögFøme
(
pBóc⁄Føme
, &
FømeLí
,

1607 (
HEADER_802_11
), &
B˙Hdr
,

1608 
TIMESTAMP_LEN
, &
FakeTime°amp
,

1609 2, &
pAd
->
P‹tCfg
.
Bóc⁄Pîiod
,

1610 2, &
C≠abûôyInfo
,

1611 1, &
SsidIe
,

1612 1, &
pAd
->
P‹tCfg
.
SsidLí
,

1613 
pAd
->
P‹tCfg
.
SsidLí
,ÖAd->P‹tCfg.
Ssid
,

1614 1, &
SupR©eIe
,

1615 1, &
SupR©eLí
,

1616 
SupR©eLí
, 
SupR©e
,

1617 1, &
DsIe
,

1618 1, &
DsLí
,

1619 1, &
pAd
->
P‹tCfg
.
Ch™√l
,

1620 1, &
IbssIe
,

1621 1, &
IbssLí
,

1622 2, &
pAd
->
A˘iveCfg
.
AtimWö
,

1623 
END_OF_ARGS
);

1626 i‡(
ExtR©eLí
)

1628 
ULONG
 
tmp
;

1630 
	`MakeOutgoögFøme
(
pBóc⁄Føme
 + 
FømeLí
, &
tmp
,

1631 3, 
LoˇlEΩIe
,

1632 1, &
ExtR©eIe
,

1633 1, &
ExtR©eLí
,

1634 
ExtR©eLí
, 
ExtR©e
,

1635 
END_OF_ARGS
);

1636 
FømeLí
 +
tmp
;

1640 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAN⁄e
)

1642 
ULONG
 
tmp
;

1644 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
)

1646 
	`MakeOutgoögFøme
(
pBóc⁄Føme
 + 
FømeLí
, &
tmp
,

1647 1, &
W∑Ie
,

1648 1, &
CùhîSuôeW∑N⁄eTkùLí
,

1649 
CùhîSuôeW∑N⁄eTkùLí
, &
CùhîSuôeW∑N⁄eTkù
[0],

1650 
END_OF_ARGS
);

1651 
FømeLí
 +
tmp
;

1653 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

1655 
	`MakeOutgoögFøme
(
pBóc⁄Føme
 + 
FømeLí
, &
tmp
,

1656 1, &
W∑Ie
,

1657 1, &
CùhîSuôeW∑N⁄eAesLí
,

1658 
CùhîSuôeW∑N⁄eAesLí
, &
CùhîSuôeW∑N⁄eAes
[0],

1659 
END_OF_ARGS
);

1660 
FømeLí
 +
tmp
;

1664 #ifde‡
BIG_ENDIAN


1665 
	`RTMPFømeEndünCh™ge
(
pAd
, 
pBóc⁄Føme
, 
DIR_WRITE
, 
FALSE
);

1668 
	`RTUSBWrôeTxDes¸ùt‹
(
pAd
, 
pTxD
, 
CIPHER_NONE
, 0,0, 
FALSE
, FALSE, 
TRUE
, 
SHORT_RETRY
,

1669 
IFS_BACKOFF
, 
pAd
->
P‹tCfg
.
MlmeR©e
, 
FømeLí
, 
QID_MGMT
, 
PID_MGMT_FRAME
, 
FALSE
);

1678 
pTxD
->
Cwmö
 = 2;

1680 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MakeIbssBóc⁄ (Àn=%d)\n", 
FømeLí
);

1681  
FømeLí
;

1682 
	}
}

	@link_list.h

27 #i‚de‡
__LINK_LIST_H__


28 
	#__LINK_LIST_H__


	)

30 
	s_LIST_ENTRY


32 
_LIST_ENTRY
 *
	mpNext
;

33 } 
	tLIST_ENTRY
, *
	tPLIST_ENTRY
;

35 
	s_LIST_HEADR


37 
PLIST_ENTRY
 
	mpHód
;

38 
PLIST_ENTRY
 
	mpTaû
;

39 
UCHAR
 
	msize
;

40 } 
	tLIST_HEADER
, *
	tPLIST_HEADER
;

42 
ölöe
 
VOID
 
	$öôLi°
(

43 
IN
 
PLIST_HEADER
 
pLi°
)

45 
pLi°
->
pHód
 =ÖLi°->
pTaû
 = 
NULL
;

46 
pLi°
->
size
 = 0;

48 
	}
}

50 
ölöe
 
VOID
 
	$ö£πTaûLi°
(

51 
IN
 
PLIST_HEADER
 
pLi°
,

52 
IN
 
PLIST_ENTRY
 
pE¡ry
)

54 
pE¡ry
->
pNext
 = 
NULL
;

55 i‡(
pLi°
->
pTaû
)

56 
pLi°
->
pTaû
->
pNext
 = 
pE¡ry
;

58 
pLi°
->
pHód
 = 
pE¡ry
;

59 
pLi°
->
pTaû
 = 
pE¡ry
;

60 
pLi°
->
size
++;

63 
	}
}

65 
ölöe
 
PLIST_ENTRY
 
	$ªmoveHódLi°
(

66 
IN
 
PLIST_HEADER
 
pLi°
)

68 
PLIST_ENTRY
 
pNext
;

69 
PLIST_ENTRY
 
pE¡ry
;

71 
pE¡ry
 = 
pLi°
->
pHód
;

72 i‡(
pLi°
->
pHód
 !
NULL
)

74 
pNext
 = 
pLi°
->
pHód
->pNext;

75 
pLi°
->
pHód
 = 
pNext
;

76 i‡(
pNext
 =
NULL
)

77 
pLi°
->
pTaû
 = 
NULL
;

78 
pLi°
->
size
--;

80  
pE¡ry
;

81 
	}
}

83 
ölöe
 
	$gëLi°Size
(

84 
IN
 
PLIST_HEADER
 
pLi°
)

86  
pLi°
->
size
;

87 
	}
}

89 
ölöe
 
PLIST_ENTRY
 
	$dñE¡ryLi°
(

90 
IN
 
PLIST_HEADER
 
pLi°
,

91 
IN
 
PLIST_ENTRY
 
pE¡ry
)

93 
PLIST_ENTRY
 
pCurE¡ry
;

94 
PLIST_ENTRY
 
pPrvE¡ry
;

96 if(
pLi°
->
pHód
 =
NULL
)

97  
NULL
;

99 if(
pE¡ry
 =
pLi°
->
pHód
)

101 
pCurE¡ry
 = 
pLi°
->
pHód
;

102 
pLi°
->
pHód
 = 
pCurE¡ry
->
pNext
;

104 if(
pLi°
->
pHód
 =
NULL
)

105 
pLi°
->
pTaû
 = 
NULL
;

107 
pLi°
->
size
--;

108  
pCurE¡ry
;

111 
pPrvE¡ry
 = 
pLi°
->
pHód
;

112 
pCurE¡ry
 = 
pPrvE¡ry
->
pNext
;

113 
pCurE¡ry
 !
NULL
)

115 i‡(
pE¡ry
 =
pCurE¡ry
)

117 
pPrvE¡ry
->
pNext
 = 
pCurE¡ry
->pNext;

119 if(
pE¡ry
 =
pLi°
->
pTaû
)

120 
pLi°
->
pTaû
 = 
pPrvE¡ry
;

122 
pLi°
->
size
--;

125 
pPrvE¡ry
 = 
pCurE¡ry
;

126 
pCurE¡ry
 = 
pPrvE¡ry
->
pNext
;

129  
pCurE¡ry
;

130 
	}
}

	@md5.c

40 
	~"π_c⁄fig.h
"

54 
	$md5_mac
(
u8
 *
key
, 
size_t
 
key_Àn
, u8 *
d©a
, size_à
d©a_Àn
, u8 *
mac
)

56 
MD5_CTX
 
c⁄ãxt
;

58 
	`MD5Inô
(&
c⁄ãxt
);

59 
	`MD5Upd©e
(&
c⁄ãxt
, 
key
, 
key_Àn
);

60 
	`MD5Upd©e
(&
c⁄ãxt
, 
d©a
, 
d©a_Àn
);

61 
	`MD5Upd©e
(&
c⁄ãxt
, 
key
, 
key_Àn
);

62 
	`MD5FöÆ
(
mac
, &
c⁄ãxt
);

63 
	}
}

77 
	$hmac_md5
(
u8
 *
key
, 
size_t
 
key_Àn
, u8 *
d©a
, size_à
d©a_Àn
, u8 *
mac
)

79 
MD5_CTX
 
c⁄ãxt
;

80 
u8
 
k_ùad
[65];

81 
u8
 
k_›ad
[65];

82 
u8
 
tk
[16];

83 
i
;

88 i‡(
key_Àn
 > 64) {

89 
MD5_CTX
 
âc⁄ãxt
;

91 
	`MD5Inô
(&
âc⁄ãxt
);

92 
	`MD5Upd©e
(&
âc⁄ãxt
, 
key
, 
key_Àn
);

93 
	`MD5FöÆ
(
tk
, &
âc⁄ãxt
);

95 
key
 = 
tk
;

96 
key_Àn
 = 16;

109 
	`NdisZîoMem‹y
(
k_ùad
, (k_ipad));

110 
	`NdisZîoMem‹y
(
k_›ad
, (k_opad));

112 
	`NdisMoveMem‹y
(
k_ùad
, 
key
, 
key_Àn
);

113 
	`NdisMoveMem‹y
(
k_›ad
, 
key
, 
key_Àn
);

116 
i
 = 0; i < 64; i++) {

117 
k_ùad
[
i
] ^= 0x36;

118 
k_›ad
[
i
] ^= 0x5c;

122 
	`MD5Inô
(&
c⁄ãxt
);

123 
	`MD5Upd©e
(&
c⁄ãxt
, 
k_ùad
, 64);

124 
	`MD5Upd©e
(&
c⁄ãxt
, 
d©a
, 
d©a_Àn
);

125 
	`MD5FöÆ
(
mac
, &
c⁄ãxt
);

128 
	`MD5Inô
(&
c⁄ãxt
);

129 
	`MD5Upd©e
(&
c⁄ãxt
, 
k_›ad
, 64);

130 
	`MD5Upd©e
(&
c⁄ãxt
, 
mac
, 16);

131 
	`MD5FöÆ
(
mac
, &
c⁄ãxt
);

132 
	}
}

134 #i‚de‡
BIG_ENDIAN


135 
	#byãRevî£
(
buf
, 
Àn
Ë

	)

137 
byãRevî£
(*
buf
, 
l⁄gs
);

138 
	$byãRevî£
(*
buf
, 
l⁄gs
)

141 *(
ULONG
 *)
buf
 = 
	`SWAP32
(*(ULONG *)buf);

142 
buf
 += 4;

143 } --
l⁄gs
);

144 
	}
}

150 
	#MD5_F1
(
x
, 
y
, 
z
Ë(((xË& (y)Ë| ((~xË& (z)))

	)

151 
	#MD5_F2
(
x
, 
y
, 
z
Ë(((xË& (z)Ë| ((yË& (~z)))

	)

152 
	#MD5_F3
(
x
, 
y
, 
z
Ë((xË^ (yË^ (z))

	)

153 
	#MD5_F4
(
x
, 
y
, 
z
Ë((yË^ ((xË| (~z)))

	)

154 
	#CYCLIC_LEFT_SHIFT
(
w
, 
s
Ë(((wË<< (s)Ë| ((wË>> (32-(s))))

	)

156 
	#MD5Sãp
(
f
, 
w
, 
x
, 
y
, 
z
, 
d©a
, 
t
, 
s
) \

157 –
w
 +
	`f
(
x
, 
y
, 
z
Ë+ 
d©a
 + 
t
, w = (
	`CYCLIC_LEFT_SHIFT
(w, 
s
)Ë& 0xffffffff, w +x )

	)

170 
VOID
 
	$MD5Inô
(
MD5_CTX
 *
pCtx
)

172 
pCtx
->
Buf
[0]=0x67452301;

173 
pCtx
->
Buf
[1]=0xefcdab89;

174 
pCtx
->
Buf
[2]=0x98badcfe;

175 
pCtx
->
Buf
[3]=0x10325476;

177 
pCtx
->
LíInBôCou¡
[0]=0;

178 
pCtx
->
LíInBôCou¡
[1]=0;

179 
	}
}

198 
VOID
 
	$MD5Upd©e
(
MD5_CTX
 *
pCtx
, 
UCHAR
 *
pD©a
, 
ULONG
 
LíInByãs
)

201 
ULONG
 
TfTimes
;

202 
ULONG
 
ãmp
;

203 
i
;

205 
ãmp
 = 
pCtx
->
LíInBôCou¡
[0];

207 
pCtx
->
LíInBôCou¡
[0] = (
ULONG
Ë’Ctx->LíInBôCou¡[0] + (
LíInByãs
 << 3));

209 i‡(
pCtx
->
LíInBôCou¡
[0] < 
ãmp
)

210 
pCtx
->
LíInBôCou¡
[1]++;

212 
pCtx
->
LíInBôCou¡
[1] +
LíInByãs
 >> 29;

215 
ãmp
 = (temp >> 3) & 0x3f;

218 i‡(
ãmp
)

220 
UCHAR
 *
pAds
 = (UCHAR *Ë
pCtx
->
I≈ut
 + 
ãmp
;

222 i‡((
ãmp
+
LíInByãs
) < 64)

224 
	`NdisMoveMem‹y
(
pAds
, (
UCHAR
 *)
pD©a
, 
LíInByãs
);

228 
	`NdisMoveMem‹y
(
pAds
, (
UCHAR
 *)
pD©a
, 64-
ãmp
);

229 
	`byãRevî£
(
pCtx
->
I≈ut
, 16);

230 
	`MD5Tønsf‹m
(
pCtx
->
Buf
, (
ULONG
 *ÌCtx->
I≈ut
);

232 
pD©a
 +64-
ãmp
;

233 
LíInByãs
 -64-
ãmp
;

237 
TfTimes
 = (
LíInByãs
 >> 6);

239 
i
=
TfTimes
; i>0; i--)

241 
	`NdisMoveMem‹y
(
pCtx
->
I≈ut
, (
UCHAR
 *)
pD©a
, 64);

242 
	`byãRevî£
(
pCtx
->
I≈ut
, 16);

243 
	`MD5Tønsf‹m
(
pCtx
->
Buf
, (
ULONG
 *ÌCtx->
I≈ut
);

244 
pD©a
 += 64;

245 
LíInByãs
 -= 64;

249 if(
LíInByãs
)

250 
	`NdisMoveMem‹y
(
pCtx
->
I≈ut
, (
UCHAR
 *)
pD©a
, 
LíInByãs
);

252 
	}
}

270 
VOID
 
	$MD5FöÆ
(
UCHAR
 
Dige°
[16], 
MD5_CTX
 *
pCtx
)

272 
UCHAR
 
Remaödî
;

273 
UCHAR
 
PadLíInByãs
;

274 
UCHAR
 *
pAµíd
=0;

275 
i
;

277 
Remaödî
 = (
UCHAR
)((
pCtx
->
LíInBôCou¡
[0] >> 3) & 0x3f);

279 
PadLíInByãs
 = (
Remaödî
 < 56) ? (56-Remainder) : (120-Remainder);

281 
pAµíd
 = (
UCHAR
 *)
pCtx
->
I≈ut
 + 
Remaödî
;

284 i‡(
Remaödî
 < 56)

286 *
pAµíd
 = 0x80;

287 
PadLíInByãs
 --;

289 
	`NdisZîoMem‹y
((
UCHAR
 *)
pCtx
->
I≈ut
 + 
Remaödî
+1, 
PadLíInByãs
);

292 
i
=0; i<4; i++)

294 
pCtx
->
I≈ut
[56+
i
] = (
UCHAR
)(’Ctx->
LíInBôCou¡
[0] >> (i << 3)) & 0xff);

295 
pCtx
->
I≈ut
[60+
i
] = (
UCHAR
)(’Ctx->
LíInBôCou¡
[1] >> (i << 3)) & 0xff);

298 
	`byãRevî£
(
pCtx
->
I≈ut
, 16);

299 
	`MD5Tønsf‹m
(
pCtx
->
Buf
, (
ULONG
 *ÌCtx->
I≈ut
);

306 *
pAµíd
 = 0x80;

307 
PadLíInByãs
 --;

309 
	`NdisZîoMem‹y
((
UCHAR
 *)
pCtx
->
I≈ut
 + 
Remaödî
+1, (64-Remainder-1));

310 
PadLíInByãs
 -(64 - 
Remaödî
 - 1);

312 
	`byãRevî£
(
pCtx
->
I≈ut
, 16);

313 
	`MD5Tønsf‹m
(
pCtx
->
Buf
, (
ULONG
 *ÌCtx->
I≈ut
);

317 
	`NdisZîoMem‹y
((
UCHAR
 *)
pCtx
->
I≈ut
, 
PadLíInByãs
);

320 
i
=0; i<4; i++)

322 
pCtx
->
I≈ut
[56+
i
] = (
UCHAR
)(’Ctx->
LíInBôCou¡
[0] >> (i << 3)) & 0xff);

323 
pCtx
->
I≈ut
[60+
i
] = (
UCHAR
)(’Ctx->
LíInBôCou¡
[1] >> (i << 3)) & 0xff);

326 
	`byãRevî£
(
pCtx
->
I≈ut
, 16);

327 
	`MD5Tønsf‹m
(
pCtx
->
Buf
, (
ULONG
 *ÌCtx->
I≈ut
);

331 
	`NdisMoveMem‹y
((
UCHAR
 *)
Dige°
, (
ULONG
 *)
pCtx
->
Buf
, 16);

332 
	`byãRevî£
((
UCHAR
 *)
Dige°
, 4);

333 
	`NdisZîoMem‹y
(
pCtx
, (pCtx));

334 
	}
}

352 
VOID
 
	$MD5Tønsf‹m
(
ULONG
 
Buf
[4], ULONG 
Mes
[16])

354 
ULONG
 
Reg
[4], 
Temp
;

355 
i
;

357 
UCHAR
 
LShi·VÆ
[16] =

367 
ULONG
 
MD5TabÀ
[64] =

391 
i
=0; i<4; i++)

392 
Reg
[
i
]=
Buf
[i];

396 
i
=0; i<16; i++)

398 
	`MD5Sãp
(
MD5_F1
, 
Reg
[0], Reg[1], Reg[2], Reg[3], 
Mes
[
i
],

399 
MD5TabÀ
[
i
], 
LShi·VÆ
[i & 0x3]);

402 
Temp
 = 
Reg
[3];

403 
Reg
[3] = Reg[2];

404 
Reg
[2] = Reg[1];

405 
Reg
[1] = Reg[0];

406 
Reg
[0] = 
Temp
;

408 
i
=16; i<32; i++)

410 
	`MD5Sãp
(
MD5_F2
, 
Reg
[0], Reg[1], Reg[2], Reg[3], 
Mes
[(5*(
i
 & 0xf)+1) & 0xf],

411 
MD5TabÀ
[
i
], 
LShi·VÆ
[(0x1 << 2)+(i & 0x3)]);

414 
Temp
 = 
Reg
[3];

415 
Reg
[3] = Reg[2];

416 
Reg
[2] = Reg[1];

417 
Reg
[1] = Reg[0];

418 
Reg
[0] = 
Temp
;

420 
i
=32; i<48; i++)

422 
	`MD5Sãp
(
MD5_F3
, 
Reg
[0], Reg[1], Reg[2], Reg[3], 
Mes
[(3*(
i
 & 0xf)+5) & 0xf],

423 
MD5TabÀ
[
i
], 
LShi·VÆ
[(0x1 << 3)+(i & 0x3)]);

426 
Temp
 = 
Reg
[3];

427 
Reg
[3] = Reg[2];

428 
Reg
[2] = Reg[1];

429 
Reg
[1] = Reg[0];

430 
Reg
[0] = 
Temp
;

432 
i
=48; i<64; i++)

434 
	`MD5Sãp
(
MD5_F4
, 
Reg
[0], Reg[1], Reg[2], Reg[3], 
Mes
[(7*(
i
 & 0xf)) & 0xf],

435 
MD5TabÀ
[
i
], 
LShi·VÆ
[(0x3 << 2)+(i & 0x3)]);

438 
Temp
 = 
Reg
[3];

439 
Reg
[3] = Reg[2];

440 
Reg
[2] = Reg[1];

441 
Reg
[1] = Reg[0];

442 
Reg
[0] = 
Temp
;

447 
i
=0; i<4; i++)

448 
Buf
[
i
] +
Reg
[i];

450 
	}
}

456 
	#SHA1_F1
(
b
, 
c
, 
d
Ë(((bË& (c)Ë| ((~bË& (d)))

	)

457 
	#SHA1_F2
(
b
, 
c
, 
d
Ë((bË^ (cË^ (d))

	)

458 
	#SHA1_F3
(
b
, 
c
, 
d
Ë(((bË& (c)Ë| ((bË& (d)Ë| ((cË& (d)))

	)

461 
	#SHA1Sãp
(
f
, 
a
, 
b
, 
c
, 
d
, 
e
, 
w
, 
k
) \

462 –
e
 +–
	`f
(
b
, 
c
, 
d
Ë+ 
w
 + 
k
 + 
	`CYCLIC_LEFT_SHIFT
(
a
, 5)) & 0xffffffff, \

463 
b
 = 
	`CYCLIC_LEFT_SHIFT
(b, 30Ë)

	)

466 
VOID
 
	$SHAInô
(
SHA_CTX
 *
pCtx
)

468 
pCtx
->
Buf
[0]=0x67452301;

469 
pCtx
->
Buf
[1]=0xefcdab89;

470 
pCtx
->
Buf
[2]=0x98badcfe;

471 
pCtx
->
Buf
[3]=0x10325476;

472 
pCtx
->
Buf
[4]=0xc3d2e1f0;

474 
pCtx
->
LíInBôCou¡
[0]=0;

475 
pCtx
->
LíInBôCou¡
[1]=0;

476 
	}
}

494 
UCHAR
 
	$SHAUpd©e
(
SHA_CTX
 *
pCtx
, 
UCHAR
 *
pD©a
, 
ULONG
 
LíInByãs
)

496 
ULONG
 
TfTimes
;

497 
ULONG
 
ãmp1
,
ãmp2
;

498 
i
;

499 
UCHAR
 
îr
=1;

501 
ãmp1
 = 
pCtx
->
LíInBôCou¡
[0];

502 
ãmp2
 = 
pCtx
->
LíInBôCou¡
[1];

504 
pCtx
->
LíInBôCou¡
[0] = (
ULONG
Ë’Ctx->LíInBôCou¡[0] + (
LíInByãs
 << 3));

505 i‡(
pCtx
->
LíInBôCou¡
[0] < 
ãmp1
)

506 
pCtx
->
LíInBôCou¡
[1]++;

509 
pCtx
->
LíInBôCou¡
[1] = (
ULONG
Ë’Ctx->LíInBôCou¡[1] +(
LíInByãs
 >> 29));

510 i‡(
pCtx
->
LíInBôCou¡
[1] < 
ãmp2
)

511  (
îr
);

515 
ãmp1
 = (temp1 >> 3) & 0x3f;

518 i‡(
ãmp1
)

520 
UCHAR
 *
pAds
 = (UCHAR *Ë
pCtx
->
I≈ut
 + 
ãmp1
;

522 i‡((
ãmp1
+
LíInByãs
) < 64)

524 
	`NdisMoveMem‹y
(
pAds
, (
UCHAR
 *)
pD©a
, 
LíInByãs
);

528 
	`NdisMoveMem‹y
(
pAds
, (
UCHAR
 *)
pD©a
, 64-
ãmp1
);

529 
	`byãRevî£
((
UCHAR
 *)
pCtx
->
I≈ut
, 16);

531 
	`NdisZîoMem‹y
((
UCHAR
 *)
pCtx
->
I≈ut
 + 64, 16);

532 
	`SHATønsf‹m
(
pCtx
->
Buf
, (
ULONG
 *ÌCtx->
I≈ut
);

534 
pD©a
 +64-
ãmp1
;

535 
LíInByãs
 -64-
ãmp1
;

539 
TfTimes
 = (
LíInByãs
 >> 6);

541 
i
=
TfTimes
; i>0; i--)

543 
	`NdisMoveMem‹y
(
pCtx
->
I≈ut
, (
UCHAR
 *)
pD©a
, 64);

544 
	`byãRevî£
((
UCHAR
 *)
pCtx
->
I≈ut
, 16);

546 
	`NdisZîoMem‹y
((
UCHAR
 *)
pCtx
->
I≈ut
 + 64, 16);

547 
	`SHATønsf‹m
(
pCtx
->
Buf
, (
ULONG
 *ÌCtx->
I≈ut
);

548 
pD©a
 += 64;

549 
LíInByãs
 -= 64;

553 if(
LíInByãs
)

554 
	`NdisMoveMem‹y
(
pCtx
->
I≈ut
, (
UCHAR
 *)
pD©a
, 
LíInByãs
);

558 
	}
}

562 
VOID
 
	$SHAFöÆ
(
SHA_CTX
 *
pCtx
, 
UCHAR
 
Dige°
[20])

564 
UCHAR
 
Remaödî
;

565 
UCHAR
 
PadLíInByãs
;

566 
UCHAR
 *
pAµíd
=0;

567 
i
;

569 
Remaödî
 = (
UCHAR
)((
pCtx
->
LíInBôCou¡
[0] >> 3) & 0x3f);

571 
pAµíd
 = (
UCHAR
 *)
pCtx
->
I≈ut
 + 
Remaödî
;

573 
PadLíInByãs
 = (
Remaödî
 < 56) ? (56-Remainder) : (120-Remainder);

576 i‡(
Remaödî
 < 56)

578 *
pAµíd
 = 0x80;

579 
PadLíInByãs
 --;

581 
	`NdisZîoMem‹y
((
UCHAR
 *)
pCtx
->
I≈ut
 + 
Remaödî
+1, 
PadLíInByãs
);

584 
i
=0; i<4; i++)

586 
pCtx
->
I≈ut
[56+
i
] = (
UCHAR
)(’Ctx->
LíInBôCou¡
[1] >> ((3-i) << 3)) & 0xff);

587 
pCtx
->
I≈ut
[60+
i
] = (
UCHAR
)(’Ctx->
LíInBôCou¡
[0] >> ((3-i) << 3)) & 0xff);

590 
	`byãRevî£
((
UCHAR
 *)
pCtx
->
I≈ut
, 16);

591 
	`NdisZîoMem‹y
((
UCHAR
 *)
pCtx
->
I≈ut
 + 64, 14);

592 
	`SHATønsf‹m
(
pCtx
->
Buf
, (
ULONG
 *ÌCtx->
I≈ut
);

599 *
pAµíd
 = 0x80;

600 
PadLíInByãs
 --;

602 
	`NdisZîoMem‹y
((
UCHAR
 *)
pCtx
->
I≈ut
 + 
Remaödî
+1, (64-Remainder-1));

603 
PadLíInByãs
 -(64 - 
Remaödî
 - 1);

605 
	`byãRevî£
((
UCHAR
 *)
pCtx
->
I≈ut
, 16);

606 
	`NdisZîoMem‹y
((
UCHAR
 *)
pCtx
->
I≈ut
 + 64, 16);

607 
	`SHATønsf‹m
(
pCtx
->
Buf
, (
ULONG
 *ÌCtx->
I≈ut
);

611 
	`NdisZîoMem‹y
((
UCHAR
 *)
pCtx
->
I≈ut
, 
PadLíInByãs
);

614 
i
=0; i<4; i++)

616 
pCtx
->
I≈ut
[56+
i
] = (
UCHAR
)(’Ctx->
LíInBôCou¡
[1] >> ((3-i) << 3)) & 0xff);

617 
pCtx
->
I≈ut
[60+
i
] = (
UCHAR
)(’Ctx->
LíInBôCou¡
[0] >> ((3-i) << 3)) & 0xff);

620 
	`byãRevî£
((
UCHAR
 *)
pCtx
->
I≈ut
, 16);

621 
	`NdisZîoMem‹y
((
UCHAR
 *)
pCtx
->
I≈ut
 + 64, 16);

622 
	`SHATønsf‹m
(
pCtx
->
Buf
, (
ULONG
 *ÌCtx->
I≈ut
);

627 
i
=0; i<20; i++)

629 
Dige°
 [
i
] = (
UCHAR
)(
pCtx
->
Buf
[i>>2] >> 8*(3-(i & 0x3)));

632 
	`NdisZîoMem‹y
(
pCtx
, (pCtx));

633 
	}
}

638 
VOID
 
	$SHATønsf‹m
(
ULONG
 
Buf
[5], ULONG 
Mes
[20])

640 
ULONG
 
Reg
[5],
Temp
;

641 
i
;

642 
ULONG
 
W
[80];

644 
ULONG
 
SHA1TabÀ
[4] = { 0x5a827999, 0x6ed9eba1,

647 
Reg
[0]=
Buf
[0];

648 
Reg
[1]=
Buf
[1];

649 
Reg
[2]=
Buf
[2];

650 
Reg
[3]=
Buf
[3];

651 
Reg
[4]=
Buf
[4];

654 
i
 = 0; i < 16; i++)

656 
W
[
i
] = (
Mes
[i] >> 24) & 0xff;

657 
W
[
i
] |(
Mes
[i] >> 8 ) & 0xff00;

658 
W
[
i
] |(
Mes
[i] << 8 ) & 0xff0000;

659 
W
[
i
] |(
Mes
[i] << 24) & 0xff000000;

663 
i
 = 0; i < 64; i++)

664 
W
[16+
i
] = 
	`CYCLIC_LEFT_SHIFT
(W[i] ^ W[2+i] ^ W[8+i] ^ W[13+i], 1);

668 
i
=0; i<80; i++)

670 i‡(
i
<20)

671 
	`SHA1Sãp
(
SHA1_F1
, 
Reg
[0], Reg[1], Reg[2], Reg[3], Reg[4],

672 
W
[
i
], 
SHA1TabÀ
[0]);

674 i‡(
i
>=20 && i<40)

675 
	`SHA1Sãp
(
SHA1_F2
, 
Reg
[0], Reg[1], Reg[2], Reg[3], Reg[4],

676 
W
[
i
], 
SHA1TabÀ
[1]);

678 i‡(
i
>=40 && i<60)

679 
	`SHA1Sãp
(
SHA1_F3
, 
Reg
[0], Reg[1], Reg[2], Reg[3], Reg[4],

680 
W
[
i
], 
SHA1TabÀ
[2]);

683 
	`SHA1Sãp
(
SHA1_F2
, 
Reg
[0], Reg[1], Reg[2], Reg[3], Reg[4],

684 
W
[
i
], 
SHA1TabÀ
[3]);

688 
Temp
 = 
Reg
[4];

689 
Reg
[4] = Reg[3];

690 
Reg
[3] = Reg[2];

691 
Reg
[2] = Reg[1];

692 
Reg
[1] = Reg[0];

693 
Reg
[0] = 
Temp
;

699 
i
=0; i<5; i++)

700 
Buf
[
i
] +
Reg
[i];

702 
	}
}

708 
uöt32
 
	gFSb
[256] =

745 
	#FT
 \

747 
	`V
(
C6
,63,63,
A5
), V(
F8
,7C,7C,84), V(
EE
,77,77,99), V(
F6
,7B,7B,8D), \

748 
	`V
(
FF
,
F2
,F2,0D), V(
D6
,6B,6B,
BD
), V(
DE
,6F,6F,
B1
), V(91,
C5
,C5,54), \

749 
	`V
(60,30,30,50), V(02,01,01,03), V(
CE
,67,67,
A9
), V(56,2B,2B,7D), \

750 
	`V
(
E7
,
FE
,FE,19), V(
B5
,
D7
,D7,62), V(4D,
AB
,AB,
E6
), V(
EC
,76,76,9A), \

751 
	`V
(8F,
CA
,CA,45), V(1F,82,82,9D), V(89,
C9
,C9,40), V(
FA
,7D,7D,87), \

752 
	`V
(
EF
,
FA
,FA,15), V(
B2
,59,59,
EB
), V(8E,47,47,
C9
), V(
FB
,
F0
,F0,0B), \

753 
	`V
(41,
AD
,AD,
EC
), V(
B3
,
D4
,D4,67), V(5F,
A2
,A2,
FD
), V(45,
AF
,AF,
EA
), \

754 
	`V
(23,9C,9C,
BF
), V(53,
A4
,A4,
F7
), V(
E4
,72,72,96), V(9B,
C0
,C0,5B), \

755 
	`V
(75,
B7
,B7,
C2
), V(
E1
,
FD
,FD,1C), V(3D,93,93,
AE
), V(4C,26,26,6A), \

756 
	`V
(6C,36,36,5A), V(7E,3F,3F,41), V(
F5
,
F7
,F7,02), V(83,
CC
,CC,4F), \

757 
	`V
(68,34,34,5C), V(51,
A5
,A5,
F4
), V(
D1
,
E5
,E5,34), V(
F9
,
F1
,F1,08), \

758 
	`V
(
E2
,71,71,93), V(
AB
,
D8
,D8,73), V(62,31,31,53), V(2A,15,15,3F), \

759 
	`V
(08,04,04,0C), V(95,
C7
,C7,52), V(46,23,23,65), V(9D,
C3
,C3,5E), \

760 
	`V
(30,18,18,28), V(37,96,96,
A1
), V(0A,05,05,0F), V(2F,9A,9A,
B5
), \

761 
	`V
(0E,07,07,09), V(24,12,12,36), V(1B,80,80,9B), V(
DF
,
E2
,E2,3D), \

762 
	`V
(
CD
,
EB
,EB,26), V(4E,27,27,69), V(7F,
B2
,B2,CD), V(
EA
,75,75,9F), \

763 
	`V
(12,09,09,1B), V(1D,83,83,9E), V(58,2C,2C,74), V(34,1A,1A,2E), \

764 
	`V
(36,1B,1B,2D), V(
DC
,6E,6E,
B2
), V(
B4
,5A,5A,
EE
), V(5B,
A0
,A0,
FB
), \

765 
	`V
(
A4
,52,52,
F6
), V(76,3B,3B,4D), V(
B7
,
D6
,D6,61), V(7D,
B3
,B3,
CE
), \

766 
	`V
(52,29,29,7B), V(
DD
,
E3
,E3,3E), V(5E,2F,2F,71), V(13,84,84,97), \

767 
	`V
(
A6
,53,53,
F5
), V(
B9
,
D1
,D1,68), V(00,00,00,00), V(
C1
,
ED
,ED,2C), \

768 
	`V
(40,20,20,60), V(
E3
,
FC
,FC,1F), V(79,
B1
,B1,
C8
), V(
B6
,5B,5B,
ED
), \

769 
	`V
(
D4
,6A,6A,
BE
), V(8D,
CB
,CB,46), V(67,BE,BE,
D9
), V(72,39,39,4B), \

770 
	`V
(94,4A,4A,
DE
), V(98,4C,4C,
D4
), V(
B0
,58,58,
E8
), V(85,
CF
,CF,4A), \

771 
	`V
(
BB
,
D0
,D0,6B), V(
C5
,
EF
,EF,2A), V(4F,
AA
,AA,
E5
), V(
ED
,
FB
,FB,16), \

772 
	`V
(86,43,43,
C5
), V(9A,4D,4D,
D7
), V(66,33,33,55), V(11,85,85,94), \

773 
	`V
(8A,45,45,
CF
), V(
E9
,
F9
,F9,10), V(04,02,02,06), V(
FE
,7F,7F,81), \

774 
	`V
(
A0
,50,50,
F0
), V(78,3C,3C,44), V(25,9F,9F,
BA
), V(4B,
A8
,A8,
E3
), \

775 
	`V
(
A2
,51,51,
F3
), V(5D,
A3
,A3,
FE
), V(80,40,40,
C0
), V(05,8F,8F,8A), \

776 
	`V
(3F,92,92,
AD
), V(21,9D,9D,
BC
), V(70,38,38,48), V(
F1
,
F5
,F5,04), \

777 
	`V
(63,
BC
,BC,
DF
), V(77,
B6
,B6,
C1
), V(
AF
,
DA
,DA,75), V(42,21,21,63), \

778 
	`V
(20,10,10,30), V(
E5
,
FF
,FF,1A), V(
FD
,
F3
,F3,0E), V(
BF
,
D2
,D2,6D), \

779 
	`V
(81,
CD
,CD,4C), V(18,0C,0C,14), V(26,13,13,35), V(
C3
,
EC
,EC,2F), \

780 
	`V
(
BE
,5F,5F,
E1
), V(35,97,97,
A2
), V(88,44,44,
CC
), V(2E,17,17,39), \

781 
	`V
(93,
C4
,C4,57), V(55,
A7
,A7,
F2
), V(
FC
,7E,7E,82), V(7A,3D,3D,47), \

782 
	`V
(
C8
,64,64,
AC
), V(
BA
,5D,5D,
E7
), V(32,19,19,2B), V(
E6
,73,73,95), \

783 
	`V
(
C0
,60,60,
A0
), V(19,81,81,98), V(9E,4F,4F,
D1
), V(
A3
,
DC
,DC,7F), \

784 
	`V
(44,22,22,66), V(54,2A,2A,7E), V(3B,90,90,
AB
), V(0B,88,88,83), \

785 
	`V
(8C,46,46,
CA
), V(
C7
,
EE
,EE,29), V(6B,
B8
,B8,
D3
), V(28,14,14,3C), \

786 
	`V
(
A7
,
DE
,DE,79), V(
BC
,5E,5E,
E2
), V(16,0B,0B,1D), V(
AD
,
DB
,DB,76), \

787 
	`V
(
DB
,
E0
,E0,3B), V(64,32,32,56), V(74,3A,3A,4E), V(14,0A,0A,1E), \

788 
	`V
(92,49,49,
DB
), V(0C,06,06,0A), V(48,24,24,6C), V(
B8
,5C,5C,
E4
), \

789 
	`V
(9F,
C2
,C2,5D), V(
BD
,
D3
,D3,6E), V(43,
AC
,AC,
EF
), V(
C4
,62,62,
A6
), \

790 
	`V
(39,91,91,
A8
), V(31,95,95,
A4
), V(
D3
,
E4
,E4,37), V(
F2
,79,79,8B), \

791 
	`V
(
D5
,
E7
,E7,32), V(8B,
C8
,C8,43), V(6E,37,37,59), V(
DA
,6D,6D,
B7
), \

792 
	`V
(01,8D,8D,8C), V(
B1
,
D5
,D5,64), V(9C,4E,4E,
D2
), V(49,
A9
,A9,
E0
), \

793 
	`V
(
D8
,6C,6C,
B4
), V(
AC
,56,56,
FA
), V(
F3
,
F4
,F4,07), V(
CF
,
EA
,EA,25), \

794 
	`V
(
CA
,65,65,
AF
), V(
F4
,7A,7A,8E), V(47,
AE
,AE,
E9
), V(10,08,08,18), \

795 
	`V
(6F,
BA
,BA,
D5
), V(
F0
,78,78,88), V(4A,25,25,6F), V(5C,2E,2E,72), \

796 
	`V
(38,1C,1C,24), V(57,
A6
,A6,
F1
), V(73,
B4
,B4,
C7
), V(97,
C6
,C6,51), \

797 
	`V
(
CB
,
E8
,E8,23), V(
A1
,
DD
,DD,7C), V(E8,74,74,9C), V(3E,1F,1F,21), \

798 
	`V
(96,4B,4B,
DD
), V(61,
BD
,BD,
DC
), V(0D,8B,8B,86), V(0F,8A,8A,85), \

799 
	`V
(
E0
,70,70,90), V(7C,3E,3E,42), V(71,
B5
,B5,
C4
), V(
CC
,66,66,
AA
), \

800 
	`V
(90,48,48,
D8
), V(06,03,03,05), V(
F7
,
F6
,F6,01), V(1C,0E,0E,12), \

801 
	`V
(
C2
,61,61,
A3
), V(6A,35,35,5F), V(
AE
,57,57,
F9
), V(69,
B9
,B9,
D0
), \

802 
	`V
(17,86,86,91), V(99,
C1
,C1,58), V(3A,1D,1D,27), V(27,9E,9E,
B9
), \

803 
	`V
(
D9
,
E1
,E1,38), V(
EB
,
F8
,F8,13), V(2B,98,98,
B3
), V(22,11,11,33), \

804 
	`V
(
D2
,69,69,
BB
), V(
A9
,
D9
,D9,70), V(07,8E,8E,89), V(33,94,94,
A7
), \

805 
	`V
(2D,9B,9B,
B6
), V(3C,1E,1E,22), V(15,87,87,92), V(
C9
,
E9
,E9,20), \

806 
	`V
(87,
CE
,CE,49), V(
AA
,55,55,
FF
), V(50,28,28,78), V(
A5
,
DF
,DF,7A), \

807 
	`V
(03,8C,8C,8F), V(59,
A1
,A1,
F8
), V(09,89,89,80), V(1A,0D,0D,17), \

808 
	`V
(65,
BF
,BF,
DA
), V(
D7
,
E6
,E6,31), V(84,42,42,
C6
), V(
D0
,68,68,
B8
), \

809 
	`V
(82,41,41,
C3
), V(29,99,99,
B0
), V(5A,2D,2D,77), V(1E,0F,0F,11), \

810 
	`V
(7B,
B0
,B0,
CB
), V(
A8
,54,54,
FC
), V(6D,
BB
,BB,
D6
), V(2C,16,16,3A)

	)

812 
	#V
(
a
,
b
,
c
,
d
Ë0x##a##b##c##
	)
d

813 
uöt32
 
	gFT0
[256] = { 
FT
 };

814 #unde‡
V


816 
	#V
(
a
,
b
,
c
,
d
Ë0x##d##a##b##
	)
c

817 
uöt32
 
	gFT1
[256] = { 
FT
 };

818 #unde‡
V


820 
	#V
(
a
,
b
,
c
,
d
Ë0x##c##d##a##
	)
b

821 
uöt32
 
	gFT2
[256] = { 
FT
 };

822 #unde‡
V


824 
	#V
(
a
,
b
,
c
,
d
Ë0x##b##c##d##
	)
a

825 
uöt32
 
	gFT3
[256] = { 
FT
 };

826 #unde‡
V


828 #unde‡
FT


832 
uöt32
 
	gRSb
[256] =

870 
	#RT
 \

872 
	`V
(51,
F4
,
A7
,50), V(7E,41,65,53), V(1A,17,
A4
,
C3
), V(3A,27,5E,96), \

873 
	`V
(3B,
AB
,6B,
CB
), V(1F,9D,45,
F1
), V(
AC
,
FA
,58,AB), V(4B,
E3
,03,93), \

874 
	`V
(20,30,
FA
,55), V(
AD
,76,6D,
F6
), V(88,
CC
,76,91), V(
F5
,02,4C,25), \

875 
	`V
(4F,
E5
,
D7
,
FC
), V(
C5
,2A,
CB
,D7), V(26,35,44,80), V(
B5
,62,
A3
,8F), \

876 
	`V
(
DE
,
B1
,5A,49), V(25,
BA
,1B,67), V(45,
EA
,0E,98), V(5D,
FE
,
C0
,
E1
), \

877 
	`V
(
C3
,2F,75,02), V(81,4C,
F0
,12), V(8D,46,97,
A3
), V(6B,
D3
,
F9
,
C6
), \

878 
	`V
(03,8F,5F,
E7
), V(15,92,9C,95), V(
BF
,6D,7A,
EB
), V(95,52,59,
DA
), \

879 
	`V
(
D4
,
BE
,83,2D), V(58,74,21,
D3
), V(49,
E0
,69,29), V(8E,
C9
,
C8
,44), \

880 
	`V
(75,
C2
,89,6A), V(
F4
,8E,79,78), V(99,58,3E,6B), V(27,
B9
,71,
DD
), \

881 
	`V
(
BE
,
E1
,4F,
B6
), V(
F0
,88,
AD
,17), V(
C9
,20,
AC
,66), V(7D,
CE
,3A,
B4
), \

882 
	`V
(63,
DF
,4A,18), V(
E5
,1A,31,82), V(97,51,33,60), V(62,53,7F,45), \

883 
	`V
(
B1
,64,77,
E0
), V(
BB
,6B,
AE
,84), V(
FE
,81,
A0
,1C), V(
F9
,08,2B,94), \

884 
	`V
(70,48,68,58), V(8F,45,
FD
,19), V(94,
DE
,6C,87), V(52,7B,
F8
,
B7
), \

885 
	`V
(
AB
,73,
D3
,23), V(72,4B,02,
E2
), V(
E3
,1F,8F,57), V(66,55,AB,2A), \

886 
	`V
(
B2
,
EB
,28,07), V(2F,
B5
,
C2
,03), V(86,
C5
,7B,9A), V(
D3
,37,08,
A5
), \

887 
	`V
(30,28,87,
F2
), V(23,
BF
,
A5
,
B2
), V(02,03,6A,
BA
), V(
ED
,16,82,5C), \

888 
	`V
(8A,
CF
,1C,2B), V(
A7
,79,
B4
,92), V(
F3
,07,
F2
,
F0
), V(4E,69,
E2
,
A1
), \

889 
	`V
(65,
DA
,
F4
,
CD
), V(06,05,
BE
,
D5
), V(
D1
,34,62,1F), V(
C4
,
A6
,
FE
,8A), \

890 
	`V
(34,2E,53,9D), V(
A2
,
F3
,55,
A0
), V(05,8A,
E1
,32), V(
A4
,
F6
,
EB
,75), \

891 
	`V
(0B,83,
EC
,39), V(40,60,
EF
,
AA
), V(5E,71,9F,06), V(
BD
,6E,10,51), \

892 
	`V
(3E,21,8A,
F9
), V(96,
DD
,06,3D), V(DD,3E,05,
AE
), V(4D,
E6
,
BD
,46), \

893 
	`V
(91,54,8D,
B5
), V(71,
C4
,5D,05), V(04,06,
D4
,6F), V(60,50,15,
FF
), \

894 
	`V
(19,98,
FB
,24), V(
D6
,
BD
,
E9
,97), V(89,40,43,
CC
), V(67,
D9
,9E,77), \

895 
	`V
(
B0
,
E8
,42,
BD
), V(07,89,8B,88), V(
E7
,19,5B,38), V(79,
C8
,
EE
,
DB
), \

896 
	`V
(
A1
,7C,0A,47), V(7C,42,0F,
E9
), V(
F8
,84,1E,
C9
), V(00,00,00,00), \

897 
	`V
(09,80,86,83), V(32,2B,
ED
,48), V(1E,11,70,
AC
), V(6C,5A,72,4E), \

898 
	`V
(
FD
,0E,
FF
,
FB
), V(0F,85,38,56), V(3D,
AE
,
D5
,1E), V(36,2D,39,27), \

899 
	`V
(0A,0F,
D9
,64), V(68,5C,
A6
,21), V(9B,5B,54,
D1
), V(24,36,2E,3A), \

900 
	`V
(0C,0A,67,
B1
), V(93,57,
E7
,0F), V(
B4
,
EE
,96,
D2
), V(1B,9B,91,9E), \

901 
	`V
(80,
C0
,
C5
,4F), V(61,
DC
,20,
A2
), V(5A,77,4B,69), V(1C,12,1A,16), \

902 
	`V
(
E2
,93,
BA
,0A), V(
C0
,
A0
,2A,
E5
), V(3C,22,
E0
,43), V(12,1B,17,1D), \

903 
	`V
(0E,09,0D,0B), V(
F2
,8B,
C7
,
AD
), V(2D,
B6
,
A8
,
B9
), V(14,1E,
A9
,
C8
), \

904 
	`V
(57,
F1
,19,85), V(
AF
,75,07,4C), V(
EE
,99,
DD
,
BB
), V(
A3
,7F,60,
FD
), \

905 
	`V
(
F7
,01,26,9F), V(5C,72,
F5
,
BC
), V(44,66,3B,
C5
), V(5B,
FB
,7E,34), \

906 
	`V
(8B,43,29,76), V(
CB
,23,
C6
,
DC
), V(
B6
,
ED
,
FC
,68), V(
B8
,
E4
,
F1
,63), \

907 
	`V
(
D7
,31,
DC
,
CA
), V(42,63,85,10), V(13,97,22,40), V(84,
C6
,11,20), \

908 
	`V
(85,4A,24,7D), V(
D2
,
BB
,3D,
F8
), V(
AE
,
F9
,32,11), V(
C7
,29,
A1
,6D), \

909 
	`V
(1D,9E,2F,4B), V(
DC
,
B2
,30,
F3
), V(0D,86,52,
EC
), V(77,
C1
,
E3
,
D0
), \

910 
	`V
(2B,
B3
,16,6C), V(
A9
,70,
B9
,99), V(11,94,48,
FA
), V(47,
E9
,64,22), \

911 
	`V
(
A8
,
FC
,8C,
C4
), V(
A0
,
F0
,3F,1A), V(56,7D,2C,
D8
), V(22,33,90,
EF
), \

912 
	`V
(87,49,4E,
C7
), V(
D9
,38,
D1
,
C1
), V(8C,
CA
,
A2
,
FE
), V(98,
D4
,0B,36), \

913 
	`V
(
A6
,
F5
,81,
CF
), V(
A5
,7A,
DE
,28), V(
DA
,
B7
,8E,26), V(3F,
AD
,
BF
,
A4
), \

914 
	`V
(2C,3A,9D,
E4
), V(50,78,92,0D), V(6A,5F,
CC
,9B), V(54,7E,46,62), \

915 
	`V
(
F6
,8D,13,
C2
), V(90,
D8
,
B8
,
E8
), V(2E,39,
F7
,5E), V(82,
C3
,
AF
,
F5
), \

916 
	`V
(9F,5D,80,
BE
), V(69,
D0
,93,7C), V(6F,
D5
,2D,
A9
), V(
CF
,25,12,
B3
), \

917 
	`V
(
C8
,
AC
,99,3B), V(10,18,7D,
A7
), V(
E8
,9C,63,6E), V(
DB
,3B,
BB
,7B), \

918 
	`V
(
CD
,26,78,09), V(6E,59,18,
F4
), V(
EC
,9A,
B7
,01), V(83,4F,9A,
A8
), \

919 
	`V
(
E6
,95,6E,65), V(
AA
,
FF
,E6,7E), V(21,
BC
,
CF
,08), V(
EF
,15,
E8
,E6), \

920 
	`V
(
BA
,
E7
,9B,
D9
), V(4A,6F,36,
CE
), V(
EA
,9F,09,
D4
), V(29,
B0
,7C,
D6
), \

921 
	`V
(31,
A4
,
B2
,
AF
), V(2A,3F,23,31), V(
C6
,
A5
,94,30), V(35,
A2
,66,
C0
), \

922 
	`V
(74,4E,
BC
,37), V(
FC
,82,
CA
,
A6
), V(
E0
,90,
D0
,
B0
), V(33,
A7
,
D8
,15), \

923 
	`V
(
F1
,04,98,4A), V(41,
EC
,
DA
,
F7
), V(7F,
CD
,50,0E), V(17,91,
F6
,2F), \

924 
	`V
(76,4D,
D6
,8D), V(43,
EF
,
B0
,4D), V(
CC
,
AA
,4D,54), V(
E4
,96,04,
DF
), \

925 
	`V
(9E,
D1
,
B5
,
E3
), V(4C,6A,88,1B), V(
C1
,2C,1F,
B8
), V(46,65,51,7F), \

926 
	`V
(9D,5E,
EA
,04), V(01,8C,35,5D), V(
FA
,87,74,73), V(
FB
,0B,41,2E), \

927 
	`V
(
B3
,67,1D,5A), V(92,
DB
,
D2
,52), V(
E9
,10,56,33), V(6D,
D6
,47,13), \

928 
	`V
(9A,
D7
,61,8C), V(37,
A1
,0C,7A), V(59,
F8
,14,8E), V(
EB
,13,3C,89), \

929 
	`V
(
CE
,
A9
,27,
EE
), V(
B7
,61,
C9
,35), V(
E1
,1C,
E5
,
ED
), V(7A,47,
B1
,3C), \

930 
	`V
(9C,
D2
,
DF
,59), V(55,
F2
,73,3F), V(18,14,
CE
,79), V(73,
C7
,37,
BF
), \

931 
	`V
(53,
F7
,
CD
,
EA
), V(5F,
FD
,
AA
,5B), V(
DF
,3D,6F,14), V(78,44,
DB
,86), \

932 
	`V
(
CA
,
AF
,
F3
,81), V(
B9
,68,
C4
,3E), V(38,24,34,2C), V(
C2
,
A3
,40,5F), \

933 
	`V
(16,1D,
C3
,72), V(
BC
,
E2
,25,0C), V(28,3C,49,8B), V(
FF
,0D,95,41), \

934 
	`V
(39,
A8
,01,71), V(08,0C,
B3
,
DE
), V(
D8
,
B4
,
E4
,9C), V(64,56,
C1
,90), \

935 
	`V
(7B,
CB
,84,61), V(
D5
,32,
B6
,70), V(48,6C,5C,74), V(
D0
,
B8
,57,42)

	)

937 
	#V
(
a
,
b
,
c
,
d
Ë0x##a##b##c##
	)
d

938 
uöt32
 
	gRT0
[256] = { 
RT
 };

939 #unde‡
V


941 
	#V
(
a
,
b
,
c
,
d
Ë0x##d##a##b##
	)
c

942 
uöt32
 
	gRT1
[256] = { 
RT
 };

943 #unde‡
V


945 
	#V
(
a
,
b
,
c
,
d
Ë0x##c##d##a##
	)
b

946 
uöt32
 
	gRT2
[256] = { 
RT
 };

947 #unde‡
V


949 
	#V
(
a
,
b
,
c
,
d
Ë0x##b##c##d##
	)
a

950 
uöt32
 
	gRT3
[256] = { 
RT
 };

951 #unde‡
V


953 #unde‡
RT


957 
uöt32
 
	gRCON
[10] =

966 
	gKT_öô
 = 1;

968 
uöt32
 
	gKT0
[256];

969 
uöt32
 
	gKT1
[256];

970 
uöt32
 
	gKT2
[256];

971 
uöt32
 
	gKT3
[256];

975 
	#GET_UINT32
(
n
,
b
,
i
) \

977 (
n
Ë–(
uöt32
Ë(
b
)[(
i
) ] << 24 ) \

978 | ( (
uöt32
Ë(
b
)[(
i
) + 1] << 16 ) \

979 | ( (
uöt32
Ë(
b
)[(
i
) + 2] << 8 ) \

980 | ( (
uöt32
Ë(
b
)[(
i
) + 3] ); \

981 }

	)

983 
	#PUT_UINT32
(
n
,
b
,
i
) \

985 (
b
)[(
i
Ë] = (
uöt8
Ë–(
n
) >> 24 ); \

986 (
b
)[(
i
Ë+ 1] = (
uöt8
Ë–(
n
) >> 16 ); \

987 (
b
)[(
i
Ë+ 2] = (
uöt8
Ë–(
n
) >> 8 ); \

988 (
b
)[(
i
Ë+ 3] = (
uöt8
Ë–(
n
) ); \

989 }

	)

993 
	$´s_£t_key
–
´s_c⁄ãxt
 *
˘x
, 
uöt8
 *
key
, 
nbôs
 )

995 
i
;

996 
uöt32
 *
RK
, *
SK
;

998  
nbôs
 )

1000 128: 
˘x
->
ƒ
 = 10; ;

1001 192: 
˘x
->
ƒ
 = 12; ;

1002 256: 
˘x
->
ƒ
 = 14; ;

1006 
RK
 = 
˘x
->
îk
;

1008  
i
 = 0; i < (
nbôs
 >> 5); i++ )

1010 
	`GET_UINT32
–
RK
[
i
], 
key
, i * 4 );

1015  
nbôs
 )

1019  
i
 = 0; i < 10; i++, 
RK
 += 4 )

1021 
RK
[4] = RK[0] ^ 
RCON
[
i
] ^

1022 –
FSb
[ (
uöt8
Ë–
RK
[3] >> 16 ) ] << 24 ) ^

1023 –
FSb
[ (
uöt8
Ë–
RK
[3] >> 8 ) ] << 16 ) ^

1024 –
FSb
[ (
uöt8
Ë–
RK
[3] ) ] << 8 ) ^

1025 –
FSb
[ (
uöt8
Ë–
RK
[3] >> 24 ) ] );

1027 
RK
[5] = RK[1] ^ RK[4];

1028 
RK
[6] = RK[2] ^ RK[5];

1029 
RK
[7] = RK[3] ^ RK[6];

1035  
i
 = 0; i < 8; i++, 
RK
 += 6 )

1037 
RK
[6] = RK[0] ^ 
RCON
[
i
] ^

1038 –
FSb
[ (
uöt8
Ë–
RK
[5] >> 16 ) ] << 24 ) ^

1039 –
FSb
[ (
uöt8
Ë–
RK
[5] >> 8 ) ] << 16 ) ^

1040 –
FSb
[ (
uöt8
Ë–
RK
[5] ) ] << 8 ) ^

1041 –
FSb
[ (
uöt8
Ë–
RK
[5] >> 24 ) ] );

1043 
RK
[7] = RK[1] ^ RK[6];

1044 
RK
[8] = RK[2] ^ RK[7];

1045 
RK
[9] = RK[3] ^ RK[8];

1046 
RK
[10] = RK[4] ^ RK[9];

1047 
RK
[11] = RK[5] ^ RK[10];

1053  
i
 = 0; i < 7; i++, 
RK
 += 8 )

1055 
RK
[8] = RK[0] ^ 
RCON
[
i
] ^

1056 –
FSb
[ (
uöt8
Ë–
RK
[7] >> 16 ) ] << 24 ) ^

1057 –
FSb
[ (
uöt8
Ë–
RK
[7] >> 8 ) ] << 16 ) ^

1058 –
FSb
[ (
uöt8
Ë–
RK
[7] ) ] << 8 ) ^

1059 –
FSb
[ (
uöt8
Ë–
RK
[7] >> 24 ) ] );

1061 
RK
[9] = RK[1] ^ RK[8];

1062 
RK
[10] = RK[2] ^ RK[9];

1063 
RK
[11] = RK[3] ^ RK[10];

1065 
RK
[12] = RK[4] ^

1066 –
FSb
[ (
uöt8
Ë–
RK
[11] >> 24 ) ] << 24 ) ^

1067 –
FSb
[ (
uöt8
Ë–
RK
[11] >> 16 ) ] << 16 ) ^

1068 –
FSb
[ (
uöt8
Ë–
RK
[11] >> 8 ) ] << 8 ) ^

1069 –
FSb
[ (
uöt8
Ë–
RK
[11] ) ] );

1071 
RK
[13] = RK[5] ^ RK[12];

1072 
RK
[14] = RK[6] ^ RK[13];

1073 
RK
[15] = RK[7] ^ RK[14];

1080 if–
KT_öô
 )

1082  
i
 = 0; i < 256; i++ )

1084 
KT0
[
i
] = 
RT0
[ 
FSb
[i] ];

1085 
KT1
[
i
] = 
RT1
[ 
FSb
[i] ];

1086 
KT2
[
i
] = 
RT2
[ 
FSb
[i] ];

1087 
KT3
[
i
] = 
RT3
[ 
FSb
[i] ];

1090 
KT_öô
 = 0;

1093 
SK
 = 
˘x
->
drk
;

1095 *
SK
++ = *
RK
++;

1096 *
SK
++ = *
RK
++;

1097 *
SK
++ = *
RK
++;

1098 *
SK
++ = *
RK
++;

1100  
i
 = 1; i < 
˘x
->
ƒ
; i++ )

1102 
RK
 -= 8;

1104 *
SK
++ = 
KT0
[ (
uöt8
Ë–*
RK
 >> 24 ) ] ^

1105 
KT1
[ (
uöt8
Ë–*
RK
 >> 16 ) ] ^

1106 
KT2
[ (
uöt8
Ë–*
RK
 >> 8 ) ] ^

1107 
KT3
[ (
uöt8
Ë–*
RK
 ) ]; RK++;

1109 *
SK
++ = 
KT0
[ (
uöt8
Ë–*
RK
 >> 24 ) ] ^

1110 
KT1
[ (
uöt8
Ë–*
RK
 >> 16 ) ] ^

1111 
KT2
[ (
uöt8
Ë–*
RK
 >> 8 ) ] ^

1112 
KT3
[ (
uöt8
Ë–*
RK
 ) ]; RK++;

1114 *
SK
++ = 
KT0
[ (
uöt8
Ë–*
RK
 >> 24 ) ] ^

1115 
KT1
[ (
uöt8
Ë–*
RK
 >> 16 ) ] ^

1116 
KT2
[ (
uöt8
Ë–*
RK
 >> 8 ) ] ^

1117 
KT3
[ (
uöt8
Ë–*
RK
 ) ]; RK++;

1119 *
SK
++ = 
KT0
[ (
uöt8
Ë–*
RK
 >> 24 ) ] ^

1120 
KT1
[ (
uöt8
Ë–*
RK
 >> 16 ) ] ^

1121 
KT2
[ (
uöt8
Ë–*
RK
 >> 8 ) ] ^

1122 
KT3
[ (
uöt8
Ë–*
RK
 ) ]; RK++;

1125 
RK
 -= 8;

1127 *
SK
++ = *
RK
++;

1128 *
SK
++ = *
RK
++;

1129 *
SK
++ = *
RK
++;

1130 *
SK
++ = *
RK
++;

1133 
	}
}

1137 
	$´s_í¸y±
(
´s_c⁄ãxt
 *
˘x
, 
uöt8
 
öput
[16], uöt8 
ouçut
[16] )

1139 
uöt32
 *
RK
, 
X0
, 
X1
, 
X2
, 
X3
, 
Y0
, 
Y1
, 
Y2
, 
Y3
;

1141 
RK
 = 
˘x
->
îk
;

1142 
	`GET_UINT32
–
X0
, 
öput
, 0 ); X0 ^
RK
[0];

1143 
	`GET_UINT32
–
X1
, 
öput
, 4 ); X1 ^
RK
[1];

1144 
	`GET_UINT32
–
X2
, 
öput
, 8 ); X2 ^
RK
[2];

1145 
	`GET_UINT32
–
X3
, 
öput
, 12 ); X3 ^
RK
[3];

1147 
	#AES_FROUND
(
X0
,
X1
,
X2
,
X3
,
Y0
,
Y1
,
Y2
,
Y3
) \

1149 
RK
 += 4; \

1151 
X0
 = 
RK
[0] ^ 
FT0
[ (
uöt8
Ë–
Y0
 >> 24 ) ] ^ \

1152 
FT1
[ (
uöt8
Ë–
Y1
 >> 16 ) ] ^ \

1153 
FT2
[ (
uöt8
Ë–
Y2
 >> 8 ) ] ^ \

1154 
FT3
[ (
uöt8
Ë–
Y3
 ) ]; \

1156 
X1
 = 
RK
[1] ^ 
FT0
[ (
uöt8
Ë–
Y1
 >> 24 ) ] ^ \

1157 
FT1
[ (
uöt8
Ë–
Y2
 >> 16 ) ] ^ \

1158 
FT2
[ (
uöt8
Ë–
Y3
 >> 8 ) ] ^ \

1159 
FT3
[ (
uöt8
Ë–
Y0
 ) ]; \

1161 
X2
 = 
RK
[2] ^ 
FT0
[ (
uöt8
Ë–
Y2
 >> 24 ) ] ^ \

1162 
FT1
[ (
uöt8
Ë–
Y3
 >> 16 ) ] ^ \

1163 
FT2
[ (
uöt8
Ë–
Y0
 >> 8 ) ] ^ \

1164 
FT3
[ (
uöt8
Ë–
Y1
 ) ]; \

1166 
X3
 = 
RK
[3] ^ 
FT0
[ (
uöt8
Ë–
Y3
 >> 24 ) ] ^ \

1167 
FT1
[ (
uöt8
Ë–
Y0
 >> 16 ) ] ^ \

1168 
FT2
[ (
uöt8
Ë–
Y1
 >> 8 ) ] ^ \

1169 
FT3
[ (
uöt8
Ë–
Y2
 ) ]; \

1170 }

	)

1172 
	`AES_FROUND
–
Y0
, 
Y1
, 
Y2
, 
Y3
, 
X0
, 
X1
, 
X2
, 
X3
 );

1173 
	`AES_FROUND
–
X0
, 
X1
, 
X2
, 
X3
, 
Y0
, 
Y1
, 
Y2
, 
Y3
 );

1174 
	`AES_FROUND
–
Y0
, 
Y1
, 
Y2
, 
Y3
, 
X0
, 
X1
, 
X2
, 
X3
 );

1175 
	`AES_FROUND
–
X0
, 
X1
, 
X2
, 
X3
, 
Y0
, 
Y1
, 
Y2
, 
Y3
 );

1176 
	`AES_FROUND
–
Y0
, 
Y1
, 
Y2
, 
Y3
, 
X0
, 
X1
, 
X2
, 
X3
 );

1177 
	`AES_FROUND
–
X0
, 
X1
, 
X2
, 
X3
, 
Y0
, 
Y1
, 
Y2
, 
Y3
 );

1178 
	`AES_FROUND
–
Y0
, 
Y1
, 
Y2
, 
Y3
, 
X0
, 
X1
, 
X2
, 
X3
 );

1179 
	`AES_FROUND
–
X0
, 
X1
, 
X2
, 
X3
, 
Y0
, 
Y1
, 
Y2
, 
Y3
 );

1180 
	`AES_FROUND
–
Y0
, 
Y1
, 
Y2
, 
Y3
, 
X0
, 
X1
, 
X2
, 
X3
 );

1182 if–
˘x
->
ƒ
 > 10 )

1184 
	`AES_FROUND
–
X0
, 
X1
, 
X2
, 
X3
, 
Y0
, 
Y1
, 
Y2
, 
Y3
 );

1185 
	`AES_FROUND
–
Y0
, 
Y1
, 
Y2
, 
Y3
, 
X0
, 
X1
, 
X2
, 
X3
 );

1188 if–
˘x
->
ƒ
 > 12 )

1190 
	`AES_FROUND
–
X0
, 
X1
, 
X2
, 
X3
, 
Y0
, 
Y1
, 
Y2
, 
Y3
 );

1191 
	`AES_FROUND
–
Y0
, 
Y1
, 
Y2
, 
Y3
, 
X0
, 
X1
, 
X2
, 
X3
 );

1196 
RK
 += 4;

1198 
X0
 = 
RK
[0] ^ ( 
FSb
[ (
uöt8
Ë–
Y0
 >> 24 ) ] << 24 ) ^

1199 –
FSb
[ (
uöt8
Ë–
Y1
 >> 16 ) ] << 16 ) ^

1200 –
FSb
[ (
uöt8
Ë–
Y2
 >> 8 ) ] << 8 ) ^

1201 –
FSb
[ (
uöt8
Ë–
Y3
 ) ] );

1203 
X1
 = 
RK
[1] ^ ( 
FSb
[ (
uöt8
Ë–
Y1
 >> 24 ) ] << 24 ) ^

1204 –
FSb
[ (
uöt8
Ë–
Y2
 >> 16 ) ] << 16 ) ^

1205 –
FSb
[ (
uöt8
Ë–
Y3
 >> 8 ) ] << 8 ) ^

1206 –
FSb
[ (
uöt8
Ë–
Y0
 ) ] );

1208 
X2
 = 
RK
[2] ^ ( 
FSb
[ (
uöt8
Ë–
Y2
 >> 24 ) ] << 24 ) ^

1209 –
FSb
[ (
uöt8
Ë–
Y3
 >> 16 ) ] << 16 ) ^

1210 –
FSb
[ (
uöt8
Ë–
Y0
 >> 8 ) ] << 8 ) ^

1211 –
FSb
[ (
uöt8
Ë–
Y1
 ) ] );

1213 
X3
 = 
RK
[3] ^ ( 
FSb
[ (
uöt8
Ë–
Y3
 >> 24 ) ] << 24 ) ^

1214 –
FSb
[ (
uöt8
Ë–
Y0
 >> 16 ) ] << 16 ) ^

1215 –
FSb
[ (
uöt8
Ë–
Y1
 >> 8 ) ] << 8 ) ^

1216 –
FSb
[ (
uöt8
Ë–
Y2
 ) ] );

1218 
	`PUT_UINT32
–
X0
, 
ouçut
, 0 );

1219 
	`PUT_UINT32
–
X1
, 
ouçut
, 4 );

1220 
	`PUT_UINT32
–
X2
, 
ouçut
, 8 );

1221 
	`PUT_UINT32
–
X3
, 
ouçut
, 12 );

1222 
	}
}

1226 
	$´s_de¸y±
–
´s_c⁄ãxt
 *
˘x
, 
uöt8
 
öput
[16], uöt8 
ouçut
[16] )

1228 
uöt32
 *
RK
, 
X0
, 
X1
, 
X2
, 
X3
, 
Y0
, 
Y1
, 
Y2
, 
Y3
;

1230 
RK
 = 
˘x
->
drk
;

1232 
	`GET_UINT32
–
X0
, 
öput
, 0 ); X0 ^
RK
[0];

1233 
	`GET_UINT32
–
X1
, 
öput
, 4 ); X1 ^
RK
[1];

1234 
	`GET_UINT32
–
X2
, 
öput
, 8 ); X2 ^
RK
[2];

1235 
	`GET_UINT32
–
X3
, 
öput
, 12 ); X3 ^
RK
[3];

1237 
	#AES_RROUND
(
X0
,
X1
,
X2
,
X3
,
Y0
,
Y1
,
Y2
,
Y3
) \

1239 
RK
 += 4; \

1241 
X0
 = 
RK
[0] ^ 
RT0
[ (
uöt8
Ë–
Y0
 >> 24 ) ] ^ \

1242 
RT1
[ (
uöt8
Ë–
Y3
 >> 16 ) ] ^ \

1243 
RT2
[ (
uöt8
Ë–
Y2
 >> 8 ) ] ^ \

1244 
RT3
[ (
uöt8
Ë–
Y1
 ) ]; \

1246 
X1
 = 
RK
[1] ^ 
RT0
[ (
uöt8
Ë–
Y1
 >> 24 ) ] ^ \

1247 
RT1
[ (
uöt8
Ë–
Y0
 >> 16 ) ] ^ \

1248 
RT2
[ (
uöt8
Ë–
Y3
 >> 8 ) ] ^ \

1249 
RT3
[ (
uöt8
Ë–
Y2
 ) ]; \

1251 
X2
 = 
RK
[2] ^ 
RT0
[ (
uöt8
Ë–
Y2
 >> 24 ) ] ^ \

1252 
RT1
[ (
uöt8
Ë–
Y1
 >> 16 ) ] ^ \

1253 
RT2
[ (
uöt8
Ë–
Y0
 >> 8 ) ] ^ \

1254 
RT3
[ (
uöt8
Ë–
Y3
 ) ]; \

1256 
X3
 = 
RK
[3] ^ 
RT0
[ (
uöt8
Ë–
Y3
 >> 24 ) ] ^ \

1257 
RT1
[ (
uöt8
Ë–
Y2
 >> 16 ) ] ^ \

1258 
RT2
[ (
uöt8
Ë–
Y1
 >> 8 ) ] ^ \

1259 
RT3
[ (
uöt8
Ë–
Y0
 ) ]; \

1260 }

	)

1262 
	`AES_RROUND
–
Y0
, 
Y1
, 
Y2
, 
Y3
, 
X0
, 
X1
, 
X2
, 
X3
 );

1263 
	`AES_RROUND
–
X0
, 
X1
, 
X2
, 
X3
, 
Y0
, 
Y1
, 
Y2
, 
Y3
 );

1264 
	`AES_RROUND
–
Y0
, 
Y1
, 
Y2
, 
Y3
, 
X0
, 
X1
, 
X2
, 
X3
 );

1265 
	`AES_RROUND
–
X0
, 
X1
, 
X2
, 
X3
, 
Y0
, 
Y1
, 
Y2
, 
Y3
 );

1266 
	`AES_RROUND
–
Y0
, 
Y1
, 
Y2
, 
Y3
, 
X0
, 
X1
, 
X2
, 
X3
 );

1267 
	`AES_RROUND
–
X0
, 
X1
, 
X2
, 
X3
, 
Y0
, 
Y1
, 
Y2
, 
Y3
 );

1268 
	`AES_RROUND
–
Y0
, 
Y1
, 
Y2
, 
Y3
, 
X0
, 
X1
, 
X2
, 
X3
 );

1269 
	`AES_RROUND
–
X0
, 
X1
, 
X2
, 
X3
, 
Y0
, 
Y1
, 
Y2
, 
Y3
 );

1270 
	`AES_RROUND
–
Y0
, 
Y1
, 
Y2
, 
Y3
, 
X0
, 
X1
, 
X2
, 
X3
 );

1272 if–
˘x
->
ƒ
 > 10 )

1274 
	`AES_RROUND
–
X0
, 
X1
, 
X2
, 
X3
, 
Y0
, 
Y1
, 
Y2
, 
Y3
 );

1275 
	`AES_RROUND
–
Y0
, 
Y1
, 
Y2
, 
Y3
, 
X0
, 
X1
, 
X2
, 
X3
 );

1278 if–
˘x
->
ƒ
 > 12 )

1280 
	`AES_RROUND
–
X0
, 
X1
, 
X2
, 
X3
, 
Y0
, 
Y1
, 
Y2
, 
Y3
 );

1281 
	`AES_RROUND
–
Y0
, 
Y1
, 
Y2
, 
Y3
, 
X0
, 
X1
, 
X2
, 
X3
 );

1286 
RK
 += 4;

1288 
X0
 = 
RK
[0] ^ ( 
RSb
[ (
uöt8
Ë–
Y0
 >> 24 ) ] << 24 ) ^

1289 –
RSb
[ (
uöt8
Ë–
Y3
 >> 16 ) ] << 16 ) ^

1290 –
RSb
[ (
uöt8
Ë–
Y2
 >> 8 ) ] << 8 ) ^

1291 –
RSb
[ (
uöt8
Ë–
Y1
 ) ] );

1293 
X1
 = 
RK
[1] ^ ( 
RSb
[ (
uöt8
Ë–
Y1
 >> 24 ) ] << 24 ) ^

1294 –
RSb
[ (
uöt8
Ë–
Y0
 >> 16 ) ] << 16 ) ^

1295 –
RSb
[ (
uöt8
Ë–
Y3
 >> 8 ) ] << 8 ) ^

1296 –
RSb
[ (
uöt8
Ë–
Y2
 ) ] );

1298 
X2
 = 
RK
[2] ^ ( 
RSb
[ (
uöt8
Ë–
Y2
 >> 24 ) ] << 24 ) ^

1299 –
RSb
[ (
uöt8
Ë–
Y1
 >> 16 ) ] << 16 ) ^

1300 –
RSb
[ (
uöt8
Ë–
Y0
 >> 8 ) ] << 8 ) ^

1301 –
RSb
[ (
uöt8
Ë–
Y3
 ) ] );

1303 
X3
 = 
RK
[3] ^ ( 
RSb
[ (
uöt8
Ë–
Y3
 >> 24 ) ] << 24 ) ^

1304 –
RSb
[ (
uöt8
Ë–
Y2
 >> 16 ) ] << 16 ) ^

1305 –
RSb
[ (
uöt8
Ë–
Y1
 >> 8 ) ] << 8 ) ^

1306 –
RSb
[ (
uöt8
Ë–
Y0
 ) ] );

1308 
	`PUT_UINT32
–
X0
, 
ouçut
, 0 );

1309 
	`PUT_UINT32
–
X1
, 
ouçut
, 4 );

1310 
	`PUT_UINT32
–
X2
, 
ouçut
, 8 );

1311 
	`PUT_UINT32
–
X3
, 
ouçut
, 12 );

1312 
	}
}

1321 
	$F
(*
∑ssw‹d
, *
ssid
, 
ssidÀngth
, 
ôî©i⁄s
, 
cou¡
, *
ouçut
)

1323 
dige°
[36], 
dige°1
[
SHA_DIGEST_LEN
];

1324 
i
, 
j
;

1327 
	`mem˝y
(
dige°
, 
ssid
, 
ssidÀngth
);

1328 
dige°
[
ssidÀngth
] = ()((
cou¡
>>24) & 0xff);

1329 
dige°
[
ssidÀngth
+1] = ()((
cou¡
>>16) & 0xff);

1330 
dige°
[
ssidÀngth
+2] = ()((
cou¡
>>8) & 0xff);

1331 
dige°
[
ssidÀngth
+3] = ()(
cou¡
 & 0xff);

1332 
	`HMAC_SHA1
(
dige°
, 
ssidÀngth
+4, (*Ë
∑ssw‹d
, (Ë
	`°æí
’assw‹d), 
dige°1
);

1335 
	`mem˝y
(
ouçut
, 
dige°1
, 
SHA_DIGEST_LEN
);

1337 
i
 = 1; i < 
ôî©i⁄s
; i++)

1340 
	`HMAC_SHA1
(
dige°1
, 
SHA_DIGEST_LEN
, (*Ë
∑ssw‹d
, (Ë
	`°æí
’assw‹d), 
dige°
);

1341 
	`mem˝y
(
dige°1
, 
dige°
, 
SHA_DIGEST_LEN
);

1344 
j
 = 0; j < 
SHA_DIGEST_LEN
; j++)

1346 
ouçut
[
j
] ^
dige°
[j];

1349 
	}
}

1356 
	$Passw‹dHash
(*
∑ssw‹d
, *
ssid
, 
ssidÀngth
, *
ouçut
)

1358 i‡((
	`°æí
(
∑ssw‹d
Ë> 63Ë|| (
ssidÀngth
 > 32))

1361 
	`F
(
∑ssw‹d
, 
ssid
, 
ssidÀngth
, 4096, 1, 
ouçut
);

1362 
	`F
(
∑ssw‹d
, 
ssid
, 
ssidÀngth
, 4096, 2, &
ouçut
[
SHA_DIGEST_LEN
]);

1364 
	}
}

	@md5.h

39 #i‚def 
uöt8


40 
	#uöt8
 

	)

43 #i‚def 
uöt32


44 
	#uöt32
 

	)

48 #i‚def 
__MD5_H__


49 
	#__MD5_H__


	)

51 
	#MD5_MAC_LEN
 16

	)

53 
	s_MD5_CTX
 {

54 
ULONG
 
	mBuf
[4];

55 
UCHAR
 
	mI≈ut
[64];

56 
ULONG
 
	mLíInBôCou¡
[2];

57 } 
	tMD5_CTX
;

59 
VOID
 
MD5Inô
(
MD5_CTX
 *
pCtx
);

60 
VOID
 
MD5Upd©e
(
MD5_CTX
 *
pCtx
, 
UCHAR
 *
pD©a
, 
ULONG
 
LíInByãs
);

61 
VOID
 
MD5FöÆ
(
UCHAR
 
Dige°
[16], 
MD5_CTX
 *
pCtx
);

62 
VOID
 
MD5Tønsf‹m
(
ULONG
 
Buf
[4], ULONG 
Mes
[16]);

64 
md5_mac
(
u8
 *
key
, 
size_t
 
key_Àn
, u8 *
d©a
, size_à
d©a_Àn
, u8 *
mac
);

65 
hmac_md5
(
u8
 *
key
, 
size_t
 
key_Àn
, u8 *
d©a
, size_à
d©a_Àn
, u8 *
mac
);

70 
	s_SHA_CTX


72 
ULONG
 
	mBuf
[5];

73 
UCHAR
 
	mI≈ut
[80];

74 
ULONG
 
	mLíInBôCou¡
[2];

76 } 
	tSHA_CTX
;

78 
VOID
 
SHAInô
(
SHA_CTX
 *
pCtx
);

79 
UCHAR
 
SHAUpd©e
(
SHA_CTX
 *
pCtx
, UCHAR *
pD©a
, 
ULONG
 
LíInByãs
);

80 
VOID
 
SHAFöÆ
(
SHA_CTX
 *
pCtx
, 
UCHAR
 
Dige°
[20]);

81 
VOID
 
SHATønsf‹m
(
ULONG
 
Buf
[5], ULONG 
Mes
[20]);

83 
	#SHA_DIGEST_LEN
 20

	)

87 #i‚def 
_AES_H


88 
	#_AES_H


	)

92 
uöt32
 
	mîk
[64];

93 
uöt32
 
	mdrk
[64];

94 
	mƒ
;

96 
	t´s_c⁄ãxt
;

98 
´s_£t_key
–
´s_c⁄ãxt
 *
˘x
, 
uöt8
 *
key
, 
nbôs
 );

99 
´s_í¸y±
–
´s_c⁄ãxt
 *
˘x
, 
uöt8
 
öput
[16], uöt8 
ouçut
[16] );

100 
´s_de¸y±
–
´s_c⁄ãxt
 *
˘x
, 
uöt8
 
öput
[16], uöt8 
ouçut
[16] );

102 
F
(*
∑ssw‹d
, *
ssid
, 
ssidÀngth
, 
ôî©i⁄s
, 
cou¡
, *
ouçut
);

103 
Passw‹dHash
(*
∑ssw‹d
, *
ssid
, 
ssidÀngth
, *
ouçut
);

	@mlme.c

39 
	~"π_c⁄fig.h
"

40 
	~<°d¨g.h
>

41 
	~<√t/iw_h™dÀr.h
>

45 
ULONG
 
	gBasicR©eMask
[12] = {0xfffff001 , 0xfffff003 , 0xfffff007 , 0xfffff00f ,

49 
UCHAR
 
	gBROADCAST_ADDR
[
MAC_ADDR_LEN
] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff};

50 
UCHAR
 
	gZERO_MAC_ADDR
[
MAC_ADDR_LEN
] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

56 
CHAR
 
	gRssiSa„LevñF‹TxR©e
[] ={ -92, -91, -90, -87, -88, -86, -85, -83, -81, -78, -72, -71, -40, -40 };

59 
UCHAR
 
	gPhy11BNextR©eDownw¨d
[] = {
RATE_1
, RATE_1, 
RATE_2
, 
RATE_5_5
};

60 
UCHAR
 
	gPhy11BNextR©eUpw¨d
[] = {
RATE_2
, 
RATE_5_5
, 
RATE_11
, RATE_11};

63 
UCHAR
 
	gPhy11BGNextR©eDownw¨d
[]{
RATE_1
, RATE_1, 
RATE_2
, 
RATE_5_5
,
RATE_11
, 
RATE_6
, RATE_11, 
RATE_12
, 
RATE_18
, 
RATE_24
, 
RATE_36
, 
RATE_48
};

64 
UCHAR
 
	gPhy11BGNextR©eUpw¨d
[] = {
RATE_2
, 
RATE_5_5
, 
RATE_11
, 
RATE_12
, 
RATE_9
, RATE_12, 
RATE_18
, 
RATE_24
, 
RATE_36
, 
RATE_48
, 
RATE_54
, RATE_54};

67 
UCHAR
 
	gPhy11ANextR©eDownw¨d
[] = {
RATE_6
, RATE_6, RATE_6, RATE_6, RATE_6, RATE_6, 
RATE_9
, 
RATE_12
, 
RATE_18
, 
RATE_24
, 
RATE_36
, 
RATE_48
};

68 
UCHAR
 
	gPhy11ANextR©eUpw¨d
[] = {
RATE_9
, RATE_9, RATE_9, RATE_9, RATE_9, 
RATE_12
, 
RATE_18
, 
RATE_24
, 
RATE_36
, 
RATE_48
, 
RATE_54
, RATE_54};

71 
USHORT
 
	gR©eUpPER
[] = { 40, 40, 35, 20, 20, 20, 20, 16, 10, 16, 10, 6 };

72 
USHORT
 
	gR©eDownPER
[] = { 50, 50, 45, 45, 35, 35, 35, 35, 25, 25, 25, 13 };

74 
UCHAR
 
	gR©eIdToMbps
[] = { 1, 2, 5, 11, 6, 9, 12, 18, 24, 36, 48, 54, 72, 100};

75 
USHORT
 
	gR©eIdTo500Kbps
[] = { 2, 4, 11, 22, 12, 18, 24, 36, 48, 72, 96, 108, 144, 200};

77 
UCHAR
 
	gZîoSsid
[32] = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

80 
UCHAR
 
	gSsidIe
 = 
IE_SSID
;

81 
UCHAR
 
	gSupR©eIe
 = 
IE_SUPP_RATES
;

82 
UCHAR
 
	gExtR©eIe
 = 
IE_EXT_SUPP_RATES
;

83 
UCHAR
 
	gEΩIe
 = 
IE_ERP
;

84 
UCHAR
 
	gDsIe
 = 
IE_DS_PARM
;

85 
UCHAR
 
	gTimIe
 = 
IE_TIM
;

86 
UCHAR
 
	gW∑Ie
 = 
IE_WPA
;

87 
UCHAR
 
	gW∑2Ie
 = 
IE_WPA2
;

88 
UCHAR
 
	gIbssIe
 = 
IE_IBSS_PARM
;

90 
UCHAR
 
WPA_OUI
[];

91 
UCHAR
 
RSN_OUI
[];

93 
RTMP_RF_REGS
 
	gRF2528RegTabÀ
[] = {

110 
UCHAR
 
	gNUM_OF_2528_CHNL
 = ((
RF2528RegTabÀ
Ë/ (
RTMP_RF_REGS
));

112 
RTMP_RF_REGS
 
	gRF5226RegTabÀ
[] = {

163 
UCHAR
 
	gNUM_OF_5226_CHNL
 = ((
RF5226RegTabÀ
Ë/ (
RTMP_RF_REGS
));

166 
RTMP_RF_REGS
 
	gRF5225RegTabÀ
[] = {

220 
UCHAR
 
	gNUM_OF_5225_CHNL
 = ((
RF5225RegTabÀ
Ë/ (
RTMP_RF_REGS
));

222 
RTMP_RF_REGS
 
	gRF3020RegTabÀ
[] = {

240 
	#NUM_OF_3020_CHNL
 ((
RF3020RegTabÀ
Ë/ (
RTMP_RF_REGS
))

	)

253 
NDIS_STATUS
 
	$MlmeInô
(

254 
IN
 
PRTMP_ADAPTER
 
pAd
)

256 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

258 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "--> MLME Initialize\n");

262 
Sètus
 = 
	`MlmeQueueInô
(&
pAd
->
Mlme
.
Queue
);

263 if(
Sètus
 !
NDIS_STATUS_SUCCESS
)

268 
Sètus
 = 
	`MlmeInôMem‹yH™dÀr
(
pAd
, 20, 
MAX_LEN_OF_MLME_BUFFER
);

269 if(
Sètus
 !
NDIS_STATUS_SUCCESS
)

271 
	`MlmeQueueDe°roy
(&
pAd
->
Mlme
.
Queue
);

275 
pAd
->
Mlme
.
bRu¬ög
 = 
FALSE
;

276 
	`NdisAŒoˇãSpöLock
(&
pAd
->
Mlme
.
TaskLock
);

279 
	`BssTabÀInô
(&
pAd
->
SˇnTab
);

282 
	`ASSERT
(
ASSOC_FUNC_SIZE
 =
MAX_ASSOC_MSG
 * 
MAX_ASSOC_STATE
);

283 
	`AssocSèãMachöeInô
(
pAd
, &pAd->
Mlme
.
AssocMachöe
,ÖAd->Mlme.
AssocFunc
);

285 
	`ASSERT
(
AUTH_FUNC_SIZE
 =
MAX_AUTH_MSG
 * 
MAX_AUTH_STATE
);

286 
	`AuthSèãMachöeInô
(
pAd
, &pAd->
Mlme
.
AuthMachöe
,ÖAd->Mlme.
AuthFunc
);

288 
	`ASSERT
(
AUTH_RSP_FUNC_SIZE
 =
MAX_AUTH_RSP_MSG
 * 
MAX_AUTH_RSP_STATE
);

289 
	`AuthR•SèãMachöeInô
(
pAd
, &pAd->
Mlme
.
AuthR•Machöe
,ÖAd->Mlme.
AuthR•Func
);

291 
	`ASSERT
(
SYNC_FUNC_SIZE
 =
MAX_SYNC_MSG
 * 
MAX_SYNC_STATE
);

292 
	`SyncSèãMachöeInô
(
pAd
, &pAd->
Mlme
.
SyncMachöe
,ÖAd->Mlme.
SyncFunc
);

294 
	`ASSERT
(
WPA_PSK_FUNC_SIZE
 =
MAX_WPA_PSK_MSG
 * 
MAX_WPA_PSK_STATE
);

295 
	`W∑PskSèãMachöeInô
(
pAd
, &pAd->
Mlme
.
W∑PskMachöe
,ÖAd->Mlme.
W∑PskFunc
);

299 
	`MlmeC¡lInô
(
pAd
, &pAd->
Mlme
.
C¡lMachöe
, 
NULL
);

302 
	`RTMPInôTimî
(
pAd
, &pAd->
Mlme
.
PîiodicTimî
, 
	`GET_TIMER_FUNCTION
(
MlmePîiodicExec
),ÖAd, 
TRUE
);

305 
	`RTMPSëTimî
(&
pAd
->
Mlme
.
PîiodicTimî
, 
MLME_TASK_EXEC_INTV
);

308 
	`RTMPInôTimî
(
pAd
, &pAd->
RxA¡
.
RxA¡DivîsôyTimî
, 
	`GET_TIMER_FUNCTION
(
AsicRxA¡EvÆTimeout
),ÖAd, 
FALSE
);

311 
	`RTMPInôTimî
(
pAd
, &pAd->
Mlme
.
LökDownTimî
, 
	`GET_TIMER_FUNCTION
(
LökDownExec
),ÖAd, 
FALSE
);

313 } 
FALSE
);

315 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<-- MLME Initialize\n");

317  
Sètus
;

318 
	}
}

332 
VOID
 
	$MlmeH™dÀr
(

333 
IN
 
PRTMP_ADAPTER
 
pAd
)

335 
MLME_QUEUE_ELEM
 *
EÀm
 = 
NULL
;

336 
IrqFœgs
;

340 
	`NdisAcquúeSpöLock
(&
pAd
->
Mlme
.
TaskLock
, 
IrqFœgs
);

343 if(
pAd
->
Mlme
.
bRu¬ög
)

345 
	`NdisRñó£SpöLock
(&
pAd
->
Mlme
.
TaskLock
, 
IrqFœgs
);

350 
pAd
->
Mlme
.
bRu¬ög
 = 
TRUE
;

353 
	`NdisRñó£SpöLock
(&
pAd
->
Mlme
.
TaskLock
, 
IrqFœgs
);

356 !
	`MlmeQueueEm±y
(&
pAd
->
Mlme
.
Queue
))

358 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_MLME_RESET_IN_PROGRESS
) ||

359 
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
) ||

360 
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
))

362 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Devi˚ HÆãd o∏Removed o∏MlmeRe°,Éxô MlmeH™dÀr! (queuênum = %d)\n", 
pAd
->
Mlme
.
Queue
.
Num
);

366 #ifde‡
RALINK_ATE


367 if(
pAd
->
©e
.
Mode
 !
ATE_STASTART
)

369 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "The driver is in ATE modeÇow\n");

375 i‡(
	`MlmeDequeue
(&
pAd
->
Mlme
.
Queue
, &
EÀm
))

377 i‡(
EÀm
->
MsgTy≥
 =
RT_CMD_RESET_MLME
)

379 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "!!!Ñeset MLME state machine !!!\n");

380 
	`MlmeRe°¨tSèãMachöe
(
pAd
);

381 
	`MlmePo°Re°¨tSèãMachöe
(
pAd
);

382 
EÀm
->
Occupõd
 = 
FALSE
;

383 
EÀm
->
MsgLí
 = 0;

389 
EÀm
->
Machöe
)

391 
ASSOC_STATE_MACHINE
:

392 
	`SèãMachöePîf‹mA˘i⁄
(
pAd
, &pAd->
Mlme
.
AssocMachöe
, 
EÀm
);

394 
AUTH_STATE_MACHINE
:

395 
	`SèãMachöePîf‹mA˘i⁄
(
pAd
, &pAd->
Mlme
.
AuthMachöe
, 
EÀm
);

397 
AUTH_RSP_STATE_MACHINE
:

398 
	`SèãMachöePîf‹mA˘i⁄
(
pAd
, &pAd->
Mlme
.
AuthR•Machöe
, 
EÀm
);

400 
SYNC_STATE_MACHINE
:

401 
	`SèãMachöePîf‹mA˘i⁄
(
pAd
, &pAd->
Mlme
.
SyncMachöe
, 
EÀm
);

403 
MLME_CNTL_STATE_MACHINE
:

404 
	`MlmeC¡lMachöePîf‹mA˘i⁄
(
pAd
, &pAd->
Mlme
.
C¡lMachöe
, 
EÀm
);

406 
WPA_PSK_STATE_MACHINE
:

407 
	`SèãMachöePîf‹mA˘i⁄
(
pAd
, &pAd->
Mlme
.
W∑PskMachöe
, 
EÀm
);

410 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ERROR: Illegal machine in MlmeHandler()\n");

415 
EÀm
->
Occupõd
 = 
FALSE
;

416 
EÀm
->
MsgLí
 = 0;

421 
	`DBGPRINT_ERR
("MlmeHandler: MlmeQueueÉmpty\n");

425 
	`NdisAcquúeSpöLock
(&
pAd
->
Mlme
.
TaskLock
, 
IrqFœgs
);

426 
pAd
->
Mlme
.
bRu¬ög
 = 
FALSE
;

427 
	`NdisRñó£SpöLock
(&
pAd
->
Mlme
.
TaskLock
, 
IrqFœgs
);

429 
	}
}

442 
VOID
 
	$MlmeHÆt
(

443 
IN
 
PRTMP_ADAPTER
 
pAd
)

445 
BOOLEAN
 
C™˚Œed
;

446 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==> MlmeHalt\n");

449 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
AssocTimî
, &
C™˚Œed
);

450 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
RóssocTimî
, &
C™˚Œed
);

451 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
DißssocTimî
, &
C™˚Œed
);

452 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
AuthTimî
, &
C™˚Œed
);

453 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
Bóc⁄Timî
, &
C™˚Œed
);

454 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
SˇnTimî
, &
C™˚Œed
);

455 
	`RTMPC™˚lTimî
(&
pAd
->
Mlme
.
PîiodicTimî
, &
C™˚Œed
);

456 
	`RTMPC™˚lTimî
(&
pAd
->
Mlme
.
LökDownTimî
, &
C™˚Œed
);

458 
	`RTMPu£cDñay
(500000);

460 
	`MlmeQueueDe°roy
(&
pAd
->
Mlme
.
Queue
);

461 
	`NdisFªeSpöLock
(&
pAd
->
Mlme
.
TaskLock
);

463 
	`MlmeFªeMem‹yH™dÀr
(
pAd
);

465 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<== MlmeHalt\n");

466 
	}
}

468 
VOID
 
	$MlmeSu•íd
(

469 
IN
 
PRTMP_ADAPTER
 
pAd
,

470 
IN
 
BOOLEAN
 
lökdown
)

472 
MLME_QUEUE_ELEM
 *
EÀm
 = 
NULL
;

473 
IrqFœgs
;

474 
BOOLEAN
 
C™˚Œed
;

476 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==>MlmeSuspend\n");

479 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
AssocTimî
, &
C™˚Œed
);

480 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
RóssocTimî
, &
C™˚Œed
);

481 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
DißssocTimî
, &
C™˚Œed
);

482 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
AuthTimî
, &
C™˚Œed
);

483 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
Bóc⁄Timî
, &
C™˚Œed
);

484 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
SˇnTimî
, &
C™˚Œed
);

486 
TRUE
)

488 
	`NdisAcquúeSpöLock
(&
pAd
->
Mlme
.
TaskLock
, 
IrqFœgs
);

489 if(
pAd
->
Mlme
.
bRu¬ög
)

491 
	`NdisRñó£SpöLock
(&
pAd
->
Mlme
.
TaskLock
, 
IrqFœgs
);

492 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
))

495 
	`RTMPu£cDñay
(100);

499 
pAd
->
Mlme
.
bRu¬ög
 = 
TRUE
;

500 
	`NdisRñó£SpöLock
(&
pAd
->
Mlme
.
TaskLock
, 
IrqFœgs
);

506 !
	`MlmeQueueEm±y
(&
pAd
->
Mlme
.
Queue
))

509 i‡(
	`MlmeDequeue
(&
pAd
->
Mlme
.
Queue
, &
EÀm
))

512 
EÀm
->
Occupõd
 = 
FALSE
;

513 
EÀm
->
MsgLí
 = 0;

518 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "ERROR:Émpty Elem in MlmeQueue\n");

523 
	`NdisAcquúeSpöLock
(&
pAd
->
Mlme
.
TaskLock
, 
IrqFœgs
);

524 
pAd
->
Mlme
.
bRu¬ög
 = 
FALSE
;

525 
	`NdisRñó£SpöLock
(&
pAd
->
Mlme
.
TaskLock
, 
IrqFœgs
);

527 
	`RTUSBCÀ™UpMLMEWaôQueue
(
pAd
);

528 
	`RTUSBCÀ™UpMLMEBulkOutQueue
(
pAd
);

531 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

532 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

533 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_REQ_IDLE
;

534 
pAd
->
Mlme
.
AuthR•Machöe
.
CuºSèã
 = 
AUTH_RSP_IDLE
;

535 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SYNC_IDLE
;

536 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_JOIN_IN_PROGRESS
))

537 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_JOIN_IN_PROGRESS
);

538 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_REASSOC_IN_PROGRESS
))

539 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_REASSOC_IN_PROGRESS
);

540 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
))

541 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
);

543 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<==MlmeSuspend\n");

544 
	}
}

546 
VOID
 
	$MlmeResume
(

547 
IN
 
PRTMP_ADAPTER
 
pAd
)

549 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==>MlmeResume\n");

551 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_JOIN_IN_PROGRESS
))

552 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_JOIN_IN_PROGRESS
);

553 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_REASSOC_IN_PROGRESS
))

554 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_REASSOC_IN_PROGRESS
);

555 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
))

556 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
);

558 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

559 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

560 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_REQ_IDLE
;

561 
pAd
->
Mlme
.
AuthR•Machöe
.
CuºSèã
 = 
AUTH_RSP_IDLE
;

562 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SYNC_IDLE
;

565 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<==MlmeResume\n");

566 
	}
}

583 
	#ADHOC_BEACON_LOST_TIME
 (10*
HZ
)

584 
VOID
 
	`MlmePîiodicExec
(

	)

585 
IN
 
PVOID
 
	gSy°emS≥cific1
,

586 
IN
 
PVOID
 
	gFun˘i⁄C⁄ãxt
,

587 
IN
 
PVOID
 
	gSy°emS≥cific2
,

588 
IN
 
PVOID
 
	gSy°emS≥cific3
)

590 
RTMP_ADAPTER
 *
	gpAd
 = (RTMP_ADAPTER *)
Fun˘i⁄C⁄ãxt
;

591 
	gIrqFœgs
;

593 if(
VIRTUAL_IF_NUM
(
pAd
)==0)

596 #ifde‡
RALINK_ATE


597 if(
	gpAd
->
	g©e
.
	gMode
 !
ATE_STASTART
)

599 
¥ötk
("RALINK_ATE\n");

608 i‡((
	gpAd
->
	gP‹tCfg
.
	gbH¨dw¨eRadio
 =
TRUE
) &&

609 (!
RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)) &&

610 (!
RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)))

612 
RTUSBEnqueueI¡î«lCmd
(
pAd
, 
RT_OID_CHECK_GPIO
);

617 i‡((
RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) ||

618 (
RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
)) ||

619 (
RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_MEASUREMENT
)) ||

620 (
RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)))

623 i‡(
RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_MEDIA_STATE_PENDING
))

625 
RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_MEDIA_STATE_PENDING
);

626 
DBGPRINT
(
RT_DEBUG_TRACE
, "NDIS_STATUS_MEDIA_DISCONNECT Event B!\n");

632 i‡(
RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
))

634 
¥ötk
("fRTMP_ADAPTER_NIC_NOT_EXIST\n");

635 
RTUSBReje˘PídögPackës
(
pAd
);

639 
	gpAd
->
	gMlme
.
	gNow32
 = 
jiffõs
;

644 i‡(
	gpAd
->
	gRÆökCou¡îs
.
	gMgmtRögFuŒCou¡
 >= 2)

646 
PCmdQElmt
 
cmdqñmt
;

648 
RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
);

650 
NdisAcquúeSpöLock
(&
pAd
->
CmdQLock
, 
IrqFœgs
);

651 
	gpAd
->
	gCmdQ
.
	gsize
 > 0)

653 
RTUSBDequeueCmd
(&
pAd
->
CmdQ
, &
cmdqñmt
);

654 i‡(
	gcmdqñmt
->
	gCmdFromNdis
 =
TRUE
)

656 i‡((
cmdqñmt
->
comm™d
 !
RT_OID_MULTI_READ_MAC
) &&

657 (
cmdqñmt
->
comm™d
 !
RT_OID_VENDOR_READ_BBP
) &&

658 (
cmdqñmt
->
comm™d
 !
RT_OID_USB_VENDOR_EEPROM_READ
))

660 i‡(
cmdqñmt
->
buf„r
 !
NULL
)

661 
k‰ì
(
cmdqñmt
->
buf„r
);

664 
k‰ì
(
cmdqñmt
);

667 
	gcmdqñmt
->
	gInU£
 = 
FALSE
;

669 
NdisRñó£SpöLock
(&
pAd
->
CmdQLock
, 
IrqFœgs
);

671 
RTUSBEnqueueI¡î«lCmd
(
pAd
, 
RT_OID_RESET_FROM_ERROR
);

673 
DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "<---MlmePeriodicExec (Mgmt Ring Full)\n");

676 
	gpAd
->
	gRÆökCou¡îs
.
	gMgmtRögFuŒCou¡
 = 0;

678 
RTUSBEnqueueI¡î«lCmd
(
pAd
, 
RT_OID_PERIODIC_EXECUT
);

680 
RTUSBMlmeUp
(
pAd
);

687 
VOID
 
	$STAMlmePîiodicExec
(

688 
IN
 
PRTMP_ADAPTER
 
pAd
)

690 
TXRX_CSR4_STRUC
 
CurTxRxC§4
;

691 
SHORT
 
dbm
;

692 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


693 
iwªq_d©a
 
wrqu
;

697 i‡(
pAd
->
P‹tCfg
.
bBlockAssoc
 && (pAd->P‹tCfg.
La°MicEº‹Time
 + (60 * 
HZ
Ë<ÖAd->
Mlme
.
Now32
))

698 
pAd
->
P‹tCfg
.
bBlockAssoc
 = 
FALSE
;

700 
	`DBGPRINT
(
RT_DEBUG_INFO
,"MMCHK - PortCfg.Ssid[%d]=%c%c%c%c... MlmeAux.Ssid[%d]=%c%c%c%c...\n",

701 
pAd
->
P‹tCfg
.
SsidLí
,ÖAd->P‹tCfg.
Ssid
[0],ÖAd->PortCfg.Ssid[1],ÖAd->PortCfg.Ssid[2],ÖAd->PortCfg.Ssid[3],

702 
pAd
->
MlmeAux
.
SsidLí
,ÖAd->MlmeAux.
Ssid
[0],ÖAd->MlmeAux.Ssid[1],ÖAd->MlmeAux.Ssid[2],ÖAd->MlmeAux.Ssid[3]);

706 
	`NICUpd©eRawCou¡îs
(
pAd
);

709 
	`AsicBbpTunög
(
pAd
);

711 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

714 
	`MlmeCÆcuœãCh™√lQuÆôy
(
pAd
,ÖAd->
Mlme
.
Now32
);

717 
	`MlmeDy«micTxR©eSwôchög
(
pAd
);

722 
	`AsicAdju°TxPowî
(
pAd
);

725 i‡(((
pAd
->
A¡í«
.
fõld
.
NumOfA¡í«
 =2Ë&& (pAd->A¡í«.fõld.
TxDeÁu…A¡í«
 =0Ë&& (pAd->A¡í«.fõld.
RxDeÁu…A¡í«
 == 0))

726 && (
pAd
->
Mlme
.
PîiodicRound
 % 2 == 1))

730 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

732 
SHORT
 
ªÆavgrssi1
;

733 
BOOLEAN
 
evÆu©e
 = 
FALSE
;

735 i‡(
pAd
->
P‹tCfg
.
NumOfAvgRssiSam∂e
 < 5)

737 
pAd
->
RxA¡
.
Paú1La°AvgRssi
 = (-115);

738 
pAd
->
RxA¡
.
Paú2La°AvgRssi
 = (-115);

739 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MlmePeriodicExec:ÇoÅraffic/beacon,Ñeset RSSI\n");

742 
pAd
->
P‹tCfg
.
NumOfAvgRssiSam∂e
 = 0;

744 
ªÆavgrssi1
 = (
pAd
->
RxA¡
.
Paú1AvgRssi
[pAd->RxA¡.
Paú1Prim¨yRxA¡
] >> 3);

746 
	`DBGPRINT
(
RT_DEBUG_INFO
,"A¡-ªÆrssi0(%d),La°rssi0(%d)\n",
ªÆavgrssi1
, 
pAd
->
RxA¡
.
Paú1La°AvgRssi
);

748 i‡((
ªÆavgrssi1
 > (
pAd
->
RxA¡
.
Paú1La°AvgRssi
 + 5)) || (realavgrssi1 < (pAd->RxAnt.Pair1LastAvgRssi - 5)))

750 
evÆu©e
 = 
TRUE
;

751 
pAd
->
RxA¡
.
Paú1La°AvgRssi
 = 
ªÆavgrssi1
;

754 i‡(
evÆu©e
 =
TRUE
)

756 
	`AsicEvÆu©eSec⁄d¨yRxA¡
(
pAd
);

761 
UCHAR
 
ãmp
;

763 
ãmp
 = 
pAd
->
RxA¡
.
Paú1Prim¨yRxA¡
;

764 
pAd
->
RxA¡
.
Paú1Prim¨yRxA¡
 =ÖAd->RxA¡.
Paú1Sec⁄d¨yRxA¡
;

765 
pAd
->
RxA¡
.
Paú1Sec⁄d¨yRxA¡
 = 
ãmp
;

766 
	`AsicSëRxA¡
(
pAd
,ÖAd->
RxA¡
.
Paú1Prim¨yRxA¡
, 0xFF);

772 i‡((
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 =
SYNC_IDLE
Ë&& (pAd->
P‹tCfg
.
Ch™√l
 <= 14))

774 i‡(
pAd
->
P‹tCfg
.
La°Rssi
 >(-82 +ÖAd->
BbpRssiToDbmDñè
))

776 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R62
, 0x04);

780 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R62
, 0x02);

782 
	`DBGPRINT
(
RT_DEBUG_INFO
, "STAMlmePîiodicExe¯- La°Rssi=%d, BbpRssiToDbmDñè=%d\n", 
pAd
->
P‹tCfg
.
La°Rssi
,ÖAd->
BbpRssiToDbmDñè
);

785 i‡(
	`INFRA_ON
(
pAd
))

789 
	`MlmeCheckPsmCh™ge
(
pAd
,ÖAd->
Mlme
.
Now32
);

794 i‡(
	`INFRA_ON
(
pAd
) &&

795 (
pAd
->
P‹tCfg
.
La°Bóc⁄RxTime
 + 1 * 
HZ
 <ÖAd->
Mlme
.
Now32
) &&

796 ((
pAd
->
BulkInD©aO√SecCou¡
 +ÖAd->
BulkOutD©aO√SecCou¡
) < 600))

798 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 <= 14)

800 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R17
,ÖAd->
BbpTunög
.
R17LowîBoundG
);

804 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R17
,ÖAd->
BbpTunög
.
R17LowîBoundA
);

810 i‡((
pAd
->
Mlme
.
PîiodicRound
 % 10) == 8)

811 
	`RTMPSídNuŒFøme
(
pAd
,ÖAd->
P‹tCfg
.
TxR©e
);

814 i‡(
	`CQI_IS_DEAD
(
pAd
->
Mlme
.
Ch™√lQuÆôy
))

816 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MMCHK - NÿBEACON. Dód CQI. AutÿRecovîyáâem± #%d\n", 
pAd
->
RÆökCou¡îs
.
BadCQIAutoRecovîyCou¡
);

818 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


819 i‡(
pAd
->
P‹tCfg
.
WPA_Suµliˇ¡
 =
TRUE
) {

821 
	`mem£t
(&
wrqu
, 0, (wrqu));

822 
wrqu
.
d©a
.
Êags
 = 
RT_DISASSOC_EVENT_FLAG
;

823 
	`wúñess_£nd_evít
(
pAd
->
√t_dev
, 
IWEVCUSTOM
, &
wrqu
, 
NULL
);

827 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


828 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

829 
	`wext_nŸify_evít_assoc
(
pAd
, 
SIOCGIWAP
, 
FALSE
);

833 
	`RTUSBEnqueueI¡î«lCmd
(
pAd
, 
RT_OID_LINK_DOWN
);

836 
	`MlmeAutoRec⁄√˘La°SSID
(
pAd
);

838 i‡(
	`CQI_IS_BAD
(
pAd
->
Mlme
.
Ch™√lQuÆôy
))

840 
pAd
->
RÆökCou¡îs
.
BadCQIAutoRecovîyCou¡
 ++;

841 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MMCHK - Bad CQI. AutÿRecovîyáâem± #%d\n", 
pAd
->
RÆökCou¡îs
.
BadCQIAutoRecovîyCou¡
);

842 
	`MlmeAutoRec⁄√˘La°SSID
(
pAd
);

846 i‡(
	`CQI_IS_POOR
(
pAd
->
Mlme
.
Ch™√lQuÆôy
))

852 i‡(
pAd
->
P‹tCfg
.
AuthMode
 < 
Ndis802_11AuthModeWPA
)

853 
	`MlmeCheckF‹Rﬂmög
(
pAd
,ÖAd->
Mlme
.
Now32
);

857 i‡(
pAd
->
P‹tCfg
.
bFa°Rﬂmög
)

860 
INT
 
RxSig«l
 = 
pAd
->
P‹tCfg
.
La°Rssi
 -ÖAd->
BbpRssiToDbmDñè
;

862 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RxSig«»%d\n", 
RxSig«l
);

864 i‡(
pAd
->
P‹tCfg
.
La°Rssi
 <’Ad->
BbpRssiToDbmDñè
 -ÖAd->P‹tCfg.
dBmToRﬂm
))

866 
	`MlmeCheckF‹Fa°Rﬂmög
(
pAd
,ÖAd->
Mlme
.
Now32
);

872 #i‚de‡
SINGLE_ADHOC_LINKUP


873 i‡(
	`ADHOC_ON
(
pAd
Ë&& 
	`OPSTATUS_TEST_FLAG
’Ad, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

879 i‡((
pAd
->
P‹tCfg
.
La°Bóc⁄RxTime
 + 
ADHOC_BEACON_LOST_TIME
 <ÖAd->
Mlme
.
Now32
))

881 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MMCHK -Éxcessive BEACONÜost,Üast STA inÅhis IBSS, MediaState=Disconnected\n");

883 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
);

885 
	`BssTabÀDñëeE¡ry
(&
pAd
->
SˇnTab
,ÖAd->
P‹tCfg
.
Bssid
,ÖAd->P‹tCfg.
Ch™√l
);

887 
pAd
->
P‹tCfg
.
La°SˇnTime
 =ÖAd->
Mlme
.
Now32
;

893 i‡(!
	`ADHOC_ON
(
pAd
Ë&& !
	`INFRA_ON
’AdË&& 
	`RAUSB0_IF_UP_CHECK
(pAd))

895 
	`DBGPRINT
(
RT_DEBUG_INFO
, "MLMEÖeriodicÉxec,Çoássociation so far\n");

896 i‡((
pAd
->
P‹tCfg
.
bAutoRec⁄√˘
 =
TRUE
) &&

897 (
	`MlmeVÆid©eSSID
(
pAd
->
MlmeAux
.
AutoRec⁄√˘Ssid
,ÖAd->MlmeAux.
AutoRec⁄√˘SsidLí
Ë=
TRUE
))

899 i‡((
pAd
->
SˇnTab
.
BssNr
==0Ë&& (pAd->
Mlme
.
C¡lMachöe
.
CuºSèã
 =
CNTL_IDLE
))

902 
MLME_SCAN_REQ_STRUCT
 
SˇnReq
;

904 i‡((
pAd
->
P‹tCfg
.
La°SˇnTime
 + 10 * 
HZ
Ë<ÖAd->
Mlme
.
Now32
)

906 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - Nÿm©chög BSS, sèπáÇew ACTIVE sˇ¿SSID[%s]\n", 
pAd
->
MlmeAux
.
AutoRec⁄√˘Ssid
);

907 
	`SˇnP¨mFûl
(
pAd
, &
SˇnReq
,ÖAd->
MlmeAux
.
AutoRec⁄√˘Ssid
,ÖAd->MlmeAux.
AutoRec⁄√˘SsidLí
, 
BSS_ANY
, 
SCAN_ACTIVE
);

908 
	`MlmeEnqueue
(
pAd
, 
SYNC_STATE_MACHINE
, 
MT2_MLME_SCAN_REQ
, (
MLME_SCAN_REQ_STRUCT
), &
SˇnReq
);

909 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_OID_LIST_SCAN
;

911 
pAd
->
P‹tCfg
.
La°SˇnTime
 =ÖAd->
Mlme
.
Now32
;

913 i‡(
pAd
->
P‹tCfg
.
BssTy≥
 =
BSS_ADHOC
)

915 
	`MlmeAutoRec⁄√˘La°SSID
(
pAd
);

918 i‡(
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 =
CNTL_IDLE
)

920 i‡((
pAd
->
Mlme
.
PîiodicRound
 % 20) == 8)

922 
	`MlmeAutoSˇn
(
pAd
);

923 
pAd
->
P‹tCfg
.
La°SˇnTime
 =ÖAd->
Mlme
.
Now32
;

925 i‡((
pAd
->
Mlme
.
PîiodicRound
 % 2) == 0)

927 
	`MlmeAutoRec⁄√˘La°SSID
(
pAd
);

929 
	`DBGPRINT
(
RT_DEBUG_INFO
, "pAd->PortCfg.bAutoReconnect is TRUE\n");

935 i‡((
pAd
->
P‹tCfg
.
BssTy≥
 =
BSS_ADHOC
) &&

936 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAN⁄e
)&&

937 ((
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
) ||

938 (
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)) &&

939 (
pAd
->
P‹tCfg
.
W∑Sèã
 =
SS_START
))

941 
	`RTMPWPAN⁄eAddKeyProc
(
pAd
,ÖAd->
P‹tCfg
.
PskKey
.
Key
);

944 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_NOTUSE
;

953 i‡(
	`ADHOC_ON
(
pAd
))

962 i‡((
pAd
->
P‹tCfg
.
bIEEE80211H
 =0Ë|| (pAd->P‹tCfg.
Rad¨Dëe˘
.
RDMode
 =
RD_NORMAL_MODE
))

963 
	`EnqueueBóc⁄Føme
(
pAd
);

965 i‡((
pAd
->
P‹tCfg
.
Ch™√l
 <= 14) &&

966 (
pAd
->
P‹tCfg
.
MaxTxR©e
 <
RATE_11
) &&

967 (
pAd
->
P‹tCfg
.
MaxDesúedR©e
 > 
RATE_11
) &&

968 ((
pAd
->
P‹tCfg
.
La°11bBóc⁄RxTime
 + 5 * 
HZ
Ë<ÖAd->
Mlme
.
Now32
))

970 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MMCHK -Üast 11BÖeerÜeft, update TxÑates\n");

972 
	`NdisMoveMem‹y
(
pAd
->
A˘iveCfg
.
SupR©e
,ÖAd->
P‹tCfg
.SupR©e, 
MAX_LEN_OF_SUPPORTED_RATES
);

973 
pAd
->
A˘iveCfg
.
SupR©eLí
 =ÖAd->
P‹tCfg
.SupRateLen;

975 
	`MlmeUpd©eTxR©es
(
pAd
, 
FALSE
);

976 
	`MakeIbssBóc⁄
(
pAd
);

977 
	`AsicE«bÀIbssSync
(
pAd
);

982 i‡(((
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11A
Ë|| (pAd->P‹tCfg.PhyModê=
PHY_11ABG_MIXED
)Ë&& (pAd->P‹tCfg.
bIEEE80211H
 =1Ë&& 
	`Rad¨Ch™√lCheck
’Ad,ÖAd->P‹tCfg.
Ch™√l
))

985 i‡(
pAd
->
P‹tCfg
.
Rad¨Dëe˘
.
RDMode
 =
RD_SILENCE_MODE
)

987 
pAd
->
P‹tCfg
.
Rad¨Dëe˘
.
RDCou¡
++;

990 i‡(
pAd
->
P‹tCfg
.
Rad¨Dëe˘
.
RDCou¡
 > 65)

992 i‡(
	`Rad¨Dëe˘i⁄St›
(
pAd
))

994 
pAd
->
ExåaInfo
 = 
DETECT_RADAR_SIGNAL
;

995 
pAd
->
P‹tCfg
.
Rad¨Dëe˘
.
RDCou¡
 = 0;

996 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "FoundÑadar signal!!!\n\n");

1000 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Not foundÑadar signal, start send beacon\n");

1001 
	`AsicE«bÀIbssSync
(
pAd
);

1002 
pAd
->
P‹tCfg
.
Rad¨Dëe˘
.
RDMode
 = 
RD_NORMAL_MODE
;

1011 i‡(((
pAd
->
Mlme
.
PîiodicRound
 % 2) == 0) &&

1012 (
	`INFRA_ON
(
pAd
Ë|| 
	`ADHOC_ON
(pAd)))

1014 
	`RTMPSëSig«lLED
(
pAd
,ÖAd->
P‹tCfg
.
La°Rssi
 -ÖAd->
BbpRssiToDbmDñè
);

1017 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

1023 
dbm
 = 
pAd
->
P‹tCfg
.
AvgRssi
 -ÖAd->
BbpRssiToDbmDñè
;

1028 i‡(
	`INFRA_ON
(
pAd
))

1030 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MAX_RETRY_ENABLED
))

1032 i‡(
pAd
->
RÆökCou¡îs
.
O√SecTxNoRëryOkCou¡
 > 15)

1034 
	`RTUSBRódMACRegi°î
(
pAd
, 
TXRX_CSR4
, &
CurTxRxC§4
.
w‹d
);

1035 
CurTxRxC§4
.
fõld
.
Sh‹tRëryLimô
 = 0x07;

1036 
CurTxRxC§4
.
fõld
.
L⁄gRëryLimô
 = 0x04;

1037 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR4
, 
CurTxRxC§4
.
w‹d
);

1038 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_MAX_RETRY_ENABLED
);

1043 i‡(
pAd
->
RÆökCou¡îs
.
O√SecTxNoRëryOkCou¡
 <= 15)

1045 
	`RTUSBRódMACRegi°î
(
pAd
, 
TXRX_CSR4
, &
CurTxRxC§4
.
w‹d
);

1046 
CurTxRxC§4
.
fõld
.
Sh‹tRëryLimô
 = 0x0f;

1047 
CurTxRxC§4
.
fõld
.
L⁄gRëryLimô
 = 0x0f;

1048 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR4
, 
CurTxRxC§4
.
w‹d
);

1049 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_MAX_RETRY_ENABLED
);

1054 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_RTS_PROTECTION_ENABLE
))

1056 i‡((
dbm
 > -60Ë|| (
pAd
->
RÆökCou¡îs
.
O√SecTxNoRëryOkCou¡
 > 15))

1057 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_RTS_PROTECTION_ENABLE
);

1064 i‡((
dbm
 <-60Ë&& (
pAd
->
RÆökCou¡îs
.
O√SecTxNoRëryOkCou¡
 <= 15))

1066 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_RTS_PROTECTION_ENABLE
);

1074 
pAd
->
BulkLa°O√SecCou¡
 =ÖAd->
BulkOutD©aO√SecCou¡
 +ÖAd->
BulkInD©aO√SecCou¡
;

1075 
pAd
->
BulkOutD©aO√SecCou¡
 = 0;

1076 
pAd
->
BulkInD©aO√SecCou¡
 = 0;

1079 
pAd
->
RÆökCou¡îs
.
O√SecBóc⁄SítC¡
 = 0;

1080 
pAd
->
RÆökCou¡îs
.
O√SecFÆ£CCAC¡
 = 0;

1081 
pAd
->
RÆökCou¡îs
.
O√SecRxFcsEºC¡
 = 0;

1082 
pAd
->
RÆökCou¡îs
.
O√SecRxOkC¡
 = 0;

1083 
pAd
->
RÆökCou¡îs
.
O√SecTxFaûCou¡
 = 0;

1084 
pAd
->
RÆökCou¡îs
.
O√SecTxNoRëryOkCou¡
 = 0;

1085 
pAd
->
RÆökCou¡îs
.
O√SecTxRëryOkCou¡
 = 0;

1088 
pAd
->
RÆökCou¡îs
.
O√SecOsTxCou¡
[
QID_AC_BE
] = 0;

1089 
pAd
->
RÆökCou¡îs
.
O√SecOsTxCou¡
[
QID_AC_BK
] = 0;

1090 
pAd
->
RÆökCou¡îs
.
O√SecOsTxCou¡
[
QID_AC_VI
] = 0;

1091 
pAd
->
RÆökCou¡îs
.
O√SecOsTxCou¡
[
QID_AC_VO
] = 0;

1092 
pAd
->
RÆökCou¡îs
.
O√SecDmaD⁄eCou¡
[
QID_AC_BE
] = 0;

1093 
pAd
->
RÆökCou¡îs
.
O√SecDmaD⁄eCou¡
[
QID_AC_BK
] = 0;

1094 
pAd
->
RÆökCou¡îs
.
O√SecDmaD⁄eCou¡
[
QID_AC_VI
] = 0;

1095 
pAd
->
RÆökCou¡îs
.
O√SecDmaD⁄eCou¡
[
QID_AC_VO
] = 0;

1096 
pAd
->
RÆökCou¡îs
.
O√SecTxD⁄eCou¡
 = 0;

1097 
pAd
->
RÆökCou¡îs
.
O√SecTxAggªg©i⁄Cou¡
 = 0;

1098 
pAd
->
RÆökCou¡îs
.
O√SecRxAggªg©i⁄Cou¡
 = 0;

1100 
pAd
->
Mlme
.
PîiodicRound
 ++;

1101 
	}
}

1103 
VOID
 
	$LökDownExec
(

1104 
IN
 
PVOID
 
Sy°emS≥cific1
,

1105 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

1106 
IN
 
PVOID
 
Sy°emS≥cific2
,

1107 
IN
 
PVOID
 
Sy°emS≥cific3
)

1110 
	}
}

1112 
VOID
 
	$MlmeAutoSˇn
(

1113 
IN
 
PRTMP_ADAPTER
 
pAd
)

1117 i‡(
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 =
CNTL_IDLE
)

1119 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MMCHK - Driveráuto scan\n");

1120 
	`MlmeEnqueue
(
pAd
,

1121 
MLME_CNTL_STATE_MACHINE
,

1122 
OID_802_11_BSSID_LIST_SCAN
,

1124 
NULL
);

1125 
	`RTUSBMlmeUp
(
pAd
);

1127 
	}
}

1129 
VOID
 
	$MlmeAutoRecovîNëw‹k
(

1130 
IN
 
PRTMP_ADAPTER
 
pAd
)

1133 i‡(
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 =
CNTL_IDLE
)

1135 
NDIS_802_11_SSID
 
OidSsid
;

1136 
OidSsid
.
SsidLígth
 = 
pAd
->
P‹tCfg
.
SsidLí
;

1137 
	`NdisMoveMem‹y
(
OidSsid
.
Ssid
, 
pAd
->
P‹tCfg
.Ssid,ÖAd->P‹tCfg.
SsidLí
);

1139 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MMCHK - DrivîáutÿªcovîögÇëw‹k - %s\n", 
pAd
->
P‹tCfg
.
Ssid
);

1141 
	`MlmeEnqueue
(
pAd
,

1142 
MLME_CNTL_STATE_MACHINE
,

1143 
OID_802_11_SSID
,

1144 (
NDIS_802_11_SSID
),

1145 &
OidSsid
);

1146 
	`RTUSBMlmeUp
(
pAd
);

1149 
	}
}

1152 
VOID
 
	$MlmeAutoRec⁄√˘La°SSID
(

1153 
IN
 
PRTMP_ADAPTER
 
pAd
)

1156 
MLME_SCAN_REQ_STRUCT
 
SˇnReq
;

1157 
ULONG
 
Now

pAd
->
Mlme
.
Now32
;

1158 i‡((
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 =
CNTL_IDLE
Ë&& (’Ad->
P‹tCfg
.
La°SˇnTime
 + (10*
HZ
)Ë>
Now
))

1160 i‡(
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 =
CNTL_IDLE
 &&

1161 (
	`MlmeVÆid©eSSID
(
pAd
->
MlmeAux
.
AutoRec⁄√˘Ssid
,ÖAd->MlmeAux.
AutoRec⁄√˘SsidLí
Ë=
TRUE
))

1163 
NDIS_802_11_SSID
 
OidSsid
;

1164 
OidSsid
.
SsidLígth
 = 
pAd
->
MlmeAux
.
AutoRec⁄√˘SsidLí
;

1165 
	`NdisMoveMem‹y
(
OidSsid
.
Ssid
, 
pAd
->
MlmeAux
.
AutoRec⁄√˘Ssid
,ÖAd->MlmeAux.
AutoRec⁄√˘SsidLí
);

1167 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Drivîáutÿªc⁄√˘Åÿœ° OID_802_11_SSID sëtög - %s\n", 
pAd
->
MlmeAux
.
AutoRec⁄√˘Ssid
);

1170 if(
OidSsid
.
SsidLígth
)

1172 
	`MlmeEnqueue
(
pAd
,

1173 
MLME_CNTL_STATE_MACHINE
,

1174 
OID_802_11_SSID
,

1175 (
NDIS_802_11_SSID
),

1176 &
OidSsid
);

1177 
	`RTUSBMlmeUp
(
pAd
);

1181 i‡((
pAd
->
P‹tCfg
.
La°SˇnTime
 + (10*
HZ
)Ë< 
Now
)

1184 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MMCHK - FastRoaming, NoÉligableÉntry,ÅryÇew scan!\n");

1186 
pAd
->
P‹tCfg
.
SˇnC¡
 = 2;

1187 
pAd
->
P‹tCfg
.
La°SˇnTime
 = 
Now
;

1189 
	`SˇnP¨mFûl
(
pAd
, &
SˇnReq
,ÖAd->
MlmeAux
.
AutoRec⁄√˘Ssid
,ÖAd->MlmeAux.
AutoRec⁄√˘SsidLí
, 
BSS_ANY
, 
SCAN_ACTIVE
);

1191 
	`MlmeEnqueue
(
pAd
, 
SYNC_STATE_MACHINE
, 
MT2_MLME_SCAN_REQ
,

1192 (
MLME_SCAN_REQ_STRUCT
), &
SˇnReq
);

1193 
	`RTUSBMlmeUp
(
pAd
);

1194 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_OID_LIST_SCAN
;

1196 
	}
}

1205 
BOOLEAN
 
	$MlmeVÆid©eSSID
(

1206 
IN
 
PUCHAR
 
pSsid
,

1207 
IN
 
UCHAR
 
SsidLí
)

1209 
ödex
;

1211 i‡(
SsidLí
 > 
MAX_LEN_OF_SSID
)

1212  (
FALSE
);

1215 
ödex
 = 0; index < 
SsidLí
; index++)

1217 i‡(
pSsid
[
ödex
] < 0x20)

1218  (
FALSE
);

1222  (
TRUE
);

1223 
	}
}

1235 
VOID
 
	$MlmeCheckF‹Rﬂmög
(

1236 
IN
 
PRTMP_ADAPTER
 
pAd
,

1237 
IN
 
ULONG
 
Now32
)

1239 
USHORT
 
i
;

1240 
BSS_TABLE
 *
pRﬂmTab
 = &
pAd
->
MlmeAux
.
RﬂmTab
;

1241 
BSS_ENTRY
 *
pBss
;

1243 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==> MlmeCheckF‹Rﬂmög::pAd->SˇnTab.BssN∏%d\n", 
pAd
->
SˇnTab
.
BssNr
);

1245 
	`BssTabÀInô
(
pRﬂmTab
);

1246 
i
 = 0; i < 
pAd
->
SˇnTab
.
BssNr
; i++)

1248 
pBss
 = &
pAd
->
SˇnTab
.
BssE¡ry
[
i
];

1250 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MlmeCheckF‹Rﬂmög::pBss->La°Bóc⁄RxTimê%d\n", 
pBss
->
La°Bóc⁄RxTime
);

1251 i‡((
pBss
->
La°Bóc⁄RxTime
 + 
BEACON_LOST_TIME
Ë< 
Now32
)

1253 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "1: AP dißµór::Now32 = %d\n", 
Now32
);

1256 i‡(
pBss
->
Rssi
 <
RSSI_THRESHOLD_FOR_ROAMING
)

1258 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "2: RSSIÅoÿwók::Rssi[%d] - RSSI_THRESHOLD_FOR_ROAMING[%d]\n", 
pBss
->
Rssi
, 
RSSI_THRESHOLD_FOR_ROAMING
);

1261 i‡(
	`MAC_ADDR_EQUAL
(
pBss
->
Bssid
, 
pAd
->
P‹tCfg
.Bssid))

1263 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "3: skip current AP\n");

1266 i‡(!
	`SSID_EQUAL
(
pBss
->
Ssid
,ÖBss->
SsidLí
, 
pAd
->
P‹tCfg
.Ssid,ÖAd->PortCfg.SsidLen))

1268 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "4: skip different SSID\n");

1271 i‡(
pBss
->
Rssi
 < (
pAd
->
P‹tCfg
.
La°Rssi
 + 
RSSI_DELTA
))

1273 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "5: only AP with stronger RSSI isÉligible forÑoaming\n");

1277 
	`NdisMoveMem‹y
(&
pRﬂmTab
->
BssE¡ry
[pRﬂmTab->
BssNr
], 
pBss
, (
BSS_ENTRY
));

1278 
pRﬂmTab
->
BssNr
 += 1;

1281 i‡(
pRﬂmTab
->
BssNr
 > 0)

1284 i‡(
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 =
CNTL_IDLE
)

1286 
pAd
->
RÆökCou¡îs
.
Po‹CQIRﬂmögCou¡
 ++;

1287 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MMCHK - Rﬂmögáâem± #%d\n", 
pAd
->
RÆökCou¡îs
.
Po‹CQIRﬂmögCou¡
);

1288 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_MLME_ROAMING_REQ
, 0, 
NULL
);

1289 
	`RTUSBMlmeUp
(
pAd
);

1292 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<=MlmeCheckF‹Rﬂmög(# o‡ˇndid©e%d)\n",
pRﬂmTab
->
BssNr
);

1293 
	}
}

1305 
VOID
 
	$MlmeCheckF‹Fa°Rﬂmög
(

1306 
IN
 
PRTMP_ADAPTER
 
pAd
,

1307 
IN
 
ULONG
 
Now
)

1309 
USHORT
 
i
;

1310 
BSS_TABLE
 *
pRﬂmTab
 = &
pAd
->
MlmeAux
.
RﬂmTab
;

1311 
BSS_ENTRY
 *
pBss
;

1312 
MLME_SCAN_REQ_STRUCT
 
SˇnReq
;

1313 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==> MlmeCheckForFastRoaming\n");

1319 i‡((
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 =
CNTL_IDLE
Ë&& (’Ad->
P‹tCfg
.
La°SˇnTime
 + 10 * 
HZ
Ë>
Now
))

1321 
	`BssTabÀInô
(
pRﬂmTab
);

1324 
i
 = 0; i < 
pAd
->
SˇnTab
.
BssNr
; i++)

1326 
pBss
 = &
pAd
->
SˇnTab
.
BssE¡ry
[
i
];

1330 if(
pBss
->
Rssi
<=45)

1332 i‡(
	`MAC_ADDR_EQUAL
(
pBss
->
Bssid
, 
pAd
->
P‹tCfg
.Bssid))

1336 i‡(!
	`SSID_EQUAL
(
pBss
->
Ssid
,ÖBss->
SsidLí
, 
pAd
->
P‹tCfg
.Ssid,ÖAd->PortCfg.SsidLen) &&pBss->SsidLen>0&&pBss->Ssid[0]!=0 )

1338 i‡(
pBss
->
Rssi
 < (
pAd
->
P‹tCfg
.
La°Rssi
 + 
RSSI_DELTA
))

1341 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "La°Rssò%d,ÖBss->Rssò%d\n", 
pAd
->
P‹tCfg
.
La°Rssi
, 
pBss
->
Rssi
);

1343 
	`NdisMoveMem‹y
(&
pRﬂmTab
->
BssE¡ry
[pRﬂmTab->
BssNr
], 
pBss
, (
BSS_ENTRY
));

1346 if(
pBss
->
SsidLí
==0||pBss->
Ssid
[0]==0)

1348 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Rﬂmög Wôh NULL SSIDánd BSSID[#%d]=%s", 
pRﬂmTab
->
BssNr
,
pBss
->
Bssid
);

1349 
pRﬂmTab
->
BssE¡ry
[pRﬂmTab->
BssNr
].
SsidLí
=
pAd
->
P‹tCfg
.SsidLen;

1350 
	`NdisMoveMem‹y
(
pRﬂmTab
->
BssE¡ry
[pRﬂmTab->
BssNr
].
Ssid
, 
pAd
->
P‹tCfg
.Ssid,ÖAd->P‹tCfg.
SsidLí
);

1351 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Rﬂmög Wôh NULL SSIDá·î modifõdÅhêBSSID[#%d]=%†wôh SSID[%d]=%s", 
pRﬂmTab
->
BssNr
,
pBss
->
Bssid
,pRﬂmTab->
BssE¡ry
[pRﬂmTab->BssNr].
SsidLí
,pRﬂmTab->BssE¡ry[pRﬂmTab->BssNr].
Ssid
);

1353 
pRﬂmTab
->
BssNr
 += 1;

1356 i‡(
pRﬂmTab
->
BssNr
 > 0)

1359 
pAd
->
RÆökCou¡îs
.
Po‹CQIRﬂmögCou¡
 ++;

1360 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MMCHK - Rﬂmögáâem± #%d\n", 
pAd
->
RÆökCou¡îs
.
Po‹CQIRﬂmögCou¡
);

1361 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_MLME_ROAMING_REQ
, 0, 
NULL
);

1362 
	`RTUSBMlmeUp
(
pAd
);

1369 i‡((
pAd
->
P‹tCfg
.
La°SˇnTime
 + 10*
HZ
Ë< 
Now
)

1373 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MMCHK - Rﬂmög, NÿñigabÀÉ¡ry,ÅryáÇew ACTIVE sˇ¿SSID[%s]\n", 
pAd
->
MlmeAux
.
AutoRec⁄√˘Ssid
);

1374 
pAd
->
P‹tCfg
.
SˇnC¡
 = 2;

1375 
pAd
->
P‹tCfg
.
La°SˇnTime
 = 
Now
;

1376 
	`SˇnP¨mFûl
(
pAd
, &
SˇnReq
,ÖAd->
MlmeAux
.
AutoRec⁄√˘Ssid
,ÖAd->MlmeAux.
AutoRec⁄√˘SsidLí
, 
BSS_ANY
, 
SCAN_ACTIVE
);

1377 
	`MlmeEnqueue
(
pAd
, 
SYNC_STATE_MACHINE
, 
MT2_MLME_SCAN_REQ
,

1378 (
MLME_SCAN_REQ_STRUCT
), &
SˇnReq
);

1379 
	`RTUSBMlmeUp
(
pAd
);

1380 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_OID_LIST_SCAN
;

1384 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<== MlmeCheckForFastRoaming\n");

1385 
	}
}

1405 
VOID
 
	$MlmeCÆcuœãCh™√lQuÆôy
(

1406 
IN
 
PRTMP_ADAPTER
 
pAd
,

1407 
IN
 
ULONG
 
Now32
)

1409 
ULONG
 
TxOkC¡
, 
TxC¡
, 
TxPER
, 
TxPRR
;

1410 
ULONG
 
RxC¡
, 
RxPER
;

1411 
UCHAR
 
N‹Rssi
;

1416 
TxOkC¡
 = 
pAd
->
RÆökCou¡îs
.
O√SecTxNoRëryOkCou¡
 +ÖAd->RÆökCou¡îs.
O√SecTxRëryOkCou¡
;

1417 
TxC¡
 = 
TxOkC¡
 + 
pAd
->
RÆökCou¡îs
.
O√SecTxFaûCou¡
;

1418 i‡(
TxC¡
 < 5)

1420 
TxPER
 = 0;

1421 
TxPRR
 = 0;

1425 
TxPER
 = (
pAd
->
RÆökCou¡îs
.
O√SecTxFaûCou¡
 * 100Ë/ 
TxC¡
;

1426 
TxPRR
 = ((
TxC¡
 - 
pAd
->
RÆökCou¡îs
.
O√SecTxNoRëryOkCou¡
) * 100) / TxCnt;

1432 
RxC¡
 = 
pAd
->
RÆökCou¡îs
.
O√SecRxOkC¡
 +ÖAd->RÆökCou¡îs.
O√SecRxFcsEºC¡
;

1433 i‡(
RxC¡
 < 5)

1434 
RxPER
 = 0;

1436 
RxPER
 = (
pAd
->
RÆökCou¡îs
.
O√SecRxFcsEºC¡
 * 100Ë/ 
RxC¡
;

1441 i‡(
	`INFRA_ON
(
pAd
) &&

1442 (
TxOkC¡
 < 2) &&

1443 (
pAd
->
P‹tCfg
.
La°Bóc⁄RxTime
 + 
BEACON_LOST_TIME
 < 
Now32
))

1445 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "BEACONÜo° > %d m£¯wôh TxOkC¡=%d -> CQI=0\n", 
BEACON_LOST_TIME
, 
TxOkC¡
);

1446 
pAd
->
Mlme
.
Ch™√lQuÆôy
 = 0;

1451 i‡(
pAd
->
P‹tCfg
.
La°Rssi
 > 0x50)

1452 
N‹Rssi
 = 100;

1453 i‡(
pAd
->
P‹tCfg
.
La°Rssi
 < 0x20)

1454 
N‹Rssi
 = 0;

1456 
N‹Rssi
 = (
pAd
->
P‹tCfg
.
La°Rssi
 - 0x20) * 2;

1459 
pAd
->
Mlme
.
Ch™√lQuÆôy
 = (
RSSI_WEIGHTING
 * 
N‹Rssi
 +

1460 
TX_WEIGHTING
 * (100 - 
TxPRR
) +

1461 
RX_WEIGHTING
* (100 - 
RxPER
)) / 100;

1462 i‡(
pAd
->
Mlme
.
Ch™√lQuÆôy
 >= 100)

1463 
pAd
->
Mlme
.
Ch™√lQuÆôy
 = 100;

1466 
	`DBGPRINT
(
RT_DEBUG_INFO
, "MMCHK - CQI= %d (Tx Fail=%d/Retry=%d/Total=%d, Rx Fail=%d/Total=%d, RSSI=%d dbm)\n",

1467 
pAd
->
Mlme
.
Ch™√lQuÆôy
,

1468 
pAd
->
RÆökCou¡îs
.
O√SecTxFaûCou¡
,

1469 
pAd
->
RÆökCou¡îs
.
O√SecTxRëryOkCou¡
,

1470 
TxC¡
,

1471 
pAd
->
RÆökCou¡îs
.
O√SecRxFcsEºC¡
,

1472 
RxC¡
, 
pAd
->
P‹tCfg
.
La°Rssi
 -ÖAd->
BbpRssiToDbmDñè
);

1474 
	}
}

1492 
VOID
 
	$MlmeDy«micTxR©eSwôchög
(

1493 
IN
 
PRTMP_ADAPTER
 
pAd
)

1495 
UCHAR
 
UpR©e
, 
DownR©e
, 
CuºR©e
;

1496 
ULONG
 
TxTŸÆC¡
, 
NewBasicR©eBôm≠
;

1497 
ULONG
 
TxEº‹R©io
 = 0;

1498 
BOOLEAN
 
fUpgødeQuÆôy
 = 
FALSE
;

1499 
SHORT
 
dbm
 = 
pAd
->
P‹tCfg
.
AvgRssi
 -ÖAd->
BbpRssiToDbmDñè
;

1501 
CuºR©e
 = 
pAd
->
P‹tCfg
.
TxR©e
;

1504 
NewBasicR©eBôm≠
 = 
pAd
->
P‹tCfg
.
BasicR©eBôm≠
 & 
BasicR©eMask
[
CuºR©e
];

1505 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR5
, 
NewBasicR©eBôm≠
);

1510 
TxTŸÆC¡
 = 
pAd
->
RÆökCou¡îs
.
O√SecTxNoRëryOkCou¡
 +

1511 
pAd
->
RÆökCou¡îs
.
O√SecTxRëryOkCou¡
 +

1512 
pAd
->
RÆökCou¡îs
.
O√SecTxFaûCou¡
;

1514 i‡(
TxTŸÆC¡
)

1515 
TxEº‹R©io
 = ((
pAd
->
RÆökCou¡îs
.
O√SecTxRëryOkCou¡
 +ÖAd->RÆökCou¡îs.
O√SecTxFaûCou¡
Ë*100Ë/ 
TxTŸÆC¡
;

1530 i‡(! 
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_TX_RATE_SWITCH_ENABLED
))

1537 i‡(
TxTŸÆC¡
 <= 15)

1539 
TxEº‹R©io
 = 0;

1540 
pAd
->
DrsCou¡îs
.
TxR©eUpPíÆty
 = 0;

1541 
	`NdisZîoMem‹y
(
pAd
->
DrsCou¡îs
.
TxQuÆôy
, 
MAX_LEN_OF_SUPPORTED_RATES
);

1542 
	`NdisZîoMem‹y
(
pAd
->
DrsCou¡îs
.
PER
, 
MAX_LEN_OF_SUPPORTED_RATES
);

1544 i‡(
dbm
 >= -65)

1545 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_54
;

1546 i‡(
dbm
 >= -66)

1547 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_48
;

1548 i‡(
dbm
 >= -70)

1549 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_36
;

1550 i‡(
dbm
 >= -74)

1551 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_24
;

1552 i‡(
dbm
 >= -77)

1553 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_18
;

1554 i‡(
dbm
 >= -79)

1555 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_12
;

1556 i‡(
dbm
 >= -81)

1559 i‡((
pAd
->
P‹tCfg
.
Ch™√l
 > 14Ë|| (pAd->P‹tCfg.
PhyMode
 =
PHY_11G
))

1560 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_9
;

1562 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_11
;

1567 i‡((
pAd
->
P‹tCfg
.
Ch™√l
 > 14Ë|| (pAd->P‹tCfg.
PhyMode
 =
PHY_11G
))

1568 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_6
;

1571 i‡(
dbm
 >= -82)

1572 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_11
;

1573 i‡(
dbm
 >= -84)

1574 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_5_5
;

1575 i‡(
dbm
 >= -85)

1576 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_2
;

1578 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_1
;

1582 i‡(
pAd
->
P‹tCfg
.
TxR©e
 >ÖAd->P‹tCfg.
MaxTxR©e
)

1583 
pAd
->
P‹tCfg
.
TxR©e
 =ÖAd->P‹tCfg.
MaxTxR©e
;

1593 
pAd
->
DrsCou¡îs
.
CuºTxR©eSèbÀTime
 ++;

1596 i‡((
pAd
->
P‹tCfg
.
Ch™√l
 > 14) ||

1597 (
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11G
))

1599 
UpR©e
 = 
Phy11ANextR©eUpw¨d
[
CuºR©e
];

1600 
DownR©e
 = 
Phy11ANextR©eDownw¨d
[
CuºR©e
];

1604 
UpR©e
 = 
Phy11BGNextR©eUpw¨d
[
CuºR©e
];

1605 
DownR©e
 = 
Phy11BGNextR©eDownw¨d
[
CuºR©e
];

1608 i‡(
UpR©e
 > 
pAd
->
P‹tCfg
.
MaxTxR©e
)

1609 
UpR©e
 = 
pAd
->
P‹tCfg
.
MaxTxR©e
;

1611 
TxEº‹R©io
 = ((
pAd
->
RÆökCou¡îs
.
O√SecTxRëryOkCou¡
 +ÖAd->RÆökCou¡îs.
O√SecTxFaûCou¡
Ë*100Ë/ 
TxTŸÆC¡
;

1614 i‡(
TxEº‹R©io
 >
R©eDownPER
[
CuºR©e
])

1616 
pAd
->
DrsCou¡îs
.
TxQuÆôy
[
CuºR©e
] = 
DRS_TX_QUALITY_WORST_BOUND
;

1619 i‡(
TxEº‹R©io
 <
R©eUpPER
[
CuºR©e
])

1621 
fUpgødeQuÆôy
 = 
TRUE
;

1622 i‡(
pAd
->
DrsCou¡îs
.
TxQuÆôy
[
CuºR©e
])

1623 
pAd
->
DrsCou¡îs
.
TxQuÆôy
[
CuºR©e
] --;

1625 i‡(
pAd
->
DrsCou¡îs
.
TxR©eUpPíÆty
)

1626 
pAd
->
DrsCou¡îs
.
TxR©eUpPíÆty
 --;

1627 i‡(
pAd
->
DrsCou¡îs
.
TxQuÆôy
[
UpR©e
])

1628 
pAd
->
DrsCou¡îs
.
TxQuÆôy
[
UpR©e
] --;

1631 
pAd
->
DrsCou¡îs
.
PER
[
CuºR©e
] = (
UCHAR
)
TxEº‹R©io
;

1642 i‡((
UpR©e
 !
CuºR©e
) &&

1643 (
pAd
->
DrsCou¡îs
.
La°SecTxR©eCh™geA˘i⁄
 == 2) &&

1644 (
pAd
->
DrsCou¡îs
.
PER
[
CuºR©e
] < 75) &&

1645 ((
pAd
->
DrsCou¡îs
.
PER
[
CuºR©e
] > 20Ë|| (pAd->DrsCou¡îs.
fNoisyEnvú⁄mít
)) &&

1646 ((
pAd
->
DrsCou¡îs
.
PER
[
CuºR©e
]+5Ë>ÖAd->DrsCou¡îs.PER[
UpR©e
]))

1649 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"DRS: ####Énter NoisyÉnvironment ####\n");

1650 
pAd
->
DrsCou¡îs
.
fNoisyEnvú⁄mít
 = 
TRUE
;

1654 
UpR©e
++;

1655 i‡((
UpR©e
==
RATE_6
Ë|| (UpR©e==
RATE_9
)ËUpR©e=
RATE_12
;

1656 i‡(
UpR©e
 > 
pAd
->
P‹tCfg
.
MaxTxR©e
)

1657 
UpR©e
 = 
pAd
->
P‹tCfg
.
MaxTxR©e
;

1658 
pAd
->
P‹tCfg
.
TxR©e
 = 
UpR©e
;

1667 i‡((
pAd
->
DrsCou¡îs
.
fNoisyEnvú⁄mít
 =
TRUE
) &&

1668 (
pAd
->
DrsCou¡îs
.
PER
[
CuºR©e
] <= 12))

1670 
UCHAR
 
JumpUpR©e
;

1672 
pAd
->
DrsCou¡îs
.
fNoisyEnvú⁄mít
 = 
FALSE
;

1673 
JumpUpR©e
 = 
RATE_54
; JumpUpR©ê> 
RATE_1
; JumpUpRate--)

1675 i‡(
dbm
 > 
RssiSa„LevñF‹TxR©e
[
JumpUpR©e
])

1679 i‡(
JumpUpR©e
 > 
pAd
->
P‹tCfg
.
MaxTxR©e
)

1680 
JumpUpR©e
 = 
pAd
->
P‹tCfg
.
MaxTxR©e
;

1682 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"DRS: ####Üeave NoisyÉnvironment ####, RSSI=%d, JumpUpRate=%d\n",

1683 
dbm
, 
R©eIdToMbps
[
JumpUpR©e
]);

1685 i‡(
JumpUpR©e
 > 
CuºR©e
)

1687 
pAd
->
P‹tCfg
.
TxR©e
 = 
JumpUpR©e
;

1698 i‡(
fUpgødeQuÆôy
 &&

1699 
	`INFRA_ON
(
pAd
) &&

1700 (
UpR©e
 !
CuºR©e
) &&

1701 (
UpR©e
 > 
RATE_11
) &&

1702 (
pAd
->
DrsCou¡îs
.
TxQuÆôy
[
CuºR©e
] <= 1) &&

1703 (
pAd
->
DrsCou¡îs
.
TxQuÆôy
[
UpR©e
] <= 1))

1705 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"DRS: 2 NULL føme†© UpR©ê%d Mbps\n",
R©eIdToMbps
[
UpR©e
]);

1706 
	`RTMPSídNuŒFøme
(
pAd
, 
UpR©e
);

1712 i‡((
pAd
->
DrsCou¡îs
.
TxQuÆôy
[
CuºR©e
] >
DRS_TX_QUALITY_WORST_BOUND
) &&

1713 (
CuºR©e
 !
DownR©e
))

1717 i‡((
dbm
 >-45Ë&& (
DownR©e
 < 
RATE_48
))

1718 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_48
;

1719 i‡((
dbm
 >-50Ë&& (
DownR©e
 < 
RATE_36
))

1720 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_36
;

1721 i‡((
dbm
 >-55Ë&& (
DownR©e
 < 
RATE_24
))

1722 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_24
;

1723 i‡((
dbm
 >-60Ë&& (
DownR©e
 < 
RATE_18
))

1724 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_18
;

1725 i‡((
dbm
 >-65Ë&& (
DownR©e
 < 
RATE_12
))

1726 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_12
;

1727 i‡((
dbm
 >-70Ë&& (
DownR©e
 < 
RATE_9
))

1730 i‡((
pAd
->
P‹tCfg
.
Ch™√l
 > 14Ë|| (pAd->P‹tCfg.
PhyMode
 =
PHY_11G
))

1731 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_9
;

1733 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_11
;

1738 i‡((
dbm
 >-75Ë&& (
DownR©e
 < 
RATE_11
))

1739 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_11
;

1742 #ifde‡
WIFI_TEST


1743 i‡(
DownR©e
 <
RATE_2
) ;

1747 
pAd
->
P‹tCfg
.
TxR©e
 = 
DownR©e
;

1751 i‡((
pAd
->
DrsCou¡îs
.
TxQuÆôy
[
CuºR©e
] <= 0) &&

1752 (
pAd
->
DrsCou¡îs
.
TxQuÆôy
[
UpR©e
] <=0) &&

1753 (
CuºR©e
 !
UpR©e
))

1755 
pAd
->
P‹tCfg
.
TxR©e
 = 
UpR©e
;

1761 i‡(
pAd
->
P‹tCfg
.
TxR©e
 >ÖAd->P‹tCfg.
MaxTxR©e
)

1762 
pAd
->
P‹tCfg
.
TxR©e
 =ÖAd->P‹tCfg.
MaxTxR©e
;

1764 }
FALSE
);

1768 i‡(
pAd
->
P‹tCfg
.
TxR©e
 > 
CuºR©e
)

1770 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"DRS: ++TXÑ©ê‰om %dÅÿ%d Mbps\n", 
R©eIdToMbps
[
CuºR©e
],R©eIdToMbps[
pAd
->
P‹tCfg
.
TxR©e
]);

1771 
pAd
->
DrsCou¡îs
.
CuºTxR©eSèbÀTime
 = 0;

1772 
pAd
->
DrsCou¡îs
.
TxR©eUpPíÆty
 = 0;

1773 
pAd
->
DrsCou¡îs
.
La°SecTxR©eCh™geA˘i⁄
 = 1;

1774 
	`NdisZîoMem‹y
(
pAd
->
DrsCou¡îs
.
TxQuÆôy
, 
MAX_LEN_OF_SUPPORTED_RATES
);

1775 
	`NdisZîoMem‹y
(
pAd
->
DrsCou¡îs
.
PER
, 
MAX_LEN_OF_SUPPORTED_RATES
);

1781 i‡(!
pAd
->
P‹tCfg
.
QuickRe•⁄eF‹R©eUpTimîRu¬ög
)

1783 i‡(
pAd
->
P‹tCfg
.
TxR©e
 <
RATE_12
)

1784 
	`RTMPSëTimî
(
pAd
, &pAd->
P‹tCfg
.
QuickRe•⁄eF‹R©eUpTimî
, 200);

1786 
	`RTMPSëTimî
(
pAd
, &pAd->
P‹tCfg
.
QuickRe•⁄eF‹R©eUpTimî
, 100);

1788 
pAd
->
P‹tCfg
.
QuickRe•⁄eF‹R©eUpTimîRu¬ög
 = 
TRUE
;

1793 i‡(
pAd
->
P‹tCfg
.
TxR©e
 < 
CuºR©e
)

1795 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"DRS: --TXÑ©ê‰om %dÅÿ%d Mbps\n", 
R©eIdToMbps
[
CuºR©e
],R©eIdToMbps[
pAd
->
P‹tCfg
.
TxR©e
]);

1805 
pAd
->
DrsCou¡îs
.
TxR©eUpPíÆty
 = 0;

1807 
pAd
->
DrsCou¡îs
.
CuºTxR©eSèbÀTime
 = 0;

1808 
pAd
->
DrsCou¡îs
.
La°SecTxR©eCh™geA˘i⁄
 = 2;

1809 
pAd
->
DrsCou¡îs
.
TxQuÆôy
[pAd->
P‹tCfg
.
TxR©e
] = 0;

1810 
pAd
->
DrsCou¡îs
.
PER
[pAd->
P‹tCfg
.
TxR©e
] = 0;

1813 
pAd
->
DrsCou¡îs
.
La°SecTxR©eCh™geA˘i⁄
 = 0;

1815 
	}
}

1835 
VOID
 
	$MlmeCheckPsmCh™ge
(

1836 
IN
 
PRTMP_ADAPTER
 
pAd
,

1837 
IN
 
ULONG
 
Now32
)

1839 
ULONG
 
PowîMode
;

1846 
PowîMode
 = 
pAd
->
P‹tCfg
.
WödowsPowîMode
;

1848 i‡(
	`INFRA_ON
(
pAd
) &&

1849 (
PowîMode
 !
Ndis802_11PowîModeCAM
) &&

1850 (
pAd
->
P‹tCfg
.
Psm
 =
PWR_ACTIVE
) &&

1852 (
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 =
CNTL_IDLE
) &&

1853 (
pAd
->
RÆökCou¡îs
.
O√SecTxNoRëryOkCou¡
 == 0) &&

1854 (
pAd
->
RÆökCou¡îs
.
O√SecTxRëryOkCou¡
 == 0) )

1856 
	`RTUSBEnqueueI¡î«lCmd
(
pAd
, 
RT_OID_SET_PSM_BIT_SAVE
);

1859 
	}
}

1861 
VOID
 
	$MlmeSëPsmBô
(

1862 
IN
 
PRTMP_ADAPTER
 
pAd
,

1863 
IN
 
USHORT
 
psm
)

1865 
TXRX_CSR4_STRUC
 
c§4
;

1867 
pAd
->
P‹tCfg
.
Psm
 = 
psm
;

1868 
	`RTUSBRódMACRegi°î
(
pAd
, 
TXRX_CSR4
, &
c§4
.
w‹d
);

1869 
c§4
.
fõld
.
AckCtsPsmBô
 = (
psm
 =
PWR_SAVE
)? 1:0;

1870 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR4
, 
c§4
.
w‹d
);

1871 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MlmeSëPsmBô = %d\n", 
psm
);

1872 
	}
}

1874 
VOID
 
	$MlmeSëTxPªambÀ
(

1875 
IN
 
PRTMP_ADAPTER
 
pAd
,

1876 
IN
 
USHORT
 
TxPªambÀ
)

1878 
TXRX_CSR4_STRUC
 
c§4
;

1880 
	`RTUSBRódMACRegi°î
(
pAd
, 
TXRX_CSR4
, &
c§4
.
w‹d
);

1881 i‡(
TxPªambÀ
 =
Rt802_11PªambÀSh‹t
)

1884 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MlmeSetTxPreamble (= SHORT PREAMBLE)\n");

1885 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_SHORT_PREAMBLE_INUSED
);

1886 
c§4
.
fõld
.
AutoRe•⁄dîPªambÀ
 = 1;

1890 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MlmeSetTxPreamble (= LONG PREAMBLE)\n");

1891 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_SHORT_PREAMBLE_INUSED
);

1892 
c§4
.
fõld
.
AutoRe•⁄dîPªambÀ
 = 0;

1894 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR4
, 
c§4
.
w‹d
);

1895 
	}
}

1899 
VOID
 
	$MlmeUpd©eTxR©es
(

1900 
IN
 
PRTMP_ADAPTER
 
pAd
,

1901 
IN
 
BOOLEAN
 
bLökUp
)

1903 
i
, 
num
;

1904 
UCHAR
 
R©e
, 
MaxDesúe
 = 
RATE_1
, 
MaxSuµ‹t
 = RATE_1;

1905 
ULONG
 
BasicR©eBôm≠
 = 0;

1906 
UCHAR
 
CuºBasicR©e
 = 
RATE_1
;

1907 
UCHAR
 *
pSupR©e
, *
pExtR©e
, 
SupR©eLí
, 
ExtR©eLí
;

1910 
num
 = 0;

1911 
i
=0; i<
MAX_LEN_OF_SUPPORTED_RATES
; i++)

1913 
pAd
->
P‹tCfg
.
DesúeR©e
[
i
] & 0x7f)

1915 2: 
R©e
 = 
RATE_1
; 
num
++; ;

1916 4: 
R©e
 = 
RATE_2
; 
num
++; ;

1917 11: 
R©e
 = 
RATE_5_5
; 
num
++; ;

1918 22: 
R©e
 = 
RATE_11
; 
num
++; ;

1919 12: 
R©e
 = 
RATE_6
; 
num
++; ;

1920 18: 
R©e
 = 
RATE_9
; 
num
++; ;

1921 24: 
R©e
 = 
RATE_12
; 
num
++; ;

1922 36: 
R©e
 = 
RATE_18
; 
num
++; ;

1923 48: 
R©e
 = 
RATE_24
; 
num
++; ;

1924 72: 
R©e
 = 
RATE_36
; 
num
++; ;

1925 96: 
R©e
 = 
RATE_48
; 
num
++; ;

1926 108: 
R©e
 = 
RATE_54
; 
num
++; ;

1927 : 
R©e
 = 
RATE_1
; ;

1929 i‡(
MaxDesúe
 < 
R©e
) MaxDesire = Rate;

1933 i‡((
pAd
->
P‹tCfg
.
BssTy≥
 =
BSS_ADHOC
) &&

1934 (
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11BG_MIXED
) &&

1935 (
pAd
->
P‹tCfg
.
AdhocMode
 == 0) &&

1936 (
MaxDesúe
 > 
RATE_11
))

1937 
MaxDesúe
 = 
RATE_11
;

1939 
pAd
->
P‹tCfg
.
MaxDesúedR©e
 = 
MaxDesúe
;

1943 i‡(
num
 <= 1)

1944 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_TX_RATE_SWITCH_ENABLED
);

1946 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_TX_RATE_SWITCH_ENABLED
);

1949 i‡(
	`ADHOC_ON
(
pAd
Ë|| 
	`INFRA_ON
(pAd))

1951 
pSupR©e
 = &
pAd
->
A˘iveCfg
.
SupR©e
[0];

1952 
pExtR©e
 = &
pAd
->
A˘iveCfg
.
ExtR©e
[0];

1953 
SupR©eLí
 = 
pAd
->
A˘iveCfg
.SupRateLen;

1954 
ExtR©eLí
 = 
pAd
->
A˘iveCfg
.ExtRateLen;

1958 
pSupR©e
 = &
pAd
->
P‹tCfg
.
SupR©e
[0];

1959 
pExtR©e
 = &
pAd
->
P‹tCfg
.
ExtR©e
[0];

1960 
SupR©eLí
 = 
pAd
->
P‹tCfg
.SupRateLen;

1961 
ExtR©eLí
 = 
pAd
->
P‹tCfg
.ExtRateLen;

1965 
i
=0; i<
SupR©eLí
; i++)

1967 
pSupR©e
[
i
] & 0x7f)

1969 2: 
R©e
 = 
RATE_1
; i‡(
pSupR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0001; ;

1970 4: 
R©e
 = 
RATE_2
; i‡(
pSupR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0002; ;

1971 11: 
R©e
 = 
RATE_5_5
; i‡(
pSupR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0004; ;

1972 22: 
R©e
 = 
RATE_11
; i‡(
pSupR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0008; ;

1973 12: 
R©e
 = 
RATE_6
; 
BasicR©eBôm≠
 |= 0x0010; ;

1974 18: 
R©e
 = 
RATE_9
; i‡(
pSupR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0020; ;

1975 24: 
R©e
 = 
RATE_12
; 
BasicR©eBôm≠
 |= 0x0040; ;

1976 36: 
R©e
 = 
RATE_18
; i‡(
pSupR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0080; ;

1977 48: 
R©e
 = 
RATE_24
; 
BasicR©eBôm≠
 |= 0x0100; ;

1978 72: 
R©e
 = 
RATE_36
; i‡(
pSupR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0200; ;

1979 96: 
R©e
 = 
RATE_48
; i‡(
pSupR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0400; ;

1980 108: 
R©e
 = 
RATE_54
; i‡(
pSupR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0800; ;

1981 : 
R©e
 = 
RATE_1
; ;

1983 i‡(
MaxSuµ‹t
 < 
R©e
) MaxSupport = Rate;

1985 
i
=0; i<
ExtR©eLí
; i++)

1987 
pExtR©e
[
i
] & 0x7f)

1989 2: 
R©e
 = 
RATE_1
; i‡(
pExtR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0001; ;

1990 4: 
R©e
 = 
RATE_2
; i‡(
pExtR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0002; ;

1991 11: 
R©e
 = 
RATE_5_5
; i‡(
pExtR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0004; ;

1992 22: 
R©e
 = 
RATE_11
; i‡(
pExtR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0008; ;

1993 12: 
R©e
 = 
RATE_6
; 
BasicR©eBôm≠
 |= 0x0010; ;

1994 18: 
R©e
 = 
RATE_9
; i‡(
pExtR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0020; ;

1995 24: 
R©e
 = 
RATE_12
; 
BasicR©eBôm≠
 |= 0x0040; ;

1996 36: 
R©e
 = 
RATE_18
; i‡(
pExtR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0080; ;

1997 48: 
R©e
 = 
RATE_24
; 
BasicR©eBôm≠
 |= 0x0100; ;

1998 72: 
R©e
 = 
RATE_36
; i‡(
pExtR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0200; ;

1999 96: 
R©e
 = 
RATE_48
; i‡(
pExtR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0400; ;

2000 108: 
R©e
 = 
RATE_54
; i‡(
pExtR©e
[
i
] & 0x80Ë
BasicR©eBôm≠
 |= 0x0800; ;

2001 : 
R©e
 = 
RATE_1
; ;

2003 i‡(
MaxSuµ‹t
 < 
R©e
) MaxSupport = Rate;

2005 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR5
, 
BasicR©eBôm≠
);

2006 
pAd
->
P‹tCfg
.
BasicR©eBôm≠
 = BasicRateBitmap;

2010 
i
=0; i<
MAX_LEN_OF_SUPPORTED_RATES
; i++)

2012 i‡(
BasicR©eBôm≠
 & (0x01 << 
i
))

2013 
CuºBasicR©e
 = (
UCHAR
)
i
;

2014 
pAd
->
P‹tCfg
.
Ex≥˘edACKR©e
[
i
] = 
CuºBasicR©e
;

2015 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Ex±e˘ed ACKÑ©e[%d] = %d Mbps\n", 
R©eIdToMbps
[
i
], R©eIdToMbps[
CuºBasicR©e
]);

2019 i‡(
MaxSuµ‹t
 < 
MaxDesúe
)

2020 
pAd
->
P‹tCfg
.
MaxTxR©e
 = 
MaxSuµ‹t
;

2022 
pAd
->
P‹tCfg
.
MaxTxR©e
 = 
MaxDesúe
;

2030 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_TX_RATE_SWITCH_ENABLED
) &&

2031 
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

2033 
dbm
 = 
pAd
->
P‹tCfg
.
AvgRssi
 -ÖAd->
BbpRssiToDbmDñè
;

2034 i‡(
bLökUp
 =
TRUE
)

2035 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_24
;

2037 
pAd
->
P‹tCfg
.
TxR©e
 =ÖAd->P‹tCfg.
MaxTxR©e
;

2039 i‡(
dbm
 < -75)

2040 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_11
;

2041 i‡(
dbm
 < -70)

2042 
pAd
->
P‹tCfg
.
TxR©e
 = 
RATE_24
;

2045 i‡(
pAd
->
P‹tCfg
.
TxR©e
 >ÖAd->P‹tCfg.
MaxTxR©e
)

2046 
pAd
->
P‹tCfg
.
TxR©e
 =ÖAd->P‹tCfg.
MaxTxR©e
;

2047 
	`DBGPRINT
(
RT_DEBUG_TRACE
, " MlmeUpd©eTxR©e†(Rssi=%d, inô TXÑ©ê%d Mbps)\n", 
dbm
, 
R©eIdToMbps
[
pAd
->
P‹tCfg
.
TxR©e
]);

2050 
pAd
->
P‹tCfg
.
TxR©e
 =ÖAd->P‹tCfg.
MaxTxR©e
;

2053 i‡(
bLökUp
)

2059 
pAd
->
P‹tCfg
.
PhyMode
)

2061 
PHY_11BG_MIXED
:

2062 
PHY_11B
:

2063 
pAd
->
P‹tCfg
.
MlmeR©e
 = 
RATE_2
;

2064 #ifdef 
WIFI_TEST


2065 
pAd
->
P‹tCfg
.
RtsR©e
 = 
RATE_11
;

2067 
pAd
->
P‹tCfg
.
RtsR©e
 = 
RATE_2
;

2070 
PHY_11A
:

2071 
pAd
->
P‹tCfg
.
MlmeR©e
 = 
RATE_6
;

2072 
pAd
->
P‹tCfg
.
RtsR©e
 = 
RATE_6
;

2074 
PHY_11ABG_MIXED
:

2075 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 <= 14)

2077 
pAd
->
P‹tCfg
.
MlmeR©e
 = 
RATE_2
;

2078 
pAd
->
P‹tCfg
.
RtsR©e
 = 
RATE_2
;

2082 
pAd
->
P‹tCfg
.
MlmeR©e
 = 
RATE_6
;

2083 
pAd
->
P‹tCfg
.
RtsR©e
 = 
RATE_6
;

2087 
pAd
->
P‹tCfg
.
MlmeR©e
 = 
RATE_2
;

2088 
pAd
->
P‹tCfg
.
RtsR©e
 = 
RATE_2
;

2095 
pAd
->
P‹tCfg
.
BasicMlmeR©e
 =ÖAd->P‹tCfg.
MlmeR©e
;

2102 i‡(
	`ADHOC_ON
(
pAd
))

2104 i‡((
pAd
->
P‹tCfg
.
AdhocMode
 =
ADHOC_11G
Ë|| (pAd->P‹tCfg.AdhocModê=
ADHOC_11A
))

2106 
pAd
->
P‹tCfg
.
MlmeR©e
 = 
RATE_6
;

2107 
pAd
->
P‹tCfg
.
RtsR©e
 = 
RATE_6
;

2111 
	`DBGPRINT
(
RT_DEBUG_TRACE
, " MlmeUpdateTxRates (MaxDesire=%d, MaxSupport=%d, MaxTxRate=%d, Rate Switching =%d)\n",

2112 
R©eIdToMbps
[
MaxDesúe
], R©eIdToMbps[
MaxSuµ‹t
], R©eIdToMbps[
pAd
->
P‹tCfg
.
MaxTxR©e
], 
	`OPSTATUS_TEST_FLAG
’Ad, 
fOP_STATUS_TX_RATE_SWITCH_ENABLED
));

2113 
	`DBGPRINT
(
RT_DEBUG_TRACE
, " MlmeUpdateTxRates (TxRate=%d, RtsRate=%d, BasicRateBitmap=0x%04x)\n",

2114 
R©eIdToMbps
[
pAd
->
P‹tCfg
.
TxR©e
], R©eIdToMbps[pAd->P‹tCfg.
RtsR©e
], 
BasicR©eBôm≠
);

2115 
	}
}

2117 
VOID
 
	$MlmeRadioOff
(

2118 
IN
 
PRTMP_ADAPTER
 
pAd
)

2120 
MLME_DISASSOC_REQ_STRUCT
 
DisReq
;

2121 
MLME_QUEUE_ELEM
 
MsgEÀm
;

2122 
ULONG
 
i
 = 0;

2124 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "===>MlmeRadioOff()\n");

2127 
	`RTMPSëLED
(
pAd
, 
LED_RADIO_OFF
);

2134 i‡(!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
))

2136 i‡(
	`INFRA_ON
(
pAd
))

2138 
	`COPY_MAC_ADDR
(&
DisReq
.
Addr
, 
pAd
->
P‹tCfg
.
Bssid
);

2139 
DisReq
.
Rós⁄
 = 
REASON_DISASSOC_STA_LEAVING
;

2141 
MsgEÀm
.
Machöe
 = 
ASSOC_STATE_MACHINE
;

2142 
MsgEÀm
.
MsgTy≥
 = 
MT2_MLME_DISASSOC_REQ
;

2143 
MsgEÀm
.
MsgLí
 = (
MLME_DISASSOC_REQ_STRUCT
);

2144 
	`NdisMoveMem‹y
(
MsgEÀm
.
Msg
, &
DisReq
, (
MLME_DISASSOC_REQ_STRUCT
));

2146 
	`MlmeDißssocReqA˘i⁄
(
pAd
, &
MsgEÀm
);

2147 
	`RTMPu£cDñay
(1000);

2151 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
);

2154 i‡(
	`INFRA_ON
(
pAd
Ë|| 
	`ADHOC_ON
(pAd))

2155 
	`LökDown
(
pAd
, 
FALSE
);

2161 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
);

2164 
	`RTUSBReje˘PídögPackës
(
pAd
);

2165 
	`RTUSBCÀ™UpD©aBulkOutQueue
(
pAd
);

2166 
	`MlmeSu•íd
(
pAd
, 
TRUE
);

2169 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0257b032);

2170 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR10
, 0x00001818);

2174 (
	`©omic_ªad
(&
pAd
->
PídögRx
 ) > 0) ||

2175 (
pAd
->
BulkOutPídög
[0] =
TRUE
) ||

2176 (
pAd
->
BulkOutPídög
[1] =
TRUE
) ||

2177 (
pAd
->
BulkOutPídög
[2] =
TRUE
) ||

2178 (
pAd
->
BulkOutPídög
[3] =
TRUE
))

2180 i‡(
	`©omic_ªad
(&
pAd
->
PídögRx
) > 0)

2182 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "BulkIn IRP Pending!!!\n");

2183 
	`RTUSB_Víd‹Reque°
(
pAd
,

2185 
DEVICE_VENDOR_REQUEST_OUT
,

2189 
NULL
,

2193 i‡((
pAd
->
BulkOutPídög
[0] =
TRUE
) ||

2194 (
pAd
->
BulkOutPídög
[1] =
TRUE
) ||

2195 (
pAd
->
BulkOutPídög
[2] =
TRUE
) ||

2196 (
pAd
->
BulkOutPídög
[3] =
TRUE
))

2198 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "BulkOut IRP Pending!!!\n");

2199 i‡(
i
 == 0)

2201 
	`RTUSBC™˚lPídögBulkOutIRP
(
pAd
);

2202 
i
++;

2206 
	`RTMPu£cDñay
(500000);

2210 
	`BssTabÀInô
(&
pAd
->
SˇnTab
);

2212 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<== MlmeRadioOff\n");

2213 
	}
}

2215 
VOID
 
	$MlmeRadioOn
(

2216 
IN
 
PRTMP_ADAPTER
 
pAd
)

2218 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"MlmeRadioOn()\n");

2220 
	`NICRe£tFromEº‹
(
pAd
);

2223 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR10
, 0x00000718);

2224 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0257b032);

2227 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
);

2229 
	`MlmeResume
(
pAd
);

2230 
	`RTUSBBulkRe˚ive
(
pAd
);

2233 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x025eb032);

2236 
	`RTMPSëLED
(
pAd
, 
LED_RADIO_ON
);

2239 
	`AsicSwôchCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

2240 
	`AsicLockCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

2248 
	`MlmeEnqueue
(
pAd
,

2249 
MLME_CNTL_STATE_MACHINE
,

2250 
RT_CMD_RESET_MLME
,

2252 
NULL
);

2254 
	}
}

2267 
VOID
 
	$BssTabÀInô
(

2268 
IN
 
BSS_TABLE
 *
Tab
)

2270 
i
;

2272 
Tab
->
BssNr
 = 0;

2273 
Tab
->
BssOvîœpNr
 = 0;

2274 
i
 = 0; i < 
MAX_LEN_OF_BSS_TABLE
; i++)

2276 
	`NdisZîoMem‹y
(&
Tab
->
BssE¡ry
[
i
], (
BSS_ENTRY
));

2278 
	}
}

2288 
ULONG
 
	$BssTabÀSórch
(

2289 
IN
 
BSS_TABLE
 *
Tab
,

2290 
IN
 
PUCHAR
 
pBssid
,

2291 
IN
 
UCHAR
 
Ch™√l
)

2293 
UCHAR
 
i
;

2295 
i
 = 0; i < 
Tab
->
BssNr
; i++)

2301 i‡((((
Tab
->
BssE¡ry
[
i
].
Ch™√l
 <= 14) && (Channel <= 14)) ||

2302 ((
Tab
->
BssE¡ry
[
i
].
Ch™√l
 > 14) && (Channel > 14))) &&

2303 
	`MAC_ADDR_EQUAL
(
Tab
->
BssE¡ry
[
i
].
Bssid
, 
pBssid
))

2305  
i
;

2308  (
ULONG
)
BSS_NOT_FOUND
;

2309 
	}
}

2311 
ULONG
 
	$BssSsidTabÀSórch
(

2312 
IN
 
BSS_TABLE
 *
Tab
,

2313 
IN
 
PUCHAR
 
pBssid
,

2314 
IN
 
PUCHAR
 
pSsid
,

2315 
IN
 
UCHAR
 
SsidLí
,

2316 
IN
 
UCHAR
 
Ch™√l
)

2318 
UCHAR
 
i
;

2320 
i
 = 0; i < 
Tab
->
BssNr
; i++)

2326 i‡((((
Tab
->
BssE¡ry
[
i
].
Ch™√l
 <= 14) && (Channel <= 14)) ||

2327 ((
Tab
->
BssE¡ry
[
i
].
Ch™√l
 > 14) && (Channel > 14))) &&

2328 
	`MAC_ADDR_EQUAL
(
Tab
->
BssE¡ry
[
i
].
Bssid
, 
pBssid
) &&

2329 
	`SSID_EQUAL
(
pSsid
, 
SsidLí
, 
Tab
->
BssE¡ry
[
i
].
Ssid
, Tab->BssEntry[i].SsidLen))

2331  
i
;

2334  (
ULONG
)
BSS_NOT_FOUND
;

2335 
	}
}

2337 
ULONG
 
	$BssTabÀSórchWôhSSID
(

2338 
IN
 
BSS_TABLE
 *
Tab
,

2339 
IN
 
PUCHAR
 
Bssid
,

2340 
IN
 
PUCHAR
 
pSsid
,

2341 
IN
 
UCHAR
 
SsidLí
,

2342 
IN
 
UCHAR
 
Ch™√l
)

2344 
UCHAR
 
i
;

2346 
i
 = 0; i < 
Tab
->
BssNr
; i++)

2348 i‡((((
Tab
->
BssE¡ry
[
i
].
Ch™√l
 <= 14) && (Channel <= 14)) ||

2349 ((
Tab
->
BssE¡ry
[
i
].
Ch™√l
 > 14) && (Channel > 14))) &&

2350 
	`MAC_ADDR_EQUAL
(&(
Tab
->
BssE¡ry
[
i
].
Bssid
), Bssid) &&

2351 (
	`SSID_EQUAL
(
pSsid
, 
SsidLí
, 
Tab
->
BssE¡ry
[
i
].
Ssid
, Tab->BssEntry[i].SsidLen) ||

2352 (
	`NdisEquÆMem‹y
(
pSsid
, 
ZîoSsid
, 
SsidLí
)) ||

2353 (
	`NdisEquÆMem‹y
(
Tab
->
BssE¡ry
[
i
].
Ssid
, 
ZîoSsid
, Tab->BssE¡ry[i].
SsidLí
))))

2355  
i
;

2358  (
ULONG
)
BSS_NOT_FOUND
;

2359 
	}
}

2361 
VOID
 
	$BssTabÀDñëeE¡ry
(

2362 
IN
 
OUT
 
BSS_TABLE
 *
Tab
,

2363 
IN
 
PUCHAR
 
pBssid
,

2364 
IN
 
UCHAR
 
Ch™√l
)

2366 
UCHAR
 
i
, 
j
;

2368 
i
 = 0; i < 
Tab
->
BssNr
; i++)

2371 i‡((
Tab
->
BssE¡ry
[
i
].
Ch™√l
 == Channel) &&

2372 (
	`MAC_ADDR_EQUAL
(
Tab
->
BssE¡ry
[
i
].
Bssid
, 
pBssid
)))

2374 
j
 = 
i
; j < 
Tab
->
BssNr
 - 1; j++)

2376 
	`NdisMoveMem‹y
(&(
Tab
->
BssE¡ry
[
j
]), &(Tab->BssE¡ry[j + 1]), (
BSS_ENTRY
));

2378 
Tab
->
BssNr
 -= 1;

2382 
	}
}

2390 
VOID
 
	$BssE¡rySë
(

2391 
IN
 
PRTMP_ADAPTER
 
pAd
,

2392 
OUT
 
BSS_ENTRY
 *
pBss
,

2393 
IN
 
PUCHAR
 
pBssid
,

2394 
IN
 
CHAR
 
Ssid
[],

2395 
IN
 
UCHAR
 
SsidLí
,

2396 
IN
 
UCHAR
 
BssTy≥
,

2397 
IN
 
USHORT
 
Bóc⁄Pîiod
,

2398 
IN
 
PCF_PARM
 
pCfP¨m
,

2399 
IN
 
USHORT
 
AtimWö
,

2400 
IN
 
USHORT
 
C≠abûôyInfo
,

2401 
IN
 
UCHAR
 
SupR©e
[],

2402 
IN
 
UCHAR
 
SupR©eLí
,

2403 
IN
 
UCHAR
 
ExtR©e
[],

2404 
IN
 
UCHAR
 
ExtR©eLí
,

2405 
IN
 
UCHAR
 
Ch™√l
,

2406 
IN
 
UCHAR
 
Rssi
,

2407 
IN
 
LARGE_INTEGER
 
TimeSèmp
,

2408 
IN
 
UCHAR
 
CkùFœg
,

2409 
IN
 
PEDCA_PARM
 
pEdˇP¨m
,

2410 
IN
 
PQOS_CAPABILITY_PARM
 
pQosC≠abûôy
,

2411 
IN
 
PQBSS_LOAD_PARM
 
pQbssLﬂd
,

2413 
IN
 
USHORT
 
LígthVIE
,

2414 
IN
 
PNDIS_802_11_VARIABLE_IEs
 
pVIE
)

2418 
	`COPY_MAC_ADDR
(
pBss
->
Bssid
, 
pBssid
);

2420 
pBss
->
Hiddí
 = 1;

2421 i‡(
SsidLí
 > 0)

2427 i‡(
	`NdisEquÆMem‹y
(
Ssid
, 
ZîoSsid
, 
SsidLí
) == 0)

2429 
	`NdisMoveMem‹y
(
pBss
->
Ssid
, Ssid, 
SsidLí
);

2430 
pBss
->
SsidLí
 = SsidLen;

2431 
pBss
->
Hiddí
 = 0;

2434 
pBss
->
BssTy≥
 = BssType;

2435 
pBss
->
Bóc⁄Pîiod
 = BeaconPeriod;

2436 i‡(
BssTy≥
 =
BSS_INFRA
)

2438 i‡(
pCfP¨m
->
bVÆid
)

2440 
pBss
->
CÂCou¡
 = 
pCfP¨m
->CfpCount;

2441 
pBss
->
CÂPîiod
 = 
pCfP¨m
->CfpPeriod;

2442 
pBss
->
CÂMaxDuøti⁄
 = 
pCfP¨m
->CfpMaxDuration;

2443 
pBss
->
CÂDurRemaöög
 = 
pCfP¨m
->CfpDurRemaining;

2448 
pBss
->
AtimWö
 = AtimWin;

2451 
pBss
->
C≠abûôyInfo
 = CapabilityInfo;

2454 
pBss
->
Privacy
 = 
	`CAP_IS_PRIVACY_ON
’Bss->
C≠abûôyInfo
);

2455 
	`NdisMoveMem‹y
(
pBss
->
SupR©e
, SupR©e, 
SupR©eLí
);

2456 
pBss
->
SupR©eLí
 = SupRateLen;

2457 
	`NdisMoveMem‹y
(
pBss
->
ExtR©e
, ExtR©e, 
ExtR©eLí
);

2458 
pBss
->
ExtR©eLí
 = ExtRateLen;

2459 
pBss
->
Ch™√l
 = Channel;

2460 
pBss
->
Rssi
 = Rssi;

2462 
pBss
->
CkùFœg
 = CkipFlag;

2465 
	`NdisMoveMem‹y
(
pBss
->
FixIEs
.
Time°amp
, &
TimeSèmp
, 8);

2466 
pBss
->
FixIEs
.
Bóc⁄I¡îvÆ
 = 
Bóc⁄Pîiod
;

2467 
pBss
->
FixIEs
.
C≠abûôõs
 = 
C≠abûôyInfo
;

2469 i‡(
LígthVIE
 != 0)

2471 
pBss
->
V¨IELí
 = 
LígthVIE
;

2472 
	`NdisMoveMem‹y
(
pBss
->
V¨IEs
, 
pVIE
,ÖBss->
V¨IELí
);

2476 
pBss
->
V¨IELí
 = 0;

2479 
	`BssCùhîP¨£
(
pBss
);

2482 i‡(
pEdˇP¨m
)

2483 
	`NdisMoveMem‹y
(&
pBss
->
EdˇP¨m
, 
pEdˇP¨m
, (
EDCA_PARM
));

2485 
pBss
->
EdˇP¨m
.
bVÆid
 = 
FALSE
;

2486 i‡(
pQosC≠abûôy
)

2487 
	`NdisMoveMem‹y
(&
pBss
->
QosC≠abûôy
, 
pQosC≠abûôy
, (
QOS_CAPABILITY_PARM
));

2489 
pBss
->
QosC≠abûôy
.
bVÆid
 = 
FALSE
;

2490 i‡(
pQbssLﬂd
)

2491 
	`NdisMoveMem‹y
(&
pBss
->
QbssLﬂd
, 
pQbssLﬂd
, (
QBSS_LOAD_PARM
));

2493 
pBss
->
QbssLﬂd
.
bVÆid
 = 
FALSE
;

2494 
	}
}

2516 
ULONG
 
	$BssTabÀSëE¡ry
(

2517 
IN
 
PRTMP_ADAPTER
 
pAd
,

2518 
OUT
 
BSS_TABLE
 *
Tab
,

2519 
IN
 
PUCHAR
 
pBssid
,

2520 
IN
 
CHAR
 
Ssid
[],

2521 
IN
 
UCHAR
 
SsidLí
,

2522 
IN
 
UCHAR
 
BssTy≥
,

2523 
IN
 
USHORT
 
Bóc⁄Pîiod
,

2524 
IN
 
CF_PARM
 *
CfP¨m
,

2525 
IN
 
USHORT
 
AtimWö
,

2526 
IN
 
USHORT
 
C≠abûôyInfo
,

2527 
IN
 
UCHAR
 
SupR©e
[],

2528 
IN
 
UCHAR
 
SupR©eLí
,

2529 
IN
 
UCHAR
 
ExtR©e
[],

2530 
IN
 
UCHAR
 
ExtR©eLí
,

2531 
IN
 
UCHAR
 
Ch™√lNo
,

2532 
IN
 
UCHAR
 
Rssi
,

2533 
IN
 
LARGE_INTEGER
 
TimeSèmp
,

2534 
IN
 
UCHAR
 
CkùFœg
,

2535 
IN
 
PEDCA_PARM
 
pEdˇP¨m
,

2536 
IN
 
PQOS_CAPABILITY_PARM
 
pQosC≠abûôy
,

2537 
IN
 
PQBSS_LOAD_PARM
 
pQbssLﬂd
,

2539 
IN
 
USHORT
 
LígthVIE
,

2540 
IN
 
PNDIS_802_11_VARIABLE_IEs
 
pVIE
)

2542 
ULONG
 
Idx
;

2544 
Idx
 = 
	`BssTabÀSórchWôhSSID
(
Tab
, 
pBssid
, 
Ssid
, 
SsidLí
, 
Ch™√lNo
);

2545 i‡(
Idx
 =
BSS_NOT_FOUND
)

2547 i‡(
Tab
->
BssNr
 >
MAX_LEN_OF_BSS_TABLE
)

2554 if(!
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

2556 i‡(
	`MAC_ADDR_EQUAL
(
pAd
->
MlmeAux
.
Bssid
, 
pBssid
) ||

2557 
	`SSID_EQUAL
(
pAd
->
MlmeAux
.
Ssid
,ÖAd->MlmeAux.
SsidLí
, Ssid, SsidLen))

2559 
Idx
 = 
Tab
->
BssOvîœpNr
;

2560 
	`BssE¡rySë
(
pAd
, &
Tab
->
BssE¡ry
[
Idx
], 
pBssid
, 
Ssid
, 
SsidLí
, 
BssTy≥
, 
Bóc⁄Pîiod
,

2561 
CfP¨m
, 
AtimWö
, 
C≠abûôyInfo
, 
SupR©e
, 
SupR©eLí
, 
ExtR©e
, 
ExtR©eLí
,

2562 
Ch™√lNo
, 
Rssi
, 
TimeSèmp
, 
CkùFœg
, 
pEdˇP¨m
, 
pQosC≠abûôy
, 
pQbssLﬂd
, 
LígthVIE
, 
pVIE
);

2563 
Tab
->
BssOvîœpNr
 = (Tab->BssOvîœpNr++Ë% 
MAX_LEN_OF_BSS_TABLE
;

2565  
Idx
;

2568  
BSS_NOT_FOUND
;

2571 
Idx
 = 
Tab
->
BssNr
;

2572 
	`BssE¡rySë
(
pAd
, &
Tab
->
BssE¡ry
[
Idx
], 
pBssid
, 
Ssid
, 
SsidLí
, 
BssTy≥
, 
Bóc⁄Pîiod
,

2573 
CfP¨m
, 
AtimWö
, 
C≠abûôyInfo
, 
SupR©e
, 
SupR©eLí
, 
ExtR©e
, 
ExtR©eLí
,

2574 
Ch™√lNo
, 
Rssi
, 
TimeSèmp
, 
CkùFœg
, 
pEdˇP¨m
, 
pQosC≠abûôy
, 
pQbssLﬂd
, 
LígthVIE
, 
pVIE
);

2575 
Tab
->
BssNr
++;

2579 
	`BssE¡rySë
(
pAd
, &
Tab
->
BssE¡ry
[
Idx
], 
pBssid
, 
Ssid
, 
SsidLí
, 
BssTy≥
, 
Bóc⁄Pîiod
,

2580 
CfP¨m
, 
AtimWö
, 
C≠abûôyInfo
, 
SupR©e
, 
SupR©eLí
, 
ExtR©e
, 
ExtR©eLí
,

2581 
Ch™√lNo
, 
Rssi
, 
TimeSèmp
, 
CkùFœg
, 
pEdˇP¨m
, 
pQosC≠abûôy
, 
pQbssLﬂd
, 
LígthVIE
, 
pVIE
);

2584  
Idx
;

2585 
	}
}

2587 
BOOLEAN
 
	$RTMPCheckAKM
(

2588 
IN
 
NDIS_802_11_AUTHENTICATION_MODE
 
auth
,

2589 
IN
 
BSS_ENTRY
 *
pBss
)

2591 
auth
)

2593 
Ndis802_11AuthModeWPA
:

2594 if(
pBss
->
AuthBôMode
 & 
WPA1AKMBIT
)

2595  
TRUE
;

2597  
FALSE
;

2598 
Ndis802_11AuthModeWPAPSK
:

2599 if(
pBss
->
AuthBôMode
 & 
WPA1PSKAKMBIT
)

2600  
TRUE
;

2602  
FALSE
;

2603 
Ndis802_11AuthModeWPA2
:

2604 if(
pBss
->
AuthBôMode
 & 
WPA2AKMBIT
)

2605  
TRUE
;

2607  
FALSE
;

2608 
Ndis802_11AuthModeWPA2PSK
:

2609 if(
pBss
->
AuthBôMode
 & 
WPA2PSKAKMBIT
)

2610  
TRUE
;

2612  
FALSE
;

2614  
FALSE
;

2616 
	}
}

2618 
VOID
 
	$BssTabÀSsidS‹t
(

2619 
IN
 
PRTMP_ADAPTER
 
pAd
,

2620 
OUT
 
BSS_TABLE
 *
OutTab
,

2621 
IN
 
CHAR
 
Ssid
[],

2622 
IN
 
UCHAR
 
SsidLí
)

2624 
INT
 
i
;

2625 
	`BssTabÀInô
(
OutTab
);

2627 
i
 = 0; i < 
pAd
->
SˇnTab
.
BssNr
; i++)

2629 
BSS_ENTRY
 *
pInBss
 = &
pAd
->
SˇnTab
.
BssE¡ry
[
i
];

2631 i‡((
pInBss
->
BssTy≥
 =
pAd
->
P‹tCfg
.BssType) &&

2632 
	`SSID_EQUAL
(
Ssid
, 
SsidLí
, 
pInBss
->Ssid,ÖInBss->SsidLen))

2634 
BSS_ENTRY
 *
pOutBss
 = &
OutTab
->
BssE¡ry
[OutTab->
BssNr
];

2638 i‡(
pAd
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
)

2640 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAN⁄e
)

2642 i‡(
pAd
->
P‹tCfg
.
AuthMode
 !
pInBss
->AuthMode)

2648 if(!
	`RTMPCheckAKM
(
pAd
->
P‹tCfg
.
AuthMode
,
pInBss
))

2653 i‡((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA
Ë|| (pAd->P‹tCfg.AuthModê=
Ndis802_11AuthModeWPAPSK
))

2656 i‡(
pInBss
->
WPA
.
bMixMode
 =
FALSE
)

2657 i‡(
pAd
->
P‹tCfg
.
WïSètus
 !
pInBss
->
WPA
.
GroupCùhî
)

2661 i‡(
pAd
->
P‹tCfg
.
WïSètus
 < 
pInBss
->
WPA
.
GroupCùhî
)

2667 i‡((
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
) &&

2668 (
pAd
->
P‹tCfg
.
WïSètus
 !
pInBss
->
WPA
.
PaúCùhî
) &&

2669 (
pAd
->
P‹tCfg
.
WïSètus
 !
pInBss
->
WPA
.
PaúCùhîAux
))

2672 i‡((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2
Ë|| (pAd->P‹tCfg.AuthModê=
Ndis802_11AuthModeWPA2PSK
))

2675 i‡(
pInBss
->
WPA2
.
bMixMode
 =
FALSE
)

2676 i‡(
pAd
->
P‹tCfg
.
WïSètus
 !
pInBss
->
WPA2
.
GroupCùhî
)

2680 i‡(
pAd
->
P‹tCfg
.
WïSètus
 < 
pInBss
->
WPA2
.
GroupCùhî
)

2686 i‡((
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
) &&

2687 (
pAd
->
P‹tCfg
.
WïSètus
 !
pInBss
->
WPA2
.
PaúCùhî
) &&

2688 (
pAd
->
P‹tCfg
.
WïSètus
 !
pInBss
->
WPA2
.
PaúCùhîAux
))

2694 i‡(
pAd
->
P‹tCfg
.
WïSètus
 !
pInBss
->WepStatus)

2696 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"P‹tCfg.WïSètus=%d, whûêpInBss->WïSètus=%d\n", 
pAd
->
P‹tCfg
.
WïSètus
, 
pInBss
->WepStatus);

2703 i‡(
SsidLí
 == 0)

2707 
	`NdisMoveMem‹y
(
pOutBss
, 
pInBss
, (
BSS_ENTRY
));

2709 
OutTab
->
BssNr
++;

2711 i‡((
pInBss
->
BssTy≥
 =
pAd
->
P‹tCfg
.BssTy≥Ë&& (
SsidLí
 == 0))

2713 
BSS_ENTRY
 *
pOutBss
 = &
OutTab
->
BssE¡ry
[OutTab->
BssNr
];

2717 i‡(
pAd
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
)

2720 if(!
	`RTMPCheckAKM
(
pAd
->
P‹tCfg
.
AuthMode
,
pInBss
))

2724 i‡((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA
Ë|| (pAd->P‹tCfg.AuthModê=
Ndis802_11AuthModeWPAPSK
))

2727 i‡(
pInBss
->
WPA
.
bMixMode
 =
FALSE
)

2728 i‡(
pAd
->
P‹tCfg
.
WïSètus
 !
pInBss
->
WPA
.
GroupCùhî
)

2732 i‡(
pAd
->
P‹tCfg
.
WïSètus
 < 
pInBss
->
WPA
.
GroupCùhî
)

2738 i‡((
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
) &&

2739 (
pAd
->
P‹tCfg
.
WïSètus
 !
pInBss
->
WPA
.
PaúCùhî
) &&

2740 (
pAd
->
P‹tCfg
.
WïSètus
 !
pInBss
->
WPA
.
PaúCùhîAux
))

2743 i‡((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2
Ë|| (pAd->P‹tCfg.AuthModê=
Ndis802_11AuthModeWPA2PSK
))

2746 i‡(
pInBss
->
WPA2
.
bMixMode
 =
FALSE
)

2747 i‡(
pAd
->
P‹tCfg
.
WïSètus
 !
pInBss
->
WPA2
.
GroupCùhî
)

2751 i‡(
pAd
->
P‹tCfg
.
WïSètus
 < 
pInBss
->
WPA2
.
GroupCùhî
)

2757 i‡((
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
) &&

2758 (
pAd
->
P‹tCfg
.
WïSètus
 !
pInBss
->
WPA2
.
PaúCùhî
) &&

2759 (
pAd
->
P‹tCfg
.
WïSètus
 !
pInBss
->
WPA2
.
PaúCùhîAux
))

2765 i‡(
pAd
->
P‹tCfg
.
WïSètus
 !
pInBss
->WepStatus)

2769 
	`NdisMoveMem‹y
(
pOutBss
, 
pInBss
, (
BSS_ENTRY
));

2771 
OutTab
->
BssNr
++;

2774 i‡(
OutTab
->
BssNr
 >
MAX_LEN_OF_BSS_TABLE
)

2779 
	`BssTabÀS‹tByRssi
(
OutTab
);

2781 i‡(
OutTab
->
BssNr
 > 0)

2783 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2PSK
)

2784 
	`RTMPMakeRSNIE
(
pAd
, 
OutTab
->
BssE¡ry
[0].
WPA2
.
GroupCùhî
);

2785 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAPSK
)

2786 
	`RTMPMakeRSNIE
(
pAd
, 
OutTab
->
BssE¡ry
[0].
WPA
.
GroupCùhî
);

2789 
	}
}

2791 
VOID
 
	$BssTabÀS‹tByRssi
(

2792 
IN
 
OUT
 
BSS_TABLE
 *
OutTab
)

2794 
INT
 
i
, 
j
;

2795 
BSS_ENTRY
 
TmpBss
;

2797 
i
 = 0; i < 
OutTab
->
BssNr
 - 1; i++)

2799 
j
 = 
i
+1; j < 
OutTab
->
BssNr
; j++)

2801 i‡(
OutTab
->
BssE¡ry
[
j
].
Rssi
 > OutTab->BssE¡ry[
i
].Rssi)

2803 
	`NdisMoveMem‹y
(&
TmpBss
, &
OutTab
->
BssE¡ry
[
j
], (
BSS_ENTRY
));

2804 
	`NdisMoveMem‹y
(&
OutTab
->
BssE¡ry
[
j
], &OutTab->BssE¡ry[
i
], (
BSS_ENTRY
));

2805 
	`NdisMoveMem‹y
(&
OutTab
->
BssE¡ry
[
i
], &
TmpBss
, (
BSS_ENTRY
));

2809 
	}
}

2811 
VOID
 
	$BssCùhîP¨£
(

2812 
IN
 
OUT
 
PBSS_ENTRY
 
pBss
)

2814 
PEID_STRUCT
 
pEid
;

2815 
PUCHAR
 
pTmp
;

2816 
PRSN_IE_HEADER_STRUCT
 
pR¢Hódî
;

2817 
PCIPHER_SUITE_STRUCT
 
pCùhî
;

2818 
PAKM_SUITE_STRUCT
 
pAKM
;

2819 
USHORT
 
Cou¡
;

2820 
INT
 
Lígth
;

2821 
NDIS_802_11_ENCRYPTION_STATUS
 
TmpCùhî
;

2826 i‡(
pBss
->
Privacy
)

2828 
pBss
->
WïSètus
 = 
Ndis802_11WEPE«bÀd
;

2832 
pBss
->
WïSètus
 = 
Ndis802_11WEPDißbÀd
;

2835 
pBss
->
AuthMode
 = 
Ndis802_11AuthModeO≥n
;

2837 
pBss
->
AuthBôMode
 = 0;

2838 
pBss
->
PaúCùhîBôMode
 = 0;

2841 
pBss
->
WPA
.
PaúCùhî
 = 
Ndis802_11WEPDißbÀd
;

2842 
pBss
->
WPA
.
PaúCùhîAux
 = 
Ndis802_11WEPDißbÀd
;

2843 
pBss
->
WPA
.
GroupCùhî
 = 
Ndis802_11WEPDißbÀd
;

2844 
pBss
->
WPA
.
R¢C≠abûôy
 = 0;

2845 
pBss
->
WPA
.
bMixMode
 = 
FALSE
;

2848 
pBss
->
WPA2
.
PaúCùhî
 = 
Ndis802_11WEPDißbÀd
;

2849 
pBss
->
WPA2
.
PaúCùhîAux
 = 
Ndis802_11WEPDißbÀd
;

2850 
pBss
->
WPA2
.
GroupCùhî
 = 
Ndis802_11WEPDißbÀd
;

2851 
pBss
->
WPA2
.
R¢C≠abûôy
 = 0;

2852 
pBss
->
WPA2
.
bMixMode
 = 
FALSE
;

2853 
Lígth
 = (
INT
Ë
pBss
->
V¨IELí
;

2855 
Lígth
 > 0)

2858 
pTmp
 = ((
PUCHAR
Ë
pBss
->
V¨IEs
Ë+ÖBss->
V¨IELí
 - 
Lígth
;

2859 
pEid
 = (
PEID_STRUCT
Ë
pTmp
;

2860 
pEid
->
Eid
)

2862 
IE_WPA
:

2863 i‡(
	`NdisEquÆMem‹y
(
pEid
->
O˘ë
, 
WPA_OUI
, 4) != 1)

2872 
pTmp
 += 11;

2883 *
pTmp
)

2887 
pBss
->
WPA
.
GroupCùhî
 = 
Ndis802_11En¸y±i⁄1E«bÀd
;

2890 
pBss
->
WPA
.
GroupCùhî
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

2893 
pBss
->
WPA
.
GroupCùhî
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

2899 
pTmp
 += 1;

2903 
	`NdisMoveMem‹y
(&
Cou¡
, 
pTmp
, (
USHORT
));

2904 #ifde‡
BIG_ENDIAN


2905 
Cou¡
 = 
	`SWAP16
(Count);

2907 
pTmp
 +(
USHORT
);

2910 
Cou¡
 > 0)

2913 
pTmp
 += 3;

2914 
TmpCùhî
 = 
Ndis802_11WEPDißbÀd
;

2915 *
pTmp
)

2919 
TmpCùhî
 = 
Ndis802_11En¸y±i⁄1E«bÀd
;

2922 
TmpCùhî
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

2923 
pBss
->
PaúCùhîBôMode
 |
TKIPBIT
;

2926 
TmpCùhî
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

2927 
pBss
->
PaúCùhîBôMode
 |
CCMPBIT
;

2932 i‡(
TmpCùhî
 > 
pBss
->
WPA
.
PaúCùhî
)

2935 
pBss
->
WPA
.
PaúCùhîAux
 =ÖBss->WPA.
PaúCùhî
;

2936 
pBss
->
WPA
.
PaúCùhî
 = 
TmpCùhî
;

2940 
pBss
->
WPA
.
PaúCùhîAux
 = 
TmpCùhî
;

2942 
pTmp
++;

2943 
Cou¡
--;

2948 
	`NdisMoveMem‹y
(&
Cou¡
, 
pTmp
, (
USHORT
));

2949 #ifde‡
BIG_ENDIAN


2950 
Cou¡
 = 
	`SWAP16
(Count);

2952 
pTmp
 +(
USHORT
);

2954 
Cou¡
 >0)

2956 
pTmp
 += 3;

2958 *
pTmp
)

2962 
pBss
->
AuthBôMode
 |
WPA1AKMBIT
;

2963 
pBss
->
AuthMode
 = 
Ndis802_11AuthModeWPA
;

2967 
pBss
->
AuthBôMode
 |
WPA1PSKAKMBIT
;

2968 
pBss
->
AuthMode
 = 
Ndis802_11AuthModeWPAPSK
;

2973 
pTmp
++;

2974 
Cou¡
--;

2979 i‡(
pBss
->
BssTy≥
 =
BSS_ADHOC
)

2981 
pBss
->
AuthMode
 = 
Ndis802_11AuthModeWPAN⁄e
;

2983 
pBss
->
WïSètus
 =ÖBss->
WPA
.
GroupCùhî
;

2985 i‡(
pBss
->
WPA
.
PaúCùhîAux
 =
Ndis802_11WEPDißbÀd
)

2986 
pBss
->
WPA
.
PaúCùhîAux
 =ÖBss->WPA.
GroupCùhî
;

2989 
pBss
->
WïSètus
 =ÖBss->
WPA
.
PaúCùhî
;

2992 i‡(
pBss
->
WPA
.
GroupCùhî
 !pBss->WPA.
PaúCùhî
)

2993 
pBss
->
WPA
.
bMixMode
 = 
TRUE
;

2997 
IE_RSN
:

2998 
pR¢Hódî
 = (
PRSN_IE_HEADER_STRUCT
Ë
pTmp
;

3001 #ifde‡
BIG_ENDIAN


3002 
pR¢Hódî
->
Vîsi⁄
 = 
	`SWAP16
(pRsnHeader->Version);

3004 i‡(
pR¢Hódî
->
Vîsi⁄
 != 1)

3006 
pTmp
 +(
RSN_IE_HEADER_STRUCT
);

3009 
pCùhî
 = (
PCIPHER_SUITE_STRUCT
Ë
pTmp
;

3010 i‡(!
	`RTMPEquÆMem‹y
(
pTmp
, 
RSN_OUI
, 3))

3014 
pCùhî
->
Ty≥
)

3018 
pBss
->
WPA2
.
GroupCùhî
 = 
Ndis802_11En¸y±i⁄1E«bÀd
;

3021 
pBss
->
WPA2
.
GroupCùhî
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

3024 
pBss
->
WPA2
.
GroupCùhî
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

3030 
pTmp
 +(
CIPHER_SUITE_STRUCT
);

3034 
	`NdisMoveMem‹y
(&
Cou¡
, 
pTmp
, (
USHORT
));

3035 #ifde‡
BIG_ENDIAN


3036 
Cou¡
 = 
	`SWAP16
(Count);

3038 
pTmp
 +(
USHORT
);

3042 
Cou¡
 > 0)

3045 
pCùhî
 = (
PCIPHER_SUITE_STRUCT
Ë
pTmp
;

3046 
TmpCùhî
 = 
Ndis802_11WEPDißbÀd
;

3047 
pCùhî
->
Ty≥
)

3051 
TmpCùhî
 = 
Ndis802_11En¸y±i⁄1E«bÀd
;

3054 
TmpCùhî
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

3055 
pBss
->
PaúCùhîBôMode
 |
TKIPBIT
;

3058 
TmpCùhî
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

3059 
pBss
->
PaúCùhîBôMode
 |
CCMPBIT
;

3064 i‡(
TmpCùhî
 > 
pBss
->
WPA2
.
PaúCùhî
)

3067 
pBss
->
WPA2
.
PaúCùhîAux
 =ÖBss->WPA2.
PaúCùhî
;

3068 
pBss
->
WPA2
.
PaúCùhî
 = 
TmpCùhî
;

3072 
pBss
->
WPA2
.
PaúCùhîAux
 = 
TmpCùhî
;

3074 
pTmp
 +(
CIPHER_SUITE_STRUCT
);

3075 
Cou¡
--;

3080 
	`NdisMoveMem‹y
(&
Cou¡
, 
pTmp
, (
USHORT
));

3081 #ifde‡
BIG_ENDIAN


3082 
Cou¡
 = 
	`SWAP16
(Count);

3084 
pTmp
 +(
USHORT
);

3087 
pAKM
 = (
PAKM_SUITE_STRUCT
Ë
pTmp
;

3088 i‡(!
	`RTMPEquÆMem‹y
(
pTmp
, 
RSN_OUI
, 3))

3091 
Cou¡
 >0)

3093 
pTmp
 += 3;

3095 *
pTmp
)

3099 
pBss
->
AuthBôMode
 |
WPA2AKMBIT
;

3100 
pBss
->
AuthMode
 = 
Ndis802_11AuthModeWPA2
;

3104 
pBss
->
AuthBôMode
 |
WPA2PSKAKMBIT
;

3105 
pBss
->
AuthMode
 = 
Ndis802_11AuthModeWPA2PSK
;

3110 
pTmp
++;

3111 
Cou¡
--;

3116 i‡(
pBss
->
BssTy≥
 =
BSS_ADHOC
)

3118 
pBss
->
AuthMode
 = 
Ndis802_11AuthModeWPAN⁄e
;

3120 
pBss
->
WPA
.
PaúCùhîAux
 =ÖBss->
WPA2
.PairCipherAux;

3121 
pBss
->
WPA
.
GroupCùhî
 =ÖBss->
WPA2
.GroupCipher;

3122 
pBss
->
WïSètus
 =ÖBss->
WPA
.
GroupCùhî
;

3124 i‡(
pBss
->
WPA
.
PaúCùhîAux
 =
Ndis802_11WEPDißbÀd
)

3125 
pBss
->
WPA
.
PaúCùhîAux
 =ÖBss->WPA.
GroupCùhî
;

3127 
pBss
->
WïSètus
 =ÖBss->
WPA2
.
PaúCùhî
;

3131 
	`NdisMoveMem‹y
(&
pBss
->
WPA2
.
R¢C≠abûôy
, 
pTmp
, (
USHORT
));

3132 #ifde‡
BIG_ENDIAN


3133 
pBss
->
WPA2
.
R¢C≠abûôy
 = 
	`SWAP16
(pBss->WPA2.RsnCapability);

3135 
pTmp
 +(
USHORT
);

3138 i‡(
pBss
->
WPA2
.
GroupCùhî
 !pBss->WPA2.
PaúCùhî
)

3139 
pBss
->
WPA2
.
bMixMode
 = 
TRUE
;

3146 
Lígth
 -(
pEid
->
Lí
 + 2);

3148 
	}
}

3161 
VOID
 
	$MacAddrR™domBssid
(

3162 
IN
 
PRTMP_ADAPTER
 
pAd
,

3163 
OUT
 
PUCHAR
 
pAddr
)

3165 
INT
 
i
;

3167 
i
 = 0; i < 
MAC_ADDR_LEN
; i++)

3169 
pAddr
[
i
] = 
	`R™domByã
(
pAd
);

3172 
pAddr
[0] = (pAddr[0] & 0xfe) | 0x02;

3173 
	}
}

3186 
VOID
 
	$MgtMacHódîInô
(

3187 
IN
 
PRTMP_ADAPTER
 
pAd
,

3188 
IN
 
OUT
 
PHEADER_802_11
 
pHdr80211
,

3189 
IN
 
UCHAR
 
SubTy≥
,

3190 
IN
 
UCHAR
 
ToDs
,

3191 
IN
 
PUCHAR
 
pDA
,

3192 
IN
 
PUCHAR
 
pBssid
)

3194 
	`NdisZîoMem‹y
(
pHdr80211
, (
HEADER_802_11
));

3195 
pHdr80211
->
FC
.
Ty≥
 = 
BTYPE_MGMT
;

3196 
pHdr80211
->
FC
.
SubTy≥
 = SubType;

3197 
pHdr80211
->
FC
.
ToDs
 = ToDs;

3198 
	`COPY_MAC_ADDR
(
pHdr80211
->
Addr1
, 
pDA
);

3199 
	`COPY_MAC_ADDR
(
pHdr80211
->
Addr2
, 
pAd
->
CuºítAddªss
);

3200 
	`COPY_MAC_ADDR
(
pHdr80211
->
Addr3
, 
pBssid
);

3201 
	}
}

3221 
ULONG
 
	$MakeOutgoögFøme
(

3222 
OUT
 
CHAR
 *
Buf„r
,

3223 
OUT
 
ULONG
 *
FømeLí
, ...)

3225 
CHAR
 *
p
;

3226 
Àng
;

3227 
ULONG
 
TŸLíg
;

3228 
va_li°
 
Args
;

3231 
TŸLíg
 = 0;

3232 
	`va_°¨t
(
Args
, 
FømeLí
);

3235 
Àng
 = 
	`va_¨g
(
Args
, );

3236 i‡(
Àng
 =
END_OF_ARGS
)

3240 
p
 = 
	`va_¨g
(
Args
, 
PVOID
);

3241 
	`NdisMoveMem‹y
(&
Buf„r
[
TŸLíg
], 
p
, 
Àng
);

3242 
TŸLíg
 = TŸLíg + 
Àng
;

3243 } 
TRUE
);

3245 
	`va_íd
(
Args
);

3246 *
FømeLí
 = 
TŸLíg
;

3247  
TŸLíg
;

3248 
	}
}

3261 
NDIS_STATUS
 
	$MlmeQueueInô
(

3262 
IN
 
MLME_QUEUE
 *
Queue
)

3264 
INT
 
i
;

3266 
	`NdisAŒoˇãSpöLock
(&
Queue
->
Lock
);

3268 
Queue
->
Num
 = 0;

3269 
Queue
->
Hód
 = 0;

3270 
Queue
->
Taû
 = 0;

3272 
i
 = 0; i < 
MAX_LEN_OF_MLME_QUEUE
; i++)

3274 
Queue
->
E¡ry
[
i
].
Occupõd
 = 
FALSE
;

3275 
Queue
->
E¡ry
[
i
].
MsgLí
 = 0;

3276 
	`NdisZîoMem‹y
(
Queue
->
E¡ry
[
i
].
Msg
, 
MAX_LEN_OF_MLME_BUFFER
);

3279  
NDIS_STATUS_SUCCESS
;

3280 
	}
}

3293 
BOOLEAN
 
	$MlmeEnqueue
(

3294 
IN
 
PRTMP_ADAPTER
 
pAd
,

3295 
IN
 
ULONG
 
Machöe
,

3296 
IN
 
ULONG
 
MsgTy≥
,

3297 
IN
 
ULONG
 
MsgLí
,

3298 
IN
 
VOID
 *
Msg
)

3300 
INT
 
Taû
;

3301 
MLME_QUEUE
 *
Queue
 = (MLME_QUEUE *)&
pAd
->
Mlme
.Queue;

3302 
IrqFœgs
;

3306 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
))

3307  
FALSE
;

3310 i‡(
MsgLí
 > 
MAX_LEN_OF_MLME_BUFFER
)

3312 
	`DBGPRINT_ERR
("MlmeEnqueue: msgÅoÿœrge, sizê%d \n", 
MsgLí
);

3313  
FALSE
;

3316 i‡(
pAd
->
MLMEThr_pid
 > 0)

3318 i‡(
	`MlmeQueueFuŒ
(
Queue
))

3320 
	`DBGPRINT_ERR
("MlmeEnqueue: full, msg droppedánd may corrupt MLME\n");

3321 
	`RTUSBMlmeUp
(
pAd
);

3322  
FALSE
;

3325 
	`NdisAcquúeSpöLock
(&(
Queue
->
Lock
), 
IrqFœgs
);

3327 
Taû
 = 
Queue
->Tail;

3328 
Queue
->
Taû
++;

3329 
Queue
->
Num
++;

3330 i‡(
Queue
->
Taû
 =
MAX_LEN_OF_MLME_QUEUE
)

3332 
Queue
->
Taû
 = 0;

3335 
Queue
->
E¡ry
[
Taû
].
Occupõd
 = 
TRUE
;

3336 
Queue
->
E¡ry
[
Taû
].
Machöe
 = Machine;

3337 
Queue
->
E¡ry
[
Taû
].
MsgTy≥
 = MsgType;

3338 
Queue
->
E¡ry
[
Taû
].
MsgLí
 = MsgLen;

3339 
	`NdisMoveMem‹y
(
Queue
->
E¡ry
[
Taû
].
Msg
, Msg, 
MsgLí
);

3341 
	`NdisRñó£SpöLock
(&(
Queue
->
Lock
), 
IrqFœgs
);

3342 
	`DBGPRINT
(
RT_DEBUG_INFO
, "MlmeEnqueue,Çum=%d\n",
Queue
->
Num
);

3345  
TRUE
;

3346 
	}
}

3357 
BOOLEAN
 
	$MlmeEnqueueF‹Recv
(

3358 
IN
 
PRTMP_ADAPTER
 
pAd
,

3359 
IN
 
PFRAME_802_11
 
p80211hdr
,

3360 
IN
 
UCHAR
 
Rssi
,

3361 
IN
 
ULONG
 
MsgLí
,

3362 
IN
 
VOID
 *
Msg
,

3363 
IN
 
UCHAR
 
Sig«l
)

3365 
INT
 
Taû
, 
Machöe
;

3368 
PUCHAR
 
pFøme
 = (PUCHAR)
Msg
;

3370 
ULONG
 
MsgTy≥
;

3371 
MLME_QUEUE
 *
Queue
 = (MLME_QUEUE *)&
pAd
->
Mlme
.Queue;

3372 
IrqFœgs
;

3374 if((
pAd
->
MLMEThr_pid
 <= 0))

3375  
FALSE
;

3377 #ifde‡
RALINK_ATE


3378 if(
pAd
->
©e
.
Mode
 !
ATE_STASTART
)

3379  
FALSE
;

3384 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
))

3385  
FALSE
;

3396 i‡(
MsgLí
 + 
LENGTH_802_11
 > 
MAX_LEN_OF_MLME_BUFFER
)

3398 
	`DBGPRINT_ERR
("MlmeEnqueueF‹Recv: fømêtoÿœrge, sizê%d \n", 
MsgLí
 + 
LENGTH_802_11
 );

3399  
FALSE
;

3403 i‡(
	`MlmeQueueFuŒ
(
Queue
))

3405 
	`DBGPRINT_ERR
("MlmeEnqueueForRecv: fullánd dropped\n");

3406 
	`RTUSBMlmeUp
(
pAd
);

3407  
FALSE
;

3418 i‡(!
	`MsgTy≥Sub°
(
pAd
, 
p80211hdr
, 
pFøme
, &
Machöe
, &
MsgTy≥
))

3420 
	`DBGPRINT_ERR
("MlmeEnqueueF‹Recv: un-ªc⁄gnized mgmt->subty≥=%d\n", 
p80211hdr
->
Hdr
.
FC
.
SubTy≥
);

3421  
FALSE
;

3425 i‡((
Machöe
 =
SYNC_STATE_MACHINE
)&&(
MsgTy≥
 =
MT2_PEER_PROBE_RSP
)&&(
pAd
->
P‹tCfg
.
bGëAPC⁄fig
))

3427 i‡(
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 =
SYNC_IDLE
)

3429 
CHAR
 
CfgD©a
[
MAX_CFG_BUFFER_LEN
+1] = {0};

3430 i‡(
	`BackDo‹ProbeR•S™ôy
(
pAd
, 
Msg
, 
MsgLí
, 
CfgD©a
))

3432 
	`¥ötk
("MlmeEnqueueF‹Recv: CfgD©a÷í:%d):\n%s\n", 
	`°æí
(
CfgD©a
), CfgData);

3433 
pAd
->
P‹tCfg
.
bGëAPC⁄fig
 = 
FALSE
;

3439 
	`NdisAcquúeSpöLock
(&(
Queue
->
Lock
), 
IrqFœgs
);

3441 
Taû
 = 
Queue
->Tail;

3442 
Queue
->
Taû
++;

3443 
Queue
->
Num
++;

3444 i‡(
Queue
->
Taû
 =
MAX_LEN_OF_MLME_QUEUE
)

3446 
Queue
->
Taû
 = 0;

3449 
	`DBGPRINT
(
RT_DEBUG_INFO
, "MlmeEnqueueF‹Recv,Çum=%d\n",
Queue
->
Num
);

3451 
Queue
->
E¡ry
[
Taû
].
Occupõd
 = 
TRUE
;

3452 
Queue
->
E¡ry
[
Taû
].
Machöe
 = Machine;

3453 
Queue
->
E¡ry
[
Taû
].
MsgTy≥
 = MsgType;

3456 
Queue
->
E¡ry
[
Taû
].
MsgLí
 = MsgLí + 
LENGTH_802_11
;

3458 
Queue
->
E¡ry
[
Taû
].
Rssi
 = Rssi;

3459 
Queue
->
E¡ry
[
Taû
].
Sig«l
 = Signal;

3460 
Queue
->
E¡ry
[
Taû
].
bReqIsFromNdis
 = 
FALSE
;

3461 
Queue
->
E¡ry
[
Taû
].
Ch™√l
 = 
pAd
->
L©chRfRegs
.Channel;

3464 
	`NdisMoveMem‹y
(
Queue
->
E¡ry
[
Taû
].
Msg
, 
p80211hdr
, 
LENGTH_802_11
);

3465 
	`NdisMoveMem‹y
(&
Queue
->
E¡ry
[
Taû
].
Msg
[
LENGTH_802_11
], Msg, 
MsgLí
);

3468 
	`NdisRñó£SpöLock
(&(
Queue
->
Lock
), 
IrqFœgs
);

3470 
	`RTUSBMlmeUp
(
pAd
);

3472  
TRUE
;

3473 
	}
}

3482 
BOOLEAN
 
	$MlmeDequeue
(

3483 
IN
 
MLME_QUEUE
 *
Queue
,

3484 
OUT
 
MLME_QUEUE_ELEM
 **
EÀm
)

3486 
IrqFœgs
;

3488 
	`NdisAcquúeSpöLock
(&(
Queue
->
Lock
), 
IrqFœgs
);

3490 *
EÀm
 = &(
Queue
->
E¡ry
[Queue->
Hód
]);

3491 
Queue
->
Num
--;

3492 
Queue
->
Hód
++;

3493 i‡(
Queue
->
Hód
 =
MAX_LEN_OF_MLME_QUEUE
)

3495 
Queue
->
Hód
 = 0;

3498 
	`NdisRñó£SpöLock
(&(
Queue
->
Lock
), 
IrqFœgs
);

3500 
	`DBGPRINT
(
RT_DEBUG_INFO
, "MlmeDequeue,Çum=%d\n",
Queue
->
Num
);

3502  
TRUE
;

3503 
	}
}

3505 
VOID
 
	$MlmeRe°¨tSèãMachöe
(

3506 
IN
 
PRTMP_ADAPTER
 
pAd
)

3508 
BOOLEAN
 
C™˚Œed
;

3509 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "!!! MlmeRestartStateMachine !!!\n");

3511 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_MLME_RESET_IN_PROGRESS
);

3515 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
AssocTimî
, &
C™˚Œed
);

3516 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
RóssocTimî
, &
C™˚Œed
);

3517 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
DißssocTimî
, &
C™˚Œed
);

3518 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
AuthTimî
, &
C™˚Œed
);

3519 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
Bóc⁄Timî
, &
C™˚Œed
);

3520 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
SˇnTimî
, &
C™˚Œed
);

3524 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_IDLE
;

3525 
pAd
->
Mlme
.
AssocMachöe
.
CuºSèã
 = 
ASSOC_IDLE
;

3526 
pAd
->
Mlme
.
AuthMachöe
.
CuºSèã
 = 
AUTH_REQ_IDLE
;

3527 
pAd
->
Mlme
.
AuthR•Machöe
.
CuºSèã
 = 
AUTH_RSP_IDLE
;

3528 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SYNC_IDLE
;

3529 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_JOIN_IN_PROGRESS
))

3530 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_JOIN_IN_PROGRESS
);

3531 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_REASSOC_IN_PROGRESS
))

3532 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_REASSOC_IN_PROGRESS
);

3533 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
))

3534 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
);

3536 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_MLME_RESET_IN_PROGRESS
);

3538 
	}
}

3540 
VOID
 
	$MlmePo°Re°¨tSèãMachöe
(

3541 
IN
 
PRTMP_ADAPTER
 
pAd
)

3549 
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_MLME_RESET_IN_PROGRESS
))

3550 
	`RTMPu£cDñay
(100000);

3552 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "!!! MlmePostRestartStateMachine !!!\n");

3555 
	`AsicSwôchCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

3556 
	`AsicLockCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

3559 
	`RTUSBResumeMsduTønsmissi⁄
(
pAd
);

3560 
	}
}

3568 
BOOLEAN
 
	$MlmeQueueEm±y
(

3569 
IN
 
MLME_QUEUE
 *
Queue
)

3571 
BOOLEAN
 
Ans
;

3572 
IrqFœgs
;

3574 
	`NdisAcquúeSpöLock
(&(
Queue
->
Lock
), 
IrqFœgs
);

3576 
Ans
 = (
Queue
->
Num
 == 0);

3578 
	`NdisRñó£SpöLock
(&(
Queue
->
Lock
), 
IrqFœgs
);

3580  
Ans
;

3581 
	}
}

3589 
BOOLEAN
 
	$MlmeQueueFuŒ
(

3590 
IN
 
MLME_QUEUE
 *
Queue
)

3592 
BOOLEAN
 
Ans
;

3593 
IrqFœgs
;

3595 
	`NdisAcquúeSpöLock
(&(
Queue
->
Lock
), 
IrqFœgs
);

3597 
Ans
 = (
Queue
->
Num
 =
MAX_LEN_OF_MLME_QUEUE
Ë|| (Queue->
E¡ry
[Queue->
Taû
].
Occupõd
 =
TRUE
);

3599 
	`NdisRñó£SpöLock
(&(
Queue
->
Lock
), 
IrqFœgs
);

3601  
Ans
;

3602 
	}
}

3611 
VOID
 
	$MlmeQueueDe°roy
(

3612 
IN
 
MLME_QUEUE
 *
pQueue
)

3614 
IrqFœgs
;

3616 
	`NdisAcquúeSpöLock
(&(
pQueue
->
Lock
), 
IrqFœgs
);

3618 
pQueue
->
Num
 = 0;

3619 
pQueue
->
Hód
 = 0;

3620 
pQueue
->
Taû
 = 0;

3622 
	`NdisRñó£SpöLock
(&(
pQueue
->
Lock
), 
IrqFœgs
);

3623 
	`NdisFªeSpöLock
(&(
pQueue
->
Lock
));

3624 
	}
}

3634 
BOOLEAN
 
	$MsgTy≥Sub°
(

3635 
IN
 
PRTMP_ADAPTER
 
pAd
,

3638 
IN
 
PFRAME_802_11
 
p80211hdr
,

3639 
IN
 
PUCHAR
 
pFøme
,

3641 
OUT
 
INT
 *
Machöe
,

3642 
OUT
 
INT
 *
MsgTy≥
)

3644 
USHORT
 
Seq
;

3645 
UCHAR
 
EAPTy≥
;

3646 
BOOLEAN
 
Rëu∫
;

3654 i‡(
p80211hdr
->
Hdr
.
FC
.
Ty≥
 =
BTYPE_DATA
)

3657 *
Machöe
 = 
WPA_PSK_STATE_MACHINE
;

3660 
EAPTy≥
 = *(
pFøme
+
LENGTH_802_1_H
+1);

3662 
Rëu∫
 = 
	`W∑MsgTy≥Sub°
(
EAPTy≥
, 
MsgTy≥
);

3663  
Rëu∫
;

3668 i‡(
p80211hdr
->
Hdr
.
FC
.
Ty≥
 =
BTYPE_MGMT
)

3673 
p80211hdr
->
Hdr
.
FC
.
SubTy≥
)

3676 
SUBTYPE_ASSOC_REQ
:

3677 *
Machöe
 = 
ASSOC_STATE_MACHINE
;

3678 *
MsgTy≥
 = 
MT2_PEER_ASSOC_REQ
;

3680 
SUBTYPE_ASSOC_RSP
:

3681 *
Machöe
 = 
ASSOC_STATE_MACHINE
;

3682 *
MsgTy≥
 = 
MT2_PEER_ASSOC_RSP
;

3684 
SUBTYPE_REASSOC_REQ
:

3685 *
Machöe
 = 
ASSOC_STATE_MACHINE
;

3686 *
MsgTy≥
 = 
MT2_PEER_REASSOC_REQ
;

3688 
SUBTYPE_REASSOC_RSP
:

3689 *
Machöe
 = 
ASSOC_STATE_MACHINE
;

3690 *
MsgTy≥
 = 
MT2_PEER_REASSOC_RSP
;

3692 
SUBTYPE_PROBE_REQ
:

3693 *
Machöe
 = 
SYNC_STATE_MACHINE
;

3694 *
MsgTy≥
 = 
MT2_PEER_PROBE_REQ
;

3696 
SUBTYPE_PROBE_RSP
:

3697 *
Machöe
 = 
SYNC_STATE_MACHINE
;

3698 *
MsgTy≥
 = 
MT2_PEER_PROBE_RSP
;

3700 
SUBTYPE_BEACON
:

3701 *
Machöe
 = 
SYNC_STATE_MACHINE
;

3702 *
MsgTy≥
 = 
MT2_PEER_BEACON
;

3704 
SUBTYPE_ATIM
:

3705 *
Machöe
 = 
SYNC_STATE_MACHINE
;

3706 *
MsgTy≥
 = 
MT2_PEER_ATIM
;

3708 
SUBTYPE_DISASSOC
:

3709 *
Machöe
 = 
ASSOC_STATE_MACHINE
;

3710 *
MsgTy≥
 = 
MT2_PEER_DISASSOC_REQ
;

3712 
SUBTYPE_AUTH
:

3716 
	`NdisMoveMem‹y
(&
Seq
, &
pFøme
[2], (
USHORT
));

3718 i‡(
Seq
 == 1 || Seq == 3)

3720 *
Machöe
 = 
AUTH_RSP_STATE_MACHINE
;

3721 *
MsgTy≥
 = 
MT2_PEER_AUTH_ODD
;

3723 i‡(
Seq
 == 2 || Seq == 4)

3725 *
Machöe
 = 
AUTH_STATE_MACHINE
;

3726 *
MsgTy≥
 = 
MT2_PEER_AUTH_EVEN
;

3730  
FALSE
;

3733 
SUBTYPE_DEAUTH
:

3734 *
Machöe
 = 
AUTH_RSP_STATE_MACHINE
;

3735 *
MsgTy≥
 = 
MT2_PEER_DEAUTH
;

3738  
FALSE
;

3741  
TRUE
;

3744  
FALSE
;

3745 
	}
}

3762 
VOID
 
	$SèãMachöeInô
(

3763 
IN
 
STATE_MACHINE
 *
S
,

3764 
IN
 
STATE_MACHINE_FUNC
 
Tøns
[],

3765 
IN
 
ULONG
 
StNr
,

3766 
IN
 
ULONG
 
MsgNr
,

3767 
IN
 
STATE_MACHINE_FUNC
 
DefFunc
,

3768 
IN
 
ULONG
 
InôSèã
,

3769 
IN
 
ULONG
 
Ba£
)

3771 
ULONG
 
i
, 
j
;

3774 
S
->
NrSèã
 = 
StNr
;

3775 
S
->
NrMsg
 = 
MsgNr
;

3776 
S
->
Ba£
 = Base;

3778 
S
->
TønsFunc
 = 
Tøns
;

3781 
i
 = 0; i < 
StNr
; i++)

3783 
j
 = 0; j < 
MsgNr
; j++)

3785 
S
->
TønsFunc
[
i
 * 
MsgNr
 + 
j
] = 
DefFunc
;

3790 
S
->
CuºSèã
 = 
InôSèã
;

3792 
	}
}

3802 
VOID
 
	$SèãMachöeSëA˘i⁄
(

3803 
IN
 
STATE_MACHINE
 *
S
,

3804 
IN
 
ULONG
 
St
,

3805 
IN
 
ULONG
 
Msg
,

3806 
IN
 
STATE_MACHINE_FUNC
 
Func
)

3808 
ULONG
 
MsgIdx
;

3810 
MsgIdx
 = 
Msg
 - 
S
->
Ba£
;

3812 i‡(
St
 < 
S
->
NrSèã
 && 
MsgIdx
 < S->
NrMsg
)

3815 
S
->
TønsFunc
[
St
 * S->
NrMsg
 + 
MsgIdx
] = 
Func
;

3817 
	}
}

3825 
VOID
 
	$SèãMachöePîf‹mA˘i⁄
(

3826 
IN
 
PRTMP_ADAPTER
 
pAd
,

3827 
IN
 
STATE_MACHINE
 *
S
,

3828 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

3830 (*(
S
->
TønsFunc
[S->
CuºSèã
 * S->
NrMsg
 + 
EÀm
->
MsgTy≥
 - S->
Ba£
]))(
pAd
, Elem);

3831 
	}
}

3841 
VOID
 
	$Dr›
(

3842 
IN
 
PRTMP_ADAPTER
 
pAd
,

3843 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

3845 
	}
}

3856 
VOID
 
	$Lf§Inô
(

3857 
IN
 
PRTMP_ADAPTER
 
pAd
,

3858 
IN
 
ULONG
 
Sìd
)

3860 i‡(
Sìd
 == 0)

3861 
pAd
->
Mlme
.
Shi·Reg
 = 1;

3863 
pAd
->
Mlme
.
Shi·Reg
 = 
Sìd
;

3864 
	}
}

3871 
UCHAR
 
	$R™domByã
(

3872 
IN
 
PRTMP_ADAPTER
 
pAd
)

3874 
ULONG
 
i
;

3875 
UCHAR
 
R
, 
Resu…
;

3877 
R
 = 0;

3878 
	`NdisGëSy°emUpTime
((
ULONG
 *)&
pAd
->
Mlme
.
Shi·Reg
);

3879 
i
 = 0; i < 8; i++)

3881 i‡(
pAd
->
Mlme
.
Shi·Reg
 & 0x00000001)

3883 
pAd
->
Mlme
.
Shi·Reg
 = (’Ad->Mlme.Shi·Reg ^ 
LFSR_MASK
) >> 1) | 0x80000000;

3884 
Resu…
 = 1;

3888 
pAd
->
Mlme
.
Shi·Reg
 =ÖAd->Mlme.ShiftReg >> 1;

3889 
Resu…
 = 0;

3891 
R
 = (R << 1Ë| 
Resu…
;

3894  
R
;

3895 
	}
}

3902 
VOID
 
	$AsicSwôchCh™√l
(

3903 
IN
 
PRTMP_ADAPTER
 
pAd
,

3904 
IN
 
UCHAR
 
Ch™√l
)

3906 
ULONG
 
R3
 = 
DEFAULT_RF_TX_POWER
, 
R4
;

3907 
CHAR
 
TxPwî
 = 0, 
Bbp94
 = 
BBPR94_DEFAULT
;

3908 
UCHAR
 
ödex
, 
BbpReg
;

3911 
	`AsicA¡í«Sñe˘
(
pAd
, 
Ch™√l
);

3914 
ödex
 = 0; index < 
pAd
->
Ch™√lLi°Num
; index++)

3916 i‡(
Ch™√l
 =
pAd
->
Ch™√lLi°
[
ödex
].Channel)

3918 
TxPwî
 = 
pAd
->
Ch™√lLi°
[
ödex
].
Powî
;

3923 i‡(
TxPwî
 > 31)

3928 
R3
 = 31;

3929 i‡(
TxPwî
 <= 36)

3930 
Bbp94
 = 
BBPR94_DEFAULT
 + (
UCHAR
Ë(
TxPwî
 - 31);

3932 i‡(
TxPwî
 < 0)

3937 
R3
 = 0;

3938 i‡(
TxPwî
 >= -6)

3939 
Bbp94
 = 
BBPR94_DEFAULT
 + 
TxPwî
;

3944 
R3
 = (
ULONG
Ë
TxPwî
;

3950 i‡(
pAd
->
P‹tCfg
.
TxPowîPî˚¡age
 > 90)

3952 i‡(
pAd
->
P‹tCfg
.
TxPowîPî˚¡age
 > 60)

3954 i‡(
R3
 > 2)

3955 
R3
 -= 2;

3957 
R3
 = 0;

3959 i‡(
pAd
->
P‹tCfg
.
TxPowîPî˚¡age
 > 30)

3961 i‡(
R3
 > 6)

3962 
R3
 -= 6;

3964 
R3
 = 0;

3966 i‡(
pAd
->
P‹tCfg
.
TxPowîPî˚¡age
 > 15)

3968 i‡(
R3
 > 12)

3969 
R3
 -= 12;

3971 
R3
 = 0;

3973 i‡(
pAd
->
P‹tCfg
.
TxPowîPî˚¡age
 > 9)

3975 i‡(
R3
 > 18)

3976 
R3
 -= 18;

3978 
R3
 = 0;

3982 i‡(
R3
 > 24)

3983 
R3
 -= 24;

3985 
R3
 = 0;

3988 i‡(
R3
 > 31) R3 = 31;

3990 i‡(
Bbp94
 < 0) Bbp94 = 0;

3992 
R3
 = R3 << 9;

3994 
pAd
->
RfIcTy≥
)

3996 
RFIC_2528
:

3998 
ödex
 = 0; index < 
NUM_OF_2528_CHNL
; index++)

4000 i‡(
Ch™√l
 =
RF2528RegTabÀ
[
ödex
].Channel)

4002 
R3
 = R3 | (
RF2528RegTabÀ
[
ödex
].R3 & 0xffffc1ff);

4003 
R4
 = (
RF2528RegTabÀ
[
ödex
].R4 & (~0x0003f000)Ë| (
pAd
->
RfFªqOff£t
 << 12);

4006 
pAd
->
L©chRfRegs
.
Ch™√l
 = Channel;

4007 
pAd
->
L©chRfRegs
.
R1
 = 
RF2528RegTabÀ
[
ödex
].R1;

4008 
pAd
->
L©chRfRegs
.
R2
 = 
RF2528RegTabÀ
[
ödex
].R2;

4009 
pAd
->
L©chRfRegs
.
R3
 = R3;

4010 
pAd
->
L©chRfRegs
.
R4
 = R4;

4017 
RFIC_5226
:

4018 
ödex
 = 0; index < 
NUM_OF_5226_CHNL
; index++)

4020 i‡(
Ch™√l
 =
RF5226RegTabÀ
[
ödex
].Channel)

4022 
R3
 = R3 | (
RF5226RegTabÀ
[
ödex
].R3 & 0xffffc1ff);

4023 
R4
 = (
RF5226RegTabÀ
[
ödex
].R4 & (~0x0003f000)Ë| (
pAd
->
RfFªqOff£t
 << 12);

4026 
pAd
->
L©chRfRegs
.
Ch™√l
 = Channel;

4027 
pAd
->
L©chRfRegs
.
R1
 = 
RF5226RegTabÀ
[
ödex
].R1;

4028 
pAd
->
L©chRfRegs
.
R2
 = 
RF5226RegTabÀ
[
ödex
].R2;

4029 
pAd
->
L©chRfRegs
.
R3
 = R3;

4030 
pAd
->
L©chRfRegs
.
R4
 = R4;

4037 
RFIC_5225
:

4038 
RFIC_2527
:

4039 
ödex
 = 0; index < 
NUM_OF_5225_CHNL
; index++)

4041 i‡(
Ch™√l
 =
RF5225RegTabÀ
[
ödex
].Channel)

4043 
R3
 = R3 | (
RF5225RegTabÀ
[
ödex
].R3 & 0xffffc1ff);

4044 
R4
 = (
RF5225RegTabÀ
[
ödex
].R4 & (~0x0003f000)Ë| (
pAd
->
RfFªqOff£t
 << 12);

4047 
pAd
->
L©chRfRegs
.
Ch™√l
 = Channel;

4048 
pAd
->
L©chRfRegs
.
R1
 = 
RF5225RegTabÀ
[
ödex
].R1;

4049 
pAd
->
L©chRfRegs
.
R2
 = 
RF5225RegTabÀ
[
ödex
].R2;

4050 
pAd
->
L©chRfRegs
.
R3
 = R3;

4051 
pAd
->
L©chRfRegs
.
R4
 = R4;

4057 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R3
, &
BbpReg
);

4058 i‡((
pAd
->
RfIcTy≥
 =
RFIC_5225
Ë|| (pAd->RfIcTy≥ =
RFIC_2527
))

4059 
BbpReg
 &= 0xFE;

4061 
BbpReg
 |= 0x01;

4062 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R3
, 
BbpReg
);

4065 
RFIC_3020
:

4066 
ödex
 = 0; index < 
NUM_OF_3020_CHNL
; index++)

4068 i‡(
Ch™√l
 =
RF3020RegTabÀ
[
ödex
].Channel)

4070 
R3
 = R3 | (
RF3020RegTabÀ
[
ödex
].R3 & 0xffffc1ff);

4071 
R4
 = (
RF3020RegTabÀ
[
ödex
].R4 & (~0x0003f000)Ë| (
pAd
->
RfFªqOff£t
 << 12);

4074 
pAd
->
L©chRfRegs
.
Ch™√l
 = Channel;

4075 
pAd
->
L©chRfRegs
.
R1
 = 
RF3020RegTabÀ
[
ödex
].R1;

4076 
pAd
->
L©chRfRegs
.
R2
 = 
RF3020RegTabÀ
[
ödex
].R2;

4077 
pAd
->
L©chRfRegs
.
R3
 = R3;

4078 
pAd
->
L©chRfRegs
.
R4
 = R4;

4089 i‡(
Bbp94
 !
BBPR94_DEFAULT
)

4091 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R94
, 
Bbp94
);

4092 
pAd
->
Bbp94
 = Bbp94;

4095 i‡(!
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

4097 i‡(
Ch™√l
 <= 14)

4099 i‡(
pAd
->
BbpTunög
.
R17LowîUµîSñe˘
 == 0)

4100 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R17
,ÖAd->
BbpTunög
.
R17LowîBoundG
);

4102 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R17
,ÖAd->
BbpTunög
.
R17UµîBoundG
);

4106 i‡(
pAd
->
BbpTunög
.
R17LowîUµîSñe˘
 == 0)

4107 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R17
,ÖAd->
BbpTunög
.
R17LowîBoundA
);

4109 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R17
,ÖAd->
BbpTunög
.
R17UµîBoundA
);

4114 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R1
);

4115 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R2
);

4116 
	`RTUSBWrôeRFRegi°î
(
pAd
, (pAd->
L©chRfRegs
.
R3
 & (~0x04)));

4117 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R4
);

4120 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R1
);

4121 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R2
);

4122 
	`RTUSBWrôeRFRegi°î
(
pAd
, (pAd->
L©chRfRegs
.
R3
 | 0x04));

4123 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R4
);

4126 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R1
);

4127 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R2
);

4128 
	`RTUSBWrôeRFRegi°î
(
pAd
, (pAd->
L©chRfRegs
.
R3
 & (~0x04)));

4129 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R4
);

4137 
	`RTMPu£cDñay
(10);

4139 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AsicSwitchChannel(RF=%d)Åo #%d, TXPwr=%d%%, R1=0x%08x, R2=0x%08x, R3=0x%08x, R4=0x%08x\n",

4140 
pAd
->
RfIcTy≥
,

4141 
pAd
->
L©chRfRegs
.
Ch™√l
,

4142 (
R3
 & 0x00003e00) >> 9,

4143 
pAd
->
L©chRfRegs
.
R1
,

4144 
pAd
->
L©chRfRegs
.
R2
,

4145 
pAd
->
L©chRfRegs
.
R3
,

4146 
pAd
->
L©chRfRegs
.
R4
);

4147 
	}
}

4158 
VOID
 
	$AsicLockCh™√l
(

4159 
IN
 
PRTMP_ADAPTER
 
pAd
,

4160 
IN
 
UCHAR
 
Ch™√l
)

4163 
	}
}

4166 *
	gA¡Så
[3] = {"DIVERSITY","Ant-A","Ant-B"};

4168 
	#SOFTWARE_DIVERSITY
 0

	)

4169 
	#ANTENNA_A
 1

	)

4170 
	#ANTENNA_B
 2

	)

4171 
	#HARDWARE_DIVERSITY
 3

	)

4178 
VOID
 
	$AsicA¡í«Sñe˘
(

4179 
IN
 
PRTMP_ADAPTER
 
pAd
,

4180 
IN
 
UCHAR
 
Ch™√l
)

4182 
ULONG
 
vÆue
;

4183 
ABGBAND_STATE
 
B™dSèã
;

4186 
	`DBGPRINT
(
RT_DEBUG_INFO
,"AsicAntennaSelect(ch=%d) - Tx=%s, Rx=%s\n",

4187 
Ch™√l
, 
A¡Så
[
pAd
->
A¡í«
.
fõld
.
TxDeÁu…A¡í«
], A¡Så[pAd->A¡í«.fõld.
RxDeÁu…A¡í«
]);

4189 i‡(
Ch™√l
 <= 14)

4190 
B™dSèã
 = 
BG_BAND
;

4192 
B™dSèã
 = 
A_BAND
;

4198 i‡(
B™dSèã
 =
pAd
->
P‹tCfg
.BandState)

4202 i‡(
Ch™√l
 <= 14)

4204 i‡(
pAd
->
NicC⁄fig2
.
fõld
.
Exã∫ÆLNA
)

4207 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17, 0x30);

4208 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 96, 0x68);

4209 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 104, 0x3C);

4210 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 75, 0x80);

4211 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 86, 0x80);

4212 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 88, 0x80);

4216 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17, 0x20);

4217 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 96, 0x48);

4218 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 104, 0x2C);

4219 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 75, 0xFE);

4220 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 86, 0xFE);

4221 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 88, 0xFE);

4223 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 35, 0x50);

4224 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 97, 0x48);

4225 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 98, 0x48);

4229 i‡(
pAd
->
NicC⁄fig2
.
fõld
.
Exã∫ÆLNA
)

4231 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17, 0x38);

4232 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 96, 0x78);

4233 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 104, 0x48);

4234 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 75, 0x80);

4235 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 86, 0x80);

4236 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 88, 0x80);

4240 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17, 0x28);

4241 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 96, 0x58);

4242 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 104, 0x38);

4244 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 35, 0x60);

4245 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 97, 0x58);

4246 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 98, 0x58);

4249 
	`RTUSBRódMACRegi°î
(
pAd
, 
PHY_CSR0
, &
vÆue
);

4250 
vÆue
 = value & 0xfffcffff;

4251 i‡(
Ch™√l
 <= 14)

4252 
vÆue
 = vÆuê| 
BIT32
[16];

4254 
vÆue
 = vÆuê| 
BIT32
[17];

4255 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
PHY_CSR0
, 
vÆue
);

4257 
pAd
->
P‹tCfg
.
B™dSèã
 = BandState;

4259 
	`AsicA¡í«Sëtög
(
pAd
, 
B™dSèã
);

4260 
	}
}

4262 
VOID
 
	$AsicA¡í«Sëtög
(

4263 
IN
 
PRTMP_ADAPTER
 
pAd
,

4264 
IN
 
ABGBAND_STATE
 
B™dSèã
)

4266 
UCHAR
 
R3
 = 0, 
R4
 = 0, 
R77
 = 0;

4267 
UCHAR
 
FømeTy≥MaskBô5
 = 0;

4271 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0257b032);

4273 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R3
, &
R3
);

4274 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R4
, &
R4
);

4275 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R77
, &
R77
);

4277 
R3
 &= 0xfe;

4278 
R4
 &= ~0x23;

4280 
FømeTy≥MaskBô5
 = ~(
pAd
->
A¡í«
.
fõld
.
FømeTy≥
 << 5);

4289 
pAd
->
A¡í«
.
fõld
.
RfIcTy≥
)

4291 
RFIC_5226
:

4293 i‡(
B™dSèã
 =
BG_BAND
)

4296 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
ANTENNA_A
)

4298 
R4
 = R4 | 0x01;

4299 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4301 
R77
 = R77 | 0x03;

4303 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

4305 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
ANTENNA_B
)

4307 
R4
 = R4 | 0x01;

4308 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4310 
R77
 = R77 & 0xfc;

4312 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

4314 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
HARDWARE_DIVERSITY
)

4316 
R4
 = R4 | 0x22;

4317 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4322 
R4
 = R4 | 0x01;

4323 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4325 
pAd
->
RxA¡
.
Paú1Prim¨yRxA¡
 = 1;

4326 
pAd
->
RxA¡
.
Paú1Sec⁄d¨yRxA¡
 = 0;

4328 
	`AsicSëRxA¡
(
pAd
,ÖAd->
RxA¡
.
Paú1Prim¨yRxA¡
,ÖAd->RxA¡.
Paú2Prim¨yRxA¡
);

4334 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
ANTENNA_A
)

4336 
R4
 = R4 | 0x01;

4337 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4339 
R77
 = R77 & 0xfc;

4341 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

4343 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
ANTENNA_B
)

4345 
R4
 = R4 | 0x01;

4346 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4348 
R77
 = R77 | 0x03;

4350 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

4352 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
HARDWARE_DIVERSITY
)

4354 
R4
 = R4 | 0x02;

4355 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4360 
R4
 = R4 | 0x01;

4361 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4363 
pAd
->
RxA¡
.
Paú1Prim¨yRxA¡
 = 1;

4364 
pAd
->
RxA¡
.
Paú1Sec⁄d¨yRxA¡
 = 0;

4365 
	`AsicSëRxA¡
(
pAd
,ÖAd->
RxA¡
.
Paú1Prim¨yRxA¡
,ÖAd->RxA¡.
Paú2Prim¨yRxA¡
);

4370 
RFIC_3020
:

4371 
RFIC_2528
:

4375 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
ANTENNA_A
)

4377 
R4
 = R4 | 0x21;

4378 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4380 
R77
 = R77 | 0x03;

4382 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

4384 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
ANTENNA_B
)

4386 
R4
 = R4 | 0x21;

4387 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4389 
R77
 = R77 & 0xfc;

4391 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

4393 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
HARDWARE_DIVERSITY
)

4395 
R4
 = R4 | 0x22;

4396 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4401 
R4
 = R4 | 0x21;

4402 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4404 
pAd
->
RxA¡
.
Paú1Prim¨yRxA¡
 = 1;

4405 
pAd
->
RxA¡
.
Paú1Sec⁄d¨yRxA¡
 = 0;

4406 
	`AsicSëRxA¡
(
pAd
,ÖAd->
RxA¡
.
Paú1Prim¨yRxA¡
,ÖAd->RxA¡.
Paú2Prim¨yRxA¡
);

4410 
RFIC_5225
:

4412 i‡(
B™dSèã
 =
BG_BAND
)

4415 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
ANTENNA_A
)

4417 
R4
 = R4 | 0x01;

4418 
R77
 = R77 | 0x03;

4420 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

4422 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
ANTENNA_B
)

4424 
R4
 = R4 | 0x01;

4425 
R77
 = R77 & 0xfc;

4427 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

4429 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
HARDWARE_DIVERSITY
)

4431 
R4
 = R4 | 0x22;

4436 
R4
 = R4 | 0x01;

4437 
pAd
->
RxA¡
.
Paú1Prim¨yRxA¡
 = 1;

4438 
pAd
->
RxA¡
.
Paú1Sec⁄d¨yRxA¡
 = 0;

4440 
	`AsicSëRxA¡
(
pAd
,ÖAd->
RxA¡
.
Paú1Prim¨yRxA¡
,ÖAd->RxA¡.
Paú2Prim¨yRxA¡
);

4446 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
ANTENNA_A
)

4448 
R4
 = R4 | 0x01;

4449 
R77
 = R77 & 0xfc;

4451 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

4453 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
ANTENNA_B
)

4455 
R4
 = R4 | 0x01;

4456 
R77
 = R77 | 0x03;

4458 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

4460 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
HARDWARE_DIVERSITY
)

4462 
R4
 = R4 | 0x02;

4467 
R4
 = R4 | 0x01;

4468 
pAd
->
RxA¡
.
Paú1Prim¨yRxA¡
 = 1;

4469 
pAd
->
RxA¡
.
Paú1Sec⁄d¨yRxA¡
 = 0;

4470 
	`AsicSëRxA¡
(
pAd
,ÖAd->
RxA¡
.
Paú1Prim¨yRxA¡
,ÖAd->RxA¡.
Paú2Prim¨yRxA¡
);

4475 
RFIC_2527
:

4479 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
ANTENNA_A
)

4481 
R4
 = R4 | 0x21;

4482 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4484 
R77
 = R77 | 0x03;

4486 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

4488 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
ANTENNA_B
)

4490 
R4
 = R4 | 0x21;

4491 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4493 
R77
 = R77 & 0xfc;

4495 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

4497 i‡(
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 =
HARDWARE_DIVERSITY
)

4499 
R4
 = R4 | 0x22;

4500 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4505 
R4
 = R4 | 0x21;

4506 
R4
 = R4 & 
FømeTy≥MaskBô5
;

4508 
pAd
->
RxA¡
.
Paú1Prim¨yRxA¡
 = 1;

4509 
pAd
->
RxA¡
.
Paú1Sec⁄d¨yRxA¡
 = 0;

4510 
	`AsicSëRxA¡
(
pAd
,ÖAd->
RxA¡
.
Paú1Prim¨yRxA¡
,ÖAd->RxA¡.
Paú2Prim¨yRxA¡
);

4515 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Unkown RFIC Type\n");

4519 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R3
, 
R3
);

4520 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R4
, 
R4
);

4522 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x025eb032);

4523 
	}
}

4542 
VOID
 
	$AsicAdju°TxPowî
(

4543 
IN
 
PRTMP_ADAPTER
 
pAd
)

4545 
ULONG
 
R3
, 
CuºTxPwr
;

4546 
SHORT
 
dbm
;

4547 
UCHAR
 
TxR©e
, 
Ch™√l
, 
ödex
;

4548 
BOOLEAN
 
bAutoTxAgc
 = 
FALSE
;

4549 
UCHAR
 
TssiRef
, *
pTssiMöusBound¨y
, *
pTssiPlusBound¨y
, 
TxAgcSãp
;

4550 
UCHAR
 
BbpR1
, 
idx
;

4551 
PCHAR
 
pTxAgcCom≥nßã
;

4552 
CHAR
 
TxPwî
=0;

4554 
TxR©e
 = 
pAd
->
P‹tCfg
.TxRate;

4555 
Ch™√l
 = 
pAd
->
P‹tCfg
.Channel;

4557 
dbm
 = 
pAd
->
P‹tCfg
.
AvgRssi
 -ÖAd->
BbpRssiToDbmDñè
;

4560 
R3
 = 
DEFAULT_RF_TX_POWER
;

4561 
ödex
0 ; index < 
pAd
->
Ch™√lLi°Num
; index++)

4563 i‡(
pAd
->
Ch™√lLi°
[
ödex
].
Ch™√l
 =pAd->
P‹tCfg
.Channel)

4565 
TxPwî
 = 
pAd
->
Ch™√lLi°
[
ödex
].
Powî
;

4574 i‡(
TxPwî
 < 0)

4575 
R3
 = 0;

4576 i‡(
TxPwî
 > 31)

4577 
R3
 = 31;

4579 
R3
 = (
ULONG
Ë
TxPwî
;

4583 i‡(
ödex
 >
pAd
->
Ch™√lLi°Num
)

4585 
	`DBGPRINT_ERR
("AsicAdju°TxPowî(ˇ¿födÖAd->P‹tCfg.Ch™√l=%d i¿Ch™√lLi°[%d]\n", 
pAd
->
P‹tCfg
.
Ch™√l
,ÖAd->
Ch™√lLi°Num
);

4590 i‡(
pAd
->
Mlme
.
PîiodicRound
 % 4 == 0)

4592 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 <= 14)

4594 
bAutoTxAgc
 = 
pAd
->
bAutoTxAgcG
;

4595 
TssiRef
 = 
pAd
->
TssiRefG
;

4596 
pTssiMöusBound¨y
 = &
pAd
->
TssiMöusBound¨yG
[0];

4597 
pTssiPlusBound¨y
 = &
pAd
->
TssiPlusBound¨yG
[0];

4598 
TxAgcSãp
 = 
pAd
->
TxAgcSãpG
;

4599 
pTxAgcCom≥nßã
 = &
pAd
->
TxAgcCom≥nßãG
;

4603 
bAutoTxAgc
 = 
pAd
->
bAutoTxAgcA
;

4604 
TssiRef
 = 
pAd
->
TssiRefA
;

4605 
pTssiMöusBound¨y
 = &
pAd
->
TssiMöusBound¨yA
[0];

4606 
pTssiPlusBound¨y
 = &
pAd
->
TssiPlusBound¨yA
[0];

4607 
TxAgcSãp
 = 
pAd
->
TxAgcSãpA
;

4608 
pTxAgcCom≥nßã
 = &
pAd
->
TxAgcCom≥nßãA
;

4611 i‡(
bAutoTxAgc
)

4613 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R1
, &
BbpR1
);

4614 i‡(
BbpR1
 > 
pTssiMöusBound¨y
[1])

4618 
idx
 = 1; idx < 5; idx++)

4620 i‡(
BbpR1
 <
pAd
->
TssiMöusBound¨yG
[
idx
])

4624 i‡(
R3
 > (
ULONG
Ë(
TxAgcSãp
 * (
idx
-1)))

4625 *
pTxAgcCom≥nßã
 = -(
TxAgcSãp
 * (
idx
-1));

4627 *
pTxAgcCom≥nßã
 = -((
UCHAR
)
R3
);

4629 
R3
 +(*
pTxAgcCom≥nßã
);

4630 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "-- Tx Power, BBP R1=%x, TssiRef=%x, TxAgcStep=%x, step = -%d\n",

4631 
BbpR1
, 
TssiRef
, 
TxAgcSãp
, 
idx
-1);

4633 i‡(
BbpR1
 < 
pTssiPlusBound¨y
[1])

4637 
idx
 = 1; idx < 5; idx++)

4639 i‡(
BbpR1
 >
pTssiPlusBound¨y
[
idx
])

4643 *
pTxAgcCom≥nßã
 = 
TxAgcSãp
 * (
idx
-1);

4644 
R3
 +(*
pTxAgcCom≥nßã
);

4645 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "++ Tx Power, BBP R1=%x, Tssi0=%x, TxAgcStep=%x, step = +%d\n",

4646 
BbpR1
, 
TssiRef
, 
TxAgcSãp
, 
idx
-1);

4652 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 <= 14)

4654 
bAutoTxAgc
 = 
pAd
->
bAutoTxAgcG
;

4655 
pTxAgcCom≥nßã
 = &
pAd
->
TxAgcCom≥nßãG
;

4659 
bAutoTxAgc
 = 
pAd
->
bAutoTxAgcA
;

4660 
pTxAgcCom≥nßã
 = &
pAd
->
TxAgcCom≥nßãA
;

4663 i‡(
bAutoTxAgc
)

4664 
R3
 +(*
pTxAgcCom≥nßã
);

4670 i‡(
pAd
->
P‹tCfg
.
TxPowîPî˚¡age
 == 0xffffffff)

4674 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

4678 i‡(
dbm
 > 
RSSI_FOR_LOWEST_TX_POWER
)

4680 i‡(
R3
 > 
LOWEST_TX_POWER_DELTA
)

4681 
R3
 -
LOWEST_TX_POWER_DELTA
;

4683 
R3
 = 0;

4685 i‡(
dbm
 > 
RSSI_FOR_LOW_TX_POWER
)

4687 i‡(
R3
 > 
LOW_TX_POWER_DELTA
)

4688 
R3
 -
LOW_TX_POWER_DELTA
;

4690 
R3
 = 0;

4695 i‡(
pAd
->
P‹tCfg
.
TxPowîPî˚¡age
 > 90)

4697 i‡(
pAd
->
P‹tCfg
.
TxPowîPî˚¡age
 > 60)

4699 i‡(
R3
 > 2)

4700 
R3
 -= 2;

4702 
R3
 = 0;

4704 i‡(
pAd
->
P‹tCfg
.
TxPowîPî˚¡age
 > 30)

4706 i‡(
R3
 > 6)

4707 
R3
 -= 6;

4709 
R3
 = 0;

4711 i‡(
pAd
->
P‹tCfg
.
TxPowîPî˚¡age
 > 15)

4713 i‡(
R3
 > 12)

4714 
R3
 -= 12;

4716 
R3
 = 0;

4718 i‡(
pAd
->
P‹tCfg
.
TxPowîPî˚¡age
 > 9)

4720 i‡(
R3
 > 18)

4721 
R3
 -= 18;

4723 
R3
 = 0;

4727 i‡(
R3
 > 24)

4728 
R3
 -= 24;

4730 
R3
 = 0;

4733 i‡(
R3
 > 31) R3 = 31;

4737 
CuºTxPwr
 = (
pAd
->
L©chRfRegs
.
R3
 >> 9) & 0x0000001f;

4738 i‡(
CuºTxPwr
 !
R3
)

4740 
CuºTxPwr
 = 
R3
;

4741 
R3
 = (
pAd
->
L©chRfRegs
.R3 & 0xffffc1ff) | (R3 << 9);

4742 
pAd
->
L©chRfRegs
.
R3
 = R3;

4745 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R1
);

4746 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R2
);

4747 
	`RTUSBWrôeRFRegi°î
(
pAd
, (pAd->
L©chRfRegs
.
R3
 & (~0x04)));

4748 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R4
);

4751 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R1
);

4752 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R2
);

4753 
	`RTUSBWrôeRFRegi°î
(
pAd
, (pAd->
L©chRfRegs
.
R3
 | 0x04));

4754 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R4
);

4757 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R1
);

4758 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R2
);

4759 
	`RTUSBWrôeRFRegi°î
(
pAd
, (pAd->
L©chRfRegs
.
R3
 & (~0x04)));

4760 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R4
);

4766 
	}
}

4778 
VOID
 
	$AsicSÀïThíAutoWakeup
(

4779 
IN
 
PRTMP_ADAPTER
 
pAd
,

4780 
IN
 
USHORT
 
TbâNumToNextWakeUp
)

4782 
MAC_CSR11_STRUC
 
c§11
;

4785 i‡(
TbâNumToNextWakeUp
 == 0)

4786 
TbâNumToNextWakeUp
 = 1;

4789 
c§11
.
w‹d
 = 0;

4790 
c§11
.
fõld
.
SÀï2AwakeL©ícy
 = 5;

4791 
c§11
.
fõld
.
NumOfTBTTBef‹eWakeup
 = 
TbâNumToNextWakeUp
 - 1;

4792 
c§11
.
fõld
.
DñayA·îLa°TBTTBef‹eWakeup
 = 
pAd
->
P‹tCfg
.
Bóc⁄Pîiod
 - 10;

4798 
c§11
.
fõld
.
bAutoWakeupE«bÀ
 = 0;

4799 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR11
, 
c§11
.
w‹d
);

4801 
c§11
.
fõld
.
bAutoWakeupE«bÀ
 = 1;

4802 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR11
, 
c§11
.
w‹d
);

4804 
	`DBGPRINT
(
RT_DEBUG_TRACE
, ">>>AsicSleepThenAutoWakeup(sleep %d TU)<<<\n",

4805 (
c§11
.
fõld
.
NumOfTBTTBef‹eWakeup
 * 
pAd
->
P‹tCfg
.
Bóc⁄Pîiod
Ë+ c§11.fõld.
DñayA·îLa°TBTTBef‹eWakeup
);

4807 
	`RTUSBPutToSÀï
(
pAd
);

4809 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_DOZE
);

4810 
	}
}

4820 
VOID
 
	$AsicF‹˚SÀï
(

4821 
IN
 
PRTMP_ADAPTER
 
pAd
)

4823 
MAC_CSR11_STRUC
 
c§11
;

4825 
	`DBGPRINT
(
RT_DEBUG_TRACE
, ">>>AsicForceSleep<<<\n");

4828 
c§11
.
w‹d
 = 0;

4829 
c§11
.
fõld
.
SÀï2AwakeL©ícy
 = 5;

4830 
c§11
.
fõld
.
bAutoWakeupE«bÀ
 = 0;

4831 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR11
, 
c§11
.
w‹d
);

4833 
	`RTUSBPutToSÀï
(
pAd
);

4835 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_DOZE
);

4836 
	}
}

4846 
VOID
 
	$AsicF‹˚Wakeup
(

4847 
IN
 
PRTMP_ADAPTER
 
pAd
)

4849 
MAC_CSR11_STRUC
 
c§11
;

4851 
	`DBGPRINT
(
RT_DEBUG_TRACE
, ">>>AsicForceWakeup<<<\n");

4853 
	`RTUSBWakeUp
(
pAd
);

4856 
c§11
.
w‹d
 = 0;

4857 
c§11
.
fõld
.
SÀï2AwakeL©ícy
 = 5;

4858 
c§11
.
fõld
.
bAutoWakeupE«bÀ
 = 0;

4859 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR11
, 
c§11
.
w‹d
);

4861 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_DOZE
);

4862 
	}
}

4870 
VOID
 
	$AsicSëBssid
(

4871 
IN
 
PRTMP_ADAPTER
 
pAd
,

4872 
IN
 
PUCHAR
 
pBssid
)

4874 
ULONG
 
Addr4
;

4876 
	`DBGPRINT
(
RT_DEBUG_TRACE
, ">>>AsicSetBssid<<<\n");

4878 
Addr4
 = (
ULONG
)(
pBssid
[0]) |

4879 (
ULONG
)(
pBssid
[1] << 8) |

4880 (
ULONG
)(
pBssid
[2] << 16) |

4881 (
ULONG
)(
pBssid
[3] << 24);

4882 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR4
, 
Addr4
);

4885 
Addr4
 = (
ULONG
)(
pBssid
[4]) | (ULONG)(pBssid[5] << 8) | 0x00030000;

4886 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR5
, 
Addr4
);

4887 
	}
}

4895 
VOID
 
	$AsicDißbÀSync
(

4896 
IN
 
PRTMP_ADAPTER
 
pAd
)

4898 
TXRX_CSR9_STRUC
 
c§
;

4899 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "--->Disable TSF synchronization\n");

4904 
	`RTUSBRódMACRegi°î
(
pAd
, 
TXRX_CSR9
, &
c§
.
w‹d
);

4905 
c§
.
fõld
.
bBóc⁄Gí
 = 0;

4906 
c§
.
fõld
.
TsfSyncMode
 = 0;

4907 
c§
.
fõld
.
bTBTTE«bÀ
 = 0;

4908 
c§
.
fõld
.
bTsfTickög
 = 0;

4909 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR9
, 
c§
.
w‹d
);

4910 
	}
}

4917 
VOID
 
	$AsicE«bÀBssSync
(

4918 
IN
 
PRTMP_ADAPTER
 
pAd
)

4920 
TXRX_CSR9_STRUC
 
c§
;

4922 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "--->AsicEnableBssSync(INFRA mode)\n");

4924 
	`RTUSBRódMACRegi°î
(
pAd
, 
TXRX_CSR9
, &
c§
.
w‹d
);

4927 
c§
.
fõld
.
Bóc⁄I¡îvÆ
 = 
pAd
->
P‹tCfg
.
Bóc⁄Pîiod
 << 4;

4928 
c§
.
fõld
.
bTsfTickög
 = 1;

4929 
c§
.
fõld
.
TsfSyncMode
 = 1;

4930 
c§
.
fõld
.
bBóc⁄Gí
 = 0;

4931 
c§
.
fõld
.
bTBTTE«bÀ
 = 1;

4932 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR9
, 
c§
.
w‹d
);

4933 
	}
}

4945 
VOID
 
	$AsicE«bÀIbssSync
(

4946 
IN
 
PRTMP_ADAPTER
 
pAd
)

4948 
TXRX_CSR9_STRUC
 
c§9
;

4949 
PUCHAR
 
±r
;

4950 
UINT
 
i
;

4951 
ULONG
 
l⁄g±r
;

4953 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "--->AsicEnableIbssSync(ADHOC mode)\n");

4955 
	`RTUSBRódMACRegi°î
(
pAd
, 
TXRX_CSR9
, &
c§9
.
w‹d
);

4956 
c§9
.
fõld
.
bBóc⁄Gí
 = 0;

4957 
c§9
.
fõld
.
bTBTTE«bÀ
 = 0;

4958 
c§9
.
fõld
.
bTsfTickög
 = 0;

4959 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR9
, 
c§9
.
w‹d
);

4961 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
HW_BEACON_BASE0
, 0);

4962 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
HW_BEACON_BASE1
, 0);

4963 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
HW_BEACON_BASE2
, 0);

4964 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
HW_BEACON_BASE3
, 0);

4967 
±r
 = (
PUCHAR
)&
pAd
->
Bóc⁄TxD
;

4968 
i
=0; i<
TXINFO_SIZE
; )

4970 
l⁄g±r
 = *
±r
 + (*(ptr+1)<<8) + (*(ptr+2)<<16) + (*(ptr+3)<<24);

4971 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
HW_BEACON_BASE0
 + 
i
, 
l⁄g±r
);

4972 
±r
 += 4;

4973 
i
+=4;

4977 
±r
 = 
pAd
->
Bóc⁄Buf
;

4978 
i
=0; i< (
pAd
->
Bóc⁄TxD
.
D©aByãC¡
);)

4980 
l⁄g±r
 = *
±r
 + (*(ptr+1)<<8) + (*(ptr+2)<<16) + (*(ptr+3)<<24);

4981 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
HW_BEACON_BASE0
 + 
TXINFO_SIZE
 + 
i
, 
l⁄g±r
);

4982 
±r
 += 4;

4983 
i
+=4;

4990 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR10
, 0x00001008);

4993 
c§9
.
fõld
.
Bóc⁄I¡îvÆ
 = 
pAd
->
P‹tCfg
.
Bóc⁄Pîiod
 << 4;

4994 
c§9
.
fõld
.
bTsfTickög
 = 1;

4995 
c§9
.
fõld
.
TsfSyncMode
 = 2;

4996 
c§9
.
fõld
.
bTBTTE«bÀ
 = 1;

4997 
c§9
.
fõld
.
bBóc⁄Gí
 = 1;

4998 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR9
, 
c§9
.
w‹d
);

5000 
	}
}

5007 
VOID
 
	$AsicSëEdˇP¨m
(

5008 
IN
 
PRTMP_ADAPTER
 
pAd
,

5009 
IN
 
PEDCA_PARM
 
pEdˇP¨m
)

5011 
AC_TXOP_CSR0_STRUC
 
c§0
;

5012 
AC_TXOP_CSR1_STRUC
 
c§1
;

5013 
AIFSN_CSR_STRUC
 
Aif¢C§
;

5014 
CWMIN_CSR_STRUC
 
CwmöC§
;

5015 
CWMAX_CSR_STRUC
 
CwmaxC§
;

5017 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"AsicSetEdcaParm\n");

5018 i‡((
pEdˇP¨m
 =
NULL
Ë|| (pEdˇP¨m->
bVÆid
 =
FALSE
Ë|| (
pAd
->
P‹tCfg
.
bWmmC≠abÀ
 == FALSE))

5020 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_WMM_INUSED
);

5022 
c§0
.
fõld
.
Ac0Tx›
 = 0;

5023 
c§0
.
fõld
.
Ac1Tx›
 = 0;

5024 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
AC_TXOP_CSR0
, 
c§0
.
w‹d
);

5025 i‡(
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11B
)

5027 
c§1
.
fõld
.
Ac2Tx›
 = 
	`˝u2À16
(192);

5028 
c§1
.
fõld
.
Ac3Tx›
 = 
	`˝u2À16
(96);

5032 
c§1
.
fõld
.
Ac2Tx›
 = 
	`˝u2À16
(96);

5033 
c§1
.
fõld
.
Ac3Tx›
 = 
	`˝u2À16
(48);

5035 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
AC_TXOP_CSR1
, 
c§1
.
w‹d
);

5037 
CwmöC§
.
w‹d
 = 0;

5038 
CwmöC§
.
fõld
.
Cwmö0
 = 
CW_MIN_IN_BITS
;

5039 
CwmöC§
.
fõld
.
Cwmö1
 = 
CW_MIN_IN_BITS
;

5040 
CwmöC§
.
fõld
.
Cwmö2
 = 
CW_MIN_IN_BITS
;

5041 
CwmöC§
.
fõld
.
Cwmö3
 = 
CW_MIN_IN_BITS
;

5042 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
CWMIN_CSR
, 
CwmöC§
.
w‹d
);

5044 
CwmaxC§
.
w‹d
 = 0;

5045 
CwmaxC§
.
fõld
.
Cwmax0
 = 
CW_MAX_IN_BITS
;

5046 
CwmaxC§
.
fõld
.
Cwmax1
 = 
CW_MAX_IN_BITS
;

5047 
CwmaxC§
.
fõld
.
Cwmax2
 = 
CW_MAX_IN_BITS
;

5048 
CwmaxC§
.
fõld
.
Cwmax3
 = 
CW_MAX_IN_BITS
;

5049 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
CWMAX_CSR
, 
CwmaxC§
.
w‹d
);

5051 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
AIFSN_CSR
, 0x00002222);

5053 
	`NdisZîoMem‹y
(&
pAd
->
P‹tCfg
.
APEdˇP¨m
, (
EDCA_PARM
));

5057 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_WMM_INUSED
);

5063 
pEdˇP¨m
->
Cwmö
[
QID_AC_VI
] += 1;

5064 
pEdˇP¨m
->
Cwmax
[
QID_AC_VI
] += 1;

5065 
pEdˇP¨m
->
Tx›
[
QID_AC_VI
] =ÖEdcaParm->Txop[QID_AC_VI] * 7 / 10;

5067 
c§0
.
fõld
.
Ac0Tx›
 = 
	`˝u2À16
(
pEdˇP¨m
->
Tx›
[
QID_AC_BE
]);

5068 
c§0
.
fõld
.
Ac1Tx›
 = 
	`˝u2À16
(
pEdˇP¨m
->
Tx›
[
QID_AC_BK
]);

5069 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
AC_TXOP_CSR0
, 
c§0
.
w‹d
);

5071 
c§1
.
fõld
.
Ac2Tx›
 = 
	`˝u2À16
(
pEdˇP¨m
->
Tx›
[
QID_AC_VI
]);

5072 
c§1
.
fõld
.
Ac3Tx›
 = 
	`˝u2À16
(
pEdˇP¨m
->
Tx›
[
QID_AC_VO
]);

5073 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
AC_TXOP_CSR1
, 
c§1
.
w‹d
);

5075 
CwmöC§
.
w‹d
 = 0;

5076 
CwmöC§
.
fõld
.
Cwmö0
 = 
pEdˇP¨m
->
Cwmö
[
QID_AC_BE
];

5077 
CwmöC§
.
fõld
.
Cwmö1
 = 
pEdˇP¨m
->
Cwmö
[
QID_AC_BK
];

5078 
CwmöC§
.
fõld
.
Cwmö2
 = 
pEdˇP¨m
->
Cwmö
[
QID_AC_VI
];

5079 
CwmöC§
.
fõld
.
Cwmö3
 = 
pEdˇP¨m
->
Cwmö
[
QID_AC_VO
];

5080 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
CWMIN_CSR
, 
CwmöC§
.
w‹d
);

5082 
CwmaxC§
.
w‹d
 = 0;

5083 
CwmaxC§
.
fõld
.
Cwmax0
 = 
pEdˇP¨m
->
Cwmax
[
QID_AC_BE
];

5084 
CwmaxC§
.
fõld
.
Cwmax1
 = 
pEdˇP¨m
->
Cwmax
[
QID_AC_BK
];

5085 
CwmaxC§
.
fõld
.
Cwmax2
 = 
pEdˇP¨m
->
Cwmax
[
QID_AC_VI
];

5086 
CwmaxC§
.
fõld
.
Cwmax3
 = 
pEdˇP¨m
->
Cwmax
[
QID_AC_VO
];

5087 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
CWMAX_CSR
, 
CwmaxC§
.
w‹d
);

5089 
Aif¢C§
.
w‹d
 = 0;

5090 
Aif¢C§
.
fõld
.
Aif¢0
 = 
pEdˇP¨m
->
Aif¢
[
QID_AC_BE
];

5091 
Aif¢C§
.
fõld
.
Aif¢1
 = 
pEdˇP¨m
->
Aif¢
[
QID_AC_BK
];

5092 
Aif¢C§
.
fõld
.
Aif¢2
 = 
pEdˇP¨m
->
Aif¢
[
QID_AC_VI
];

5093 
Aif¢C§
.
fõld
.
Aif¢3
 = 
pEdˇP¨m
->
Aif¢
[
QID_AC_VO
];

5094 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
AIFSN_CSR
, 
Aif¢C§
.
w‹d
);

5096 
	`NdisMoveMem‹y
(&
pAd
->
P‹tCfg
.
APEdˇP¨m
, 
pEdˇP¨m
, (
EDCA_PARM
));

5098 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"EDCA [#%d]: AIFSN CWmö CWmax TXOP(usË ACM\n", 
pEdˇP¨m
->
EdˇUpd©eCou¡
);

5099 
	`DBGPRINT
(
RT_DEBUG_TRACE
," AC_BE %d %d %d %4d %d\n",

5100 
pEdˇP¨m
->
Aif¢
[0],

5101 
pEdˇP¨m
->
Cwmö
[0],

5102 
pEdˇP¨m
->
Cwmax
[0],

5103 
pEdˇP¨m
->
Tx›
[0]<<5,

5104 
pEdˇP¨m
->
bACM
[0]);

5105 
	`DBGPRINT
(
RT_DEBUG_TRACE
," AC_BK %d %d %d %4d %d\n",

5106 
pEdˇP¨m
->
Aif¢
[1],

5107 
pEdˇP¨m
->
Cwmö
[1],

5108 
pEdˇP¨m
->
Cwmax
[1],

5109 
pEdˇP¨m
->
Tx›
[1]<<5,

5110 
pEdˇP¨m
->
bACM
[1]);

5111 
	`DBGPRINT
(
RT_DEBUG_TRACE
," AC_VI %d %d %d %4d %d\n",

5112 
pEdˇP¨m
->
Aif¢
[2],

5113 
pEdˇP¨m
->
Cwmö
[2],

5114 
pEdˇP¨m
->
Cwmax
[2],

5115 
pEdˇP¨m
->
Tx›
[2]<<5,

5116 
pEdˇP¨m
->
bACM
[2]);

5117 
	`DBGPRINT
(
RT_DEBUG_TRACE
," AC_VO %d %d %d %4d %d\n",

5118 
pEdˇP¨m
->
Aif¢
[3],

5119 
pEdˇP¨m
->
Cwmö
[3],

5120 
pEdˇP¨m
->
Cwmax
[3],

5121 
pEdˇP¨m
->
Tx›
[3]<<5,

5122 
pEdˇP¨m
->
bACM
[3]);

5124 
	}
}

5131 
VOID
 
	$AsicSëSlŸTime
(

5132 
IN
 
PRTMP_ADAPTER
 
pAd
,

5133 
IN
 
BOOLEAN
 
bU£Sh‹tSlŸTime
)

5135 
MAC_CSR9_STRUC
 
C§9
;

5137 i‡–
pAd
->
P‹tCfg
.
Ch™√l
 > 14)

5138 
bU£Sh‹tSlŸTime
 = 
TRUE
;

5140 i‡(
bU£Sh‹tSlŸTime
 && 
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_SHORT_SLOT_INUSED
))

5142 i‡((!
bU£Sh‹tSlŸTime
Ë&& (!
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_SHORT_SLOT_INUSED
)))

5145 i‡(
bU£Sh‹tSlŸTime
)

5146 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_SHORT_SLOT_INUSED
);

5148 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_SHORT_SLOT_INUSED
);

5150 
	`RTUSBRódMACRegi°î
(
pAd
, 
MAC_CSR9
, &
C§9
.
w‹d
);

5151 
C§9
.
fõld
.
SlŸTime
 = (
bU£Sh‹tSlŸTime
)? 9 : 20;

5154 i‡(
pAd
->
P‹tCfg
.
bE«bÀTxBur°
)

5155 
C§9
.
fõld
.
SlŸTime
 = 9;

5157 i‡(
pAd
->
P‹tCfg
.
BssTy≥
 =
BSS_ADHOC
)

5158 
C§9
.
fõld
.
SlŸTime
 = 20;

5160 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR9
, 
C§9
.
w‹d
);

5163 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AsicSëSlŸTime(=%d us)\n", 
C§9
.
fõld
.
SlŸTime
);

5164 
	}
}

5174 
VOID
 
	$AsicBbpTunög
(

5175 
IN
 
PRTMP_ADAPTER
 
pAd
)

5177 
UCHAR
 
R17
, 
R17UµîBound
, 
R17LowîBound
;

5178 
dbm
;

5180 i‡((
pAd
->
BbpTunög
.
bE«bÀ
 =
FALSE
Ë|| (pAd->
P‹tCfg
.
Rad¨Dëe˘
.
RDMode
 !
RD_NORMAL_MODE
))

5183 i‡(
pAd
->
BbpTunög
.
bE«bÀ
 =
FALSE
)

5186 
R17
 = 
pAd
->
BbpWrôeL©ch
[17];

5191 i‡(
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 !
CNTL_IDLE
)

5194 
dbm
 = 
pAd
->
P‹tCfg
.
AvgRssi
 -ÖAd->
BbpRssiToDbmDñè
;

5199 i‡(
dbm
 > -82)

5201 
pAd
->
BbpTunög
.
R17LowîBoundG
 = 0x1C;

5202 
pAd
->
BbpTunög
.
R17UµîBoundG
 = 0x40;

5204 i‡(
dbm
 > -84)

5206 
pAd
->
BbpTunög
.
R17LowîBoundG
 = 0x1C;

5207 
pAd
->
BbpTunög
.
R17UµîBoundG
 = 0x20;

5211 
pAd
->
BbpTunög
.
R17LowîBoundG
 = 0x1C;

5212 
pAd
->
BbpTunög
.
R17UµîBoundG
 = 0x1C;

5216 i‡(
pAd
->
NicC⁄fig2
.
fõld
.
Exã∫ÆLNA
)

5218 
pAd
->
BbpTunög
.
R17LowîBoundG
 += 0x14;

5219 
pAd
->
BbpTunög
.
R17UµîBoundG
 += 0x10;

5222 i‡(
pAd
->
L©chRfRegs
.
Ch™√l
 <= 14)

5224 
R17UµîBound
 = 
pAd
->
BbpTunög
.
R17UµîBoundG
;

5225 
R17LowîBound
 = 
pAd
->
BbpTunög
.
R17LowîBoundG
;

5229 
R17UµîBound
 = 
pAd
->
BbpTunög
.
R17UµîBoundA
;

5230 
R17LowîBound
 = 
pAd
->
BbpTunög
.
R17LowîBoundA
;

5233 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

5239 i‡((
dbm
 < -80Ë&& (
pAd
->
Mlme
.
PîiodicRound
 > 20))

5241 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "weak RSSI=%d, CCA=%d, stopÅuning, R17 = 0x%x\n",

5242 
dbm
, 
pAd
->
RÆökCou¡îs
.
O√SecFÆ£CCAC¡
, 
R17
);

5249 i‡(
dbm
 >
RSSI_FOR_VERY_LOW_SENSIBILITY
)

5251 i‡(
R17
 != 0x60)

5253 
R17
 = 0x60;

5254 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17, 
R17
);

5256 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Avg RSSI=%d, BbpRssiToDbmDñè =%d\n", 
pAd
->
P‹tCfg
.
AvgRssi
,ÖAd->
BbpRssiToDbmDñè
);

5257 
	`DBGPRINT
(
RT_DEBUG_TRACE
, " 2 strong RSSI=%d, CCA=%d, fixed R17át 0x%x\n",

5258 
dbm
, 
pAd
->
RÆökCou¡îs
.
O√SecFÆ£CCAC¡
, 
R17
);

5262 i‡(
dbm
 >
RSSI_FOR_LOW_SENSIBILITY
)

5264 i‡(
R17
 !
R17UµîBound
)

5266 
R17
 = 
R17UµîBound
;

5267 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17, 
R17
);

5274 i‡(
dbm
 >
RSSI_FOR_MID_LOW_SENSIBILITY
)

5276 i‡(
R17
 !(
R17LowîBound
 + 0x10))

5278 
R17
 = 
R17LowîBound
 + 0x10;

5279 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17, 
R17
);

5281 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "mid RSSI=%d, CCA=%d, fixed R17át 0x%x\n",

5282 
dbm
, 
pAd
->
RÆökCou¡îs
.
O√SecFÆ£CCAC¡
, 
R17
);

5287 i‡(
dbm
 >
RSSI_FOR_MID_SENSIBILITY
)

5289 i‡(
R17
 !(
R17LowîBound
 + 0x10))

5291 
R17
 = 
R17LowîBound
 + 0x08;

5292 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17, 
R17
);

5294 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "mid RSSI=%d, CCA=%d, fixed R17át 0x%x\n",

5295 
dbm
, 
pAd
->
RÆökCou¡îs
.
O√SecFÆ£CCAC¡
, 
R17
);

5304 
R17UµîBound
 -2*(
RSSI_FOR_MID_SENSIBILITY
 - 
dbm
);

5305 i‡(
R17UµîBound
 < 
R17LowîBound
)

5306 
R17UµîBound
 = 
R17LowîBound
;

5308 i‡(
R17
 > 
R17UµîBound
)

5310 
R17
 = 
R17UµîBound
;

5311 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17, 
R17
);

5312 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RSSI=%d, CCA=%d, R17=R17UµîBound=0x%x\n", 
dbm
, 
pAd
->
RÆökCou¡îs
.
O√SecFÆ£CCAC¡
, 
R17
);

5324 i‡((
pAd
->
RÆökCou¡îs
.
O√SecFÆ£CCAC¡
 >ÖAd->
BbpTunög
.
FÆ£CˇUµîThªshﬁd
) &&

5325 (
R17
 < 
R17UµîBound
))

5327 
R17
 +
pAd
->
BbpTunög
.
R17Dñè
;

5329 i‡(
R17
 >
R17UµîBound
)

5330 
R17
 = 
R17UµîBound
;

5332 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17, 
R17
);

5333 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RSSI=%d, CCA=%d, ++R170x%x\n", 
dbm
, 
pAd
->
RÆökCou¡îs
.
O√SecFÆ£CCAC¡
, 
R17
);

5335 i‡((
pAd
->
RÆökCou¡îs
.
O√SecFÆ£CCAC¡
 <ÖAd->
BbpTunög
.
FÆ£CˇLowîThªshﬁd
) &&

5336 (
R17
 > 
R17LowîBound
))

5338 
R17
 -
pAd
->
BbpTunög
.
R17Dñè
;

5340 i‡(
R17
 <
R17LowîBound
)

5341 
R17
 = 
R17LowîBound
;

5343 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17, 
R17
);

5344 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RSSI=%d, CCA=%d, --R170x%x\n", 
dbm
, 
pAd
->
RÆökCou¡îs
.
O√SecFÆ£CCAC¡
, 
R17
);

5348 
	`DBGPRINT
(
RT_DEBUG_INFO
, "RSSI=%d, CCA=%d, kì∞R17áà0x%x\n", 
dbm
, 
pAd
->
RÆökCou¡îs
.
O√SecFÆ£CCAC¡
, 
R17
);

5351 
	}
}

5353 
VOID
 
	$AsicAddSh¨edKeyE¡ry
(

5354 
IN
 
PRTMP_ADAPTER
 
pAd
,

5355 
IN
 
UCHAR
 
BssIndex
,

5356 
IN
 
UCHAR
 
KeyIdx
,

5357 
IN
 
UCHAR
 
CùhîAlg
,

5358 
IN
 
PUCHAR
 
pKey
,

5359 
IN
 
PUCHAR
 
pTxMic
,

5360 
IN
 
PUCHAR
 
pRxMic
)

5362 
INT
 
i
;

5363 
ULONG
 
off£t
, 
c§0
;

5364 
SEC_CSR1_STRUC
 
c§1
;

5366 
	uØa
 {

5367 
ULONG
 
ãmp_ul
;

5368 
	sbbb
{

5369 #ifde‡
BIG_ENDIAN


5370 
UCHAR
 
ch4
;

5371 
UCHAR
 
ch3
;

5372 
UCHAR
 
ch2
;

5373 
UCHAR
 
ch1
;

5375 
UCHAR
 
ch1
;

5376 
UCHAR
 
ch2
;

5377 
UCHAR
 
ch3
;

5378 
UCHAR
 
ch4
;

5380 } 
ãmp_uc
;

5381 } 
ddd
;

5383 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AsicAddSh¨edKeyE¡ry: %†key #%d\n", 
CùhîName
[
CùhîAlg
], 
BssIndex
*4 + 
KeyIdx
);

5384 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, " Key =");

5385 
i
 = 0; i < 16; i++)

5387 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "%02x:", 
pKey
[
i
]);

5389 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "\n");

5390 i‡(
pRxMic
)

5392 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, " Rx MIC Key = ");

5393 
i
 = 0; i < 8; i++)

5395 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "%02x:", 
pRxMic
[
i
]);

5397 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "\n");

5399 i‡(
pTxMic
)

5401 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, " Tx MIC Key = ");

5402 
i
 = 0; i < 8; i++)

5404 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "%02x:", 
pTxMic
[
i
]);

5406 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "\n");

5412 
	`RTUSBRódMACRegi°î
(
pAd
, 
SEC_CSR0
, &
c§0
);

5413 
c§0
 = c§0 & ~
BIT32
[
BssIndex
*4 + 
KeyIdx
];

5414 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
SEC_CSR0
, 
c§0
);

5420 
off£t
 = 
SHARED_KEY_TABLE_BASE
 + (4*
BssIndex
 + 
KeyIdx
)*
HW_KEY_ENTRY_SIZE
;

5422 
i
=0; i<
MAX_LEN_OF_SHARE_KEY
; i = i+4)

5424 
ddd
.
ãmp_uc
.
ch1
 = 
pKey
[
i
];

5425 
ddd
.
ãmp_uc
.
ch2
 = 
pKey
[
i
+1];

5426 
ddd
.
ãmp_uc
.
ch3
 = 
pKey
[
i
+2];

5427 
ddd
.
ãmp_uc
.
ch4
 = 
pKey
[
i
+3];

5429 
	`RTUSBWrôeMACRegi°î
(
pAd
, (
USHORT
Ë(
off£t
 + 
i
), 
ddd
.
ãmp_ul
);

5432 
off£t
 +
MAX_LEN_OF_SHARE_KEY
;

5433 i‡(
pTxMic
)

5435 
i
=0; i<8; i=i+4)

5437 
ddd
.
ãmp_uc
.
ch1
 = 
pTxMic
[
i
];

5438 
ddd
.
ãmp_uc
.
ch2
 = 
pTxMic
[
i
+1];

5439 
ddd
.
ãmp_uc
.
ch3
 = 
pTxMic
[
i
+2];

5440 
ddd
.
ãmp_uc
.
ch4
 = 
pTxMic
[
i
+3];

5441 
	`RTUSBWrôeMACRegi°î
(
pAd
, (
USHORT
Ë(
off£t
 + 
i
), 
ddd
.
ãmp_ul
);

5445 
off£t
 += 8;

5446 i‡(
pRxMic
)

5448 
i
=0; i<8; i = i+4)

5450 
ddd
.
ãmp_uc
.
ch1
 = 
pRxMic
[
i
];

5451 
ddd
.
ãmp_uc
.
ch2
 = 
pRxMic
[
i
+1];

5452 
ddd
.
ãmp_uc
.
ch3
 = 
pRxMic
[
i
+2];

5453 
ddd
.
ãmp_uc
.
ch4
 = 
pRxMic
[
i
+3];

5455 
	`RTUSBWrôeMACRegi°î
(
pAd
, (
USHORT
Ë(
off£t
 + 
i
), 
ddd
.
ãmp_ul
);

5462 
	`RTUSBRódMACRegi°î
(
pAd
, 
SEC_CSR1
, &
c§1
.
w‹d
);

5463 i‡(
KeyIdx
 == 0)

5464 
c§1
.
fõld
.
Bss0Key0CùhîAlg
 = 
CùhîAlg
;

5465 i‡(
KeyIdx
 == 1)

5466 
c§1
.
fõld
.
Bss0Key1CùhîAlg
 = 
CùhîAlg
;

5467 i‡(
KeyIdx
 == 2)

5468 
c§1
.
fõld
.
Bss0Key2CùhîAlg
 = 
CùhîAlg
;

5470 
c§1
.
fõld
.
Bss0Key3CùhîAlg
 = 
CùhîAlg
;

5471 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
SEC_CSR1
, 
c§1
.
w‹d
);

5476 
	`RTUSBRódMACRegi°î
(
pAd
, 
SEC_CSR0
, &
c§0
);

5477 
c§0
 |
BIT32
[
BssIndex
*4 + 
KeyIdx
];

5478 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
SEC_CSR0
, 
c§0
);

5479 
	}
}

5481 
VOID
 
	$AsicRemoveSh¨edKeyE¡ry
(

5482 
IN
 
PRTMP_ADAPTER
 
pAd
,

5483 
IN
 
UCHAR
 
BssIndex
,

5484 
IN
 
UCHAR
 
KeyIdx
)

5486 
ULONG
 
SecC§0
;

5488 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"AsicRemoveSh¨edKeyE¡ry: #%d \n", 
BssIndex
*4 + 
KeyIdx
);

5490 
	`ASSERT
(
BssIndex
 < 4);

5491 
	`ASSERT
(
KeyIdx
 < 
SHARE_KEY_NUM
);

5493 
	`RTUSBRódMACRegi°î
(
pAd
, 
SEC_CSR0
, &
SecC§0
);

5494 
SecC§0
 &(~
BIT32
[
BssIndex
*4 + 
KeyIdx
]);

5495 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
SEC_CSR0
, 
SecC§0
);

5496 
	}
}

5498 
VOID
 
	$AsicAddPaúwi£KeyE¡ry
(

5499 
IN
 
PRTMP_ADAPTER
 
pAd
,

5500 
IN
 
PUCHAR
 
pAddr
,

5501 
IN
 
UCHAR
 
KeyIdx
,

5502 
IN
 
UCHAR
 
CùhîAlg
,

5503 
IN
 
PUCHAR
 
pKey
,

5504 
IN
 
PUCHAR
 
pTxMic
,

5505 
IN
 
PUCHAR
 
pRxMic
)

5507 
ULONG
 
off£t
, 
c§2
, 
c§3
;

5508 
i
;

5509 
ULONG
 
key
, 
addr
;

5511 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"AsicAddPairwiseKeyEntry: Entry#%d Alg=%s mac=%02x:%02x:%02x:%02x:%02x:%02x\n",

5512 
KeyIdx
, 
CùhîName
[
CùhîAlg
], 
pAddr
[0],ÖAddr[1],ÖAddr[2],ÖAddr[3],ÖAddr[4],ÖAddr[5]);

5514 
off£t
 = 
PAIRWISE_KEY_TABLE_BASE
 + (
KeyIdx
 * 
HW_KEY_ENTRY_SIZE
);

5522 
i
=0; i<
MAX_LEN_OF_PEER_KEY
; i = i+4)

5524 
key
 = (
ULONG
)(
pKey
[
i
]) |

5525 (
ULONG
)(
pKey
[
i
+1] << 8) |

5526 (
ULONG
)(
pKey
[
i
+2] << 16) |

5527 (
ULONG
)(
pKey
[
i
+3] << 24);

5529 
	`RTUSBWrôeMACRegi°î
(
pAd
, (
USHORT
)(
off£t
 + 
i
), 
key
);

5531 
off£t
 +
MAX_LEN_OF_PEER_KEY
;

5534 i‡(
pTxMic
)

5536 
i
=0; i<8; i = i+4)

5538 
key
 = (
ULONG
)(
pTxMic
[
i
]) |

5539 (
ULONG
)(
pTxMic
[
i
+1] << 8) |

5540 (
ULONG
)(
pTxMic
[
i
+2] << 16) |

5541 (
ULONG
)(
pTxMic
[
i
+3] << 24);

5543 
	`RTUSBWrôeMACRegi°î
(
pAd
, (
USHORT
)(
off£t
 + 
i
), 
key
);

5545 
off£t
 += 8;

5549 i‡(
pRxMic
)

5551 
i
=0; i<8; i = i+4)

5553 
key
 = (
ULONG
)(
pRxMic
[
i
]) |

5554 (
ULONG
)(
pRxMic
[
i
+1] << 8) |

5555 (
ULONG
)(
pRxMic
[
i
+2] << 16) |

5556 (
ULONG
)(
pRxMic
[
i
+3] << 24);

5558 
	`RTUSBWrôeMACRegi°î
(
pAd
, (
USHORT
)(
off£t
 + 
i
), 
key
);

5562 
off£t
 = 
PAIRWISE_TA_TABLE_BASE
 + (
KeyIdx
 * 
HW_PAIRWISE_TA_ENTRY_SIZE
);

5564 
addr
 = (
ULONG
)(
pAddr
[0]) |

5565 (
ULONG
)(
pAddr
[1] << 8) |

5566 (
ULONG
)(
pAddr
[2] << 16) |

5567 (
ULONG
)(
pAddr
[3] << 24);

5568 
	`RTUSBWrôeMACRegi°î
(
pAd
, (
USHORT
)(
off£t
), 
addr
);

5570 
addr
 = (
ULONG
)(
pAddr
[4]Ë| (ULONG)’Addr[5] << 8Ë| (ULONG)(
CùhîAlg
 << 16);

5571 
	`RTUSBWrôeMACRegi°î
(
pAd
, (
USHORT
)(
off£t
 + 4), 
addr
);

5575 
ULONG
 
VÆue1
;

5576 
USHORT
 
tmp_off£t
;

5578 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"PAIRWISE_KEY_TABLE_BASE==> \n");

5579 
tmp_off£t
 = 
PAIRWISE_KEY_TABLE_BASE
 + (
KeyIdx
 * 
HW_KEY_ENTRY_SIZE
);

5580 
i
=0; i<
HW_KEY_ENTRY_SIZE
; i=i+4)

5582 
	`RTUSBRódMACRegi°î
(
pAd
, 
tmp_off£t
 + 
i
, &
VÆue1
);

5583 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MAC:Off£t[0x%04x]=[0x%04x]\n", 
tmp_off£t
 + 
i
, 
VÆue1
);

5586 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"PAIRWISE_TA_TABLE_BASE==> \n");

5587 
tmp_off£t
 = 
PAIRWISE_TA_TABLE_BASE
 + (
KeyIdx
 * 
HW_PAIRWISE_TA_ENTRY_SIZE
);

5588 
i
=0; i<
HW_PAIRWISE_TA_ENTRY_SIZE
; i = i+4)

5590 
	`RTUSBRódMACRegi°î
(
pAd
, 
tmp_off£t
 + 
i
, &
VÆue1
);

5591 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MAC:Off£t[0x%04x]=[0x%04x]\n", 
tmp_off£t
 + 
i
, 
VÆue1
);

5597 i‡(
KeyIdx
 < 32)

5599 
	`RTUSBRódMACRegi°î
(
pAd
, 
SEC_CSR2
, &
c§2
);

5600 
c§2
 |
BIT32
[
KeyIdx
];

5601 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
SEC_CSR2
, 
c§2
);

5605 
	`RTUSBRódMACRegi°î
(
pAd
, 
SEC_CSR3
, &
c§3
);

5606 
c§3
 |
BIT32
[
KeyIdx
-32];

5607 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
SEC_CSR3
, 
c§3
);

5609 
	}
}

5611 
VOID
 
	$AsicRemovePaúwi£KeyE¡ry
(

5612 
IN
 
PRTMP_ADAPTER
 
pAd
,

5613 
IN
 
UCHAR
 
KeyIdx
)

5615 
ULONG
 
c§2
, 
c§3
;

5617 
	`DBGPRINT
(
RT_DEBUG_INFO
,"AsicRemovePaúwi£KeyE¡ry: #%d \n", 
KeyIdx
);

5620 i‡(
KeyIdx
 < 32)

5622 
	`RTUSBRódMACRegi°î
(
pAd
, 
SEC_CSR2
, &
c§2
);

5623 
c§2
 &(~
BIT32
[
KeyIdx
]);

5624 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
SEC_CSR2
, 
c§2
);

5628 
	`RTUSBRódMACRegi°î
(
pAd
, 
SEC_CSR3
, &
c§3
);

5629 
c§3
 &(~
BIT32
[
KeyIdx
-32]);

5630 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
SEC_CSR3
, 
c§3
);

5632 
	}
}

5648 
VOID
 
	$RTMPCheckR©es
(

5649 
IN
 
PRTMP_ADAPTER
 
pAd
,

5650 
IN
 
OUT
 
UCHAR
 
SupR©e
[],

5651 
IN
 
OUT
 
UCHAR
 *
SupR©eLí
)

5653 
UCHAR
 
R©eIdx
, 
i
, 
j
;

5654 
UCHAR
 
NewR©e
[12], 
NewR©eLí
;

5656 
NewR©eLí
 = 0;

5658 i‡(
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11B
)

5659 
R©eIdx
 = 4;

5665 
R©eIdx
 = 12;

5668 
i
 = 0; i < *
SupR©eLí
; i++)

5669 
j
 = 0; j < 
R©eIdx
; j++)

5670 i‡((
SupR©e
[
i
] & 0x7fË=
R©eIdTo500Kbps
[
j
])

5671 
NewR©e
[
NewR©eLí
++] = 
SupR©e
[
i
];

5673 *
SupR©eLí
 = 
NewR©eLí
;

5674 
	`NdisMoveMem‹y
(
SupR©e
, 
NewR©e
, 
NewR©eLí
);

5675 
	}
}

5693 
VOID
 
	$AsicSëRxA¡
(

5694 
IN
 
PRTMP_ADAPTER
 
pAd
,

5695 
IN
 
UCHAR
 
Paú1
,

5696 
IN
 
UCHAR
 
Paú2
)

5698 
	`DBGPRINT
(
RT_DEBUG_INFO
, "AsicSëRxA¡,Öaú1=%d,Öaú2=%d\n", 
Paú1
, 
Paú2
);

5700 i‡((
pAd
->
RfIcTy≥
 =
RFIC_2528
Ë|| (pAd->RfIcTy≥ =
RFIC_3020
))

5702 
UCHAR
 
R77
;

5705 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R77
, &
R77
);

5707 
R77
 &= ~0x03;

5708 i‡(
Paú1
 == 0)

5710 
R77
 = R77 | 0x03;

5718 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0257b032);

5719 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

5721 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x025eb032);

5723 i‡(
pAd
->
RfIcTy≥
 =
RFIC_5226
)

5725 
UCHAR
 
R77
;

5728 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R77
, &
R77
);

5730 
R77
 &= ~0x03;

5733 i‡(
pAd
->
P‹tCfg
.
B™dSèã
 =
BG_BAND
)

5736 i‡(
Paú1
 == 0)

5738 
R77
 = R77 | 0x03;

5748 i‡(
Paú1
 == 0)

5754 
R77
 = R77 | 0x03;

5759 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0257b032);

5760 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

5763 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x025eb032);

5765 i‡(
pAd
->
RfIcTy≥
 =
RFIC_5225
)

5767 
UCHAR
 
R77
;

5770 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R77
, &
R77
);

5772 
R77
 &= ~0x03;

5775 i‡(
pAd
->
P‹tCfg
.
B™dSèã
 =
BG_BAND
)

5778 i‡(
Paú1
 == 0)

5780 
R77
 = R77 | 0x03;

5790 i‡(
Paú1
 == 0)

5796 
R77
 = R77 | 0x03;

5801 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0257b032);

5802 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

5805 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x025eb032);

5808 i‡(
pAd
->
RfIcTy≥
 =
RFIC_2527
)

5810 
UCHAR
 
R77
;

5813 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R77
, &
R77
);

5815 
R77
 &= ~0x03;

5816 i‡(
Paú1
 == 0)

5818 
R77
 = R77 | 0x03;

5826 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0257b032);

5827 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R77
, 
R77
);

5830 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x025eb032);

5833 
	}
}

5839 
VOID
 
	$AsicEvÆu©eSec⁄d¨yRxA¡
(

5840 
IN
 
PRTMP_ADAPTER
 
pAd
)

5842 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"AntDiv - beforeÉvaluate Pair1-Ant (%d,%d), Pair2-Ant (%d,%d)\n",

5843 
pAd
->
RxA¡
.
Paú1Prim¨yRxA¡
,ÖAd->RxA¡.
Paú1Sec⁄d¨yRxA¡
,pAd->RxA¡.
Paú2Prim¨yRxA¡
,ÖAd->RxA¡.
Paú2Sec⁄d¨yRxA¡
);

5845 
	`AsicSëRxA¡
(
pAd
,ÖAd->
RxA¡
.
Paú1Sec⁄d¨yRxA¡
, 0xFF);

5847 
pAd
->
RxA¡
.
EvÆu©ePîiod
 = 1;

5848 
pAd
->
RxA¡
.
Fú°PktAºivedWhíEvÆu©e
 = 
FALSE
;

5849 
pAd
->
RxA¡
.
RcvPktNumWhíEvÆu©e
 = 0;

5852 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

5853 
	`RTMPSëTimî
(&
pAd
->
RxA¡
.
RxA¡DivîsôyTimî
, 100);

5855 
	`RTMPSëTimî
(&
pAd
->
RxA¡
.
RxA¡DivîsôyTimî
, 300);

5857 
	}
}

5860 
VOID
 
	$AsicRxA¡EvÆTimeout
(

5861 
IN
 
PVOID
 
Sy°emS≥cific1
,

5862 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

5863 
IN
 
PVOID
 
Sy°emS≥cific2
,

5864 
IN
 
PVOID
 
Sy°emS≥cific3
)

5866 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
Fun˘i⁄C⁄ãxt
;

5868 
	`RTUSBEnqueueI¡î«lCmd
(
pAd
, 
RT_PERFORM_SOFT_DIVERSITY
);

5869 
	}
}

5871 
VOID
 
	$AsicRxA¡EvÆA˘i⁄
(

5872 
IN
 
PRTMP_ADAPTER
 
pAd
)

5874 
UCHAR
 
ãmp
;

5876 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"After Eval,RSSI[0,1,2,3]=<%d,%d,%d,%d>,RcvPktNumWhenEvaluate=%d\n",

5877 (
pAd
->
RxA¡
.
Paú1AvgRssi
[0] >> 3), (pAd->RxAnt.Pair1AvgRssi[1] >> 3),

5878 (
pAd
->
RxA¡
.
Paú2AvgRssi
[0] >> 3), (pAd->RxA¡.Paú2AvgRssi[1] >> 3),ÖAd->RxA¡.
RcvPktNumWhíEvÆu©e
);

5882 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
))

5885 i‡((
pAd
->
RxA¡
.
RcvPktNumWhíEvÆu©e
 !0Ë&& (pAd->RxA¡.
Paú1AvgRssi
[pAd->RxA¡.
Paú1Sec⁄d¨yRxA¡
] >pAd->RxA¡.Paú1AvgRssi[pAd->RxA¡.
Paú1Prim¨yRxA¡
]))

5892 
ãmp
 = 
pAd
->
RxA¡
.
Paú1Prim¨yRxA¡
;

5893 
pAd
->
RxA¡
.
Paú1Prim¨yRxA¡
 =ÖAd->RxA¡.
Paú1Sec⁄d¨yRxA¡
;

5894 
pAd
->
RxA¡
.
Paú1Sec⁄d¨yRxA¡
 = 
ãmp
;

5896 
pAd
->
RxA¡
.
Paú1La°AvgRssi
 = (pAd->RxA¡.
Paú1AvgRssi
[pAd->RxA¡.
Paú1Sec⁄d¨yRxA¡
] >> 3);

5900 
	`AsicSëRxA¡
(
pAd
,ÖAd->
RxA¡
.
Paú1Prim¨yRxA¡
, 0xFF);

5903 
pAd
->
RxA¡
.
EvÆu©ePîiod
 = 0;

5905 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"A·î EvÆ-Paú1 #%d,Paú2 #%d\n",
pAd
->
RxA¡
.
Paú1Prim¨yRxA¡
,pAd->RxA¡.
Paú2Prim¨yRxA¡
);

5906 
	}
}

5916 
VOID
 
	$SèQuickRe•⁄eF‹R©eUpExec
(

5917 
IN
 
PVOID
 
Sy°emS≥cific1
,

5918 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

5919 
IN
 
PVOID
 
Sy°emS≥cific2
,

5920 
IN
 
PVOID
 
Sy°emS≥cific3
)

5922 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTER)
Fun˘i⁄C⁄ãxt
;

5923 
UCHAR
 
UpR©e
, 
DownR©e
, 
CuºR©e
;

5924 
ULONG
 
TxTŸÆC¡
, 
TxEº‹R©io
 = 0;

5931 i‡(!
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

5934 
TxTŸÆC¡
 = 
pAd
->
RÆökCou¡îs
.
O√SecTxNoRëryOkCou¡
 +

5935 
pAd
->
RÆökCou¡îs
.
O√SecTxRëryOkCou¡
 +

5936 
pAd
->
RÆökCou¡îs
.
O√SecTxFaûCou¡
;

5939 i‡(
TxTŸÆC¡
 == 0)

5945 
CuºR©e
 = 
pAd
->
P‹tCfg
.
TxR©e
;

5946 i‡((
pAd
->
P‹tCfg
.
Ch™√l
 > 14) ||

5947 (
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11G
))

5949 i‡(
Phy11ANextR©eUpw¨d
[
CuºR©e
] <
pAd
->
P‹tCfg
.
MaxTxR©e
)

5950 
UpR©e
 = 
Phy11ANextR©eUpw¨d
[
CuºR©e
];

5952 
UpR©e
 = 
CuºR©e
;

5953 
DownR©e
 = 
Phy11ANextR©eDownw¨d
[
CuºR©e
];

5957 i‡(
pAd
->
P‹tCfg
.
MaxTxR©e
 < 
RATE_FIRST_OFDM_RATE
)

5959 i‡(
Phy11BNextR©eUpw¨d
[
CuºR©e
] <
pAd
->
P‹tCfg
.
MaxTxR©e
)

5960 
UpR©e
 = 
Phy11BNextR©eUpw¨d
[
CuºR©e
];

5962 
UpR©e
 = 
CuºR©e
;

5963 
DownR©e
 = 
Phy11BNextR©eDownw¨d
[
CuºR©e
];

5967 i‡(
Phy11BGNextR©eUpw¨d
[
CuºR©e
] <
pAd
->
P‹tCfg
.
MaxTxR©e
)

5968 
UpR©e
 = 
Phy11BGNextR©eUpw¨d
[
CuºR©e
];

5970 
UpR©e
 = 
CuºR©e
;

5971 
DownR©e
 = 
Phy11BGNextR©eDownw¨d
[
CuºR©e
];

5979 i‡(
TxTŸÆC¡
 > 15)

5981 
TxEº‹R©io
 = ((
pAd
->
RÆökCou¡îs
.
O√SecTxRëryOkCou¡
 +ÖAd->RÆökCou¡îs.
O√SecTxFaûCou¡
Ë* 100Ë/ 
TxTŸÆC¡
;

5983 i‡(
TxEº‹R©io
 >
R©eDownPER
[
CuºR©e
])

5985 
pAd
->
DrsCou¡îs
.
TxQuÆôy
[
CuºR©e
] = 
DRS_TX_QUALITY_WORST_BOUND
;

5989 
pAd
->
DrsCou¡îs
.
PER
[
CuºR©e
] = (
UCHAR
)
TxEº‹R©io
;

5995 i‡((
pAd
->
DrsCou¡îs
.
TxQuÆôy
[
CuºR©e
] >
DRS_TX_QUALITY_WORST_BOUND
Ë&& (CuºR©ê!
DownR©e
))

5997 
pAd
->
P‹tCfg
.
TxR©e
 = 
DownR©e
;

6003 i‡(
pAd
->
P‹tCfg
.
TxR©e
 < 
CuºR©e
)

6005 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"SèQuickRe•⁄eF‹R©eUpExec: Bef‹êTXÑ©ê%d Mbps, Now TxÑ©ê%d Mbps\n", 
R©eIdToMbps
[
CuºR©e
], R©eIdToMbps[
pAd
->
P‹tCfg
.
TxR©e
]);

6013 
pAd
->
DrsCou¡îs
.
TxR©eUpPíÆty
 = 0;

6015 
pAd
->
DrsCou¡îs
.
CuºTxR©eSèbÀTime
 = 0;

6016 
pAd
->
DrsCou¡îs
.
La°SecTxR©eCh™geA˘i⁄
 = 2;

6017 
pAd
->
DrsCou¡îs
.
TxQuÆôy
[pAd->
P‹tCfg
.
TxR©e
] = 0;

6018 
pAd
->
DrsCou¡îs
.
PER
[pAd->
P‹tCfg
.
TxR©e
] = 0;

6021 
pAd
->
DrsCou¡îs
.
La°SecTxR©eCh™geA˘i⁄
 = 0;

6024 
pAd
->
RÆökCou¡îs
.
O√SecTxFaûCou¡
 = 0;

6025 
pAd
->
RÆökCou¡îs
.
O√SecTxNoRëryOkCou¡
 = 0;

6026 
pAd
->
RÆökCou¡îs
.
O√SecTxRëryOkCou¡
 = 0;

6027 } 
FALSE
);

6028 
pAd
->
P‹tCfg
.
QuickRe•⁄eF‹R©eUpTimîRu¬ög
 = 
FALSE
;

6029 
	}
}

6051 
NDIS_STATUS
 
	$MlmeAŒoˇãMem‹y
(

6052 
IN
 
PRTMP_ADAPTER
 
pAd
,

6053 
OUT
 
PVOID
 *
AŒocVa
)

6055 
PMLME_MEMORY_STRUCT
 
pMlmeMem‹ySåu˘
 = 
NULL
;

6057 
	`DBGPRINT
(
RT_DEBUG_INFO
,"==> MlmeAllocateMemory\n");

6060 i‡(
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Hód
 =
NULL
)

6062 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"MlmeAllocateMemory, failed!! (ThereáreÇoávailable memory inÜist)\n");

6063 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"<== MlmeAllocateMemory\n");

6064  (
NDIS_STATUS_RESOURCES
);

6066 
pMlmeMem‹ySåu˘
 = 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Hód
;

6068 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Hód
 =ÖAd->Mlme.MemH™dÀr.pUnU£Hód->
Next
;

6069 i‡(
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Hód
 =
NULL
)

6070 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Taû
 = 
NULL
;

6071 
pAd
->
Mlme
.
MemH™dÀr
.
UnU£Cou¡
--;

6073 *
AŒocVa
 = 
pMlmeMem‹ySåu˘
->AllocVa;

6075 
pMlmeMem‹ySåu˘
->
Next
 = 
NULL
;

6077 i‡(
pAd
->
Mlme
.
MemH™dÀr
.
pInU£Hód
 =
NULL
)

6079 
pAd
->
Mlme
.
MemH™dÀr
.
pInU£Hód
 = 
pMlmeMem‹ySåu˘
;

6080 
pAd
->
Mlme
.
MemH™dÀr
.
pInU£Taû
 = 
pMlmeMem‹ySåu˘
;

6084 
pAd
->
Mlme
.
MemH™dÀr
.
pInU£Taû
->
Next
 = 
pMlmeMem‹ySåu˘
;

6085 
pAd
->
Mlme
.
MemH™dÀr
.
pInU£Taû
 =ÖAd->Mlme.MemH™dÀr.pInU£Taû->
Next
;

6087 
pAd
->
Mlme
.
MemH™dÀr
.
InU£Cou¡
++;

6091 
	`DBGPRINT
(
RT_DEBUG_INFO
, "MlmeAŒoˇãMem‹y [pMlmeMem‹ySåu˘=0x%x][VA=0x%x]\n", (
UINT
)
pMlmeMem‹ySåu˘
, (UINTÌMlmeMem‹ySåu˘->
AŒocVa
);

6092 
	`DBGPRINT
(
RT_DEBUG_INFO
, "<== MlmeAllocateMemory[IN:%d][UN:%d]\n",

6093 
pAd
->
Mlme
.
MemH™dÀr
.
InU£Cou¡
,ÖAd->Mlme.MemH™dÀr.
UnU£Cou¡
);

6094  (
NDIS_STATUS_SUCCESS
);

6095 
	}
}

6115 
VOID
 
	$MlmeFªeMem‹y
(

6116 
IN
 
PRTMP_ADAPTER
 
pAd
,

6117 
IN
 
PVOID
 
AŒocVa
)

6119 
PMLME_MEMORY_STRUCT
 
pPªvious
;

6120 
PMLME_MEMORY_STRUCT
 
pMlmeMem‹ySåu˘
;

6121 
BOOLEAN
 
bIsFound
;

6123 i‡(
AŒocVa
 =
NULL
)

6126 
bIsFound
 = 
FALSE
;

6127 
pPªvious
 = 
NULL
;

6128 
pMlmeMem‹ySåu˘
 = 
pAd
->
Mlme
.
MemH™dÀr
.
pInU£Hód
;

6129 
pMlmeMem‹ySåu˘
)

6132 i‡(
pMlmeMem‹ySåu˘
->
AŒocVa
 == AllocVa)

6136 i‡(
pPªvious
 =
NULL
)

6137 
pAd
->
Mlme
.
MemH™dÀr
.
pInU£Hód
 = 
pMlmeMem‹ySåu˘
->
Next
;

6139 
pPªvious
->
Next
 = 
pMlmeMem‹ySåu˘
->Next;

6140 
pAd
->
Mlme
.
MemH™dÀr
.
InU£Cou¡
--;

6143 
pMlmeMem‹ySåu˘
->
Next
 = 
NULL
;

6144 i‡((
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Hód
 =
NULL
))

6146 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Hód
 = 
pMlmeMem‹ySåu˘
;

6147 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Taû
 = 
pMlmeMem‹ySåu˘
;

6152 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Taû
->
Next
 = 
pMlmeMem‹ySåu˘
;

6153 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Taû
 =ÖAd->Mlme.MemH™dÀr.pUnU£Taû->
Next
;

6155 
pAd
->
Mlme
.
MemH™dÀr
.
UnU£Cou¡
++;

6157 
bIsFound
 = 
TRUE
;

6162 
pPªvious
 = 
pMlmeMem‹ySåu˘
;

6163 
pMlmeMem‹ySåu˘
 =ÖMlmeMem‹ySåu˘->
Next
;

6166 
	}
}

6187 
NDIS_STATUS
 
	$MlmeInôMem‹yH™dÀr
(

6188 
IN
 
PRTMP_ADAPTER
 
pAd
,

6189 
IN
 
UINT
 
Numbî
,

6190 
IN
 
UINT
 
Size
)

6192 
PMLME_MEMORY_STRUCT
 
Cuºít
 = 
NULL
;

6193 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

6194 
UINT
 
i
;

6196 
	`DBGPRINT
(
RT_DEBUG_INFO
,"==> MlmeInitMemory\n");

6197 
pAd
->
Mlme
.
MemH™dÀr
.
Mem‹yCou¡
 = 0;

6198 
pAd
->
Mlme
.
MemH™dÀr
.
pInU£Hód
 = 
NULL
;

6199 
pAd
->
Mlme
.
MemH™dÀr
.
pInU£Taû
 = 
NULL
;

6200 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Hód
 = 
NULL
;

6201 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Taû
 = 
NULL
;

6202 
pAd
->
Mlme
.
MemH™dÀr
.
MemRu¬ög
 = 
FALSE
;

6205 
i
 = 0; i < 
MAX_MLME_HANDLER_MEMORY
; i++)

6206 
pAd
->
Mlme
.
MemH™dÀr
.
MemFªePídög
[
i
] = 
NULL
;

6211 i‡(
Numbî
 > 
MAX_MLME_HANDLER_MEMORY
)

6212 
Numbî
 = 
MAX_MLME_HANDLER_MEMORY
;

6214 
i
 = 0; i < 
Numbî
; i++)

6217 
Cuºít
(
PMLME_MEMORY_STRUCT
Ë
	`kmÆloc
((
MLME_MEMORY_STRUCT
), 
MEM_ALLOC_FLAG
);

6218 i‡(!
Cuºít
)

6220 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "NotÉnough memory\n");

6221 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

6226 
Cuºít
->
AŒocVa
(
VOID
 *Ë
	`kmÆloc
(
Size
, 
MEM_ALLOC_FLAG
);

6227 i‡(!
Cuºít
->
AŒocVa
)

6229 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "NotÉnough memory\n");

6230 
	`k‰ì
((
VOID
 *)
Cuºít
);

6231 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

6235 
	`NdisZîoMem‹y
(
Cuºít
->
AŒocVa
, 
Size
);

6237 
pAd
->
Mlme
.
MemH™dÀr
.
Mem‹yCou¡
++;

6240 i‡(
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Hód
 !
NULL
)

6242 
Cuºít
->
Next
 = 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Hód
;

6243 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Hód
 = 
Cuºít
;

6247 
Cuºít
->
Next
 = 
NULL
;

6248 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Hód
 = 
Cuºít
;

6251 i‡(
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Taû
 =
NULL
)

6252 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Taû
 = 
Cuºít
;

6256 i‡(
pAd
->
Mlme
.
MemH™dÀr
.
Mem‹yCou¡
 < 
Numbî
)

6258 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

6259 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MlmeInôMem‹y Inôü»Áûed [Requúe=%d,ávaûabÀ=%d]\n", 
Numbî
, 
pAd
->
Mlme
.
MemH™dÀr
.
Mem‹yCou¡
);

6262 
pAd
->
Mlme
.
MemH™dÀr
.
InU£Cou¡
 = 0;

6263 
pAd
->
Mlme
.
MemH™dÀr
.
UnU£Cou¡
 = 
Numbî
;

6264 
pAd
->
Mlme
.
MemH™dÀr
.
PídögCou¡
 = 0;

6265 
	`DBGPRINT
(
RT_DEBUG_INFO
, "<== MlmeInitMemory\n");

6267  (
Sètus
);

6268 
	}
}

6283 
VOID
 
	$MlmeFªeMem‹yH™dÀr
(

6284 
IN
 
PRTMP_ADAPTER
 
pAd
)

6286 
PMLME_MEMORY_STRUCT
 
pMlmeMem‹ySåu˘
 = 
NULL
;

6288 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->MlmeFreeMemoryHandler\n");

6291 
pAd
->
Mlme
.
MemH™dÀr
.
pInU£Hód
 !
NULL
)

6293 
pMlmeMem‹ySåu˘
 = 
pAd
->
Mlme
.
MemH™dÀr
.
pInU£Hód
;

6294 
pAd
->
Mlme
.
MemH™dÀr
.
pInU£Hód
 =ÖAd->Mlme.MemH™dÀr.pInU£Hód->
Next
;

6296 
	`k‰ì
(
pMlmeMem‹ySåu˘
->
AŒocVa
);

6298 
	`k‰ì
(
pMlmeMem‹ySåu˘
);

6302 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Hód
 !
NULL
)

6304 
pMlmeMem‹ySåu˘
 = 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Hód
;

6305 
pAd
->
Mlme
.
MemH™dÀr
.
pUnU£Hód
 =ÖAd->Mlme.MemH™dÀr.pUnU£Hód->
Next
;

6307 
	`k‰ì
(
pMlmeMem‹ySåu˘
->
AŒocVa
);

6309 
	`k‰ì
(
pMlmeMem‹ySåu˘
);

6312 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<---MlmeFreeMemoryHandler\n");

6313 
	}
}

6328 
VOID
 
	$Rad¨Dëe˘i⁄Sèπ
(

6329 
IN
 
PRTMP_ADAPTER
 
pAd
)

6331 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RadarDetectionStart--->\n");

6333 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0257b032);

6336 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R82
, 0x20);

6337 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R83
, 0);

6338 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R84
, 0x40);

6340 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R18
, &pAd->
P‹tCfg
.
Rad¨Dëe˘
.
BBPR18
);

6341 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R18
, 0xFF);

6343 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R21
, &pAd->
P‹tCfg
.
Rad¨Dëe˘
.
BBPR21
);

6344 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R21
, 0x3F);

6345 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R22
, &pAd->
P‹tCfg
.
Rad¨Dëe˘
.
BBPR22
);

6346 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R22
, 0x3F);

6348 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R16
, &pAd->
P‹tCfg
.
Rad¨Dëe˘
.
BBPR16
);

6349 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R16
, 0xBD);

6350 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R17
, &pAd->
P‹tCfg
.
Rad¨Dëe˘
.
BBPR17
);

6351 i‡(
pAd
->
NicC⁄fig2
.
fõld
.
Exã∫ÆLNA
)

6353 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17, 0x44);

6357 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17, 0x34);

6360 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R64
, &pAd->
P‹tCfg
.
Rad¨Dëe˘
.
BBPR64
);

6361 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R64
, 0x21);

6363 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0256b032);

6364 
	}
}

6381 
BOOLEAN
 
	$Rad¨Dëe˘i⁄St›
(

6382 
IN
 
PRTMP_ADAPTER
 
pAd
)

6384 
UCHAR
 
R66
;

6388 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R66
, &
R66
);

6391 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R16
,ÖAd->
P‹tCfg
.
Rad¨Dëe˘
.
BBPR16
);

6392 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R17
,ÖAd->
P‹tCfg
.
Rad¨Dëe˘
.
BBPR17
);

6393 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R18
,ÖAd->
P‹tCfg
.
Rad¨Dëe˘
.
BBPR18
);

6394 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R21
,ÖAd->
P‹tCfg
.
Rad¨Dëe˘
.
BBPR21
);

6395 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R22
,ÖAd->
P‹tCfg
.
Rad¨Dëe˘
.
BBPR22
);

6396 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R64
,ÖAd->
P‹tCfg
.
Rad¨Dëe˘
.
BBPR64
);

6398 i‡(
R66
 == 1)

6399  
TRUE
;

6401  
FALSE
;

6402 
	}
}

6419 
BOOLEAN
 
	$Rad¨Ch™√lCheck
(

6420 
IN
 
PRTMP_ADAPTER
 
pAd
,

6421 
IN
 
UCHAR
 
Ch
)

6423 
INT
 
i
;

6424 
UCHAR
 
Ch™√l
[15]={52, 56, 60, 64, 100, 104, 108, 112, 116, 120, 124, 128, 132, 136, 140};

6426 
i
=0; i<15; i++)

6428 i‡(
Ch
 =
Ch™√l
[
i
])

6434 i‡(
i
 != 15)

6435  
TRUE
;

6437  
FALSE
;

6438 
	}
}

	@mlme.h

40 #i‚de‡
__MLME_H__


41 
	#__MLME_H__


	)

43 
	~"oid.h
"

47 
	#SUPPORTED_CAPABILITY_INFO
 0x0533

	)

49 
	#END_OF_ARGS
 -1

	)

50 
	#LFSR_MASK
 0x80000057

	)

51 
	#MLME_TASK_EXEC_INTV
 1000

53 

	)

54 
	#BEACON_LOST_TIME
 (4*
HZ
)

55 

	)

56 
	#AUTH_TIMEOUT
 300

57 
	#ASSOC_TIMEOUT
 300

58 
	#JOIN_TIMEOUT
 2000

59 
	#MIN_CHANNEL_TIME
 110

60 
	#MAX_CHANNEL_TIME
 140

62 
	#FAST_ACTIVE_SCAN_TIME
 30

63 
	#CW_MIN_IN_BITS
 4

64 
	#CW_MAX_IN_BITS
 10

65 

	)

68 
	#RSSI_TO_DBM_OFFSET
 120

69 
	#RSSI_FOR_MID_TX_POWER
 -55

70 
	#RSSI_FOR_LOW_TX_POWER
 -45

72 
	#RSSI_FOR_LOWEST_TX_POWER
 -30

	)

74 
	#LOW_TX_POWER_DELTA
 6

75 
	#LOWEST_TX_POWER_DELTA
 16

76 

	)

77 
	#RSSI_TRIGGERED_UPON_BELOW_THRESHOLD
 0

	)

78 
	#RSSI_TRIGGERED_UPON_EXCCEED_THRESHOLD
 1

	)

79 
	#RSSI_THRESHOLD_FOR_ROAMING
 25

	)

80 
	#RSSI_DELTA
 5

	)

83 
	#CQI_IS_GOOD
(
cqi
Ë((cqiË>50)

	)

85 
	#CQI_IS_POOR
(
cqi
) (cqi < 50)

86 
	#CQI_IS_BAD
(
cqi
Ë(cqò< 5)

	)

87 
	#CQI_IS_DEAD
(
cqi
) (cqi == 0)

88 

	)

90 
	#RSSI_WEIGHTING
 50

	)

91 
	#TX_WEIGHTING
 30

	)

92 
	#RX_WEIGHTING
 20

	)

94 
	#MAX_LEN_OF_BSS_TABLE
 64

	)

95 
	#BSS_NOT_FOUND
 0xFFFFFFFF

	)

97 
	#SCAN_PASSIVE
 18

	)

98 
	#SCAN_ACTIVE
 19

	)

99 
	#FAST_SCAN_ACTIVE
 24

100 
	#MAX_LEN_OF_MLME_QUEUE
 40

	)

103 
	#CAP_IS_ESS_ON
(
x
Ë(((xË& 0x0001Ë!0)

	)

104 
	#CAP_IS_IBSS_ON
(
x
Ë(((xË& 0x0002Ë!0)

	)

105 
	#CAP_IS_CF_POLLABLE_ON
(
x
Ë(((xË& 0x0004Ë!0)

	)

106 
	#CAP_IS_CF_POLL_REQ_ON
(
x
Ë(((xË& 0x0008Ë!0)

	)

107 
	#CAP_IS_PRIVACY_ON
(
x
Ë(((xË& 0x0010Ë!0)

	)

108 
	#CAP_IS_SHORT_PREAMBLE_ON
(
x
Ë(((xË& 0x0020Ë!0)

	)

109 
	#CAP_IS_PBCC_ON
(
x
Ë(((xË& 0x0040Ë!0)

	)

110 
	#CAP_IS_AGILITY_ON
(
x
Ë(((xË& 0x0080Ë!0)

	)

111 
	#CAP_IS_SPECTRUM_MGMT
(
x
) (((x) & 0x0100) != 0)

112 
	#CAP_IS_QOS
(
x
) (((x) & 0x0200) != 0)

113 
	#CAP_IS_SHORT_SLOT
(
x
Ë(((xË& 0x0400Ë!0)

	)

114 
	#CAP_IS_APSD
(
x
) (((x) & 0x0800) != 0)

115 
	#CAP_IS_IMMED_BA
(
x
) (((x) & 0x1000) != 0)

116 
	#CAP_IS_DSSS_OFDM
(
x
Ë(((xË& 0x2000Ë!0)

	)

117 
	#CAP_IS_DELAY_BA
(
x
) (((x) & 0x4000) != 0)

118 

	)

119 
	#CAP_GENERATE
(
ess
,
ibss
,
¥iv
,
s_¥e
,
s_¶Ÿ
Ë((”ssË? 0x0001 : 0x0000Ë| ((ibssË? 0x0002 : 0x0000Ë| (’rivË? 0x0010 : 0x0000Ë| ((s_¥eË? 0x0020 : 0x0000Ë| ((s_¶ŸË? 0x0400 : 0x0000))

	)

121 
	#STA_QOS_CAPABILITY
 0

122 

	)

123 
	#ERP_IS_NON_ERP_PRESENT
(
x
) (((x) & 0x01) != 0)

124 
	#ERP_IS_USE_PROTECTION
(
x
) (((x) & 0x02) != 0)

125 
	#ERP_IS_USE_BARKER_PREAMBLE
(
x
) (((x) & 0x04) != 0)

126 

	)

127 
	#DRS_TX_QUALITY_WORST_BOUND
 3

	)

128 
	#DRS_PENALTY
 8

	)

136 
	sPACKED
 {

137 #ifde‡
BIG_ENDIAN


138 
USHORT
 
	mTx›_QueueSize
:8;

139 
USHORT
 
	mRsv
:1;

140 
USHORT
 
	mAckPﬁicy
:2;

141 
USHORT
 
	mEOSP
:1;

142 
USHORT
 
	mTID
:4;

144 
USHORT
 
	mTID
:4;

145 
USHORT
 
	mEOSP
:1;

146 
USHORT
 
	mAckPﬁicy
:2;

147 
USHORT
 
	mRsv
:1;

148 
USHORT
 
	mTx›_QueueSize
:8;

150 } 
	tQOS_CONTROL
, *
	tPQOS_CONTROL
;

153 
	sPACKED
 {

154 #ifde‡
BIG_ENDIAN


155 
USHORT
 
	mOrdî
:1;

156 
USHORT
 
	mWï
:1;

157 
USHORT
 
	mM‹eD©a
:1;

158 
USHORT
 
	mPwrMgmt
:1;

159 
USHORT
 
	mRëry
:1;

160 
USHORT
 
	mM‹eFøg
:1;

161 
USHORT
 
	mFrDs
:1;

162 
USHORT
 
	mToDs
:1;

163 
USHORT
 
	mSubTy≥
:4;

164 
USHORT
 
	mTy≥
:2;

165 
USHORT
 
	mVî
:2;

167 
USHORT
 
	mVî
:2;

168 
USHORT
 
	mTy≥
:2;

169 
USHORT
 
	mSubTy≥
:4;

170 
USHORT
 
	mToDs
:1;

171 
USHORT
 
	mFrDs
:1;

172 
USHORT
 
	mM‹eFøg
:1;

173 
USHORT
 
	mRëry
:1;

174 
USHORT
 
	mPwrMgmt
:1;

175 
USHORT
 
	mM‹eD©a
:1;

176 
USHORT
 
	mWï
:1;

177 
USHORT
 
	mOrdî
:1;

179 } 
	tFRAME_CONTROL
, *
	tPFRAME_CONTROL
;

181 
PACKED
 
	t_HEADER_802_11
 {

182 
FRAME_CONTROL
 
	gFC
;

183 
USHORT
 
	gDuøti⁄
;

184 
UCHAR
 
	gAddr1
[
MAC_ADDR_LEN
];

185 
UCHAR
 
	gAddr2
[
MAC_ADDR_LEN
];

186 
UCHAR
 
	gAddr3
[
MAC_ADDR_LEN
];

187 #ifde‡
BIG_ENDIAN


188 
USHORT
 
	gSequí˚
:12;

189 
USHORT
 
	gFøg
:4;

191 
USHORT
 
	gFøg
:4;

192 
USHORT
 
	gSequí˚
:12;

194 } 
	tHEADER_802_11
, *
	tPHEADER_802_11
;

196 
PACKED
 
	t_FRAME_802_11
 {

197 
HEADER_802_11
 
	gHdr
;

198 
UCHAR
 
	gO˘ë
[1];

199 } 
	tFRAME_802_11
, *
	tPFRAME_802_11
;

201 
	s_PSPOLL_FRAME
 {

202 
FRAME_CONTROL
 
	mFC
;

203 
USHORT
 
	mAid
;

204 
UCHAR
 
	mBssid
[
MAC_ADDR_LEN
];

205 
UCHAR
 
	mTa
[
MAC_ADDR_LEN
];

206 } 
	tPSPOLL_FRAME
, *
	tPPSPOLL_FRAME
;

208 
PACKED
 
	t_RTS_FRAME
 {

209 
FRAME_CONTROL
 
	gFC
;

210 
USHORT
 
	gDuøti⁄
;

211 
UCHAR
 
	gAddr1
[
MAC_ADDR_LEN
];

212 
UCHAR
 
	gAddr2
[
MAC_ADDR_LEN
];

213 } 
	tRTS_FRAME
, *
	tPRTS_FRAME
;

218 
	sPACKED
 {

219 
BOOLEAN
 
	mbVÆid
;

220 
UCHAR
 
	mCÂCou¡
;

221 
UCHAR
 
	mCÂPîiod
;

222 
USHORT
 
	mCÂMaxDuøti⁄
;

223 
USHORT
 
	mCÂDurRemaöög
;

224 } 
	tCF_PARM
, *
	tPCF_PARM
;

226 
PACKED
 
	t_CIPHER_SUITE
 {

227 
NDIS_802_11_ENCRYPTION_STATUS
 
	gPaúCùhî
;

228 
NDIS_802_11_ENCRYPTION_STATUS
 
	gPaúCùhîAux
;

229 
NDIS_802_11_ENCRYPTION_STATUS
 
	gGroupCùhî
;

230 
USHORT
 
	gR¢C≠abûôy
;

231 
BOOLEAN
 
	gbMixMode
;

232 } 
	tCIPHER_SUITE
, *
	tPCIPHER_SUITE
;

235 
	sPACKED
 {

236 
BOOLEAN
 
	mbVÆid
;

237 
BOOLEAN
 
	mbQAck
;

238 
BOOLEAN
 
	mbQueueReque°
;

239 
BOOLEAN
 
	mbTx›Reque°
;

241 
UCHAR
 
	mEdˇUpd©eCou¡
;

242 
UCHAR
 
	mAif¢
[4];

243 
UCHAR
 
	mCwmö
[4];

244 
UCHAR
 
	mCwmax
[4];

245 
USHORT
 
	mTx›
[4];

246 
BOOLEAN
 
	mbACM
[4];

247 } 
	tEDCA_PARM
, *
	tPEDCA_PARM
;

250 
	sPACKED
 {

251 
BOOLEAN
 
	mbVÆid
;

252 
USHORT
 
	mSèNum
;

253 
UCHAR
 
	mCh™√lUtûiz©i⁄
;

254 
USHORT
 
	mRemaöögAdmissi⁄C⁄åﬁ
;

255 } 
	tQBSS_LOAD_PARM
, *
	tPQBSS_LOAD_PARM
;

259 
	sPACKED
 {

260 
BOOLEAN
 
	mbVÆid
;

261 
BOOLEAN
 
	mbQAck
;

262 
BOOLEAN
 
	mbQueueReque°
;

263 
BOOLEAN
 
	mbTx›Reque°
;

265 
UCHAR
 
	mEdˇUpd©eCou¡
;

266 } 
	tQOS_CAPABILITY_PARM
, *
	tPQOS_CAPABILITY_PARM
;

269 
UCHAR
 
	mBssid
[
MAC_ADDR_LEN
];

270 
UCHAR
 
	mCh™√l
;

271 
UCHAR
 
	mBssTy≥
;

272 
USHORT
 
	mAtimWö
;

273 
USHORT
 
	mBóc⁄Pîiod
;

275 
UCHAR
 
	mSupR©e
[
MAX_LEN_OF_SUPPORTED_RATES
];

276 
UCHAR
 
	mSupR©eLí
;

277 
UCHAR
 
	mExtR©e
[
MAX_LEN_OF_SUPPORTED_RATES
];

278 
UCHAR
 
	mExtR©eLí
;

279 
UCHAR
 
	mRssi
;

280 
UCHAR
 
	mPrivacy
;

281 
UCHAR
 
	mHiddí
;

283 
USHORT
 
	mDtimPîiod
;

284 
USHORT
 
	mC≠abûôyInfo
;

286 
USHORT
 
	mCÂCou¡
;

287 
USHORT
 
	mCÂPîiod
;

288 
USHORT
 
	mCÂMaxDuøti⁄
;

289 
USHORT
 
	mCÂDurRemaöög
;

290 
UCHAR
 
	mSsidLí
;

292 
CHAR
 
	mSsid
[
MAX_LEN_OF_SSID
+1];

294 
ULONG
 
	mLa°Bóc⁄RxTime
;

297 
CIPHER_SUITE
 
	mWPA
;

298 
CIPHER_SUITE
 
	mWPA2
;

301 
NDIS_802_11_FIXED_IEs
 
	mFixIEs
;

302 
NDIS_802_11_AUTHENTICATION_MODE
 
	mAuthModeAux
;

303 
NDIS_802_11_AUTHENTICATION_MODE
 
	mAuthMode
;

304 
UCHAR
 
	mAuthBôMode
;

305 
UCHAR
 
	mPaúCùhîBôMode
;

306 
NDIS_802_11_WEP_STATUS
 
	mWïSètus
;

307 
UCHAR
 
	mV¨IELí
;

308 
UCHAR
 
	mV¨IEs
[
MAX_VIE_LEN
];

311 
UCHAR
 
	mCkùFœg
;

317 
EDCA_PARM
 
	mEdˇP¨m
;

318 
QOS_CAPABILITY_PARM
 
	mQosC≠abûôy
;

319 
QBSS_LOAD_PARM
 
	mQbssLﬂd
;

320 } 
	tBSS_ENTRY
, *
	tPBSS_ENTRY
;

323 
UCHAR
 
	mBssNr
;

324 
UCHAR
 
	mBssOvîœpNr
;

325 
BSS_ENTRY
 
	mBssE¡ry
[
MAX_LEN_OF_BSS_TABLE
];

326 } 
	tBSS_TABLE
, *
	tPBSS_TABLE
;

328 
	s_MLME_QUEUE_ELEM
 {

329 
UCHAR
 
	mMsg
[
MAX_LEN_OF_MLME_BUFFER
];

330 
ULONG
 
	mMachöe
;

331 
ULONG
 
	mMsgTy≥
;

332 
ULONG
 
	mMsgLí
;

333 
LARGE_INTEGER
 
	mTimeSèmp
;

334 
UCHAR
 
	mRssi
;

335 
UCHAR
 
	mSig«l
;

336 
UCHAR
 
	mCh™√l
;

337 
BOOLEAN
 
	mOccupõd
;

338 
BOOLEAN
 
	mbReqIsFromNdis
;

340 } 
	tMLME_QUEUE_ELEM
, *
	tPMLME_QUEUE_ELEM
;

342 
	s_MLME_QUEUE
 {

343 
ULONG
 
	mNum
;

344 
ULONG
 
	mHód
;

345 
ULONG
 
	mTaû
;

346 
•ölock_t
 
	mLock
;

347 
MLME_QUEUE_ELEM
 
	mE¡ry
[
MAX_LEN_OF_MLME_QUEUE
];

348 } 
	tMLME_QUEUE
, *
	tPMLME_QUEUE
;

350 
	$VOID
 (*
	tSTATE_MACHINE_FUNC
)(
	tVOID
 *
	tAd≠t‹
, 
	tMLME_QUEUE_ELEM
 *
	tEÀm
);

352 
	s_STATE_MACHINE
 {

353 
ULONG
 
Ba£
;

354 
ULONG
 
NrSèã
;

355 
ULONG
 
NrMsg
;

356 
ULONG
 
CuºSèã
;

357 
STATE_MACHINE_FUNC
 *
TønsFunc
;

358 } 
	tSTATE_MACHINE
, *
	tPSTATE_MACHINE
;

366 
	s_MLME_AUX
 {

367 
UCHAR
 
BssTy≥
;

369 
UCHAR
 
Ssid
[
MAX_LEN_OF_SSID
+1];

370 
UCHAR
 
SsidLí
;

371 
UCHAR
 
Bssid
[
MAC_ADDR_LEN
];

373 
UCHAR
 
AutoRec⁄√˘Ssid
[
MAX_LEN_OF_SSID
+1];

374 
UCHAR
 
AutoRec⁄√˘SsidLí
;

375 
USHORT
 
Alg
;

376 
UCHAR
 
SˇnTy≥
;

377 
UCHAR
 
Ch™√l
;

378 
USHORT
 
Aid
;

379 
USHORT
 
C≠abûôyInfo
;

380 
USHORT
 
Bóc⁄Pîiod
;

381 
USHORT
 
CÂMaxDuøti⁄
;

382 
USHORT
 
CÂPîiod
;

383 
USHORT
 
AtimWö
;

387 
UCHAR
 
SupR©e
[
MAX_LEN_OF_SUPPORTED_RATES
];

388 
UCHAR
 
ExtR©e
[
MAX_LEN_OF_SUPPORTED_RATES
];

389 
UCHAR
 
SupR©eLí
;

390 
UCHAR
 
ExtR©eLí
;

393 
QOS_CAPABILITY_PARM
 
APQosC≠abûôy
;

394 
EDCA_PARM
 
APEdˇP¨m
;

395 
QBSS_LOAD_PARM
 
APQbssLﬂd
;

398 
ULONG
 
APRÆökIe
;

400 
BSS_TABLE
 
SsidBssTab
;

401 
BSS_TABLE
 
RﬂmTab
;

402 
ULONG
 
BssIdx
;

403 
ULONG
 
RﬂmIdx
;

405 
BOOLEAN
 
CuºReqIsFromNdis
;

409 
RALINK_TIMER_STRUCT
 
Bóc⁄Timî
, 
SˇnTimî
;

410 
RALINK_TIMER_STRUCT
 
AuthTimî
;

411 
RALINK_TIMER_STRUCT
 
AssocTimî
, 
RóssocTimî
, 
DißssocTimî
;

412 } 
	tMLME_AUX
, *
	tPMLME_AUX
;

415 
	s_MLME_ASSOC_REQ_STRUCT
{

416 
UCHAR
 
Addr
[
MAC_ADDR_LEN
];

417 
USHORT
 
C≠abûôyInfo
;

418 
USHORT
 
Li°íI¡v
;

419 
ULONG
 
Timeout
;

420 } 
	tMLME_ASSOC_REQ_STRUCT
, *
	tPMLME_ASSOC_REQ_STRUCT
, 
	tMLME_REASSOC_REQ_STRUCT
, *
	tPMLME_REASSOC_REQ_STRUCT
;

422 
	s_MLME_DISASSOC_REQ_STRUCT
{

423 
UCHAR
 
Addr
[
MAC_ADDR_LEN
];

424 
USHORT
 
Rós⁄
;

425 } 
	tMLME_DISASSOC_REQ_STRUCT
, *
	tPMLME_DISASSOC_REQ_STRUCT
;

427 
	s_MLME_AUTH_REQ_STRUCT
 {

428 
UCHAR
 
Addr
[
MAC_ADDR_LEN
];

429 
USHORT
 
Alg
;

430 
ULONG
 
Timeout
;

431 } 
	tMLME_AUTH_REQ_STRUCT
, *
	tPMLME_AUTH_REQ_STRUCT
;

433 
	s_MLME_DEAUTH_REQ_STRUCT
 {

434 
UCHAR
 
Addr
[
MAC_ADDR_LEN
];

435 
USHORT
 
Rós⁄
;

436 } 
	tMLME_DEAUTH_REQ_STRUCT
, *
	tPMLME_DEAUTH_REQ_STRUCT
;

439 
ULONG
 
BssIdx
;

440 } 
	tMLME_JOIN_REQ_STRUCT
;

442 
	s_MLME_SCAN_REQ_STRUCT
 {

443 
UCHAR
 
Bssid
[
MAC_ADDR_LEN
];

444 
UCHAR
 
BssTy≥
;

445 
UCHAR
 
SˇnTy≥
;

446 
UCHAR
 
SsidLí
;

448 
CHAR
 
Ssid
[
MAX_LEN_OF_SSID
+1];

449 } 
	tMLME_SCAN_REQ_STRUCT
, *
	tPMLME_SCAN_REQ_STRUCT
;

451 
	s_MLME_START_REQ_STRUCT
 {

453 
CHAR
 
Ssid
[
MAX_LEN_OF_SSID
+1];

454 
UCHAR
 
SsidLí
;

455 } 
	tMLME_START_REQ_STRUCT
, *
	tPMLME_START_REQ_STRUCT
;

458 
UCHAR
 
Eid
;

459 
UCHAR
 
Lí
;

460 
UCHAR
 
O˘ë
[1];

461 } 
	tEID_STRUCT
,*
	tPEID_STRUCT
;

	@mlme_ex.c

38 
	~"π_c⁄fig.h
"

39 
	~"mlme_ex_def.h
"

40 
	~<°d¨g.h
>

41 
	~"mesh_dbg_ªdef.h
"

59 
VOID
 
	$SèãMachöeInôEx
(

60 
IN
 
STATE_MACHINE_EX
 *
S
,

61 
IN
 
STATE_MACHINE_FUNC_EX
 
Tøns
[],

62 
IN
 
ULONG
 
StNr
,

63 
IN
 
ULONG
 
MsgNr
,

64 
IN
 
STATE_MACHINE_FUNC_EX
 
DefFunc
,

65 
IN
 
ULONG
 
InôSèã
,

66 
IN
 
ULONG
 
Ba£
)

68 
ULONG
 
i
, 
j
;

71 
S
->
NrSèã
 = 
StNr
;

72 
S
->
NrMsg
 = 
MsgNr
;

73 
S
->
Ba£
 = Base;

75 
S
->
TønsFunc
 = 
Tøns
;

78 
i
 = 0; i < 
StNr
; i++)

80 
j
 = 0; j < 
MsgNr
; j++)

82 
S
->
TønsFunc
[
i
 * 
MsgNr
 + 
j
] = 
DefFunc
;

87 
S
->
CuºSèã
 = 
InôSèã
;

90 
	}
}

100 
VOID
 
	$SèãMachöeSëA˘i⁄Ex
(

101 
IN
 
STATE_MACHINE_EX
 *
S
,

102 
IN
 
ULONG
 
St
,

103 
IN
 
ULONG
 
Msg
,

104 
IN
 
STATE_MACHINE_FUNC_EX
 
Func
)

106 
ULONG
 
MsgIdx
;

108 
MsgIdx
 = 
Msg
 - 
S
->
Ba£
;

110 i‡(
St
 < 
S
->
NrSèã
 && 
MsgIdx
 < S->
NrMsg
)

113 
S
->
TønsFunc
[
St
 * S->
NrMsg
 + 
MsgIdx
] = 
Func
;

117 
	}
}

125 
VOID
 
	$SèãMachöePîf‹mA˘i⁄Ex
(

126 
IN
 
PRTMP_ADAPTER
 
pAd
,

127 
IN
 
STATE_MACHINE_EX
 *
S
,

128 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
,

129 
USHORT
 
Idx
,

130 
PULONG
 
pCuºSèã
)

132 i‡(
S
->
TønsFunc
[(*
pCuºSèã
Ë* S->
NrMsg
 + 
EÀm
->
MsgTy≥
 - S->
Ba£
])

133 (*(
S
->
TønsFunc
[(*
pCuºSèã
Ë* S->
NrMsg
 + 
EÀm
->
MsgTy≥
 - S->
Ba£
]))(
pAd
, EÀm,ÖCuºSèã, 
Idx
);

136 
	}
}

149 
BOOLEAN
 
	$MlmeEnqueueEx
(

150 
IN
 
PRTMP_ADAPTER
 
pAd
,

151 
IN
 
ULONG
 
Machöe
,

152 
IN
 
ULONG
 
MsgTy≥
,

153 
IN
 
ULONG
 
MsgLí
,

154 
IN
 
VOID
 *
Msg
,

155 
IN
 
USHORT
 
Idx
)

157 
INT
 
Taû
;

158 
MLME_QUEUE
 *
Queue
 = (MLME_QUEUE *)&
pAd
->
Mlme
.Queue;

162 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
))

163  
FALSE
;

167 i‡(
MsgLí
 > 
MAX_LEN_OF_MLME_BUFFER
)

169 
	`DBGPRINT_ERR
(("MlmeEnqueueEx: msgÅoÿœrge, sizê%d \n", 
MsgLí
));

170  
FALSE
;

173 i‡(
	`MlmeQueueFuŒ
(
Queue
))

175 
	`DBGPRINT_ERR
(("MlmeEnqueueEx: full, msg droppedánd may corrupt MLME\n"));

176 
	`RTUSBMlmeUp
(
pAd
);

177  
FALSE
;

180 
	`RTMP_SEM_LOCK
(&
Queue
->
Lock
);

181 
Taû
 = 
Queue
->Tail;

182 
Queue
->
Taû
++;

183 
Queue
->
Num
++;

184 i‡(
Queue
->
Taû
 =
MAX_LEN_OF_MLME_QUEUE
)

186 
Queue
->
Taû
 = 0;

188 
	`DBGPRINT
(
RT_DEBUG_INFO
, ("MlmeEnqueueEx,Çum=%d\n",
Queue
->
Num
));

190 
Queue
->
E¡ry
[
Taû
].
Occupõd
 = 
TRUE
;

191 
Queue
->
E¡ry
[
Taû
].
Machöe
 = Machine;

192 
Queue
->
E¡ry
[
Taû
].
MsgTy≥
 = MsgType;

193 
Queue
->
E¡ry
[
Taû
].
MsgLí
 = MsgLen;

194 
Queue
->
E¡ry
[
Taû
].
Idx
 = Idx;

195 i‡(
Msg
 !
NULL
)

196 
	`NdisMoveMem‹y
(
Queue
->
E¡ry
[
Taû
].
Msg
, Msg, 
MsgLí
);

198 
	`RTMP_SEM_UNLOCK
(&
Queue
->
Lock
);

200  
TRUE
;

201 
	}
}

211 
VOID
 
	$Dr›Ex
(

212 
IN
 
PRTMP_ADAPTER
 
pAd
,

213 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
,

214 
PULONG
 
pCuºSèã
,

215 
USHORT
 
Idx
)

218 
	}
}

	@mlme_ex.h

38 #i‚de‡
__MLME_EX_H__


39 
	#__MLME_EX_H__


	)

41 
	~"mlme_ex_def.h
"

44 
VOID
 
SèãMachöeInôEx
(

45 
IN
 
STATE_MACHINE_EX
 *
S
,

46 
IN
 
STATE_MACHINE_FUNC_EX
 
Tøns
[],

47 
IN
 
ULONG
 
StNr
,

48 
IN
 
ULONG
 
MsgNr
,

49 
IN
 
STATE_MACHINE_FUNC_EX
 
DefFunc
,

50 
IN
 
ULONG
 
InôSèã
,

51 
IN
 
ULONG
 
Ba£
);

53 
VOID
 
SèãMachöeSëA˘i⁄Ex
(

54 
IN
 
STATE_MACHINE_EX
 *
S
,

55 
IN
 
ULONG
 
St
,

56 
IN
 
ULONG
 
Msg
,

57 
IN
 
STATE_MACHINE_FUNC_EX
 
Func
);

59 
BOOLEAN
 
isVÆidApCliIf
(

60 
SHORT
 
Idx
);

62 
VOID
 
SèãMachöePîf‹mA˘i⁄Ex
(

63 
IN
 
PRTMP_ADAPTER
 
pAd
,

64 
IN
 
STATE_MACHINE_EX
 *
S
,

65 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
,

66 
USHORT
 
Idx
,

67 
PULONG
 
pCuºSèã
);

69 
BOOLEAN
 
MlmeEnqueueEx
(

70 
IN
 
PRTMP_ADAPTER
 
pAd
,

71 
IN
 
ULONG
 
Machöe
,

72 
IN
 
ULONG
 
MsgTy≥
,

73 
IN
 
ULONG
 
MsgLí
,

74 
IN
 
VOID
 *
Msg
,

75 
IN
 
USHORT
 
Idx
);

77 
VOID
 
Dr›Ex
(

78 
IN
 
PRTMP_ADAPTER
 
pAd
,

79 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
,

80 
PULONG
 
pCuºSèã
,

81 
USHORT
 
Idx
);

	@mlme_ex_def.h

38 #i‚de‡
__MLME_EX_DEF_H__


39 
	#__MLME_EX_DEF_H__


	)

42 
	$VOID
 (*
	tSTATE_MACHINE_FUNC_EX
)(
	tVOID
 *
	tAd≠t‹
, 
	tMLME_QUEUE_ELEM
 *
	tEÀm
, 
	tPULONG
 
	tpCuºSèã
, 
	tUSHORT
 
	tIdx
);

44 
	s_STA_STATE_MACHINE_EX


46 
ULONG
 
Ba£
;

47 
ULONG
 
NrSèã
;

48 
ULONG
 
NrMsg
;

49 
ULONG
 
CuºSèã
;

50 
STATE_MACHINE_FUNC_EX
 *
TønsFunc
;

51 } 
	tSTATE_MACHINE_EX
, *
	tPSTA_STATE_MACHINE_EX
;

	@netif_block.c

28 
	~"π_c⁄fig.h
"

29 
	~"√tif_block.h
"

31 
NETIF_ENTRY
 
	g‰ìNëIfE¡ryPoﬁ
[
FREE_NETIF_POOL_SIZE
];

32 
LIST_HEADER
 
	g‰ìNëIfE¡ryLi°
;

34 
	$öôblockQueueTab
(

35 
IN
 
PRTMP_ADAPTER
 
pAd
)

37 
i
;

39 
	`öôLi°
(&
‰ìNëIfE¡ryLi°
);

40 
i
 = 0; i < 
FREE_NETIF_POOL_SIZE
; i++)

41 
	`ö£πTaûLi°
(&
‰ìNëIfE¡ryLi°
, (
PLIST_ENTRY
)&
‰ìNëIfE¡ryPoﬁ
[
i
]);

43 
i
=0; i < 
NUM_OF_TX_RING
; i++)

44 
	`öôLi°
(&
pAd
->
blockQueueTab
[
i
].
NëIfLi°
);

47 
	}
}

49 
BOOLEAN
 
	$blockNëIf
(

50 
IN
 
PBLOCK_QUEUE_ENTRY
 
pBlockQueueE¡ry
,

51 
IN
 
PNET_DEV
 
pNëDev
)

53 
PNETIF_ENTRY
 
pNëIfE¡ry
 = 
NULL
;

55 i‡((
pNëIfE¡ry
 = (
PNETIF_ENTRY
)
	`ªmoveHódLi°
(&
‰ìNëIfE¡ryLi°
)Ë!
NULL
)

57 
	`√tif_°›_queue
(
pNëDev
);

58 
pNëIfE¡ry
->
pNëDev
 =ÖNetDev;

59 
	`ö£πTaûLi°
(&
pBlockQueueE¡ry
->
NëIfLi°
, (
PLIST_ENTRY
)
pNëIfE¡ry
);

61 
pBlockQueueE¡ry
->
SwTxQueueBlockFœg
 = 
TRUE
;

62 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "√tif_°›_queue(%s)\n", 
pNëDev
->
«me
);

65  
FALSE
;

67  
TRUE
;

68 
	}
}

70 
VOID
 
	$ªÀa£NëIf
(

71 
IN
 
PBLOCK_QUEUE_ENTRY
 
pBlockQueueE¡ry
)

73 
PNETIF_ENTRY
 
pNëIfE¡ry
 = 
NULL
;

74 
PLIST_HEADER
 
pNëIfLi°
 = &
pBlockQueueE¡ry
->
NëIfLi°
;

76 (
pNëIfE¡ry
 = (
PNETIF_ENTRY
)
	`ªmoveHódLi°
(
pNëIfLi°
)Ë!
NULL
)

78 
PNET_DEV
 
pNëDev
 = 
pNëIfE¡ry
->pNetDev;

79 
	`√tif_wake_queue
(
pNëDev
);

80 
	`ö£πTaûLi°
(&
‰ìNëIfE¡ryLi°
, (
PLIST_ENTRY
)
pNëIfE¡ry
);

82 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "√tif_wake_queue(%s)\n", 
pNëDev
->
«me
);

84 
pBlockQueueE¡ry
->
SwTxQueueBlockFœg
 = 
FALSE
;

86 
	}
}

89 
VOID
 
	$St›NëIfQueue
(

90 
IN
 
PRTMP_ADAPTER
 
pAd
,

91 
IN
 
UCHAR
 
QueIdx
,

92 
IN
 
PNDIS_PACKET
 
pPackë
)

94 
PNET_DEV
 
NëDev
 = 
NULL
;

95 
BOOLEAN
 
vÆid
;

98 
NëDev
 = 
pAd
->
√t_dev
;

103 
vÆid
 = (
pAd
->
P‹tCfg
.
bWmmC≠abÀ
 =
TRUE
Ë? 
FALSE
 : TRUE;

105 i‡(
vÆid
)

106 
	`blockNëIf
(&
pAd
->
blockQueueTab
[
QueIdx
], 
NëDev
);

108 
	}
}

	@netif_block.h

28 #i‚de‡
__NET_IF_BLOCK_H__


29 
	#__NET_IF_BLOCK_H__


	)

32 
	~"lök_li°.h
"

33 
	~"πmp.h
"

35 
	#FREE_NETIF_POOL_SIZE
 32

	)

37 
	s_NETIF_ENTRY


39 
_NETIF_ENTRY
 *
	mpNext
;

40 
PNET_DEV
 
	mpNëDev
;

41 } 
	tNETIF_ENTRY
, *
	tPNETIF_ENTRY
;

43 
öôblockQueueTab
(

44 
IN
 
PRTMP_ADAPTER
 
pAd
);

46 
BOOLEAN
 
blockNëIf
(

47 
IN
 
PBLOCK_QUEUE_ENTRY
 
pBlockQueueE¡ry
,

48 
IN
 
PNET_DEV
 
pNëDev
);

50 
VOID
 
ªÀa£NëIf
(

51 
IN
 
PBLOCK_QUEUE_ENTRY
 
pBlockQueueE¡ry
);

53 
VOID
 
St›NëIfQueue
(

54 
IN
 
PRTMP_ADAPTER
 
pAd
,

55 
IN
 
UCHAR
 
QueIdx
,

56 
IN
 
PNDIS_PACKET
 
pPackë
);

	@oid.h

38 #i‚de‡
_OID_H_


39 
	#_OID_H_


	)

41 
	~<löux/wúñess.h
>

44 #i‡
WIRELESS_EXT
 <= 11

45 #i‚de‡
SIOCDEVPRIVATE


46 
	#SIOCDEVPRIVATE
 0x8BE0

	)

48 
	#SIOCIWFIRSTPRIV
 
SIOCDEVPRIVATE


	)

51 
	#RT_PRIV_IOCTL
 (
SIOCIWFIRSTPRIV
 + 0x0E)

	)

52 
	#RTPRIV_IOCTL_SET
 (
SIOCIWFIRSTPRIV
 + 0x02)

	)

53 
	#RTPRIV_IOCTL_SHOW
 (
SIOCIWFIRSTPRIV
 + 0x13)

	)

55 #ifde‡
DBG


56 
	#RTPRIV_IOCTL_BBP
 (
SIOCIWFIRSTPRIV
 + 0x03)

	)

57 
	#RTPRIV_IOCTL_MAC
 (
SIOCIWFIRSTPRIV
 + 0x05)

	)

58 #ifde‡
RALINK_ATE


59 
	#RTPRIV_IOCTL_E2P
 (
SIOCIWFIRSTPRIV
 + 0x11)

	)

62 
	#RTPRIV_IOCTL_STATISTICS
 (
SIOCIWFIRSTPRIV
 + 0x09)

	)

63 
	#RTPRIV_IOCTL_GSITESURVEY
 (
SIOCIWFIRSTPRIV
 + 0x0D)

	)

64 
	#RTPRIV_IOCTL_GETRAAPCFG
 (
SIOCIWFIRSTPRIV
 + 0x0F)

	)

67 
	#RTPRIV_IOCTL_AUTH
 (
SIOCIWFIRSTPRIV
 + 0x07)

	)

68 
	#RTPRIV_IOCTL_WEPSTATUS
 (
SIOCIWFIRSTPRIV
 + 0x08)

	)

69 
	#RTPRIV_IOCTL_WPAPSK
 (
SIOCIWFIRSTPRIV
 + 0x0A)

	)

70 
	#RTPRIV_IOCTL_PSM
 (
SIOCIWFIRSTPRIV
 + 0x0B)

	)

73 
	#OID_GET_SET_TOGGLE
 0x8000

	)

75 
	#OID_GEN_MACHINE_NAME
 0x0001021A

	)

78 
	#OID_802_11_NETWORK_TYPES_SUPPORTED
 0x0103

	)

79 
	#OID_802_11_NETWORK_TYPE_IN_USE
 0x0104

	)

80 
	#OID_802_11_RSSI_TRIGGER
 0x0107

	)

81 
	#OID_802_11_NUMBER_OF_ANTENNAS
 0x010B

	)

82 
	#OID_802_11_RX_ANTENNA_SELECTED
 0x010C

	)

83 
	#OID_802_11_TX_ANTENNA_SELECTED
 0x010D

	)

84 
	#OID_802_11_SUPPORTED_RATES
 0x010E

	)

85 
	#OID_802_11_ADD_WEP
 0x0112

	)

86 
	#OID_802_11_REMOVE_WEP
 0x0113

	)

87 
	#OID_802_11_DISASSOCIATE
 0x0114

	)

88 
	#OID_802_11_MIC_FAILURE_REPORT_FRAME
 0x0115

89 
	#OID_802_11_PRIVACY_FILTER
 0x0118

	)

90 
	#OID_802_11_ASSOCIATION_INFORMATION
 0x011E

	)

91 
	#OID_802_11_TEST
 0x011F

	)

93 
	#RT_OID_802_11_COUNTRY_REGION
 0x0507

	)

94 
	#OID_802_11_BSSID_LIST_SCAN
 0x0508

	)

95 
	#OID_802_11_SSID
 0x0509

96 
	#OID_802_11_BSSID
 0x050A

97 
	#RT_OID_802_11_RADIO
 0x050B

98 
	#RT_OID_802_11_PHY_MODE
 0x050C

99 
	#RT_OID_802_11_STA_CONFIG
 0x050D

100 
	#OID_802_11_DESIRED_RATES
 0x050E

	)

101 
	#RT_OID_802_11_PREAMBLE
 0x050F

102 
	#OID_802_11_WEP_STATUS
 0x0510

103 
	#OID_802_11_AUTHENTICATION_MODE
 0x0511

104 
	#OID_802_11_INFRASTRUCTURE_MODE
 0x0512

105 
	#RT_OID_802_11_RESET_COUNTERS
 0x0513

	)

106 
	#OID_802_11_RTS_THRESHOLD
 0x0514

107 
	#OID_802_11_FRAGMENTATION_THRESHOLD
 0x0515

108 
	#OID_802_11_POWER_MODE
 0x0516

109 
	#OID_802_11_TX_POWER_LEVEL
 0x0517

	)

110 
	#RT_OID_802_11_ADD_WPA
 0x0518

	)

111 
	#OID_802_11_REMOVE_KEY
 0x0519

	)

112 
	#OID_802_11_ADD_KEY
 0x0520

	)

113 
	#OID_802_11_CONFIGURATION
 0x0521

114 
	#OID_802_11_TX_PACKET_BURST
 0x0522

	)

115 
	#RT_OID_802_11_QUERY_NOISE_LEVEL
 0x0523

	)

116 
	#RT_OID_802_11_EXTRA_INFO
 0x0524

	)

118 
	#RT_OID_DEVICE_NAME
 0x0607

	)

119 
	#RT_OID_VERSION_INFO
 0x0608

	)

120 
	#OID_802_11_BSSID_LIST
 0x0609

	)

121 
	#OID_802_3_CURRENT_ADDRESS
 0x060A

	)

122 
	#OID_GEN_MEDIA_CONNECT_STATUS
 0x060B

	)

123 
	#RT_OID_802_11_QUERY_LINK_STATUS
 0x060C

	)

124 
	#OID_802_11_RSSI
 0x060D

	)

125 
	#OID_802_11_STATISTICS
 0x060E

	)

126 
	#OID_GEN_RCV_OK
 0x060F

	)

127 
	#OID_GEN_RCV_NO_BUFFER
 0x0610

	)

128 
	#RT_OID_802_11_QUERY_EEPROM_VERSION
 0x0611

	)

129 
	#RT_OID_802_11_QUERY_FIRMWARE_VERSION
 0x0612

	)

130 
	#RT_OID_802_11_QUERY_LAST_RX_RATE
 0x0613

	)

131 
	#RT_OID_802_11_TX_POWER_LEVEL_1
 0x0614

	)

132 
	#RT_OID_802_11_QUERY_PIDVID
 0x0615

	)

135 
	#OID_SET_COUNTERMEASURES
 0x0616

	)

136 
	#OID_802_11_SET_IEEE8021X
 0x0617

	)

137 
	#OID_802_11_SET_IEEE8021X_REQUIRE_KEY
 0x0618

	)

138 
	#OID_802_11_PMKID
 0x0620

	)

139 
	#RT_OID_WPA_SUPPLICANT_SUPPORT
 0x0621

	)

140 
	#RT_OID_WE_VERSION_COMPILED
 0x0622

	)

143 
	#OID_802_11_ENCRYPTION_STATUS
 
OID_802_11_WEP_STATUS


	)

144 
	#OID_802_11_RELOAD_DEFAULTS
 0x011B

	)

151 #ifde‡
TEST_MODE_SUPPORT


152 
	#RT_OID_ENTER_TEST_MODE
 0x0D720101

	)

153 
	#RT_OID_EXIT_TEST_MODE
 0x0D720102

	)

155 
	#RT_OID_START_BULK_OUT
 0x0D73010E

	)

156 
	#RT_OID_STOP_BULK_OUT
 0x0D730115

	)

158 
	#RT_OID_VENDOR_SELECT_CHANNEL
 0x0D730112

	)

159 
	#RT_OID_VENDOR_SET_TX_POWER
 0x0D730113

	)

162 
	#RT_OID_START_BULK_IN
 0x0D720108

	)

163 
	#RT_OID_STOP_BULK_IN
 0x0D730116

	)

165 
	#RT_OID_START_RX
 0x0D720108

	)

166 
	#RT_OID_STOP_RX
 0x0D730116

	)

169 
	#RT_OID_START_CONT_TX
 0x0D730120

	)

170 
	#RT_OID_START_CARRIER_TX
 0x0D730122

	)

171 
	#RT_OID_STOP_TX
 0x0D730121

172 
	#RT_OID_VENDOR_GET_COUNTERS
 0x0D73011B

	)

173 
	#RT_OID_VENDOR_GET_TX_FRAGMENTS_COUNT
 0x0D73011C

	)

176 
	#RT_OID_VENDOR_GET_COUNTERS
 0x0D73011B

	)

178 
	#RT_OID_USB_VENDOR_RESET
 0x0D730101

	)

179 
	#RT_OID_USB_VENDOR_UNPLUG
 0x0D730102

	)

180 
	#RT_OID_USB_VENDOR_SWITCH_FUNCTION
 0x0D730103

	)

182 
	#RT_OID_MULTI_WRITE_MAC
 0x0D730107

	)

183 
	#RT_OID_MULTI_READ_MAC
 0x0D730108

	)

184 
	#RT_OID_USB_VENDOR_EEPROM_WRITE
 0x0D73010A

	)

185 
	#RT_OID_USB_VENDOR_EEPROM_READ
 0x0D73010B

	)

187 
	#RT_OID_USB_VENDOR_ENTER_TESTMODE
 0x0D73010C

	)

188 
	#RT_OID_USB_VENDOR_EXIT_TESTMODE
 0x0D73010D

	)

189 
	#RT_OID_USB_GET_DEVICE_DESC
 0x0D730110

	)

190 
	#RT_OID_VENDOR_WRITE_BBP
 0x0D730119

	)

191 
	#RT_OID_VENDOR_READ_BBP
 0x0D730118

	)

192 
	#RT_OID_VENDOR_WRITE_RF
 0x0D73011A

	)

194 
	#RT_OID_VENDOR_FLIP_IQ
 0x0D73011D

	)

197 
	#RT_OID_SET_PER_RATE_TX_RATE_SWITCHING_STRUC
 0x0D730123

	)

198 
	#RT_OID_GET_BBP_R17_TUNING_MODE
 0x0D730124

	)

199 
	#RT_OID_SET_BBP_R17_TUNING_MODE
 (
OID_GET_SET_TOGGLE
 | 
RT_OID_GET_BBP_R17_TUNING_MODE
)

	)

200 
	#RT_OID_GET_TEST_MODE_BBP_TUNING_MODE
 0x0D730125

	)

201 
	#RT_OID_SET_TEST_MODE_BBP_TUNING_MODE
 (
OID_GET_SET_TOGGLE
 | 
RT_OID_GET_TEST_MODE_BBP_TUNING_MODE
)

	)

202 
	#RT_OID_NOR_FLASH_ERASE_BLOCK
 0x0D730126

	)

203 
	#RT_OID_NOR_FLASH_WRITE
 0x0D730127

	)

204 
	#RT_OID_NOR_FLASH_READ
 0x0D730128

	)

205 
	#RT_OID_NOR_FLASH_GET
 0x0D730129

	)

209 
	#RT_OID_USB_RESET_BULK_OUT
 0x0D730210

	)

210 
	#RT_OID_USB_RESET_BULK_IN
 0x0D730211

	)

211 
	#RT_OID_SET_PSM_BIT_SAVE
 0x0D730212

	)

212 
	#RT_OID_SET_RADIO
 0x0D730214

	)

213 
	#RT_OID_UPDATE_TX_RATE
 0x0D730216

	)

214 
	#OID_802_11_ADD_KEY_WEP
 0x0D730218

	)

215 
	#RT_OID_RESET_FROM_ERROR
 0x0D73021A

	)

216 
	#RT_OID_LINK_DOWN
 0x0D73021B

	)

217 
	#RT_OID_RESET_FROM_NDIS
 0x0D73021C

	)

218 
	#RT_OID_PERIODIC_EXECUT
 0x0D73021D

	)

219 
	#RT_OID_TEST_PERIODIC_EXECUT
 0x0D73021E

	)

220 
	#RT_OID_ASICLED_EXECUT
 0x0D73021F

	)

221 
	#RT_OID_CHECK_GPIO
 0x0D730215

	)

222 
	#RT_OID_REMOVE_ALLKEYS
 0x0D730220

	)

223 
	#RT_PERFORM_SOFT_DIVERSITY
 0x0D730221

	)

224 
	#RT_OID_FORCE_WAKE_UP
 0x0D730222

	)

225 
	#RT_OID_SET_PSM_BIT_ACTIVE
 0x0D730223

	)

226 
	#RT_CMD_RESET_MLME
 0x0D730224

	)

227 #ifde‡
NETOPIA


228 
	#RT_OID_UPDATE_R17
 0x0D730213

	)

232 
	#RT_OID_802_11_BSSID
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_BSSID
)

	)

233 
	#RT_OID_802_11_SSID
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_SSID
)

	)

234 
	#RT_OID_802_11_INFRASTRUCTURE_MODE
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_INFRASTRUCTURE_MODE
)

	)

235 
	#RT_OID_802_11_ADD_WEP
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_ADD_WEP
)

	)

236 
	#RT_OID_802_11_ADD_KEY
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_ADD_KEY
)

	)

237 
	#RT_OID_802_11_REMOVE_WEP
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_REMOVE_WEP
)

	)

238 
	#RT_OID_802_11_REMOVE_KEY
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_REMOVE_KEY
)

	)

239 
	#RT_OID_802_11_DISASSOCIATE
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_DISASSOCIATE
)

	)

240 
	#RT_OID_802_11_AUTHENTICATION_MODE
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_AUTHENTICATION_MODE
)

	)

241 
	#RT_OID_802_11_PRIVACY_FILTER
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_PRIVACY_FILTER
)

	)

242 
	#RT_OID_802_11_BSSID_LIST_SCAN
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_BSSID_LIST_SCAN
)

	)

243 
	#RT_OID_802_11_WEP_STATUS
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_WEP_STATUS
)

	)

244 
	#RT_OID_802_11_RELOAD_DEFAULTS
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_RELOAD_DEFAULTS
)

	)

245 
	#RT_OID_802_11_NETWORK_TYPE_IN_USE
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_NETWORK_TYPE_IN_USE
)

	)

246 
	#RT_OID_802_11_TX_POWER_LEVEL
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_TX_POWER_LEVEL
)

	)

247 
	#RT_OID_802_11_RSSI_TRIGGER
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_RSSI_TRIGGER
)

	)

248 
	#RT_OID_802_11_FRAGMENTATION_THRESHOLD
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_FRAGMENTATION_THRESHOLD
)

	)

249 
	#RT_OID_802_11_RTS_THRESHOLD
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_RTS_THRESHOLD
)

	)

250 
	#RT_OID_802_11_RX_ANTENNA_SELECTED
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_RX_ANTENNA_SELECTED
)

	)

251 
	#RT_OID_802_11_TX_ANTENNA_SELECTED
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_TX_ANTENNA_SELECTED
)

	)

252 
	#RT_OID_802_11_SUPPORTED_RATES
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_SUPPORTED_RATES
)

	)

253 
	#RT_OID_802_11_DESIRED_RATES
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_DESIRED_RATES
)

	)

254 
	#RT_OID_802_11_CONFIGURATION
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_CONFIGURATION
)

	)

255 
	#RT_OID_802_11_POWER_MODE
 (
OID_GET_SET_TOGGLE
 | 
OID_802_11_POWER_MODE
)

	)

257 
	#RT_OID_802_11_QUERY_PREAMBLE
 0x0D710101

	)

258 
	#RT_OID_802_11_SET_PREAMBLE
 (
OID_GET_SET_TOGGLE
 | 
RT_OID_802_11_QUERY_PREAMBLE
)

	)

260 
	#RT_OID_802_11_QUERY_AC_CAM
 0x0D710104

	)

261 
	#RT_OID_802_11_SET_AC_CAM
 (
OID_GET_SET_TOGGLE
 | 
RT_OID_802_11_QUERY_AC_CAM
)

	)

262 #ifde‡
DBG


263 
	#RT_OID_802_11_QUERY_HARDWARE_REGISTER
 0x0D710105

	)

264 
	#RT_OID_802_11_SET_HARDWARE_REGISTER
 (
OID_GET_SET_TOGGLE
 | 
RT_OID_802_11_QUERY_HARDWARE_REGISTER
)

	)

266 
	#RT_OID_802_11_QUERY_RACONFIG
 0x0D710106

	)

267 
	#RT_OID_802_11_SET_RACONFIG
 (
OID_GET_SET_TOGGLE
 | 
RT_OID_802_11_QUERY_RACONFIG
)

	)

269 
	#RT_OID_802_11_QUERY_COUNTRY_REGION
 0x0D710107

	)

270 
	#RT_OID_802_11_SET_COUNTRY_REGION
 (
OID_GET_SET_TOGGLE
 | 
RT_OID_802_11_QUERY_COUNTRY_REGION
)

	)

272 
	#RT_OID_802_11_QUERY_RADIO
 0x0D710108

	)

273 
	#RT_OID_802_11_SET_RADIO
 (
OID_GET_SET_TOGGLE
 | 
RT_OID_802_11_QUERY_RADIO
)

	)

275 
	#RT_OID_802_11_QUERY_PHY_MODE
 0x0D71010C

	)

276 
	#RT_OID_802_11_SET_PHY_MODE
 (
OID_GET_SET_TOGGLE
 | 
RT_OID_802_11_QUERY_PHY_MODE
)

	)

278 
	#RT_OID_802_11_QUERY_STA_CONFIG
 0x0D710111

	)

279 
	#RT_OID_802_11_SET_STA_CONFIG
 (
OID_GET_SET_TOGGLE
 | 
RT_OID_802_11_QUERY_STA_CONFIG
)

	)

282 
	#RT_OID_802_11_QUERY_GEN_MIC_ERROR
 0x0D710115

	)

283 
	#RT_OID_802_11_SET_GEN_MIC_ERROR
 (
OID_GET_SET_TOGGLE
 | 
RT_OID_802_11_QUERY_GEN_MIC_ERROR
)

	)

285 
	#RT_OID_802_11_QUERY_CURRENT_CHANNEL_ID
 0x0D710117

	)

287 
	#RT_OID_802_11_RSSI_2
 0x0D710125

	)

288 
	#RT_OID_802_11_SET_TX_RATES
 (
OID_GET_SET_TOGGLE
 | 0x0D710127)

	)

289 
	#RT_OID_802_11_QUERY_IEEE80211H
 0x0D710128

	)

290 
	#RT_OID_802_11_SET_IEEE80211H
 (
OID_GET_SET_TOGGLE
 | 
RT_OID_802_11_QUERY_IEEE80211H
)

	)

293 
	#RT_ASSOC_EVENT_FLAG
 0x0101

	)

294 
	#RT_DISASSOC_EVENT_FLAG
 0x0102

	)

295 
	#RT_REQIE_EVENT_FLAG
 0x0103

	)

296 
	#RT_RESPIE_EVENT_FLAG
 0x0104

	)

297 
	#RT_ASSOCINFO_EVENT_FLAG
 0x0105

	)

298 
	#RT_PMKIDCAND_FLAG
 0x0106

	)

306 
	#NDIS_802_11_LENGTH_SSID
 32

	)

307 
	#NDIS_802_11_LENGTH_RATES
 8

	)

308 
	#NDIS_802_11_LENGTH_RATES_EX
 16

	)

310 
	e_NDIS_802_11_STATUS_TYPE


312 
	mNdis802_11SètusTy≥_Authítiˇti⁄
,

313 
	mNdis802_11SètusTy≥_MedüSåómMode
,

314 
	mNdis802_11SètusTy≥_PMKID_C™did©eLi°
,

315 
	mNdis802_11SètusTy≥Max


316 } 
	tNDIS_802_11_STATUS_TYPE
, *
	tPNDIS_802_11_STATUS_TYPE
;

319 
UCHAR
 
	tNDIS_802_11_MAC_ADDRESS
[6];

321 
	s_NDIS_802_11_STATUS_INDICATION


323 
NDIS_802_11_STATUS_TYPE
 
	mSètusTy≥
;

324 } 
	tNDIS_802_11_STATUS_INDICATION
, *
	tPNDIS_802_11_STATUS_INDICATION
;

327 
	#NDIS_802_11_AUTH_REQUEST_AUTH_FIELDS
 0x0f

	)

329 
	#NDIS_802_11_AUTH_REQUEST_REAUTH
 0x01

	)

330 
	#NDIS_802_11_AUTH_REQUEST_KEYUPDATE
 0x02

	)

331 
	#NDIS_802_11_AUTH_REQUEST_PAIRWISE_ERROR
 0x06

	)

332 
	#NDIS_802_11_AUTH_REQUEST_GROUP_ERROR
 0x0E

	)

334 
	s_NDIS_802_11_AUTHENTICATION_REQUEST


336 
ULONG
 
	mLígth
;

337 
NDIS_802_11_MAC_ADDRESS
 
	mBssid
;

338 
ULONG
 
	mFœgs
;

339 } 
	tNDIS_802_11_AUTHENTICATION_REQUEST
, *
	tPNDIS_802_11_AUTHENTICATION_REQUEST
;

342 
	e_NDIS_802_11_NETWORK_TYPE


344 
	mNdis802_11FH
,

345 
	mNdis802_11DS
,

346 
	mNdis802_11OFDM5
,

347 
	mNdis802_11OFDM24
,

348 
	mNdis802_11Automode
,

349 
	mNdis802_11Nëw‹kTy≥Max


350 } 
	tNDIS_802_11_NETWORK_TYPE
, *
	tPNDIS_802_11_NETWORK_TYPE
;

352 
PACKED
 
	t_NDIS_802_11_NETWORK_TYPE_LIST


354 
ULONG
 
	gNumbîOfIãms
;

355 
NDIS_802_11_NETWORK_TYPE
 
	gNëw‹kTy≥
 [1];

356 } 
	tNDIS_802_11_NETWORK_TYPE_LIST
, *
	tPNDIS_802_11_NETWORK_TYPE_LIST
;

358 
	e_NDIS_802_11_POWER_MODE


360 
	mNdis802_11PowîModeCAM
,

361 
	mNdis802_11PowîModeMAX_PSP
,

362 
	mNdis802_11PowîModeFa°_PSP
,

363 
	mNdis802_11PowîModeMax


364 } 
	tNDIS_802_11_POWER_MODE
, *
	tPNDIS_802_11_POWER_MODE
;

366 
ULONG
 
	tNDIS_802_11_TX_POWER_LEVEL
;

371 
LONG
 
	tNDIS_802_11_RSSI
;

373 
	s_NDIS_802_11_CONFIGURATION_FH


375 
ULONG
 
	mLígth
;

376 
ULONG
 
	mH›P©ã∫
;

377 
ULONG
 
	mH›Së
;

378 
ULONG
 
	mDwñlTime
;

379 } 
	tNDIS_802_11_CONFIGURATION_FH
, *
	tPNDIS_802_11_CONFIGURATION_FH
;

381 
	s_NDIS_802_11_CONFIGURATION


383 
ULONG
 
	mLígth
;

384 
ULONG
 
	mBóc⁄Pîiod
;

385 
ULONG
 
	mATIMWödow
;

386 
ULONG
 
	mDSC⁄fig
;

387 
NDIS_802_11_CONFIGURATION_FH
 
	mFHC⁄fig
;

388 } 
	tNDIS_802_11_CONFIGURATION
, *
	tPNDIS_802_11_CONFIGURATION
;

390 
	s_NDIS_802_11_STATISTICS


392 
ULONG
 
	mLígth
;

393 
LARGE_INTEGER
 
	mTønsmôãdFøgmítCou¡
;

394 
LARGE_INTEGER
 
	mMu…iˇ°TønsmôãdFømeCou¡
;

395 
LARGE_INTEGER
 
	mFaûedCou¡
;

396 
LARGE_INTEGER
 
	mRëryCou¡
;

397 
LARGE_INTEGER
 
	mMu…ùÀRëryCou¡
;

398 
LARGE_INTEGER
 
	mRTSSuc˚ssCou¡
;

399 
LARGE_INTEGER
 
	mRTSFaûuªCou¡
;

400 
LARGE_INTEGER
 
	mACKFaûuªCou¡
;

401 
LARGE_INTEGER
 
	mFømeDu∂iˇãCou¡
;

402 
LARGE_INTEGER
 
	mRe˚ivedFøgmítCou¡
;

403 
LARGE_INTEGER
 
	mMu…iˇ°Re˚ivedFømeCou¡
;

404 
LARGE_INTEGER
 
	mFCSEº‹Cou¡
;

405 } 
	tNDIS_802_11_STATISTICS
, *
	tPNDIS_802_11_STATISTICS
;

407 
ULONG
 
	tNDIS_802_11_KEY_INDEX
;

408 
ULONGLONG
 
	tNDIS_802_11_KEY_RSC
;

411 
PACKED
 
	t_NDIS_802_11_KEY


413 
ULONG
 
	gLígth
;

414 
ULONG
 
	gKeyIndex
;

415 
ULONG
 
	gKeyLígth
;

416 
NDIS_802_11_MAC_ADDRESS
 
	gBSSID
;

417 
NDIS_802_11_KEY_RSC
 
	gKeyRSC
;

418 
UCHAR
 
	gKeyM©îül
[1];

419 } 
	tNDIS_802_11_KEY
, *
	tPNDIS_802_11_KEY
;

421 
	s_NDIS_802_11_REMOVE_KEY


423 
ULONG
 
	mLígth
;

424 
ULONG
 
	mKeyIndex
;

425 
NDIS_802_11_MAC_ADDRESS
 
	mBSSID
;

426 } 
	tNDIS_802_11_REMOVE_KEY
, *
	tPNDIS_802_11_REMOVE_KEY
;

428 
PACKED
 
	t_NDIS_802_11_WEP


430 
ULONG
 
	gLígth
;

431 
ULONG
 
	gKeyIndex
;

432 
ULONG
 
	gKeyLígth
;

433 
UCHAR
 
	gKeyM©îül
[1];

434 } 
	tNDIS_802_11_WEP
, *
	tPNDIS_802_11_WEP
;

437 
	e_NDIS_802_11_NETWORK_INFRASTRUCTURE


439 
	mNdis802_11IBSS
,

440 
	mNdis802_11In‰a°ru˘uª
,

441 
	mNdis802_11AutoUnknown
,

442 
	mNdis802_11In‰a°ru˘uªMax


443 } 
	tNDIS_802_11_NETWORK_INFRASTRUCTURE
, *
	tPNDIS_802_11_NETWORK_INFRASTRUCTURE
;

446 
UCHAR
 
	tNDIS_802_11_PMKID_VALUE
[16];

448 
	s_BSSID_INFO


450 
NDIS_802_11_MAC_ADDRESS
 
	mBSSID
;

451 
NDIS_802_11_PMKID_VALUE
 
	mPMKID
;

452 } 
	tBSSID_INFO
, *
	tPBSSID_INFO
;

454 
	s_NDIS_802_11_PMKID


456 
ULONG
 
	mLígth
;

457 
ULONG
 
	mBSSIDInfoCou¡
;

458 
BSSID_INFO
 
	mBSSIDInfo
[1];

459 } 
	tNDIS_802_11_PMKID
, *
	tPNDIS_802_11_PMKID
;

462 
	s_PMKID_CANDIDATE
 {

463 
NDIS_802_11_MAC_ADDRESS
 
	mBSSID
;

464 
ULONG
 
	mFœgs
;

465 } 
	tPMKID_CANDIDATE
, *
	tPPMKID_CANDIDATE
;

467 
	s_NDIS_802_11_PMKID_CANDIDATE_LIST


469 
ULONG
 
	mVîsi⁄
;

470 
ULONG
 
	mNumC™did©es
;

471 
PMKID_CANDIDATE
 
	mC™did©eLi°
[1];

472 } 
	tNDIS_802_11_PMKID_CANDIDATE_LIST
, *
	tPNDIS_802_11_PMKID_CANDIDATE_LIST
;

475 
	#NDIS_802_11_PMKID_CANDIDATE_PREAUTH_ENABLED
 0x01

	)

479 
	e_NDIS_802_11_AUTHENTICATION_MODE


481 
	mNdis802_11AuthModeO≥n
,

482 
	mNdis802_11AuthModeSh¨ed
,

483 
	mNdis802_11AuthModeAutoSwôch
,

484 
	mNdis802_11AuthModeWPA
,

485 
	mNdis802_11AuthModeWPAPSK
,

486 
	mNdis802_11AuthModeWPAN⁄e
,

487 
	mNdis802_11AuthModeWPA2
,

488 
	mNdis802_11AuthModeWPA2PSK
,

489 
	mNdis802_11AuthModeMax


490 } 
	tNDIS_802_11_AUTHENTICATION_MODE
, *
	tPNDIS_802_11_AUTHENTICATION_MODE
;

492 
	#WPA1AKMBIT
 1

	)

493 
	#WPA2AKMBIT
 2

	)

494 
	#WPA1PSKAKMBIT
 4

	)

495 
	#WPA2PSKAKMBIT
 8

	)

497 
	#TKIPBIT
 0x01

	)

498 
	#CCMPBIT
 0x02

	)

500 
UCHAR
 
	tNDIS_802_11_RATES
[
NDIS_802_11_LENGTH_RATES
];

501 
UCHAR
 
	tNDIS_802_11_RATES_EX
[
NDIS_802_11_LENGTH_RATES_EX
];

503 
PACKED
 
	t_NDIS_802_11_SSID


505 
ULONG
 
	gSsidLígth
;

506 
UCHAR
 
	gSsid
[
NDIS_802_11_LENGTH_SSID
];

507 } 
	tNDIS_802_11_SSID
, *
	tPNDIS_802_11_SSID
;

510 
PACKED
 
	t_NDIS_WLAN_BSSID


512 
ULONG
 
	gLígth
;

513 
NDIS_802_11_MAC_ADDRESS
 
	gMacAddªss
;

514 
UCHAR
 
	gRe£rved
[2];

515 
NDIS_802_11_SSID
 
	gSsid
;

516 
ULONG
 
	gPrivacy
;

517 
NDIS_802_11_RSSI
 
	gRssi
;

518 
NDIS_802_11_NETWORK_TYPE
 
	gNëw‹kTy≥InU£
;

519 
NDIS_802_11_CONFIGURATION
 
	gC⁄figuøti⁄
;

520 
NDIS_802_11_NETWORK_INFRASTRUCTURE
 
	gIn‰a°ru˘uªMode
;

521 
NDIS_802_11_RATES
 
	gSuµ‹ãdR©es
;

522 } 
	tNDIS_WLAN_BSSID
, *
	tPNDIS_WLAN_BSSID
;

524 
PACKED
 
	t_NDIS_802_11_BSSID_LIST


526 
ULONG
 
	gNumbîOfIãms
;

527 
NDIS_WLAN_BSSID
 
	gBssid
[1];

528 } 
	tNDIS_802_11_BSSID_LIST
, *
	tPNDIS_802_11_BSSID_LIST
;

531 
PACKED
 
	t_NDIS_WLAN_BSSID_EX


533 
ULONG
 
	gLígth
;

534 
NDIS_802_11_MAC_ADDRESS
 
	gMacAddªss
;

535 
UCHAR
 
	gRe£rved
[2];

536 
NDIS_802_11_SSID
 
	gSsid
;

537 
ULONG
 
	gPrivacy
;

538 
NDIS_802_11_RSSI
 
	gRssi
;

540 
NDIS_802_11_NETWORK_TYPE
 
	gNëw‹kTy≥InU£
;

541 
NDIS_802_11_CONFIGURATION
 
	gC⁄figuøti⁄
;

542 
NDIS_802_11_NETWORK_INFRASTRUCTURE
 
	gIn‰a°ru˘uªMode
;

543 
NDIS_802_11_RATES_EX
 
	gSuµ‹ãdR©es
;

544 
ULONG
 
	gIELígth
;

545 
UCHAR
 
	gIEs
[1];

546 } 
	tNDIS_WLAN_BSSID_EX
, *
	tPNDIS_WLAN_BSSID_EX
;

548 
	s_NDIS_802_11_BSSID_LIST_EX


550 
ULONG
 
	mNumbîOfIãms
;

551 
NDIS_WLAN_BSSID_EX
 
	mBssid
[1];

552 } 
	tNDIS_802_11_BSSID_LIST_EX
, *
	tPNDIS_802_11_BSSID_LIST_EX
;

554 
	s_NDIS_802_11_FIXED_IEs


556 
UCHAR
 
	mTime°amp
[8];

557 
USHORT
 
	mBóc⁄I¡îvÆ
;

558 
USHORT
 
	mC≠abûôõs
;

559 } 
	tNDIS_802_11_FIXED_IEs
, *
	tPNDIS_802_11_FIXED_IEs
;

561 
	s_NDIS_802_11_VARIABLE_IEs


563 
UCHAR
 
	mEÀmítID
;

564 
UCHAR
 
	mLígth
;

565 
UCHAR
 
	md©a
[1];

566 } 
	tNDIS_802_11_VARIABLE_IEs
, *
	tPNDIS_802_11_VARIABLE_IEs
;

568 
ULONG
 
	tNDIS_802_11_FRAGMENTATION_THRESHOLD
;

570 
ULONG
 
	tNDIS_802_11_RTS_THRESHOLD
;

572 
ULONG
 
	tNDIS_802_11_ANTENNA
;

574 
	e_NDIS_802_11_PRIVACY_FILTER


576 
	mNdis802_11PrivFûãrAc˚±AŒ
,

577 
	mNdis802_11PrivFûãr8021xWEP


578 } 
	tNDIS_802_11_PRIVACY_FILTER
, *
	tPNDIS_802_11_PRIVACY_FILTER
;

582 
	e_NDIS_802_11_WEP_STATUS


584 
	mNdis802_11WEPE«bÀd
,

585 
	mNdis802_11En¸y±i⁄1E«bÀd
 = 
Ndis802_11WEPE«bÀd
,

586 
	mNdis802_11WEPDißbÀd
,

587 
	mNdis802_11En¸y±i⁄DißbÀd
 = 
Ndis802_11WEPDißbÀd
,

588 
	mNdis802_11WEPKeyAb£¡
,

589 
	mNdis802_11En¸y±i⁄1KeyAb£¡
 = 
Ndis802_11WEPKeyAb£¡
,

590 
	mNdis802_11WEPNŸSuµ‹ãd
,

591 
	mNdis802_11En¸y±i⁄NŸSuµ‹ãd
 = 
Ndis802_11WEPNŸSuµ‹ãd
,

592 
	mNdis802_11En¸y±i⁄2E«bÀd
,

593 
	mNdis802_11En¸y±i⁄2KeyAb£¡
,

594 
	mNdis802_11En¸y±i⁄3E«bÀd
,

595 
	mNdis802_11En¸y±i⁄3KeyAb£¡


596 } 
	tNDIS_802_11_WEP_STATUS
, *
	tPNDIS_802_11_WEP_STATUS
,

597 
	tNDIS_802_11_ENCRYPTION_STATUS
, *
	tPNDIS_802_11_ENCRYPTION_STATUS
;

599 
	e_NDIS_802_11_RELOAD_DEFAULTS


601 
	mNdis802_11RñﬂdWEPKeys


602 } 
	tNDIS_802_11_RELOAD_DEFAULTS
, *
	tPNDIS_802_11_RELOAD_DEFAULTS
;

604 
	#NDIS_802_11_AI_REQFI_CAPABILITIES
 1

	)

605 
	#NDIS_802_11_AI_REQFI_LISTENINTERVAL
 2

	)

606 
	#NDIS_802_11_AI_REQFI_CURRENTAPADDRESS
 4

	)

608 
	#NDIS_802_11_AI_RESFI_CAPABILITIES
 1

	)

609 
	#NDIS_802_11_AI_RESFI_STATUSCODE
 2

	)

610 
	#NDIS_802_11_AI_RESFI_ASSOCIATIONID
 4

	)

612 
	s_NDIS_802_11_AI_REQFI


614 
USHORT
 
	mC≠abûôõs
;

615 
USHORT
 
	mLi°íI¡îvÆ
;

616 
NDIS_802_11_MAC_ADDRESS
 
	mCuºítAPAddªss
;

617 } 
	tNDIS_802_11_AI_REQFI
, *
	tPNDIS_802_11_AI_REQFI
;

619 
	s_NDIS_802_11_AI_RESFI


621 
USHORT
 
	mC≠abûôõs
;

622 
USHORT
 
	mSètusCode
;

623 
USHORT
 
	mAssocüti⁄Id
;

624 } 
	tNDIS_802_11_AI_RESFI
, *
	tPNDIS_802_11_AI_RESFI
;

626 
	s_NDIS_802_11_ASSOCIATION_INFORMATION


628 
ULONG
 
	mLígth
;

629 
USHORT
 
	mAvaûabÀReque°FixedIEs
;

630 
NDIS_802_11_AI_REQFI
 
	mReque°FixedIEs
;

631 
ULONG
 
	mReque°IELígth
;

632 
ULONG
 
	mOff£tReque°IEs
;

633 
USHORT
 
	mAvaûabÀRe•⁄£FixedIEs
;

634 
NDIS_802_11_AI_RESFI
 
	mRe•⁄£FixedIEs
;

635 
ULONG
 
	mRe•⁄£IELígth
;

636 
ULONG
 
	mOff£tRe•⁄£IEs
;

637 } 
	tNDIS_802_11_ASSOCIATION_INFORMATION
, *
	tPNDIS_802_11_ASSOCIATION_INFORMATION
;

639 
	s_NDIS_802_11_AUTHENTICATION_EVENT


641 
NDIS_802_11_STATUS_INDICATION
 
	mSètus
;

642 
NDIS_802_11_AUTHENTICATION_REQUEST
 
	mReque°
[1];

643 } 
	tNDIS_802_11_AUTHENTICATION_EVENT
, *
	tPNDIS_802_11_AUTHENTICATION_EVENT
;

645 
	s_NDIS_802_11_TEST


647 
ULONG
 
	mLígth
;

648 
ULONG
 
	mTy≥
;

651 
NDIS_802_11_AUTHENTICATION_EVENT
 
	mAuthítiˇti⁄Evít
;

652 
NDIS_802_11_RSSI
 
	mRssiTriggî
;

653 }
	mâ
;

654 } 
	tNDIS_802_11_TEST
, *
	tPNDIS_802_11_TEST
;

656 
	e_RT_802_11_PREAMBLE
 {

657 
	mRt802_11PªambÀL⁄g
,

658 
	mRt802_11PªambÀSh‹t
,

659 
	mRt802_11PªambÀAuto


660 } 
	tRT_802_11_PREAMBLE
, *
	tPRT_802_11_PREAMBLE
;

663 
	e_RT_802_11_PHY_MODE
 {

664 
	mPHY_11BG_MIXED
,

665 
	mPHY_11B
,

666 
	mPHY_11A
,

667 
	mPHY_11ABG_MIXED
,

668 
	mPHY_11G


669 } 
	tRT_802_11_PHY_MODE
;

671 
	e_RT_802_11_ADHOC_MODE
 {

672 
	mADHOC_11B
,

673 
	mADHOC_11BG_MIXED
,

674 
	mADHOC_11G
,

675 
	mADHOC_11A
,

676 
	mADHOC_11ABG_MIXED


677 } 
	tRT_802_11_ADHOC_MODE
;

680 
	s_RT_802_11_LINK_STATUS
 {

681 
ULONG
 
	mCuºTxR©e
;

682 
ULONG
 
	mCh™√lQuÆôy
;

683 
ULONG
 
	mTxByãCou¡
;

684 
ULONG
 
	mRxByãCou¡
;

685 } 
	tRT_802_11_LINK_STATUS
, *
	tPRT_802_11_LINK_STATUS
;

688 
	s_RT_802_11_HARDWARE_REGISTER
 {

689 
ULONG
 
	mH¨dw¨eTy≥
;

690 
ULONG
 
	mOff£t
;

691 
ULONG
 
	mD©a
;

692 } 
	tRT_802_11_HARDWARE_REGISTER
, *
	tPRT_802_11_HARDWARE_REGISTER
;

704 
	s_RT_802_11_STA_CONFIG
 {

705 
ULONG
 
	mE«bÀTxBur°
;

706 
ULONG
 
	mE«bÀTurboR©e
;

707 
ULONG
 
	mU£BGPrŸe˘i⁄
;

708 
ULONG
 
	mU£Sh‹tSlŸTime
;

709 
ULONG
 
	mAdhocMode
;

710 
ULONG
 
	mHwRadioSètus
;

711 
ULONG
 
	mRsv1
;

712 
ULONG
 
	mSy°emEº‹Bôm≠
;

713 } 
	tRT_802_11_STA_CONFIG
, *
	tPRT_802_11_STA_CONFIG
;

715 
PACKED
 
	t_RT_VERSION_INFO
{

716 
UCHAR
 
	gDrivîVîsi⁄W
;

717 
UCHAR
 
	gDrivîVîsi⁄X
;

718 
UCHAR
 
	gDrivîVîsi⁄Y
;

719 
UCHAR
 
	gDrivîVîsi⁄Z
;

720 
UINT
 
	gDrivîBuûdYór
;

721 
UINT
 
	gDrivîBuûdM⁄th
;

722 
UINT
 
	gDrivîBuûdDay
;

723 } 
	tRT_VERSION_INFO
, *
	tPRT_VERSION_INFO
;

728 
	e_NDIS_MEDIA_STATE


730 
	mNdisMedüSèãC⁄√˘ed
,

731 
	mNdisMedüSèãDisc⁄√˘ed


732 } 
	tNDIS_MEDIA_STATE
, *
	tPNDIS_MEDIA_STATE
;

737 
	#GENERAL_LINK_UP
 0x0

738 
	#GENERAL_LINK_DOWN
 0x1

739 
	#HW_RADIO_OFF
 0x2

740 
	#SW_RADIO_OFF
 0x3

741 
	#AUTH_FAIL
 0x4

742 
	#AUTH_FAIL_KEYS
 0x5

743 
	#ASSOC_FAIL
 0x6

744 
	#EAP_MIC_FAILURE
 0x7

745 
	#EAP_4WAY_TIMEOUT
 0x8

746 
	#EAP_GROUP_KEY_TIMEOUT
 0x9

747 
	#EAP_SUCCESS
 0xa

748 
	#DETECT_RADAR_SIGNAL
 0xb

749 

	)

750 
	#EXTRA_INFO_CLEAR
 0xffffffff

	)

	@rt73.h

40 #i‚def 
__RT73_H__


41 
	#__RT73_H__


	)

48 
	#FIRMWARE_IMAGE_BASE
 0x800

	)

49 
	#MAX_FIRMWARE_IMAGE_SIZE
 2048

50 

	)

55 
	#SHARED_KEY_TABLE_BASE
 0x1000

56 
	#PAIRWISE_KEY_TABLE_BASE
 0x1200

57 
	#PAIRWISE_TA_TABLE_BASE
 0x1a00

58 

	)

60 
	s_HW_KEY_ENTRY
 {

61 
UCHAR
 
	mKey
[16];

62 
UCHAR
 
	mTxMic
[8];

63 
UCHAR
 
	mRxMic
[8];

64 } 
	tHW_KEY_ENTRY
, *
	tPHW_KEY_ENTRY
;

65 
	#HW_KEY_ENTRY_SIZE
 (
HW_KEY_ENTRY
)

	)

68 
	s_HW_PAIRWISE_TA_ENTRY
 {

69 
UCHAR
 
	mAddªss
[6];

70 
UCHAR
 
	mRsv
[2];

71 } 
	tHW_PAIRWISE_TA_ENTRY
, 
	tPHW_PAIRWISE_TA_ENTRY
;

72 
	#HW_PAIRWISE_TA_ENTRY_SIZE
 (
HW_PAIRWISE_TA_ENTRY
)

	)

74 
	#HW_DEBUG_SETTING_BASE
 0x2bf0

75 
	#HW_DEBUG_SETTING_END
 0x2bff

	)

78 
	#HW_BEACON_BASE0
 0x2400

	)

79 
	#HW_BEACON_BASE1
 0x2500

	)

80 
	#HW_BEACON_BASE2
 0x2600

	)

81 
	#HW_BEACON_BASE3
 0x2700

	)

86 
	#MAC_CSR0
 0x3000

	)

87 
	#MAC_CSR1
 0x3004

	)

88 
	#MAC_CSR2
 0x3008

	)

89 
	#MAC_CSR3
 0x300c

	)

90 
	#MAC_CSR4
 0x3010

	)

91 
	#MAC_CSR5
 0x3014

	)

92 
	#MAC_CSR6
 0x3018

	)

93 
	#MAC_CSR7
 0x301c

	)

94 
	#MAC_CSR8
 0x3020

95 
	#MAC_CSR9
 0x3024

	)

96 
	#MAC_CSR10
 0x3028

97 
	#MAC_CSR11
 0x302c

98 
	#MAC_CSR12
 0x3030

99 
	#MAC_CSR13
 0x3034

100 
	#MAC_CSR14
 0x3038

101 
	#MAC_CSR15
 0x303c

102 

	)

106 
	#TXRX_CSR0
 0x3040

	)

107 
	#TXRX_CSR1
 0x3044

	)

108 
	#TXRX_CSR2
 0x3048

	)

109 
	#TXRX_CSR3
 0x304c

	)

110 
	#TXRX_CSR4
 0x3050

	)

111 
	#TXRX_CSR5
 0x3054

	)

112 
	#TXRX_CSR6
 0x3058

113 
	#TXRX_CSR7
 0x305c

114 
	#TXRX_CSR8
 0x3060

115 
	#TXRX_CSR9
 0x3064

116 
	#TXRX_CSR10
 0x3068

117 
	#TXRX_CSR11
 0x306c

118 
	#TXRX_CSR12
 0x3070

119 
	#TXRX_CSR13
 0x3074

120 
	#TXRX_CSR14
 0x3078

121 
	#TXRX_CSR15
 0x307c

122 

	)

126 
	#PHY_CSR0
 0x3080

127 
	#PHY_CSR1
 0x3084

	)

128 
	#PHY_CSR2
 0x3088

129 
	#PHY_CSR3
 0x308c

130 
	#PHY_CSR4
 0x3090

131 
	#PHY_CSR5
 0x3094

132 
	#PHY_CSR6
 0x3098

133 
	#PHY_CSR7
 0x309c

134 

	)

138 
	#SEC_CSR0
 0x30a0

139 
	#SEC_CSR1
 0x30a4

140 
	#SEC_CSR2
 0x30a8

141 
	#SEC_CSR3
 0x30ac

142 
	#SEC_CSR4
 0x30b0

143 
	#SEC_CSR5
 0x30b4

144 

	)

148 
	#STA_CSR0
 0x30c0

149 
	#STA_CSR1
 0x30c4

150 
	#STA_CSR2
 0x30c8

151 
	#STA_CSR3
 0x30cc

152 
	#STA_CSR4
 0x30d0

153 
	#STA_CSR5
 0x30d4

154 

	)

158 
	#QOS_CSR0
 0x30e0

159 
	#QOS_CSR1
 0x30e4

160 
	#QOS_CSR2
 0x30e8

161 
	#QOS_CSR3
 0x30ec

162 
	#QOS_CSR4
 0x30f0

163 
	#QOS_CSR5
 0x30f4

164 

	)

169 
	#AIFSN_CSR
 0x0400

	)

170 
	#CWMIN_CSR
 0x0404

	)

171 
	#CWMAX_CSR
 0x0408

	)

172 
	#AC_TXOP_CSR0
 0x040c

	)

173 
	#AC_TXOP_CSR1
 0x0410

	)

181 
	#DESC_OWN_HOST
 0

	)

182 
	#DESC_OWN_NIC
 1

	)

186 
	#PID_DATA_REQUIRE_ACK
 0x00

187 
	#PID_DATA_WITHOUT_ACK
 0x40

188 
	#PID_NULL_AT_HIGH_RATE
 0x80

	)

189 
	#PID_RTS_FRAME
 0x81

	)

190 
	#PID_MGMT_FRAME
 0x82

	)

191 
	#PID_CNTL_FRAME
 0x83

192 
	#PID_MCU_INTERNAL
 0xff

193 

	)

198 
	#PTYPE_DATA_REQUIRE_ACK
 0x00

199 
	#PTYPE_NULL_AT_HIGH_RATE
 0x40

200 
	#PTYPE_RESERVED
 0x80

201 
	#PTYPE_SPECIAL
 0xc0

202 

	)

204 
	#PSUBTYPE_DATA_NO_ACK
 0x00

	)

205 
	#PSUBTYPE_MGMT
 0x01

	)

206 
	#PSUBTYPE_OTHER_CNTL
 0x02

	)

207 
	#PSUBTYPE_RTS
 0x03

	)

208 
	#PSUBTYPE_MCU_INTERNAL
 0x04

	)

212 
	#QID_AC_BK
 1

213 
	#QID_AC_BE
 0

214 
	#QID_AC_VI
 2

	)

215 
	#QID_AC_VO
 3

	)

216 
	#QID_HCCA
 4

	)

217 
	#NUM_OF_TX_RING
 5

	)

218 
	#QID_MGMT
 13

	)

219 
	#QID_RX
 14

	)

220 
	#QID_OTHER
 15

	)

225 
	#BUSY
 1

	)

226 
	#IDLE
 0

	)

228 
	#BBP_R0
 0

229 
	#BBP_R1
 1

230 
	#BBP_R2
 2

231 
	#BBP_R3
 3

	)

232 
	#BBP_R4
 4

	)

233 
	#BBP_R5
 5

	)

234 
	#BBP_R6
 6

	)

235 
	#BBP_R14
 14

236 
	#BBP_R16
 16

	)

237 
	#BBP_R17
 17

238 
	#BBP_R18
 18

	)

239 
	#BBP_R21
 21

	)

240 
	#BBP_R22
 22

	)

241 
	#BBP_R32
 32

	)

242 
	#BBP_R62
 62

243 
	#BBP_R64
 64

	)

244 
	#BBP_R66
 66

	)

245 
	#BBP_R70
 70

246 
	#BBP_R77
 77

	)

247 
	#BBP_R82
 82

	)

248 
	#BBP_R83
 83

	)

249 
	#BBP_R84
 84

	)

250 
	#BBP_R94
 94

251 

	)

252 
	#BBPR94_DEFAULT
 0x06

253 

	)

254 
	#RSSI_FOR_VERY_LOW_SENSIBILITY
 -35

	)

255 
	#RSSI_FOR_LOW_SENSIBILITY
 -58

	)

256 
	#RSSI_FOR_MID_LOW_SENSIBILITY
 -66

	)

257 
	#RSSI_FOR_MID_SENSIBILITY
 -74

	)

262 
	#EEDO
 0x10

	)

263 
	#EEDI
 0x08

	)

264 
	#EECS
 0x04

	)

265 
	#EESK
 0x02

	)

266 
	#EERL
 0x01

	)

268 
	#EEPROM_WRITE_OPCODE
 0x05

	)

269 
	#EEPROM_READ_OPCODE
 0x06

	)

270 
	#EEPROM_EWDS_OPCODE
 0x10

	)

271 
	#EEPROM_EWEN_OPCODE
 0x13

	)

273 
	#NUM_EEPROM_BBP_PARMS
 19

	)

274 
	#NUM_EEPROM_TX_G_PARMS
 7

	)

275 
	#NUM_EEPROM_BBP_TUNING_PARMS
 7

	)

276 
	#EEPROM_VERSION_OFFSET
 0x2

	)

277 
	#EEPROM_MAC_ADDRESS_BASE_OFFSET
 0x4

	)

278 
	#EEPROM_BBP_BASE_OFFSET
 0x20

	)

279 
	#EEPROM_G_TX_PWR_OFFSET
 0x46

	)

280 
	#EEPROM_FREQ_OFFSET
 0x5e

	)

281 
	#EEPROM_LED_OFFSET
 0x60

	)

282 
	#EEPROM_A_TX_PWR_OFFSET
 0x62

	)

283 
	#EEPROM_J52_TX_PWR_OFFSET
 0x7C

284 
	#EEPROM_TSSI_REF_OFFSET
 0x4A

	)

285 
	#EEPROM_TSSI_DELTA_OFFSET
 0x1A

	)

287 
	#EEPROM_RSSI_BG_OFFSET
 0x9a

	)

288 
	#EEPROM_RSSI_A_OFFSET
 0x9c

	)

289 
	#EEPROM_BG_TSSI_CALIBRAION
 0x54

	)

290 
	#EEPROM_A_TSSI_CALIBRAION
 0x90

	)

291 
	#EEPROM_TXPOWER_DELTA_OFFSET
 0x9e

	)

299 
	#TXINFO_SIZE
 24

	)

304 #ifde‡
BIG_ENDIAN


305 
	s_TXD_STRUC
 {

307 
ULONG
 
	mCùhîAlg
:3;

308 
ULONG
 
	mBur°2
:1;

309 
ULONG
 
	mD©aByãC¡
:12;

310 
ULONG
 
	mKeyIndex
:6;

316 
ULONG
 
	mKeyTabÀ
:1;

317 
ULONG
 
	mTkùMic
:1;

318 
ULONG
 
	mRëryMd
:1;

319 
ULONG
 
	mIFS
:1;

320 
ULONG
 
	mOfdm
:1;

321 
ULONG
 
	mTime°amp
:1;

322 
ULONG
 
	mACK
:1;

323 
ULONG
 
	mM‹eFøg
:1;

324 
ULONG
 
	mDr›
:1;

325 
ULONG
 
	mBur°
:1;

329 
ULONG
 
	mBufCou¡
:3;

330 
ULONG
 
	mHwSeq
:1;

331 
	mULONG
 :6;

332 
ULONG
 
	mIvOff£t
:6;

333 
ULONG
 
	mCwmax
:4;

334 
ULONG
 
	mCwmö
:4;

335 
ULONG
 
	mAif¢
:4;

336 
ULONG
 
	mHo°QId
:4;

339 
ULONG
 
	mPl˝LígthHigh
:8;

340 
ULONG
 
	mPl˝LígthLow
:8;

341 
ULONG
 
	mPl˝Sîvi˚
:8;

342 
ULONG
 
	mPl˝Sig«l
:8;

345 
ULONG
 
	mIv
;

348 
ULONG
 
	mEiv
;

351 
ULONG
 
	mRe£rved
:7;

352 
ULONG
 
	mbWaôögDmaD⁄eI¡
:1;

353 
ULONG
 
	mBbpTxPowî
:8;

354 
ULONG
 
	mPktId
:8;

355 
ULONG
 
	mFømeOff£t
:8;

363 } 
	tTXD_STRUC
, *
	tPTXD_STRUC
;

365 
	s_TXD_STRUC
 {

367 
ULONG
 
	mBur°
:1;

369 
ULONG
 
	mDr›
:1;

370 
ULONG
 
	mM‹eFøg
:1;

371 
ULONG
 
	mACK
:1;

372 
ULONG
 
	mTime°amp
:1;

373 
ULONG
 
	mOfdm
:1;

374 
ULONG
 
	mIFS
:1;

375 
ULONG
 
	mRëryMd
:1;

377 
ULONG
 
	mTkùMic
:1;

378 
ULONG
 
	mKeyTabÀ
:1;

379 
ULONG
 
	mKeyIndex
:6;

385 
ULONG
 
	mD©aByãC¡
:12;

386 
ULONG
 
	mBur°2
:1;

387 
ULONG
 
	mCùhîAlg
:3;

390 
ULONG
 
	mHo°QId
:4;

391 
ULONG
 
	mAif¢
:4;

392 
ULONG
 
	mCwmö
:4;

393 
ULONG
 
	mCwmax
:4;

394 
ULONG
 
	mIvOff£t
:6;

395 
	mULONG
 :6;

396 
ULONG
 
	mHwSeq
:1;

397 
ULONG
 
	mBufCou¡
:3;

400 
ULONG
 
	mPl˝Sig«l
:8;

401 
ULONG
 
	mPl˝Sîvi˚
:8;

402 
ULONG
 
	mPl˝LígthLow
:8;

403 
ULONG
 
	mPl˝LígthHigh
:8;

406 
ULONG
 
	mIv
;

409 
ULONG
 
	mEiv
;

412 
ULONG
 
	mFømeOff£t
:8;

413 
ULONG
 
	mPktId
:8;

414 
ULONG
 
	mBbpTxPowî
:8;

415 
ULONG
 
	mbWaôögDmaD⁄eI¡
:1;

416 
ULONG
 
	mRe£rved
:7;

424 } 
	tTXD_STRUC
, *
	tPTXD_STRUC
;

430 #ifde‡
BIG_ENDIAN


431 
	s_RXD_STRUC
 {

433 
ULONG
 
	mCùhîAlg
:3;

434 
ULONG
 
	mRsv
:1;

435 
ULONG
 
	mD©aByãC¡
:12;

436 
ULONG
 
	mKeyIndex
:6;

437 
ULONG
 
	mCùhîEº
:2;

439 
ULONG
 
	mOfdm
:1;

440 
ULONG
 
	mCrc
:1;

441 
ULONG
 
	mMyBss
:1;

442 
ULONG
 
	mBˇ°
:1;

443 
ULONG
 
	mMˇ°
:1;

444 
ULONG
 
	mU2M
:1;

445 
ULONG
 
	mDr›
:1;

446 
ULONG
 
	mOw√r
:1;

449 
ULONG
 
	mRsv1
:1;

450 
ULONG
 
	mFømeOff£t
:7;

451 
ULONG
 
	mRsv0
:8;

452 
ULONG
 
	mPl˝Rssi
:8;

453 
ULONG
 
	mPl˝Sig«l
:8;

456 
ULONG
 
	mIv
;

459 
ULONG
 
	mEiv
;

462 
ULONG
 
	mRsv2
;

471 
ULONG
 
	mRsv3
;

474 
ULONG
 
	mRsv3
;

475 
ULONG
 
	mRsv4
;

476 
ULONG
 
	mRsv5
;

477 
ULONG
 
	mRsv6
;

478 
ULONG
 
	mRsv7
;

479 
ULONG
 
	mRsv8
;

480 
ULONG
 
	mRsv9
;

481 
ULONG
 
	mRsv10
;

482 
ULONG
 
	mRsv11
;

483 
ULONG
 
	mRsv12
;

485 } 
	tRXD_STRUC
, *
	tPRXD_STRUC
;

487 
	s_RXD_STRUC
 {

489 
ULONG
 
	mOw√r
:1;

490 
ULONG
 
	mDr›
:1;

491 
ULONG
 
	mU2M
:1;

492 
ULONG
 
	mMˇ°
:1;

493 
ULONG
 
	mBˇ°
:1;

494 
ULONG
 
	mMyBss
:1;

495 
ULONG
 
	mCrc
:1;

496 
ULONG
 
	mOfdm
:1;

498 
ULONG
 
	mCùhîEº
:2;

499 
ULONG
 
	mKeyIndex
:6;

500 
ULONG
 
	mD©aByãC¡
:12;

501 
ULONG
 
	mRsv
:1;

502 
ULONG
 
	mCùhîAlg
:3;

505 
ULONG
 
	mPl˝Sig«l
:8;

506 
ULONG
 
	mPl˝Rssi
:8;

507 
ULONG
 
	mRsv0
:8;

508 
ULONG
 
	mFømeOff£t
:7;

509 
ULONG
 
	mRsv1
:1;

512 
ULONG
 
	mIv
;

515 
ULONG
 
	mEiv
;

518 
ULONG
 
	mRsv2
;

527 
ULONG
 
	mRsv3
;

530 
ULONG
 
	mRsv3
;

531 
ULONG
 
	mRsv4
;

532 
ULONG
 
	mRsv5
;

533 
ULONG
 
	mRsv6
;

534 
ULONG
 
	mRsv7
;

535 
ULONG
 
	mRsv8
;

536 
ULONG
 
	mRsv9
;

537 
ULONG
 
	mRsv10
;

538 
ULONG
 
	mRsv11
;

539 
ULONG
 
	mRsv12
;

541 } 
	tRXD_STRUC
, *
	tPRXD_STRUC
;

551 #ifde‡
BIG_ENDIAN


552 
	u_H2M_MAILBOX_STRUC
 {

554 
ULONG
 
	mOw√r
:8;

555 
ULONG
 
	mCmdTokí
:8;

556 
ULONG
 
	mHighByã
:8;

557 
ULONG
 
	mLowByã
:8;

558 } 
	mfõld
;

559 
ULONG
 
	mw‹d
;

560 } 
	tH2M_MAILBOX_STRUC
, *
	tPH2M_MAILBOX_STRUC
;

562 
	u_H2M_MAILBOX_STRUC
 {

564 
ULONG
 
	mLowByã
:8;

565 
ULONG
 
	mHighByã
:8;

566 
ULONG
 
	mCmdTokí
:8;

567 
ULONG
 
	mOw√r
:8;

568 } 
	mfõld
;

569 
ULONG
 
	mw‹d
;

570 } 
	tH2M_MAILBOX_STRUC
, *
	tPH2M_MAILBOX_STRUC
;

576 #ifde‡
BIG_ENDIAN


577 
	u_M2H_CMD_DONE_STRUC
 {

579 
ULONG
 
	mCmdTokí3
;

580 
ULONG
 
	mCmdTokí2
;

581 
ULONG
 
	mCmdTokí1
;

582 
ULONG
 
	mCmdTokí0
;

583 } 
	mfõld
;

584 
ULONG
 
	mw‹d
;

585 } 
	tM2H_CMD_DONE_STRUC
, *
	tPM2H_CMD_DONE_STRUC
;

587 
	u_M2H_CMD_DONE_STRUC
 {

589 
ULONG
 
	mCmdTokí0
;

590 
ULONG
 
	mCmdTokí1
;

591 
ULONG
 
	mCmdTokí2
;

592 
ULONG
 
	mCmdTokí3
;

593 } 
	mfõld
;

594 
ULONG
 
	mw‹d
;

595 } 
	tM2H_CMD_DONE_STRUC
, *
	tPM2H_CMD_DONE_STRUC
;

601 #ifde‡
BIG_ENDIAN


602 
	u_MCU_INT_SOURCE_STRUC
 {

604 
	mULONG
 :22;

605 
ULONG
 
	mTBTTExpúe
:1;

606 
ULONG
 
	mTwakeup
:1;

607 
ULONG
 
	mMcuI¡7
:1;

608 
ULONG
 
	mMcuI¡6
:1;

609 
ULONG
 
	mMcuI¡5
:1;

610 
ULONG
 
	mMcuI¡4
:1;

611 
ULONG
 
	mMcuI¡3
:1;

612 
ULONG
 
	mMcuI¡2
:1;

613 
ULONG
 
	mMcuI¡1
:1;

614 
ULONG
 
	mMcuI¡0
:1;

615 } 
	mfõld
;

616 
ULONG
 
	mw‹d
;

617 } 
	tMCU_INT_SOURCE_STRUC
, *
	tPMCU_INT_SOURCE_STRUC
, 
	tMCU_INT_MASK_STRUC
, *
	tPMCU_INT_MASK_STRUC
;

619 
	u_MCU_INT_SOURCE_STRUC
 {

621 
ULONG
 
	mMcuI¡0
:1;

622 
ULONG
 
	mMcuI¡1
:1;

623 
ULONG
 
	mMcuI¡2
:1;

624 
ULONG
 
	mMcuI¡3
:1;

625 
ULONG
 
	mMcuI¡4
:1;

626 
ULONG
 
	mMcuI¡5
:1;

627 
ULONG
 
	mMcuI¡6
:1;

628 
ULONG
 
	mMcuI¡7
:1;

629 
ULONG
 
	mTwakeup
:1;

630 
ULONG
 
	mTBTTExpúe
:1;

631 
	mULONG
 :22;

632 } 
	mfõld
;

633 
ULONG
 
	mw‹d
;

634 } 
	tMCU_INT_SOURCE_STRUC
, *
	tPMCU_INT_SOURCE_STRUC
, 
	tMCU_INT_MASK_STRUC
, *
	tPMCU_INT_MASK_STRUC
;

641 #ifde‡
BIG_ENDIAN


642 
	u_MCU_LEDCS_STRUC
 {

644 
USHORT
 
	mPﬁ¨ôyRDY_A
:1;

645 
USHORT
 
	mPﬁ¨ôyRDY_G
:1;

646 
USHORT
 
	mPﬁ¨ôyACT
:1;

647 
USHORT
 
	mPﬁ¨ôyGPIO_4
:1;

648 
USHORT
 
	mPﬁ¨ôyGPIO_3
:1;

649 
USHORT
 
	mPﬁ¨ôyGPIO_2
:1;

650 
USHORT
 
	mPﬁ¨ôyGPIO_1
:1;

651 
USHORT
 
	mPﬁ¨ôyGPIO_0
:1;

652 
USHORT
 
	mLökASètus
:1;

653 
USHORT
 
	mLökGSètus
:1;

654 
USHORT
 
	mRadioSètus
:1;

655 
USHORT
 
	mLedMode
:5;

656 } 
	mfõld
;

657 
USHORT
 
	mw‹d
;

658 } 
	tMCU_LEDCS_STRUC
, *
	tPMCU_LEDCS_STRUC
;

660 
	u_MCU_LEDCS_STRUC
 {

662 
USHORT
 
	mLedMode
:5;

663 
USHORT
 
	mRadioSètus
:1;

664 
USHORT
 
	mLökGSètus
:1;

665 
USHORT
 
	mLökASètus
:1;

666 
USHORT
 
	mPﬁ¨ôyGPIO_0
:1;

667 
USHORT
 
	mPﬁ¨ôyGPIO_1
:1;

668 
USHORT
 
	mPﬁ¨ôyGPIO_2
:1;

669 
USHORT
 
	mPﬁ¨ôyGPIO_3
:1;

670 
USHORT
 
	mPﬁ¨ôyGPIO_4
:1;

671 
USHORT
 
	mPﬁ¨ôyACT
:1;

672 
USHORT
 
	mPﬁ¨ôyRDY_G
:1;

673 
USHORT
 
	mPﬁ¨ôyRDY_A
:1;

674 } 
	mfõld
;

675 
USHORT
 
	mw‹d
;

676 } 
	tMCU_LEDCS_STRUC
, *
	tPMCU_LEDCS_STRUC
;

686 #ifde‡
BIG_ENDIAN


687 
	u_MAC_CSR1_STRUC
 {

689 
ULONG
 
	mRsvd1
:29;

690 
ULONG
 
	mHo°Ródy
:1;

691 
ULONG
 
	mBbpRe£t
:1;

692 
ULONG
 
	mSo·Re£t
:1;

693 } 
	mfõld
;

694 
ULONG
 
	mw‹d
;

695 } 
	tMAC_CSR1_STRUC
, *
	tPMAC_CSR1_STRUC
;

697 
	u_MAC_CSR1_STRUC
 {

699 
ULONG
 
	mSo·Re£t
:1;

700 
ULONG
 
	mBbpRe£t
:1;

701 
ULONG
 
	mHo°Ródy
:1;

702 
ULONG
 
	mRsvd1
:29;

703 } 
	mfõld
;

704 
ULONG
 
	mw‹d
;

705 } 
	tMAC_CSR1_STRUC
, *
	tPMAC_CSR1_STRUC
;

711 #ifde‡
BIG_ENDIAN


712 
	u_MAC_CSR2_STRUC
 {

714 
UCHAR
 
	mByã3
;

715 
UCHAR
 
	mByã2
;

716 
UCHAR
 
	mByã1
;

717 
UCHAR
 
	mByã0
;

718 } 
	mfõld
;

719 
ULONG
 
	mw‹d
;

720 } 
	tMAC_CSR2_STRUC
, *
	tPMAC_CSR2_STRUC
;

722 
	u_MAC_CSR2_STRUC
 {

724 
UCHAR
 
	mByã0
;

725 
UCHAR
 
	mByã1
;

726 
UCHAR
 
	mByã2
;

727 
UCHAR
 
	mByã3
;

728 } 
	mfõld
;

729 
ULONG
 
	mw‹d
;

730 } 
	tMAC_CSR2_STRUC
, *
	tPMAC_CSR2_STRUC
;

736 #ifde‡
BIG_ENDIAN


737 
	u_MAC_CSR3_STRUC
 {

739 
UCHAR
 
	mRsvd1
;

740 
UCHAR
 
	mU2MeMask
;

741 
UCHAR
 
	mByã5
;

742 
UCHAR
 
	mByã4
;

743 } 
	mfõld
;

744 
ULONG
 
	mw‹d
;

745 } 
	tMAC_CSR3_STRUC
, *
	tPMAC_CSR3_STRUC
;

747 
	u_MAC_CSR3_STRUC
 {

749 
UCHAR
 
	mByã4
;

750 
UCHAR
 
	mByã5
;

751 
UCHAR
 
	mU2MeMask
;

752 
UCHAR
 
	mRsvd1
;

753 } 
	mfõld
;

754 
ULONG
 
	mw‹d
;

755 } 
	tMAC_CSR3_STRUC
, *
	tPMAC_CSR3_STRUC
;

761 #ifde‡
BIG_ENDIAN


762 
	u_MAC_CSR4_STRUC
 {

764 
UCHAR
 
	mByã3
;

765 
UCHAR
 
	mByã2
;

766 
UCHAR
 
	mByã1
;

767 
UCHAR
 
	mByã0
;

768 } 
	mfõld
;

769 
ULONG
 
	mw‹d
;

770 } 
	tMAC_CSR4_STRUC
, *
	tPMAC_CSR4_STRUC
;

772 
	u_MAC_CSR4_STRUC
 {

774 
UCHAR
 
	mByã0
;

775 
UCHAR
 
	mByã1
;

776 
UCHAR
 
	mByã2
;

777 
UCHAR
 
	mByã3
;

778 } 
	mfõld
;

779 
ULONG
 
	mw‹d
;

780 } 
	tMAC_CSR4_STRUC
, *
	tPMAC_CSR4_STRUC
;

786 #ifde‡
BIG_ENDIAN


787 
	u_MAC_CSR5_STRUC
 {

789 
USHORT
 
	mRsvd
:14;

790 
USHORT
 
	mBssIdMask
:2;

791 
UCHAR
 
	mByã5
;

792 
UCHAR
 
	mByã4
;

793 } 
	mfõld
;

794 
ULONG
 
	mw‹d
;

795 } 
	tMAC_CSR5_STRUC
, *
	tPMAC_CSR5_STRUC
;

797 
	u_MAC_CSR5_STRUC
 {

799 
UCHAR
 
	mByã4
;

800 
UCHAR
 
	mByã5
;

801 
USHORT
 
	mBssIdMask
:2;

802 
USHORT
 
	mRsvd
:14;

803 } 
	mfõld
;

804 
ULONG
 
	mw‹d
;

805 } 
	tMAC_CSR5_STRUC
, *
	tPMAC_CSR5_STRUC
;

810 #ifde‡
BIG_ENDIAN


811 
	u_MAC_CSR8_STRUC
 {

813 
USHORT
 
	mEifs
;

814 
UCHAR
 
	mSifsA·îRxOfdm
;

815 
UCHAR
 
	mSifs
;

816 } 
	mfõld
;

817 
ULONG
 
	mw‹d
;

818 } 
	tMAC_CSR8_STRUC
, *
	tPMAC_CSR8_STRUC
;

820 
	u_MAC_CSR8_STRUC
 {

822 
UCHAR
 
	mSifs
;

823 
UCHAR
 
	mSifsA·îRxOfdm
;

824 
USHORT
 
	mEifs
;

825 } 
	mfõld
;

826 
ULONG
 
	mw‹d
;

827 } 
	tMAC_CSR8_STRUC
, *
	tPMAC_CSR8_STRUC
;

833 #ifde‡
BIG_ENDIAN


834 
	u_MAC_CSR9_STRUC
 {

836 
ULONG
 
	mRsvd
:15;

837 
ULONG
 
	mCWSñe˘
:1;

838 
ULONG
 
	mCWMax
:4;

839 
ULONG
 
	mCWMö
:4;

840 
ULONG
 
	mSlŸTime
:8;

841 } 
	mfõld
;

842 
ULONG
 
	mw‹d
;

843 } 
	tMAC_CSR9_STRUC
, *
	tPMAC_CSR9_STRUC
;

845 
	u_MAC_CSR9_STRUC
 {

847 
ULONG
 
	mSlŸTime
:8;

848 
ULONG
 
	mCWMö
:4;

849 
ULONG
 
	mCWMax
:4;

850 
ULONG
 
	mCWSñe˘
:1;

851 
ULONG
 
	mRsvd
:15;

852 } 
	mfõld
;

853 
ULONG
 
	mw‹d
;

854 } 
	tMAC_CSR9_STRUC
, *
	tPMAC_CSR9_STRUC
;

861 #ifde‡
BIG_ENDIAN


862 
	u_MAC_CSR11_STRUC
 {

864 
	mULONG
 :12;

865 
ULONG
 
	mSÀï2AwakeL©ícy
:4;

866 
ULONG
 
	mbAutoWakeupE«bÀ
:1;

867 
ULONG
 
	mNumOfTBTTBef‹eWakeup
:7;

868 
ULONG
 
	mDñayA·îLa°TBTTBef‹eWakeup
:8;

869 } 
	mfõld
;

870 
ULONG
 
	mw‹d
;

871 } 
	tMAC_CSR11_STRUC
, *
	tPMAC_CSR11_STRUC
;

873 
	u_MAC_CSR11_STRUC
 {

875 
ULONG
 
	mDñayA·îLa°TBTTBef‹eWakeup
:8;

876 
ULONG
 
	mNumOfTBTTBef‹eWakeup
:7;

877 
ULONG
 
	mbAutoWakeupE«bÀ
:1;

878 
ULONG
 
	mSÀï2AwakeL©ícy
:4;

879 
	mULONG
 :12;

880 } 
	mfõld
;

881 
ULONG
 
	mw‹d
;

882 } 
	tMAC_CSR11_STRUC
, *
	tPMAC_CSR11_STRUC
;

888 #ifde‡
BIG_ENDIAN


889 
	u_MAC_CSR12_STRUC
 {

891 
	mULONG
 :28;

892 
ULONG
 
	mBbpRfSètus
:1;

893 
ULONG
 
	mF‹˚Wakeup
:1;

894 
ULONG
 
	mPutToSÀï
:1;

895 
ULONG
 
	mCuºítPowîSèã
:1;

896 } 
	mfõld
;

897 
ULONG
 
	mw‹d
;

898 } 
	tMAC_CSR12_STRUC
, *
	tPMAC_CSR12_STRUC
;

900 
	u_MAC_CSR12_STRUC
 {

902 
ULONG
 
	mCuºítPowîSèã
:1;

903 
ULONG
 
	mPutToSÀï
:1;

904 
ULONG
 
	mF‹˚Wakeup
:1;

905 
ULONG
 
	mBbpRfSètus
:1;

906 
	mULONG
 :28;

907 } 
	mfõld
;

908 
ULONG
 
	mw‹d
;

909 } 
	tMAC_CSR12_STRUC
, *
	tPMAC_CSR12_STRUC
;

915 #ifde‡
BIG_ENDIAN


916 
	u_MAC_CSR14_STRUC
 {

918 
	mULONG
 :12;

919 
ULONG
 
	mSwLed2
:1;

920 
ULONG
 
	mHwLedPﬁ¨ôy
:1;

921 
ULONG
 
	mSwLed1
:1;

922 
ULONG
 
	mHwLed
:1;

923 
ULONG
 
	mOffPîiod
:8;

924 
ULONG
 
	mOnPîiod
:8;

925 } 
	mfõld
;

926 
ULONG
 
	mw‹d
;

927 } 
	tMAC_CSR14_STRUC
, *
	tPMAC_CSR14_STRUC
;

929 
	u_MAC_CSR14_STRUC
 {

931 
ULONG
 
	mOnPîiod
:8;

932 
ULONG
 
	mOffPîiod
:8;

933 
ULONG
 
	mHwLed
:1;

934 
ULONG
 
	mSwLed1
:1;

935 
ULONG
 
	mHwLedPﬁ¨ôy
:1;

936 
ULONG
 
	mSwLed2
:1;

937 
	mULONG
 :12;

938 } 
	mfõld
;

939 
ULONG
 
	mw‹d
;

940 } 
	tMAC_CSR14_STRUC
, *
	tPMAC_CSR14_STRUC
;

946 #ifde‡
BIG_ENDIAN


947 
	uTXRX_CSR0_STRUC
 {

949 
	mULONG
 :5;

950 
ULONG
 
	mTxWôhoutWaôögSBox
:1;

951 
ULONG
 
	mDr›AckCts
:1;

952 
ULONG
 
	mDr›Bˇ°
:1;

953 
ULONG
 
	mDr›Mˇ°
:1;

954 
ULONG
 
	mDr›VîEº
:1;

955 
ULONG
 
	mDr›ToDs
:1;

956 
ULONG
 
	mDr›NŸToMe
:1;

957 
ULONG
 
	mDr›C⁄åﬁ
:1;

958 
ULONG
 
	mDr›PhyEº
:1;

959 
ULONG
 
	mDr›CRCEº
:1;

960 
ULONG
 
	mDißbÀRx
:1;

961 
ULONG
 
	mAutoTxSeq
:1;

962 
ULONG
 
	mTsfOff£t
:6;

963 
ULONG
 
	mRxAckTimeout
:9;

964 } 
	mfõld
;

965 
ULONG
 
	mw‹d
;

966 } 
	tTXRX_CSR0_STRUC
, *
	tPTXRX_CSR0_STRUC
;

968 
	u_TXRX_CSR0_STRUC
 {

970 
ULONG
 
	mRxAckTimeout
:9;

971 
ULONG
 
	mTsfOff£t
:6;

972 
ULONG
 
	mAutoTxSeq
:1;

973 
ULONG
 
	mDißbÀRx
:1;

974 
ULONG
 
	mDr›CRCEº
:1;

975 
ULONG
 
	mDr›PhyEº
:1;

976 
ULONG
 
	mDr›C⁄åﬁ
:1;

977 
ULONG
 
	mDr›NŸToMe
:1;

978 
ULONG
 
	mDr›ToDs
:1;

979 
ULONG
 
	mDr›VîEº
:1;

980 
ULONG
 
	mDr›Mˇ°
:1;

981 
ULONG
 
	mDr›Bˇ°
:1;

982 
ULONG
 
	mDr›AckCts
:1;

983 
ULONG
 
	mTxWôhoutWaôögSBox
:1;

984 
	mULONG
 :5;

985 } 
	mfõld
;

986 
ULONG
 
	mw‹d
;

987 } 
	tTXRX_CSR0_STRUC
, *
	tPTXRX_CSR0_STRUC
;

993 #ifde‡
BIG_ENDIAN


994 
	u_TXRX_CSR4_STRUC
 {

996 
ULONG
 
	mSh‹tRëryLimô
:4;

997 
ULONG
 
	mL⁄gRëryLimô
:4;

998 
ULONG
 
	mRsv1
:1;

999 
ULONG
 
	mOfdmTxFÆlbacktoCCK
:1;

1000 
ULONG
 
	mOfdmTxR©eDownSãp
:2;

1001 
ULONG
 
	mOfdmTxR©eDownE«bÀ
:1;

1002 
ULONG
 
	mAutoRe•⁄dîPªambÀ
:1;

1003 
ULONG
 
	mAutoRe•⁄dîE«bÀ
:1;

1004 
ULONG
 
	mAckCtsPsmBô
:1;

1005 
ULONG
 
	mRsv2
:5;

1006 
ULONG
 
	mC¡lFømeAckPﬁicy
:3;

1007 
ULONG
 
	mTxAckTimeout
:8;

1008 } 
	mfõld
;

1009 
ULONG
 
	mw‹d
;

1010 } 
	tTXRX_CSR4_STRUC
, *
	tPTXRX_CSR4_STRUC
;

1012 
	u_TXRX_CSR4_STRUC
 {

1014 
ULONG
 
	mTxAckTimeout
:8;

1015 
ULONG
 
	mC¡lFømeAckPﬁicy
:3;

1016 
ULONG
 
	mRsv2
:5;

1017 
ULONG
 
	mAckCtsPsmBô
:1;

1018 
ULONG
 
	mAutoRe•⁄dîE«bÀ
:1;

1019 
ULONG
 
	mAutoRe•⁄dîPªambÀ
:1;

1020 
ULONG
 
	mOfdmTxR©eDownE«bÀ
:1;

1021 
ULONG
 
	mOfdmTxR©eDownSãp
:2;

1022 
ULONG
 
	mOfdmTxFÆlbacktoCCK
:1;

1023 
ULONG
 
	mRsv1
:1;

1024 
ULONG
 
	mL⁄gRëryLimô
:4;

1025 
ULONG
 
	mSh‹tRëryLimô
:4;

1026 } 
	mfõld
;

1027 
ULONG
 
	mw‹d
;

1028 } 
	tTXRX_CSR4_STRUC
, *
	tPTXRX_CSR4_STRUC
;

1034 #ifde‡
BIG_ENDIAN


1035 
	u_TXRX_CSR9_STRUC
 {

1037 
ULONG
 
	mTxTime°ampCom≥nßã
:8;

1038 
	mULONG
 :3;

1039 
ULONG
 
	mbBóc⁄Gí
:1;

1040 
ULONG
 
	mbTBTTE«bÀ
:1;

1041 
ULONG
 
	mTsfSyncMode
:2;

1042 
ULONG
 
	mbTsfTickög
:1;

1043 
ULONG
 
	mBóc⁄I¡îvÆ
:16;

1044 } 
	mfõld
;

1045 
ULONG
 
	mw‹d
;

1046 } 
	tTXRX_CSR9_STRUC
, *
	tPTXRX_CSR9_STRUC
;

1048 
	u_TXRX_CSR9_STRUC
 {

1050 
ULONG
 
	mBóc⁄I¡îvÆ
:16;

1051 
ULONG
 
	mbTsfTickög
:1;

1052 
ULONG
 
	mTsfSyncMode
:2;

1053 
ULONG
 
	mbTBTTE«bÀ
:1;

1054 
ULONG
 
	mbBóc⁄Gí
:1;

1055 
	mULONG
 :3;

1056 
ULONG
 
	mTxTime°ampCom≥nßã
:8;

1057 } 
	mfõld
;

1058 
ULONG
 
	mw‹d
;

1059 } 
	tTXRX_CSR9_STRUC
, *
	tPTXRX_CSR9_STRUC
;

1065 #ifde‡
BIG_ENDIAN


1066 
	u_PHY_CSR3_STRUC
 {

1068 
	mULONG
 :15;

1069 
ULONG
 
	mBusy
:1;

1070 
ULONG
 
	mfRód
:1;

1071 
ULONG
 
	mRegNum
:7;

1072 
ULONG
 
	mVÆue
:8;

1073 } 
	mfõld
;

1074 
ULONG
 
	mw‹d
;

1075 } 
	tPHY_CSR3_STRUC
, *
	tPPHY_CSR3_STRUC
;

1077 
	u_PHY_CSR3_STRUC
 {

1079 
ULONG
 
	mVÆue
:8;

1080 
ULONG
 
	mRegNum
:7;

1081 
ULONG
 
	mfRód
:1;

1082 
ULONG
 
	mBusy
:1;

1083 
	mULONG
 :15;

1084 } 
	mfõld
;

1085 
ULONG
 
	mw‹d
;

1086 } 
	tPHY_CSR3_STRUC
, *
	tPPHY_CSR3_STRUC
;

1092 #ifde‡
BIG_ENDIAN


1093 
	u_PHY_CSR4_STRUC
 {

1095 
ULONG
 
	mBusy
:1;

1096 
ULONG
 
	mPLL_LD
:1;

1097 
ULONG
 
	mIFSñe˘
:1;

1098 
ULONG
 
	mNumbîOfBôs
:5;

1099 
ULONG
 
	mRFRegVÆue
:24;

1100 } 
	mfõld
;

1101 
ULONG
 
	mw‹d
;

1102 } 
	tPHY_CSR4_STRUC
, *
	tPPHY_CSR4_STRUC
;

1104 
	u_PHY_CSR4_STRUC
 {

1106 
ULONG
 
	mRFRegVÆue
:24;

1107 
ULONG
 
	mNumbîOfBôs
:5;

1108 
ULONG
 
	mIFSñe˘
:1;

1109 
ULONG
 
	mPLL_LD
:1;

1110 
ULONG
 
	mBusy
:1;

1111 } 
	mfõld
;

1112 
ULONG
 
	mw‹d
;

1113 } 
	tPHY_CSR4_STRUC
, *
	tPPHY_CSR4_STRUC
;

1119 #ifde‡
BIG_ENDIAN


1120 
	u_SEC_CSR1_STRUC
 {

1122 
	mULONG
 :1;

1123 
ULONG
 
	mBss1Key3CùhîAlg
:3;

1124 
	mULONG
 :1;

1125 
ULONG
 
	mBss1Key2CùhîAlg
:3;

1126 
	mULONG
 :1;

1127 
ULONG
 
	mBss1Key1CùhîAlg
:3;

1128 
	mULONG
 :1;

1129 
ULONG
 
	mBss1Key0CùhîAlg
:3;

1130 
	mULONG
 :1;

1131 
ULONG
 
	mBss0Key3CùhîAlg
:3;

1132 
	mULONG
 :1;

1133 
ULONG
 
	mBss0Key2CùhîAlg
:3;

1134 
	mULONG
 :1;

1135 
ULONG
 
	mBss0Key1CùhîAlg
:3;

1136 
	mULONG
 :1;

1137 
ULONG
 
	mBss0Key0CùhîAlg
:3;

1138 } 
	mfõld
;

1139 
ULONG
 
	mw‹d
;

1140 } 
	tSEC_CSR1_STRUC
, *
	tPSEC_CSR1_STRUC
;

1142 
	u_SEC_CSR1_STRUC
 {

1144 
ULONG
 
	mBss0Key0CùhîAlg
:3;

1145 
	mULONG
 :1;

1146 
ULONG
 
	mBss0Key1CùhîAlg
:3;

1147 
	mULONG
 :1;

1148 
ULONG
 
	mBss0Key2CùhîAlg
:3;

1149 
	mULONG
 :1;

1150 
ULONG
 
	mBss0Key3CùhîAlg
:3;

1151 
	mULONG
 :1;

1152 
ULONG
 
	mBss1Key0CùhîAlg
:3;

1153 
	mULONG
 :1;

1154 
ULONG
 
	mBss1Key1CùhîAlg
:3;

1155 
	mULONG
 :1;

1156 
ULONG
 
	mBss1Key2CùhîAlg
:3;

1157 
	mULONG
 :1;

1158 
ULONG
 
	mBss1Key3CùhîAlg
:3;

1159 
	mULONG
 :1;

1160 } 
	mfõld
;

1161 
ULONG
 
	mw‹d
;

1162 } 
	tSEC_CSR1_STRUC
, *
	tPSEC_CSR1_STRUC
;

1168 #ifde‡
BIG_ENDIAN


1169 
	u_SEC_CSR5_STRUC
 {

1171 
	mULONG
 :1;

1172 
ULONG
 
	mBss3Key3CùhîAlg
:3;

1173 
	mULONG
 :1;

1174 
ULONG
 
	mBss3Key2CùhîAlg
:3;

1175 
	mULONG
 :1;

1176 
ULONG
 
	mBss3Key1CùhîAlg
:3;

1177 
	mULONG
 :1;

1178 
ULONG
 
	mBss3Key0CùhîAlg
:3;

1179 
	mULONG
 :1;

1180 
ULONG
 
	mBss2Key3CùhîAlg
:3;

1181 
	mULONG
 :1;

1182 
ULONG
 
	mBss2Key2CùhîAlg
:3;

1183 
	mULONG
 :1;

1184 
ULONG
 
	mBss2Key1CùhîAlg
:3;

1185 
	mULONG
 :1;

1186 
ULONG
 
	mBss2Key0CùhîAlg
:3;

1187 } 
	mfõld
;

1188 
ULONG
 
	mw‹d
;

1189 } 
	tSEC_CSR5_STRUC
, *
	tPSEC_CSR5_STRUC
;

1191 
	u_SEC_CSR5_STRUC
 {

1193 
ULONG
 
	mBss2Key0CùhîAlg
:3;

1194 
	mULONG
 :1;

1195 
ULONG
 
	mBss2Key1CùhîAlg
:3;

1196 
	mULONG
 :1;

1197 
ULONG
 
	mBss2Key2CùhîAlg
:3;

1198 
	mULONG
 :1;

1199 
ULONG
 
	mBss2Key3CùhîAlg
:3;

1200 
	mULONG
 :1;

1201 
ULONG
 
	mBss3Key0CùhîAlg
:3;

1202 
	mULONG
 :1;

1203 
ULONG
 
	mBss3Key1CùhîAlg
:3;

1204 
	mULONG
 :1;

1205 
ULONG
 
	mBss3Key2CùhîAlg
:3;

1206 
	mULONG
 :1;

1207 
ULONG
 
	mBss3Key3CùhîAlg
:3;

1208 
	mULONG
 :1;

1209 } 
	mfõld
;

1210 
ULONG
 
	mw‹d
;

1211 } 
	tSEC_CSR5_STRUC
, *
	tPSEC_CSR5_STRUC
;

1217 #ifde‡
BIG_ENDIAN


1218 
	u_STA_CSR0_STRUC
 {

1220 
USHORT
 
	mPl˝Eº
;

1221 
USHORT
 
	mCrcEº
;

1222 } 
	mfõld
;

1223 
ULONG
 
	mw‹d
;

1224 } 
	tSTA_CSR0_STRUC
, *
	tPSTA_CSR0_STRUC
;

1226 
	u_STA_CSR0_STRUC
 {

1228 
USHORT
 
	mCrcEº
;

1229 
USHORT
 
	mPl˝Eº
;

1230 } 
	mfõld
;

1231 
ULONG
 
	mw‹d
;

1232 } 
	tSTA_CSR0_STRUC
, *
	tPSTA_CSR0_STRUC
;

1238 #ifde‡
BIG_ENDIAN


1239 
	u_STA_CSR1_STRUC
 {

1241 
USHORT
 
	mFÆ£Cˇ
;

1242 
USHORT
 
	mPhyEº
;

1243 } 
	mfõld
;

1244 
ULONG
 
	mw‹d
;

1245 } 
	tSTA_CSR1_STRUC
, *
	tPSTA_CSR1_STRUC
;

1247 
	u_STA_CSR1_STRUC
 {

1249 
USHORT
 
	mPhyEº
;

1250 
USHORT
 
	mFÆ£Cˇ
;

1251 } 
	mfõld
;

1252 
ULONG
 
	mw‹d
;

1253 } 
	tSTA_CSR1_STRUC
, *
	tPSTA_CSR1_STRUC
;

1259 #ifde‡
BIG_ENDIAN


1260 
	u_STA_CSR2_STRUC
 {

1262 
USHORT
 
	mRxOvîÊowCou¡
;

1263 
USHORT
 
	mRxFifoOvîÊowCou¡
;

1264 } 
	mfõld
;

1265 
ULONG
 
	mw‹d
;

1266 } 
	tSTA_CSR2_STRUC
, *
	tPSTA_CSR2_STRUC
;

1268 
	u_STA_CSR2_STRUC
 {

1270 
USHORT
 
	mRxFifoOvîÊowCou¡
;

1271 
USHORT
 
	mRxOvîÊowCou¡
;

1272 } 
	mfõld
;

1273 
ULONG
 
	mw‹d
;

1274 } 
	tSTA_CSR2_STRUC
, *
	tPSTA_CSR2_STRUC
;

1280 #ifde‡
BIG_ENDIAN


1281 
	u_STA_CSR3_STRUC
 {

1283 
USHORT
 
	mRsv
;

1284 
USHORT
 
	mTxBóc⁄Cou¡
;

1285 } 
	mfõld
;

1286 
ULONG
 
	mw‹d
;

1287 } 
	tSTA_CSR3_STRUC
, *
	tPSTA_CSR3_STRUC
;

1289 
	u_STA_CSR3_STRUC
 {

1291 
USHORT
 
	mTxBóc⁄Cou¡
;

1292 
USHORT
 
	mRsv
;

1293 } 
	mfõld
;

1294 
ULONG
 
	mw‹d
;

1295 } 
	tSTA_CSR3_STRUC
, *
	tPSTA_CSR3_STRUC
;

1301 #ifde‡
BIG_ENDIAN


1302 
	u_STA_CSR4_STRUC
 {

1304 
USHORT
 
	mTxO√RëryCou¡
;

1305 
USHORT
 
	mTxNoRëryCou¡
;

1306 } 
	mfõld
;

1307 
ULONG
 
	mw‹d
;

1308 } 
	tSTA_CSR4_STRUC
, *
	tPSTA_CSR4_STRUC
;

1310 
	u_STA_CSR4_STRUC
 {

1312 
USHORT
 
	mTxNoRëryCou¡
;

1313 
USHORT
 
	mTxO√RëryCou¡
;

1314 } 
	mfõld
;

1315 
ULONG
 
	mw‹d
;

1316 } 
	tSTA_CSR4_STRUC
, *
	tPSTA_CSR4_STRUC
;

1323 #ifde‡
BIG_ENDIAN


1324 
	u_STA_CSR5_STRUC
 {

1326 
USHORT
 
	mTxRëryFaûCou¡
;

1327 
USHORT
 
	mTxMu…iRëryCou¡
;

1328 } 
	mfõld
;

1329 
ULONG
 
	mw‹d
;

1330 } 
	tSTA_CSR5_STRUC
, *
	tPSTA_CSR5_STRUC
;

1332 
	u_STA_CSR5_STRUC
 {

1334 
USHORT
 
	mTxMu…iRëryCou¡
;

1335 
USHORT
 
	mTxRëryFaûCou¡
;

1336 } 
	mfõld
;

1337 
ULONG
 
	mw‹d
;

1338 } 
	tSTA_CSR5_STRUC
, *
	tPSTA_CSR5_STRUC
;

1344 #ifde‡
BIG_ENDIAN


1345 
	u_HOST_CMD_CSR_STRUC
 {

1347 
ULONG
 
	mRsv
:24;

1348 
ULONG
 
	mI¡îru±Mcu
:1;

1349 
ULONG
 
	mHo°Comm™d
:7;

1350 } 
	mfõld
;

1351 
ULONG
 
	mw‹d
;

1352 } 
	tHOST_CMD_CSR_STRUC
, *
	tPHOST_CMD_CSR_STRUC
;

1354 
	u_HOST_CMD_CSR_STRUC
 {

1356 
ULONG
 
	mHo°Comm™d
:7;

1357 
ULONG
 
	mI¡îru±Mcu
:1;

1358 
ULONG
 
	mRsv
:24;

1359 } 
	mfõld
;

1360 
ULONG
 
	mw‹d
;

1361 } 
	tHOST_CMD_CSR_STRUC
, *
	tPHOST_CMD_CSR_STRUC
;

1367 #ifde‡
BIG_ENDIAN


1368 
	u_TX_RING_CSR0_STRUC
 {

1370 
UCHAR
 
	mAc3TŸÆ
;

1371 
UCHAR
 
	mAc2TŸÆ
;

1372 
UCHAR
 
	mAc1TŸÆ
;

1373 
UCHAR
 
	mAc0TŸÆ
;

1374 } 
	mfõld
;

1375 
ULONG
 
	mw‹d
;

1376 } 
	tTX_RING_CSR0_STRUC
, *
	tPTX_RING_CSR0_STRUC
;

1378 
	u_TX_RING_CSR0_STRUC
 {

1380 
UCHAR
 
	mAc0TŸÆ
;

1381 
UCHAR
 
	mAc1TŸÆ
;

1382 
UCHAR
 
	mAc2TŸÆ
;

1383 
UCHAR
 
	mAc3TŸÆ
;

1384 } 
	mfõld
;

1385 
ULONG
 
	mw‹d
;

1386 } 
	tTX_RING_CSR0_STRUC
, *
	tPTX_RING_CSR0_STRUC
;

1392 #ifde‡
BIG_ENDIAN


1393 
	u_TX_RING_CSR1_STRUC
 {

1395 
ULONG
 
	mRsv
:10;

1396 
ULONG
 
	mTxdSize
:6;

1397 
ULONG
 
	mHcˇTŸÆ
:8;

1398 
ULONG
 
	mMgmtTŸÆ
:8;

1399 } 
	mfõld
;

1400 
ULONG
 
	mw‹d
;

1401 } 
	tTX_RING_CSR1_STRUC
, *
	tPTX_RING_CSR1_STRUC
;

1403 
	u_TX_RING_CSR1_STRUC
 {

1405 
ULONG
 
	mMgmtTŸÆ
:8;

1406 
ULONG
 
	mHcˇTŸÆ
:8;

1407 
ULONG
 
	mTxdSize
:6;

1408 
ULONG
 
	mRsv
:10;

1409 } 
	mfõld
;

1410 
ULONG
 
	mw‹d
;

1411 } 
	tTX_RING_CSR1_STRUC
, *
	tPTX_RING_CSR1_STRUC
;

1417 #ifde‡
BIG_ENDIAN


1418 
	u_AIFSN_CSR_STRUC
 {

1420 
ULONG
 
	mRsv
:16;

1421 
ULONG
 
	mAif¢3
:4;

1422 
ULONG
 
	mAif¢2
:4;

1423 
ULONG
 
	mAif¢1
:4;

1424 
ULONG
 
	mAif¢0
:4;

1425 } 
	mfõld
;

1426 
ULONG
 
	mw‹d
;

1427 } 
	tAIFSN_CSR_STRUC
, *
	tPAIFSN_CSR_STRUC
;

1429 
	u_AIFSN_CSR_STRUC
 {

1431 
ULONG
 
	mAif¢0
:4;

1432 
ULONG
 
	mAif¢1
:4;

1433 
ULONG
 
	mAif¢2
:4;

1434 
ULONG
 
	mAif¢3
:4;

1435 
ULONG
 
	mRsv
:16;

1436 } 
	mfõld
;

1437 
ULONG
 
	mw‹d
;

1438 } 
	tAIFSN_CSR_STRUC
, *
	tPAIFSN_CSR_STRUC
;

1444 #ifde‡
BIG_ENDIAN


1445 
	u_CWMIN_CSR_STRUC
 {

1447 
ULONG
 
	mRsv
:16;

1448 
ULONG
 
	mCwmö3
:4;

1449 
ULONG
 
	mCwmö2
:4;

1450 
ULONG
 
	mCwmö1
:4;

1451 
ULONG
 
	mCwmö0
:4;

1452 } 
	mfõld
;

1453 
ULONG
 
	mw‹d
;

1454 } 
	tCWMIN_CSR_STRUC
, *
	tPCWMIN_CSR_STRUC
;

1456 
	u_CWMIN_CSR_STRUC
 {

1458 
ULONG
 
	mCwmö0
:4;

1459 
ULONG
 
	mCwmö1
:4;

1460 
ULONG
 
	mCwmö2
:4;

1461 
ULONG
 
	mCwmö3
:4;

1462 
ULONG
 
	mRsv
:16;

1463 } 
	mfõld
;

1464 
ULONG
 
	mw‹d
;

1465 } 
	tCWMIN_CSR_STRUC
, *
	tPCWMIN_CSR_STRUC
;

1471 #ifde‡
BIG_ENDIAN


1472 
	u_CWMAX_CSR_STRUC
 {

1474 
ULONG
 
	mRsv
:16;

1475 
ULONG
 
	mCwmax3
:4;

1476 
ULONG
 
	mCwmax2
:4;

1477 
ULONG
 
	mCwmax1
:4;

1478 
ULONG
 
	mCwmax0
:4;

1479 } 
	mfõld
;

1480 
ULONG
 
	mw‹d
;

1481 } 
	tCWMAX_CSR_STRUC
, *
	tPCWMAX_CSR_STRUC
;

1483 
	u_CWMAX_CSR_STRUC
 {

1485 
ULONG
 
	mCwmax0
:4;

1486 
ULONG
 
	mCwmax1
:4;

1487 
ULONG
 
	mCwmax2
:4;

1488 
ULONG
 
	mCwmax3
:4;

1489 
ULONG
 
	mRsv
:16;

1490 } 
	mfõld
;

1491 
ULONG
 
	mw‹d
;

1492 } 
	tCWMAX_CSR_STRUC
, *
	tPCWMAX_CSR_STRUC
;

1498 #ifde‡
BIG_ENDIAN


1499 
	u_TX_CNTL_CSR_STRUC
 {

1501 
ULONG
 
	mRsv1
:11;

1502 
ULONG
 
	mAb‹tTxMgmt
:1;

1503 
ULONG
 
	mAb‹tTxAc3
:1;

1504 
ULONG
 
	mAb‹tTxAc2
:1;

1505 
ULONG
 
	mAb‹tTxAc1
:1;

1506 
ULONG
 
	mAb‹tTxAc0
:1;

1507 
ULONG
 
	mRsv2
:11;

1508 
ULONG
 
	mKickTxMgmt
:1;

1509 
ULONG
 
	mKickTxAc3
:1;

1510 
ULONG
 
	mKickTxAc2
:1;

1511 
ULONG
 
	mKickTxAc1
:1;

1512 
ULONG
 
	mKickTxAc0
:1;

1513 } 
	mfõld
;

1514 
ULONG
 
	mw‹d
;

1515 } 
	tTX_CNTL_CSR_STRUC
, *
	tPTX_CNTL_CSR_STRUC
;

1517 
	u_TX_CNTL_CSR_STRUC
 {

1519 
ULONG
 
	mKickTxAc0
:1;

1520 
ULONG
 
	mKickTxAc1
:1;

1521 
ULONG
 
	mKickTxAc2
:1;

1522 
ULONG
 
	mKickTxAc3
:1;

1523 
ULONG
 
	mKickTxMgmt
:1;

1524 
ULONG
 
	mRsv2
:11;

1525 
ULONG
 
	mAb‹tTxAc0
:1;

1526 
ULONG
 
	mAb‹tTxAc1
:1;

1527 
ULONG
 
	mAb‹tTxAc2
:1;

1528 
ULONG
 
	mAb‹tTxAc3
:1;

1529 
ULONG
 
	mAb‹tTxMgmt
:1;

1530 
ULONG
 
	mRsv1
:11;

1531 } 
	mfõld
;

1532 
ULONG
 
	mw‹d
;

1533 } 
	tTX_CNTL_CSR_STRUC
, *
	tPTX_CNTL_CSR_STRUC
;

1539 #ifde‡
BIG_ENDIAN


1540 
	u_RX_RING_CSR_STRUC
 {

1542 
ULONG
 
	mRsv
:13;

1543 
ULONG
 
	mRxdWrôebackSize
:3;

1544 
	mULONG
 :2;

1545 
ULONG
 
	mRxdSize
:6;

1546 
ULONG
 
	mRxRögTŸÆ
:8;

1547 } 
	mfõld
;

1548 
ULONG
 
	mw‹d
;

1549 } 
	tRX_RING_CSR_STRUC
, *
	tPRX_RING_CSR_STRUC
;

1551 
	u_RX_RING_CSR_STRUC
 {

1553 
ULONG
 
	mRxRögTŸÆ
:8;

1554 
ULONG
 
	mRxdSize
:6;

1555 
	mULONG
 :2;

1556 
ULONG
 
	mRxdWrôebackSize
:3;

1557 
ULONG
 
	mRsv
:13;

1558 } 
	mfõld
;

1559 
ULONG
 
	mw‹d
;

1560 } 
	tRX_RING_CSR_STRUC
, *
	tPRX_RING_CSR_STRUC
;

1566 #ifde‡
BIG_ENDIAN


1567 
	u_INT_SOURCE_CSR_STRUC
 {

1569 
	mULONG
 :10;

1570 
ULONG
 
	mHcˇDmaD⁄e
:1;

1571 
ULONG
 
	mMgmtDmaD⁄e
:1;

1572 
ULONG
 
	mAc3DmaD⁄e
:1;

1573 
ULONG
 
	mAc2DmaD⁄e
:1;

1574 
ULONG
 
	mAc1DmaD⁄e
:1;

1575 
ULONG
 
	mAc0DmaD⁄e
:1;

1576 
	mULONG
 :11;

1577 
ULONG
 
	mTxAb‹tD⁄e
:1;

1578 
	mULONG
 :1;

1579 
ULONG
 
	mBóc⁄TxD⁄e
:1;

1580 
ULONG
 
	mRxD⁄e
:1;

1581 
ULONG
 
	mTxD⁄e
:1;

1582 } 
	mfõld
;

1583 
ULONG
 
	mw‹d
;

1584 } 
	tINT_SOURCE_CSR_STRUC
, *
	tPINT_SOURCE_CSR_STRUC
;

1586 
	u_INT_SOURCE_CSR_STRUC
 {

1588 
ULONG
 
	mTxD⁄e
:1;

1589 
ULONG
 
	mRxD⁄e
:1;

1590 
ULONG
 
	mBóc⁄TxD⁄e
:1;

1591 
	mULONG
 :1;

1592 
ULONG
 
	mTxAb‹tD⁄e
:1;

1593 
	mULONG
 :11;

1594 
ULONG
 
	mAc0DmaD⁄e
:1;

1595 
ULONG
 
	mAc1DmaD⁄e
:1;

1596 
ULONG
 
	mAc2DmaD⁄e
:1;

1597 
ULONG
 
	mAc3DmaD⁄e
:1;

1598 
ULONG
 
	mMgmtDmaD⁄e
:1;

1599 
ULONG
 
	mHcˇDmaD⁄e
:1;

1600 
	mULONG
 :10;

1601 } 
	mfõld
;

1602 
ULONG
 
	mw‹d
;

1603 } 
	tINT_SOURCE_CSR_STRUC
, *
	tPINT_SOURCE_CSR_STRUC
;

1609 #ifde‡
BIG_ENDIAN


1610 
	u_INT_MASK_CSR_STRUC
 {

1612 
	mULONG
 :10;

1613 
ULONG
 
	mHcˇDmaD⁄e
:1;

1614 
ULONG
 
	mMgmtDmaD⁄e
:1;

1615 
ULONG
 
	mAc3DmaD⁄e
:1;

1616 
ULONG
 
	mAc2DmaD⁄e
:1;

1617 
ULONG
 
	mAc1DmaD⁄e
:1;

1618 
ULONG
 
	mAc0DmaD⁄e
:1;

1619 
ULONG
 
	mMôig©i⁄Pîiod
:8;

1620 
ULONG
 
	mbE«bÀMôig©i⁄Pîiod
:1;

1621 
	mULONG
 :2;

1622 
ULONG
 
	mTxAb‹tD⁄e
:1;

1623 
	mULONG
 :1;

1624 
ULONG
 
	mBóc⁄TxD⁄e
:1;

1625 
ULONG
 
	mRxD⁄e
:1;

1626 
ULONG
 
	mTxD⁄e
:1;

1627 } 
	mfõld
;

1628 
ULONG
 
	mw‹d
;

1629 }
	tINT_MASK_CSR_STRUC
, *
	tPINT_MASK_CSR_STRUC
;

1631 
	u_INT_MASK_CSR_STRUC
 {

1633 
ULONG
 
	mTxD⁄e
:1;

1634 
ULONG
 
	mRxD⁄e
:1;

1635 
ULONG
 
	mBóc⁄TxD⁄e
:1;

1636 
	mULONG
 :1;

1637 
ULONG
 
	mTxAb‹tD⁄e
:1;

1638 
	mULONG
 :2;

1639 
ULONG
 
	mbE«bÀMôig©i⁄Pîiod
:1;

1640 
ULONG
 
	mMôig©i⁄Pîiod
:8;

1641 
ULONG
 
	mAc0DmaD⁄e
:1;

1642 
ULONG
 
	mAc1DmaD⁄e
:1;

1643 
ULONG
 
	mAc2DmaD⁄e
:1;

1644 
ULONG
 
	mAc3DmaD⁄e
:1;

1645 
ULONG
 
	mMgmtDmaD⁄e
:1;

1646 
ULONG
 
	mHcˇDmaD⁄e
:1;

1647 
	mULONG
 :10;

1648 } 
	mfõld
;

1649 
ULONG
 
	mw‹d
;

1650 } 
	tINT_MASK_CSR_STRUC
, *
	tPINT_MASK_CSR_STRUC
;

1655 #ifde‡
BIG_ENDIAN


1656 
	u_E2PROM_CSR_STRUC
 {

1658 
ULONG
 
	mRsvd
:25;

1659 
ULONG
 
	mLﬂdSètus
:1;

1660 
ULONG
 
	mTy≥
:1;

1661 
ULONG
 
	mEïromDO
:1;

1662 
ULONG
 
	mEïromDI
:1;

1663 
ULONG
 
	mEïromCS
:1;

1664 
ULONG
 
	mEïromSK
:1;

1665 
ULONG
 
	mRñﬂd
:1;

1666 } 
	mfõld
;

1667 
ULONG
 
	mw‹d
;

1668 } 
	tE2PROM_CSR_STRUC
, *
	tPE2PROM_CSR_STRUC
;

1670 
	u_E2PROM_CSR_STRUC
 {

1672 
ULONG
 
	mRñﬂd
:1;

1673 
ULONG
 
	mEïromSK
:1;

1674 
ULONG
 
	mEïromCS
:1;

1675 
ULONG
 
	mEïromDI
:1;

1676 
ULONG
 
	mEïromDO
:1;

1677 
ULONG
 
	mTy≥
:1;

1678 
ULONG
 
	mLﬂdSètus
:1;

1679 
ULONG
 
	mRsvd
:25;

1680 } 
	mfõld
;

1681 
ULONG
 
	mw‹d
;

1682 } 
	tE2PROM_CSR_STRUC
, *
	tPE2PROM_CSR_STRUC
;

1688 #ifde‡
BIG_ENDIAN


1689 
	u_AC_TXOP_CSR0_STRUC
 {

1691 
USHORT
 
	mAc1Tx›
;

1692 
USHORT
 
	mAc0Tx›
;

1693 } 
	mfõld
;

1694 
ULONG
 
	mw‹d
;

1695 } 
	tAC_TXOP_CSR0_STRUC
, *
	tPAC_TXOP_CSR0_STRUC
;

1697 
	u_AC_TXOP_CSR0_STRUC
 {

1699 
USHORT
 
	mAc0Tx›
;

1700 
USHORT
 
	mAc1Tx›
;

1701 } 
	mfõld
;

1702 
ULONG
 
	mw‹d
;

1703 } 
	tAC_TXOP_CSR0_STRUC
, *
	tPAC_TXOP_CSR0_STRUC
;

1709 #ifde‡
BIG_ENDIAN


1710 
	u_AC_TXOP_CSR1_STRUC
 {

1712 
USHORT
 
	mAc3Tx›
;

1713 
USHORT
 
	mAc2Tx›
;

1714 } 
	mfõld
;

1715 
ULONG
 
	mw‹d
;

1716 } 
	tAC_TXOP_CSR1_STRUC
, *
	tPAC_TXOP_CSR1_STRUC
;

1718 
	u_AC_TXOP_CSR1_STRUC
 {

1720 
USHORT
 
	mAc2Tx›
;

1721 
USHORT
 
	mAc3Tx›
;

1722 } 
	mfõld
;

1723 
ULONG
 
	mw‹d
;

1724 } 
	tAC_TXOP_CSR1_STRUC
, *
	tPAC_TXOP_CSR1_STRUC
;

1735 #ifde‡
BIG_ENDIAN


1736 
	u_EEPROM_ANTENNA_STRUC
 {

1738 
USHORT
 
	mRfIcTy≥
:5;

1739 
USHORT
 
	mH¨dw¨eRadioC⁄åﬁ
:1;

1740 
USHORT
 
	mDy«micTxAgcC⁄åﬁ
:1;

1741 
USHORT
 
	mRsv
:2;

1742 
USHORT
 
	mFømeTy≥
:1;

1743 
USHORT
 
	mRxDeÁu…A¡í«
:2;

1744 
USHORT
 
	mTxDeÁu…A¡í«
:2;

1745 
USHORT
 
	mNumOfA¡í«
:2;

1746 } 
	mfõld
;

1747 
USHORT
 
	mw‹d
;

1748 } 
	tEEPROM_ANTENNA_STRUC
, *
	tPEEPROM_ANTENNA_STRUC
;

1750 
	u_EEPROM_ANTENNA_STRUC
 {

1752 
USHORT
 
	mNumOfA¡í«
:2;

1753 
USHORT
 
	mTxDeÁu…A¡í«
:2;

1754 
USHORT
 
	mRxDeÁu…A¡í«
:2;

1755 
USHORT
 
	mFømeTy≥
:1;

1756 
USHORT
 
	mRsv
:2;

1757 
USHORT
 
	mDy«micTxAgcC⁄åﬁ
:1;

1758 
USHORT
 
	mH¨dw¨eRadioC⁄åﬁ
:1;

1759 
USHORT
 
	mRfIcTy≥
:5;

1760 } 
	mfõld
;

1761 
USHORT
 
	mw‹d
;

1762 } 
	tEEPROM_ANTENNA_STRUC
, *
	tPEEPROM_ANTENNA_STRUC
;

1765 #ifde‡
BIG_ENDIAN


1766 
	u_EEPROM_NIC_CINFIG2_STRUC
 {

1768 
USHORT
 
	mRsv2
:11;

1769 
USHORT
 
	mExã∫ÆLNA
:1;

1770 
USHORT
 
	mRsv1
:4;

1771 } 
	mfõld
;

1772 
USHORT
 
	mw‹d
;

1773 } 
	tEEPROM_NIC_CONFIG2_STRUC
, *
	tPEEPROM_NIC_CONFIG2_STRUC
;

1775 
	u_EEPROM_NIC_CINFIG2_STRUC
 {

1777 
USHORT
 
	mRsv1
:4;

1778 
USHORT
 
	mExã∫ÆLNA
:1;

1779 
USHORT
 
	mRsv2
:11;

1780 } 
	mfõld
;

1781 
USHORT
 
	mw‹d
;

1782 } 
	tEEPROM_NIC_CONFIG2_STRUC
, *
	tPEEPROM_NIC_CONFIG2_STRUC
;

1785 #ifde‡
BIG_ENDIAN


1786 
	u_EEPROM_TX_PWR_STRUC
 {

1788 
UCHAR
 
	mByã1
;

1789 
UCHAR
 
	mByã0
;

1790 } 
	mfõld
;

1791 
USHORT
 
	mw‹d
;

1792 } 
	tEEPROM_TX_PWR_STRUC
, *
	tPEEPROM_TX_PWR_STRUC
;

1794 
	u_EEPROM_TX_PWR_STRUC
 {

1796 
UCHAR
 
	mByã0
;

1797 
UCHAR
 
	mByã1
;

1798 } 
	mfõld
;

1799 
USHORT
 
	mw‹d
;

1800 } 
	tEEPROM_TX_PWR_STRUC
, *
	tPEEPROM_TX_PWR_STRUC
;

1803 #ifde‡
BIG_ENDIAN


1804 
	u_EEPROM_VERSION_STRUC
 {

1806 
UCHAR
 
	mVîsi⁄
;

1807 
UCHAR
 
	mF´Rñó£Numbî
;

1808 } 
	mfõld
;

1809 
USHORT
 
	mw‹d
;

1810 } 
	tEEPROM_VERSION_STRUC
, *
	tPEEPROM_VERSION_STRUC
;

1812 
	u_EEPROM_VERSION_STRUC
 {

1814 
UCHAR
 
	mF´Rñó£Numbî
;

1815 
UCHAR
 
	mVîsi⁄
;

1816 } 
	mfõld
;

1817 
USHORT
 
	mw‹d
;

1818 } 
	tEEPROM_VERSION_STRUC
, *
	tPEEPROM_VERSION_STRUC
;

1821 #ifde‡
BIG_ENDIAN


1822 
	u_EEPROM_LED_STRUC
 {

1824 
USHORT
 
	mRsvd
:3;

1825 
USHORT
 
	mLedMode
:5;

1826 
USHORT
 
	mPﬁ¨ôyGPIO_4
:1;

1827 
USHORT
 
	mPﬁ¨ôyGPIO_3
:1;

1828 
USHORT
 
	mPﬁ¨ôyGPIO_2
:1;

1829 
USHORT
 
	mPﬁ¨ôyGPIO_1
:1;

1830 
USHORT
 
	mPﬁ¨ôyGPIO_0
:1;

1831 
USHORT
 
	mPﬁ¨ôyACT
:1;

1832 
USHORT
 
	mPﬁ¨ôyRDY_A
:1;

1833 
USHORT
 
	mPﬁ¨ôyRDY_G
:1;

1834 } 
	mfõld
;

1835 
USHORT
 
	mw‹d
;

1836 } 
	tEEPROM_LED_STRUC
, *
	tPEEPROM_LED_STRUC
;

1838 
	u_EEPROM_LED_STRUC
 {

1840 
USHORT
 
	mPﬁ¨ôyRDY_G
:1;

1841 
USHORT
 
	mPﬁ¨ôyRDY_A
:1;

1842 
USHORT
 
	mPﬁ¨ôyACT
:1;

1843 
USHORT
 
	mPﬁ¨ôyGPIO_0
:1;

1844 
USHORT
 
	mPﬁ¨ôyGPIO_1
:1;

1845 
USHORT
 
	mPﬁ¨ôyGPIO_2
:1;

1846 
USHORT
 
	mPﬁ¨ôyGPIO_3
:1;

1847 
USHORT
 
	mPﬁ¨ôyGPIO_4
:1;

1848 
USHORT
 
	mLedMode
:5;

1849 
USHORT
 
	mRsvd
:3;

1850 } 
	mfõld
;

1851 
USHORT
 
	mw‹d
;

1852 } 
	tEEPROM_LED_STRUC
, *
	tPEEPROM_LED_STRUC
;

1855 #ifde‡
BIG_ENDIAN


1856 
	u_EEPROM_TXPOWER_DELTA_STRUC
 {

1858 
UCHAR
 
	mTxPowîE«bÀ
:1;

1859 
UCHAR
 
	mTy≥
:1;

1860 
UCHAR
 
	mDñèVÆue
:6;

1861 } 
	mfõld
;

1862 
UCHAR
 
	mvÆue
;

1863 } 
	tEEPROM_TXPOWER_DELTA_STRUC
, *
	tPEEPROM_TXPOWER_DELTA_STRUC
;

1865 
	u_EEPROM_TXPOWER_DELTA_STRUC
 {

1867 
UCHAR
 
	mDñèVÆue
:6;

1868 
UCHAR
 
	mTy≥
:1;

1869 
UCHAR
 
	mTxPowîE«bÀ
:1;

1870 } 
	mfõld
;

1871 
UCHAR
 
	mvÆue
;

1872 } 
	tEEPROM_TXPOWER_DELTA_STRUC
, *
	tPEEPROM_TXPOWER_DELTA_STRUC
;

1875 
	#BUILD_TIMER_FUNCTION
(
_func
) \

1876 
löux_
##
	`_func
(
d©a
) \

1878 
PRALINK_TIMER_STRUCT
 
pTimî
 = (PRALINK_TIMER_STRUCTË
d©a
; \

1879 
timeout
; \

1880 
	`_func
(
NULL
, (
PVOID
Ë
pTimî
->
cookõ
, NULL,ÖTimer); \

1881 i‡(
pTimî
->
Rïót
) \

1882 { 
timeout
=
pTimî
->
TimîVÆue
; \

1883 
timeout
=(—imeout*
HZ
) / 1000); \

1884 
pTimî
->
TimîObj
.
expúes
 = 
jiffõs
 + 
timeout
; \

1885 
	`add_timî
(&
pTimî
->
TimîObj
);} \

1886 }

	)

1889 
	#DECLARE_TIMER_FUNCTION
(
_func
) \

1890 
löux_
##
	`_func
(
d©a
)

	)

1892 
	#GET_TIMER_FUNCTION
(
_func
) \

1893 
löux_
##
_func


	)

1896 
DECLARE_TIMER_FUNCTION
(
MlmePîiodicExec
);

1897 
DECLARE_TIMER_FUNCTION
(
AsicRxA¡EvÆTimeout
);

1898 
DECLARE_TIMER_FUNCTION
(
LökDownExec
);

1899 
DECLARE_TIMER_FUNCTION
(
Bóc⁄Timeout
);

1900 
DECLARE_TIMER_FUNCTION
(
SˇnTimeout
);

1901 
DECLARE_TIMER_FUNCTION
(
AssocTimeout
);

1902 
DECLARE_TIMER_FUNCTION
(
RóssocTimeout
);

1903 
DECLARE_TIMER_FUNCTION
(
DißssocTimeout
);

1904 
DECLARE_TIMER_FUNCTION
(
AuthTimeout
);

1905 
DECLARE_TIMER_FUNCTION
(
SèQuickRe•⁄eF‹R©eUpExec
);

	@rt73.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

7 
moduÀ
 
__this_moduÀ


8 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

9 .
«me
 = 
KBUILD_MODNAME
,

10 .
	göô
 = 
öô_moduÀ
,

11 #ifde‡
CONFIG_MODULE_UNLOAD


12 .
	gexô
 = 
˛ónup_moduÀ
,

14 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

17 c⁄° 
	g__moduÀ_dïíds
[]

18 
__©åibuã_u£d__


19 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

22 
MODULE_ALIAS
("usb:v148Fp2573d*dc*dsc*dp*ic*isc*ip*");

23 
MODULE_ALIAS
("usb:v148Fp2671d*dc*dsc*dp*ic*isc*ip*");

24 
MODULE_ALIAS
("usb:v04BBp093Dd*dc*dsc*dp*ic*isc*ip*");

25 
MODULE_ALIAS
("usb:v18E8p6196d*dc*dsc*dp*ic*isc*ip*");

26 
MODULE_ALIAS
("usb:v18E8p6229d*dc*dsc*dp*ic*isc*ip*");

27 
MODULE_ALIAS
("usb:v18E8p6238d*dc*dsc*dp*ic*isc*ip*");

28 
MODULE_ALIAS
("usb:v1044p8008d*dc*dsc*dp*ic*isc*ip*");

29 
MODULE_ALIAS
("usb:v14B2p3C22d*dc*dsc*dp*ic*isc*ip*");

30 
MODULE_ALIAS
("usb:v0DB0p6877d*dc*dsc*dp*ic*isc*ip*");

31 
MODULE_ALIAS
("usb:v0DB0pA874d*dc*dsc*dp*ic*isc*ip*");

32 
MODULE_ALIAS
("usb:v0DB0pA861d*dc*dsc*dp*ic*isc*ip*");

33 
MODULE_ALIAS
("usb:v07B8pB21Dd*dc*dsc*dp*ic*isc*ip*");

34 
MODULE_ALIAS
("usb:v0769p31F3d*dc*dsc*dp*ic*isc*ip*");

35 
MODULE_ALIAS
("usb:v1472p0009d*dc*dsc*dp*ic*isc*ip*");

36 
MODULE_ALIAS
("usb:v1371p9022d*dc*dsc*dp*ic*isc*ip*");

37 
MODULE_ALIAS
("usb:v1371p9032d*dc*dsc*dp*ic*isc*ip*");

38 
MODULE_ALIAS
("usb:v1631pC019d*dc*dsc*dp*ic*isc*ip*");

39 
MODULE_ALIAS
("usb:v1044p800Ad*dc*dsc*dp*ic*isc*ip*");

40 
MODULE_ALIAS
("usb:v1690p0722d*dc*dsc*dp*ic*isc*ip*");

41 
MODULE_ALIAS
("usb:v0DF6p9712d*dc*dsc*dp*ic*isc*ip*");

42 
MODULE_ALIAS
("usb:v0DF6p90ACd*dc*dsc*dp*ic*isc*ip*");

43 
MODULE_ALIAS
("usb:v148Fp9021d*dc*dsc*dp*ic*isc*ip*");

44 
MODULE_ALIAS
("usb:v0EB0p9021d*dc*dsc*dp*ic*isc*ip*");

45 
MODULE_ALIAS
("usb:v0411p00D8d*dc*dsc*dp*ic*isc*ip*");

46 
MODULE_ALIAS
("usb:v0586p3415d*dc*dsc*dp*ic*isc*ip*");

47 
MODULE_ALIAS
("usb:v0B05p1723d*dc*dsc*dp*ic*isc*ip*");

48 
MODULE_ALIAS
("usb:v0B05p1724d*dc*dsc*dp*ic*isc*ip*");

49 
MODULE_ALIAS
("usb:v050Dp705Ad*dc*dsc*dp*ic*isc*ip*");

50 
MODULE_ALIAS
("usb:v07D1p3C03d*dc*dsc*dp*ic*isc*ip*");

51 
MODULE_ALIAS
("usb:v13B1p0023d*dc*dsc*dp*ic*isc*ip*");

52 
MODULE_ALIAS
("usb:v13B1p0020d*dc*dsc*dp*ic*isc*ip*");

	@rt_config.h

38 #i‚def 
__RT_CONFIG_H__


39 
	#__RT_CONFIG_H__


	)

41 
	#PROFILE_PATH
 "/ëc/Wúñess/RT73STA/π73°a.d©"

	)

42 
	#NIC_DEVICE_NAME
 "RT73STA"

	)

43 
	#RT2573_IMAGE_FILE_NAME
 "/ëc/Wúñess/RT73STA/π73.bö"

	)

44 
	#RALINK_PASSPHRASE
 "RÆök"

	)

45 
	#DRIVER_VERSION
 "1.1.0.0"

	)

48 
	#DRV_MAJORVERSION
 1

	)

49 
	#DRV_MINORVERSION
 1

	)

50 
	#DRV_SUBVERSION
 0

	)

51 
	#DRV_TESTVERSION
 0

	)

52 
	#DRV_YEAR
 2008

	)

53 
	#DRV_MONTH
 1

	)

54 
	#DRV_DAY
 9

	)

57 #i‡!
deföed
(
__OPTIMIZE__
Ë|| !deföed(
__KERNEL__
)

58 #w¨nög 
You
 
mu°
 
compûe
 
this
 
fûe
 
wôh
 
the
 
c‹ª˘
 
›ti⁄s
!

59 #w¨nög 
Sì
 
the
 
œ°
 
löes
 
of
Åhê
sour˚
 
fûe
.

60 #îr‹ 
You
 
mu°
 
compûe
 
this
 
drivî
 
wôh
 "-O".

63 
	~<löux/moduÀ.h
>

64 
	~<löux/vîsi⁄.h
>

65 
	~<löux/kî√l.h
>

67 
	~<löux/öô.h
>

68 
	~<löux/°rög.h
>

69 
	~<löux/timî.h
>

70 
	~<löux/î∫o.h
>

71 
	~<löux/¶ab.h
>

73 
	~<löux/pci.h
>

74 
	~<löux/√tdevi˚.h
>

75 
	~<löux/ëhîdevi˚.h
>

76 
	~<löux/skbuff.h
>

77 
	~<löux/ëhtoﬁ.h
>

78 
	~<löux/wúñess.h
>

79 
	~<löux/¥oc_fs.h
>

80 
	~<löux/dñay.h
>

81 
	~<löux/if_¨p.h
>

82 
	~<löux/˘y≥.h
>

83 
	~<löux/sched.h
>

84 
	~<löux/smp_lock.h
>

85 
	~<löux/kmod.h
>

86 
	~<löux/i›‹t.h
>

87 
	~<löux/thªads.h
>

88 
	~<löux/vmÆloc.h
>

91 
	~<löux/usb.h
>

93 #i‡
LINUX_VERSION_CODE
 >= 0x20407

94 
	~<löux/mii.h
>

96 
	~<asm/¥o˚ss‹.h
>

97 
	~<asm/bô›s.h
>

98 
	~<asm/io.h
>

99 
	~<asm/úq.h
>

100 
	~<asm/uac˚ss.h
>

101 
	~<asm/©omic.h
>

105 
	#__KERNEL_SYSCALLS__


	)

106 
	~<löux/uni°d.h
>

110 #i‚de‡
ULONG


111 
	#CHAR
 

	)

112 
	#INT
 

	)

113 
	#SHORT
 

	)

114 
	#UINT
 
u32


	)

115 
	#ULONG
 
u32


	)

116 
	#USHORT
 
u16


	)

117 
	#UCHAR
 
u8


	)

119 
	#uöt32
 
u32


	)

120 
	#uöt8
 
u8


	)

123 
	#BOOLEAN
 
u8


	)

125 
	#VOID
 

	)

126 
	#LONG
 

	)

127 
	#LONGLONG
 
s64


	)

128 
	#ULONGLONG
 
u64


	)

129 
VOID
 *
	tPVOID
;

130 
CHAR
 *
	tPCHAR
;

131 
UCHAR
 *
	tPUCHAR
;

132 
USHORT
 *
	tPUSHORT
;

133 
LONG
 *
	tPLONG
;

134 
ULONG
 *
	tPULONG
;

136 
	u_LARGE_INTEGER
 {

137 #ifde‡
BIG_ENDIAN


139 
LONG
 
	mHighP¨t
;

140 
ULONG
 
	mLowP¨t
;

141 }
	mvv
;

143 
LONG
 
	mHighP¨t
;

144 
ULONG
 
	mLowP¨t
;

145 } 
	mu
;

148 
ULONG
 
	mLowP¨t
;

149 
LONG
 
	mHighP¨t
;

150 }
	mvv
;

152 
ULONG
 
	mLowP¨t
;

153 
LONG
 
	mHighP¨t
;

154 } 
	mu
;

157 
s64
 
	mQuadP¨t
;

158 } 
	tLARGE_INTEGER
;

163 
	#IN


	)

164 
	#OUT


	)

166 
	#TRUE
 1

	)

167 
	#FALSE
 0

	)

169 
	#ETH_LENGTH_OF_ADDRESS
 6

170 

	)

171 
	#NDIS_STATUS
 
INT


	)

172 
	#NDIS_STATUS_SUCCESS
 0x00

	)

173 
	#NDIS_STATUS_FAILURE
 0x01

	)

174 
	#NDIS_STATUS_RESOURCES
 0x03

	)

175 
	#NDIS_STATUS_MEDIA_DISCONNECT
 0x04

	)

176 
	#NDIS_STATUS_MEDIA_CONNECT
 0x05

	)

177 
	#NDIS_STATUS_RESET
 0x06

	)

186 #i‡
deföed
(
RALINK_WPA_SUPPLICANT_SUPPORT
Ë&& deföed(
NATIVE_WPA_SUPPLICANT_SUPPORT
)

190 #i‡
WIRELESS_EXT
 < 15

191 #i‡
deföed
(
RALINK_WPA_SUPPLICANT_SUPPORT
Ë|| deföed(
NATIVE_WPA_SUPPLICANT_SUPPORT
)

200 
	~"π73.h
"

206 
	~"πmp_ty≥.h
"

207 
	~"πmp_def.h
"

208 
	~"oid.h
"

209 
	~"mlme.h
"

210 
	~"md5.h
"

211 
	~"w∑.h
"

212 
	~"πmp.h
"

214 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


215 
	~"πmp_wext.h
"

217 
	#MAX_WPA_IE_LEN
 64

219 

	)

220 #ifde‡
BLOCK_NET_IF


221 
	~"√tif_block.h
"

225 #i‚de‡
NR_CPUS


226 
	#NR_CPUS
 1

	)

228 #i‡
NR_CPUS
 > 1

229 
	#MEM_ALLOC_FLAG
 
GFP_ATOMIC


	)

231 
	#MEM_ALLOC_FLAG
 (
GFP_DMA
 | 
GFP_ATOMIC
)

	)

234 #i‚de‡
KERNEL_VERSION


235 
	#KERNEL_VERSION
(
a
,
b
,
c
Ë(◊)*65536+(b)*256+(c))

	)

238 #i‡
LINUX_VERSION_CODE
 >
KERNEL_VERSION
(2,5,0)

239 
	#πusb_submô_urb
(
purb
Ë
	`usb_submô_urb
’urb, 
GFP_KERNEL
)

	)

241 
	#πusb_submô_urb
(
purb
Ë
	`usb_submô_urb
’urb)

	)

245 
	#RAUSB0_IF_UP_CHECK
(
_pAd
Ë(((_pAd)->
√t_dev
Ë&& ((_pAd)->√t_dev->
Êags
 & 
IFF_UP
))

	)

247 #i‚de‡
USB_ST_NOERROR


248 
	#USB_ST_NOERROR
 0

	)

251 
	#READ_PROFILE_FROM_FILE


252 
	#INIT_FROM_EEPROM


	)

	@rt_user.c

56 
	~<°dio.h
>

57 
	~<°dlib.h
>

58 
	~<°rög.h
>

59 
	~<sys/sockë.h
>

60 
	~<sys/io˘l.h
>

61 
	~<uni°d.h
>

62 
	~<löux/wúñess.h
>

66 #i‡
WIRELESS_EXT
 <= 11

67 #i‚de‡
SIOCDEVPRIVATE


68 
	#SIOCDEVPRIVATE
 0x8BE0

	)

70 
	#SIOCIWFIRSTPRIV
 
SIOCDEVPRIVATE


	)

82 
	#RT_PRIV_IOCTL
 (
SIOCIWFIRSTPRIV
 + 0x0E)

	)

83 
	#RTPRIV_IOCTL_SET
 (
SIOCIWFIRSTPRIV
 + 0x02)

	)

84 
	#RTPRIV_IOCTL_BBP
 (
SIOCIWFIRSTPRIV
 + 0x03)

	)

85 
	#RTPRIV_IOCTL_MAC
 (
SIOCIWFIRSTPRIV
 + 0x05)

	)

86 
	#RTPRIV_IOCTL_E2P
 (
SIOCIWFIRSTPRIV
 + 0x11)

	)

87 
	#RTPRIV_IOCTL_STATISTICS
 (
SIOCIWFIRSTPRIV
 + 0x09)

	)

88 
	#RTPRIV_IOCTL_GSITESURVEY
 (
SIOCIWFIRSTPRIV
 + 0x0D)

	)

91 
	#OID_GET_SET_TOGGLE
 0x8000

	)

93 
	#RT_QUERY_ATE_TXDONE_COUNT
 0x0401

	)

94 
	#RT_QUERY_SIGNAL_CONTEXT
 0x0402

	)

95 
	#RT_SET_APD_PID
 (
OID_GET_SET_TOGGLE
 + 0x0405)

	)

96 
	#RT_SET_DEL_MAC_ENTRY
 (
OID_GET_SET_TOGGLE
 + 0x0406)

	)

100 
	#OID_802_11_MESH_SECURITY_INFO
 0x0651

	)

101 
	#OID_802_11_MESH_ID
 0x0652

	)

102 
	#OID_802_11_MESH_AUTO_LINK
 0x0653

	)

103 
	#OID_802_11_MESH_LINK_STATUS
 0x0654

	)

104 
	#OID_802_11_MESH_LIST
 0x0655

	)

105 
	#OID_802_11_MESH_ROUTE_LIST
 0x0656

	)

106 
	#OID_802_11_MESH_ADD_LINK
 0x0657

	)

107 
	#OID_802_11_MESH_DEL_LINK
 0x0658

	)

108 
	#OID_802_11_MESH_MAX_TX_RATE
 0x0659

	)

109 
	#OID_802_11_MESH_CHANNEL
 0x065A

	)

111 
	#RT_OID_802_11_MESH_SECURITY_INFO
 (
OID_GET_SET_TOGGLE
 + 
OID_802_11_MESH_SECURITY_INFO
)

	)

112 
	#RT_OID_802_11_MESH_ID
 (
OID_GET_SET_TOGGLE
 + 
OID_802_11_MESH_ID
)

	)

113 
	#RT_OID_802_11_MESH_AUTO_LINK
 (
OID_GET_SET_TOGGLE
 + 
OID_802_11_MESH_AUTO_LINK
)

	)

114 
	#RT_OID_802_11_MESH_ADD_LINK
 (
OID_GET_SET_TOGGLE
 + 
OID_802_11_MESH_ADD_LINK
)

	)

115 
	#RT_OID_802_11_MESH_DEL_LINK
 (
OID_GET_SET_TOGGLE
 + 
OID_802_11_MESH_DEL_LINK
)

	)

116 
	#RT_OID_802_11_MESH_MAX_TX_RATE
 (
OID_GET_SET_TOGGLE
 + 
OID_802_11_MESH_MAX_TX_RATE
)

	)

117 
	#RT_OID_802_11_MESH_CHANNEL
 (
OID_GET_SET_TOGGLE
 + 
OID_802_11_MESH_CHANNEL
)

	)

121 #i‚de‡ 
TRUE


122 
	#TRUE
 1

	)

125 #i‚de‡ 
FALSE


126 
	#FALSE
 0

	)

129 
	#MAC_ADDR_LEN
 6

	)

130 
	#ETH_LENGTH_OF_ADDRESS
 6

	)

131 
	#MAX_LEN_OF_MAC_TABLE
 64

	)

133 
	#MAX_MESH_ID_LEN
 32

	)

134 
	#MAX_NEIGHBOR_NUM
 64

	)

135 
	#MAX_MESH_LINK_NUM
 4

	)

136 
	#MAX_HOST_NAME_LEN
 32

	)

138 
	#PACKED
 
	`__©åibuã__
 ((
∑cked
))

	)

142 
	#MESH_MAX_LEN_OF_FORWARD_TABLE
 48

	)

144 
	s_RT_MESH_ROUTE_ENTRY


146 
	mMeshDA
[
MAC_ADDR_LEN
];

147 
	mD¢
;

148 
	mNextH›
[
MAC_ADDR_LEN
];

149 
	mMëric
;

150 } 
	tRT_MESH_ROUTE_ENTRY
, *
	tPRT_MESH_ROUTE_ENTRY
;

152 
	s_RT_MESH_ROUTE_TABLE


154 
	mNum
;

155 
RT_MESH_ROUTE_ENTRY
 
	mE¡ry
[
MESH_MAX_LEN_OF_FORWARD_TABLE
];

156 } 
	tRT_MESH_ROUTE_TABLE
, *
	tPRT_MESH_ROUTE_TABLE
;

158 
PACKED
 
	t_MESH_SECURITY_INFO


160 
	gLígth
;

161 
	gEn¸ypTy≥
;

162 
	gKeyIndex
;

163 
	gKeyLígth
;

164 
	gKeyM©îül
[64];

165 } 
	tMESH_SECURITY_INFO
, *
	tPMESH_SECURITY_INFO
;

167 
	s_MESH_NEIGHBOR_ENTRY_INFO


169 
	mRssi
;

170 
	mHo°Name
[
MAX_HOST_NAME_LEN
];

171 
	mMacAddr
[
MAC_ADDR_LEN
];

172 
	mMeshId
[
MAX_MESH_ID_LEN
];

173 
	mCh™√l
;

174 
	mSètus
;

175 
	mMeshEn¸ypTy≥
;

176 } 
	tMESH_NEIGHBOR_ENTRY_INFO
, *
	tPMESH_NEIGHBOR_ENTRY_INFO
;

178 
	s_MESH_NEIGHBOR_INFO


180 
	mnum
;

181 
MESH_NEIGHBOR_ENTRY_INFO
 
	mE¡ry
[
MAX_NEIGHBOR_NUM
];

182 } 
	tMESH_NEIGHBOR_INFO
, *
	tPMESH_NEIGHBOR_INFO
;

184 
	s_MESH_LINK_ENTRY_INFO


186 
	mSètus
;

187 
	mRssi
;

188 
	mCurTxR©e
;

189 
	mPìrMacAddr
[
MAC_ADDR_LEN
];

190 } 
	tMESH_LINK_ENTRY_INFO
, *
	tPMESH_LINK_ENTRY_INFO
;

192 
	s_MESH_LINK_INFO


194 
MESH_LINK_ENTRY_INFO
 
	mE¡ry
[
MAX_MESH_LINK_NUM
];

195 } 
	tMESH_LINK_INFO
, *
	tPMESH_LINK_INFO
;

202 
	$maö
–
¨gc
, ** 
¨gv
 )

204 
	#DATA_BUFFER_SIZE
 8192

	)

205 
«me
[25];

206 
sockë_id
;

207 
iwªq
 
wrq
;

208 
ªt
 = 1, 
cmd
 = 0;

209 *
ba£
;

210 *
d©a
;

213 
sockë_id
 = 
	`sockë
(
AF_INET
, 
SOCK_DGRAM
, 0);

214 if(
sockë_id
 < 0)

216 
	`¥ötf
("\nrtuser::error::Open socketÉrror!\n\n");

220 
d©a
 = 
	`mÆloc
(
DATA_BUFFER_SIZE
);

221 i‡(
d©a
 =
NULL
)

223 
	`¥ötf
("u«bÀÅÿÆlo¯d©®buf„r, sizê(%d)\n", 
DATA_BUFFER_SIZE
);

228 
	`•rötf
(
«me
, "mesh0");

229 
	`mem£t
(
d©a
, 0, 
DATA_BUFFER_SIZE
);

234 
ba£
 = 
¨gv
[1];

237 if(
¨gc
 != 2)

238 
πu£r_exô
;

240 if(
	`°r°r
(
ba£
, "OID_802_11_MESH_ROUTE_LIST"))

241 
cmd
 = 
OID_802_11_MESH_ROUTE_LIST
;

242 if(
	`°r°r
(
ba£
, "RT_OID_802_11_MESH_SECURITY_INFO"))

243 
cmd
 = 
RT_OID_802_11_MESH_SECURITY_INFO
;

244 if(
	`°r°r
(
ba£
, "OID_802_11_MESH_SECURITY_INFO"))

245 
cmd
 = 
OID_802_11_MESH_SECURITY_INFO
;

246 if(
	`°r°r
(
ba£
, "RT_OID_802_11_MESH_ID"))

247 
cmd
 = 
RT_OID_802_11_MESH_ID
;

248 if(
	`°r°r
(
ba£
, "OID_802_11_MESH_ID"))

249 
cmd
 = 
OID_802_11_MESH_ID
;

250 if(
	`°r°r
(
ba£
, "RT_OID_802_11_MESH_AUTO_LINK"))

251 
cmd
 = 
RT_OID_802_11_MESH_AUTO_LINK
;

252 if(
	`°r°r
(
ba£
, "OID_802_11_MESH_AUTO_LINK"))

253 
cmd
 = 
OID_802_11_MESH_AUTO_LINK
;

254 if(
	`°r°r
(
ba£
, "RT_OID_802_11_MESH_ADD_LINK"))

255 
cmd
 = 
RT_OID_802_11_MESH_ADD_LINK
;

256 if(
	`°r°r
(
ba£
, "RT_OID_802_11_MESH_DEL_LINK"))

257 
cmd
 = 
RT_OID_802_11_MESH_DEL_LINK
;

258 if(
	`°r°r
(
ba£
, "OID_802_11_MESH_LINK_STATUS"))

259 
cmd
 = 
OID_802_11_MESH_LINK_STATUS
;

260 if(
	`°r°r
(
ba£
, "OID_802_11_MESH_LIST"))

261 
cmd
 = 
OID_802_11_MESH_LIST
;

262 i‡(
	`°r°r
(
ba£
, "RT_OID_802_11_MESH_CHANNEL"))

263 
cmd
 = 
RT_OID_802_11_MESH_CHANNEL
;

264 i‡(
	`°r°r
(
ba£
, "OID_802_11_MESH_CHANNEL"))

265 
cmd
 = 
OID_802_11_MESH_CHANNEL
;

266 i‡(
	`°r°r
(
ba£
, "RT_OID_802_11_MESH_MAX_TX_RATE"))

267 
cmd
 = 
RT_OID_802_11_MESH_MAX_TX_RATE
;

268 i‡(
	`°r°r
(
ba£
, "OID_802_11_MESH_MAX_TX_RATE"))

269 
cmd
 = 
OID_802_11_MESH_MAX_TX_RATE
;

271 
cmd
)

273 
OID_802_11_MESH_ROUTE_LIST
:

275 
RT_MESH_ROUTE_TABLE
 *
•
;

276 
i
;

279 
	`¥ötf
("\nrtuser::get OID_802_11_MESH_ROUTE_LIST \n\n");

280 
	`mem£t
(
d©a
, 0, (
RT_MESH_ROUTE_TABLE
));

281 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

282 
wrq
.
u
.
d©a
.
Àngth
 = (
RT_MESH_ROUTE_TABLE
);

283 
wrq
.
u
.
d©a
.
poöãr
 = data;

284 
wrq
.
u
.
d©a
.
Êags
 = 
OID_802_11_MESH_ROUTE_LIST
;

285 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

287 if(
ªt
 != 0)

289 
	`¥ötf
("\nrtuser::error::get OID_802_11_MESH_ROUTE_LIST\n\n");

290 
πu£r_exô
;

293 
•
 = (
RT_MESH_ROUTE_TABLE
 *)
wrq
.
u
.
d©a
.
poöãr
;

294 
	`¥ötf
("\n===== MESH_ROUTE_TABLE =====\n\n");

295 
i
 = 0; i < 
•
->
Num
; i++)

297 
	`¥ötf
("Dest Mesh Addr = %02x:%02x:%02x:%02x:%02x:%02x\n",

298 
•
->
E¡ry
[
i
].
MeshDA
[0], sp->Entry[i].MeshDA[1],

299 
•
->
E¡ry
[
i
].
MeshDA
[2], sp->Entry[i].MeshDA[3],

300 
•
->
E¡ry
[
i
].
MeshDA
[4], sp->Entry[i].MeshDA[5]);

301 
	`¥ötf
("D¢ = %ld\n", 
•
->
E¡ry
[
i
].
D¢
);

302 
	`¥ötf
("NextHop Addr = %02x:%02x:%02x:%02x:%02x:%02x\n",

303 
•
->
E¡ry
[
i
].
NextH›
[0], sp->Entry[i].NextHop[1],

304 
•
->
E¡ry
[
i
].
NextH›
[2], sp->Entry[i].NextHop[3],

305 
•
->
E¡ry
[
i
].
NextH›
[4], sp->Entry[i].NextHop[5]);

306 
	`¥ötf
("Mëri¯ = %ld\n\n", 
•
->
E¡ry
[
i
].
Mëric
);

311 
OID_802_11_MESH_SECURITY_INFO
:

313 
PMESH_SECURITY_INFO
 
pMeshSecurôy
;

316 
	`¥ötf
("\nrtuser::OID_802_11_MESH_SECURITY_INFO \n\n");

317 
	`mem£t
(
d©a
, 0, (
MESH_SECURITY_INFO
));

319 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

320 
wrq
.
u
.
d©a
.
Àngth
 = (
MESH_SECURITY_INFO
);

321 
wrq
.
u
.
d©a
.
poöãr
 = data;

322 
wrq
.
u
.
d©a
.
Êags
 = 
OID_802_11_MESH_SECURITY_INFO
;

323 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

325 if(
ªt
 != 0)

327 
	`¥ötf
("\nrtuser::error::get mesh security\n\n");

328 
πu£r_exô
;

331 
pMeshSecurôy
 = (
PMESH_SECURITY_INFO
)
wrq
.
u
.
d©a
.
poöãr
;

334 
pMeshSecurôy
->
En¸ypTy≥
)

337 
	`¥ötf
("Mesh Encryption is OPEN-NONE\n\n");

341 
	`¥ötf
("Mesh Encryption is OPEN-WEP\n\n");

345 
	`¥ötf
("Mesh Encryption is WPANONE-TKIP\n\n");

349 
	`¥ötf
("Mesh Encryption is WPANONE-AES\n\n");

353 
	`¥ötf
("Unsupported Mesh Encryption Type\n\n");

358 i‡(
pMeshSecurôy
->
KeyLígth
 > 0)

360 
	`¥ötf
("Key=%s,Üígth=%d\n", 
pMeshSecurôy
->
KeyM©îül
,ÖMeshSecurôy->
KeyLígth
);

361 
	`¥ötf
("Thêkey Index = %d \n", 
pMeshSecurôy
->
KeyIndex
);

367 
RT_OID_802_11_MESH_SECURITY_INFO
:

369 
MESH_SECURITY_INFO
 
MeshSecurôy
;

372 
En¸ypTy≥
 = 0;

373 
KeyIndex
 = 1;

374 c⁄° *
MeshKey
 = "12345678";

377 
	`¥ötf
("\nrtuser::set mesh security \n\n");

378 
	`mem£t
(&
MeshSecurôy
, 0, (
MESH_SECURITY_INFO
));

381 i‡(
En¸ypTy≥
 == 1)

383 i‡((
	`°æí
(
MeshKey
) == 5) || (strlen(MeshKey) == 13) ||

384 (
	`°æí
(
MeshKey
) == 10) || (strlen(MeshKey) == 26))

386 
	`¥ötf
("set securityás OPEN-WEP\n\n");

387 
MeshSecurôy
.
KeyLígth
 = 
	`°æí
(
MeshKey
);

388 
	`mem˝y
(
MeshSecurôy
.
KeyM©îül
, 
MeshKey
, MeshSecurôy.
KeyLígth
);

392 
	`¥ötf
("set mesh security::invalid WEP keyánd set securityás OPEN-NONE\n\n");

393 
En¸ypTy≥
 = 0;

396 i‡((
En¸ypTy≥
 == 2) || (EncrypType == 3))

399 i‡((
	`°æí
(
MeshKey
) >= 8) && (strlen(MeshKey) <= 64))

401 
	`¥ötf
("£à£curôyá†%s\n\n", (
En¸ypTy≥
 == 2) ? "WPANONE-TKIP" : "WPANONE-AES");

402 
MeshSecurôy
.
KeyLígth
 = 
	`°æí
(
MeshKey
);

403 
	`mem˝y
(
MeshSecurôy
.
KeyM©îül
, 
MeshKey
, MeshSecurôy.
KeyLígth
);

407 
	`¥ötf
("set mesh security::invalid WPA keyánd set securityás OPEN-NONE\n\n");

408 
En¸ypTy≥
 = 0;

413 
	`¥ötf
("set securityás OPEN-NONE\n\n");

414 
En¸ypTy≥
 = 0;

418 
MeshSecurôy
.
En¸ypTy≥
 = EncrypType;

421 i‡(
KeyIndex
 >= 1 && KeyIndex <= 4)

422 
MeshSecurôy
.
KeyIndex
 = KeyIndex;

424 
MeshSecurôy
.
KeyIndex
 = 1;

427 i‡((
En¸ypTy≥
 == 2) || (EncrypType == 3))

428 
MeshSecurôy
.
KeyIndex
 = 1;

430 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

431 
wrq
.
u
.
d©a
.
Àngth
 = (
MESH_SECURITY_INFO
);

432 
wrq
.
u
.
d©a
.
poöãr
 = (*)&
MeshSecurôy
;

433 
wrq
.
u
.
d©a
.
Êags
 = 
RT_OID_802_11_MESH_SECURITY_INFO
;

434 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

436 if(
ªt
 != 0)

438 
	`¥ötf
("\nrtuser::error::set mesh security\n\n");

439 
πu£r_exô
;

444 
OID_802_11_MESH_ID
:

447 
	`¥ötf
("\nrtuser::set OID_802_11_MESH_ID \n\n");

449 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

450 
wrq
.
u
.
d©a
.
Àngth
 = 
MAX_MESH_ID_LEN
;

451 
wrq
.
u
.
d©a
.
poöãr
 = data;

452 
wrq
.
u
.
d©a
.
Êags
 = 
OID_802_11_MESH_ID
;

453 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

455 if(
ªt
 != 0)

457 
	`¥ötf
("\nrtuser::error::get mesh id\n\n");

458 
πu£r_exô
;

461 
	`¥ötf
("Mesh-Id=%s\n", (*)
wrq
.
u
.
d©a
.
poöãr
);

465 
RT_OID_802_11_MESH_ID
:

467 
MeshId
[
MAX_MESH_ID_LEN
];

470 
	`¥ötf
("\nrtuser::set RT_OID_802_11_MESH_ID \n\n");

471 
	`mem£t
(
MeshId
, 0, (
MAX_MESH_ID_LEN
));

472 
	`mem˝y
(
MeshId
, "Sam∂eMesh", 
	`°æí
("SampleMesh") + 1);

474 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

475 
wrq
.
u
.
d©a
.
Àngth
 = 
	`°æí
("SampleMesh");

476 
wrq
.
u
.
d©a
.
poöãr
 = (*)&
MeshId
;

477 
wrq
.
u
.
d©a
.
Êags
 = 
RT_OID_802_11_MESH_ID
;

478 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

480 if(
ªt
 != 0)

482 
	`¥ötf
("\nrtuser::error::set mesh Id\n\n");

483 
πu£r_exô
;

488 
OID_802_11_MESH_AUTO_LINK
:

490 
MeshAutoLök
;

492 
	`¥ötf
("\nrtuser::set OID_802_11_MESH_AUTO_LINK \n\n");

495 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

496 
wrq
.
u
.
d©a
.
Àngth
 = 1;

497 
wrq
.
u
.
d©a
.
poöãr
 = (*)&
MeshAutoLök
;

498 
wrq
.
u
.
d©a
.
Êags
 = 
OID_802_11_MESH_AUTO_LINK
;

499 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

501 if(
ªt
 != 0)

503 
	`¥ötf
("\nrtuser::error::get mesháutoÜink setting\n\n");

504 
πu£r_exô
;

507 
	`¥ötf
("Mesh-AutÿLök=%s\n", 
MeshAutoLök
 == 1 ? "Enable" : "Disable");

511 
RT_OID_802_11_MESH_AUTO_LINK
:

513 
MeshAutoLök
;

516 
	`¥ötf
("\nrtuser::set RT_OID_802_11_MESH_AUTO_LINK \n\n");

517 
MeshAutoLök
 = 0;

519 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

520 
wrq
.
u
.
d©a
.
Àngth
 = ();

521 
wrq
.
u
.
d©a
.
poöãr
 = (*)&
MeshAutoLök
;

522 
wrq
.
u
.
d©a
.
Êags
 = 
RT_OID_802_11_MESH_AUTO_LINK
;

523 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

525 if(
ªt
 != 0)

527 
	`¥ötf
("\nrtuser::error::set mesháutoÜink\n\n");

528 
πu£r_exô
;

533 
RT_OID_802_11_MESH_ADD_LINK
:

535 
PìrMac
[
MAC_ADDR_LEN
] = {0x0, 0xc, 0x43, 0x28, 0x61, 0x10};

538 
	`¥ötf
("\nrtuser::set RT_OID_802_11_MESH_ADD_LINK \n\n");

540 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

541 
wrq
.
u
.
d©a
.
Àngth
 = (
PìrMac
);

542 
wrq
.
u
.
d©a
.
poöãr
 = (*)&
PìrMac
;

543 
wrq
.
u
.
d©a
.
Êags
 = 
RT_OID_802_11_MESH_ADD_LINK
;

544 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

546 if(
ªt
 != 0)

548 
	`¥ötf
("\nrtuser::error::set mesháddÜink\n\n");

549 
πu£r_exô
;

554 
RT_OID_802_11_MESH_DEL_LINK
:

556 
PìrMac
[
MAC_ADDR_LEN
] = {0x0, 0xc, 0x43, 0x28, 0x61, 0x10};

559 
	`¥ötf
("\nrtuser::set RT_OID_802_11_MESH_DEL_LINK \n\n");

561 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

562 
wrq
.
u
.
d©a
.
Àngth
 = (
PìrMac
);

563 
wrq
.
u
.
d©a
.
poöãr
 = (*)&
PìrMac
;

564 
wrq
.
u
.
d©a
.
Êags
 = 
RT_OID_802_11_MESH_DEL_LINK
;

565 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

567 if(
ªt
 != 0)

569 
	`¥ötf
("\nrtuser::error::set mesh delÜink\n\n");

570 
πu£r_exô
;

575 
OID_802_11_MESH_LINK_STATUS
:

577 
PMESH_LINK_INFO
 
pMeshLökInfo
;

578 
PMESH_LINK_ENTRY_INFO
 
pMeshLökE¡ry
;

579 
ii
;

582 
	`¥ötf
("\nrtuser::set OID_802_11_MESH_LINK_STATUS \n\n");

583 
	`mem£t
(
d©a
, 0, (
MESH_LINK_INFO
));

585 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

586 
wrq
.
u
.
d©a
.
Àngth
 = (
MESH_LINK_INFO
);

587 
wrq
.
u
.
d©a
.
poöãr
 = data;

588 
wrq
.
u
.
d©a
.
Êags
 = 
OID_802_11_MESH_LINK_STATUS
;

589 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

591 if(
ªt
 != 0)

593 
	`¥ötf
("\nrtuser::error::get meshÜink info\n\n");

594 
πu£r_exô
;

597 
pMeshLökInfo
 = (
PMESH_LINK_INFO
)
wrq
.
u
.
d©a
.
poöãr
;

599 
ii
 = 0; iò< 
MAX_MESH_LINK_NUM
; ii++)

601 
pMeshLökE¡ry
 = (
PMESH_LINK_ENTRY_INFO
)&
pMeshLökInfo
->
E¡ry
[
ii
];

602 
	`¥ötf
(" PeerMac = %02x:%02x:%02x:%02x:%02x:%02x:",

603 
pMeshLökE¡ry
->
PìrMacAddr
[0],ÖMeshLinkEntry->PeerMacAddr[1],

604 
pMeshLökE¡ry
->
PìrMacAddr
[2],ÖMeshLinkEntry->PeerMacAddr[3],

605 
pMeshLökE¡ry
->
PìrMacAddr
[4],ÖMeshLinkEntry->PeerMacAddr[5]);

606 
	`¥ötf
(" Sètu†=%d\n", 
pMeshLökE¡ry
->
Sètus
);

612 
OID_802_11_MESH_LIST
:

614 
PMESH_NEIGHBOR_INFO
 
pMeshNeighInfo
;

615 
PMESH_NEIGHBOR_ENTRY_INFO
 
pMeshNeighE¡ry
;

616 
ii
;

619 
	`¥ötf
("\nrtuser::set OID_802_11_MESH_LIST \n\n");

620 
	`mem£t
(
d©a
, 0, (
MESH_NEIGHBOR_INFO
));

622 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

623 
wrq
.
u
.
d©a
.
Àngth
 = (
MESH_NEIGHBOR_INFO
);

624 
wrq
.
u
.
d©a
.
poöãr
 = data;

625 
wrq
.
u
.
d©a
.
Êags
 = 
OID_802_11_MESH_LIST
;

626 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

628 if(
ªt
 != 0)

630 
	`¥ötf
("\nrtuser::error::get meshÇeighbor info\n\n");

631 
πu£r_exô
;

634 
pMeshNeighInfo
 = (
PMESH_NEIGHBOR_INFO
)
wrq
.
u
.
d©a
.
poöãr
;

636 
ii
 = 0; iò< 
pMeshNeighInfo
->
num
; ii++)

638 
pMeshNeighE¡ry
 = (
PMESH_NEIGHBOR_ENTRY_INFO
)&
pMeshNeighInfo
->
E¡ry
[
ii
];

640 
	`¥ötf
("Rssò=%d", 
pMeshNeighE¡ry
->
Rssi
);

641 
	`¥ötf
(" PeerMac = %02x:%02x:%02x:%02x:%02x:%02x:",

642 
pMeshNeighE¡ry
->
MacAddr
[0],ÖMeshNeighEntry->MacAddr[1],

643 
pMeshNeighE¡ry
->
MacAddr
[2],ÖMeshNeighEntry->MacAddr[3],

644 
pMeshNeighE¡ry
->
MacAddr
[4],

645 
pMeshNeighE¡ry
->
MacAddr
[5]);

646 
	`¥ötf
(" MeshId = %s", 
pMeshNeighE¡ry
->
MeshId
);

647 
	`¥ötf
(" Ch = %d", 
pMeshNeighE¡ry
->
Ch™√l
);

648 
	`¥ötf
(" Sètu†=%d", 
pMeshNeighE¡ry
->
Sètus
);

650 
pMeshNeighE¡ry
->
MeshEn¸ypTy≥
)

653 
	`¥ötf
(" Encryption = OPEN-NONE\n");

657 
	`¥ötf
(" Encryption = OPEN-WEP\n");

661 
	`¥ötf
(" Encryption = WPANONE-TKIP\n");

665 
	`¥ötf
(" Encryption = WPANONE-AES\n");

669 
	`¥ötf
(" Encryption = OPEN-NONE\n");

676 
RT_OID_802_11_MESH_MAX_TX_RATE
:

678 
MaxTxR©e
;

681 
	`¥ötf
("\nrtuser::set RT_OID_802_11_MESH_MAX_TX_RATE \n\n");

682 
MaxTxR©e
 = 11;

684 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

685 
wrq
.
u
.
d©a
.
Àngth
 = ();

686 
wrq
.
u
.
d©a
.
poöãr
 = (*)& 
MaxTxR©e
;

687 
wrq
.
u
.
d©a
.
Êags
 = 
RT_OID_802_11_MESH_MAX_TX_RATE
;

688 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

690 if(
ªt
 != 0)

692 
	`¥ötf
("\nrtuser::error::set mesh maxÅxÑate.\n\n");

693 
πu£r_exô
;

698 
OID_802_11_MESH_MAX_TX_RATE
:

700 
MaxTxR©e
;

703 
	`¥ötf
("\nrtuser::set OID_802_11_MESH_MAX_TX_RATE \n\n");

705 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

706 
wrq
.
u
.
d©a
.
Àngth
 = ();

707 
wrq
.
u
.
d©a
.
poöãr
 = (*)& 
MaxTxR©e
;

708 
wrq
.
u
.
d©a
.
Êags
 = 
OID_802_11_MESH_MAX_TX_RATE
;

709 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

711 if(
ªt
 != 0)

713 
	`¥ötf
("\nrtuser::error::set mesh maxÅxÑate.\n\n");

714 
πu£r_exô
;

716 
	`¥ötf
("CuºíàMesh TxÑ©e=%d\n", 
MaxTxR©e
);

720 
RT_OID_802_11_MESH_CHANNEL
:

722 
Ch™√l
;

725 
	`¥ötf
("\nrtuser::set RT_OID_802_11_MESH_CHANNEL \n\n");

726 
Ch™√l
 = 11;

728 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

729 
wrq
.
u
.
d©a
.
Àngth
 = ();

730 
wrq
.
u
.
d©a
.
poöãr
 = (*)& 
Ch™√l
;

731 
wrq
.
u
.
d©a
.
Êags
 = 
RT_OID_802_11_MESH_CHANNEL
;

732 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

734 if(
ªt
 != 0)

736 
	`¥ötf
("\nrtuser::error::set mesh channel.\n\n");

737 
πu£r_exô
;

742 
OID_802_11_MESH_CHANNEL
:

744 
Ch™√l
;

747 
	`¥ötf
("\nrtuser::set OID_802_11_MESH_CHANNEL \n\n");

749 
	`°r˝y
(
wrq
.
i‰_«me
, 
«me
);

750 
wrq
.
u
.
d©a
.
Àngth
 = ();

751 
wrq
.
u
.
d©a
.
poöãr
 = (*)& 
Ch™√l
;

752 
wrq
.
u
.
d©a
.
Êags
 = 
OID_802_11_MESH_CHANNEL
;

753 
ªt
 = 
	`io˘l
(
sockë_id
, 
RT_PRIV_IOCTL
, &
wrq
);

755 if(
ªt
 != 0)

757 
	`¥ötf
("\nrtuser::error::get mesh channel.\n\n");

758 
πu£r_exô
;

760 
	`¥ötf
("CuºíàMesh Ch™√l=%d\n", 
Ch™√l
);

765 
	`¥ötf
("\nUnsupported OIDÅype\n");

769 
πu£r_exô
:

770 if(
sockë_id
 >= 0)

771 
	`˛o£
(
sockë_id
);

773 i‡(
d©a
 !
NULL
)

774 
	`‰ì
(
d©a
);

776 if(
ªt
)

777  
ªt
;

780 
	}
}

	@rtmp.h

37 #i‚de‡
__RTMP_H__


38 
	#__RTMP_H__


	)

40 
	~"lök_li°.h
"

42 
	~"mlme.h
"

43 
	~"oid.h
"

44 
	~"w∑.h
"

49 
UCHAR
 
BROADCAST_ADDR
[
MAC_ADDR_LEN
];

50 
UCHAR
 
ZERO_MAC_ADDR
[
MAC_ADDR_LEN
];

51 
ULONG
 
BIT32
[32];

52 
UCHAR
 
BIT8
[8];

53 * 
CùhîName
[];

55 
UCHAR
 
SNAP_802_1H
[6];

56 
UCHAR
 
SNAP_BRIDGE_TUNNEL
[6];

57 
UCHAR
 
EAPOL_LLC_SNAP
[8];

58 
UCHAR
 
EAPOL
[2];

59 
UCHAR
 
IPX
[2];

60 
UCHAR
 
APPLE_TALK
[2];

61 
UCHAR
 
R©eIdToPl˝Sig«l
[12];

62 
UCHAR
 
OfdmSig«lToR©eId
[16] ;

63 
UCHAR
 
deÁu…_cwmö
[4];

64 
UCHAR
 
deÁu…_cwmax
[4];

65 
UCHAR
 
deÁu…_°a_aif¢
[4];

66 
UCHAR
 
M≠U£rPri‹ôyToAc˚ssC©eg‹y
[8];

68 
UCHAR
 
Phy11BNextR©eDownw¨d
[];

69 
UCHAR
 
Phy11BNextR©eUpw¨d
[];

70 
UCHAR
 
Phy11BGNextR©eDownw¨d
[];

71 
UCHAR
 
Phy11BGNextR©eUpw¨d
[];

72 
UCHAR
 
Phy11ANextR©eDownw¨d
[];

73 
UCHAR
 
Phy11ANextR©eUpw¨d
[];

74 
CHAR
 
RssiSa„LevñF‹TxR©e
[];

75 
UCHAR
 
R©eIdToMbps
[];

76 
USHORT
 
R©eIdTo500Kbps
[];

78 
UCHAR
 
CùhîSuôeW∑N⁄eTkù
[];

79 
UCHAR
 
CùhîSuôeW∑N⁄eTkùLí
;

81 
UCHAR
 
CùhîSuôeW∑N⁄eAes
[];

82 
UCHAR
 
CùhîSuôeW∑N⁄eAesLí
;

84 
UCHAR
 
SsidIe
;

85 
UCHAR
 
SupR©eIe
;

86 
UCHAR
 
ExtR©eIe
;

87 
UCHAR
 
EΩIe
;

88 
UCHAR
 
DsIe
;

89 
UCHAR
 
TimIe
;

90 
UCHAR
 
W∑Ie
;

91 
UCHAR
 
W∑2Ie
;

92 
UCHAR
 
IbssIe
;

94 
UCHAR
 
WPA_OUI
[];

95 
UCHAR
 
RSN_OUI
[];

96 
UCHAR
 
WME_INFO_ELEM
[];

97 
UCHAR
 
WME_PARM_ELEM
[];

98 
UCHAR
 
RALINK_OUI
[];

100 
usb_devi˚_id
 
πusb_usb_id
[];

101 
INT
 c⁄° 
πusb_usb_id_Àn
;

106 
urb
 *
	tpurbb_t
;

107 
usb_˘æªque°
 
	tdev˘æªque°
;

110 
	#CONTROL_TIMEOUT_MS
 (1000)

111 
	#CONTROL_TIMEOUT_JIFFIES
 ((
CONTROL_TIMEOUT_MS
 * 
HZ
)/1000)

	)

113 #i‡
LINUX_VERSION_CODE
 >
KERNEL_VERSION
(2,6,7)

114 
	#RTUSB_UNLINK_URB
(
urb
Ë
	`usb_kûl_urb
(urb)

	)

116 
	#RTUSB_UNLINK_URB
(
urb
Ë
	`usb_u∆ök_urb
(urb)

	)

119 #i‡
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,29)

120 
	#RTMP_OS_NETDEV_SET_PRIV
(
_pNëDev
, 
_pPriv
Ë((_pNëDev)->
¥iv
 = (_pPriv))

	)

121 
	#RTMP_OS_NETDEV_GET_PRIV
(
_pNëDev
Ë((_pNëDev)->
¥iv
)

	)

123 
	#RTMP_OS_NETDEV_SET_PRIV
(
_pNëDev
, 
_pPriv
Ë((_pNëDev)->
ml_¥iv
 = (_pPriv))

	)

124 
	#RTMP_OS_NETDEV_GET_PRIV
(
_pNëDev
Ë((_pNëDev)->
ml_¥iv
)

	)

128 
	#DEVREQ_REQUEST
(
x
Ë((x)->
bReque°
)

	)

129 
	#DEVREQ_REQUESTTYPE
(
x
Ë((x)->
bReque°Ty≥
)

	)

130 
	#DEVREQ_VALUE
(
x
Ë((x)->
wVÆue
)

	)

131 
	#DEVREQ_INDEX
(
x
Ë((x)->
wIndex
)

	)

132 
	#DEVREQ_LENGTH
(
x
Ë((x)->
wLígth
)

	)

134 
	#PURB
 
purbb_t


	)

135 
	#PIRP
 
PVOID


	)

136 
	#PMDL
 
PVOID


	)

137 
	#NDIS_OID
 
UINT


	)

139 
	#STATUS_SUCCESS
 0x00

	)

140 
	#STATUS_UNSUCCESSFUL
 0x01

	)

142 
LONG
 
	tNTSTATUS
;

143 
NTSTATUS
 *
	tPNTSTATUS
;

146 
√t_devi˚
 * 
	tPNET_DEV
;

147 
sk_buff
 * 
	tPNDIS_PACKET
;

148 
sk_buff
 
	tNDIS_PACKET
;

149 
PNDIS_PACKET
 * 
	tPPNDIS_PACKET
;

151 
ölöe
 
	$NdisGëSy°emUpTime
(
ULONG
 *
time
)

153 *
time
 = 
jiffõs
;

154 
	}
}

159 
	s_QUEUE_ENTRY
 {

160 
_QUEUE_ENTRY
 *
	mNext
;

161 } 
	tQUEUE_ENTRY
, *
	tPQUEUE_ENTRY
;

164 
	s_QUEUE_HEADER
 {

165 
PQUEUE_ENTRY
 
	mHód
;

166 
PQUEUE_ENTRY
 
	mTaû
;

167 
ULONG
 
	mNumbî
;

168 } 
	tQUEUE_HEADER
, *
	tPQUEUE_HEADER
;

170 
	#InôülizeQueueHódî
(
QueueHódî
) \

172 (
QueueHódî
)->
Hód
 = (QueueHódî)->
Taû
 = 
NULL
; \

173 (
QueueHódî
)->
Numbî
 = 0; \

174 }

	)

176 
	#RemoveHódQueue
(
QueueHódî
) \

177 (
QueueHódî
)->
Hód
; \

179 
PQUEUE_ENTRY
 
pNext
; \

180 i‡((
QueueHódî
)->
Hód
 !
NULL
) \

182 
pNext
 = (
QueueHódî
)->
Hód
->
Next
; \

183 (
QueueHódî
)->
Hód
 = 
pNext
; \

184 i‡(
pNext
 =
NULL
) \

185 (
QueueHódî
)->
Taû
 = 
NULL
; \

186 (
QueueHódî
)->
Numbî
--; \

188 }

	)

190 
	#In£πHódQueue
(
QueueHódî
, 
QueueE¡ry
) \

192 ((
PQUEUE_ENTRY
)
QueueE¡ry
)->
Next
 = (
QueueHódî
)->
Hód
; \

193 (
QueueHódî
)->
Hód
 = (
PQUEUE_ENTRY
)(
QueueE¡ry
); \

194 i‡((
QueueHódî
)->
Taû
 =
NULL
) \

195 (
QueueHódî
)->
Taû
 = (
PQUEUE_ENTRY
)(
QueueE¡ry
); \

196 (
QueueHódî
)->
Numbî
++; \

197 }

	)

199 
	#In£πTaûQueue
(
QueueHódî
, 
QueueE¡ry
) \

201 ((
PQUEUE_ENTRY
)
QueueE¡ry
)->
Next
 = 
NULL
; \

202 i‡((
QueueHódî
)->
Taû
) \

203 (
QueueHódî
)->
Taû
->
Next
 = (
PQUEUE_ENTRY
)(
QueueE¡ry
); \

205 (
QueueHódî
)->
Hód
 = (
PQUEUE_ENTRY
)(
QueueE¡ry
); \

206 (
QueueHódî
)->
Taû
 = (
PQUEUE_ENTRY
)(
QueueE¡ry
); \

207 (
QueueHódî
)->
Numbî
++; \

208 }

	)

214 #ifde‡
DBG


215 
ULONG
 
RTDebugLevñ
;

217 
	#DBGPRINT
(
Levñ
, 
fmt
, 
¨gs
...) \

219 i‡(
Levñ
 <
RTDebugLevñ
) \

221 
	`¥ötk
(
NIC_DBG_STRING
); \

222 
	`¥ötk
(
KERN_DEBUG
 
fmt
, ## 
¨gs
); \

224 }

	)

226 
	#DBGPRINT_ERR
(
fmt
, 
¨gs
...) \

228 
	`¥ötk
("ERROR!!! "); \

229 
	`¥ötk
(
KERN_DEBUG
 
fmt
, ## 
¨gs
); \

230 }

	)

232 
	#DBGPRINT_RAW
(
Levñ
, 
fmt
, 
¨gs
...) \

234 i‡(
Levñ
 <
RTDebugLevñ
) \

236 
	`¥ötk
(" "); \

237 
	`¥ötk
(
KERN_DEBUG
 
fmt
, ## 
¨gs
); \

239 }

	)

241 
	#DBGPRINT
(
Levñ
, 
fmt
, 
¨gs
...)

	)

242 
	#DBGPRINT_ERR
(
fmt
, 
¨gs
...)

	)

243 
	#DBGPRINT_RAW
(
Levñ
, 
fmt
, 
¨gs
...)

	)

257 
	#NdisAŒoˇãSpöLock
(
lock
) \

259 
	`•ö_lock_öô
(
lock
); \

260 }

	)

262 
	#NdisRñó£SpöLock
(
lock
, 
Êagg
) \

264 i‡(
	`ö_öãºu±
()) \

265 
	`•ö_u∆ock_úqª°‹e
(
lock
, 
Êagg
);\

267 
	`•ö_u∆ock
(
lock
); \

268 }

	)

270 
	#NdisAcquúeSpöLock
(
lock
, 
Êagg
) \

272 i‡(
	`ö_öãºu±
()) \

273 
	`•ö_lock_úqßve
(
lock
, 
Êagg
); \

275 
	`•ö_lock
(
lock
); \

276 }

	)

278 
	#NdisRñó£SpöLock
(
lock
, 
Êagg
) \

280 
	`•ö_u∆ock_úqª°‹e
(
lock
, 
Êagg
); \

281 }

	)

282 
	#NdisAcquúeSpöLock
(
lock
, 
Êagg
) \

284 
	`•ö_lock_úqßve
(
lock
, 
Êagg
); \

285 }

	)

288 
	#NdisFªeSpöLock
(
lock
) \

290 }

	)

292 
	#RTUSBFªeSkbBuf„r
(
skb
) \

294 
	`dev_k‰ì_skb_™y
(
skb
); \

295 }

	)

297 
	#RTUSBMlmeUp
(
pAd
) \

299 if(
pAd
->
MLMEThr_pid
>0) \

300 
	`up
(&(
pAd
->
mlme_£m≠h‹e
)); \

301 }

	)

303 
	#RTUSBMacRegDown
(
pAd
) \

305 
	`down_åylock
(&
pAd
->
MaCRegWrôe_£m≠h‹e
); \

306 
pAd
->
MacRegWrôe_Pro˚ssög
=1;\

307 }

	)

308 
	#RTUSBMacRegUp
(
pAd
) \

310 
pAd
->
MacRegWrôe_Pro˚ssög
=0;\

311 
	`up
(&(
pAd
->
MaCRegWrôe_£m≠h‹e
)); \

312 }

	)

313 
	#RTUSBCMDUp
(
pAd
) \

315 if(
pAd
->
RTUSBCmdThr_pid
>0) \

316 
	`up
(&(
pAd
->
RTUSBCmd_£m≠h‹e
)); \

317 }

	)

320 
	#FILL_REQUEST
(
a
,
Ø
,
ab
,
ac
,
ad
,
´
) \

322 (
a
)->
devªq
->
ªque°
 = 
Ø
; \

323 (
a
)->
devªq
->
ªque°ty≥
 = 
ab
; \

324 (
a
)->
devªq
->
vÆue
 = 
	`˝u_to_À16
(
ac
); \

325 (
a
)->
devªq
->
ödex
 = 
	`˝u_to_À16
(
ad
); \

326 (
a
)->
devªq
->
Àngth
 = 
	`˝u_to_À16
(
´
);\

327 }0);

	)

331 
	#URB_FUNCTION_RESERVED0
 0x0016

	)

338 
	#URB_FUNCTION_VENDOR_DEVICE
 0x0017

	)

339 
	#URB_FUNCTION_VENDOR_INTERFACE
 0x0018

	)

340 
	#URB_FUNCTION_VENDOR_ENDPOINT
 0x0019

	)

341 
	#URB_FUNCTION_VENDOR_OTHER
 0x0020

	)

343 
	#URB_FUNCTION_CLASS_DEVICE
 0x001A

	)

344 
	#URB_FUNCTION_CLASS_INTERFACE
 0x001B

	)

345 
	#URB_FUNCTION_CLASS_ENDPOINT
 0x001C

	)

346 
	#URB_FUNCTION_CLASS_OTHER
 0x001F

	)

351 
	#URB_FUNCTION_RESERVED
 0x001D

	)

353 
	#URB_FUNCTION_GET_CONFIGURATION
 0x0026

	)

354 
	#URB_FUNCTION_GET_INTERFACE
 0x0027

	)

356 
	#URB_FUNCTION_LAST
 0x0029

	)

362 #unde‡
ASSERT


363 
	#ASSERT
(
x
) \

365 i‡(!(
x
)) \

367 
	`¥ötk
(
KERN_WARNING
 
__FILE__
 ":%dás£π " #x "Áûed\n", 
__LINE__
); \

369 }

	)

374 
	#RTMP_SET_FLAG
(
_M
, 
_F
Ë((_M)->
Fœgs
 |(_F))

	)

375 
	#RTMP_CLEAR_FLAG
(
_M
, 
_F
Ë((_M)->
Fœgs
 &~(_F))

	)

376 
	#RTMP_CLEAR_FLAGS
(
_M
Ë((_M)->
Fœgs
 = 0)

	)

377 
	#RTMP_TEST_FLAG
(
_M
, 
_F
Ë(((_M)->
Fœgs
 & (_F)Ë!0)

	)

378 
	#RTMP_TEST_FLAGS
(
_M
, 
_F
Ë(((_M)->
Fœgs
 & (_F)Ë=(_F))

	)

381 
	#RTUSB_SET_BULK_FLAG
(
_M
, 
_F
Ë((_M)->
BulkFœgs
 |(_F))

	)

382 
	#RTUSB_CLEAR_BULK_FLAG
(
_M
, 
_F
Ë((_M)->
BulkFœgs
 &~(_F))

	)

383 
	#RTUSB_TEST_BULK_FLAG
(
_M
, 
_F
Ë(((_M)->
BulkFœgs
 & (_F)Ë!0)

	)

385 
	#OPSTATUS_SET_FLAG
(
_pAd
, 
_F
Ë((_pAd)->
P‹tCfg
.
OpSètusFœgs
 |(_F))

	)

386 
	#OPSTATUS_CLEAR_FLAG
(
_pAd
, 
_F
Ë((_pAd)->
P‹tCfg
.
OpSètusFœgs
 &~(_F))

	)

387 
	#OPSTATUS_TEST_FLAG
(
_pAd
, 
_F
Ë(((_pAd)->
P‹tCfg
.
OpSètusFœgs
 & (_F)Ë!0)

	)

389 
	#CLIENT_STATUS_SET_FLAG
(
_pE¡ry
,
_F
Ë((_pE¡ry)->
Clõ¡SètusFœgs
 |(_F))

	)

390 
	#CLIENT_STATUS_CLEAR_FLAG
(
_pE¡ry
,
_F
Ë((_pE¡ry)->
Clõ¡SètusFœgs
 &~(_F))

	)

391 
	#CLIENT_STATUS_TEST_FLAG
(
_pE¡ry
,
_F
Ë(((_pE¡ry)->
Clõ¡SètusFœgs
 & (_F)Ë!0)

	)

394 
	#INC_RING_INDEX
(
_idx
, 
_RögSize
) \

396 (
_idx
)++; \

397 i‡((
_idx
Ë>(
_RögSize
)) _idx=0; \

398 }

	)

404 
	#INC_TX_TSC
(
_tsc
) \

406 
i
=0; \

407 ++
_tsc
[
i
] == 0x0) \

409 
i
++; \

410 i‡(
i
 == 6) \

413 }

	)

416 #unde‡
NdisMoveMem‹y


417 #unde‡
NdisZîoMem‹y


418 #unde‡
NdisFûlMem‹y


419 #unde‡
NdisEquÆMem‹y


421 
	#NdisMoveMem‹y
(
De°ö©i⁄
, 
Sour˚
, 
Lígth
Ë
	`RTMPMoveMem‹y
(De°ö©i⁄, Sour˚, Lígth)

	)

422 
	#NdisZîoMem‹y
(
De°ö©i⁄
, 
Lígth
Ë
	`RTMPZîoMem‹y
(De°ö©i⁄, Lígth)

	)

423 
	#NdisFûlMem‹y
(
De°ö©i⁄
, 
Lígth
, 
Fûl
Ë
	`RTMPFûlMem‹y
(De°ö©i⁄, Lígth, Fûl)

	)

424 
	#NdisEquÆMem‹y
(
Sour˚1
, 
Sour˚2
, 
Lígth
Ë
	`RTMPEquÆMem‹y
(Sour˚1, Sour˚2, Lígth)

	)

426 
	#MAC_ADDR_EQUAL
(
pAddr1
,
pAddr2
Ë
	`RTMPEquÆMem‹y
((
PVOID
)’Addr1), (PVOID)’Addr2), 
MAC_ADDR_LEN
)

	)

427 
	#COPY_MAC_ADDR
(
Addr1
, 
Addr2
Ë
	`mem˝y
((Addr1), (Addr2), 
MAC_ADDR_LEN
)

	)

428 
	#SSID_EQUAL
(
ssid1
, 
Àn1
, 
ssid2
, 
Àn2
Ë(÷í1=ˆí2Ë&& (
	`RTMPEquÆMem‹y
(ssid1, ssid2,Üí1)))

	)

430 
	#NdisMSÀï
 
mdñay


	)

433 
	#MAP_CHANNEL_ID_TO_KHZ
(
ch
, 
khz
) { \

434 
ch
) \

436 1: 
khz
 = 2412000; ; \

437 2: 
khz
 = 2417000; ; \

438 3: 
khz
 = 2422000; ; \

439 4: 
khz
 = 2427000; ; \

440 5: 
khz
 = 2432000; ; \

441 6: 
khz
 = 2437000; ; \

442 7: 
khz
 = 2442000; ; \

443 8: 
khz
 = 2447000; ; \

444 9: 
khz
 = 2452000; ; \

445 10: 
khz
 = 2457000; ; \

446 11: 
khz
 = 2462000; ; \

447 12: 
khz
 = 2467000; ; \

448 13: 
khz
 = 2472000; ; \

449 14: 
khz
 = 2484000; ; \

450 36: 
khz
 = 5180000; ; \

451 40: 
khz
 = 5200000; ; \

452 44: 
khz
 = 5220000; ; \

453 48: 
khz
 = 5240000; ; \

454 52: 
khz
 = 5260000; ; \

455 56: 
khz
 = 5280000; ; \

456 60: 
khz
 = 5300000; ; \

457 64: 
khz
 = 5320000; ; \

458 149: 
khz
 = 5745000; ; \

459 153: 
khz
 = 5765000; ; \

460 157: 
khz
 = 5785000; ; \

461 161: 
khz
 = 5805000; ; \

462 165: 
khz
 = 5825000; ; \

463 100: 
khz
 = 5500000; ; \

464 104: 
khz
 = 5520000; ; \

465 108: 
khz
 = 5540000; ; \

466 112: 
khz
 = 5560000; ; \

467 116: 
khz
 = 5580000; ; \

468 120: 
khz
 = 5600000; ; \

469 124: 
khz
 = 5620000; ; \

470 128: 
khz
 = 5640000; ; \

471 132: 
khz
 = 5660000; ; \

472 136: 
khz
 = 5680000; ; \

473 140: 
khz
 = 5700000; ; \

474 34: 
khz
 = 5170000; ; \

475 38: 
khz
 = 5190000; ; \

476 42: 
khz
 = 5210000; ; \

477 46: 
khz
 = 5230000; ; \

478 : 
khz
 = 2412000; ; \

480 }

	)

482 
	#MAP_KHZ_TO_CHANNEL_ID
(
khz
, 
ch
) { \

483 
khz
) \

485 2412000: 
ch
 = 1; ; \

486 2417000: 
ch
 = 2; ; \

487 2422000: 
ch
 = 3; ; \

488 2427000: 
ch
 = 4; ; \

489 2432000: 
ch
 = 5; ; \

490 2437000: 
ch
 = 6; ; \

491 2442000: 
ch
 = 7; ; \

492 2447000: 
ch
 = 8; ; \

493 2452000: 
ch
 = 9; ; \

494 2457000: 
ch
 = 10; ; \

495 2462000: 
ch
 = 11; ; \

496 2467000: 
ch
 = 12; ; \

497 2472000: 
ch
 = 13; ; \

498 2484000: 
ch
 = 14; ; \

499 5180000: 
ch
 = 36; ; \

500 5200000: 
ch
 = 40; ; \

501 5220000: 
ch
 = 44; ; \

502 5240000: 
ch
 = 48; ; \

503 5260000: 
ch
 = 52; ; \

504 5280000: 
ch
 = 56; ; \

505 5300000: 
ch
 = 60; ; \

506 5320000: 
ch
 = 64; ; \

507 5745000: 
ch
 = 149; ; \

508 5765000: 
ch
 = 153; ; \

509 5785000: 
ch
 = 157; ; \

510 5805000: 
ch
 = 161; ; \

511 5825000: 
ch
 = 165; ; \

512 5500000: 
ch
 = 100; ; \

513 5520000: 
ch
 = 104; ; \

514 5540000: 
ch
 = 108; ; \

515 5560000: 
ch
 = 112; ; \

516 5580000: 
ch
 = 116; ; \

517 5600000: 
ch
 = 120; ; \

518 5620000: 
ch
 = 124; ; \

519 5640000: 
ch
 = 128; ; \

520 5660000: 
ch
 = 132; ; \

521 5680000: 
ch
 = 136; ; \

522 5700000: 
ch
 = 140; ; \

523 5170000: 
ch
 = 34; ; \

524 5190000: 
ch
 = 38; ; \

525 5210000: 
ch
 = 42; ; \

526 5230000: 
ch
 = 46; ; \

527 : 
ch
 = 1; ; \

529 }

	)

531 
	#VIRTUAL_IF_INC
(
pAd
Ë(’Ad)->
VútuÆIfC¡
++)

	)

532 
	#VIRTUAL_IF_DEC
(
pAd
Ë(’Ad)->
VútuÆIfC¡
--)

	)

533 
	#VIRTUAL_IF_NUM
(
pAd
Ë(’Ad)->
VútuÆIfC¡
)

	)

538 
	#NIC_MAX_PHYS_BUF_COUNT
 8

	)

540 
	s_RTMP_SCATTER_GATHER_ELEMENT
 {

541 
PVOID
 
	mAddªss
;

542 
ULONG
 
	mLígth
;

543 
PULONG
 
	mRe£rved
;

544 } 
	tRTMP_SCATTER_GATHER_ELEMENT
, *
	tPRTMP_SCATTER_GATHER_ELEMENT
;

546 
	s_RTMP_SCATTER_GATHER_LIST
 {

547 
ULONG
 
	mNumbîOfEÀmíts
;

548 
PULONG
 
	mRe£rved
;

549 
RTMP_SCATTER_GATHER_ELEMENT
 
	mEÀmíts
[
NIC_MAX_PHYS_BUF_COUNT
];

550 } 
	tRTMP_SCATTER_GATHER_LIST
, *
	tPRTMP_SCATTER_GATHER_LIST
;

556 #i‚de‡
mö


557 
	#mö
(
_a
, 
_b
Ë(((_aË< (_b)Ë? (_aË: (_b))

	)

560 #i‚de‡
max


561 
	#max
(
_a
, 
_b
Ë(((_aË> (_b)Ë? (_aË: (_b))

	)

564 
	#INC_COUNTER
(
VÆ
Ë(VÆ.
QuadP¨t
++)

	)

565 
	#INC_COUNTER64
(
VÆ
Ë(VÆ.
QuadP¨t
++)

	)

567 
	#INFRA_ON
(
_p
Ë(
	`OPSTATUS_TEST_FLAG
(_p, 
fOP_STATUS_INFRA_ON
))

	)

568 
	#ADHOC_ON
(
_p
Ë(
	`OPSTATUS_TEST_FLAG
(_p, 
fOP_STATUS_ADHOC_ON
))

	)

572 
	#RTMP_SET_PACKET_MOREDATA
(
_p
, 
_m‹ebô
Ë((_p)->
cb
[6] = _m‹ebô)

	)

573 
	#RTMP_GET_PACKET_MOREDATA
(
_p
Ë((_p)->
cb
[6])

	)

576 
	#RTMP_SET_PACKET_UP
(
_p
, 
_¥io
Ë((_p)->
cb
[8] = ((_p)->cb[8] & 0xf0Ë| (_¥io))

	)

577 
	#RTMP_GET_PACKET_UP
(
_p
Ë((_p)->
cb
[8] & 0x0f)

	)

580 
	#RTMP_SET_PACKET_FRAGMENTS
(
_p
, 
numbî
Ë((_p)->
cb
[9] = ((_p)->cb[9] & 0x0fË| (numbî << 4))

	)

581 
	#RTMP_GET_PACKET_FRAGMENTS
(
_p
Ë(((_p)->
cb
[9] & 0xf0Ë>> 4)

	)

585 
	#RTMP_SET_PACKET_WCID
(
_p
, 
_wcid
Ë((_p)->
cb
[10] = _wcid)

	)

586 
	#RTMP_GET_PACKET_WCID
(
_p
Ë((_p)->
cb
[10])

	)

589 
	#RTMP_SET_PACKET_SOURCE
(
_p
, 
_pkt§c
Ë((_p)->
cb
[11]_pkt§c)

	)

590 
	#RTMP_GET_PACKET_SOURCE
(
_p
Ë((_p)->
cb
[11])

	)

593 
	#RTMP_SET_PACKET_RTS
(
_p
, 
_num
Ë((_p)->
cb
[12] = ((_p)->cb[12] & 0xf8Ë| (_num))

	)

594 
	#RTMP_GET_PACKET_RTS
(
_p
Ë((_p)->
cb
[12] & 0x07)

	)

597 
	#RTMP_SET_PACKET_TXRATE
(
_p
, 
_øã
Ë((_p)->
cb
[13] = ((_p)->cb[13] & 0x07Ë| (_øã << 3))

	)

598 
	#RTMP_GET_PACKET_TXRATE
(
_p
Ë(((_p)->
cb
[13] & 0xf8Ë>> 3)

	)

603 
	#PKTSRC_NDIS
 0x7f

	)

604 
	#PKTSRC_DRIVER
 0x0f

	)

606 
	#MAKE_802_3_HEADER
(
_p
, 
_pMac1
, 
_pMac2
, 
_pTy≥
) \

608 
	`NdisMoveMem‹y
(
_p
, 
_pMac1
, 
MAC_ADDR_LEN
); \

609 
	`NdisMoveMem‹y
((
_p
 + 
MAC_ADDR_LEN
), 
_pMac2
, MAC_ADDR_LEN); \

610 
	`NdisMoveMem‹y
((
_p
 + 
MAC_ADDR_LEN
 * 2), 
_pTy≥
, 
LENGTH_802_3_TYPE
); \

611 }

	)

620 
	#CONVERT_TO_802_3
(
_p8023hdr
, 
_pDA
, 
_pSA
, 
_pD©a
, 
_D©aSize
, 
_pRemovedLLCSNAP
) \

622 
LLC_Lí
[2]; \

624 
_pRemovedLLCSNAP
 = 
NULL
; \

625 i‡(
	`NdisEquÆMem‹y
(
SNAP_802_1H
, 
_pD©a
, 6) || \

626 
	`NdisEquÆMem‹y
(
SNAP_BRIDGE_TUNNEL
, 
_pD©a
, 6)) \

628 
PUCHAR
 
pPrŸo
 = 
_pD©a
 + 6; \

630 i‡((
	`NdisEquÆMem‹y
(
IPX
, 
pPrŸo
, 2Ë|| NdisEquÆMem‹y(
APPLE_TALK
,ÖProto, 2)) && \

631 
	`NdisEquÆMem‹y
(
SNAP_802_1H
, 
_pD©a
, 6)) \

633 
LLC_Lí
[0] = (
UCHAR
)(
_D©aSize
 / 256); \

634 
LLC_Lí
[1] = (
UCHAR
)(
_D©aSize
 % 256); \

635 
	`MAKE_802_3_HEADER
(
_p8023hdr
, 
_pDA
, 
_pSA
, 
LLC_Lí
); \

639 
	`MAKE_802_3_HEADER
(
_p8023hdr
, 
_pDA
, 
_pSA
, 
pPrŸo
); \

640 
_pRemovedLLCSNAP
 = 
_pD©a
; \

641 
_D©aSize
 -
LENGTH_802_1_H
; \

642 
_pD©a
 +
LENGTH_802_1_H
; \

647 
LLC_Lí
[0] = (
UCHAR
)(
_D©aSize
 / 256); \

648 
LLC_Lí
[1] = (
UCHAR
)(
_D©aSize
 % 256); \

649 
	`MAKE_802_3_HEADER
(
_p8023hdr
, 
_pDA
, 
_pSA
, 
LLC_Lí
); \

651 }

	)

653 
	#RECORD_LATEST_RX_DATA_RATE
(
_pAd
, 
_pRxD
) \

655 i‡((
_pRxD
)->
Ofdm
) \

656 (
_pAd
)->
La°RxR©e
 = 
OfdmSig«lToR©eId
[(
_pRxD
)->
Pl˝Sig«l
 & 0x0f]; \

657 i‡((
_pRxD
)->
Pl˝Sig«l
 == 10) \

658 (
_pAd
)->
La°RxR©e
 = 
RATE_1
; \

659 i‡((
_pRxD
)->
Pl˝Sig«l
 == 20) \

660 (
_pAd
)->
La°RxR©e
 = 
RATE_2
; \

661 i‡((
_pRxD
)->
Pl˝Sig«l
 == 55) \

662 (
_pAd
)->
La°RxR©e
 = 
RATE_5_5
; \

664 (
_pAd
)->
La°RxR©e
 = 
RATE_11
; \

665 }

	)

669 
	#MAKE_802_11_HEADER
(
_pAd
, 
_80211hdr
, 
_pDA
, 
_£q
) \

671 
	`NdisZîoMem‹y
(&
_80211hdr
, (
HEADER_802_11
)); \

672 i‡(
	`INFRA_ON
(
_pAd
)) \

674 
	`COPY_MAC_ADDR
(
_80211hdr
.
Addr1
, 
_pAd
->
P‹tCfg
.
Bssid
); \

675 
	`COPY_MAC_ADDR
(
_80211hdr
.
Addr3
, 
_pDA
); \

676 
_80211hdr
.
FC
.
ToDs
 = 1; \

680 
	`COPY_MAC_ADDR
(
_80211hdr
.
Addr1
, 
_pDA
); \

681 
	`COPY_MAC_ADDR
(
_80211hdr
.
Addr3
, 
_pAd
->
P‹tCfg
.
Bssid
); \

683 
	`COPY_MAC_ADDR
(
_80211hdr
.
Addr2
, 
_pAd
->
CuºítAddªss
); \

684 
_80211hdr
.
Sequí˚
 = 
_£q
; \

685 
_80211hdr
.
FC
.
Ty≥
 = 
BTYPE_DATA
; \

686 
_80211hdr
.
FC
.
PwrMgmt
 = (
_pAd
->
P‹tCfg
.
Psm
 =
PWR_SAVE
); \

687 }

	)

691 
	#COLLECT_RX_ANTENNA_AVERAGE_RSSI
(
_pAd
, 
_rssi1
, 
_rssi2
) \

693 
SHORT
 
AvgRssi
; \

694 
UCHAR
 
U£dA¡
; \

695 i‡(
_pAd
->
RxA¡
.
EvÆu©ePîiod
 == 0) \

697 
U£dA¡
 = 
_pAd
->
RxA¡
.
Paú1Prim¨yRxA¡
; \

698 
AvgRssi
 = 
_pAd
->
RxA¡
.
Paú1AvgRssi
[
U£dA¡
]; \

699 i‡(
AvgRssi
 < 0) \

700 
AvgRssi
 = AvgRssò- (AvgRssò>> 3Ë+ 
_rssi1
; \

702 
AvgRssi
 = 
_rssi1
 << 3; \

703 
_pAd
->
RxA¡
.
Paú1AvgRssi
[
U£dA¡
] = 
AvgRssi
; \

707 
U£dA¡
 = 
_pAd
->
RxA¡
.
Paú1Sec⁄d¨yRxA¡
; \

708 
AvgRssi
 = 
_pAd
->
RxA¡
.
Paú1AvgRssi
[
U£dA¡
]; \

709 i‡((
AvgRssi
 < 0Ë&& (
_pAd
->
RxA¡
.
Fú°PktAºivedWhíEvÆu©e
)) \

710 
AvgRssi
 = AvgRssò- (AvgRssò>> 3Ë+ 
_rssi1
; \

713 
_pAd
->
RxA¡
.
Fú°PktAºivedWhíEvÆu©e
 = 
TRUE
; \

714 
AvgRssi
 = 
_rssi1
 << 3; \

716 
_pAd
->
RxA¡
.
Paú1AvgRssi
[
U£dA¡
] = 
AvgRssi
; \

717 
_pAd
->
RxA¡
.
RcvPktNumWhíEvÆu©e
++; \

719 }

	)

721 
	#RELEASE_NDIS_PACKET
(
_pAd
, 
_pSkb
) \

723 i‡(
	`RTMP_GET_PACKET_SOURCE
(
_pSkb
Ë=
PKTSRC_NDIS
) \

725 
	`RTUSBFªeSkbBuf„r
(
_pSkb
); \

726 
_pAd
->
RÆökCou¡îs
.
PídögNdisPackëCou¡
 --; \

729 
	`RTUSBFªeSkbBuf„r
(
_pSkb
); \

730 }

	)

732 
	#EnqueueCmd
(
cmdq
, 
cmdqñmt
) \

734 i‡(
cmdq
->
size
 == 0) \

735 
cmdq
->
hód
 = 
cmdqñmt
; \

737 
cmdq
->
èû
->
√xt
 = 
cmdqñmt
; \

738 
cmdq
->
èû
 = 
cmdqñmt
; \

739 
cmdqñmt
->
√xt
 = 
NULL
; \

740 
cmdq
->
size
++; \

741 }

	)

745 
	#FREE_TX_RING
(
_p
, 
_b
, 
_t
) \

747 (
_t
)->
InU£
 = 
FALSE
; \

748 (
_t
)->
La°O√
 = 
FALSE
; \

749 (
_t
)->
IRPPídög
 = 
FALSE
; \

750 (
_t
)->
bWaôögBulkOut
 = 
FALSE
; \

751 (
_t
)->
BulkOutSize
= 0; \

752 (
_p
)->
NextBulkOutIndex
[
_b
] = (((_p)->NextBulkOutIndex[_b] + 1Ë% 
TX_RING_SIZE
); \

753 
	`©omic_dec
(&(
_p
)->
TxCou¡
); \

754 }

	)

758 #i‡
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,5,0)

759 #unde‡
__waô_evít_öãºu±ibÀ_timeout


760 #unde‡
waô_evít_öãºu±ibÀ_timeout


761 
	#__waô_evít_öãºu±ibÀ_timeout
(
wq
, 
c⁄dôi⁄
, 
ªt
) \

763 
waô_queue_t
 
__waô
; \

764 
	`öô_waôqueue_íåy
(&
__waô
, 
cuºít
); \

766 
	`add_waô_queue
(&
wq
, &
__waô
); \

768 
	`£t_cuºít_°©e
(
TASK_INTERRUPTIBLE
); \

769 i‡(
c⁄dôi⁄
) \

771 i‡(!
	`sig«l_≥ndög
(
cuºít
)) { \

772 
ªt
 = 
	`scheduÀ_timeout
(ret); \

773 i‡(!
ªt
) \

777 
ªt
 = -
ERESTARTSYS
; \

780 
cuºít
->
°©e
 = 
TASK_RUNNING
; \

781 
	`ªmove_waô_queue
(&
wq
, &
__waô
); \

782 } 0)

	)

784 
	#waô_evít_öãºu±ibÀ_timeout
(
wq
, 
c⁄dôi⁄
, 
timeout
) \

786 
__ªt
 = 
timeout
; \

787 i‡(!(
c⁄dôi⁄
)) \

788 
	`__waô_evít_öãºu±ibÀ_timeout
(
wq
, 
c⁄dôi⁄
, 
__ªt
); \

789 
__ªt
; \

790 })

	)

795 
	#LOCAL_TX_RING_EMPTY
(
_p
, 
_i
Ë(((_p)->
TxC⁄ãxt
[_i][(_p)->
NextBulkOutIndex
[_i]].
InU£
Ë=
FALSE
)

	)

797 #i‡
LINUX_VERSION_CODE
 >
KERNEL_VERSION
(2,6,27)

798 
pid
 * 
	tTHREAD_PID
;

799 
	#THREAD_PID_INIT_VALUE
 
NULL


	)

800 
	#GET_PID
(
_v
Ë
	`föd_gë_pid
((_v))

	)

801 
	#GET_PID_NUMBER
(
_v
Ë
	`pid_ƒ
((_v))

	)

802 
	#CHECK_PID_LEGALITY
(
_pid
Ëi‡(
	`pid_ƒ
((_pid)Ë>0)

	)

803 
	#KILL_THREAD_PID
(
_A
, 
_B
, 
_C
Ë
	`kûl_pid
((_A), (_B), (_C))

	)

805 
pid_t
 
	tTHREAD_PID
;

806 
	#THREAD_PID_INIT_VALUE
 -1

	)

807 
	#GET_PID
(
_v
Ë(_v)

	)

808 
	#GET_PID_NUMBER
(
_v
Ë(_v)

	)

809 
	#CHECK_PID_LEGALITY
(
_pid
Ëi‡((_pidË>0)

	)

810 
	#KILL_THREAD_PID
(
_A
, 
_B
, 
_C
Ë
	`kûl_¥oc
((_A), (_B), (_C))

	)

813 #i‡
LINUX_VERSION_CODE
 >
KERNEL_VERSION
(2,6,27)

814 
	#IWE_STREAM_ADD_EVENT
(
_A
, 
_B
, 
_C
, 
_D
, 
_E
Ë
	`iwe_°ªam_add_evít
(_A, _B, _C, _D, _E)

	)

815 
	#IWE_STREAM_ADD_POINT
(
_A
, 
_B
, 
_C
, 
_D
, 
_E
Ë
	`iwe_°ªam_add_poöt
(_A, _B, _C, _D, _E)

	)

816 
	#IWE_STREAM_ADD_VALUE
(
_A
, 
_B
, 
_C
, 
_D
, 
_E
, 
_F
Ë
	`iwe_°ªam_add_vÆue
(_A, _B, _C, _D, _E, _F)

	)

818 
	#IWE_STREAM_ADD_EVENT
(
_A
, 
_B
, 
_C
, 
_D
, 
_E
Ë
	`iwe_°ªam_add_evít
(_B, _C, _D, _E)

	)

819 
	#IWE_STREAM_ADD_POINT
(
_A
, 
_B
, 
_C
, 
_D
, 
_E
Ë
	`iwe_°ªam_add_poöt
(_B, _C, _D, _E)

	)

820 
	#IWE_STREAM_ADD_VALUE
(
_A
, 
_B
, 
_C
, 
_D
, 
_E
, 
_F
Ë
	`iwe_°ªam_add_vÆue
(_B, _C, _D, _E, _F)

	)

826 
fûe
* 
	tRTMP_OS_FD
;

828 
	s_RTMP_OS_FS_INFO_


830 
	mfsuid
;

831 
	mfsgid
;

832 
mm_£gmít_t
 
	mfs
;

833 }
	tRTMP_OS_FS_INFO
;

835 
	#IS_FILE_OPEN_ERR
(
_fd
Ë
	`IS_ERR
((_fd))

	)

837 
	s_CmdQElmt
 {

838 
UINT
 
	mcomm™d
;

839 
PVOID
 
	mbuf„r
;

840 
ULONG
 
	mbuf„æígth
;

841 
BOOLEAN
 
	mCmdFromNdis
;

842 
BOOLEAN
 
	mSëO≥øti⁄
;

843 
BOOLEAN
 
	mInU£
;

844 
_CmdQElmt
 *
	m√xt
;

845 } 
	tCmdQElmt
, *
	tPCmdQElmt
;

847 
	s_CmdQ
 {

848 
UINT
 
	msize
;

849 
CmdQElmt
 *
	mhód
;

850 
CmdQElmt
 *
	mèû
;

851 } 
	tCmdQ
, *
	tPCmdQ
;

857 
	s__TX_BUFFER
{

858 
TXD_STRUC
 
	mTxDesc
;

860 
UCHAR
 
	mWúñessPackë
[2342];

861 
HEADER_802_11
 
	mNuŒFøme
;

862 
PSPOLL_FRAME
 
	mPsPﬁlPackë
;

863 
RTS_FRAME
 
	mRTSFøme
;

865 }
	mu
;

866 } 
	tTX_BUFFER
, *
	tPTX_BUFFER
;

871 
	s__RTS_BUFFER
{

872 
TXD_STRUC
 
	mTxDesc
;

873 
UCHAR
 
	mRTSPackë
[16];

874 } 
	tRTS_BUFFER
, *
	tPRTS_BUFFER
;

877 
	s_TX_CONTEXT


879 
PVOID
 
	mpAd
;

880 
PURB
 
	mpUrb
;

882 
PTX_BUFFER
 
	mTøns„rBuf„r
;

883 
ULONG
 
	mBulkOutSize
;

884 
UCHAR
 
	mBulkOutPùeId
;

885 
BOOLEAN
 
	mInU£
;

886 
BOOLEAN
 
	mbWaôögBulkOut
;

887 
BOOLEAN
 
	mIRPPídög
;

888 
BOOLEAN
 
	mLa°O√
;

889 } 
	tTX_CONTEXT
, *
	tPTX_CONTEXT
, **
	tPPTX_CONTEXT
;

891 
	e_Pídögúp
 {

892 
	mNONEPENDING
,

893 
	mIRP0PENDING
,

894 
	mIRP1PENDING


895 } 
	tPídögIRP
;

897 
	e_BEACON_INDEX
 {

898 
	mBEACON0
,

899 
	mBEACON1


900 } 
	tBEACON_INDEX
;

903 
	#IRPLOCK_COMPLETED
 0

	)

904 
	#IRPLOCK_CANCELABLE
 1

	)

905 
	#IRPLOCK_CANCE_START
 2

	)

906 
	#IRPLOCK_CANCE_COMPLETE
 3

	)

911 
	s_RX_CONTEXT


913 
PUCHAR
 
	mTøns„rBuf„r
;

914 
PVOID
 
	mpAd
;

916 
PURB
 
	mpUrb
;

917 
BOOLEAN
 
	mInU£
;

918 
BOOLEAN
 
	mIRPPídög
;

919 
©omic_t
 
	mIΩLock
;

920 } 
	tRX_CONTEXT
, *
	tPRX_CONTEXT
;

925 
	s_RTMP_REG_PAIR


927 
ULONG
 
	mRegi°î
;

928 
ULONG
 
	mVÆue
;

929 } 
	tRTMP_REG_PAIR
, *
	tPRTMP_REG_PAIR
;

931 
	s_BBP_REG_PAIR


933 
UCHAR
 
	mRegi°î
;

934 
UCHAR
 
	mVÆue
;

935 } 
	tBBP_REG_PAIR
, *
	tPBBP_REG_PAIR
;

940 
	s_RTMP_RF_REGS


942 
UCHAR
 
	mCh™√l
;

943 
ULONG
 
	mR1
;

944 
ULONG
 
	mR2
;

945 
ULONG
 
	mR3
;

946 
ULONG
 
	mR4
;

947 } 
	tRTMP_RF_REGS
, *
	tPRTMP_RF_REGS
;

952 
	s_COUNTER_802_3


955 
ULONG
 
	mGoodTønsmôs
;

956 
ULONG
 
	mGoodRe˚ives
;

957 
ULONG
 
	mTxEº‹s
;

958 
ULONG
 
	mRxEº‹s
;

959 
ULONG
 
	mRxNoBuf„r
;

962 
ULONG
 
	mRcvAlignmítEº‹s
;

963 
ULONG
 
	mO√Cﬁlisi⁄
;

964 
ULONG
 
	mM‹eCﬁlisi⁄s
;

966 } 
	tCOUNTER_802_3
, *
	tPCOUNTER_802_3
;

968 
	s_COUNTER_802_11
 {

969 
ULONG
 
	mLígth
;

970 
LARGE_INTEGER
 
	mTønsmôãdFøgmítCou¡
;

971 
LARGE_INTEGER
 
	mMu…iˇ°TønsmôãdFømeCou¡
;

972 
LARGE_INTEGER
 
	mFaûedCou¡
;

973 
LARGE_INTEGER
 
	mNoRëryCou¡
;

974 
LARGE_INTEGER
 
	mRëryCou¡
;

975 
LARGE_INTEGER
 
	mMu…ùÀRëryCou¡
;

976 
LARGE_INTEGER
 
	mRTSSuc˚ssCou¡
;

977 
LARGE_INTEGER
 
	mRTSFaûuªCou¡
;

978 
LARGE_INTEGER
 
	mACKFaûuªCou¡
;

979 
LARGE_INTEGER
 
	mFømeDu∂iˇãCou¡
;

980 
LARGE_INTEGER
 
	mRe˚ivedFøgmítCou¡
;

981 
LARGE_INTEGER
 
	mMu…iˇ°Re˚ivedFømeCou¡
;

982 
LARGE_INTEGER
 
	mFCSEº‹Cou¡
;

983 } 
	tCOUNTER_802_11
, *
	tPCOUNTER_802_11
;

985 
	s_COUNTER_RALINK
 {

986 
ULONG
 
	mTønsmôãdByãCou¡
;

987 
ULONG
 
	mRe˚ivedByãCou¡
;

988 
ULONG
 
	mBìnDißssocüãdCou¡
;

989 
ULONG
 
	mBadCQIAutoRecovîyCou¡
;

990 
ULONG
 
	mPo‹CQIRﬂmögCou¡
;

991 
ULONG
 
	mMgmtRögFuŒCou¡
;

992 
ULONG
 
	mRxCou¡
;

993 
ULONG
 
	mRxRögEºCou¡
;

994 
ULONG
 
	mKickTxCou¡
;

995 
ULONG
 
	mTxRögEºCou¡
;

996 
LARGE_INTEGER
 
	mRólFcsEºCou¡
;

997 
ULONG
 
	mPídögNdisPackëCou¡
;

999 
ULONG
 
	mO√SecOsTxCou¡
[
NUM_OF_TX_RING
];

1000 
ULONG
 
	mO√SecDmaD⁄eCou¡
[
NUM_OF_TX_RING
];

1001 
ULONG
 
	mO√SecTxD⁄eCou¡
;

1002 
ULONG
 
	mO√SecTxAggªg©i⁄Cou¡
;

1003 
ULONG
 
	mO√SecRxAggªg©i⁄Cou¡
;

1005 
ULONG
 
	mO√SecTxNoRëryOkCou¡
;

1006 
ULONG
 
	mO√SecTxRëryOkCou¡
;

1007 
ULONG
 
	mO√SecTxFaûCou¡
;

1008 
ULONG
 
	mO√SecFÆ£CCAC¡
;

1009 
ULONG
 
	mO√SecRxOkC¡
;

1010 
ULONG
 
	mO√SecRxFcsEºC¡
;

1011 
ULONG
 
	mO√SecBóc⁄SítC¡
;

1012 } 
	tCOUNTER_RALINK
, *
	tPCOUNTER_RALINK
;

1014 
	s_COUNTER_DRS
 {

1016 
USHORT
 
	mTxQuÆôy
[
MAX_LEN_OF_SUPPORTED_RATES
];

1017 
UCHAR
 
	mPER
[
MAX_LEN_OF_SUPPORTED_RATES
];

1018 
UCHAR
 
	mTxR©eUpPíÆty
;

1019 
ULONG
 
	mCuºTxR©eSèbÀTime
;

1020 
BOOLEAN
 
	mfNoisyEnvú⁄mít
;

1021 
UCHAR
 
	mLa°SecTxR©eCh™geA˘i⁄
;

1022 } 
	tCOUNTER_DRS
, *
	tPCOUNTER_DRS
;

1024 
	s_COUNTER_QA
 {

1025 
LARGE_INTEGER
 
	mCRCEº‹Cou¡
;

1026 
LARGE_INTEGER
 
	mRXOvîFlowCou¡
;

1027 
LARGE_INTEGER
 
	mPHYEº‹Cou¡
;

1028 
LARGE_INTEGER
 
	mFÆ£CCACou¡
;

1029 
LARGE_INTEGER
 
	mU2MD©aCou¡
;

1030 
LARGE_INTEGER
 
	mOthîD©aCou¡
;

1031 
LARGE_INTEGER
 
	mBóc⁄Cou¡
;

1032 
LARGE_INTEGER
 
	mŸhîsCou¡
;

1033 } 
	tCOUNTER_QA
, *
	tPCOUNTER_QA
;

1038 
	s_ARCFOUR


1040 
UINT
 
	mX
;

1041 
UINT
 
	mY
;

1042 
UCHAR
 
	mSTATE
[256];

1043 } 
	tARCFOURCONTEXT
, *
	tPARCFOURCONTEXT
;

1045 
PACKED
 
	t_IV_CONTROL_


1047 
	uPACKED


1049 
	sPACKED


1051 
UCHAR
 
	grc0
;

1052 
UCHAR
 
	grc1
;

1053 
UCHAR
 
	grc2
;

1055 
	uPACKED


1057 
	sPACKED


1059 #ifde‡
BIG_ENDIAN


1060 
UCHAR
 
	gKeyID
:2;

1061 
UCHAR
 
	gExtIV
:1;

1062 
UCHAR
 
	gRsvd
:5;

1064 
UCHAR
 
	gRsvd
:5;

1065 
UCHAR
 
	gExtIV
:1;

1066 
UCHAR
 
	gKeyID
:2;

1068 } 
	gfõld
;

1069 
UCHAR
 
	gByã
;

1070 } 
	gCONTROL
;

1071 } 
	gfõld
;

1073 
ULONG
 
	gw‹d
;

1074 } 
	gIV16
;

1076 
ULONG
 
	gIV32
;

1077 } 
	tTKIP_IV
, *
	tPTKIP_IV
;

1081 
	s_WEP_KEY
 {

1082 
UCHAR
 
	mKeyLí
;

1083 
UCHAR
 
	mKey
[
MAX_LEN_OF_KEY
];

1084 } 
	tWEP_KEY
, *
	tPWEP_KEY
;

1087 
	s_CIPHER_KEY
 {

1088 
UCHAR
 
	mBssId
[6];

1089 
UCHAR
 
	mCùhîAlg
;

1090 
UCHAR
 
	mKeyLí
;

1091 
UCHAR
 
	mKey
[16];

1092 
UCHAR
 
	mRxMic
[8];

1093 
UCHAR
 
	mTxMic
[8];

1094 
UCHAR
 
	mTxTsc
[6];

1095 
UCHAR
 
	mRxTsc
[6];

1096 
UCHAR
 
	mTy≥
;

1097 } 
	tCIPHER_KEY
, *
	tPCIPHER_KEY
;

1100 
	s_BBP_TUNING_STRUCT
 {

1101 
BOOLEAN
 
	mE«bÀ
;

1102 
UCHAR
 
	mFÆ£CˇCou¡UµîBound
;

1103 
UCHAR
 
	mFÆ£CˇCou¡LowîBound
;

1104 
UCHAR
 
	mR17LowîBound
;

1105 
UCHAR
 
	mR17UµîBound
;

1106 
UCHAR
 
	mCuºítR17VÆue
;

1107 } 
	tBBP_TUNING
, *
	tPBBP_TUNING
;

1109 
	s_SOFT_RX_ANT_DIVERSITY_STRUCT
 {

1110 
UCHAR
 
	mEvÆu©ePîiod
;

1111 
UCHAR
 
	mPaú1Prim¨yRxA¡
;

1112 
UCHAR
 
	mPaú1Sec⁄d¨yRxA¡
;

1113 
UCHAR
 
	mPaú2Prim¨yRxA¡
;

1114 
UCHAR
 
	mPaú2Sec⁄d¨yRxA¡
;

1115 
SHORT
 
	mPaú1AvgRssi
[2];

1116 
SHORT
 
	mPaú2AvgRssi
[2];

1117 
SHORT
 
	mPaú1La°AvgRssi
;

1118 
SHORT
 
	mPaú2La°AvgRssi
;

1119 
ULONG
 
	mRcvPktNumWhíEvÆu©e
;

1120 
BOOLEAN
 
	mFú°PktAºivedWhíEvÆu©e
;

1121 
RALINK_TIMER_STRUCT
 
	mRxA¡DivîsôyTimî
;

1122 } 
	tSOFT_RX_ANT_DIVERSITY
, *
	tPSOFT_RX_ANT_DIVERSITY
;

1125 
BOOLEAN
 
	mE«bÀ
;

1126 
UCHAR
 
	mDñè
;

1127 
BOOLEAN
 
	mPlusSign
;

1128 } 
	tCCK_TX_POWER_CALIBRATE
, *
	tPCCK_TX_POWER_CALIBRATE
;

1133 
	s_TUPLE_CACHE
 {

1134 
BOOLEAN
 
	mVÆid
;

1135 
UCHAR
 
	mMacAddªss
[
MAC_ADDR_LEN
];

1136 
USHORT
 
	mSequí˚
;

1137 
USHORT
 
	mFøg
;

1138 } 
	tTUPLE_CACHE
, *
	tPTUPLE_CACHE
;

1143 
	s_FRAGMENT_FRAME
 {

1144 
UCHAR
 
	mHódî802_11
[
LENGTH_802_11
];

1145 
UCHAR
 
	mHódî802_3
[
LENGTH_802_3
];

1146 
UCHAR
 
	mHódî_LLC
[
LENGTH_802_1_H
];

1147 
UCHAR
 
	mBuf„r
[
LENGTH_802_3
 + 
MAX_FRAME_SIZE
];

1148 
ULONG
 
	mRxSize
;

1149 
USHORT
 
	mSequí˚
;

1150 
USHORT
 
	mLa°Føg
;

1151 
ULONG
 
	mFœgs
;

1152 } 
	tFRAGMENT_FRAME
, *
	tPFRAGMENT_FRAME
;

1157 
	s_TKIP_KEY_INFO
 {

1158 
UINT
 
	mnByãsInM
;

1159 
ULONG
 
	mIV16
;

1160 
ULONG
 
	mIV32
;

1161 
ULONG
 
	mK0
;

1162 
ULONG
 
	mK1
;

1163 
ULONG
 
	mL
;

1164 
ULONG
 
	mR
;

1165 
ULONG
 
	mM
;

1166 
UCHAR
 
	mRC4KEY
[16];

1167 
UCHAR
 
	mMIC
[8];

1168 } 
	tTKIP_KEY_INFO
, *
	tPTKIP_KEY_INFO
;

1173 
	s__PRIVATE_STRUC
 {

1174 
ULONG
 
	mSy°emRe£tC¡
;

1175 
ULONG
 
	mTxRögFuŒC¡
;

1176 
ULONG
 
	mPhyRxEºC¡
;

1178 
ULONG
 
	mFCSCRC32
;

1179 
ARCFOURCONTEXT
 
	mWEPCONTEXT
;

1181 
TKIP_KEY_INFO
 
	mTx
;

1182 
TKIP_KEY_INFO
 
	mRx
;

1183 } 
	tPRIVATE_STRUC
, *
	tPPRIVATE_STRUC
;

1185 #ifde‡
RALINK_ATE


1186 
	s_ATE_INFO
 {

1187 
UCHAR
 
	mMode
;

1188 
CHAR
 
	mTxPowî
;

1189 
UCHAR
 
	mAddr1
[6];

1190 
UCHAR
 
	mAddr2
[6];

1191 
UCHAR
 
	mAddr3
[6];

1192 
UCHAR
 
	mCh™√l
;

1193 
ULONG
 
	mTxLígth
;

1194 
ULONG
 
	mTxCou¡
;

1195 
ULONG
 
	mTxD⁄eCou¡
;

1196 
ULONG
 
	mTxR©e
;

1197 
ULONG
 
	mRFFªqOff£t
;

1198 } 
	tATE_INFO
, *
	tPATE_INFO
;

1202 
	s_BBP_R17_TUNING
 {

1203 
BOOLEAN
 
	mbE«bÀ
;

1204 
UCHAR
 
	mR17LowîBoundG
;

1205 
UCHAR
 
	mR17LowîBoundA
;

1206 
UCHAR
 
	mR17UµîBoundG
;

1207 
UCHAR
 
	mR17UµîBoundA
;

1211 
USHORT
 
	mFÆ£CˇLowîThªshﬁd
;

1212 
USHORT
 
	mFÆ£CˇUµîThªshﬁd
;

1213 
UCHAR
 
	mR17Dñè
;

1214 
UCHAR
 
	mR17CuºítVÆue
;

1215 
BOOLEAN
 
	mR17LowîUµîSñe˘
;

1216 } 
	tBBP_R17_TUNING
, *
	tPBBP_R17_TUNING
;

1219 
	s_CHANNEL_TX_POWER
 {

1220 
UCHAR
 
	mCh™√l
;

1221 
CHAR
 
	mPowî
;

1222 } 
	tCHANNEL_TX_POWER
, *
	tPCHANNEL_TX_POWER
;

1224 
	e_ABGBAND_STATE_
 {

1225 
	mUNKNOWN_BAND
,

1226 
	mBG_BAND
,

1227 
	mA_BAND
,

1228 } 
	tABGBAND_STATE
;

1230 
	s_MLME_MEMORY_STRUCT
 {

1231 
PVOID
 
	mAŒocVa
;

1232 
_MLME_MEMORY_STRUCT
 *
	mNext
;

1233 } 
	tMLME_MEMORY_STRUCT
, *
	tPMLME_MEMORY_STRUCT
;

1235 
	s_MLME_MEMORY_HANDLER
 {

1236 
BOOLEAN
 
	mMemRu¬ög
;

1237 
UINT
 
	mMem‹yCou¡
;

1238 
UINT
 
	mInU£Cou¡
;

1239 
UINT
 
	mUnU£Cou¡
;

1240 
UINT
 
	mPídögCou¡
;

1241 
PMLME_MEMORY_STRUCT
 
	mpInU£Hód
;

1242 
PMLME_MEMORY_STRUCT
 
	mpInU£Taû
;

1243 
PMLME_MEMORY_STRUCT
 
	mpUnU£Hód
;

1244 
PMLME_MEMORY_STRUCT
 
	mpUnU£Taû
;

1245 
PULONG
 
	mMemFªePídög
[
MAX_MLME_HANDLER_MEMORY
];

1246 } 
	tMLME_MEMORY_HANDLER
, *
	tPMLME_MEMORY_HANDLER
;

1248 
	s_MLME_STRUCT
 {

1250 
STATE_MACHINE
 
	mC¡lMachöe
;

1251 
STATE_MACHINE
 
	mAssocMachöe
;

1252 
STATE_MACHINE
 
	mAuthMachöe
;

1253 
STATE_MACHINE
 
	mAuthR•Machöe
;

1254 
STATE_MACHINE
 
	mSyncMachöe
;

1255 
STATE_MACHINE
 
	mW∑PskMachöe
;

1256 
STATE_MACHINE_FUNC
 
	mAssocFunc
[
ASSOC_FUNC_SIZE
];

1257 
STATE_MACHINE_FUNC
 
	mAuthFunc
[
AUTH_FUNC_SIZE
];

1258 
STATE_MACHINE_FUNC
 
	mAuthR•Func
[
AUTH_RSP_FUNC_SIZE
];

1259 
STATE_MACHINE_FUNC
 
	mSyncFunc
[
SYNC_FUNC_SIZE
];

1260 
STATE_MACHINE_FUNC
 
	mW∑PskFunc
[
WPA_PSK_FUNC_SIZE
];

1263 
ULONG
 
	mCh™√lQuÆôy
;

1264 
ULONG
 
	mNow32
;

1266 
BOOLEAN
 
	mbRu¬ög
;

1267 
•ölock_t
 
	mTaskLock
;

1268 
MLME_QUEUE
 
	mQueue
;

1270 
UINT
 
	mShi·Reg
;

1272 
RALINK_TIMER_STRUCT
 
	mPîiodicTimî
;

1273 
RALINK_TIMER_STRUCT
 
	mLökDownTimî
;

1274 
ULONG
 
	mPîiodicRound
;

1276 
MLME_MEMORY_HANDLER
 
	mMemH™dÀr
;

1277 } 
	tMLME_STRUCT
, *
	tPMLME_STRUCT
;

1282 
PACKED
 
	t_MGMT_STRUC
 {

1283 
BOOLEAN
 
	gVÆid
;

1284 
PUCHAR
 
	gpBuf„r
;

1285 
ULONG
 
	gLígth
;

1286 } 
	tMGMT_STRUC
, *
	tPMGMT_STRUC
;

1289 
	s_RADAR_DETECT_STRUCT
 {

1290 
UCHAR
 
	mCSCou¡
;

1291 
UCHAR
 
	mCSPîiod
;

1292 
UCHAR
 
	mRDCou¡
;

1293 
UCHAR
 
	mRDMode
;

1294 
UCHAR
 
	mBBPR16
;

1295 
UCHAR
 
	mBBPR17
;

1296 
UCHAR
 
	mBBPR18
;

1297 
UCHAR
 
	mBBPR21
;

1298 
UCHAR
 
	mBBPR22
;

1299 
UCHAR
 
	mBBPR64
;

1300 
ULONG
 
	mInSîvi˚M⁄ô‹Cou¡
;

1301 } 
	tRADAR_DETECT_STRUCT
, *
	tPRADAR_DETECT_STRUCT
;

1306 
	s_PORT_CONFIG
 {

1309 
USHORT
 
	mPsm
;

1310 
USHORT
 
	mDißssocRós⁄
;

1311 
UCHAR
 
	mDißssocSè
[
MAC_ADDR_LEN
];

1312 
USHORT
 
	mDóuthRós⁄
;

1313 
UCHAR
 
	mDóuthSè
[
MAC_ADDR_LEN
];

1314 
USHORT
 
	mAuthFaûRós⁄
;

1315 
UCHAR
 
	mAuthFaûSè
[
MAC_ADDR_LEN
];

1317 
NDIS_802_11_AUTHENTICATION_MODE
 
	mAuthMode
;

1318 
NDIS_802_11_WEP_STATUS
 
	mWïSètus
;

1319 
NDIS_802_11_WEP_STATUS
 
	mOrigWïSètus
;

1321 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


1322 
	mwx_auth_Æg
;

1323 
	mwx_key_mgmt
;

1324 
	mwx_w∑_vîsi⁄
;

1325 
	mwx_∑úwi£
;

1326 
	mwx_groupCùhî
;

1333 
BOOLEAN
 
	mwx_√ed_sync
;

1334 
BOOLEAN
 
	mbN©iveW∑
;

1337 
NDIS_802_11_ENCRYPTION_STATUS
 
	mGroupCùhî
;

1338 
NDIS_802_11_ENCRYPTION_STATUS
 
	mPaúCùhî
;

1339 
BOOLEAN
 
	mbMixCùhî
;

1340 
USHORT
 
	mR¢C≠abûôy
;

1343 
CIPHER_KEY
 
	mPskKey
;

1344 
UCHAR
 
	mPTK
[64];

1345 
BSSID_INFO
 
	mSavedPMK
[
PMKID_NO
];

1346 
ULONG
 
	mSavedPMKNum
;

1349 
UCHAR
 
	mP‹tSecuªd
;

1350 
UCHAR
 
	mRSN_IE
[44];

1351 
UCHAR
 
	mRSN_IELí
;

1354 
BOOLEAN
 
	mIEEE8021X
;

1355 
CIPHER_KEY
 
	mDesúeSh¨edKey
[4];

1356 
BOOLEAN
 
	mIEEE8021x_ªquúed_keys
;

1357 
BOOLEAN
 
	mWPA_Suµliˇ¡
;

1361 
ULONG
 
	mLa°MicEº‹Time
;

1362 
ULONG
 
	mMicEºC¡
;

1363 
BOOLEAN
 
	mbBlockAssoc
;

1365 
WPA_STATE
 
	mW∑Sèã
;

1366 
UCHAR
 
	mRïœyCou¡î
[8];

1367 
UCHAR
 
	mAN⁄˚
[32];

1368 
UCHAR
 
	mSN⁄˚
[32];

1371 
UCHAR
 
	mDeÁu…KeyId
;

1372 
NDIS_802_11_PRIVACY_FILTER
 
	mPrivacyFûãr
;

1376 
USHORT
 
	mRtsThªshﬁd
;

1377 
USHORT
 
	mFøgmítThªshﬁd
;

1378 
BOOLEAN
 
	mbFøgmítZîoDißbÀ
;

1381 
UCHAR
 
	mTxPowî
;

1382 
ULONG
 
	mTxPowîPî˚¡age
;

1383 
ULONG
 
	mTxPowîDeÁu…
;

1386 
UCHAR
 
	mCh™√l
;

1387 
UCHAR
 
	mAdhocCh™√l
;

1388 
UCHAR
 
	mCou¡ryRegi⁄
;

1389 
UCHAR
 
	mCou¡ryRegi⁄F‹AB™d
;

1394 
UCHAR
 
	mSupR©e
[
MAX_LEN_OF_SUPPORTED_RATES
];

1395 
UCHAR
 
	mSupR©eLí
;

1396 
UCHAR
 
	mExtR©e
[
MAX_LEN_OF_SUPPORTED_RATES
];

1397 
UCHAR
 
	mExtR©eLí
;

1398 
UCHAR
 
	mEx≥˘edACKR©e
[
MAX_LEN_OF_SUPPORTED_RATES
];

1400 
ULONG
 
	mBasicR©eBôm≠
;

1405 
UCHAR
 
	mDesúeR©e
[
MAX_LEN_OF_SUPPORTED_RATES
];

1406 
UCHAR
 
	mMaxDesúedR©e
;

1407 
UCHAR
 
	mDeÁu…MaxDesúedR©e
;

1408 
UCHAR
 
	mBasicMlmeR©e
;

1409 
UCHAR
 
	mMlmeR©e
;

1410 
UCHAR
 
	mRtsR©e
;

1411 
UCHAR
 
	mTxR©e
;

1412 
UCHAR
 
	mMaxTxR©e
;

1414 
UCHAR
 
	mBssid
[
MAC_ADDR_LEN
];

1415 
USHORT
 
	mBóc⁄Pîiod
;

1417 
CHAR
 
	mSsid
[
MAX_LEN_OF_SSID
+1];

1418 
UCHAR
 
	mSsidLí
;

1419 
UCHAR
 
	mLa°SsidLí
;

1421 
CHAR
 
	mLa°Ssid
[
MAX_LEN_OF_SSID
+1];

1422 
UCHAR
 
	mLa°Bssid
[
MAC_ADDR_LEN
];

1424 
UCHAR
 
	mBssTy≥
;

1425 
USHORT
 
	mAtimWö
;

1427 
UCHAR
 
	mRssiTriggî
;

1428 
UCHAR
 
	mRssiTriggîMode
;

1429 
USHORT
 
	mDeÁu…Li°íCou¡
;

1430 
ULONG
 
	mWödowsPowîMode
;

1431 
ULONG
 
	mWödowsB©ãryPowîMode
;

1432 
BOOLEAN
 
	mbWödowsACCAME«bÀ
;

1433 
BOOLEAN
 
	mbAutoRec⁄√˘
;

1435 
UCHAR
 
	mLa°Rssi
;

1436 
UCHAR
 
	mLa°Rssi2
;

1437 
USHORT
 
	mAvgRssi
;

1438 
USHORT
 
	mAvgRssiX8
;

1439 
ULONG
 
	mNumOfAvgRssiSam∂e
;

1441 
ULONG
 
	mLa°Bóc⁄RxTime
;

1442 
ULONG
 
	mLa°11bBóc⁄RxTime
;

1443 
ULONG
 
	mLa°SˇnTime
;

1444 
ULONG
 
	mSˇnC¡
;

1445 
BOOLEAN
 
	mbSwRadio
;

1446 
BOOLEAN
 
	mbHwRadio
;

1447 
BOOLEAN
 
	mbRadio
;

1448 
BOOLEAN
 
	mbH¨dw¨eRadio
;

1449 
BOOLEAN
 
	mbShowHiddíSSID
;

1453 
UCHAR
 
	mPhyMode
;

1454 
USHORT
 
	mDsifs
;

1455 
USHORT
 
	mTxPªambÀ
;

1459 
NDIS_802_11_ASSOCIATION_INFORMATION
 
	mAssocInfo
;

1460 
UCHAR
 
	mReqV¨IELí
;

1461 
UCHAR
 
	mReqV¨IEs
[
MAX_VIE_LEN
];

1462 
UCHAR
 
	mResV¨IELí
;

1463 
UCHAR
 
	mResV¨IEs
[
MAX_VIE_LEN
];

1465 
ULONG
 
	mE«bÀTurboR©e
;

1466 
ULONG
 
	mU£BGPrŸe˘i⁄
;

1467 
ULONG
 
	mU£Sh‹tSlŸTime
;

1471 
BOOLEAN
 
	mbWmmC≠abÀ
;

1472 
QOS_CAPABILITY_PARM
 
	mAPQosC≠abûôy
;

1473 
EDCA_PARM
 
	mAPEdˇP¨m
;

1474 
QBSS_LOAD_PARM
 
	mAPQbssLﬂd
;

1476 
BOOLEAN
 
	mbE«bÀTxBur°
;

1477 
BOOLEAN
 
	mbAggªg©i⁄C≠abÀ
;

1478 
BOOLEAN
 
	mbU£ZîoToDißbÀFøgmít
;

1479 
BOOLEAN
 
	mbIEEE80211H
;

1485 
ULONG
 
	mOpSètusFœgs
;

1487 
UCHAR
 
	mAckPﬁicy
[4];

1489 
ABGBAND_STATE
 
	mB™dSèã
;

1491 
ULONG
 
	mAdhocMode
;

1493 
RALINK_TIMER_STRUCT
 
	mQuickRe•⁄eF‹R©eUpTimî
;

1494 
BOOLEAN
 
	mQuickRe•⁄eF‹R©eUpTimîRu¬ög
;

1495 
RALINK_TIMER_STRUCT
 
	mW∑DißssocAndBlockAssocTimî
;

1498 
BOOLEAN
 
	mbFa°Rﬂmög
;

1499 
ULONG
 
	mdBmToRﬂm
;

1501 
RADAR_DETECT_STRUCT
 
	mRad¨Dëe˘
;

1503 
BOOLEAN
 
	mbGëAPC⁄fig
;

1505 } 
	tPORT_CONFIG
, *
	tPPORT_CONFIG
;

1514 
	s_ACTIVE_CONFIG
 {

1515 
USHORT
 
	mAid
;

1516 
USHORT
 
	mAtimWö
;

1517 
USHORT
 
	mC≠abûôyInfo
;

1518 
USHORT
 
	mCÂMaxDuøti⁄
;

1519 
USHORT
 
	mCÂPîiod
;

1523 
UCHAR
 
	mSupR©e
[
MAX_LEN_OF_SUPPORTED_RATES
];

1524 
UCHAR
 
	mExtR©e
[
MAX_LEN_OF_SUPPORTED_RATES
];

1525 
UCHAR
 
	mSupR©eLí
;

1526 
UCHAR
 
	mExtR©eLí
;

1527 } 
	tACTIVE_CONFIG
, *
	tPACTIVE_CONFIG
;

1529 #ifde‡
BLOCK_NET_IF


1530 
	s_BLOCK_QUEUE_ENTRY


1532 
BOOLEAN
 
	mSwTxQueueBlockFœg
;

1533 
LIST_HEADER
 
	mNëIfLi°
;

1534 } 
	tBLOCK_QUEUE_ENTRY
, *
	tPBLOCK_QUEUE_ENTRY
;

1540 
	s_RTMP_ADAPTER


1545 
CHAR
 
	mnickn
[
IW_ESSID_MAX_SIZE
+1];

1546 
usb_devi˚
 *
	mpUsb_Dev
;

1547 
√t_devi˚
 *
	m√t_dev
;

1548 
èskÀt_°ru˘
 
	mrx_bh
;

1549 
usb_c⁄fig_des¸ùt‹
 *
	mc⁄fig
;

1550 
dev˘æªque°
 *
	mdevªq
;

1555 
£m≠h‹e
 
	musbdev_£m≠h‹e
;

1557 
£m≠h‹e
 
	mmlme_£m≠h‹e
;

1558 
£m≠h‹e
 
	mRTUSBCmd_£m≠h‹e
;

1560 
£m≠h‹e
 
	mMaCRegWrôe_£m≠h‹e
;

1561 
com∂ëi⁄
 
	mMlmeThªadNŸify
;

1562 
com∂ëi⁄
 
	mCmdThªadNŸify
;

1563 
THREAD_PID
 
	mMLMEThr_pid
;

1564 
THREAD_PID
 
	mRTUSBCmdThr_pid
;

1565 
waô_queue_hód_t
 *
	mwaô
;

1567 #i‡
WIRELESS_EXT
 >= 12

1568 
iw_°©i°ics
 
	miw_°©s
;

1570 
√t_devi˚_°©s
 
	m°©s
;

1572 
ULONG
 
	mVíd‹Desc
;

1573 
INT
 
	mio˘l_if_ty≥
;

1576 
QUEUE_HEADER
 
	mTxSwQueue
[
NUM_OF_TX_RING
];

1577 
MGMT_STRUC
 
	mMgmtRög
[
MGMT_RING_SIZE
];

1578 
ULONG
 
	mMaxTxQueueSize
;

1581 
TXD_STRUC
 
	mBóc⁄TxD
;

1582 
UCHAR
 
	mBóc⁄Buf
[256];

1585 
PSPOLL_FRAME
 
	mPsPﬁlFøme
;

1586 
HEADER_802_11
 
	mNuŒFøme
;

1589 
BOOLEAN
 
	mbLoˇlAdmöMAC
;

1590 
UCHAR
 
	mPîm™ítAddªss
[
MAC_ADDR_LEN
];

1591 
UCHAR
 
	mCuºítAddªss
[
MAC_ADDR_LEN
];

1593 
MLME_STRUCT
 
	mMlme
;

1598 
PORT_CONFIG
 
	mP‹tCfg
;

1599 
ACTIVE_CONFIG
 
	mA˘iveCfg
;

1600 
MLME_AUX
 
	mMlmeAux
;

1601 
BSS_TABLE
 
	mSˇnTab
;

1604 
CIPHER_KEY
 
	mSh¨edKey
[4];

1608 
BOOLEAN
 
	mbAc˚±Dúe˘
;

1609 
BOOLEAN
 
	mbAc˚±Mu…iˇ°
;

1610 
BOOLEAN
 
	mbAc˚±Brﬂdˇ°
;

1611 
BOOLEAN
 
	mbAc˚±AŒMu…iˇ°
;

1614 
ULONG
 
	mNumbîOfMˇ°Addªs£s
;

1615 
UCHAR
 
	mMˇ°TabÀ
[
MAX_MCAST_LIST_SIZE
][
MAC_ADDR_LEN
];

1619 
TUPLE_CACHE
 
	mTu∂eCache
[
MAX_CLIENT
];

1620 
UCHAR
 
	mTu∂eCacheLa°Upd©eIndex
;

1623 
FRAGMENT_FRAME
 
	mFøgFøme
;

1626 
COUNTER_802_3
 
	mCou¡îs8023
;

1627 
COUNTER_802_11
 
	mWœnCou¡îs
;

1628 
COUNTER_RALINK
 
	mRÆökCou¡îs
;

1629 
COUNTER_DRS
 
	mDrsCou¡îs
;

1630 
PRIVATE_STRUC
 
	mPriv©eInfo
;

1634 
COUNTER_802_3
 
	mCou¡îs
;

1635 
COUNTER_QA
 
	mQACou¡îs
;

1638 
ULONG
 
	mFœgs
;

1641 
USHORT
 
	mSequí˚
;

1644 
ULONG
 
	mLökDownTime
;

1645 
ULONG
 
	mLa°RxR©e
;

1646 
BOOLEAN
 
	mbC⁄figCh™ged
;

1648 
ULONG
 
	mExåaInfo
;

1649 
ULONG
 
	mSy°emEº‹Bôm≠
;

1654 
ULONG
 
	mEïromVîsi⁄
;

1655 
UCHAR
 
	mEEPROMAddªssNum
;

1656 
USHORT
 
	mEEPROMDeÁu…VÆue
[
NUM_EEPROM_BBP_PARMS
];

1658 
ULONG
 
	mFúmw¨eVîsi⁄
;

1663 
UCHAR
 
	mBbpWrôeL©ch
[110];

1664 
UCHAR
 
	mBbpRssiToDbmDñè
;

1665 
BBP_R17_TUNING
 
	mBbpTunög
;

1670 
UCHAR
 
	mRfIcTy≥
;

1671 
ULONG
 
	mRfFªqOff£t
;

1672 
BOOLEAN
 
	mbAutoTxAgc
;

1673 
RTMP_RF_REGS
 
	mL©chRfRegs
;

1677 
UCHAR
 
	mRFProgSeq
;

1678 
EEPROM_ANTENNA_STRUC
 
	mA¡í«
;

1679 
EEPROM_NIC_CONFIG2_STRUC
 
	mNicC⁄fig2
;

1680 
CHANNEL_TX_POWER
 
	mTxPowî
[
MAX_NUM_OF_CHANNELS
];

1681 
CHANNEL_TX_POWER
 
	mCh™√lLi°
[
MAX_NUM_OF_CHANNELS
];

1682 
UCHAR
 
	mCh™√lLi°Num
;

1683 
EEPROM_TXPOWER_DELTA_STRUC
 
	mTxPowîDñèC⁄fig
;

1684 
UCHAR
 
	mBbp94
;

1685 
BOOLEAN
 
	mBbpF‹CCK
;

1692 
SOFT_RX_ANT_DIVERSITY
 
	mRxA¡
;

1695 
BOOLEAN
 
	mbAutoTxAgcA
;

1696 
UCHAR
 
	mTssiRefA
;

1697 
UCHAR
 
	mTssiPlusBound¨yA
[5];

1698 
UCHAR
 
	mTssiMöusBound¨yA
[5];

1699 
UCHAR
 
	mTxAgcSãpA
;

1700 
CHAR
 
	mTxAgcCom≥nßãA
;

1702 
BOOLEAN
 
	mbAutoTxAgcG
;

1703 
UCHAR
 
	mTssiRefG
;

1704 
UCHAR
 
	mTssiPlusBound¨yG
[5];

1705 
UCHAR
 
	mTssiMöusBound¨yG
[5];

1706 
UCHAR
 
	mTxAgcSãpG
;

1707 
CHAR
 
	mTxAgcCom≥nßãG
;

1709 
CHAR
 
	mBGRssiOff£t1
;

1710 
CHAR
 
	mBGRssiOff£t2
;

1711 
CHAR
 
	mARssiOff£t1
;

1712 
CHAR
 
	mARssiOff£t2
;

1718 
MCU_LEDCS_STRUC
 
	mLedC¡l
;

1719 
USHORT
 
	mLedIndiˇt‹Såígth
;

1727 #ifde‡
RALINK_ATE


1728 
ATE_INFO
 
	m©e
;

1729 
BOOLEAN
 
	mC⁄töBulkOut
;

1730 
©omic_t
 
	mBulkOutRemaöed
;

1731 
BOOLEAN
 
	mC⁄töBulkIn
;

1732 
©omic_t
 
	mBulkInRemaöed
;

1741 
USHORT
 
	mBulkOutMaxPackëSize
;

1742 
USHORT
 
	mBulkInMaxPackëSize
;

1744 
CmdQ
 
	mCmdQ
;

1745 
CmdQElmt
 
	mCmdQEÀmíts
[
COMMAND_QUEUE_SIZE
];

1746 
BOOLEAN
 
	mCmdH™dÀrIsRu¬ög
;

1748 
BOOLEAN
 
	mDeQueueRu¬ög
[4];

1749 
BOOLEAN
 
	mDeMGMTQueueRu¬ög
;

1752 
•ölock_t
 
	mSídTxWaôQueueLock
[4];

1754 
•ölock_t
 
	mD©aQLock
[4];

1755 
•ölock_t
 
	mDeQueueLock
[4];

1756 
•ölock_t
 
	mDeMGMTQueueLock
;

1757 
•ölock_t
 
	mMLMEWaôQueueLock
;

1758 
•ölock_t
 
	mCmdQLock
;

1759 
•ölock_t
 
	mBulkOutLock
[4];

1762 
•ölock_t
 
	mMLMEQLock
;

1763 
•ölock_t
 
	mGíîicLock
;

1764 
•ölock_t
 
	mTxRögLock
;

1769 
TX_CONTEXT
 
	mMLMEC⁄ãxt
[
PRIO_RING_SIZE
];

1770 
TX_CONTEXT
 
	mBóc⁄C⁄ãxt
[
BEACON_RING_SIZE
];

1771 
TX_CONTEXT
 
	mNuŒC⁄ãxt
;

1772 
TX_CONTEXT
 
	mPsPﬁlC⁄ãxt
;

1773 
TX_CONTEXT
 
	mRTSC⁄ãxt
;

1778 
QUEUE_HEADER
 
	mSídTxWaôQueue
[4];

1780 
UINT32
 
	mTxRögTŸÆNumbî
[4];

1781 
UCHAR
 
	mNextTxIndex
[4];

1783 
UCHAR
 
	mNextMLMEIndex
;

1784 
UCHAR
 
	mPushMgmtIndex
;

1785 
UCHAR
 
	mP›MgmtIndex
;

1786 
©omic_t
 
	mMgmtQueueSize
;

1787 
UCHAR
 
	mNextRxBulkInIndex
;

1790 
UCHAR
 
	mNextBulkOutIndex
[4];

1791 
BOOLEAN
 
	mBulkOutPídög
[4];

1794 
ULONG
 
	mPrioRögTxC¡
;

1795 
UCHAR
 
	mPrioRögFú°Index
;

1797 
©omic_t
 
	mTxCou¡
;

1798 
LONG
 
	mPídögTx
;

1801 
TX_CONTEXT
 
	mTxC⁄ãxt
[4][
TX_RING_SIZE
];

1802 
LONG
 
	mNumPackësQueued
[4];

1809 
RX_CONTEXT
 
	mRxC⁄ãxt
[
RX_RING_SIZE
];

1813 
©omic_t
 
	mPídögRx
;

1820 
ULONG
 
	mBulkFœgs
;

1823 
ULONG
 
	mBulkOutD©aO√SecCou¡
;

1824 
ULONG
 
	mBulkInD©aO√SecCou¡
;

1825 
ULONG
 
	mBulkLa°O√SecCou¡
;

1828 #ifde‡
BLOCK_NET_IF


1829 
BLOCK_QUEUE_ENTRY
 
	mblockQueueTab
[
NUM_OF_TX_RING
];

1833 
	mnuŒ_‰ame_cou¡î
;

1836 
ULONG
 
	mVútuÆIfC¡
;

1837 
USHORT
 
	mMacRegWrôe_Pro˚ssög
;

1838 
BOOLEAN
 
	mProbeFöish
;

1839 } 
	tRTMP_ADAPTER
, *
	tPRTMP_ADAPTER
;

1853 #ifde‡
RALINK_ATE


1854 
RTMP_RF_REGS
 
RF2528RegTabÀ
[];

1855 
RTMP_RF_REGS
 
RF5226RegTabÀ
[];

1856 
RTMP_RF_REGS
 
RF5225RegTabÀ
[];

1857 
UCHAR
 
NUM_OF_2528_CHNL
;

1858 
UCHAR
 
NUM_OF_5226_CHNL
;

1859 
UCHAR
 
NUM_OF_5225_CHNL
;

1869 
VOID
 
RTUSBHÆt
(

1870 
IN
 
PRTMP_ADAPTER
 
pAd
,

1871 
IN
 
BOOLEAN
 
IsFªe
);

1873 
VOID
 
CMDH™dÀr
(

1874 
IN
 
PRTMP_ADAPTER
 
pAd
);

1876 
INT
 
MlmeThªad
(

1877 
IN
 * 
C⁄ãxt
);

1879 
INT
 
RTUSBCmdThªad
(

1880 
IN
 * 
C⁄ãxt
);

1882 #i‡
WIRELESS_EXT
 >= 12

1883 
iw_°©i°ics
 *
π73_gë_wúñess_°©s
(

1884 
IN
 
√t_devi˚
 *
√t_dev
);

1887 
√t_devi˚_°©s
 *
π73_gë_ëhî_°©s
(

1888 
IN
 
√t_devi˚
 *
√t_dev
);

1890 
π_abs
(
¨g
);

1896 
VOID
 
Cª©eThªads
–
√t_devi˚
 *
√t_dev
 );

1898 
NDIS_STATUS
 
NICInôTønsmô
(

1899 
IN
 
PRTMP_ADAPTER
 
pAd
 );

1901 
NDIS_STATUS
 
NICInôRecv
(

1902 
IN
 
PRTMP_ADAPTER
 
pAd
);

1904 
VOID
 
Rñó£Ad≠ãr
(

1905 
IN
 
PRTMP_ADAPTER
 
pAd
,

1906 
IN
 
BOOLEAN
 
IsFªe
,

1907 
IN
 
BOOLEAN
 
IsO∆yTx
);

1909 
NDIS_STATUS
 
RTMPInôAd≠ãrBlock
(

1910 
IN
 
PRTMP_ADAPTER
 
pAd
);

1912 
NDIS_STATUS
 
RTUSBWrôeHWMACAddªss
(

1913 
IN
 
PRTMP_ADAPTER
 
pAd
);

1915 
VOID
 
NICRódEEPROMP¨amëîs
(

1916 
IN
 
PRTMP_ADAPTER
 
pAd
);

1918 
VOID
 
NICInôAsicFromEEPROM
(

1919 
IN
 
PRTMP_ADAPTER
 
pAd
);

1921 
NDIS_STATUS
 
NICInôülizeAsic
(

1922 
IN
 
PRTMP_ADAPTER
 
pAd
);

1924 
VOID
 
NICIssueRe£t
(

1925 
IN
 
PRTMP_ADAPTER
 
pAd
);

1927 
BOOLEAN
 
NICCheckF‹H™g
(

1928 
IN
 
PRTMP_ADAPTER
 
pAd
);

1930 
VOID
 
NICUpd©eRawCou¡îs
(

1931 
IN
 
PRTMP_ADAPTER
 
pAd
);

1933 
VOID
 
NICRe£tFromEº‹
(

1934 
IN
 
PRTMP_ADAPTER
 
pAd
);

1936 
NDIS_STATUS
 
NICLﬂdFúmw¨e
(

1937 
IN
 
PRTMP_ADAPTER
 
pAd
);

1939 
PUCHAR
 
RTMPFödSe˘i⁄
(

1940 
IN
 
PCHAR
 
buf„r
);

1942 
INT
 
RTMPGëKeyP¨amëî
(

1943 
IN
 
PCHAR
 
key
,

1944 
OUT
 
PCHAR
 
de°
,

1945 
IN
 
INT
 
de°size
,

1946 
IN
 
PCHAR
 
buf„r
);

1948 
VOID
 
RTMPRódP¨amëîsFromFûe
(

1949 
IN
 
PRTMP_ADAPTER
 
pAd
);

1951 #i‚de‡
BIG_ENDIAN


1952 
ULONG
 
RTMPEquÆMem‹y
(

1953 
IN
 
PVOID
 
pSrc1
,

1954 
IN
 
PVOID
 
pSrc2
,

1955 
IN
 
ULONG
 
Lígth
);

1958 
ULONG
 
RTMPCom∑ªMem‹y
(

1959 
IN
 
PVOID
 
pSrc1
,

1960 
IN
 
PVOID
 
pSrc2
,

1961 
IN
 
ULONG
 
Lígth
);

1963 
VOID
 
RTMPZîoMem‹y
(

1964 
IN
 
PVOID
 
pSrc
,

1965 
IN
 
ULONG
 
Lígth
);

1967 
VOID
 
RTMPFûlMem‹y
(

1968 
IN
 
PVOID
 
pSrc
,

1969 
IN
 
ULONG
 
Lígth
,

1970 
IN
 
UCHAR
 
Fûl
);

1972 
VOID
 
RTMPMoveMem‹y
(

1973 
OUT
 
PVOID
 
pDe°
,

1974 
IN
 
PVOID
 
pSrc
,

1975 
IN
 
ULONG
 
Lígth
);

1977 
VOID
 
P‹tCfgInô
(

1978 
IN
 
PRTMP_ADAPTER
 
pAd
);

1980 
UCHAR
 
BtoH
(

1981 
IN
 
CHAR
 
ch
);

1983 
VOID
 
AtoH
(

1984 
IN
 
CHAR
 *
§c
,

1985 
OUT
 
UCHAR
 *
de°
,

1986 
IN
 
INT
 
de°Àn
);

1988 
VOID
 
RTMPP©chMacBbpBug
(

1989 
IN
 
PRTMP_ADAPTER
 
pAd
);

1991 
VOID
 
RTMPu£cDñay
(

1992 
IN
 
ULONG
 
u£c
);

1994 
VOID
 
RTMPSëLED
(

1995 
IN
 
PRTMP_ADAPTER
 
pAd
,

1996 
IN
 
UCHAR
 
Sètus
);

1998 
VOID
 
RTMPSëSig«lLED
(

1999 
IN
 
PRTMP_ADAPTER
 
pAd
,

2000 
IN
 
NDIS_802_11_RSSI
 
Dbm
);

2002 
VOID
 
RTMPCckBbpTunög
(

2003 
IN
 
PRTMP_ADAPTER
 
pAd
,

2004 
IN
 
UINT
 
TxR©e
);

2006 
VOID
 
RTMPInôTimî
(

2007 
IN
 
PRTMP_ADAPTER
 
pAd
,

2008 
IN
 
PRALINK_TIMER_STRUCT
 
pTimî
,

2009 
IN
 
PVOID
 
pTimîFunc
,

2010 
IN
 
PVOID
 
pD©a
,

2011 
IN
 
BOOLEAN
 
Rïót
);

2013 
VOID
 
RTMPSëTimî
(

2014 
IN
 
PRALINK_TIMER_STRUCT
 
pTimî
,

2015 
IN
 
ULONG
 
VÆue
);

2017 
VOID
 
RTMPModTimî
(

2018 
IN
 
PRALINK_TIMER_STRUCT
 
pTimî
,

2019 
IN
 
ULONG
 
VÆue
);

2021 
VOID
 
RTMPC™˚lTimî
(

2022 
IN
 
PRALINK_TIMER_STRUCT
 
pTimî
,

2023 
OUT
 
BOOLEAN
 *
pC™˚Œed
);

2025 * 
π°r°r
(c⁄° * 
s1
,c⁄° * 
s2
);

2033 
VOID
 
AsicSwôchCh™√l
(

2034 
IN
 
PRTMP_ADAPTER
 
pAd
,

2035 
IN
 
UCHAR
 
Ch™√l
);

2037 
VOID
 
AsicLockCh™√l
(

2038 
IN
 
PRTMP_ADAPTER
 
pAd
,

2039 
IN
 
UCHAR
 
Ch™√l
);

2041 
VOID
 
AsicA¡í«Sñe˘
(

2042 
IN
 
PRTMP_ADAPTER
 
pAd
,

2043 
IN
 
UCHAR
 
Ch™√l
);

2045 
VOID
 
AsicA¡í«Sëtög
(

2046 
IN
 
PRTMP_ADAPTER
 
pAd
,

2047 
IN
 
ABGBAND_STATE
 
B™dSèã
);

2049 
VOID
 
AsicAdju°TxPowî
(

2050 
IN
 
PRTMP_ADAPTER
 
pAd
);

2052 
VOID
 
AsicSÀïThíAutoWakeup
(

2053 
IN
 
PRTMP_ADAPTER
 
pAd
,

2054 
IN
 
USHORT
 
TbâNumToNextWakeUp
);

2056 
VOID
 
AsicF‹˚SÀï
(

2057 
IN
 
PRTMP_ADAPTER
 
pAd
);

2059 
VOID
 
AsicF‹˚Wakeup
(

2060 
IN
 
PRTMP_ADAPTER
 
pAd
);

2062 
VOID
 
AsicSëBssid
(

2063 
IN
 
PRTMP_ADAPTER
 
pAd
,

2064 
IN
 
PUCHAR
 
pBssid
);

2066 
VOID
 
AsicDißbÀSync
(

2067 
IN
 
PRTMP_ADAPTER
 
pAd
);

2069 
VOID
 
AsicE«bÀBssSync
(

2070 
IN
 
PRTMP_ADAPTER
 
pAd
);

2072 
VOID
 
AsicE«bÀIbssSync
(

2073 
IN
 
PRTMP_ADAPTER
 
pAd
);

2075 
VOID
 
AsicSëEdˇP¨m
(

2076 
IN
 
PRTMP_ADAPTER
 
pAd
,

2077 
IN
 
PEDCA_PARM
 
pEdˇP¨m
);

2079 
VOID
 
AsicSëSlŸTime
(

2080 
IN
 
PRTMP_ADAPTER
 
pAd
,

2081 
IN
 
BOOLEAN
 
bU£Sh‹tSlŸTime
);

2083 
VOID
 
AsicBbpTunög
(

2084 
IN
 
PRTMP_ADAPTER
 
pAd
);

2086 
VOID
 
AsicAddSh¨edKeyE¡ry
(

2087 
IN
 
PRTMP_ADAPTER
 
pAd
,

2088 
IN
 
UCHAR
 
BssIndex
,

2089 
IN
 
UCHAR
 
KeyIdx
,

2090 
IN
 
UCHAR
 
CùhîAlg
,

2091 
IN
 
PUCHAR
 
pKey
,

2092 
IN
 
PUCHAR
 
pTxMic
,

2093 
IN
 
PUCHAR
 
pRxMic
);

2095 
VOID
 
AsicRemoveSh¨edKeyE¡ry
(

2096 
IN
 
PRTMP_ADAPTER
 
pAd
,

2097 
IN
 
UCHAR
 
BssIndex
,

2098 
IN
 
UCHAR
 
KeyIdx
);

2100 
VOID
 
AsicAddPaúwi£KeyE¡ry
(

2101 
IN
 
PRTMP_ADAPTER
 
pAd
,

2102 
IN
 
PUCHAR
 
pAddr
,

2103 
IN
 
UCHAR
 
KeyIdx
,

2104 
IN
 
UCHAR
 
CùhîAlg
,

2105 
IN
 
PUCHAR
 
pKey
,

2106 
IN
 
PUCHAR
 
pTxMic
,

2107 
IN
 
PUCHAR
 
pRxMic
);

2109 
VOID
 
AsicRemovePaúwi£KeyE¡ry
(

2110 
IN
 
PRTMP_ADAPTER
 
pAd
,

2111 
IN
 
UCHAR
 
KeyIdx
);

2113 
VOID
 
RTMPCheckR©es
(

2114 
IN
 
PRTMP_ADAPTER
 
pAd
,

2115 
IN
 
OUT
 
UCHAR
 
SupR©e
[],

2116 
IN
 
OUT
 
UCHAR
 *
SupR©eLí
);

2118 
VOID
 
AsicSëRxA¡
(

2119 
IN
 
PRTMP_ADAPTER
 
pAd
,

2120 
IN
 
UCHAR
 
Paú1
,

2121 
IN
 
UCHAR
 
Paú2
);

2123 
VOID
 
AsicEvÆu©eSec⁄d¨yRxA¡
(

2124 
IN
 
PRTMP_ADAPTER
 
pAd
);

2126 
VOID
 
AsicRxA¡EvÆTimeout
(

2127 
IN
 
PVOID
 
Sy°emS≥cific1
,

2128 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

2129 
IN
 
PVOID
 
Sy°emS≥cific2
,

2130 
IN
 
PVOID
 
Sy°emS≥cific3
);

2132 
VOID
 
AsicRxA¡EvÆA˘i⁄
(

2133 
IN
 
PRTMP_ADAPTER
 
pAd
);

2135 
UCHAR
 
R™domByã
(

2136 
IN
 
PRTMP_ADAPTER
 
pAd
);

2138 
VOID
 
SèQuickRe•⁄eF‹R©eUpExec
(

2139 
IN
 
PVOID
 
Sy°emS≥cific1
,

2140 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

2141 
IN
 
PVOID
 
Sy°emS≥cific2
,

2142 
IN
 
PVOID
 
Sy°emS≥cific3
);

2144 
VOID
 
BssTabÀInô
(

2145 
IN
 
BSS_TABLE
 *
Tab
);

2147 
ULONG
 
BssTabÀSórch
(

2148 
IN
 
BSS_TABLE
 *
Tab
,

2149 
IN
 
PUCHAR
 
pBssid
,

2150 
IN
 
UCHAR
 
Ch™√l
);

2152 
ULONG
 
BssSsidTabÀSórch
(

2153 
IN
 
BSS_TABLE
 *
Tab
,

2154 
IN
 
PUCHAR
 
pBssid
,

2155 
IN
 
PUCHAR
 
pSsid
,

2156 
IN
 
UCHAR
 
SsidLí
,

2157 
IN
 
UCHAR
 
Ch™√l
);

2159 
ULONG
 
BssTabÀSórchWôhSSID
(

2160 
IN
 
BSS_TABLE
 *
Tab
,

2161 
IN
 
PUCHAR
 
Bssid
,

2162 
IN
 
PUCHAR
 
pSsid
,

2163 
IN
 
UCHAR
 
SsidLí
,

2164 
IN
 
UCHAR
 
Ch™√l
);

2166 
VOID
 
BssTabÀDñëeE¡ry
(

2167 
IN
 
OUT
 
BSS_TABLE
 *
Tab
,

2168 
IN
 
PUCHAR
 
pBssid
,

2169 
IN
 
UCHAR
 
Ch™√l
);

2171 
VOID
 
BssE¡rySë
(

2172 
IN
 
PRTMP_ADAPTER
 
pAd
,

2173 
OUT
 
BSS_ENTRY
 *
pBss
,

2174 
IN
 
PUCHAR
 
pBssid
,

2175 
IN
 
CHAR
 
Ssid
[],

2176 
IN
 
UCHAR
 
SsidLí
,

2177 
IN
 
UCHAR
 
BssTy≥
,

2178 
IN
 
USHORT
 
Bóc⁄Pîiod
,

2179 
IN
 
PCF_PARM
 
pCfP¨m
,

2180 
IN
 
USHORT
 
AtimWö
,

2181 
IN
 
USHORT
 
C≠abûôyInfo
,

2182 
IN
 
UCHAR
 
SupR©e
[],

2183 
IN
 
UCHAR
 
SupR©eLí
,

2184 
IN
 
UCHAR
 
ExtR©e
[],

2185 
IN
 
UCHAR
 
ExtR©eLí
,

2186 
IN
 
UCHAR
 
Ch™√l
,

2187 
IN
 
UCHAR
 
Rssi
,

2188 
IN
 
LARGE_INTEGER
 
TimeSèmp
,

2189 
IN
 
UCHAR
 
CkùFœg
,

2190 
IN
 
PEDCA_PARM
 
pEdˇP¨m
,

2191 
IN
 
PQOS_CAPABILITY_PARM
 
pQosC≠abûôy
,

2192 
IN
 
PQBSS_LOAD_PARM
 
pQbssLﬂd
,

2194 
IN
 
USHORT
 
LígthVIE
,

2195 
IN
 
PNDIS_802_11_VARIABLE_IEs
 
pVIE
);

2197 
ULONG
 
BssTabÀSëE¡ry
(

2198 
IN
 
PRTMP_ADAPTER
 
pAd
,

2199 
OUT
 
BSS_TABLE
 *
Tab
,

2200 
IN
 
PUCHAR
 
pBssid
,

2201 
IN
 
CHAR
 
Ssid
[],

2202 
IN
 
UCHAR
 
SsidLí
,

2203 
IN
 
UCHAR
 
BssTy≥
,

2204 
IN
 
USHORT
 
Bóc⁄Pîiod
,

2205 
IN
 
CF_PARM
 *
CfP¨m
,

2206 
IN
 
USHORT
 
AtimWö
,

2207 
IN
 
USHORT
 
C≠abûôyInfo
,

2208 
IN
 
UCHAR
 
SupR©e
[],

2209 
IN
 
UCHAR
 
SupR©eLí
,

2210 
IN
 
UCHAR
 
ExtR©e
[],

2211 
IN
 
UCHAR
 
ExtR©eLí
,

2212 
IN
 
UCHAR
 
Ch™√lNo
,

2213 
IN
 
UCHAR
 
Rssi
,

2214 
IN
 
LARGE_INTEGER
 
TimeSèmp
,

2215 
IN
 
UCHAR
 
CkùFœg
,

2216 
IN
 
PEDCA_PARM
 
pEdˇP¨m
,

2217 
IN
 
PQOS_CAPABILITY_PARM
 
pQosC≠abûôy
,

2218 
IN
 
PQBSS_LOAD_PARM
 
pQbssLﬂd
,

2220 
IN
 
USHORT
 
LígthVIE
,

2221 
IN
 
PNDIS_802_11_VARIABLE_IEs
 
pVIE
);

2223 
VOID
 
BssTabÀSsidS‹t
(

2224 
IN
 
PRTMP_ADAPTER
 
pAd
,

2225 
OUT
 
BSS_TABLE
 *
OutTab
,

2226 
IN
 
CHAR
 
Ssid
[],

2227 
IN
 
UCHAR
 
SsidLí
);

2229 
VOID
 
BssTabÀS‹tByRssi
(

2230 
IN
 
OUT
 
BSS_TABLE
 *
OutTab
);

2232 
VOID
 
BssCùhîP¨£
(

2233 
IN
 
OUT
 
PBSS_ENTRY
 
pBss
);

2235 
VOID
 
MacAddrR™domBssid
(

2236 
IN
 
PRTMP_ADAPTER
 
pAd
,

2237 
OUT
 
PUCHAR
 
pAddr
);

2239 
VOID
 
MgtMacHódîInô
(

2240 
IN
 
PRTMP_ADAPTER
 
pAd
,

2241 
IN
 
OUT
 
PHEADER_802_11
 
pHdr80211
,

2242 
IN
 
UCHAR
 
SubTy≥
,

2243 
IN
 
UCHAR
 
ToDs
,

2244 
IN
 
PUCHAR
 
pDA
,

2245 
IN
 
PUCHAR
 
pBssid
);

2247 
ULONG
 
MakeOutgoögFøme
(

2248 
OUT
 
CHAR
 *
Buf„r
,

2249 
OUT
 
ULONG
 *
FømeLí
, ...);

2251 
NDIS_STATUS
 
MlmeInô
(

2252 
IN
 
PRTMP_ADAPTER
 
pAd
);

2254 
VOID
 
MlmeH™dÀr
(

2255 
IN
 
PRTMP_ADAPTER
 
pAd
);

2257 
VOID
 
MlmeHÆt
(

2258 
IN
 
PRTMP_ADAPTER
 
pAd
) ;

2260 
VOID
 
MlmeSu•íd
(

2261 
IN
 
PRTMP_ADAPTER
 
pAd
,

2262 
IN
 
BOOLEAN
 
lökdown
);

2264 
VOID
 
MlmeResume
(

2265 
IN
 
PRTMP_ADAPTER
 
pAd
);

2267 
VOID
 
MlmePîiodicExec
(

2268 
IN
 
PVOID
 
Sy°emS≥cific1
,

2269 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

2270 
IN
 
PVOID
 
Sy°emS≥cific2
,

2271 
IN
 
PVOID
 
Sy°emS≥cific3
);

2273 
VOID
 
STAMlmePîiodicExec
(

2274 
IN
 
PRTMP_ADAPTER
 
pAd
);

2276 
VOID
 
LökDownExec
(

2277 
IN
 
PVOID
 
Sy°emS≥cific1
,

2278 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

2279 
IN
 
PVOID
 
Sy°emS≥cific2
,

2280 
IN
 
PVOID
 
Sy°emS≥cific3
);

2282 
VOID
 
MlmeAutoSˇn
(

2283 
IN
 
PRTMP_ADAPTER
 
pAd
);

2285 
VOID
 
MlmeAutoRecovîNëw‹k
(

2286 
IN
 
PRTMP_ADAPTER
 
pAd
);

2288 
VOID
 
MlmeAutoRec⁄√˘La°SSID
(

2289 
IN
 
PRTMP_ADAPTER
 
pAd
);

2291 
BOOLEAN
 
MlmeVÆid©eSSID
(

2292 
IN
 
PUCHAR
 
pSsid
,

2293 
IN
 
UCHAR
 
SsidLí
);

2295 
VOID
 
MlmeCheckF‹Rﬂmög
(

2296 
IN
 
PRTMP_ADAPTER
 
pAd
,

2297 
IN
 
ULONG
 
Now32
);

2299 
VOID
 
MlmeCheckF‹Fa°Rﬂmög
(

2300 
IN
 
PRTMP_ADAPTER
 
pAd
,

2301 
IN
 
ULONG
 
Now
);

2303 
VOID
 
MlmeCÆcuœãCh™√lQuÆôy
(

2304 
IN
 
PRTMP_ADAPTER
 
pAd
,

2305 
IN
 
ULONG
 
Now32
);

2307 
VOID
 
MlmeDy«micTxR©eSwôchög
(

2308 
IN
 
PRTMP_ADAPTER
 
pAd
);

2310 
VOID
 
MlmeCheckPsmCh™ge
(

2311 
IN
 
PRTMP_ADAPTER
 
pAd
,

2312 
IN
 
ULONG
 
Now32
);

2314 
VOID
 
MlmeSëPsmBô
(

2315 
IN
 
PRTMP_ADAPTER
 
pAd
,

2316 
IN
 
USHORT
 
psm
);

2318 
VOID
 
MlmeSëTxPªambÀ
(

2319 
IN
 
PRTMP_ADAPTER
 
pAd
,

2320 
IN
 
USHORT
 
TxPªambÀ
);

2322 
VOID
 
MlmeUpd©eTxR©es
(

2323 
IN
 
PRTMP_ADAPTER
 
pAd
,

2324 
IN
 
BOOLEAN
 
bLökUp
);

2326 
VOID
 
MlmeRadioOff
(

2327 
IN
 
PRTMP_ADAPTER
 
pAd
);

2329 
VOID
 
MlmeRadioOn
(

2330 
IN
 
PRTMP_ADAPTER
 
pAd
);

2332 
NDIS_STATUS
 
MlmeQueueInô
(

2333 
IN
 
MLME_QUEUE
 *
Queue
);

2335 
BOOLEAN
 
MlmeEnqueue
(

2336 
IN
 
PRTMP_ADAPTER
 
pAd
,

2337 
IN
 
ULONG
 
Machöe
,

2338 
IN
 
ULONG
 
MsgTy≥
,

2339 
IN
 
ULONG
 
MsgLí
,

2340 
IN
 
VOID
 *
Msg
);

2342 
BOOLEAN
 
MlmeEnqueueF‹Recv
(

2343 
IN
 
PRTMP_ADAPTER
 
pAd
,

2344 
IN
 
PFRAME_802_11
 
p80211Føme
,

2345 
IN
 
UCHAR
 
Rssi
,

2346 
IN
 
ULONG
 
MsgLí
,

2347 
IN
 
VOID
 *
Msg
,

2348 
IN
 
UCHAR
 
Sig«l
);

2350 
BOOLEAN
 
MlmeDequeue
(

2351 
IN
 
MLME_QUEUE
 *
Queue
,

2352 
OUT
 
MLME_QUEUE_ELEM
 **
EÀm
);

2354 
VOID
 
MlmeRe°¨tSèãMachöe
(

2355 
IN
 
PRTMP_ADAPTER
 
pAd
);

2357 
VOID
 
MlmePo°Re°¨tSèãMachöe
(

2358 
IN
 
PRTMP_ADAPTER
 
pAd
);

2360 
BOOLEAN
 
MlmeQueueEm±y
(

2361 
IN
 
MLME_QUEUE
 *
Queue
);

2363 
BOOLEAN
 
MlmeQueueFuŒ
(

2364 
IN
 
MLME_QUEUE
 *
Queue
);

2366 
VOID
 
MlmeQueueDe°roy
(

2367 
IN
 
MLME_QUEUE
 *
pQueue
);

2369 
BOOLEAN
 
MsgTy≥Sub°
(

2370 
IN
 
PRTMP_ADAPTER
 
pAd
,

2373 
IN
 
PFRAME_802_11
 
p80211hdr
,

2374 
IN
 
PUCHAR
 
pFøme
,

2376 
OUT
 
INT
 *
Machöe
,

2377 
OUT
 
INT
 *
MsgTy≥
);

2379 
VOID
 
SèãMachöeInô
(

2380 
IN
 
STATE_MACHINE
 *
S
,

2381 
IN
 
STATE_MACHINE_FUNC
 
Tøns
[],

2382 
IN
 
ULONG
 
StNr
,

2383 
IN
 
ULONG
 
MsgNr
,

2384 
IN
 
STATE_MACHINE_FUNC
 
DefFunc
,

2385 
IN
 
ULONG
 
InôSèã
,

2386 
IN
 
ULONG
 
Ba£
);

2388 
VOID
 
SèãMachöeSëA˘i⁄
(

2389 
IN
 
STATE_MACHINE
 *
S
,

2390 
IN
 
ULONG
 
St
,

2391 
IN
 
ULONG
 
Msg
,

2392 
IN
 
STATE_MACHINE_FUNC
 
Func
);

2394 
VOID
 
SèãMachöePîf‹mA˘i⁄
(

2395 
IN
 
PRTMP_ADAPTER
 
pAd
,

2396 
IN
 
STATE_MACHINE
 *
S
,

2397 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2399 
VOID
 
Dr›
(

2400 
IN
 
PRTMP_ADAPTER
 
pAd
,

2401 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2403 
VOID
 
Lf§Inô
(

2404 
IN
 
PRTMP_ADAPTER
 
pAd
,

2405 
IN
 
ULONG
 
Sìd
);

2407 
NDIS_STATUS
 
MlmeAŒoˇãMem‹y
(

2408 
IN
 
PRTMP_ADAPTER
 
pAd
,

2409 
OUT
 
PVOID
 *
AŒocVa
);

2411 
VOID
 
MlmeFªeMem‹y
(

2412 
IN
 
PRTMP_ADAPTER
 
pAd
,

2413 
IN
 
PVOID
 
AŒocVa
);

2415 
NDIS_STATUS
 
MlmeInôMem‹yH™dÀr
(

2416 
IN
 
PRTMP_ADAPTER
 
pAd
,

2417 
IN
 
UINT
 
Numbî
,

2418 
IN
 
UINT
 
Size
);

2420 
VOID
 
MlmeFªeMem‹yH™dÀr
(

2421 
IN
 
PRTMP_ADAPTER
 
pAd
);

2423 
VOID
 
Rad¨Dëe˘i⁄Sèπ
(

2424 
IN
 
PRTMP_ADAPTER
 
pAd
);

2426 
BOOLEAN
 
Rad¨Dëe˘i⁄St›
(

2427 
IN
 
PRTMP_ADAPTER
 
pAd
);

2429 
BOOLEAN
 
Rad¨Ch™√lCheck
(

2430 
IN
 
PRTMP_ADAPTER
 
pAd
,

2431 
IN
 
UCHAR
 
Ch
);

2435 
VOID
 
AssocSèãMachöeInô
(

2436 
IN
 
PRTMP_ADAPTER
 
pAd
,

2437 
IN
 
STATE_MACHINE
 *
S
,

2438 
OUT
 
STATE_MACHINE_FUNC
 
Tøns
[]);

2440 
VOID
 
AssocTimeout
(

2441 
IN
 
PVOID
 
Sy°emS≥cific1
,

2442 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

2443 
IN
 
PVOID
 
Sy°emS≥cific2
,

2444 
IN
 
PVOID
 
Sy°emS≥cific3
);

2446 
VOID
 
RóssocTimeout
(

2447 
IN
 
PVOID
 
Sy°emS≥cific1
,

2448 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

2449 
IN
 
PVOID
 
Sy°emS≥cific2
,

2450 
IN
 
PVOID
 
Sy°emS≥cific3
);

2452 
VOID
 
DißssocTimeout
(

2453 
IN
 
PVOID
 
Sy°emS≥cific1
,

2454 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

2455 
IN
 
PVOID
 
Sy°emS≥cific2
,

2456 
IN
 
PVOID
 
Sy°emS≥cific3
);

2458 
VOID
 
MlmeAssocReqA˘i⁄
(

2459 
IN
 
PRTMP_ADAPTER
 
pAd
,

2460 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2462 
VOID
 
MlmeRóssocReqA˘i⁄
(

2463 
IN
 
PRTMP_ADAPTER
 
pAd
,

2464 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2466 
VOID
 
MlmeDißssocReqA˘i⁄
(

2467 
IN
 
PRTMP_ADAPTER
 
pAd
,

2468 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2470 
VOID
 
PìrAssocR•A˘i⁄
(

2471 
IN
 
PRTMP_ADAPTER
 
pAd
,

2472 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2474 
VOID
 
PìrRóssocR•A˘i⁄
(

2475 
IN
 
PRTMP_ADAPTER
 
pAd
,

2476 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2478 
VOID
 
AssocPo°Proc
(

2479 
IN
 
PRTMP_ADAPTER
 
pAd
,

2480 
IN
 
PUCHAR
 
pAddr2
,

2481 
IN
 
USHORT
 
C≠abûôyInfo
,

2482 
IN
 
USHORT
 
Aid
,

2483 
IN
 
UCHAR
 
SupR©e
[],

2484 
IN
 
UCHAR
 
SupR©eLí
,

2485 
IN
 
UCHAR
 
ExtR©e
[],

2486 
IN
 
UCHAR
 
ExtR©eLí
,

2487 
IN
 
PEDCA_PARM
 
pEdˇP¨m
);

2489 
VOID
 
PìrDißssocA˘i⁄
(

2490 
IN
 
PRTMP_ADAPTER
 
pAd
,

2491 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2493 
VOID
 
AssocTimeoutA˘i⁄
(

2494 
IN
 
PRTMP_ADAPTER
 
pAd
,

2495 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2497 
VOID
 
RóssocTimeoutA˘i⁄
(

2498 
IN
 
PRTMP_ADAPTER
 
pAd
,

2499 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2501 
VOID
 
DißssocTimeoutA˘i⁄
(

2502 
IN
 
PRTMP_ADAPTER
 
pAd
,

2503 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2505 
VOID
 
InvÆidSèãWhíAssoc
(

2506 
IN
 
PRTMP_ADAPTER
 
pAd
,

2507 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2509 
VOID
 
InvÆidSèãWhíRóssoc
(

2510 
IN
 
PRTMP_ADAPTER
 
pAd
,

2511 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2513 
VOID
 
InvÆidSèãWhíDißssocüã
(

2514 
IN
 
PRTMP_ADAPTER
 
pAd
,

2515 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2517 
VOID
 
Cls3îrA˘i⁄
(

2518 
IN
 
PRTMP_ADAPTER
 
pAd
,

2519 
IN
 
PUCHAR
 
pAddr
);

2521 
VOID
 
AuthSèãMachöeInô
(

2522 
IN
 
PRTMP_ADAPTER
 
pAd
,

2523 
IN
 
PSTATE_MACHINE
 
Sm
,

2524 
OUT
 
STATE_MACHINE_FUNC
 
Tøns
[]);

2526 
VOID
 
AuthTimeout
(

2527 
IN
 
PVOID
 
Sy°emS≥cific1
,

2528 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

2529 
IN
 
PVOID
 
Sy°emS≥cific2
,

2530 
IN
 
PVOID
 
Sy°emS≥cific3
);

2532 
VOID
 
MlmeAuthReqA˘i⁄
(

2533 
IN
 
PRTMP_ADAPTER
 
pAd
,

2534 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2536 
VOID
 
PìrAuthR•AtSeq2A˘i⁄
(

2537 
IN
 
PRTMP_ADAPTER
 
pAd
,

2538 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2540 
VOID
 
PìrAuthR•AtSeq4A˘i⁄
(

2541 
IN
 
PRTMP_ADAPTER
 
pAd
,

2542 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2544 
VOID
 
AuthTimeoutA˘i⁄
(

2545 
IN
 
PRTMP_ADAPTER
 
pAd
,

2546 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2548 
VOID
 
Cls2îrA˘i⁄
(

2549 
IN
 
PRTMP_ADAPTER
 
pAd
,

2550 
IN
 
PUCHAR
 
pAddr
);

2552 
VOID
 
MlmeDóuthReqA˘i⁄
(

2553 
IN
 
PRTMP_ADAPTER
 
pAd
,

2554 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2556 
VOID
 
InvÆidSèãWhíAuth
(

2557 
IN
 
PRTMP_ADAPTER
 
pAd
,

2558 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2560 
VOID
 
AuthR•SèãMachöeInô
(

2561 
IN
 
PRTMP_ADAPTER
 
pAd
,

2562 
IN
 
PSTATE_MACHINE
 
Sm
,

2563 
IN
 
STATE_MACHINE_FUNC
 
Tøns
[]);

2565 
VOID
 
PìrAuthSim∂eR•GíAndSíd
(

2566 
IN
 
PRTMP_ADAPTER
 
pAd
,

2567 
IN
 
PHEADER_802_11
 
pHdr80211
,

2568 
IN
 
USHORT
 
Alg
,

2569 
IN
 
USHORT
 
Seq
,

2570 
IN
 
USHORT
 
Rós⁄
,

2571 
IN
 
USHORT
 
Sètus
);

2573 
VOID
 
PìrDóuthA˘i⁄
(

2574 
IN
 
PRTMP_ADAPTER
 
pAd
,

2575 
IN
 
PMLME_QUEUE_ELEM
 
EÀm
);

2577 
VOID
 
MlmeC¡lInô
(

2578 
IN
 
PRTMP_ADAPTER
 
pAd
,

2579 
IN
 
STATE_MACHINE
 *
S
,

2580 
OUT
 
STATE_MACHINE_FUNC
 
Tøns
[]);

2582 
VOID
 
MlmeC¡lMachöePîf‹mA˘i⁄
(

2583 
IN
 
PRTMP_ADAPTER
 
pAd
,

2584 
IN
 
STATE_MACHINE
 *
S
,

2585 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2587 
VOID
 
C¡lIdÀProc
(

2588 
IN
 
PRTMP_ADAPTER
 
pAd
,

2589 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2591 
VOID
 
C¡lOidSˇnProc
(

2592 
IN
 
PRTMP_ADAPTER
 
pAd
,

2593 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2595 
VOID
 
C¡lOidSsidProc
(

2596 
IN
 
PRTMP_ADAPTER
 
pAd
,

2597 
IN
 
MLME_QUEUE_ELEM
 * 
EÀm
);

2599 
VOID
 
C¡lOidRTBssidProc
(

2600 
IN
 
PRTMP_ADAPTER
 
pAd
,

2601 
IN
 
MLME_QUEUE_ELEM
 * 
EÀm
);

2603 
VOID
 
C¡lMlmeRﬂmögProc
(

2604 
IN
 
PRTMP_ADAPTER
 
pAd
,

2605 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2607 
VOID
 
C¡lWaôDißssocProc
(

2608 
IN
 
PRTMP_ADAPTER
 
pAd
,

2609 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2611 
VOID
 
C¡lWaôJoöProc
(

2612 
IN
 
PRTMP_ADAPTER
 
pAd
,

2613 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2615 
VOID
 
C¡lWaôSèπProc
(

2616 
IN
 
PRTMP_ADAPTER
 
pAd
,

2617 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2619 
VOID
 
C¡lWaôAuthProc
(

2620 
IN
 
PRTMP_ADAPTER
 
pAd
,

2621 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2623 
VOID
 
C¡lWaôAuthProc2
(

2624 
IN
 
PRTMP_ADAPTER
 
pAd
,

2625 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2627 
VOID
 
C¡lWaôAssocProc
(

2628 
IN
 
PRTMP_ADAPTER
 
pAd
,

2629 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2631 
VOID
 
C¡lWaôRóssocProc
(

2632 
IN
 
PRTMP_ADAPTER
 
pAd
,

2633 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2635 
VOID
 
LökUp
(

2636 
IN
 
PRTMP_ADAPTER
 
pAd
,

2637 
IN
 
UCHAR
 
BssTy≥
);

2639 
VOID
 
LökDown
(

2640 
IN
 
PRTMP_ADAPTER
 
pAd
,

2641 
IN
 
BOOLEAN
 
IsReqFromAP
);

2643 
VOID
 
IãøãOnBssTab
(

2644 
IN
 
PRTMP_ADAPTER
 
pAd
);

2646 
VOID
 
IãøãOnBssTab2
(

2647 
IN
 
PRTMP_ADAPTER
 
pAd
);

2649 
VOID
 
JoöP¨mFûl
(

2650 
IN
 
PRTMP_ADAPTER
 
pAd
,

2651 
IN
 
OUT
 
MLME_JOIN_REQ_STRUCT
 *
JoöReq
,

2652 
IN
 
ULONG
 
BssIdx
);

2654 
VOID
 
AssocP¨mFûl
(

2655 
IN
 
PRTMP_ADAPTER
 
pAd
,

2656 
IN
 
OUT
 
MLME_ASSOC_REQ_STRUCT
 *
AssocReq
,

2657 
IN
 
PUCHAR
 
pAddr
,

2658 
IN
 
USHORT
 
C≠abûôyInfo
,

2659 
IN
 
ULONG
 
Timeout
,

2660 
IN
 
USHORT
 
Li°íI¡v
);

2662 
VOID
 
SˇnP¨mFûl
(

2663 
IN
 
PRTMP_ADAPTER
 
pAd
,

2664 
IN
 
OUT
 
MLME_SCAN_REQ_STRUCT
 *
SˇnReq
,

2665 
IN
 
CHAR
 
Ssid
[],

2666 
IN
 
UCHAR
 
SsidLí
,

2667 
IN
 
UCHAR
 
BssTy≥
,

2668 
IN
 
UCHAR
 
SˇnTy≥
);

2670 
VOID
 
DißssocP¨mFûl
(

2671 
IN
 
PRTMP_ADAPTER
 
pAd
,

2672 
IN
 
OUT
 
MLME_DISASSOC_REQ_STRUCT
 *
DißssocReq
,

2673 
IN
 
PUCHAR
 
pAddr
,

2674 
IN
 
USHORT
 
Rós⁄
);

2676 
VOID
 
SèπP¨mFûl
(

2677 
IN
 
PRTMP_ADAPTER
 
pAd
,

2678 
IN
 
OUT
 
MLME_START_REQ_STRUCT
 *
SèπReq
,

2679 
IN
 
CHAR
 
Ssid
[],

2680 
IN
 
UCHAR
 
SsidLí
);

2682 
VOID
 
AuthP¨mFûl
(

2683 
IN
 
PRTMP_ADAPTER
 
pAd
,

2684 
IN
 
OUT
 
MLME_AUTH_REQ_STRUCT
 *
AuthReq
,

2685 
IN
 
PUCHAR
 
pAddr
,

2686 
IN
 
USHORT
 
Alg
);

2688 
VOID
 
Compo£PsPﬁl
(

2689 
IN
 
PRTMP_ADAPTER
 
pAd
);

2691 
VOID
 
Compo£NuŒFøme
(

2692 
IN
 
PRTMP_ADAPTER
 
pAd
);

2694 
ULONG
 
MakeIbssBóc⁄
(

2695 
IN
 
PRTMP_ADAPTER
 
pAd
);

2700 
VOID
 
SyncSèãMachöeInô
(

2701 
IN
 
PRTMP_ADAPTER
 
pAd
,

2702 
IN
 
STATE_MACHINE
 *
Sm
,

2703 
OUT
 
STATE_MACHINE_FUNC
 
Tøns
[]);

2705 
VOID
 
Bóc⁄Timeout
(

2706 
IN
 
PVOID
 
Sy°emS≥cific1
,

2707 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

2708 
IN
 
PVOID
 
Sy°emS≥cific2
,

2709 
IN
 
PVOID
 
Sy°emS≥cific3
);

2711 
VOID
 
SˇnTimeout
(

2712 
IN
 
PVOID
 
Sy°emS≥cific1
,

2713 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

2714 
IN
 
PVOID
 
Sy°emS≥cific2
,

2715 
IN
 
PVOID
 
Sy°emS≥cific3
);

2717 
VOID
 
MlmeSˇnReqA˘i⁄
(

2718 
IN
 
PRTMP_ADAPTER
 
pAd
,

2719 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2721 
VOID
 
MlmeJoöReqA˘i⁄
(

2722 
IN
 
PRTMP_ADAPTER
 
pAd
,

2723 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2725 
VOID
 
MlmeSèπReqA˘i⁄
(

2726 
IN
 
PRTMP_ADAPTER
 
pAd
,

2727 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2729 
VOID
 
PìrBóc⁄AtSˇnA˘i⁄
(

2730 
IN
 
PRTMP_ADAPTER
 
pAd
,

2731 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2733 
VOID
 
PìrBóc⁄AtJoöA˘i⁄
(

2734 
IN
 
PRTMP_ADAPTER
 
pAd
,

2735 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2737 
VOID
 
PìrBóc⁄
(

2738 
IN
 
PRTMP_ADAPTER
 
pAd
,

2739 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2741 
VOID
 
PìrProbeReqA˘i⁄
(

2742 
IN
 
PRTMP_ADAPTER
 
pAd
,

2743 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2745 
VOID
 
Bóc⁄TimeoutAtJoöA˘i⁄
(

2746 
IN
 
PRTMP_ADAPTER
 
pAd
,

2747 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2749 
VOID
 
SˇnTimeoutA˘i⁄
(

2750 
IN
 
PRTMP_ADAPTER
 
pAd
,

2751 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2753 
VOID
 
SˇnNextCh™√l
(

2754 
IN
 
PRTMP_ADAPTER
 
pAd
);

2756 
VOID
 
InvÆidSèãWhíSˇn
(

2757 
IN
 
PRTMP_ADAPTER
 
pAd
,

2758 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2760 
VOID
 
InvÆidSèãWhíJoö
(

2761 
IN
 
PRTMP_ADAPTER
 
pAd
,

2762 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2764 
VOID
 
InvÆidSèãWhíSèπ
(

2765 
IN
 
PRTMP_ADAPTER
 
pAd
,

2766 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

2768 
VOID
 
EnqueuePsPﬁl
(

2769 
IN
 
PRTMP_ADAPTER
 
pAd
);

2771 
VOID
 
EnqueueBóc⁄Føme
(

2772 
IN
 
PRTMP_ADAPTER
 
pAd
);

2774 
VOID
 
EnqueueProbeReque°
(

2775 
IN
 
PRTMP_ADAPTER
 
pAd
);

2777 
VOID
 
BuûdCh™√lLi°
(

2778 
IN
 
PRTMP_ADAPTER
 
pAd
);

2780 
UCHAR
 
NextCh™√l
(

2781 
IN
 
PRTMP_ADAPTER
 
pAd
,

2782 
IN
 
UCHAR
 
ch™√l
);

2784 
UCHAR
 
Fú°Ch™√l
(

2785 
IN
 
PRTMP_ADAPTER
 
pAd
);

2787 
CHAR
 
C⁄vîtToRssi
(

2788 
IN
 
PRTMP_ADAPTER
 
pAd
,

2789 
IN
 
UCHAR
 
Rssi
,

2790 
IN
 
UCHAR
 
RssiNumbî
);

2795 
BOOLEAN
 
MlmeSˇnReqS™ôy
(

2796 
IN
 
PRTMP_ADAPTER
 
pAd
,

2797 
IN
 
VOID
 *
Msg
,

2798 
IN
 
ULONG
 
MsgLí
,

2799 
OUT
 
UCHAR
 *
pBssTy≥
,

2800 
OUT
 
CHAR
 
Ssid
[],

2801 
OUT
 
UCHAR
 *
pSsidLí
,

2802 
OUT
 
UCHAR
 *
pSˇnTy≥
);

2804 
BOOLEAN
 
MlmeSèπReqS™ôy
(

2805 
IN
 
PRTMP_ADAPTER
 
pAd
,

2806 
IN
 
VOID
 *
Msg
,

2807 
IN
 
ULONG
 
MsgLí
,

2808 
OUT
 
CHAR
 
Ssid
[],

2809 
OUT
 
UCHAR
 *
pSsidLí
);

2811 
BOOLEAN
 
MlmeAssocReqS™ôy
(

2812 
IN
 
PRTMP_ADAPTER
 
pAd
,

2813 
IN
 
VOID
 *
Msg
,

2814 
IN
 
ULONG
 
MsgLí
,

2815 
OUT
 
PUCHAR
 
pApAddr
,

2816 
OUT
 
USHORT
 *
pC≠abûôyInfo
,

2817 
OUT
 
ULONG
 *
pTimeout
,

2818 
OUT
 
USHORT
 *
pLi°íI¡v
);

2820 
BOOLEAN
 
MlmeAuthReqS™ôy
(

2821 
IN
 
PRTMP_ADAPTER
 
pAd
,

2822 
IN
 
VOID
 *
Msg
,

2823 
IN
 
ULONG
 
MsgLí
,

2824 
OUT
 
PUCHAR
 
pAddr
,

2825 
OUT
 
ULONG
 *
pTimeout
,

2826 
OUT
 
USHORT
 *
pAlg
);

2828 
BOOLEAN
 
PìrAssocR•S™ôy
(

2829 
IN
 
PRTMP_ADAPTER
 
pAd
,

2830 
IN
 
VOID
 *
pMsg
,

2831 
IN
 
ULONG
 
MsgLí
,

2832 
OUT
 
PUCHAR
 
pAddr2
,

2833 
OUT
 
USHORT
 *
pC≠abûôyInfo
,

2834 
OUT
 
USHORT
 *
pSètus
,

2835 
OUT
 
USHORT
 *
pAid
,

2836 
OUT
 
UCHAR
 
SupR©e
[],

2837 
OUT
 
UCHAR
 *
pSupR©eLí
,

2838 
OUT
 
UCHAR
 
ExtR©e
[],

2839 
OUT
 
UCHAR
 *
pExtR©eLí
,

2840 
OUT
 
PEDCA_PARM
 
pEdˇP¨m
);

2842 
BOOLEAN
 
PìrDißssocS™ôy
(

2843 
IN
 
PRTMP_ADAPTER
 
pAd
,

2844 
IN
 
VOID
 *
Msg
,

2845 
IN
 
ULONG
 
MsgLí
,

2846 
OUT
 
PUCHAR
 
pAddr2
,

2847 
OUT
 
USHORT
 *
pRós⁄
);

2849 
BOOLEAN
 
PìrDóuthS™ôy
(

2850 
IN
 
PRTMP_ADAPTER
 
pAd
,

2851 
IN
 
VOID
 *
Msg
,

2852 
IN
 
ULONG
 
MsgLí
,

2853 
OUT
 
PUCHAR
 
pAddr2
,

2854 
OUT
 
USHORT
 *
pRós⁄
);

2856 
NTSTATUS
 
RTUSBSögÀWrôe
(

2857 
IN
 
PRTMP_ADAPTER
 
pAd
,

2858 
IN
 
USHORT
 
Off£t
,

2859 
IN
 
USHORT
 
VÆue
);

2861 
BOOLEAN
 
PìrAuthS™ôy
(

2862 
IN
 
PRTMP_ADAPTER
 
pAd
,

2863 
IN
 
VOID
 *
Msg
,

2864 
IN
 
ULONG
 
MsgLí
,

2865 
OUT
 
PUCHAR
 
pAddr
,

2866 
OUT
 
USHORT
 *
pAlg
,

2867 
OUT
 
USHORT
 *
pSeq
,

2868 
OUT
 
USHORT
 *
pSètus
,

2869 
CHAR
 *
pChlgText
);

2871 
BOOLEAN
 
PìrProbeReqS™ôy
(

2872 
IN
 
PRTMP_ADAPTER
 
pAd
,

2873 
IN
 
VOID
 *
Msg
,

2874 
IN
 
ULONG
 
MsgLí
,

2875 
OUT
 
PUCHAR
 
pAddr2
,

2876 
OUT
 
CHAR
 
Ssid
[],

2877 
OUT
 
UCHAR
 *
pSsidLí
);

2879 
BOOLEAN
 
PìrBóc⁄AndProbeR•S™ôy
(

2880 
IN
 
PRTMP_ADAPTER
 
pAd
,

2881 
IN
 
VOID
 *
Msg
,

2882 
IN
 
ULONG
 
MsgLí
,

2883 
OUT
 
PUCHAR
 
pAddr2
,

2884 
OUT
 
PUCHAR
 
pBssid
,

2885 
OUT
 
CHAR
 
Ssid
[],

2886 
OUT
 
UCHAR
 *
pSsidLí
,

2887 
OUT
 
UCHAR
 *
pBssTy≥
,

2888 
OUT
 
USHORT
 *
pBóc⁄Pîiod
,

2889 
OUT
 
UCHAR
 *
pCh™√l
,

2890 
OUT
 
UCHAR
 *
pNewCh™√l
,

2891 
OUT
 
LARGE_INTEGER
 *
pTime°amp
,

2892 
OUT
 
CF_PARM
 *
pCfP¨m
,

2893 
OUT
 
USHORT
 *
pAtimWö
,

2894 
OUT
 
USHORT
 *
pC≠abûôyInfo
,

2895 
OUT
 
UCHAR
 *
pEΩ
,

2896 
OUT
 
UCHAR
 *
pDtimCou¡
,

2897 
OUT
 
UCHAR
 *
pDtimPîiod
,

2898 
OUT
 
UCHAR
 *
pBˇ°Fœg
,

2899 
OUT
 
UCHAR
 *
pMesßgeToMe
,

2900 
OUT
 
UCHAR
 
SupR©e
[],

2901 
OUT
 
UCHAR
 *
pSupR©eLí
,

2902 
OUT
 
UCHAR
 
ExtR©e
[],

2903 
OUT
 
UCHAR
 *
pExtR©eLí
,

2904 
OUT
 
UCHAR
 *
pCkùFœg
,

2905 
OUT
 
UCHAR
 *
pAú⁄ëCñlPowîLimô
,

2906 
OUT
 
PEDCA_PARM
 
pEdˇP¨m
,

2907 
OUT
 
PQBSS_LOAD_PARM
 
pQbssLﬂd
,

2908 
OUT
 
PQOS_CAPABILITY_PARM
 
pQosC≠abûôy
,

2909 
OUT
 
ULONG
 *
pRÆökIe
,

2911 
OUT
 
USHORT
 *
LígthVIE
,

2912 
OUT
 
PNDIS_802_11_VARIABLE_IEs
 
pVIE
);

2914 
BOOLEAN
 
GëTimBô
(

2915 
IN
 
CHAR
 *
På
,

2916 
IN
 
USHORT
 
Aid
,

2917 
OUT
 
UCHAR
 *
TimLí
,

2918 
OUT
 
UCHAR
 *
Bˇ°Fœg
,

2919 
OUT
 
UCHAR
 *
DtimCou¡
,

2920 
OUT
 
UCHAR
 *
DtimPîiod
,

2921 
OUT
 
UCHAR
 *
MesßgeToMe
);

2923 
UCHAR
 
Ch™√lS™ôy
(

2924 
IN
 
PRTMP_ADAPTER
 
pAd
,

2925 
IN
 
UCHAR
 
ch™√l
);

2927 
NDIS_802_11_NETWORK_TYPE
 
Nëw‹kTy≥InU£S™ôy
(

2928 
IN
 
UCHAR
 
Ch™√l
,

2929 
IN
 
UCHAR
 
SupR©e
[],

2930 
IN
 
UCHAR
 
SupR©eLí
,

2931 
IN
 
UCHAR
 
ExtR©e
[],

2932 
IN
 
UCHAR
 
ExtR©eLí
);

2934 
UCHAR
 
PìrTxTy≥InU£S™ôy
(

2935 
IN
 
UCHAR
 
Ch™√l
,

2936 
IN
 
UCHAR
 
SupR©e
[],

2937 
IN
 
UCHAR
 
SupR©eLí
,

2938 
IN
 
UCHAR
 
ExtR©e
[],

2939 
IN
 
UCHAR
 
ExtR©eLí
);

2941 
NDIS_STATUS
 
RTMPWPAWïKeyS™ôy
(

2942 
IN
 
PRTMP_ADAPTER
 
pAd
,

2943 
IN
 
PVOID
 
pBuf
);

2945 
NDIS_STATUS
 
RTMPRemoveKeyS™ôy
(

2946 
IN
 
PRTMP_ADAPTER
 
pAd
,

2947 
IN
 
PVOID
 
pBuf
);

2953 
VOID
 
RTUSBBulkOutD©aPackë
(

2954 
IN
 
PRTMP_ADAPTER
 
pAd
,

2955 
IN
 
UCHAR
 
BulkOutPùeId
,

2956 
IN
 
UCHAR
 
Index
);

2958 
VOID
 
RTUSBBulkOutNuŒFøme
(

2959 
IN
 
PRTMP_ADAPTER
 
pAd
);

2961 
VOID
 
RTUSBBulkOutRTSFøme
(

2962 
IN
 
PRTMP_ADAPTER
 
pAd
);

2964 
VOID
 
RTUSBBulkOutMLMEPackë
(

2965 
IN
 
PRTMP_ADAPTER
 
pAd
,

2966 
IN
 
UCHAR
 
Index
);

2968 
VOID
 
RTUSBBulkOutPsPﬁl
(

2969 
IN
 
PRTMP_ADAPTER
 
pAd
);

2971 
VOID
 
RTUSBBulkRe˚ive
(

2972 
IN
 
PRTMP_ADAPTER
 
pAd
);

2974 
VOID
 
RTUSBBulkRxH™dÀ
(

2975 
IN
 
d©a
);

2977 
VOID
 
RTUSBKickBulkOut
(

2978 
IN
 
PRTMP_ADAPTER
 
pAd
);

2980 
VOID
 
RTUSBCÀ™UpD©aBulkOutQueue
(

2981 
IN
 
PRTMP_ADAPTER
 
pAd
);

2983 
VOID
 
RTUSBCÀ™UpMLMEBulkOutQueue
(

2984 
IN
 
PRTMP_ADAPTER
 
pAd
);

2986 
VOID
 
RTUSBC™˚lPídögIRPs
(

2987 
IN
 
PRTMP_ADAPTER
 
pAd
);

2989 
VOID
 
RTUSBC™˚lPídögBulkOutIRP
(

2990 
IN
 
PRTMP_ADAPTER
 
pAd
);

2992 
VOID
 
RTUSBC™˚lPídögBulkInIRP
(

2993 
IN
 
PRTMP_ADAPTER
 
pAd
);

2997 #i‡
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,5,0)

2998 
	#RTUSBBulkOutD©aPackëCom∂ëe
(
purb
, 
±_ªgs
Ë
	`RTUSBBulkOutD©aPackëCom∂ëe
’urb)

	)

2999 
	#RTUSBBulkOutNuŒFømeCom∂ëe
(
pUrb
, 
±_ªgs
Ë
	`RTUSBBulkOutNuŒFømeCom∂ëe
’Urb)

	)

3000 
	#RTUSBBulkOutRTSFømeCom∂ëe
(
pUrb
, 
±_ªgs
Ë
	`RTUSBBulkOutRTSFømeCom∂ëe
’Urb)

	)

3001 
	#RTUSBBulkOutMLMEPackëCom∂ëe
(
pUrb
, 
±_ªgs
Ë
	`RTUSBBulkOutMLMEPackëCom∂ëe
’Urb)

	)

3002 
	#RTUSBBulkOutPsPﬁlCom∂ëe
(
pUrb
, 
±_ªgs
Ë
	`RTUSBBulkOutPsPﬁlCom∂ëe
’Urb)

	)

3003 
	#RTUSBBulkRxCom∂ëe
(
pUrb
, 
±_ªgs
Ë
	`RTUSBBulkRxCom∂ëe
’Urb)

	)

3005 
VOID
 
RTUSBBulkOutD©aPackëCom∂ëe
(
purbb_t
 
purb
, 
±_ªgs
 *pt_regs);

3006 
VOID
 
RTUSBBulkOutNuŒFømeCom∂ëe
(
purbb_t
 
pUrb
, 
±_ªgs
 *pt_regs);

3007 
VOID
 
RTUSBBulkOutRTSFømeCom∂ëe
(
purbb_t
 
pUrb
, 
±_ªgs
 *pt_regs);

3008 
VOID
 
RTUSBBulkOutMLMEPackëCom∂ëe
(
purbb_t
 
pUrb
, 
±_ªgs
 *pt_regs);

3009 
VOID
 
RTUSBBulkOutPsPﬁlCom∂ëe
(
purbb_t
 
pUrb
, 
±_ªgs
 *pt_regs);

3010 
VOID
 
RTUSBBulkRxCom∂ëe
(
purbb_t
 
pUrb
, 
±_ªgs
 *pt_regs);

3011 
dump_urb
(
urb
* 
purb
);

3016 
NTSTATUS
 
RTUSBFúmw¨eRun
(

3017 
IN
 
PRTMP_ADAPTER
 
pAd
);

3019 
NTSTATUS
 
RTUSBMu…iRód
(

3020 
IN
 
PRTMP_ADAPTER
 
pAd
,

3021 
IN
 
USHORT
 
Off£t
,

3022 
OUT
 
PUCHAR
 
pD©a
,

3023 
IN
 
USHORT
 
Àngth
);

3025 
NTSTATUS
 
RTUSBMu…iWrôe
(

3026 
IN
 
PRTMP_ADAPTER
 
pAd
,

3027 
IN
 
USHORT
 
Off£t
,

3028 
IN
 
PUCHAR
 
pD©a
,

3029 
IN
 
USHORT
 
Àngth
);

3031 
NTSTATUS
 
RTUSBRódMACRegi°î
(

3032 
IN
 
PRTMP_ADAPTER
 
pAd
,

3033 
IN
 
USHORT
 
Off£t
,

3034 
OUT
 
PULONG
 
pVÆue
);

3036 
NTSTATUS
 
RTUSBWrôeMACRegi°î
(

3037 
IN
 
PRTMP_ADAPTER
 
pAd
,

3038 
IN
 
USHORT
 
Off£t
,

3039 
IN
 
ULONG
 
VÆue
);

3041 
NTSTATUS
 
RTUSBSëLED
(

3042 
IN
 
PRTMP_ADAPTER
 
pAd
,

3043 
IN
 
MCU_LEDCS_STRUC
 
LedSètus
,

3044 
IN
 
USHORT
 
LedIndiˇt‹Såígth
);

3046 
NTSTATUS
 
RTUSBRódBBPRegi°î
(

3047 
IN
 
PRTMP_ADAPTER
 
pAd
,

3048 
IN
 
UCHAR
 
Id
,

3049 
IN
 
PUCHAR
 
pVÆue
);

3051 
NTSTATUS
 
RTUSBWrôeBBPRegi°î
(

3052 
IN
 
PRTMP_ADAPTER
 
pAd
,

3053 
IN
 
UCHAR
 
Id
,

3054 
IN
 
UCHAR
 
VÆue
);

3056 
NTSTATUS
 
RTUSBWrôeRFRegi°î
(

3057 
IN
 
PRTMP_ADAPTER
 
pAd
,

3058 
IN
 
ULONG
 
VÆue
);

3060 
NTSTATUS
 
RTUSBRódEEPROM
(

3061 
IN
 
PRTMP_ADAPTER
 
pAd
,

3062 
IN
 
USHORT
 
Off£t
,

3063 
OUT
 
PUCHAR
 
pD©a
,

3064 
IN
 
USHORT
 
Àngth
);

3066 
NTSTATUS
 
RTUSBWrôeEEPROM
(

3067 
IN
 
PRTMP_ADAPTER
 
pAd
,

3068 
IN
 
USHORT
 
Off£t
,

3069 
IN
 
PUCHAR
 
pD©a
,

3070 
IN
 
USHORT
 
Àngth
);

3072 
NTSTATUS
 
RTUSBPutToSÀï
(

3073 
IN
 
PRTMP_ADAPTER
 
pAd
);

3075 
NTSTATUS
 
RTUSBWakeUp
(

3076 
IN
 
PRTMP_ADAPTER
 
pAd
);

3078 
VOID
 
RTUSBInôülizeCmdQ
(

3079 
IN
 
PCmdQ
 
cmdq
);

3081 
NDIS_STATUS
 
RTUSBEnqueueCmdFromNdis
(

3082 
IN
 
PRTMP_ADAPTER
 
pAd
,

3083 
IN
 
NDIS_OID
 
Oid
,

3084 
IN
 
BOOLEAN
 
SëInf‹m©i⁄
,

3085 
IN
 
PVOID
 
pInf‹m©i⁄Buf„r
,

3086 
IN
 
ULONG
 
Inf‹m©i⁄Buf„rLígth
);

3088 
VOID
 
RTUSBEnqueueI¡î«lCmd
(

3089 
IN
 
PRTMP_ADAPTER
 
pAd
,

3090 
IN
 
NDIS_OID
 
Oid
);

3092 
VOID
 
RTUSBDequeueCmd
(

3093 
IN
 
PCmdQ
 
cmdq
,

3094 
OUT
 
PCmdQElmt
 *
pcmdqñmt
);

3096 
INT
 
RTUSB_Víd‹Reque°
(

3097 
IN
 
PRTMP_ADAPTER
 
pAd
,

3098 
IN
 
ULONG
 
Tøns„rFœgs
,

3099 
IN
 
UCHAR
 
Reque°Ty≥
,

3100 
IN
 
UCHAR
 
Reque°
,

3101 
IN
 
USHORT
 
VÆue
,

3102 
IN
 
USHORT
 
Index
,

3103 
IN
 
PVOID
 
Tøns„rBuf„r
,

3104 
IN
 
ULONG
 
Tøns„rBuf„rLígth
);

3106 
NTSTATUS
 
RTUSB_Re£tDevi˚
(

3107 
IN
 
PRTMP_ADAPTER
 
pAd
);

3108 #ifde‡
DBG


3109 
NDIS_STATUS
 
RTUSBQuîyH¨dW¨eRegi°î
(

3110 
IN
 
PRTMP_ADAPTER
 
pAd
,

3111 
IN
 
PVOID
 
pBuf
);

3113 
NDIS_STATUS
 
RTUSBSëH¨dW¨eRegi°î
(

3114 
IN
 
PRTMP_ADAPTER
 
pAd
,

3115 
IN
 
PVOID
 
pBuf
);

3121 
NDIS_STATUS
 
Sniff2ByãsFromNdisBuf„r
(

3122 
IN
 
sk_buff
 *
pFú°Skb
,

3123 
IN
 
UCHAR
 
DesúedOff£t
,

3124 
OUT
 
PUCHAR
 
pByã0
,

3125 
OUT
 
PUCHAR
 
pByã1
);

3127 
NDIS_STATUS
 
RTMPSídPackë
(

3128 
IN
 
PRTMP_ADAPTER
 
pAd
,

3129 
IN
 
sk_buff
 *
pSkb
);

3131 
INT
 
RTMPSídPackës
(

3132 
IN
 
sk_buff
 *
pSkb
,

3133 
IN
 
√t_devi˚
 *
√t_dev
);

3135 #ifde‡
BIG_ENDIAN


3136 
	gölöe


3138 
NDIS_STATUS
 
RTUSBH¨dTønsmô
(

3139 
IN
 
PRTMP_ADAPTER
 
pAd
,

3140 
IN
 
sk_buff
 *
pSkb
,

3141 
IN
 
UCHAR
 
NumbîRequúed
,

3142 
IN
 
UCHAR
 
QueIdx
);

3144 
VOID
 
RTUSBMlmeH¨dTønsmô
(

3145 
IN
 
PRTMP_ADAPTER
 
pAd
,

3146 
IN
 
PMGMT_STRUC
 
pMgmt
);

3148 
NDIS_STATUS
 
RTUSBFªeDes¸ùt‹Reque°
(

3149 
IN
 
PRTMP_ADAPTER
 
pAd
,

3150 
IN
 
UCHAR
 
RögTy≥
,

3151 
IN
 
UCHAR
 
BulkOutPùeId
,

3152 
IN
 
UCHAR
 
NumbîRequúed
);

3154 
VOID
 
RTUSBReje˘PídögPackës
(

3155 
IN
 
PRTMP_ADAPTER
 
pAd
);

3157 
VOID
 
RTUSBWrôeTxDes¸ùt‹
(

3158 
IN
 
PRTMP_ADAPTER
 
pAd
,

3159 
IN
 
PTXD_STRUC
 
pSour˚TxD
,

3160 
IN
 
UCHAR
 
CùhîAlg
,

3161 
IN
 
UCHAR
 
KeyTabÀ
,

3162 
IN
 
UCHAR
 
KeyIdx
,

3163 
IN
 
BOOLEAN
 
Ack
,

3164 
IN
 
BOOLEAN
 
Føgmít
,

3165 
IN
 
BOOLEAN
 
InsTime°amp
,

3166 
IN
 
UCHAR
 
RëryMode
,

3167 
IN
 
UCHAR
 
Ifs
,

3168 
IN
 
UINT
 
R©e
,

3169 
IN
 
ULONG
 
Lígth
,

3170 
IN
 
UCHAR
 
QueIdx
,

3171 
IN
 
UCHAR
 
PID
,

3172 
IN
 
BOOLEAN
 
bA·îRTSCTS
);

3174 
VOID
 
RTMPDeQueuePackë
(

3175 
IN
 
PRTMP_ADAPTER
 
pAd
,

3176 
IN
 
UCHAR
 
BulkOutPùeId
);

3178 
VOID
 
RTUSBRxPackë
(

3179 
IN
 
d©a
);

3181 
VOID
 
RTUSBDequeueMLMEPackë
(

3182 
IN
 
PRTMP_ADAPTER
 
pAd
);

3184 
VOID
 
RTUSBCÀ™UpMLMEWaôQueue
(

3185 
IN
 
PRTMP_ADAPTER
 
pAd
);

3187 
VOID
 
RTUSBSu•ídMsduTønsmissi⁄
(

3188 
IN
 
PRTMP_ADAPTER
 
pAd
);

3190 
VOID
 
RTUSBResumeMsduTønsmissi⁄
(

3191 
IN
 
PRTMP_ADAPTER
 
pAd
);

3193 
VOID
 
Möù‹tMMReque°
(

3194 
IN
 
PRTMP_ADAPTER
 
pAd
,

3195 
IN
 
UCHAR
 
QueIdx
,

3196 
IN
 
PVOID
 
pBuf„r
,

3197 
IN
 
ULONG
 
Lígth
);

3199 
BOOLEAN
 
RTMPSórchTu∂eCache
(

3200 
IN
 
PRTMP_ADAPTER
 
pAd
,

3201 
IN
 
PHEADER_802_11
 
pHódî
);

3203 
VOID
 
RTMPUpd©eTu∂eCache
(

3204 
IN
 
PRTMP_ADAPTER
 
pAd
,

3205 
IN
 
PHEADER_802_11
 
pHódî
);

3207 
NDIS_STATUS
 
RTMPAµlyPackëFûãr
(

3208 
IN
 
PRTMP_ADAPTER
 
pAd
,

3209 
IN
 
PRXD_STRUC
 
pRxD
,

3210 
IN
 
PHEADER_802_11
 
pHódî
);

3212 
NDIS_STATUS
 
RTMPCheckRxDes¸ùt‹
(

3213 
IN
 
PRTMP_ADAPTER
 
pAd
,

3214 
IN
 
PHEADER_802_11
 
pHódî
,

3215 
IN
 
PRXD_STRUC
 
pRxD
);

3217 
VOID
 
RTMPRï‹tMicEº‹
(

3218 
IN
 
PRTMP_ADAPTER
 
pAd
,

3219 
IN
 
PCIPHER_KEY
 
pW∑Key
);

3221 
VOID
 
RTMPSídNuŒFøme
(

3222 
IN
 
PRTMP_ADAPTER
 
pAd
,

3223 
IN
 
UCHAR
 
TxR©e
);

3225 
VOID
 
RTMPSídRTSCTSFøme
(

3226 
IN
 
PRTMP_ADAPTER
 
pAd
,

3227 
IN
 
PUCHAR
 
pDA
,

3228 
IN
 
ULONG
 
NextMpduSize
,

3229 
IN
 
UCHAR
 
TxR©e
,

3230 
IN
 
UCHAR
 
RTSR©e
,

3231 
IN
 
USHORT
 
AckDuøti⁄
,

3232 
IN
 
UCHAR
 
QueIdx
,

3233 
IN
 
UCHAR
 
FømeG≠
,

3234 
IN
 
UCHAR
 
Ty≥
);

3236 
USHORT
 
RTMPCÆcDuøti⁄
(

3237 
IN
 
PRTMP_ADAPTER
 
pAd
,

3238 
IN
 
UCHAR
 
R©e
,

3239 
IN
 
ULONG
 
Size
);

3241 
BOOLEAN
 
RTMPCheckDHCPFøme
(

3242 
IN
 
PRTMP_ADAPTER
 
pAd
,

3243 
IN
 
sk_buff
 *
pSkb
);

3249 
VOID
 
RTMPInôWïEngöe
(

3250 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3251 
IN
 
PUCHAR
 
pKey
,

3252 
IN
 
UCHAR
 
KeyId
,

3253 
IN
 
UCHAR
 
KeyLí
,

3254 
IN
 
OUT
 
PUCHAR
 
pDe°
);

3256 
VOID
 
RTMPEn¸y±D©a
(

3257 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3258 
IN
 
PUCHAR
 
pSrc
,

3259 
IN
 
PUCHAR
 
pDe°
,

3260 
IN
 
UINT
 
Lí
);

3262 
BOOLEAN
 
RTMPDe¸y±D©a
(

3263 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3264 
IN
 
PUCHAR
 
pSrc
,

3265 
IN
 
UINT
 
Lí
);

3267 
VOID
 
ARCFOUR_INIT
(

3268 
IN
 
PARCFOURCONTEXT
 
Ctx
,

3269 
IN
 
PUCHAR
 
pKey
,

3270 
IN
 
UINT
 
KeyLí
);

3272 
UCHAR
 
ARCFOUR_BYTE
(

3273 
IN
 
PARCFOURCONTEXT
 
Ctx
);

3275 
VOID
 
ARCFOUR_DECRYPT
(

3276 
IN
 
PARCFOURCONTEXT
 
Ctx
,

3277 
IN
 
PUCHAR
 
pDe°
,

3278 
IN
 
PUCHAR
 
pSrc
,

3279 
IN
 
UINT
 
Lí
);

3281 
VOID
 
ARCFOUR_ENCRYPT
(

3282 
IN
 
PARCFOURCONTEXT
 
Ctx
,

3283 
IN
 
PUCHAR
 
pDe°
,

3284 
IN
 
PUCHAR
 
pSrc
,

3285 
IN
 
UINT
 
Lí
);

3287 
ULONG
 
RTMP_CALC_FCS32
(

3288 
IN
 
ULONG
 
Fcs
,

3289 
IN
 
PUCHAR
 
Cp
,

3290 
IN
 
INT
 
Lí
);

3292 
VOID
 
RTMPSëICV
(

3293 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3294 
IN
 
PUCHAR
 
pDe°
);

3299 
VOID
 
RTMPInôTkùEngöe
(

3300 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3301 
IN
 
PUCHAR
 
pTKey
,

3302 
IN
 
UCHAR
 
KeyId
,

3303 
IN
 
PUCHAR
 
pTA
,

3304 
IN
 
PUCHAR
 
pMICKey
,

3305 
IN
 
PUCHAR
 
pTSC
,

3306 
OUT
 
PULONG
 
pIV16
,

3307 
OUT
 
PULONG
 
pIV32
);

3309 
VOID
 
RTMPInôMICEngöe
(

3310 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3311 
IN
 
PUCHAR
 
pKey
,

3312 
IN
 
PUCHAR
 
pDA
,

3313 
IN
 
PUCHAR
 
pSA
,

3314 
IN
 
UCHAR
 
U£rPri‹ôy
,

3315 
IN
 
PUCHAR
 
pMICKey
);

3317 
BOOLEAN
 
RTMPTkùCom∑ªMICVÆue
(

3318 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3319 
IN
 
PUCHAR
 
pSrc
,

3320 
IN
 
PUCHAR
 
pDA
,

3321 
IN
 
PUCHAR
 
pSA
,

3322 
IN
 
PUCHAR
 
pMICKey
,

3323 
IN
 
UINT
 
Lí
);

3325 
VOID
 
RTMPCÆcuœãMICVÆue
(

3326 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3327 
IN
 
sk_buff
 *
pSkb
,

3328 
IN
 
PUCHAR
 
pEnˇp
,

3329 
IN
 
PCIPHER_KEY
 
pKey
);

3331 
BOOLEAN
 
RTMPSo·De¸y±TKIP
(

3332 
IN
 
PRTMP_ADAPTER
 
pAd
,

3333 
IN
 
PUCHAR
 
pD©a
,

3334 
IN
 
ULONG
 
D©aByãC¡
,

3335 
IN
 
UCHAR
 
U£rPri‹ôy
,

3336 
IN
 
PCIPHER_KEY
 
pW∑Key
);

3338 
BOOLEAN
 
RTMPSo·De¸y±AES
(

3339 
IN
 
PRTMP_ADAPTER
 
pAd
,

3340 
IN
 
PUCHAR
 
pD©a
,

3341 
IN
 
ULONG
 
D©aByãC¡
,

3342 
IN
 
PCIPHER_KEY
 
pW∑Key
);

3344 
BOOLEAN
 
RTMPTkùCom∑ªMICVÆueWôhLLC
(

3345 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3346 
IN
 
PUCHAR
 
pLLC
,

3347 
IN
 
PUCHAR
 
pSrc
,

3348 
IN
 
PUCHAR
 
pDA
,

3349 
IN
 
PUCHAR
 
pSA
,

3350 
IN
 
PUCHAR
 
pMICKey
,

3351 
IN
 
UINT
 
Lí
);

3353 
VOID
 
RTMPTkùAµíd
(

3354 
IN
 
PTKIP_KEY_INFO
 
pTkù
,

3355 
IN
 
PUCHAR
 
pSrc
,

3356 
IN
 
UINT
 
nByãs
);

3358 
VOID
 
RTMPTkùGëMIC
(

3359 
IN
 
PTKIP_KEY_INFO
 
pTkù
);

3364 
BOOLEAN
 
W∑MsgTy≥Sub°
(

3365 
IN
 
UCHAR
 
EAPTy≥
,

3366 
OUT
 
ULONG
 *
MsgTy≥
);

3368 
VOID
 
W∑PskSèãMachöeInô
(

3369 
IN
 
PRTMP_ADAPTER
 
pAd
,

3370 
IN
 
STATE_MACHINE
 *
S
,

3371 
OUT
 
STATE_MACHINE_FUNC
 
Tøns
[]);

3373 
VOID
 
W∑EAPOLKeyA˘i⁄
(

3374 
IN
 
PRTMP_ADAPTER
 
pAd
,

3375 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

3377 
VOID
 
W∑PaúMsg1A˘i⁄
(

3378 
IN
 
PRTMP_ADAPTER
 
pAd
,

3379 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

3381 
VOID
 
W∑PaúMsg3A˘i⁄
(

3382 
IN
 
PRTMP_ADAPTER
 
pAd
,

3383 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

3385 
VOID
 
W∑GroupMsg1A˘i⁄
(

3386 
IN
 
PRTMP_ADAPTER
 
pAd
,

3387 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

3389 
VOID
 
W∑MacHódîInô
(

3390 
IN
 
PRTMP_ADAPTER
 
pAd
,

3391 
IN
 
OUT
 
PHEADER_802_11
 
pHdr80211
,

3392 
IN
 
UCHAR
 
wï
,

3393 
IN
 
PUCHAR
 
pAddr1
);

3395 
VOID
 
W∑2PaúMsg1A˘i⁄
(

3396 
IN
 
PRTMP_ADAPTER
 
pAd
,

3397 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

3399 
VOID
 
W∑2PaúMsg3A˘i⁄
(

3400 
IN
 
PRTMP_ADAPTER
 
pAd
,

3401 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

3403 
VOID
 
P¨£KeyD©a
(

3404 
IN
 
PRTMP_ADAPTER
 
pAd
,

3405 
IN
 
PUCHAR
 
pKeyD©a
,

3406 
IN
 
UCHAR
 
KeyD©aLí
,

3407 
IN
 
UCHAR
 
KeyIdx
,

3408 
IN
 
BOOLEAN
 
IsGroupMsg
);

3410 
VOID
 
WPAMake8023Hdr
(

3411 
IN
 
PRTMP_ADAPTER
 
pAd
,

3412 
IN
 
PCHAR
 
pDAddr
,

3413 
IN
 
OUT
 
PCHAR
 
pHdr
);

3415 
VOID
 
RTMPToWúñessSè
(

3416 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3417 
IN
 
PUCHAR
 
pFøme
,

3418 
IN
 
UINT
 
FømeLí
);

3420 
VOID
 
HMAC_SHA1
(

3421 
IN
 
UCHAR
 *
ãxt
,

3422 
IN
 
UINT
 
ãxt_Àn
,

3423 
IN
 
UCHAR
 *
key
,

3424 
IN
 
UINT
 
key_Àn
,

3425 
IN
 
UCHAR
 *
dige°
);

3427 
VOID
 
PRF
(

3428 
IN
 
UCHAR
 *
key
,

3429 
IN
 
INT
 
key_Àn
,

3430 
IN
 
UCHAR
 *
¥efix
,

3431 
IN
 
INT
 
¥efix_Àn
,

3432 
IN
 
UCHAR
 *
d©a
,

3433 
IN
 
INT
 
d©a_Àn
,

3434 
OUT
 
UCHAR
 *
ouçut
,

3435 
IN
 
INT
 
Àn
);

3437 
VOID
 
W∑Cou¡PTK
(

3438 
IN
 
UCHAR
 *
PMK
,

3439 
IN
 
UCHAR
 *
AN⁄˚
,

3440 
IN
 
UCHAR
 *
AA
,

3441 
IN
 
UCHAR
 *
SN⁄˚
,

3442 
IN
 
UCHAR
 *
SA
,

3443 
OUT
 
UCHAR
 *
ouçut
,

3444 
IN
 
UINT
 
Àn
);

3446 
VOID
 
GíR™dom
(

3447 
IN
 
PRTMP_ADAPTER
 
pAd
,

3448 
OUT
 
UCHAR
 *
øndom
);

3450 
VOID
 
AES_GTK_KEY_UNWRAP
(

3451 
IN
 
UCHAR
 *
key
,

3452 
OUT
 
UCHAR
 *
∂aöãxt
,

3453 
IN
 
UCHAR
 
c_Àn
,

3454 
IN
 
UCHAR
 *
cùhîãxt
);

3457 
INT
 
RTMPCheckWPA‰ameF‹E≠Code
(

3458 
IN
 
PRTMP_ADAPTER
 
pAd
,

3459 
IN
 
PUCHAR
 
pFøme
,

3460 
IN
 
ULONG
 
FømeLí
,

3461 
IN
 
ULONG
 
OffSë
);

3464 
VOID
 
W∑MicFaûuªRï‹tFøme
(

3465 
IN
 
PRTMP_ADAPTER
 
pAd
,

3466 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
);

3468 
VOID
 
W∑DißssocApAndBlockAssoc
(

3469 
IN
 
PVOID
 
Sy°emS≥cific1
,

3470 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

3471 
IN
 
PVOID
 
Sy°emS≥cific2
,

3472 
IN
 
PVOID
 
Sy°emS≥cific3
);

3478 
INT
 
π73_io˘l
(

3479 
IN
 
√t_devi˚
 *
√t_dev
,

3480 
IN
 
OUT
 
i‰eq
 *
rq
,

3481 
IN
 
INT
 
cmd
);

3483 
INT
 
RTMPSëInf‹m©i⁄
(

3484 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3485 
IN
 
OUT
 
i‰eq
 *
rq
,

3486 
IN
 
INT
 
cmd
);

3488 
INT
 
RTMPQuîyInf‹m©i⁄
(

3489 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3490 
IN
 
OUT
 
i‰eq
 *
rq
,

3491 
IN
 
INT
 
cmd
);

3493 
CHAR
 *
GëEn¸y±Ty≥
(

3494 
CHAR
 
íc
,

3495 
CHAR
 
ícBôMode
);

3497 
CHAR
 *
GëAuthMode
(

3498 
CHAR
 
auth
,

3499 
CHAR
 
authBôMode
);

3501 
NDIS_STATUS
 
RTMPWPAAddKeyProc
(

3502 
IN
 
PRTMP_ADAPTER
 
pAd
,

3503 
IN
 
PVOID
 
pBuf
);

3505 
NDIS_STATUS
 
RTMPWPARemoveKeyProc
(

3506 
IN
 
PRTMP_ADAPTER
 
pAd
,

3507 
IN
 
PVOID
 
pBuf
);

3509 
VOID
 
RTMPWPARemoveAŒKeys
(

3510 
IN
 
PRTMP_ADAPTER
 
pAd
);

3512 
VOID
 
RTMPIndiˇãWPA2Sètus
(

3513 
IN
 
PRTMP_ADAPTER
 
pAd
);

3515 
VOID
 
RTMPSëPhyMode
(

3516 
IN
 
PRTMP_ADAPTER
 
pAd
,

3517 
IN
 
ULONG
 
phymode
);

3519 
VOID
 
RTMPSëDesúedR©es
(

3520 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3521 
IN
 
LONG
 
R©es
);

3523 
INT
 
Së_DrivîVîsi⁄_Proc
(

3524 
IN
 
PRTMP_ADAPTER
 
pAd
,

3525 
IN
 
PUCHAR
 
¨g
);

3527 
INT
 
Së_Cou¡ryRegi⁄_Proc
(

3528 
IN
 
PRTMP_ADAPTER
 
pAd
,

3529 
IN
 
PUCHAR
 
¨g
);

3531 
INT
 
Së_Cou¡ryRegi⁄AB™d_Proc
(

3532 
IN
 
PRTMP_ADAPTER
 
pAd
,

3533 
IN
 
PUCHAR
 
¨g
);

3535 
INT
 
Së_SSID_Proc
(

3536 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3537 
IN
 
PUCHAR
 
¨g
);

3539 
INT
 
Së_WúñessMode_Proc
(

3540 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3541 
IN
 
PUCHAR
 
¨g
);

3543 
INT
 
Së_TxR©e_Proc
(

3544 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3545 
IN
 
PUCHAR
 
¨g
);

3547 
INT
 
Së_AdhocModeR©e_Proc
(

3548 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3549 
IN
 
PUCHAR
 
¨g
);

3551 
INT
 
Së_Ch™√l_Proc
(

3552 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3553 
IN
 
PUCHAR
 
¨g
);

3555 #ifde‡
DBG


3556 
INT
 
Së_Debug_Proc
(

3557 
IN
 
PRTMP_ADAPTER
 
pAd
,

3558 
IN
 
PUCHAR
 
¨g
);

3561 
INT
 
Së_BGPrŸe˘i⁄_Proc
(

3562 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3563 
IN
 
PUCHAR
 
¨g
);

3565 
INT
 
Së_TxPªambÀ_Proc
(

3566 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3567 
IN
 
PUCHAR
 
¨g
);

3569 
INT
 
Së_RTSThªshﬁd_Proc
(

3570 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3571 
IN
 
PUCHAR
 
¨g
);

3573 
INT
 
Së_FøgThªshﬁd_Proc
(

3574 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3575 
IN
 
PUCHAR
 
¨g
);

3577 
INT
 
Së_TxBur°_Proc
(

3578 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3579 
IN
 
PUCHAR
 
¨g
);

3581 #ifde‡
AGGREGATION_SUPPORT


3582 
INT
 
Së_PktAggªg©e_Proc
(

3583 
IN
 
PRTMP_ADAPTER
 
pAd
,

3584 
IN
 
PUCHAR
 
¨g
);

3587 
INT
 
Së_TurboR©e_Proc
(

3588 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3589 
IN
 
PUCHAR
 
¨g
);

3592 
INT
 
Së_WmmC≠abÀ_Proc
(

3593 
IN
 
PRTMP_ADAPTER
 
pAd
,

3594 
IN
 
PUCHAR
 
¨g
);

3597 
INT
 
Së_Sh‹tSlŸ_Proc
(

3598 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3599 
IN
 
PUCHAR
 
¨g
);

3601 
INT
 
Së_IEEE80211H_Proc
(

3602 
IN
 
PRTMP_ADAPTER
 
pAd
,

3603 
IN
 
PUCHAR
 
¨g
);

3605 
INT
 
Së_Nëw‹kTy≥_Proc
(

3606 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3607 
IN
 
PUCHAR
 
¨g
);

3609 
INT
 
Së_AuthMode_Proc
(

3610 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3611 
IN
 
PUCHAR
 
¨g
);

3613 
INT
 
Së_En¸ypTy≥_Proc
(

3614 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3615 
IN
 
PUCHAR
 
¨g
);

3617 
INT
 
Së_DeÁu…KeyID_Proc
(

3618 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3619 
IN
 
PUCHAR
 
¨g
);

3621 
INT
 
Së_Key1_Proc
(

3622 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3623 
IN
 
PUCHAR
 
¨g
);

3625 
INT
 
Së_Key2_Proc
(

3626 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3627 
IN
 
PUCHAR
 
¨g
);

3629 
INT
 
Së_Key3_Proc
(

3630 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3631 
IN
 
PUCHAR
 
¨g
);

3633 
INT
 
Së_Key4_Proc
(

3634 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3635 
IN
 
PUCHAR
 
¨g
);

3637 
INT
 
Së_WPAPSK_Proc
(

3638 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3639 
IN
 
PUCHAR
 
¨g
);

3641 
INT
 
Së_Re£tSètCou¡î_Proc
(

3642 
IN
 
PRTMP_ADAPTER
 
pAd
,

3643 
IN
 
PUCHAR
 
¨g
);

3645 
INT
 
Së_PSMode_Proc
(

3646 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3647 
IN
 
PUCHAR
 
¨g
);

3649 
INT
 
Së_TxQueSize_Proc
(

3650 
IN
 
PRTMP_ADAPTER
 
pAd
,

3651 
IN
 
PUCHAR
 
¨g
);

3653 #ifde‡
DBG


3654 
VOID
 
RTMPIo˘lBBP
(

3655 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3656 
IN
 
iwªq
 *
wrq
);

3658 
VOID
 
RTMPIo˘lMAC
(

3659 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3660 
IN
 
iwªq
 *
wrq
);

3662 #ifde‡
RALINK_ATE


3663 
VOID
 
RTMPIo˘lE2PROM
(

3664 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3665 
IN
 
iwªq
 *
wrq
);

3670 
VOID
 
RTMPIo˘lSèti°ics
(

3671 
IN
 
PRTMP_ADAPTER
 
pAd
,

3672 
IN
 
iwªq
 *
wrq
);

3674 
VOID
 
RTMPIo˘lGëSôeSurvey
(

3675 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3676 
IN
 
iwªq
 *
wrq
);

3678 
VOID
 
RTMPMakeRSNIE
(

3679 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3680 
IN
 
UCHAR
 
GroupCùhî
);

3682 
NDIS_STATUS
 
RTMPWPAN⁄eAddKeyProc
(

3683 
IN
 
PRTMP_ADAPTER
 
pAd
,

3684 
IN
 
PVOID
 
pBuf
);

3686 #ifde‡
RALINK_ATE


3687 
INT
 
Së_ATE_Proc
(

3688 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3689 
IN
 
PUCHAR
 
¨g
);

3691 
INT
 
Së_ATE_DA_Proc
(

3692 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3693 
IN
 
PUCHAR
 
¨g
);

3695 
INT
 
Së_ATE_SA_Proc
(

3696 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3697 
IN
 
PUCHAR
 
¨g
);

3699 
INT
 
Së_ATE_BSSID_Proc
(

3700 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3701 
IN
 
PUCHAR
 
¨g
);

3703 
INT
 
Së_ATE_CHANNEL_Proc
(

3704 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3705 
IN
 
PUCHAR
 
¨g
);

3707 
INT
 
Së_ATE_TX_POWER_Proc
(

3708 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3709 
IN
 
PUCHAR
 
¨g
);

3711 
INT
 
Së_ATE_TX_FREQOFFSET_Proc
(

3712 
IN
 
PRTMP_ADAPTER
 
pAd
,

3713 
IN
 
PUCHAR
 
¨g
);

3715 
INT
 
Së_ATE_TX_LENGTH_Proc
(

3716 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3717 
IN
 
PUCHAR
 
¨g
);

3719 
INT
 
Së_ATE_TX_COUNT_Proc
(

3720 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3721 
IN
 
PUCHAR
 
¨g
);

3723 
INT
 
Së_ATE_TX_RATE_Proc
(

3724 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3725 
IN
 
PUCHAR
 
¨g
);

3727 
VOID
 
RTMPSèti⁄St›
(

3728 
IN
 
PRTMP_ADAPTER
 
pAd
);

3730 
VOID
 
RTMPSèti⁄Sèπ
(

3731 
IN
 
PRTMP_ADAPTER
 
pAd
);

3733 
VOID
 
ATEAsicSwôchCh™√l
(

3734 
IN
 
PRTMP_ADAPTER
 
pAd
,

3735 
IN
 
UCHAR
 
Ch™√l
);

3737 
VOID
 
ATE_RTUSBBulkOutD©aPackëCom∂ëe
(

3738 
purbb_t
 
purb
, 
±_ªgs
 *pt_regs);

3740 
VOID
 
ATE_RTUSBBulkOutD©aPackë
(

3741 
IN
 
PRTMP_ADAPTER
 
pAd
);

3744 
VOID
 
ATE_RTMPSídNuŒFøme
(

3745 
IN
 
PRTMP_ADAPTER
 
pAd
);

3750 
INT
 
RTMPIo˘lSëAuth
(

3751 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3752 
IN
 
iwªq
 *
wrq
);

3754 
INT
 
RTMPIo˘lSëKeyId
(

3755 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3756 
IN
 
iwªq
 *
wrq
);

3758 
INT
 
RTMPIo˘lSëEn¸yp
(

3759 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3760 
IN
 
iwªq
 *
wrq
);

3762 
INT
 
RTMPIo˘lSëW∑psk
(

3763 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3764 
IN
 
iwªq
 *
wrq
);

3766 
INT
 
RTMPIo˘lSëPsm
(

3767 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3768 
IN
 
iwªq
 *
wrq
);

3771 * 
r°πok
(* 
s
,c⁄° * 
˘
);

3773 #ifde‡
BIG_ENDIAN


3774 
ölöe
 
VOID
 
	$RTMPDes¸ùt‹EndünCh™ge
(

3775 
IN
 
PUCHAR
 
pD©a
,

3776 
IN
 
ULONG
 
Des¸ùt‹Ty≥
)

3778 
size
 = (
Des¸ùt‹Ty≥
 =
TYPE_TXD
Ë? 
TXD_SIZE
 : 
RXD_SIZE
;

3779 
i
;

3780 
i
=1; i<
size
/4; i++) {

3784 i‡(
Des¸ùt‹Ty≥
 =
TYPE_TXD
) {

3786 i‡(
i
==3||i==4)

3791 i‡(
i
==2||i==3)

3794 *((
ULONG
 *)(
pD©a
 + 
i
*4)Ë
	`SWAP32
(*((ULONG *)(pData + i*4)));

3796 *(
ULONG
 *)
pD©a
 = 
	`SWAP32
(*(ULONG *)pData);

3798 
	}
}

3800 
ölöe
 
VOID
 
	$WrôeBackToDes¸ùt‹
(

3801 
IN
 
PUCHAR
 
De°
,

3802 
IN
 
PUCHAR
 
Src
,

3803 
IN
 
BOOLEAN
 
DoEn¸y±
,

3804 
IN
 
ULONG
 
Des¸ùt‹Ty≥
)

3806 
PULONG
 
p1
, 
p2
;

3807 
UCHAR
 
i
;

3808 
size
 = (
Des¸ùt‹Ty≥
 =
TYPE_TXD
Ë? 
TXD_SIZE
 : 
RXD_SIZE
;

3810 
p1
 = ((
PULONG
)
De°
) + 1;

3811 
p2
 = ((
PULONG
)
Src
) + 1;

3812 
i
 = 1; i < 
size
/4 ; i++)

3813 *
p1
++ = *
p2
++;

3814 *(
PULONG
)
De°
 = *(PULONG)
Src
;

3815 
	}
}

3817 
ölöe
 
VOID
 
	$RTMPFømeEndünCh™ge
(

3818 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3819 
IN
 
PUCHAR
 
pD©a
,

3820 
IN
 
ULONG
 
Dú
,

3821 
IN
 
BOOLEAN
 
FromRxD⁄eI¡
)

3823 
PFRAME_802_11
 
pFøme
;

3824 
PUCHAR
 
pMacHdr
;

3827 if(
Dú
 =
DIR_READ
)

3829 *(
USHORT
 *)
pD©a
 = 
	`SWAP16
(*(USHORT *)pData);

3832 
pFøme
 = (
PFRAME_802_11
Ë
pD©a
;

3833 
pMacHdr
 = (
PUCHAR
Ë
pFøme
;

3836 *(
USHORT
 *)(
pMacHdr
 + 2Ë
	`SWAP16
(*(USHORT *)(pMacHdr + 2));

3839 *(
USHORT
 *)(
pMacHdr
 + 22Ë
	`SWAP16
(*(USHORT *)(pMacHdr + 22));

3841 if(
pFøme
->
Hdr
.
FC
.
Ty≥
 =
BTYPE_MGMT
)

3843 
pFøme
->
Hdr
.
FC
.
SubTy≥
)

3845 
SUBTYPE_ASSOC_REQ
:

3846 
SUBTYPE_REASSOC_REQ
:

3848 
pMacHdr
 +
LENGTH_802_11
;

3849 *(
USHORT
 *)
pMacHdr
 = 
	`SWAP16
(*(USHORT *)pMacHdr);

3852 
pMacHdr
 += 2;

3853 *(
USHORT
 *)
pMacHdr
 = 
	`SWAP16
(*(USHORT *)pMacHdr);

3856 
SUBTYPE_ASSOC_RSP
:

3857 
SUBTYPE_REASSOC_RSP
:

3859 
pMacHdr
 +
LENGTH_802_11
;

3860 *(
USHORT
 *)
pMacHdr
 = 
	`SWAP16
(*(USHORT *)pMacHdr);

3863 
pMacHdr
 += 2;

3864 *(
USHORT
 *)
pMacHdr
 = 
	`SWAP16
(*(USHORT *)pMacHdr);

3867 
pMacHdr
 += 2;

3868 *(
USHORT
 *)
pMacHdr
 = 
	`SWAP16
(*(USHORT *)pMacHdr);

3871 
SUBTYPE_AUTH
:

3874 if(!
FromRxD⁄eI¡
 && 
pFøme
->
Hdr
.
FC
.
Wï
 != 1)

3877 
pMacHdr
 +
LENGTH_802_11
;

3878 *(
USHORT
 *)
pMacHdr
 = 
	`SWAP16
(*(USHORT *)pMacHdr);

3881 
pMacHdr
 += 2;

3882 *(
USHORT
 *)
pMacHdr
 = 
	`SWAP16
(*(USHORT *)pMacHdr);

3885 
pMacHdr
 += 2;

3886 *(
USHORT
 *)
pMacHdr
 = 
	`SWAP16
(*(USHORT *)pMacHdr);

3890 
SUBTYPE_BEACON
:

3891 
SUBTYPE_PROBE_RSP
:

3893 
pMacHdr
 +
LENGTH_802_11
 + 
TIMESTAMP_LEN
;

3894 *(
USHORT
 *)
pMacHdr
 = 
	`SWAP16
(*(USHORT *)pMacHdr);

3897 
pMacHdr
 +(
USHORT
);

3898 *(
USHORT
 *)
pMacHdr
 = 
	`SWAP16
(*(USHORT *)pMacHdr);

3901 
SUBTYPE_DEAUTH
:

3902 
SUBTYPE_DISASSOC
:

3904 
pMacHdr
 +
LENGTH_802_11
;

3905 *(
USHORT
 *)
pMacHdr
 = 
	`SWAP16
(*(USHORT *)pMacHdr);

3909 if(
pFøme
->
Hdr
.
FC
.
Ty≥
 =
BTYPE_DATA
)

3912 if(
pFøme
->
Hdr
.
FC
.
Ty≥
 =
BTYPE_CNTL
)

3917 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"Invalid Frame Type!!!\n");

3921 if(
Dú
 =
DIR_WRITE
)

3923 *(
USHORT
 *)
pD©a
 = 
	`SWAP16
(*(USHORT *)pData);

3925 
	}
}

3927 
ölöe
 
ULONG
 
	$RTMPEquÆMem‹y
(

3928 
IN
 
PVOID
 
pSrc1
,

3929 
IN
 
PVOID
 
pSrc2
,

3930 
IN
 
ULONG
 
Lígth
)

3932 
PUCHAR
 
pMem1
;

3933 
PUCHAR
 
pMem2
;

3934 
ULONG
 
Index
 = 0;

3936 
pMem1
 = (
PUCHAR
Ë
pSrc1
;

3937 
pMem2
 = (
PUCHAR
Ë
pSrc2
;

3939 
Index
 = 0; Index < 
Lígth
; Index++)

3941 i‡(
pMem1
[
Index
] !
pMem2
[Index])

3947 i‡(
Index
 =
Lígth
)

3955 
	}
}

3958 
VOID
 
RTMPIo˘lGëRaAPCfg
(

3959 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3960 
IN
 
iwªq
 *
wrq
);

3962 
BOOLEAN
 
BackDo‹ProbeR•S™ôy
(

3963 
IN
 
PRTMP_ADAPTER
 
pAd
,

3964 
IN
 
VOID
 *
Msg
,

3965 
IN
 
ULONG
 
MsgLí
,

3966 
OUT
 
CHAR
 *
pCfgD©aBuf
);

	@rtmp_def.h

39 #i‚de‡
__RTMP_DEF_H__


40 
	#__RTMP_DEF_H__


	)

45 
	#RT_DEBUG_OFF
 0

	)

46 
	#RT_DEBUG_ERROR
 1

	)

47 
	#RT_DEBUG_WARN
 2

	)

48 
	#RT_DEBUG_TRACE
 3

	)

49 
	#RT_DEBUG_INFO
 4

	)

50 
	#RT_DEBUG_LOUD
 5

	)

52 
	#NIC_TAG
 ((
ULONG
)'3752')

	)

53 
	#NIC_DBG_STRING
 ("-RT73-")

	)

55 #ifde‡
BIG_ENDIAN


56 
	#DIR_READ
 0

	)

57 
	#DIR_WRITE
 1

	)

58 
	#TYPE_TXD
 0

	)

59 
	#TYPE_RXD
 1

	)

63 
	#WEP_SMALL_KEY_LEN
 (40/8)

	)

64 
	#WEP_LARGE_KEY_LEN
 (104/8)

	)

69 
	#MAX_TX_QUEUE_SIZE
 1600

	)

70 
	#TX_RING_SIZE
 64

	)

71 
	#PRIO_RING_SIZE
 16

	)

72 
	#RX_RING_SIZE
 64

	)

73 
	#BEACON_RING_SIZE
 2

	)

74 
	#MGMT_RING_SIZE
 
PRIO_RING_SIZE


	)

75 
	#PRIO_BUFFER_SIZE
 1024

76 
	#BUFFER_SIZE
 2400

77 
	#MAX_FRAME_SIZE
 2346

78 
	#ALLOC_RX_PACKET_POOL
 (
RX_RING_SIZE
)

	)

79 
	#ALLOC_RX_BUFFER_POOL
 (
ALLOC_RX_PACKET_POOL
)

	)

80 
	#TX_RING
 0xa

	)

81 
	#ATIM_RING
 0xb

	)

82 
	#PRIO_RING
 0xc

	)

83 
	#RX_RING
 0xd

	)

84 
	#BEACON_RING
 0xe

	)

85 
	#NULL_RING
 0xf

	)

86 
	#MAX_TX_PROCESS
 2

	)

87 
	#MAX_RX_PROCESS
 4

	)

88 
	#MAX_CLIENT
 2

	)

90 
	#LOCAL_TXBUF_SIZE
 2048

	)

91 
	#TXD_SIZE
 24

	)

92 
	#RXD_SIZE
 24

	)

93 
	#TX_DMA_1ST_BUFFER_SIZE
 64

94 
	#MGMT_DMA_BUFFER_SIZE
 2048

	)

95 
	#RX_DMA_BUFFER_SIZE
 4096

	)

96 
	#MAX_AGGREGATION_SIZE
 4096

	)

97 
	#MAX_DMA_DONE_PROCESS
 
TX_RING_SIZE


	)

98 
	#MAX_TX_DONE_PROCESS
 8

	)

99 
	#MAX_NUM_OF_TUPLE_CACHE
 2

	)

100 
	#MAX_MCAST_LIST_SIZE
 32

	)

106 
	#fRTMP_ADAPTER_TEST_MODE
 0x00000001

	)

107 
	#fRTMP_ADAPTER_MLME_RESET_IN_PROGRESS
 0x00000002

	)

108 
	#fRTMP_ADAPTER_HARDWARE_ERROR
 0x00000004

	)

109 
	#fRTMP_ADAPTER_SEND_PACKET_ERROR
 0x00000010

	)

110 
	#fRTMP_ADAPTER_RECEIVE_PACKET_ERROR
 0x00000020

	)

111 
	#fRTMP_ADAPTER_HALT_IN_PROGRESS
 0x00000040

	)

112 
	#fRTMP_ADAPTER_RESET_IN_PROGRESS
 0x00000080

	)

113 
	#fRTMP_ADAPTER_NIC_NOT_EXIST
 0x00000100

	)

114 
	#fRTMP_ADAPTER_TX_RING_ALLOCATED
 0x00000200

	)

115 
	#fRTMP_ADAPTER_ATIM_RING_ALLOCATED
 0x00000400

	)

116 
	#fRTMP_ADAPTER_PRIO_RING_ALLOCATED
 0x00000800

	)

117 
	#fRTMP_ADAPTER_RX_RING_ALLOCATED
 0x00001000

	)

118 
	#fRTMP_ADAPTER_BSS_JOIN_IN_PROGRESS
 0x00002000

	)

119 
	#fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
 0x00004000

	)

120 
	#fRTMP_ADAPTER_REASSOC_IN_PROGRESS
 0x00008000

	)

121 
	#fRTMP_ADAPTER_MEDIA_STATE_PENDING
 0x00010000

	)

122 
	#fRTMP_ADAPTER_RADIO_OFF
 0x00020000

	)

123 
	#fRTMP_ADAPTER_BULKOUT_RESET
 0x00040000

	)

124 
	#fRTMP_ADAPTER_BULKIN_RESET
 0x00080000

	)

125 
	#fRTMP_ADAPTER_RESET_DATA_SW_QUEUE
 0x00100000

	)

126 
	#fRTMP_ADAPTER_RESET_PIPE_IN_PROGRESS
 0x00200000

	)

127 
	#fRTMP_ADAPTER_SCAN_CHANNEL_IN_PROGRESS
 0x04000000

	)

128 
	#fRTMP_ADAPTER_RADIO_MEASUREMENT
 0x08000000

	)

129 
	#fRTMP_ADAPTER_REMOVE_IN_PROGRESS
 0x10000000

	)

130 
	#fRTMP_ADAPTER_MEDIA_STATE_CHANGE
 0x20000000

	)

134 
	#fRTMP_ADAPTER_TX_RING_BUSY
 0x80000000

	)

135 
	#fRTMP_ADAPTER_PRIO_RING_BUSY
 0x40000000

	)

136 
	#fRTMP_ADAPTER_ATIM_RING_BUSY
 0x20000000

	)

137 
	#fRTMP_ADAPTER_RX_RING_BUSY
 0x10000000

	)

140 
	#fRTMP_ADAPTER_TX_QUEUE_BUSY
 0x08000000

	)

141 
	#fRTMP_ADAPTER_PRIO_QUEUE_BUSY
 0x04000000

	)

147 
	#fOP_STATUS_INFRA_ON
 0x00000001

	)

148 
	#fOP_STATUS_ADHOC_ON
 0x00000002

	)

149 
	#fOP_STATUS_BG_PROTECTION_INUSED
 0x00000004

	)

150 
	#fOP_STATUS_SHORT_SLOT_INUSED
 0x00000008

	)

151 
	#fOP_STATUS_SHORT_PREAMBLE_INUSED
 0x00000010

	)

152 
	#fOP_STATUS_RECEIVE_DTIM
 0x00000020

	)

153 
	#fOP_STATUS_TX_RATE_SWITCH_ENABLED
 0x00000040

	)

154 
	#fOP_STATUS_MEDIA_STATE_CONNECTED
 0x00000080

	)

155 
	#fOP_STATUS_WMM_INUSED
 0x00000100

	)

156 
	#fOP_STATUS_AGGREGATION_INUSED
 0x00000200

	)

157 
	#fOP_STATUS_DOZE
 0x00000400

	)

158 
	#fOP_STATUS_MAX_RETRY_ENABLED
 0x00000800

	)

159 
	#fOP_STATUS_RTS_PROTECTION_ENABLE
 0x00001000

	)

164 
	#fRTUSB_BULK_OUT_DATA_NULL
 0x00000001

	)

165 
	#fRTUSB_BULK_OUT_RTS
 0x00000002

	)

166 
	#fRTUSB_BULK_OUT_MLME
 0x00000004

	)

167 
	#fRTUSB_BULK_OUT_BEACON_1
 0x00000008

	)

169 
	#fRTUSB_BULK_OUT_DATA_NORMAL
 0x00010000

	)

170 
	#fRTUSB_BULK_OUT_DATA_NORMAL_2
 0x00020000

	)

171 
	#fRTUSB_BULK_OUT_DATA_NORMAL_3
 0x00040000

	)

172 
	#fRTUSB_BULK_OUT_DATA_NORMAL_4
 0x00080000

	)

175 
	#fRTUSB_BULK_OUT_BEACON_0
 0x00000010

	)

176 
	#fRTUSB_BULK_OUT_PSPOLL
 0x00000020

	)

177 
	#fRTUSB_BULK_OUT_DATA_FRAG
 0x00000040

	)

178 
	#fRTUSB_BULK_OUT_DATA_FRAG_2
 0x00000080

	)

179 
	#fRTUSB_BULK_OUT_DATA_FRAG_3
 0x00000100

	)

180 
	#fRTUSB_BULK_OUT_DATA_FRAG_4
 0x00000200

	)

181 #ifde‡
RALINK_ATE


182 
	#fRTUSB_BULK_OUT_DATA_ATE
 0x00100000

	)

188 
	#fCLIENT_STATUS_WMM_CAPABLE
 0x00000001

189 
	#fCLIENT_STATUS_AGGREGATION_CAPABLE
 0x00000002

190 

	)

201 
	#ERRLOG_READ_PCI_SLOT_FAILED
 0x00000101L

	)

202 
	#ERRLOG_WRITE_PCI_SLOT_FAILED
 0x00000102L

	)

203 
	#ERRLOG_VENDOR_DEVICE_NOMATCH
 0x00000103L

	)

206 
	#ERRLOG_BUS_MASTER_DISABLED
 0x00000201L

	)

209 
	#ERRLOG_INVALID_SPEED_DUPLEX
 0x00000301L

	)

210 
	#ERRLOG_SET_SECONDARY_FAILED
 0x00000302L

	)

213 
	#ERRLOG_OUT_OF_MEMORY
 0x00000401L

	)

214 
	#ERRLOG_OUT_OF_SHARED_MEMORY
 0x00000402L

	)

215 
	#ERRLOG_OUT_OF_MAP_REGISTERS
 0x00000403L

	)

216 
	#ERRLOG_OUT_OF_BUFFER_POOL
 0x00000404L

	)

217 
	#ERRLOG_OUT_OF_NDIS_BUFFER
 0x00000405L

	)

218 
	#ERRLOG_OUT_OF_PACKET_POOL
 0x00000406L

	)

219 
	#ERRLOG_OUT_OF_NDIS_PACKET
 0x00000407L

	)

220 
	#ERRLOG_OUT_OF_LOOKASIDE_MEMORY
 0x00000408L

	)

223 
	#ERRLOG_SELFTEST_FAILED
 0x00000501L

	)

224 
	#ERRLOG_INITIALIZE_ADAPTER
 0x00000502L

	)

225 
	#ERRLOG_REMOVE_MINIPORT
 0x00000503L

	)

228 
	#ERRLOG_MAP_IO_SPACE
 0x00000601L

	)

229 
	#ERRLOG_QUERY_ADAPTER_RESOURCES
 0x00000602L

	)

230 
	#ERRLOG_NO_IO_RESOURCE
 0x00000603L

	)

231 
	#ERRLOG_NO_INTERRUPT_RESOURCE
 0x00000604L

	)

232 
	#ERRLOG_NO_MEMORY_RESOURCE
 0x00000605L

	)

236 
	#PEER_KEY_NO
 2

	)

237 
	#MAC_ADDR_LEN
 6

	)

238 
	#TIMESTAMP_LEN
 8

	)

239 
	#MAX_LEN_OF_SUPPORTED_RATES
 12

240 
	#MAX_LEN_OF_KEY
 32

241 

	)

242 
	#MAX_NUM_OF_CHANNELS
 43

244 
	#MAX_NUM_OF_A_CHANNELS
 24

245 
	#J52_CHANNEL_START_OFFSET
 38

247 
	#MAX_LEN_OF_SSID
 32

	)

248 
	#CIPHER_TEXT_LEN
 128

	)

249 
	#MAX_LEN_OF_MLME_BUFFER
 2048

	)

250 
	#MAX_MLME_HANDLER_MEMORY
 20

251 
	#MAX_FRAME_LEN
 2338

	)

252 
	#MAX_VIE_LEN
 300

253 

	)

254 
	#MAX_TX_POWER_LEVEL
 100

	)

255 
	#MAX_RSSI_TRIGGER
 -10

	)

256 
	#MIN_RSSI_TRIGGER
 -200

	)

257 
	#MAX_FRAG_THRESHOLD
 2346

	)

258 
	#MIN_FRAG_THRESHOLD
 256

	)

259 
	#MAX_RTS_THRESHOLD
 2347

	)

262 
	#SHARE_KEY_NUM
 4

	)

263 
	#MAX_LEN_OF_SHARE_KEY
 16

264 
	#MAX_LEN_OF_PEER_KEY
 16

265 
	#PAIRWISE_KEY_NO
 64

266 
	#GROUP_KEY_NO
 4

	)

267 
	#PMKID_NO
 4

268 

	)

271 
	#PWR_ACTIVE
 0

	)

272 
	#PWR_SAVE
 1

	)

273 
	#PWR_UNKNOWN
 2

	)

276 
	#BSS_ADHOC
 0

277 
	#BSS_INFRA
 1

278 
	#BSS_ANY
 2

279 

	)

281 
	#REASON_RESERVED
 0

	)

282 
	#REASON_UNSPECIFY
 1

	)

283 
	#REASON_NO_LONGER_VALID
 2

	)

284 
	#REASON_DEAUTH_STA_LEAVING
 3

	)

285 
	#REASON_DISASSOC_INACTIVE
 4

	)

286 
	#REASON_DISASSPC_AP_UNABLE
 5

	)

287 
	#REASON_CLS2ERR
 6

	)

288 
	#REASON_CLS3ERR
 7

	)

289 
	#REASON_DISASSOC_STA_LEAVING
 8

	)

290 
	#REASON_STA_REQ_ASSOC_NOT_AUTH
 9

	)

291 
	#REASON_INVALID_IE
 13

	)

292 
	#REASON_MIC_FAILURE
 14

	)

293 
	#REASON_4_WAY_TIMEOUT
 15

	)

294 
	#REASON_GROUP_KEY_HS_TIMEOUT
 16

	)

295 
	#REASON_IE_DIFFERENT
 17

	)

296 
	#REASON_MCIPHER_NOT_VALID
 18

	)

297 
	#REASON_UCIPHER_NOT_VALID
 19

	)

298 
	#REASON_AKMP_NOT_VALID
 20

	)

299 
	#REASON_UNSUPPORT_RSNE_VER
 21

	)

300 
	#REASON_INVALID_RSNE_CAP
 22

	)

301 
	#REASON_8021X_AUTH_FAIL
 23

	)

302 
	#REASON_CIPHER_SUITE_REJECTED
 24

	)

305 
	#MLME_SUCCESS
 0

	)

306 
	#MLME_UNSPECIFY_FAIL
 1

	)

307 
	#MLME_CANNOT_SUPPORT_CAP
 10

	)

308 
	#MLME_REASSOC_DENY_ASSOC_EXIST
 11

	)

309 
	#MLME_ASSOC_DENY_OUT_SCOPE
 12

	)

310 
	#MLME_ALG_NOT_SUPPORT
 13

	)

311 
	#MLME_SEQ_NR_OUT_OF_SEQUENCE
 14

	)

312 
	#MLME_REJ_CHALLENGE_FAILURE
 15

	)

313 
	#MLME_REJ_TIMEOUT
 16

	)

314 
	#MLME_ASSOC_REJ_UNABLE_HANDLE_STA
 17

	)

315 
	#MLME_ASSOC_REJ_DATA_RATE
 18

	)

317 
	#MLME_ASSOC_REJ_NO_EXT_RATE
 22

	)

318 
	#MLME_ASSOC_REJ_NO_EXT_RATE_PBCC
 23

	)

319 
	#MLME_ASSOC_REJ_NO_CCK_OFDM
 24

	)

321 
	#MLME_INVALID_FORMAT
 0x51

	)

322 
	#MLME_FAIL_NO_RESOURCE
 0x52

	)

323 
	#MLME_STATE_MACHINE_REJECT
 0x53

	)

324 
	#MLME_MAC_TABLE_FAIL
 0x54

	)

327 
	#IE_SSID
 0

	)

328 
	#IE_SUPP_RATES
 1

	)

329 
	#IE_FH_PARM
 2

	)

330 
	#IE_DS_PARM
 3

	)

331 
	#IE_CF_PARM
 4

	)

332 
	#IE_TIM
 5

	)

333 
	#IE_IBSS_PARM
 6

	)

334 
	#IE_COUNTRY
 7

335 
	#IE_802_11D_REQUEST
 10

336 
	#IE_QBSS_LOAD
 11

337 
	#IE_EDCA_PARAMETER
 12

338 
	#IE_TSPEC
 13

339 
	#IE_TCLAS
 14

340 
	#IE_SCHEDULE
 15

341 
	#IE_CHALLENGE_TEXT
 16

	)

342 
	#IE_POWER_CONSTRAINT
 32

343 
	#IE_POWER_CAPABILITY
 33

344 
	#IE_TPC_REQUEST
 34

345 
	#IE_TPC_REPORT
 35

346 
	#IE_SUPP_CHANNELS
 36

347 
	#IE_CHANNEL_SWITCH_ANNOUNCEMENT
 37

348 
	#IE_MEASUREMENT_REQUEST
 38

349 
	#IE_MEASUREMENT_REPORT
 39

350 
	#IE_QUIET
 40

351 
	#IE_IBSS_DFS
 41

352 
	#IE_ERP
 42

353 
	#IE_TS_DELAY
 43

354 
	#IE_TCLAS_PROCESSING
 44

355 
	#IE_QOS_CAPABILITY
 45

356 
	#IE_EXT_SUPP_RATES
 50

357 
	#IE_WPA
 221

358 
	#IE_VENDOR_SPECIFIC
 221

359 
	#IE_RSN
 48

360 
	#IE_WPA2
 48

361 

	)

369 
	#ASSOC_STATE_MACHINE
 1

	)

370 
	#AUTH_STATE_MACHINE
 2

	)

371 
	#AUTH_RSP_STATE_MACHINE
 3

	)

372 
	#SYNC_STATE_MACHINE
 4

	)

373 
	#MLME_CNTL_STATE_MACHINE
 5

	)

374 
	#WPA_PSK_STATE_MACHINE
 6

	)

379 
	#CNTL_IDLE
 0

	)

380 
	#CNTL_WAIT_DISASSOC
 1

	)

381 
	#CNTL_WAIT_JOIN
 2

	)

382 
	#CNTL_WAIT_REASSOC
 3

	)

383 
	#CNTL_WAIT_START
 4

	)

384 
	#CNTL_WAIT_AUTH
 5

	)

385 
	#CNTL_WAIT_ASSOC
 6

	)

386 
	#CNTL_WAIT_AUTH2
 7

	)

387 
	#CNTL_WAIT_OID_LIST_SCAN
 8

	)

388 
	#CNTL_WAIT_OID_DISASSOC
 9

	)

390 
	#MT2_ASSOC_CONF
 34

	)

391 
	#MT2_AUTH_CONF
 35

	)

392 
	#MT2_DEAUTH_CONF
 36

	)

393 
	#MT2_DISASSOC_CONF
 37

	)

394 
	#MT2_REASSOC_CONF
 38

	)

395 
	#MT2_PWR_MGMT_CONF
 39

	)

396 
	#MT2_JOIN_CONF
 40

	)

397 
	#MT2_SCAN_CONF
 41

	)

398 
	#MT2_START_CONF
 42

	)

399 
	#MT2_GET_CONF
 43

	)

400 
	#MT2_SET_CONF
 44

	)

401 
	#MT2_RESET_CONF
 45

	)

403 
	#MT2_DEAUTH_IND
 46

	)

404 
	#MT2_ASSOC_IND
 47

	)

405 
	#MT2_DISASSOC_IND
 48

	)

406 
	#MT2_REASSOC_IND
 49

	)

407 
	#MT2_AUTH_IND
 50

	)

409 
	#MT2_SCAN_END_CONF
 51

410 
	#MT2_MLME_ROAMING_REQ
 52

	)

412 
	#CNTL_FUNC_SIZE
 1

	)

417 
	#ASSOC_IDLE
 0

	)

418 
	#ASSOC_WAIT_RSP
 1

	)

419 
	#REASSOC_WAIT_RSP
 2

	)

420 
	#DISASSOC_WAIT_RSP
 3

	)

421 
	#MAX_ASSOC_STATE
 4

	)

423 
	#ASSOC_MACHINE_BASE
 0

	)

424 
	#MT2_MLME_ASSOC_REQ
 0

	)

425 
	#MT2_MLME_REASSOC_REQ
 1

	)

426 
	#MT2_MLME_DISASSOC_REQ
 2

	)

427 
	#MT2_PEER_DISASSOC_REQ
 3

	)

428 
	#MT2_PEER_ASSOC_REQ
 4

	)

429 
	#MT2_PEER_ASSOC_RSP
 5

	)

430 
	#MT2_PEER_REASSOC_REQ
 6

	)

431 
	#MT2_PEER_REASSOC_RSP
 7

	)

432 
	#MT2_DISASSOC_TIMEOUT
 8

	)

433 
	#MT2_ASSOC_TIMEOUT
 9

	)

434 
	#MT2_REASSOC_TIMEOUT
 10

	)

435 
	#MAX_ASSOC_MSG
 11

	)

437 
	#ASSOC_FUNC_SIZE
 (
MAX_ASSOC_STATE
 * 
MAX_ASSOC_MSG
)

	)

442 
	#AUTH_REQ_IDLE
 0

	)

443 
	#AUTH_WAIT_SEQ2
 1

	)

444 
	#AUTH_WAIT_SEQ4
 2

	)

445 
	#MAX_AUTH_STATE
 3

	)

447 
	#AUTH_MACHINE_BASE
 0

	)

448 
	#MT2_MLME_AUTH_REQ
 0

	)

449 
	#MT2_PEER_AUTH_EVEN
 1

	)

450 
	#MT2_AUTH_TIMEOUT
 2

	)

451 
	#MAX_AUTH_MSG
 3

	)

453 
	#AUTH_FUNC_SIZE
 (
MAX_AUTH_STATE
 * 
MAX_AUTH_MSG
)

	)

458 
	#AUTH_RSP_IDLE
 0

	)

459 
	#AUTH_RSP_WAIT_CHAL
 1

	)

460 
	#MAX_AUTH_RSP_STATE
 2

	)

462 
	#AUTH_RSP_MACHINE_BASE
 0

	)

463 
	#MT2_AUTH_CHALLENGE_TIMEOUT
 0

	)

464 
	#MT2_PEER_AUTH_ODD
 1

	)

465 
	#MT2_PEER_DEAUTH
 2

	)

466 
	#MAX_AUTH_RSP_MSG
 3

	)

468 
	#AUTH_RSP_FUNC_SIZE
 (
MAX_AUTH_RSP_STATE
 * 
MAX_AUTH_RSP_MSG
)

	)

473 
	#SYNC_IDLE
 0

474 
	#JOIN_WAIT_BEACON
 1

	)

475 
	#SCAN_LISTEN
 2

	)

476 
	#MAX_SYNC_STATE
 3

	)

478 
	#SYNC_MACHINE_BASE
 0

	)

479 
	#MT2_MLME_SCAN_REQ
 0

	)

480 
	#MT2_MLME_JOIN_REQ
 1

	)

481 
	#MT2_MLME_START_REQ
 2

	)

482 
	#MT2_PEER_BEACON
 3

	)

483 
	#MT2_PEER_PROBE_RSP
 4

	)

484 
	#MT2_PEER_ATIM
 5

	)

485 
	#MT2_SCAN_TIMEOUT
 6

	)

486 
	#MT2_BEACON_TIMEOUT
 7

	)

487 
	#MT2_ATIM_TIMEOUT
 8

	)

488 
	#MT2_PEER_PROBE_REQ
 9

	)

489 
	#MAX_SYNC_MSG
 10

	)

491 
	#SYNC_FUNC_SIZE
 (
MAX_SYNC_STATE
 * 
MAX_SYNC_MSG
)

	)

496 
	#WPA_PSK_IDLE
 0

	)

497 
	#MAX_WPA_PSK_STATE
 1

	)

499 
	#WPA_MACHINE_BASE
 0

	)

500 
	#MT2_EAPPackë
 0

	)

501 
	#MT2_EAPOLSèπ
 1

	)

502 
	#MT2_EAPOLLogoff
 2

	)

503 
	#MT2_EAPOLKey
 3

	)

504 
	#MT2_EAPOLASFAÀπ
 4

	)

505 
	#MAX_WPA_PSK_MSG
 5

	)

507 
	#WPA_PSK_FUNC_SIZE
 (
MAX_WPA_PSK_STATE
 * 
MAX_WPA_PSK_MSG
)

	)

512 
	#MT2_GET_REQ
 31

	)

513 
	#MT2_SET_REQ
 32

	)

514 
	#MT2_RESET_REQ
 33

	)

519 
	#BTYPE_MGMT
 0

	)

520 
	#BTYPE_CNTL
 1

	)

521 
	#BTYPE_DATA
 2

	)

525 
	#SUBTYPE_ASSOC_REQ
 0

	)

526 
	#SUBTYPE_ASSOC_RSP
 1

	)

527 
	#SUBTYPE_REASSOC_REQ
 2

	)

528 
	#SUBTYPE_REASSOC_RSP
 3

	)

529 
	#SUBTYPE_PROBE_REQ
 4

	)

530 
	#SUBTYPE_PROBE_RSP
 5

	)

531 
	#SUBTYPE_BEACON
 8

	)

532 
	#SUBTYPE_ATIM
 9

	)

533 
	#SUBTYPE_DISASSOC
 10

	)

534 
	#SUBTYPE_AUTH
 11

	)

535 
	#SUBTYPE_DEAUTH
 12

	)

536 
	#SUBTYPE_ACTION
 13

	)

539 
	#SUBTYPE_BLOCK_ACK_REQ
 8

	)

540 
	#SUBTYPE_BLOCK_ACK
 9

	)

541 
	#SUBTYPE_PS_POLL
 10

	)

542 
	#SUBTYPE_RTS
 11

543 
	#SUBTYPE_CTS
 12

544 
	#SUBTYPE_ACK
 13

545 
	#SUBTYPE_CFEND
 14

	)

546 
	#SUBTYPE_CFEND_CFACK
 15

	)

549 
	#SUBTYPE_DATA
 0

	)

550 
	#SUBTYPE_DATA_CFACK
 1

	)

551 
	#SUBTYPE_DATA_CFPOLL
 2

	)

552 
	#SUBTYPE_DATA_CFACK_CFPOLL
 3

	)

553 
	#SUBTYPE_NULL_FUNC
 4

	)

554 
	#SUBTYPE_CFACK
 5

555 
	#SUBTYPE_CFPOLL
 6

	)

556 
	#SUBTYPE_CFACK_CFPOLL
 7

	)

557 
	#SUBTYPE_QDATA
 8

	)

558 
	#SUBTYPE_QDATA_CFACK
 9

	)

559 
	#SUBTYPE_QDATA_CFPOLL
 10

	)

560 
	#SUBTYPE_QDATA_CFACK_CFPOLL
 11

	)

561 
	#SUBTYPE_QOS_NULL
 12

	)

562 
	#SUBTYPE_QOS_CFACK
 13

	)

563 
	#SUBTYPE_QOS_CFPOLL
 14

	)

564 
	#SUBTYPE_QOS_CFACK_CFPOLL
 15

	)

567 
	#NORMAL_ACK
 0x00

568 
	#NO_ACK
 0x20

569 
	#NO_EXPLICIT_ACK
 0x40

570 
	#BLOCK_ACK
 0x60

571 

	)

575 
	#LENGTH_802_11
 24

	)

576 
	#LENGTH_802_11_WITH_ADDR4
 30

	)

577 
	#LENGTH_802_11_AND_H
 30

	)

578 
	#LENGTH_802_11_CRC_H
 34

	)

579 
	#LENGTH_802_11_CRC
 28

	)

580 
	#LENGTH_802_3
 14

	)

581 
	#LENGTH_802_3_TYPE
 2

	)

582 
	#LENGTH_802_1_H
 8

	)

583 
	#LENGTH_EAPOL_H
 4

	)

584 
	#LENGTH_CRC
 4

	)

585 
	#MAX_SEQ_NUMBER
 0x0fff

	)

587 
	#TX_RESULT_SUCCESS
 0

	)

588 
	#TX_RESULT_ZERO_LENGTH
 1

	)

589 
	#TX_RESULT_UNDER_RUN
 2

	)

590 
	#TX_RESULT_PHY_ERROR
 4

	)

591 
	#TX_RESULT_RETRY_FAIL
 6

	)

593 
	#RATE_1
 0

	)

594 
	#RATE_2
 1

	)

595 
	#RATE_5_5
 2

	)

596 
	#RATE_11
 3

	)

597 
	#RATE_6
 4

598 
	#RATE_9
 5

599 
	#RATE_12
 6

600 
	#RATE_18
 7

601 
	#RATE_24
 8

602 
	#RATE_36
 9

603 
	#RATE_48
 10

604 
	#RATE_54
 11

605 
	#RATE_FIRST_OFDM_RATE
 
RATE_6


	)

606 
	#RATE_AUTO_SWITCH
 255

607 

	)

609 
	#CCK_RATE
 1

	)

610 
	#OFDM_RATE
 2

	)

611 
	#CCKOFDM_RATE
 3

	)

614 
	#IFS_BACKOFF
 0

	)

615 
	#IFS_SIFS
 1

	)

618 
	#LONG_RETRY
 1

	)

619 
	#SHORT_RETRY
 0

	)

622 
	#REGION_0_BG_BAND
 0

623 
	#REGION_1_BG_BAND
 1

624 
	#REGION_2_BG_BAND
 2

625 
	#REGION_3_BG_BAND
 3

626 
	#REGION_4_BG_BAND
 4

627 
	#REGION_5_BG_BAND
 5

628 
	#REGION_6_BG_BAND
 6

629 
	#REGION_7_BG_BAND
 7

630 
	#REGION_MAXIMUM_BG_BAND
 
REGION_7_BG_BAND


	)

632 
	#REGION_0_A_BAND
 0

633 
	#REGION_1_A_BAND
 1

634 
	#REGION_2_A_BAND
 2

635 
	#REGION_3_A_BAND
 3

636 
	#REGION_4_A_BAND
 4

637 
	#REGION_5_A_BAND
 5

638 
	#REGION_6_A_BAND
 6

639 
	#REGION_7_A_BAND
 7

640 
	#REGION_8_A_BAND
 8

641 
	#REGION_9_A_BAND
 9

642 
	#REGION_10_A_BAND
 10

643 
	#REGION_MAXIMUM_A_BAND
 
REGION_10_A_BAND


	)

647 
	#CIPHER_NONE
 0

	)

648 
	#CIPHER_WEP64
 1

	)

649 
	#CIPHER_WEP128
 2

	)

650 
	#CIPHER_TKIP
 3

	)

651 
	#CIPHER_AES
 4

	)

652 
	#CIPHER_CKIP64
 5

	)

653 
	#CIPHER_CKIP128
 6

	)

654 
	#CIPHER_TKIP_NO_MIC
 7

655 

	)

658 
	#RFIC_5226
 1

659 
	#RFIC_2528
 2

660 
	#RFIC_5225
 3

661 
	#RFIC_2527
 4

662 
	#RFIC_3020
 5

663 

	)

665 
	#LED_LINK_DOWN
 0

	)

666 
	#LED_LINK_UP
 1

	)

667 
	#LED_RADIO_OFF
 2

	)

668 
	#LED_RADIO_ON
 3

	)

669 
	#LED_HALT
 4

	)

672 
	#LED_MODE_DEFAULT
 0

	)

673 
	#LED_MODE_TWO_LED
 1

	)

674 
	#LED_MODE_SIGNAL_STREGTH
 2

	)

678 
	#PPPINITFCS32
 0xfffffff‡

	)

680 
	#PAIRWISE_KEY_TABLE
 1

	)

681 
	#SHARED_KEY_TABLE
 0

	)

683 
	#DEFAULT_BBP_TX_POWER
 0

	)

684 
	#DEFAULT_RF_TX_POWER
 5

	)

686 
	#MAX_INI_BUFFER_SIZE
 (4*1024)

687 

	)

688 
	#MAX_LEN_OF_MAC_TABLE
 64

	)

689 
	#HASH_TABLE_SIZE
 256

	)

692 
	#MAX_NUM_OF_EVENT
 10

693 
	#EVENT_MAX_EVENT_TYPE
 6

	)

697 
	#WPA_802_1X_PORT_SECURED
 1

	)

698 
	#WPA_802_1X_PORT_PASS_4_WAY
 2

	)

699 
	#WPA_802_1X_PORT_NOT_SECURED
 3

	)

701 
	#PAIRWISE_KEY
 1

	)

702 
	#GROUP_KEY
 2

	)

704 
	#AUTH_MODE_OPEN
 0x00

	)

705 
	#AUTH_MODE_KEY
 0x01

	)

706 
	#AUTH_MODE_AUTO_SWITCH
 0x03

	)

709 
	#LEN_KEY_DESC_NONCE
 32

	)

710 
	#LEN_KEY_DESC_IV
 16

	)

711 
	#LEN_KEY_DESC_RSC
 8

	)

712 
	#LEN_KEY_DESC_ID
 8

	)

713 
	#LEN_KEY_DESC_REPLAY
 8

	)

714 
	#LEN_KEY_DESC_MIC
 16

	)

716 
	#LEN_MASTER_KEY
 32

	)

719 
	#LEN_EAP_EK
 16

	)

720 
	#LEN_EAP_MICK
 16

	)

721 
	#LEN_EAP_KEY
 ((
LEN_EAP_EK
)+(
LEN_EAP_MICK
))

	)

722 
	#PMK_LEN
 32

	)

725 
	#LEN_PMKID
 16

	)

726 
	#LEN_TKIP_EK
 16

	)

727 
	#LEN_TKIP_RXMICK
 8

	)

728 
	#LEN_TKIP_TXMICK
 8

	)

729 
	#LEN_AES_EK
 16

	)

730 
	#LEN_AES_KEY
 
LEN_AES_EK


	)

731 
	#LEN_TKIP_KEY
 ((
LEN_TKIP_EK
)+(
LEN_TKIP_RXMICK
)+(
LEN_TKIP_TXMICK
))

	)

732 
	#TKIP_AP_TXMICK_OFFSET
 ((
LEN_EAP_KEY
)+(
LEN_TKIP_EK
))

	)

733 
	#TKIP_AP_RXMICK_OFFSET
 (
TKIP_AP_TXMICK_OFFSET
+
LEN_TKIP_TXMICK
)

	)

734 
	#TKIP_GTK_LENGTH
 ((
LEN_TKIP_EK
)+(
LEN_TKIP_RXMICK
)+(
LEN_TKIP_TXMICK
))

	)

736 
	#LEN_PTK
 ((
LEN_EAP_KEY
)+(
LEN_TKIP_KEY
))

	)

737 
	#MAX_LEN_OF_RSNIE
 80

	)

738 
	#MIN_LEN_OF_RSNIE
 8

	)

742 
	#RSSI_NO_1
 1

	)

743 
	#RSSI_NO_2
 2

	)

747 
	#RD_NORMAL_MODE
 0

748 
	#RD_SWITCHING_MODE
 1

749 
	#RD_SILENCE_MODE
 2

750 

	)

751 
	#MAX_CFG_BUFFER_LEN
 1056

	)

755 
	#CMD_RESET_BULKOUT
 0

	)

756 
	#CMD_RESET_BULKIN
 1

	)

757 
	#CMD_RESET_FROM_ERROR
 2

	)

758 
	#CMD_LINK_DOWN
 3

	)

759 
	#CMD_UPDATE_TX_RATE
 4

	)

760 
	#CMD_SET_PSM_SAVE
 5

	)

761 
	#CMD_RESET_FROM_NDIS
 6

	)

762 
	#CMD_PERIODIC_EXECUT
 7

	)

763 
	#CMD_ASICLED_EXECUT
 8

	)

764 
	#CMD_CHECK_GPIO
 9

	)

765 
	#CMD_Remove_AŒKeys
 10

	)

766 
	#CMD_SOFT_DIVERSITY
 11

	)

767 
	#CMD_FORCE_WAKEUP
 12

	)

768 
	#CMD_SET_PSM_ACTIVE
 13

	)

770 
	#COMMAND_QUEUE_SIZE
 14

	)

773 
	#USB_DEVICE_MAX_CONFIG_DESCRIPTOR_SIZE
 1024

	)

775 
	#UNLINK_TIMEOUT_MS
 3

	)

781 
	#MAC_ADDRESS_LENGTH
 6

	)

783 
	#HEADER_SIZE
 14

	)

784 
	#MAXIMUM_PACKET_SIZE
 1500

	)

786 
	#USB_DEVICE_MAX_CONFIG_DESCRIPTOR_SIZE
 1024

	)

788 
	#MAX_QUEUE_SIZE
 100

	)

790 
	#USB_TX_HEADER_SIZE
 8

791 
	#USB_RX_HEADER_SIZE
 12

	)

793 
	#WIRELESS_HEADER_OVERHEAD
 18

	)

794 
	#MAX_TX_PADDING_BYTES
 50

	)

795 
	#MAX_RX_PADDING_BYTES
 66

	)

796 
	#CRC32_BYTES
 4

	)

798 
	#MAX_WIRELESS_SIZE
 
WIRELESS_HEADER_OVERHEAD
 + 
HEADER_SIZE
 + 
MAXIMUM_PACKET_SIZE
 + 
CRC32_BYTES


	)

800 
	#INT_MAIN
 0x0100

	)

805 
	#DEVICE_VENDOR_REQUEST_OUT
 (
USB_DIR_OUT
 | 
USB_TYPE_VENDOR
 | 
USB_RECIP_DEVICE
)

806 
	#DEVICE_VENDOR_REQUEST_IN
 (
USB_DIR_IN
 | 
USB_TYPE_VENDOR
 | 
USB_RECIP_DEVICE
 )

807 
	#INTERFACE_VENDOR_REQUEST_OUT
 0x41

	)

808 
	#INTERFACE_VENDOR_REQUEST_IN
 0xc1

	)

811 
	#RETRY_LIMIT
 3

	)

813 
UCHAR
 
	tADDRESS
[
MAC_ADDRESS_LENGTH
];

815 #ifde‡
RALINK_ATE


816 
	#ATE_STASTOP
 0

817 
	#ATE_STASTART
 1

818 
	#ATE_TXCONT
 2

819 
	#ATE_TXCARR
 3

820 
	#ATE_TXFRAME
 4

821 
	#ATE_RXFRAME
 5

823 

	)

828 
	#RT73_USB_DEVICES
 { \

829 {
	`USB_DEVICE
(0x148f,0x2573)}, \

830 {
	`USB_DEVICE
(0x148f,0x2671)}, \

831 {
	`USB_DEVICE
(0x04bb,0x093d)}, \

832 {
	`USB_DEVICE
(0x18e8,0x6196)}, \

833 {
	`USB_DEVICE
(0x18e8,0x6229)}, \

834 {
	`USB_DEVICE
(0x18e8,0x6238)}, \

835 {
	`USB_DEVICE
(0x1044,0x8008)}, \

836 {
	`USB_DEVICE
(0x14b2,0x3c22)}, \

837 {
	`USB_DEVICE
(0x0db0,0x6877)}, \

838 {
	`USB_DEVICE
(0x0db0,0xa874)}, \

839 {
	`USB_DEVICE
(0x0db0,0xa861)}, \

840 {
	`USB_DEVICE
(0x07b8,0xb21d)}, \

841 {
	`USB_DEVICE
(0x0769,0x31f3)}, \

842 {
	`USB_DEVICE
(0x1472,0x0009)}, \

843 {
	`USB_DEVICE
(0x1371,0x9022)}, \

844 {
	`USB_DEVICE
(0x1371,0x9032)}, \

845 {
	`USB_DEVICE
(0x1631,0xc019)}, \

846 {
	`USB_DEVICE
(0x1044,0x800a)}, \

847 {
	`USB_DEVICE
(0x1690,0x0722)}, \

848 {
	`USB_DEVICE
(0x0df6,0x9712)}, \

849 {
	`USB_DEVICE
(0x0df6,0x90ac)}, \

850 {
	`USB_DEVICE
(0x148f,0x9021)}, \

851 {
	`USB_DEVICE
(0x0eb0,0x9021)}, \

852 {
	`USB_DEVICE
(0x0411,0x00D8)}, \

853 {
	`USB_DEVICE
(0x0586,0x3415)}, \

854 {
	`USB_DEVICE
(0x0b05,0x1723)}, \

855 {
	`USB_DEVICE
(0x0b05,0x1724)}, \

856 {
	`USB_DEVICE
(0x050d,0x705a)}, \

857 {
	`USB_DEVICE
(0x07d1,0x3c03)}, \

858 {
	`USB_DEVICE
(0x13b1,0x0023)}, \

859 {
	`USB_DEVICE
(0x13b1,0x0020)}, \

861 }

	)

	@rtmp_info.c

41 
	~"π_c⁄fig.h
"

42 
	~<√t/iw_h™dÀr.h
>

44 #ifde‡
DBG


45 
ULONG
 
RTDebugLevñ
;

48 #i‚de‡
IW_ESSID_MAX_SIZE


50 
	#IW_ESSID_MAX_SIZE
 32

	)

53 
UCHAR
 
CùhîW∑2Tem∂©e
[];

54 
UCHAR
 
CùhîW∑2Tem∂©eLí
;

55 
UCHAR
 
CùhîW∑PskTkù
[];

56 
UCHAR
 
CùhîW∑PskTkùLí
;

58 
	#NR_WEP_KEYS
 4

	)

63 
iw_¥iv_¨gs
 
	g¥ivèb
[] = {

64 { 
RTPRIV_IOCTL_SET
,

65 
IW_PRIV_TYPE_CHAR
 | 1024, 0,

67 { 
RTPRIV_IOCTL_SHOW
,

68 
IW_PRIV_TYPE_CHAR
 | 1024, 0,

70 #ifde‡
DBG


71 { 
RTPRIV_IOCTL_BBP
,

72 
IW_PRIV_TYPE_CHAR
 | 1024, IW_PRIV_TYPE_CHAR | 1024,

74 { 
RTPRIV_IOCTL_MAC
,

75 
IW_PRIV_TYPE_CHAR
 | 1024, IW_PRIV_TYPE_CHAR | 1024,

77 #ifde‡
RALINK_ATE


78 { 
RTPRIV_IOCTL_E2P
,

79 
IW_PRIV_TYPE_CHAR
 | 1024, IW_PRIV_TYPE_CHAR | 1024,

85 { 
RTPRIV_IOCTL_STATISTICS
,

86 
IW_PRIV_TYPE_CHAR
 | 1024, IW_PRIV_TYPE_CHAR | 1024,

88 { 
RTPRIV_IOCTL_GSITESURVEY
,

89 
IW_PRIV_TYPE_CHAR
 | 1024, IW_PRIV_TYPE_CHAR | 1024 ,

91 { 
RTPRIV_IOCTL_GETRAAPCFG
, 
IW_PRIV_TYPE_CHAR
 | 1024, 0,

94 { 
RTPRIV_IOCTL_AUTH
,

95 
IW_PRIV_TYPE_INT
 |1, 0,

97 { 
RTPRIV_IOCTL_WEPSTATUS
,

98 
IW_PRIV_TYPE_INT
 |1, 0,

100 { 
RTPRIV_IOCTL_WPAPSK
,

101 
IW_PRIV_TYPE_CHAR
 |64, 0,

103 { 
RTPRIV_IOCTL_PSM
,

104 
IW_PRIV_TYPE_INT
 |1, 0,

110 
CHAR
 *
	m«me
;

111 
INT
 (*
£t_¥oc
)(
PRTMP_ADAPTER
 
	mpAd≠ãr
, 
PUCHAR
 
	m¨g
);

112 } *
	gPRTMP_PRIVATE_SET_PROC
, 
	gRTMP_PRIVATE_SUPPORT_PROC
[] = {

113 {"Cou¡ryRegi⁄", 
Së_Cou¡ryRegi⁄_Proc
},

114 {"Cou¡ryRegi⁄AB™d", 
Së_Cou¡ryRegi⁄AB™d_Proc
},

115 {"SSID", 
Së_SSID_Proc
},

116 {"WúñessMode", 
Së_WúñessMode_Proc
},

117 {"TxR©e", 
Së_TxR©e_Proc
},

118 {"Ch™√l", 
Së_Ch™√l_Proc
},

119 {"BGPrŸe˘i⁄", 
Së_BGPrŸe˘i⁄_Proc
},

120 {"TxPªambÀ", 
Së_TxPªambÀ_Proc
},

121 {"RTSThªshﬁd", 
Së_RTSThªshﬁd_Proc
},

122 {"FøgThªshﬁd", 
Së_FøgThªshﬁd_Proc
},

123 {"TxBur°", 
Së_TxBur°_Proc
},

124 {"AdhocOfdm", 
Së_AdhocModeR©e_Proc
},

125 #ifde‡
AGGREGATION_SUPPORT


126 {"PktAggªg©e", 
Së_PktAggªg©e_Proc
},

128 {"TurboR©e", 
Së_TurboR©e_Proc
},

130 {"WmmC≠abÀ", 
Së_WmmC≠abÀ_Proc
},

132 {"IEEE80211H", 
Së_IEEE80211H_Proc
},

133 {"Nëw‹kTy≥", 
Së_Nëw‹kTy≥_Proc
},

134 {"AuthMode", 
Së_AuthMode_Proc
},

135 {"En¸ypTy≥", 
Së_En¸ypTy≥_Proc
},

136 {"DeÁu…KeyID", 
Së_DeÁu…KeyID_Proc
},

137 {"Key1", 
Së_Key1_Proc
},

138 {"Key2", 
Së_Key2_Proc
},

139 {"Key3", 
Së_Key3_Proc
},

140 {"Key4", 
Së_Key4_Proc
},

141 {"WPAPSK", 
Së_WPAPSK_Proc
},

142 {"Re£tCou¡î", 
Së_Re£tSètCou¡î_Proc
},

143 {"PSMode", 
Së_PSMode_Proc
},

144 {"TxQueSize", 
Së_TxQueSize_Proc
},

145 #ifde‡
DBG


146 {"Debug", 
Së_Debug_Proc
},

148 #ifde‡
RALINK_ATE


149 {"ATE", 
Së_ATE_Proc
},

150 {"ATEDA", 
Së_ATE_DA_Proc
},

151 {"ATESA", 
Së_ATE_SA_Proc
},

152 {"ATEBSSID", 
Së_ATE_BSSID_Proc
},

153 {"ATECHANNEL", 
Së_ATE_CHANNEL_Proc
},

154 {"ATETXPOW", 
Së_ATE_TX_POWER_Proc
},

155 {"ATETXFREQOFFSET", 
Së_ATE_TX_FREQOFFSET_Proc
},

156 {"ATETXLEN", 
Së_ATE_TX_LENGTH_Proc
},

157 {"ATETXCNT", 
Së_ATE_TX_COUNT_Proc
},

158 {"ATETXRATE", 
Së_ATE_TX_RATE_Proc
},

160 {
NULL
,}

164 
CHAR
 *
	m«me
;

165 
INT
 (*
£t_¥oc
)(
PRTMP_ADAPTER
 
	mpAd≠ãr
, 
PUCHAR
 
	m¨g
);

166 } *
	gPRTMP_PRIVATE_SHOW_PROC
, 
	gRTMP_PRIVATE_SHOW_SUPPORT_PROC
[] = {

167 {
NULL
,}

170 * 
	$π°rchr
(c⁄° * 
s
, 
c
)

172 ; *
s
 !(Ë
c
; ++s)

173 i‡(*
s
 == '\0')

174  
NULL
;

175  (*Ë
s
;

176 
	}
}

183 
	$π_io˘l_giw«me
(
√t_devi˚
 *
dev
,

184 
iw_ªque°_öfo
 *
öfo
,

185 *
«me
, *
exåa
)

187 
	`°∫˝y
(
«me
, "RT73 WLAN", 
IFNAMSIZ
);

189 
	}
}

191 
	$π_io˘l_siw‰eq
(
√t_devi˚
 *
dev
,

192 
iw_ªque°_öfo
 *
öfo
,

193 
iw_‰eq
 *
‰eq
, *
exåa
)

195 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTER)
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

196 
ch™
 = -1;

199 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

200  -
ENETDOWN
;

201 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

202  -
ENETDOWN
;

204 i‡(
‰eq
->
e
 > 1)

205  -
EINVAL
;

207 if((
‰eq
->
e
 =0Ë&& (‰eq->
m
 <= 1000))

208 
ch™
 = 
‰eq
->
m
;

210 
	`MAP_KHZ_TO_CHANNEL_ID
–(
‰eq
->
m
 /100Ë, 
ch™
);

211 
pAd≠ãr
->
P‹tCfg
.
Ch™√l
 = 
ch™
;

212 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==>π_io˘l_siw‰eq::SIOCSIWFREQ[cmd=0x%x] (Ch™√l=%d)\n", 
SIOCSIWFREQ
, 
pAd≠ãr
->
P‹tCfg
.
Ch™√l
);

216 
	}
}

219 
	$π_io˘l_giw‰eq
(
√t_devi˚
 *
dev
,

220 
iw_ªque°_öfo
 *
öfo
,

221 
iw_‰eq
 *
‰eq
, *
exåa
)

223 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

224 
ULONG
 
m
;

225 
UCHAR
 
ch™√l
;

227 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

228  -
ENETDOWN
;

230 
ch™√l
 = 
pAd≠ãr
->
P‹tCfg
.
Ch™√l
;

232 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"==>π_io˘l_giw‰eq %d\n",
pAd≠ãr
->
P‹tCfg
.
Ch™√l
);

234 
	`MAP_CHANNEL_ID_TO_KHZ
(
pAd≠ãr
->
P‹tCfg
.
Ch™√l
, 
m
);

235 
‰eq
->
m
 = m * 100;

236 
‰eq
->
e
 = 1;

239 
	}
}

242 
	$π_io˘l_siwmode
(
√t_devi˚
 *
dev
,

243 
iw_ªque°_öfo
 *
öfo
,

244 
__u32
 *
mode
, *
exåa
)

246 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

249 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

250  -
ENETDOWN
;

251 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

252  -
ENETDOWN
;

255 *
mode
)

257 
IW_MODE_ADHOC
:

258 i‡(
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 !
BSS_ADHOC
)

261 i‡(
	`INFRA_ON
(
pAd≠ãr
))

263 
	`RTUSBEnqueueI¡î«lCmd
(
pAd≠ãr
, 
RT_OID_LINK_DOWN
);

265 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "NDIS_STATUS_MEDIA_DISCONNECT Event BB!\n");

269 
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 = 
BSS_ADHOC
;

270 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "===>rt_ioctl_siwmode::SIOCSIWMODE (AD-HOC)\n");

272 
IW_MODE_INFRA
:

273 i‡(
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 !
BSS_INFRA
)

276 i‡(
	`ADHOC_ON
(
pAd≠ãr
))

277 
	`RTUSBEnqueueI¡î«lCmd
(
pAd≠ãr
, 
RT_OID_LINK_DOWN
);

279 
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 = 
BSS_INFRA
;

280 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "===>rt_ioctl_siwmode::SIOCSIWMODE (INFRA)\n");

283 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "===>rt_ioctl_siwmode::SIOCSIWMODE (unknown)\n");

284  -
EINVAL
;

288 
pAd≠ãr
->
P‹tCfg
.
W∑Sèã
 = 
SS_NOTUSE
;

291 
	}
}

294 
	$π_io˘l_giwmode
(
√t_devi˚
 *
dev
,

295 
iw_ªque°_öfo
 *
öfo
,

296 
__u32
 *
mode
, *
exåa
)

298 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

301 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

302  -
ENETDOWN
;

304 i‡(
	`ADHOC_ON
(
pAd≠ãr
))

305 *
mode
 = 
IW_MODE_ADHOC
;

306 i‡(
	`INFRA_ON
(
pAd≠ãr
))

307 *
mode
 = 
IW_MODE_INFRA
;

309 *
mode
 = 
IW_MODE_AUTO
;

311 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"==>rt_ioctl_giwmode\n");

313 
	}
}

315 
	$π_io˘l_siw£ns
(
√t_devi˚
 *
dev
,

316 
iw_ªque°_öfo
 *
öfo
,

317 *
«me
, *
exåa
)

319 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

322 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

323  -
ENETDOWN
;

324 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

325  -
ENETDOWN
;

328 
	}
}

330 
	$π_io˘l_giw£ns
(
√t_devi˚
 *
dev
,

331 
iw_ªque°_öfo
 *
öfo
,

332 *
«me
, *
exåa
)

334 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

336 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

337  -
ENETDOWN
;

340 
	}
}

342 
	$π_io˘l_giwønge
(
√t_devi˚
 *
dev
,

343 
iw_ªque°_öfo
 *
öfo
,

344 
iw_poöt
 *
d©a
, *
exåa
)

346 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

347 
iw_ønge
 *
ønge
 = (iw_øngê*Ë
exåa
;

348 
u16
 
vÆ
;

349 
i
;

351 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

352  -
ENETDOWN
;

354 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"===>rt_ioctl_giwrange\n");

355 
d©a
->
Àngth
 = (
iw_ønge
);

356 
	`mem£t
(
ønge
, 0, (
iw_ønge
));

369 #i‡
WIRELESS_EXT
 > 17

371 
ønge
->
evít_ˇ∑
[0] = (
IW_EVENT_CAPA_K_0
 |

372 
	`IW_EVENT_CAPA_MASK
(
SIOCGIWAP
) |

373 
	`IW_EVENT_CAPA_MASK
(
SIOCGIWSCAN
));

374 
ønge
->
evít_ˇ∑
[1] = 
IW_EVENT_CAPA_K_1
;

378 
ønge
->
£nsôivôy
 = 3;

381 
ønge
->
max_quÆ
.
quÆ
 = 100;

384 
ønge
->
max_quÆ
.
Àvñ
 = 0;

385 
ønge
->
max_quÆ
.
noi£
 = 0;

388 
ønge
->
avg_quÆ
.
quÆ
 = 20;

389 
ønge
->
avg_quÆ
.
Àvñ
 = -60;

390 
ønge
->
avg_quÆ
.
noi£
 = -95;

394 i‡(
	`INFRA_ON
(
pAd≠ãr
)||
	`ADHOC_ON
(pAdapter))

396 
UCHAR
 
ÆlR©eLí
, 
SupR©eLí
;

397 
SupR©eLí
 = 
pAd≠ãr
->
A˘iveCfg
.SupRateLen;

398 
ÆlR©eLí
 = 
SupR©eLí
 + 
pAd≠ãr
->
A˘iveCfg
.
ExtR©eLí
;

400 
ønge
->
num_bôøãs
 = (
ÆlR©eLí
 > 
IW_MAX_BITRATES
 ? IW_MAX_BITRATES :állRateLen);

401 
i
 = 0; i < 
ønge
->
num_bôøãs
; i++)

403 i‡(
i
 < 
SupR©eLí
)

404 
ønge
->
bôøã
[
i
] = (
pAd≠ãr
->
A˘iveCfg
.
SupR©e
[i] & 0x7F) * 500000;

406 
ønge
->
bôøã
[
i
] = (
pAd≠ãr
->
A˘iveCfg
.
ExtR©e
[i-
SupR©eLí
] & 0x7F) * 500000;

416 
ønge
->
mö_πs
 = 0;

417 
ønge
->
max_πs
 = 2347;

420 
ønge
->
mö_‰ag
 = 256;

421 
ønge
->
max_‰ag
 = 2346;

424 i‡(
	`INFRA_ON
(
pAd≠ãr
)||
	`ADHOC_ON
(pAdapter))

426 
ønge
->
mö_pmp
 = 1 * 1024;

427 
ønge
->
max_pmp
 = 65535 * 1024;

428 
ønge
->
mö_pmt
 = 1 * 1024;

429 
ønge
->
max_pmt
 = 1000 * 1024;

430 
ønge
->
pmp_Êags
 = 
IW_POWER_PERIOD
;

431 
ønge
->
pmt_Êags
 = 
IW_POWER_TIMEOUT
;

432 
ønge
->
pm_ˇ∑
 = 
IW_POWER_PERIOD
 | 
IW_POWER_TIMEOUT
 |

433 
IW_POWER_UNICAST_R
 | 
IW_POWER_ALL_R
;

437 
ønge
->
max_ícodög_tokís
 = 
NR_WEP_KEYS
;

438 
ønge
->
num_ícodög_sizes
 = 2;

439 
ønge
->
ícodög_size
[0] = 5;

440 
ønge
->
ícodög_size
[1] = 13;

444 
ønge
->
txpowî_ˇ∑
 = 
IW_TXPOW_DBM
;

449 
ønge
->
we_vîsi⁄_compûed
 = 
WIRELESS_EXT
;

450 
ønge
->
we_vîsi⁄_sour˚
 = 14;

453 
ønge
->
ªåy_ˇ∑
 = 
IW_RETRY_LIMIT
;

454 
ønge
->
ªåy_Êags
 = 
IW_RETRY_LIMIT
;

456 
ønge
->
mö_ªåy
 = 0;

457 
ønge
->
max_ªåy
 = 255;

462 
ønge
->
num_ch™√ls
 = 
pAd≠ãr
->
Ch™√lLi°Num
;

467 
vÆ
 = 0, 
i
 = 1; i <
ønge
->
num_ch™√ls
; i++) {

468 
u32
 
m
;

469 
ønge
->
‰eq
[
vÆ
].
i
 = 
pAd≠ãr
->
Ch™√lLi°
[i-1].
Ch™√l
;

470 
	`MAP_CHANNEL_ID_TO_KHZ
(
pAd≠ãr
->
Ch™√lLi°
[
i
-1].
Ch™√l
, 
m
);

471 
ønge
->
‰eq
[
vÆ
].
m
 = m * 100;

473 
ønge
->
‰eq
[
vÆ
].
e
 = 1;

474 
vÆ
++;

475 i‡(
vÆ
 =
IW_MAX_FREQUENCIES
)

478 
ønge
->
num_‰equícy
 = 
vÆ
;

480 #i‡
WIRELESS_EXT
 > 17

482 
ønge
->
íc_ˇ∑
 = 
IW_ENC_CAPA_WPA
 | 
IW_ENC_CAPA_WPA2
 |

483 
IW_ENC_CAPA_CIPHER_TKIP
 | 
IW_ENC_CAPA_CIPHER_CCMP
;

488 
ovî2
 = 0;

489 
Àn
 = 
	`¥ism2_gë_d©¨©es
(
dev
, 
øãs
);

490 
ønge
->
num_bôøãs
 = 0;

491 
i
 = 0; i < 
Àn
; i++) {

492 i‡(
ønge
->
num_bôøãs
 < 
IW_MAX_BITRATES
) {

493 
ønge
->
bôøã
[ønge->
num_bôøãs
] =

494 
øãs
[
i
] * 500000;

495 
ønge
->
num_bôøãs
++;

497 i‡(
øãs
[
i
] == 0x0b ||Ñates[i] == 0x16)

498 
ovî2
 = 1;

501 
ønge
->
throughput
 = 
ovî2
 ? 5500000 : 1500000;

505 
	}
}

509 
	$π_io˘l_siw≠
(
√t_devi˚
 *
dev
,

510 
iw_ªque°_öfo
 *
öfo
,

511 
iwªq_d©a
 *
wrqu
, *
exåa
)

513 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

514 
UCHAR
 
Bssid
[
MAC_ADDR_LEN
];

517 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

518  -
ENETDOWN
;

519 i‡(
pAd
->
RTUSBCmdThr_pid
 < 0)

520  -
ENETDOWN
;

522 i‡(
wrqu
->
≠_addr
.
ß_Ámûy
 !
ARPHRD_ETHER
)

523  -
EINVAL
;

525 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


526 #i‡
WIRELESS_EXT
 > 17

527 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

529 i‡(
pAd
->
P‹tCfg
.
wx_√ed_sync
){

530 
	`wext2Rtmp_Securôy_Wøµî
(
pAd
);

531 
pAd
->
P‹tCfg
.
wx_√ed_sync
 = 0;

537 
	`NdisMoveMem‹y
(&
Bssid
[0], 
wrqu
->
≠_addr
.
ß_d©a
, 
MAC_ADDR_LEN
);

538 i‡(
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 !
CNTL_IDLE
)

540 
	`MlmeEnqueue
(
pAd
,

541 
MLME_CNTL_STATE_MACHINE
,

542 
RT_CMD_RESET_MLME
,

544 
NULL
);

547 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


548 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

550 i‡(
	`NdisEquÆMem‹y
(
wrqu
->
≠_addr
.
ß_d©a
, "\x00\x00\x00\x00\x00\x00", 
MAC_ADDR_LEN
))

552 i‡(
	`INFRA_ON
(
pAd
))

554 
MLME_DISASSOC_REQ_STRUCT
 
DißssocReq
;

556 
pAd
->
MlmeAux
.
CuºReqIsFromNdis
 = 
TRUE
;

558 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CNTL - disassociate with current AP...\n");

559 
	`DißssocP¨mFûl
(
pAd
, &
DißssocReq
,ÖAd->
P‹tCfg
.
Bssid
, 
REASON_DISASSOC_STA_LEAVING
);

560 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_MLME_DISASSOC_REQ
,

561 (
MLME_DISASSOC_REQ_STRUCT
), &
DißssocReq
);

562 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_DISASSOC
;

569 
	`MlmeEnqueue
(
pAd
,

570 
MLME_CNTL_STATE_MACHINE
,

571 
OID_802_11_BSSID
,

572 (
NDIS_802_11_MAC_ADDRESS
),

573 (
VOID
 *)&
Bssid
);

574 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s():IOCTL::SIOCSIWAP %02x:%02x:%02x:%02x:%02x:%02x\n",

575 
__FUNCTION__
, 
Bssid
[0], Bssid[1], Bssid[2], Bssid[3], Bssid[4], Bssid[5]);

578 
	`RTUSBMlmeUp
(
pAd
);

582 
	}
}

586 
	$π_io˘l_giw≠
(
√t_devi˚
 *
dev
,

587 
iw_ªque°_öfo
 *
öfo
,

588 
iwªq_d©a
 *
wrqu
, *
exåa
)

591 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

593 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

594  -
ENETDOWN
;

596 i‡(
	`INFRA_ON
(
pAd≠ãr
Ë|| 
	`ADHOC_ON
(pAdapter))

598 
wrqu
->
≠_addr
.
ß_Ámûy
 = 
ARPHRD_ETHER
;

599 
	`mem˝y
(
wrqu
->
≠_addr
.
ß_d©a
, &
pAd≠ãr
->
P‹tCfg
.
Bssid
, 
ETH_ALEN
);

603 
	`mem£t
(
wrqu
->
≠_addr
.
ß_d©a
, 0, 
ETH_ALEN
);

604 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "rt_ioctl_giwap():SIOCGIWAP(=EMPTY)\n");

605  -
ENOTCONN
;

609 
	}
}

627 
	$£t_quÆôy
(
PRTMP_ADAPTER
 
pAd≠ãr
,

628 
iw_quÆôy
 *
iq
,

629 
u_öt
 
rssi
)

631 
u32
 
Ch™√lQuÆôy
, 
N‹Rssi
;

635 i‡(
rssi
 > 0x50)

636 
N‹Rssi
 = 100;

637 i‡(
rssi
 < 0x20)

638 
N‹Rssi
 = 0;

640 
N‹Rssi
 = (
rssi
 - 0x20) * 2;

643 
Ch™√lQuÆôy
 = (
RSSI_WEIGHTING
 * 
N‹Rssi
 +

644 
TX_WEIGHTING
 * (100 - 0) +

645 
RX_WEIGHTING
* (100 - 0)) / 100;

647 i‡(
Ch™√lQuÆôy
 >= 100)

648 
Ch™√lQuÆôy
 = 100;

650 
iq
->
quÆ
 = 
Ch™√lQuÆôy
;

652 #ifde‡
RTMP_EMBEDDED


653 
iq
->
Àvñ
 = 
	`π_abs
(
rssi
);

655 
iq
->
Àvñ
 = 
	`abs
(
rssi
);

657 
iq
->
Àvñ
 +256 - 
pAd≠ãr
->
BbpRssiToDbmDñè
;

658 
iq
->
noi£
 = (
pAd≠ãr
->
BbpWrôeL©ch
[17] >ÖAd≠ãr->
BbpTunög
.
R17UµîBoundG
Ë?ÖAd≠ãr->BbpTunög.R17UµîBoundG : ((
ULONG
)ÖAdapter->BbpWriteLatch[17]);

659 
iq
->
noi£
 += 256 - 143;

660 
iq
->
upd©ed
 = 
pAd≠ãr
->
iw_°©s
.
quÆ
.updated;

662 
	}
}

664 
	$π_io˘l_iw≠li°
(
√t_devi˚
 *
dev
,

665 
iw_ªque°_öfo
 *
öfo
,

666 
iw_poöt
 *
d©a
, *
exåa
)

669 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

670 
sockaddr
 
addr
[
IW_MAX_AP
];

671 
iw_quÆôy
 
quÆ
[
IW_MAX_AP
];

672 
i
;

674 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

675  -
ENETDOWN
;

677 
i
 = 0; i <
IW_MAX_AP
 ; i++)

679 i‡(
i
 >
pAd≠ãr
->
SˇnTab
.
BssNr
)

681 
addr
[
i
].
ß_Ámûy
 = 
ARPHRD_ETHER
;

682 
	`mem˝y
(
addr
[
i
].
ß_d©a
, &
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[i].
Bssid
, 
MAC_ADDR_LEN
);

683 
	`£t_quÆôy
(
pAd≠ãr
, &
quÆ
[
i
],ÖAd≠ãr->
SˇnTab
.
BssE¡ry
[i].
Rssi
);

685 
d©a
->
Àngth
 = 
i
;

686 
	`mem˝y
(
exåa
, &
addr
, 
i
*(addr[0]));

687 
d©a
->
Êags
 = 1;

688 
	`mem˝y
(
exåa
 + 
i
*(
addr
[0]), &
quÆ
, i*(qual[i]));

691 
	}
}

693 #ifde‡
SIOCGIWSCAN


694 
	$π_io˘l_siwsˇn
(
√t_devi˚
 *
dev
,

695 
iw_ªque°_öfo
 *
öfo
,

696 
iwªq_d©a
 *
wrqu
, *
exåa
)

698 
ULONG
 
Now
;

699 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

700 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

704 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

705  -
ENETDOWN
;

707 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

708  -
ENETDOWN
;

710 i‡(
	`RTMP_TEST_FLAG
(
pAd≠ãr
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
))

714 
Now
 = 
jiffõs
;

716 i‡((
	`OPSTATUS_TEST_FLAG
(
pAd≠ãr
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
)) &&

717 ((
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA
) ||

718 (
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAPSK
) ||

719 (
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2
) ||

720 (
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2PSK
)) &&

721 (
pAd≠ãr
->
P‹tCfg
.
P‹tSecuªd
 =
WPA_802_1X_PORT_NOT_SECURED
)

724 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "!!! Link UP, Port Not Secured! ignoreÅhis set::OID_802_11_BSSID_LIST_SCAN\n");

725 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

729 i‡(
pAd≠ãr
->
Mlme
.
C¡lMachöe
.
CuºSèã
 !
CNTL_IDLE
 && (pAd≠ãr->
MLMEThr_pid
 > 0))

731 
	`MlmeEnqueue
(
pAd≠ãr
,

732 
MLME_CNTL_STATE_MACHINE
,

733 
RT_CMD_RESET_MLME
,

735 
NULL
);

739 
pAd≠ãr
->
P‹tCfg
.
SˇnC¡
 = 0;

740 
pAd≠ãr
->
P‹tCfg
.
La°SˇnTime
 = 
Now
;

742 
	`MlmeEnqueue
(
pAd≠ãr
,

743 
MLME_CNTL_STATE_MACHINE
,

744 
OID_802_11_BSSID_LIST_SCAN
,

746 
NULL
);

747 
	`RTUSBMlmeUp
(
pAd≠ãr
);

749 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

754 
	}
}

756 
	#MAX_CUSTOM_LEN
 64

	)

758 
	$π_io˘l_giwsˇn
(
√t_devi˚
 *
dev
,

759 
iw_ªque°_öfo
 *
öfo
,

760 
iwªq_d©a
 *
wrqu
, *
exåa
)

763 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

764 
i
=2, 
j
;

765 *
cuºít_ev
 = 
exåa
, *
¥evious_ev
 =Éxtra;

766 
iw_evít
 
iwe
;

767 
BSS_ENTRY
 *
pBssE¡ry
;

768 #i‡
WIRELESS_EXT
 >= 17

769 *
íd_buf
 = (*)(
exåa
 + 
wrqu
->
d©a
.
Àngth
);

771 *
íd_buf
 = 
exåa
 + 
IW_SCAN_MAX_DATA
;

774 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


775 *
p
;

776 *
pExtR©e
, *
pSupR©e
;

777 
øã
;

778 
k
;

779 
cu°om
[
MAX_CUSTOM_LEN
];

785 *
cuºít_vÆ
;

787 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

788  -
ENETDOWN
;

790 i‡(
	`RTMP_TEST_FLAG
(
pAd≠ãr
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
)){

794  -
EAGAIN
;

797 i‡(
pAd≠ãr
->
SˇnTab
.
BssNr
 == 0)

798  -
EAGAIN
;

799 
i
 = 0; i < 
pAd≠ãr
->
SˇnTab
.
BssNr
; i++)

801 i‡(
cuºít_ev
 >
íd_buf
)

804 
pBssE¡ry
 = (
BSS_ENTRY
 *)&
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
];

807 
	`mem£t
(&
iwe
, 0, (iwe));

808 
iwe
.
cmd
 = 
SIOCGIWAP
;

809 
iwe
.
u
.
≠_addr
.
ß_Ámûy
 = 
ARPHRD_ETHER
;

810 
	`mem˝y
(
iwe
.
u
.
≠_addr
.
ß_d©a
, 
pBssE¡ry
->
Bssid
, 
ETH_ALEN
);

812 
¥evious_ev
 = 
cuºít_ev
;

813 
cuºít_ev
 = 
	`IWE_STREAM_ADD_EVENT
(
öfo
,cuºít_ev, 
íd_buf
, &
iwe
, 
IW_EV_ADDR_LEN
);

814 i‡(
cuºít_ev
 =
¥evious_ev
)

819 
	`mem£t
(&
iwe
, 0, (iwe));

820 
iwe
.
cmd
 = 
SIOCGIWMODE
;

821 i‡(
pBssE¡ry
->
BssTy≥
 =
Ndis802_11IBSS
)

822 
iwe
.
u
.
mode
 = 
IW_MODE_ADHOC
;

823 i‡(
pBssE¡ry
->
BssTy≥
 =
Ndis802_11In‰a°ru˘uª
)

824 
iwe
.
u
.
mode
 = 
IW_MODE_INFRA
;

826 
iwe
.
u
.
mode
 = 
IW_MODE_AUTO
;

827 
iwe
.
Àn
 = 
IW_EV_UINT_LEN
;

829 
¥evious_ev
 = 
cuºít_ev
;

830 
cuºít_ev
 = 
	`IWE_STREAM_ADD_EVENT
(
öfo
,cuºít_ev, 
íd_buf
, &
iwe
, 
IW_EV_UINT_LEN
);

831 i‡(
cuºít_ev
 =
¥evious_ev
)

836 
	`mem£t
(&
iwe
, 0, (iwe));

837 
iwe
.
cmd
 = 
SIOCGIWESSID
;

838 
iwe
.
u
.
d©a
.
Àngth
 = 
pBssE¡ry
->
SsidLí
;

839 
iwe
.
u
.
d©a
.
Êags
 = 1;

841 
¥evious_ev
 = 
cuºít_ev
;

842 
cuºít_ev
 = 
	`IWE_STREAM_ADD_POINT
(
öfo
,cuºít_ev,
íd_buf
, &
iwe
, 
pBssE¡ry
->
Ssid
);

843 i‡(
cuºít_ev
 =
¥evious_ev
)

848 
	`mem£t
(&
iwe
, 0, (iwe));

849 
iwe
.
cmd
 = 
SIOCGIWFREQ
;

850 
iwe
.
u
.
‰eq
.
m
 = 
pBssE¡ry
->
Ch™√l
;

851 
iwe
.
u
.
‰eq
.
e
 = 0;

852 
iwe
.
u
.
‰eq
.
i
 = 0;

854 
¥evious_ev
 = 
cuºít_ev
;

855 
cuºít_ev
 = 
	`IWE_STREAM_ADD_EVENT
(
öfo
,cuºít_ev,
íd_buf
, &
iwe
, 
IW_EV_FREQ_LEN
);

856 i‡(
cuºít_ev
 =
¥evious_ev
)

861 
	`mem£t
(&
iwe
, 0, (iwe));

862 
iwe
.
cmd
 = 
SIOCGIWENCODE
;

863 i‡(
	`CAP_IS_PRIVACY_ON
 (
pBssE¡ry
->
C≠abûôyInfo
 ))

864 
iwe
.
u
.
d©a
.
Êags
 = 
IW_ENCODE_ENABLED
 | 
IW_ENCODE_NOKEY
;

866 
iwe
.
u
.
d©a
.
Êags
 = 
IW_ENCODE_DISABLED
;

867 
iwe
.
u
.
d©a
.
Àngth
 = 0;

869 
¥evious_ev
 = 
cuºít_ev
;

870 
cuºít_ev
 = 
	`IWE_STREAM_ADD_POINT
(
öfo
,cuºít_ev, 
íd_buf
, &
iwe
,

871 (*)
pAd≠ãr
->
Sh¨edKey
[pAd≠ãr->
P‹tCfg
.
DeÁu…KeyId
].
Key
);

872 i‡(
cuºít_ev
 =
¥evious_ev
)

875 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


876 i‡(
pAd≠ãr
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

880 
	`mem£t
(&
iwe
, 0, (iwe));

881 
iwe
.
cmd
 = 
SIOCGIWRATE
;

882 
iwe
.
u
.
bôøã
.
fixed
 = 0;

883 
iwe
.
u
.
bôøã
.
dißbÀd
 = 0;

885 
pSupR©e
 = (*)&
pBssE¡ry
->
SupR©e
[0];

886 
pExtR©e
 = (*)&
pBssE¡ry
->
ExtR©e
[0];

887 
p
 = 
cuºít_ev
;

888 
cuºít_ev
 = 
p
 + 
IW_EV_LCP_LEN
;

889 
k
 = 0, 
j
 = 0; k < 
pBssE¡ry
->
SupR©eLí
; )

891 i‡(
j
 < 
pBssE¡ry
->
ExtR©eLí
 &&

892 ((
pExtR©e
[
j
] & 0x7FË< (
pSupR©e
[
k
] & 0x7F)))

893 
øã
 = 
pExtR©e
[
j
++] & 0x7F;

895 
øã
 = 
pSupR©e
[
k
++] & 0x7F;

896 
iwe
.
u
.
bôøã
.
vÆue
 = 
øã
 * 500000;

898 
¥evious_ev
 = 
cuºít_ev
;

899 
cuºít_ev
 = 
	`IWE_STREAM_ADD_VALUE
(
öfo
,
p
, cuºít_ev, 
íd_buf
, &
iwe
, 
IW_EV_PARAM_LEN
);

900 i‡(
cuºít_ev
 =
¥evious_ev
)

901 
fuŒ
;

903 ; 
j
 < 
pBssE¡ry
->
ExtR©eLí
; j++)

905 
øã
 = (
pExtR©e
[
j
] & 0x7F);

906 
iwe
.
u
.
bôøã
.
vÆue
 = 
øã
 * 500000;

908 
¥evious_ev
 = 
cuºít_ev
;

909 
cuºít_ev
 = 
	`IWE_STREAM_ADD_VALUE
(
öfo
,
p
, cuºít_ev, 
íd_buf
, &
iwe
, 
IW_EV_PARAM_LEN
);

910 i‡(
cuºít_ev
 =
¥evious_ev
)

911 
fuŒ
;

917 
	`mem£t
(&
iwe
, 0, (iwe));

918 
iwe
.
cmd
 = 
IWEVQUAL
;

919 
	`£t_quÆôy
(
pAd≠ãr
, &
iwe
.
u
.
quÆ
, 
pBssE¡ry
->
Rssi
);

921 
¥evious_ev
 = 
cuºít_ev
;

922 
cuºít_ev
 = 
	`IWE_STREAM_ADD_EVENT
(
öfo
,cuºít_ev, 
íd_buf
, &
iwe
, 
IW_EV_QUAL_LEN
);

923 i‡(
cuºít_ev
 =
¥evious_ev
)

929 i‡(
pBssE¡ry
->
V¨IELí
 > 0)

931 
EID_STRUCT
 *
pEid
;

932 
UCHAR
 *
pEnd
;

933 
EIDLí
, 
isWPA
, 
isRSN
;

935 
pEid
 = (
PEID_STRUCT
)(&
pBssE¡ry
->
V¨IEs
[0]);

936 
pEnd
 = (
UCHAR
 *)(&
pBssE¡ry
->
V¨IEs
[0] +ÖBssE¡ry->
V¨IELí
);

938  (((
UCHAR
 *)
pEid
Ë+ (
EID_STRUCT
)Ë<
pEnd
)

940 
EIDLí
 = 2 + 
pEid
->
Lí
;

941 i‡((((
UCHAR
 *)
pEid
Ë+ 
EIDLí
Ë> 
pEnd
)

944 
isWPA
 = 
isRSN
 = 0;

945 
pEid
->
Eid
)

947 
IE_WPA
:

948 
isWPA
 = 
	`NdisEquÆMem‹y
(
pEid
->
O˘ë
, 
WPA_OUI
, 4);

950 
IE_WPA2
:

951 
isRSN
 = 
	`RTMPEquÆMem‹y
(
pEid
->
O˘ë
 + 2, 
RSN_OUI
, 3);

956 i‡(
isWPA
 | 
isRSN
)

958 
	`mem£t
(&
iwe
, 0, (iwe));

959 
	`mem£t
(
cu°om
, 0, (custom));

960 #i‡
WIRELESS_EXT
 > 17

961 
iwe
.
cmd
 = 
IWEVGENIE
;

962 
iwe
.
u
.
d©a
.
Àngth
 = 
EIDLí
;

963 
	`NdisMoveMem‹y
(
cu°om
, 
pEid
, 
EIDLí
);

965 
iwe
.
cmd
 = 
IWEVCUSTOM
;

966 
iwe
.
u
.
d©a
.
Àngth
 = 7 + 
EIDLí
;

967 i‡(
isWPA
)

968 
	`NdisMoveMem‹y
(
cu°om
, "wpa_ie=", 7);

969 i‡(
isRSN
)

970 
	`NdisMoveMem‹y
(
cu°om
, "rsn_ie=", 7);

971 
	`NdisMoveMem‹y
(&
cu°om
[7], 
pEid
, 
EIDLí
);

973 
¥evious_ev
 = 
cuºít_ev
;

974 
cuºít_ev
 = 
	`IWE_STREAM_ADD_POINT
(
öfo
,cuºít_ev, 
íd_buf
, &
iwe
, 
cu°om
);

975 i‡(
cuºít_ev
 =
¥evious_ev
)

976 
fuŒ
;

978 
pEid
 +(2 +ÖEid->
Lí
);

989 
	`mem£t
(&
iwe
, 0, (iwe));

990 
iwe
.
cmd
 = 
SIOCGIWRATE
;

991 
cuºít_vÆ
 = 
cuºít_ev
 + 
IW_EV_LCP_LEN
;

993 
j
 = 0; j < 1;j++)

995 
iwe
.
u
.
bôøã
.
vÆue
 = 
R©eIdToMbps
[
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
SupR©e
[i]/2] * 1000000;

996 
iwe
.
u
.
bôøã
.
dißbÀd
 = 0;

997 
cuºít_vÆ
 = 
	`IWE_STREAM_ADD_VALUE
(
öfo
,
cuºít_ev
,

998 
cuºít_vÆ
, 
íd_buf
, &
iwe
,

999 
IW_EV_PARAM_LEN
);

1003 if((
cuºít_vÆ
-
cuºít_ev
)>
IW_EV_LCP_LEN
)

1004 
cuºít_ev
 = 
cuºít_vÆ
;

1013 
	`mem£t
(&
iwe
, 0, (iwe));

1014 
iwe
.
cmd
 = 
SIOCGIWRATE
;

1015 
cuºít_vÆ
 = 
cuºít_ev
 + 
IW_EV_LCP_LEN
;

1017 
SupR©eLí
 = 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].SupRateLen;

1018 
ExtR©eLí
 = 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].ExtRateLen;

1020 
max_øã
 = 0;

1021 
p
 = 
cu°om
;

1022 
p
 +
	`¢¥ötf
’, 
MAX_CUSTOM_LEN
 - (∞- 
cu°om
), " Rates (Mb/s): ");

1023 
k
 = 0, 
j
 = 0; k < 
SupR©eLí
; )

1025 i‡(
j
 < 
ExtR©eLí
 &&

1026 ((
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
ExtR©e
[
j
] & 0x7F) <

1027 (
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
SupR©e
[
k
] & 0x7F)))

1029 
øã
 = 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
ExtR©e
[
j
++] & 0x7F;

1033 
øã
 = 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
SupR©e
[
k
++] & 0x7F;

1036 i‡(
øã
 > 
max_øã
)

1037 
max_øã
 = 
øã
;

1038 
p
 +
	`¢¥ötf
’, 
MAX_CUSTOM_LEN
 - (∞- 
cu°om
),

1039 "%d%†", 
øã
 >> 1, (rate & 1) ? ".5" : "");

1042 ; 
j
 < 
ExtR©eLí
; j++)

1044 
øã
 = 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
ExtR©e
[
j
] & 0x7F;

1045 
p
 +
	`¢¥ötf
’, 
MAX_CUSTOM_LEN
 - (∞- 
cu°om
),

1046 "%d%†", 
øã
 >> 1, (rate & 1) ? ".5" : "");

1047 i‡(
øã
 > 
max_øã
)

1048 
max_øã
 = 
øã
;

1050 
iwe
.
u
.
bôøã
.
vÆue
 = 
max_øã
 * 500000;

1051 
iwe
.
u
.
bôøã
.
dißbÀd
 = 0;

1052 
cuºít_vÆ
 = 
	`iwe_°ªam_add_vÆue
(
cuºít_ev
,

1053 
cuºít_vÆ
, 
íd_buf
, &
iwe
,

1054 
IW_EV_PARAM_LEN
);

1055 if((
cuºít_vÆ
-
cuºít_ev
)>
IW_EV_LCP_LEN
)

1056 
cuºít_ev
 = 
cuºít_vÆ
;

1062 
	`mem£t
(&
iwe
, 0, (iwe));

1063 
iwe
.
cmd
 = 
IWEVCUSTOM
;

1064 
iwe
.
u
.
d©a
.
Àngth
 = 
p
 - 
cu°om
;

1065 i‡(
iwe
.
u
.
d©a
.
Àngth
)

1067 
¥evious_ev
 = 
cuºít_ev
;

1068 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt
(cuºít_ev, 
íd_buf
, &
iwe
, 
cu°om
);

1069 i‡(
cuºít_ev
 =
¥evious_ev
)

1075 
	`mem£t
(&
iwe
, 0, (iwe));

1076 
iwe
.
cmd
 = 
IWEVQUAL
;

1077 
	`£t_quÆôy
(
pAd≠ãr
, &
iwe
.
u
.
quÆ
,ÖAd≠ãr->
SˇnTab
.
BssE¡ry
[
i
].
Rssi
);

1079 
¥evious_ev
 = 
cuºít_ev
;

1080 
cuºít_ev
 = 
	`iwe_°ªam_add_evít
(cuºít_ev, 
íd_buf
, &
iwe
, 
IW_EV_QUAL_LEN
);

1081 i‡(
cuºít_ev
 =
¥evious_ev
)

1086 
	`mem£t
(&
iwe
, 0, (iwe));

1087 
iwe
.
cmd
 = 
IWEVCUSTOM
;

1088 
p
 = 
cu°om
;

1089 
p
 +
	`¢¥ötf
’, 
MAX_CUSTOM_LEN
 - (∞- 
cu°om
),

1090 " La° bóc⁄: %lum†ago", (
jiffõs
 - 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
La°Bóc⁄RxTime
Ë/ (
HZ
 / 100));

1091 
iwe
.
u
.
d©a
.
Àngth
 = 
p
 - 
cu°om
;

1092 i‡(
iwe
.
u
.
d©a
.
Àngth
)

1094 
¥evious_ev
 = 
cuºít_ev
;

1095 
cuºít_ev
 = 
	`iwe_°ªam_add_poöt
(cuºít_ev, 
íd_buf
, &
iwe
, 
cu°om
);

1096 i‡(
cuºít_ev
 =
¥evious_ev
)

1100 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


1103 
	`mem£t
(&
iwe
, 0, (iwe));

1107 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


1108 
fuŒ
:

1110 #i‡
WIRELESS_EXT
 >= 17

1111 i‡(
pAd≠ãr
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

1113 i‡(
cuºít_ev
 > 
íd_buf
 || (cuºít_ev =
¥evious_ev
))

1115 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"===>rt_ioctl_giwscan(-E2BIG). Require more buffer size!\n");

1116  -
E2BIG
;

1121 
wrqu
->
d©a
.
Àngth
 = 
cuºít_ev
 - 
exåa
;

1122 
wrqu
->
d©a
.
Êags
 = 0;

1124 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"===>π_io˘l_giwsˇn. %d(%dËBSSÑëu∫ed\n",
i
 , 
pAd≠ãr
->
SˇnTab
.
BssNr
);

1126 
	}
}

1129 
	$π_io˘l_siwessid
(
√t_devi˚
 *
dev
,

1130 
iw_ªque°_öfo
 *
öfo
,

1131 
iw_poöt
 *
d©a
, *
essid
)

1134 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

1135 
NDIS_802_11_SSID
 
Ssid
, *
pSsid
=
NULL
;

1138 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

1139  -
ENETDOWN
;

1140 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

1141  -
ENETDOWN
;

1143 
	`NdisZîoMem‹y
(&
Ssid
, (
NDIS_802_11_SSID
));

1145 i‡(
d©a
->
Êags
)

1147 i‡(
d©a
->
Àngth
 > 
IW_ESSID_MAX_SIZE
)

1149  -
E2BIG
;

1151 #i‡
WIRELESS_EXT
 < 21

1152 
	`NdisMoveMem‹y
(
Ssid
.Ssid, 
essid
, (
d©a
->
Àngth
 - 1));

1153 
Ssid
.
SsidLígth
 = 
d©a
->
Àngth
 - 1;

1155 
	`NdisMoveMem‹y
(
Ssid
.Ssid, 
essid
, 
d©a
->
Àngth
);

1156 
Ssid
.
SsidLígth
 = 
d©a
->
Àngth
;

1161 
Ssid
.
SsidLígth
 = 0;

1162 
	`NdisMoveMem‹y
(
Ssid
.Ssid, "", 0);

1165 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


1166 i‡(
pAd≠ãr
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

1169 
NDIS_802_11_REMOVE_KEY
 
ªmoveKey
;

1170 
	`mem£t
(&
ªmoveKey
, 0, (removeKey));

1171 
ªmoveKey
.
KeyIndex
 = 0xffffffff;

1173 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
OID_802_11_REMOVE_KEY
, 
TRUE
, (
PVOID
)&
ªmoveKey
, (removeKey));

1176 #i‡
WIRELESS_EXT
 > 17

1177 i‡(
pAd≠ãr
->
P‹tCfg
.
wx_√ed_sync
)

1179 
	`wext2Rtmp_Securôy_Wøµî
(
pAd≠ãr
);

1180 
pAd≠ãr
->
P‹tCfg
.
wx_√ed_sync
 = 0;

1184 if(
Ssid
.
SsidLígth
 == 0)

1186 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
OID_802_11_DISASSOCIATE
, 
TRUE
, 
NULL
, 0);

1187 
pAd≠ãr
->
P‹tCfg
.
SsidLí
 = 0;

1188 
	`mem£t
(
pAd≠ãr
->
P‹tCfg
.
Ssid
, 0, 
MAX_LEN_OF_SSID
);

1192 i‡((
pAd≠ãr
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄1E«bÀd
) &&

1193 (
pAd≠ãr
->
P‹tCfg
.
IEEE8021X
 !
TRUE
))

1196 
buf
[(
NDIS_802_11_WEP
)+
MAX_LEN_OF_KEY
- 1];

1197 
NDIS_802_11_WEP
 
keyöfo
;

1198 } 
WïKey
;

1199 
KeyIdx
;

1201 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "EncrypType=WEP, set KeyÅo Asic!\n");

1202 
KeyIdx
 = 0; KeyIdx < 4; KeyIdx++)

1204 i‡(
pAd≠ãr
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 == 0)

1207 
	`NdisZîoMem‹y
(&
WïKey
, (WepKey));

1208 
WïKey
.
keyöfo
.
KeyLígth
 = 
pAd≠ãr
->
Sh¨edKey
[
KeyIdx
].
KeyLí
;

1209 
	`NdisMoveMem‹y
(
WïKey
.
keyöfo
.
KeyM©îül
, 
pAd≠ãr
->
Sh¨edKey
[
KeyIdx
].
Key
, WïKey.keyöfo.
KeyLígth
);

1210 
WïKey
.
keyöfo
.
KeyIndex
 = 
KeyIdx
;

1211 i‡(
pAd≠ãr
->
P‹tCfg
.
DeÁu…KeyId
 =
KeyIdx
);

1212 
WïKey
.
keyöfo
.
KeyIndex
 |= 0x80000000;

1213 
WïKey
.
keyöfo
.
Lígth
 = (WïKey.keyöfo)+ WïKey.keyöfo.
KeyLígth
 -1;

1214 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s():Së WEP keyÅÿkey[0x%x]!\n", 
__FUNCTION__
, 
KeyIdx
);

1215 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
OID_802_11_ADD_WEP
, 
TRUE
, (
PVOID
)&
WïKey
,

1216 
WïKey
.
keyöfo
.
Lígth
);

1222 
pSsid
 = &
Ssid
;

1223 i‡((
pAd≠ãr
->
Mlme
.
C¡lMachöe
.
CuºSèã
 !
CNTL_IDLE
Ë&& (pAd≠ãr->
MLMEThr_pid
 > 0))

1225 
	`MlmeEnqueue
(
pAd≠ãr
,

1226 
MLME_CNTL_STATE_MACHINE
,

1227 
RT_CMD_RESET_MLME
,

1229 
NULL
);

1236 i‡(
pAd≠ãr
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
)

1238 
	`NdisZîoMem‹y
(
pAd≠ãr
->
MlmeAux
.
Ssid
, 
MAX_LEN_OF_SSID
);

1239 
	`NdisMoveMem‹y
(
pAd≠ãr
->
MlmeAux
.
Ssid
, Ssid.Ssid, Ssid.
SsidLígth
);

1240 
pAd≠ãr
->
MlmeAux
.
SsidLí
 = 
Ssid
.
SsidLígth
;

1243 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "===>π_io˘l_siwessid:: (Ssid.SsidLígth = %d, %s)\n",
Ssid
.
SsidLígth
, Ssid.Ssid);

1245 i‡(
pAd≠ãr
->
MLMEThr_pid
 > 0)

1247 
	`MlmeEnqueue
(
pAd≠ãr
,

1248 
MLME_CNTL_STATE_MACHINE
,

1249 
OID_802_11_SSID
,

1250 (
NDIS_802_11_SSID
),

1251 (
VOID
 *)
pSsid
);

1253 
	`RTUSBMlmeUp
(
pAd≠ãr
);

1256 
	}
}

1258 
	$π_io˘l_giwessid
(
√t_devi˚
 *
dev
,

1259 
iw_ªque°_öfo
 *
öfo
,

1260 
iw_poöt
 *
d©a
, *
exåa
)

1263 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

1265 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

1266  -
ENETDOWN
;

1268 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd≠ãr
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

1270 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"MediaState is connected\n");

1271 
d©a
->
Àngth
 = 
pAd≠ãr
->
P‹tCfg
.
SsidLí
;

1272 
	`mem˝y
(
exåa
, 
pAd≠ãr
->
P‹tCfg
.
Ssid
,ÖAd≠ãr->P‹tCfg.
SsidLí
);

1273 
d©a
->
Êags
 = 1;

1274 
pAd≠ãr
->
P‹tCfg
.
Ssid
[pAd≠ãr->P‹tCfg.
SsidLí
] = '\0';

1275 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"pAd≠ãr->P‹tCfg.Ssid=%†, SsidÀ¿%d\n",
pAd≠ãr
->
P‹tCfg
.
Ssid
,ÖAd≠ãr->P‹tCfg.
SsidLí
);

1279 
d©a
->
Àngth
 = 0;

1280 
d©a
->
Êags
 = 0;

1281 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"MediaState isÇot connected,Éss\n");

1283 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "===>π_io˘l_giwessid:: (Lí=%d, ssid=%s...)\n", 
pAd≠ãr
->
P‹tCfg
.
SsidLí
,ÖAd≠ãr->P‹tCfg.
Ssid
);

1287 
	}
}

1289 
	$π_io˘l_siwnickn
(
√t_devi˚
 *
dev
,

1290 
iw_ªque°_öfo
 *
öfo
,

1291 
iw_poöt
 *
d©a
, *
nick«me
)

1293 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

1296 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

1297  -
ENETDOWN
;

1298 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

1299  -
ENETDOWN
;

1301 i‡(
d©a
->
Àngth
 > 
IW_ESSID_MAX_SIZE
)

1302  -
EINVAL
;

1304 
	`mem£t
(
pAd≠ãr
->
nickn
, 0, 
IW_ESSID_MAX_SIZE
);

1305 
	`mem˝y
(
pAd≠ãr
->
nickn
, 
nick«me
, 
d©a
->
Àngth
);

1309 
	}
}

1311 
	$π_io˘l_giwnickn
(
√t_devi˚
 *
dev
,

1312 
iw_ªque°_öfo
 *
öfo
,

1313 
iw_poöt
 *
d©a
, *
nick«me
)

1315 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTER)
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

1317 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

1318  -
ENETDOWN
;

1320 i‡(
d©a
->
Àngth
 > 
	`°æí
(
pAd≠ãr
->
nickn
) + 1)

1321 
d©a
->
Àngth
 = 
	`°æí
(
pAd≠ãr
->
nickn
) + 1;

1322 i‡(
d©a
->
Àngth
 > 0) {

1323 
	`mem˝y
(
nick«me
, 
pAd≠ãr
->
nickn
, 
d©a
->
Àngth
-1);

1324 
nick«me
[
d©a
->
Àngth
-1] = '\0';

1327 
	}
}

1329 
	$π_io˘l_siwπs
(
√t_devi˚
 *
dev
,

1330 
iw_ªque°_öfo
 *
öfo
,

1331 
iw_∑øm
 *
πs
, *
exåa
)

1333 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

1334 
u16
 
vÆ
;

1337 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

1338  -
ENETDOWN
;

1339 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

1340  -
ENETDOWN
;

1342 i‡(
πs
->
dißbÀd
)

1343 
vÆ
 = 
MAX_RTS_THRESHOLD
;

1344 i‡(
πs
->
vÆue
 < 0 ||Ñts->vÆuê> 
MAX_RTS_THRESHOLD
)

1345  -
EINVAL
;

1346 i‡(
πs
->
vÆue
 == 0)

1347 
vÆ
 = 
MAX_RTS_THRESHOLD
;

1349 
vÆ
 = 
πs
->
vÆue
;

1351 i‡(
vÆ
 !
pAd≠ãr
->
P‹tCfg
.
RtsThªshﬁd
)

1352 
pAd≠ãr
->
P‹tCfg
.
RtsThªshﬁd
 = 
vÆ
;

1355 
	}
}

1357 
	$π_io˘l_giwπs
(
√t_devi˚
 *
dev
,

1358 
iw_ªque°_öfo
 *
öfo
,

1359 
iw_∑øm
 *
πs
, *
exåa
)

1361 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

1363 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

1364  -
ENETDOWN
;

1366 
πs
->
vÆue
 = 
pAd≠ãr
->
P‹tCfg
.
RtsThªshﬁd
;

1367 
πs
->
dißbÀd
 = (πs->
vÆue
 =
MAX_RTS_THRESHOLD
);

1368 
πs
->
fixed
 = 1;

1371 
	}
}

1373 
	$π_io˘l_siw‰ag
(
√t_devi˚
 *
dev
,

1374 
iw_ªque°_öfo
 *
öfo
,

1375 
iw_∑øm
 *
πs
, *
exåa
)

1377 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

1378 
u16
 
vÆ
;

1381 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

1382  -
ENETDOWN
;

1383 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

1384  -
ENETDOWN
;

1386 i‡(
πs
->
dißbÀd
)

1387 
vÆ
 = 
MAX_FRAG_THRESHOLD
;

1388 i‡(
πs
->
vÆue
 >
MIN_FRAG_THRESHOLD
 ||Ñts->vÆuê<
MAX_FRAG_THRESHOLD
)

1389 
vÆ
 = 
	`__˝u_to_À16
(
πs
->
vÆue
 & ~0x1);

1390 i‡(
πs
->
vÆue
 == 0)

1391 
vÆ
 = 
MAX_FRAG_THRESHOLD
;

1393  -
EINVAL
;

1395 
pAd≠ãr
->
P‹tCfg
.
FøgmítThªshﬁd
 = 
vÆ
;

1397 
	}
}

1399 
	$π_io˘l_giw‰ag
(
√t_devi˚
 *
dev
,

1400 
iw_ªque°_öfo
 *
öfo
,

1401 
iw_∑øm
 *
πs
, *
exåa
)

1403 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

1405 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

1406  -
ENETDOWN
;

1408 
πs
->
vÆue
 = 
pAd≠ãr
->
P‹tCfg
.
FøgmítThªshﬁd
;

1409 
πs
->
dißbÀd
 = (πs->
vÆue
 == 2346);

1410 
πs
->
fixed
 = 1;

1413 
	}
}

1415 
	$π_io˘l_siwícode
(
√t_devi˚
 *
dev
,

1416 
iw_ªque°_öfo
 *
öfo
,

1417 
iw_poöt
 *
îq
, *
keybuf
)

1420 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

1422 
buf
[(
NDIS_802_11_WEP
)+
MAX_LEN_OF_KEY
- 1];

1423 
NDIS_802_11_WEP
 
keyöfo
;

1424 } 
WïKey
;

1425 
ödex
, 
i
, 
Àn
;

1426 
CHAR
 
kid
 = 0;

1429 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


1430 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

1433 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

1434  -
ENETDOWN
;

1435 i‡(
pAd
->
RTUSBCmdThr_pid
 < 0)

1436  -
ENETDOWN
;

1438 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"%s():Érq->Àngth = %d,Érq->Êag†%x\n", 
__FUNCTION__
, 
îq
->
Àngth
,Érq->
Êags
);

1441 i‡(
îq
->
Êags
 & 
IW_ENCODE_DISABLED
)

1444 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11WEPDißbÀd
;

1445 
pAd
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11WEPDißbÀd
;

1446 
pAd
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11WEPDißbÀd
;

1448 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeO≥n
;

1450 
d⁄e
;

1459 
ödex
 = (
îq
->
Êags
 & 
IW_ENCODE_INDEX
);

1460 i‡((
îq
->
Àngth
 > 
IW_ENCODING_TOKEN_MAX
)

1461 || ((
ödex
 < 0Ë|| (ödex >
NR_WEP_KEYS
)))

1462  -
EINVAL
;

1463 
ödex
 = ((ödex > 0Ë? (ödex - 1Ë: 
pAd
->
P‹tCfg
.
DeÁu…KeyId
);

1466 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11WEPE«bÀd
;

1467 
pAd
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11WEPE«bÀd
;

1468 
pAd
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11WEPE«bÀd
;

1471 i‡(
îq
->
Êags
 & 
IW_ENCODE_RESTRICTED
)

1472 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeSh¨ed
;

1474 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeO≥n
;

1477 if(
îq
->
Àngth
 > 0)

1480 
	`NdisZîoMem‹y
(&
WïKey
, (WepKey));

1483 
Àn
 = (
îq
->
Àngth
 >
WEP_LARGE_KEY_LEN
 ? WEP_LARGE_KEY_LEN : 
WEP_SMALL_KEY_LEN
);

1485 
	`NdisZîoMem‹y
(
pAd
->
Sh¨edKey
[
ödex
].
Key
, (pAd->SharedKey[index].Key));

1486 
	`NdisMoveMem‹y
(
pAd
->
Sh¨edKey
[
ödex
].
Key
, 
keybuf
, 
Àn
);

1487 
pAd
->
Sh¨edKey
[
ödex
].
KeyLí
 = 
Àn
;

1489 
	`NdisMoveMem‹y
(
WïKey
.
keyöfo
.
KeyM©îül
, 
keybuf
, 
Àn
);

1490 
WïKey
.
keyöfo
.
KeyIndex
 = 0x80000000 + 
ödex
;

1491 
WïKey
.
keyöfo
.
KeyLígth
 = 
Àn
;

1493 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Sh¨edKey[%d]:", 
ödex
);

1494 
i
=0; i < 
Àn
; i++)

1495 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, " %x", 
pAd
->
Sh¨edKey
[
ödex
].
Key
[
i
]);

1496 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "\n");

1499 
	`RTUSBEnqueueCmdFromNdis
(
pAd
, 
OID_802_11_ADD_WEP
, 
TRUE
, &
WïKey
, (WïKey.
keyöfo
Ë+ 
Àn
 - 1);

1504 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 = 
ödex
;

1508 
i
 = 0; i < 
NR_WEP_KEYS
; i++)

1510 *
keyBuf
 = &
pAd
->
Sh¨edKey
[
i
].
Key
[0];

1511 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s():SharedKey[%d]=0x%x:%x:%x:%x:%x:%x:%x:%x:%x:%x:%x:%x:%x, KeyLen = %d, isDefault=%d!\n",

1512 
__FUNCTION__
, 
i
, 
keyBuf
[0],keyBuf[1], keyBuf[2], keyBuf[3], keyBuf[4], keyBuf[5], keyBuf[6],

1513 
keyBuf
[7], keyBuf[8], keyBuf[9], keyBuf[10], keyBuf[11], keyBuf[12],
pAd
->
Sh¨edKey
[
i
].
KeyLí
,

1514 (
pAd
->
P‹tCfg
.
DeÁu…KeyId
 =
i
 ? 1 : 0));

1517 
d⁄e
:

1518 
pAd
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_NOT_SECURED
;

1520 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s():AuthMode=%x, WepStatus=%x!\n",

1521 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
AuthMode
,ÖAd->P‹tCfg.
WïSètus
);

1529 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

1530  -
ENETDOWN
;

1531 i‡(
pAd
->
RTUSBCmdThr_pid
 < 0)

1532  -
ENETDOWN
;

1534 
	`NdisZîoMem‹y
(&
WïKey
, (WepKey));

1536 i‡(
îq
->
Êags
 & 
IW_ENCODE_DISABLED
)

1538 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11WEPDißbÀd
;

1539 
pAd
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11WEPDißbÀd
;

1540 
pAd
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11WEPDißbÀd
;

1544 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11WEPE«bÀd
;

1545 
pAd
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11WEPE«bÀd
;

1546 
pAd
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11WEPE«bÀd
;

1549 i‡(
îq
->
Êags
 & 
IW_ENCODE_RESTRICTED
)

1550 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeSh¨ed
;

1552 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeO≥n
;

1554 if(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11WEPDißbÀd
)

1555 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeO≥n
;

1557 i‡((
îq
->
Êags
 & 
IW_ENCODE_DISABLED
) == 0)

1560 i‡(
îq
->
Àngth
 > 
IFNAMSIZ
)

1561  -
EINVAL
;

1564 
ödex
 = (
îq
->
Êags
 & 
IW_ENCODE_INDEX
) ;

1565 if((
ödex
 < 0Ë|| (ödex > 
NR_WEP_KEYS
))

1566  -
EINVAL
;

1567 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"Érq->Êag†%x\n",
îq
->
Êags
);

1569 i‡(
ödex
 != 0)

1571 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 = 
ödex
 -1;

1574 i‡((
îq
->
Àngth
 =1Ë&& (
ödex
 == 0))

1577 
	`NdisMoveMem‹y
(&
kid
, 
keybuf
, 1 );

1578 if((
ödex
 < 0Ë|| (ödex >
NR_WEP_KEYS
))

1579  -
EINVAL
;

1581 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"kid = %d ,Érq->Àngth = %d\n",
kid
, 
îq
->
Àngth
);

1582 i‡(
kid
 > 0)

1583 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 = 
kid
-1;

1585 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 = 0;

1589 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"DeÁu…KeyId = %d ,Érq->Àngth = %d, fœg†0x%x\n",
pAd
->
P‹tCfg
.
DeÁu…KeyId
, 
îq
->
Àngth
,îq->
Êags
);

1590 
Àn
 = 
îq
->
Àngth
;

1591 if(
Àn
 > 
WEP_LARGE_KEY_LEN
)

1592 
Àn
 = 
WEP_LARGE_KEY_LEN
;

1595 
	`NdisZîoMem‹y
(
pAd
->
Sh¨edKey
[pAd->
P‹tCfg
.
DeÁu…KeyId
].
Key
, 
MAX_LEN_OF_KEY
);

1596 
	`NdisMoveMem‹y
(
pAd
->
Sh¨edKey
[pAd->
P‹tCfg
.
DeÁu…KeyId
].
Key
, 
keybuf
, 
Àn
);

1597 
	`NdisMoveMem‹y
(
WïKey
.
keyöfo
.
KeyM©îül
, 
keybuf
, 
Àn
);

1598 
WïKey
.
keyöfo
.
KeyIndex
 = 0x80000000 + 
pAd
->
P‹tCfg
.
DeÁu…KeyId
;

1599 
WïKey
.
keyöfo
.
KeyLígth
 = 
Àn
;

1600 
pAd
->
Sh¨edKey
[pAd->
P‹tCfg
.
DeÁu…KeyId
].
KeyLí
 =(
UCHAR
Ë(
Àn
 <
WEP_SMALL_KEY_LEN
 ? WEP_SMALL_KEY_LEN : 
WEP_LARGE_KEY_LEN
);

1601 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"SharedKey ");

1602 
i
=0; i < 5;i++)

1603 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
," %x ", 
pAd
->
Sh¨edKey
[pAd->
P‹tCfg
.
DeÁu…KeyId
].
Key
[
i
]);

1604 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "\n");

1606 
	`RTUSBEnqueueCmdFromNdis
(
pAd
, 
OID_802_11_ADD_WEP
, 
TRUE
, &
WïKey
, (WïKey.
keyöfo
Ë+ 
Àn
 - 1);

1610 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==>π_io˘l_siwícode::AuthMode=%x\n",
pAd
->
P‹tCfg
.
AuthMode
);

1611 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==>π_io˘l_siwícode::DeÁu…KeyId=%x, KeyLí = %d\n",
pAd
->
P‹tCfg
.
DeÁu…KeyId
 ,ÖAd->
Sh¨edKey
[pAd->P‹tCfg.DeÁu…KeyId].
KeyLí
);

1612 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==>π_io˘l_siwícode::WïSètus=%x\n",
pAd
->
P‹tCfg
.
WïSètus
);

1614 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


1617 
	}
}

1620 
	$π_io˘l_giwícode
(
√t_devi˚
 *
dev
,

1621 
iw_ªque°_öfo
 *
öfo
,

1622 
iw_poöt
 *
îq
, *
key
)

1624 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

1625 
keyIdx
;

1627 i‡(
pAd
->
RTUSBCmdThr_pid
 < 0)

1628  -
ENETDOWN
;

1630 
keyIdx
 = 
îq
->
Êags
 & 
IW_ENCODE_INDEX
;

1631 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): Reque° keyIdx=%d\n", 
__FUNCTION__
, 
keyIdx
);

1633 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11WEPDißbÀd
)

1635 
îq
->
Àngth
 = 0;

1636 
îq
->
Êags
 = 
IW_ENCODE_DISABLED
;

1642 i‡(
keyIdx
 > 
NR_WEP_KEYS
)

1643  -
EINVAL
;

1646 
keyIdx
 = (keyIdx =0 ? 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 : (keyIdx - 1));

1649 i‡(
îq
->
Àngth
 < 
pAd
->
Sh¨edKey
[
keyIdx
].
KeyLí
)

1650  -
EINVAL
;

1653 
îq
->
Àngth
 = 
pAd
->
Sh¨edKey
[
keyIdx
].
KeyLí
;

1654 
	`mem˝y
(
key
, 
pAd
->
Sh¨edKey
[
keyIdx
].
Key
, 
îq
->
Àngth
);

1655 
îq
->
Êags
 = (
keyIdx
 + 1);

1656 
îq
->
Êags
 |
IW_ENCODE_ENABLED
;

1657 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeSh¨ed
)

1658 
îq
->
Êags
 |
IW_ENCODE_RESTRICTED
;

1660 
îq
->
Êags
 |
IW_ENCODE_OPEN
;

1665 
	}
}

1668 #i‡
WIRELESS_EXT
 > 17

1671 
	$π_io˘l_siwauth
(
√t_devi˚
 *
dev
,

1672 
iw_ªque°_öfo
 *
öfo
,

1673 
iwªq_d©a
 *
wrqu
, *
exåa
)

1675 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

1676 
iw_∑øm
 *
∑øm
 = &
wrqu
->param;

1679 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

1680  -
ENETDOWN
;

1681 i‡(
pAd
->
RTUSBCmdThr_pid
 < 0)

1682  -
ENETDOWN
;

1684 
∑øm
->
Êags
 & 
IW_AUTH_INDEX
) {

1685 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


1686 
IW_AUTH_WPA_VERSION
:

1687 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

1689 
pAd
->
P‹tCfg
.
wx_w∑_vîsi⁄
 = 
∑øm
->
vÆue
;

1690 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): së wx_w∑_vîsi⁄=%d!\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
wx_w∑_vîsi⁄
);

1694 
IW_AUTH_CIPHER_PAIRWISE
:

1695 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

1697 
pAd
->
P‹tCfg
.
wx_∑úwi£
 = 
∑øm
->
vÆue
;

1698 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): së wx_∑úwi£=%d!\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
wx_∑úwi£
);

1702 
IW_AUTH_CIPHER_GROUP
:

1703 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

1705 
pAd
->
P‹tCfg
.
wx_groupCùhî

∑øm
->
vÆue
;

1706 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): së wx_groupCùhî=%d!\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
wx_groupCùhî
);

1710 
IW_AUTH_KEY_MGMT
:

1711 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

1713 
pAd
->
P‹tCfg
.
wx_key_mgmt
 = 
∑øm
->
vÆue
;

1714 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): së wx_key_mgmt=%d!\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
wx_key_mgmt
);

1717 
IW_AUTH_80211_AUTH_ALG
:

1718 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

1720 
pAd
->
P‹tCfg
.
wx_auth_Æg
 = 
∑øm
->
vÆue
;

1721 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): së wx_auth_Æg=%d!\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
wx_auth_Æg
);

1725 
IW_AUTH_TKIP_COUNTERMEASURES
:

1727 
pAd
->
P‹tCfg
.
bBlockAssoc
 = (
∑øm
->
vÆue
 > 0 ? 
TRUE
 : 
FALSE
);

1728 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): së bBlockAssoc=%d!\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
bBlockAssoc
);

1730 
IW_AUTH_DROP_UNENCRYPTED
:

1731 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): U£rS∑˚ cÆ»SIOCAUTHÅÿdÿIW_AUTH_DROP_UNENCRYPTED, vÆue=%d!\n", 
__FUNCTION__
, 
∑øm
->
vÆue
);

1733 
IW_AUTH_WPA_ENABLED
:

1735 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): së IW_AUTH_WPA_ENABLED=%d!\n", 
__FUNCTION__
, 
∑øm
->
vÆue
);

1737 
IW_AUTH_RX_UNENCRYPTED_EAPOL
:

1739 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): së IW_AUTH_RX_UNENCRYPTED_EAPOL=%d!\n", 
__FUNCTION__
, 
∑øm
->
vÆue
);

1741 
IW_AUTH_ROAMING_CONTROL
:

1743 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): së IW_AUTH_ROAMING_CONTROL=%d!\n", 
__FUNCTION__
, 
∑øm
->
vÆue
);

1745 
IW_AUTH_PRIVACY_INVOKED
:

1747 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): së IW_AUTH_PRIVACY_INVOKED=%d!\n", 
__FUNCTION__
, 
∑øm
->
vÆue
);

1750 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): unknow¿£âög =0x%x!\n", 
__FUNCTION__
, 
∑øm
->
Êags
);

1751  -
EOPNOTSUPP
;

1754 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


1755 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

1756 
pAd
->
P‹tCfg
.
wx_√ed_sync
 |= 1;

1761 
	}
}

1765 
	$π_io˘l_giwauth
(
√t_devi˚
 *
dev
,

1766 
iw_ªque°_öfo
 *
öfo
,

1767 
iwªq_d©a
 *
wrqu
, *
exåa
)

1769 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

1770 
iw_∑øm
 *
∑øm
 = &
wrqu
->param;

1771 
ªt
 = 0;

1773 i‡(
pAd
->
RTUSBCmdThr_pid
 < 0)

1774  -
ENETDOWN
;

1777 
∑øm
->
Êags
 & 
IW_AUTH_INDEX
)

1779 
IW_AUTH_WPA_VERSION
:

1781 i‡(
∑øm
->
vÆue
 =
IW_AUTH_WPA_VERSION_WPA
)

1783 i‡(
∑øm
->
vÆue
 =
IW_AUTH_WPA_VERSION_WPA2
)

1785 i‡(
∑øm
->
vÆue
 =
IW_AUTH_WPA_VERSION_DISABLED
)

1792 
IW_AUTH_CIPHER_PAIRWISE
:

1793 
IW_AUTH_CIPHER_GROUP
:

1794 
IW_AUTH_KEY_MGMT
:

1798 
ªt
 = -
EOPNOTSUPP
;

1801 
IW_AUTH_TKIP_COUNTERMEASURES
:

1802 
∑øm
->
vÆue
 = 1;

1805 
IW_AUTH_DROP_UNENCRYPTED
:

1806 
∑øm
->
vÆue
 = 1;

1809 
IW_AUTH_80211_AUTH_ALG
:

1810 
∑øm
->
vÆue
 = 
pAd
->
P‹tCfg
.
AuthMode
;

1813 
IW_AUTH_WPA_ENABLED
:

1814 
∑øm
->
vÆue
 = (
pAd
->
P‹tCfg
.
AuthMode
 > 
Ndis802_11AuthModeWPA
 ? 1 : 0);

1817 
IW_AUTH_RX_UNENCRYPTED_EAPOL
:

1818 
∑øm
->
vÆue
 = 1;

1821 
IW_AUTH_ROAMING_CONTROL
:

1822 
IW_AUTH_PRIVACY_INVOKED
:

1823 
∑øm
->
vÆue
 = 1;

1827  -
EOPNOTSUPP
;

1834  -
EOPNOTSUPP
;

1837 
	}
}

1842 
	$π_io˘l_siwícodìxt
(
√t_devi˚
 *
dev
,

1843 
iw_ªque°_öfo
 *
öfo
,

1844 
iwªq_d©a
 *
wrqu
, *
exåa
)

1846 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

1847 
iw_poöt
 *
ícodög
 = &
wrqu
->encoding;

1848 
iw_ícode_ext
 *
ext
 = 
wrqu
->
ícodög
.
poöãr
;

1849 
keyIdx
;

1850 
UCHAR
 *
pBuf
 = 
NULL
;

1851 
bufLí
;

1854 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

1855  -
ENETDOWN
;

1856 i‡(
pAd
->
RTUSBCmdThr_pid
 < 0)

1857  -
ENETDOWN
;

1859 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"%s():Éncoding->flags = %x,Éxt->ext_flags=0x%x,Éxt->alg=0x%x!\n",

1860 
__FUNCTION__
, 
ícodög
->
Êags
, 
ext
->
ext_Êags
,Éxt->
Æg
);

1863 
keyIdx
 = (
ícodög
->
Êags
 & 
IW_ENCODE_INDEX
);

1864 if((
keyIdx
 < 0Ë|| (keyIdx > 
NR_WEP_KEYS
))

1865  -
EINVAL
;

1866 
keyIdx
 = ((keyIdx > 0Ë? (keyIdx - 1Ë: 
pAd
->
P‹tCfg
.
DeÁu…KeyId
);

1867 if((
ext
->
ext_Êags
 & 
IW_ENCODE_EXT_GROUP_KEY
) == 0)

1868 
keyIdx
 |= 1 << 30;

1869 if(
ext
->
ext_Êags
 & 
IW_ENCODE_EXT_SET_TX_KEY
)

1870 
keyIdx
 |= 1 << 31;

1872 i‡((
ícodög
->
Êags
 & 
IW_ENCODE_DISABLED
Ë|| (
ext
->
Æg
 && 
IW_ENCODE_ALG_NONE
))

1874 
NDIS_802_11_REMOVE_KEY
 
RtmpRmvKey
;

1877 
	`NdisZîoMem‹y
(&
RtmpRmvKey
, (RtmpRmvKey));

1878 
	`NdisMoveMem‹y
(
RtmpRmvKey
.
BSSID
, 
ext
->
addr
.
ß_d©a
, 
ETH_ALEN
);

1879 
RtmpRmvKey
.
KeyIndex
 = 
keyIdx
;

1880 
RtmpRmvKey
.
Lígth
 = (RtmpRmvKey);

1881 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): DoÑemove keyáction! Remove KeyIdx=0x%x!\n",

1882 
__FUNCTION__
, 
keyIdx
);

1883 i‡(
NDIS_STATUS_SUCCESS
 =
	`RTMPRemoveKeyS™ôy
(
pAd
, (
PVOID
)&
RtmpRmvKey
))

1884 
	`RTUSBEnqueueCmdFromNdis
(
pAd
, 
OID_802_11_REMOVE_KEY
, 
TRUE
, (
PVOID
)&
RtmpRmvKey
, (RtmpRmvKey));

1886 i‡(
ext
->
key_Àn
 == 0)

1889 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 = 
keyIdx
;

1890 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): Do set default key indexáction!set default key=0x%x!\n",

1891 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
DeÁu…KeyId
);

1897 i‡(
ext
->
Æg
 =
IW_ENCODE_ALG_WEP
)

1899 
NDIS_802_11_WEP
 *
pRtmpWïKey
;

1900 
ULONG
 
ªÆ_keyIdx
;

1902 
bufLí
 = ((
NDIS_802_11_WEP
)- 1)+ 
ext
->
key_Àn
;

1903 if((
pBuf
 = 
	`kmÆloc
(
bufLí
, 
MEM_ALLOC_FLAG
)Ë=
NULL
)

1904  -
ENOMEM
;

1905 
	`NdisZîoMem‹y
(
pBuf
, 
bufLí
);

1907 
pRtmpWïKey
 = (
NDIS_802_11_WEP
 *)
pBuf
;

1908 
pRtmpWïKey
->
KeyIndex
 = 
keyIdx
;

1909 
pRtmpWïKey
->
KeyLígth
 = 
ext
->
key_Àn
;

1910 
pRtmpWïKey
->
Lígth
 = 
bufLí
;

1911 
	`NdisMoveMem‹y
(&(
pRtmpWïKey
->
KeyM©îül
[0]), 
ext
->
key
,Éxt->
key_Àn
);

1913 
ªÆ_keyIdx
 = 
keyIdx
 & 0x0fffffff;

1916 
	`NdisZîoMem‹y
(
pAd
->
Sh¨edKey
[
ªÆ_keyIdx
].
Key
, 16);

1917 
	`NdisMoveMem‹y
(
pAd
->
Sh¨edKey
[
ªÆ_keyIdx
].
Key
, 
ext
->
key
,Éxt->
key_Àn
);

1918 
pAd
->
Sh¨edKey
[
ªÆ_keyIdx
].
KeyLí
 = 
ext
->
key_Àn
;

1919 if(
ext
->
key_Àn
 == 5)

1920 
pAd
->
Sh¨edKey
[
ªÆ_keyIdx
].
CùhîAlg
 = 
CIPHER_WEP64
;

1922 
pAd
->
Sh¨edKey
[
ªÆ_keyIdx
].
CùhîAlg
 = 
CIPHER_WEP128
;

1924 
	`NdisZîoMem‹y
(
pAd
->
P‹tCfg
.
DesúeSh¨edKey
[
ªÆ_keyIdx
].
Key
, 16);

1925 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
DesúeSh¨edKey
[
ªÆ_keyIdx
].
Key
, 
ext
->
key
,Éxt->
key_Àn
);

1926 
pAd
->
P‹tCfg
.
DesúeSh¨edKey
[
ªÆ_keyIdx
].
KeyLí
 = 
ext
->
key_Àn
;

1927 
pAd
->
P‹tCfg
.
DesúeSh¨edKey
[
ªÆ_keyIdx
].
CùhîAlg
 =ÖAd->
Sh¨edKey
[real_keyIdx].CipherAlg;

1930 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): Doádd WEP keyáction! keyIdx=0x%x!KeyLength=%d!\n",

1931 
__FUNCTION__
, 
keyIdx
, 
ext
->
key_Àn
);

1932 
	`RTUSBEnqueueCmdFromNdis
(
pAd
, 
OID_802_11_ADD_WEP
, 
TRUE
, (
PVOID
)
pRtmpWïKey
,ÖRtmpWïKey->
Lígth
);

1934 if((
ext
->
Æg
 =
IW_ENCODE_ALG_TKIP
Ë|| (ext->Æg =
IW_ENCODE_ALG_CCMP
))

1936 
NDIS_802_11_KEY
 *
pRtmpKey
;

1937 
i
;

1939 
bufLí
 = ((
NDIS_802_11_KEY
)- 1)+ 
ext
->
key_Àn
;

1940 if((
pBuf
 = 
	`kmÆloc
(
bufLí
, 
MEM_ALLOC_FLAG
)Ë=
NULL
)

1941  -
ENOMEM
;

1942 
	`NdisZîoMem‹y
(
pBuf
, 
bufLí
);

1944 
pRtmpKey
 = (
NDIS_802_11_KEY
 *)
pBuf
;

1946 
pRtmpKey
->
Lígth
 = 
bufLí
;

1948 
pRtmpKey
->
KeyIndex
 = 
keyIdx
;

1950 
pRtmpKey
->
KeyLígth
 = 
ext
->
key_Àn
;

1952 
	`NdisMoveMem‹y
(
pRtmpKey
->
BSSID
, 
ext
->
addr
.
ß_d©a
, 
ETH_ALEN
);

1954 i‡(
ext
->
ext_Êags
 & 
IW_ENCODE_EXT_RX_SEQ_VALID
)

1956 
keyIdx
 |= 1 << 29;

1957 
i
 = 0; i < 
IW_ENCODE_SEQ_MAX_SIZE
; i++)

1958 
pRtmpKey
->
KeyRSC
 |
ext
->
rx_£q
[
i
] << (i * 8);

1961 i‡(
ext
->
Æg
 =
IW_ENCODE_ALG_TKIP
 &&Éxt->
key_Àn
 == 32)

1963 
	`NdisMoveMem‹y
(&
pRtmpKey
->
KeyM©îül
[0], 
ext
->
key
, 16);

1964 
	`NdisMoveMem‹y
((&
pRtmpKey
->
KeyM©îül
[0] + 16), (
ext
->
key
 + 24), 8);

1965 
	`NdisMoveMem‹y
((&
pRtmpKey
->
KeyM©îül
[0] + 24), (
ext
->
key
 + 16), 8);

1969 
	`NdisMoveMem‹y
(&
pRtmpKey
->
KeyM©îül
[0], 
ext
->
key
,Éxt->
key_Àn
);

1972 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): Doádd TKIP/AES keyáction! keyIdx=0x%x!\n",

1973 
__FUNCTION__
, 
keyIdx
);

1974 
	`RTUSBEnqueueCmdFromNdis
(
pAd
, 
OID_802_11_ADD_KEY
, 
TRUE
, (
PVOID
)
pRtmpKey
,ÖRtmpKey->
Lígth
);

1978 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "%s(): Unknow¿ícodìxàa˘i⁄!\n", 
__FUNCTION__
);

1979  -
EINVAL
;

1982 if(
pBuf
)

1983 
	`k‰ì
(
pBuf
);

1985 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


1986 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

1987 
pAd
->
P‹tCfg
.
wx_√ed_sync
 |= 1;

1991 
	}
}

1995 
	$π_io˘l_giwícodìxt
(
√t_devi˚
 *
dev
,

1996 
iw_ªque°_öfo
 *
öfo
,

1997 
iwªq_d©a
 *
wrqu
, *
exåa
)

1999 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

2001 i‡(
pAd
->
RTUSBCmdThr_pid
 < 0)

2002  -
ENETDOWN
;

2005 
	}
}

2009 
	$π_io˘l_siwpmkß
(
√t_devi˚
 *
dev
,

2010 
iw_ªque°_öfo
 *
öfo
,

2011 
iwªq_d©a
 *
wrqu
, *
exåa
)

2013 
	#IW_PMKID_LEN
 16

	)

2015 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

2016 
iw_pmkß
 *
pmkß
 = (iw_pmkß *)
wrqu
->
d©a
.
poöãr
;

2018 
ULONG
 
CachedIdx
;

2019 
found
 = 0;

2022 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

2023  -
ENETDOWN
;

2024 i‡(
pAd
->
RTUSBCmdThr_pid
 < 0)

2025  -
ENETDOWN
;

2027 i‡(
pmkß
->
cmd
 =
IW_PMKSA_FLUSH
)

2029 
CachedIdx
 = 0; CachedIdx < 
pAd
->
P‹tCfg
.
SavedPMKNum
; CachedIdx++)

2030 
	`NdisZîoMem‹y
(&
pAd
->
P‹tCfg
.
SavedPMK
[
CachedIdx
], (
BSSID_INFO
));

2031 
pAd
->
P‹tCfg
.
SavedPMKNum
 = 0;

2035 
CachedIdx
 = 0; CachedIdx < 
pAd
->
P‹tCfg
.
SavedPMKNum
; CachedIdx++)

2037 i‡(
	`NdisEquÆMem‹y
(
pmkß
->
bssid
.
ß_d©a
, 
pAd
->
P‹tCfg
.
SavedPMK
[
CachedIdx
].
BSSID
, 
ETH_ALEN
))

2039 
found
 = 1;

2044 i‡(
pmkß
->
cmd
 =
IW_PMKSA_ADD
)

2047 
	`DBGPRINT
(
RT_DEBUG_OFF
, "%s():Upd©êIW_PMKSA_ADD, idx = %d\n", 
__FUNCTION__
, 
CachedIdx
);

2048 
CachedIdx
 = (CachedIdx < 
PMKID_NO
Ë? CachedIdx : (
pmkß
->
bssid
.
ß_d©a
[5] % PMKID_NO);

2049 
	`DBGPRINT
(
RT_DEBUG_OFF
, "%s():A·îádju°, IW_PMKSA_ADD, idx = %d\n", 
__FUNCTION__
, 
CachedIdx
);

2051 
	`NdisMoveMem‹y
(&
pAd
->
P‹tCfg
.
SavedPMK
[
CachedIdx
].
BSSID
[0], 
pmkß
->
bssid
.
ß_d©a
, 
ETH_ALEN
);

2052 
	`NdisMoveMem‹y
(&
pAd
->
P‹tCfg
.
SavedPMK
[
CachedIdx
].
PMKID
[0], 
pmkß
->
pmkid
, 
IW_PMKID_LEN
);

2053 if((!
found
Ë&& (
pAd
->
P‹tCfg
.
SavedPMKNum
 < 
PMKID_NO
))

2054 
pAd
->
P‹tCfg
.
SavedPMKNum
++;

2056 i‡(
pmkß
->
cmd
 =
IW_PMKSA_REMOVE
 && 
found
)

2058 
	`DBGPRINT
(
RT_DEBUG_OFF
, "%s():RemovêIW_PMKSA_REMOVE, idx = %d\n", 
__FUNCTION__
, 
CachedIdx
);

2059 
	`NdisZîoMem‹y
(&
pAd
->
P‹tCfg
.
SavedPMK
[
CachedIdx
], (
BSSID_INFO
));

2060 
pAd
->
P‹tCfg
.
SavedPMKNum
--;

2065 
	}
}

2068 
	$π_io˘l_siwgíõ
(
√t_devi˚
 *
dev
,

2069 
iw_ªque°_öfo
 *
öfo
,

2070 
iwªq_d©a
 *
wrqu
, *
exåa
)

2072 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

2075 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

2076  -
ENETDOWN
;

2077 i‡(
pAd
->
RTUSBCmdThr_pid
 < 0)

2078  -
ENETDOWN
;

2080 i‡((
wrqu
->
d©a
.
Àngth
 > 44) ||

2081 ((
wrqu
->
d©a
.
Àngth
 > 0Ë&& (
exåa
 =
NULL
)))

2082  -
EINVAL
;

2084 i‡(
wrqu
->
d©a
.
Àngth
)

2087 
pAd
->
P‹tCfg
.
wx_RSNIE_Lí
 = 
wrqu
->
d©a
.
Àngth
 > 
MAX_WPA_IE_LEN
 ? MAX_WPA_IE_LEN : wrqu->data.length;

2088 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
wx_RSN_IE
, 
exåa
,ÖAd->P‹tCfg.
wx_RSNIE_Lí
);

2090 
pAd
->
P‹tCfg
.
RSN_IELí
 = 
wrqu
->
d©a
.
Àngth
 > 44 ? 44 : wrqu->data.length;

2091 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
RSN_IE
, 
exåa
,ÖAd->P‹tCfg.
RSN_IELí
);

2093 
	`¥ötk
("%s(): së WPA IE f‹ Assocüti⁄ Reque°!\n", 
__FUNCTION__
);

2096 
	`¥ötk
("wrqu->d©a.Àngth=%d! St› w∑!\n", 
wrqu
->
d©a
.
Àngth
);

2101 
	}
}

2105 
	$π_io˘l_giwgíõ
(
√t_devi˚
 *
dev
,

2106 
iw_ªque°_öfo
 *
öfo
,

2107 
iwªq_d©a
 *
wrqu
, *
exåa
)

2109 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

2111 i‡(
pAd
->
RTUSBCmdThr_pid
 < 0)

2112  -
ENETDOWN
;

2114 i‡(
wrqu
->
d©a
.
Àngth
 < 
pAd
->
P‹tCfg
.
RSN_IELí
)

2115  -
E2BIG
;

2117 
wrqu
->
d©a
.
Àngth
 = 
pAd
->
P‹tCfg
.
RSN_IELí
;

2118 
	`NdisMoveMem‹y
(
exåa
, &
pAd
->
P‹tCfg
.
RSN_IE
[0],ÖAd->P‹tCfg.
RSN_IELí
);

2121 
	}
}

2127 
	$π_io˘l_£ç¨am
(
√t_devi˚
 *
dev
, 
iw_ªque°_öfo
 *
öfo
,

2128 *
w
, *
exåa
)

2130 
PRTMP_ADAPTER
 
pAd≠ãr
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

2131 *
this_ch¨
 = 
exåa
;

2132 *
vÆue
;

2133 
Sètus
=0;

2136 i‡((
dev
->
Êags
 & 
IFF_UP
) == 0)

2137  -
ENETDOWN
;

2138 i‡(
pAd≠ãr
->
RTUSBCmdThr_pid
 < 0)

2139  -
ENETDOWN
;

2141 i‡(!*
this_ch¨
)

2142  
Sètus
;

2144 i‡((
vÆue
 = 
	`π°rchr
(
this_ch¨
, '=')Ë!
NULL
)

2145 *
vÆue
++ = 0;

2147 i‡(!
vÆue
)

2148  
Sètus
;

2151 i‡(!*
vÆue
 && (
	`°rcmp
(
this_ch¨
, "SSID") != 0))

2152  
Sètus
;

2154 
PRTMP_PRIVATE_SET_PROC
 = 
RTMP_PRIVATE_SUPPORT_PROC
; PRTMP_PRIVATE_SET_PROC->
«me
; PRTMP_PRIVATE_SET_PROC++)

2156 i‡(
	`°rcmp
(
this_ch¨
, 
PRTMP_PRIVATE_SET_PROC
->
«me
) == 0)

2158 if(!
PRTMP_PRIVATE_SET_PROC
->
	`£t_¥oc
(
pAd≠ãr
, 
vÆue
))

2160 
Sètus
 = -
EINVAL
;

2166 if(
PRTMP_PRIVATE_SET_PROC
->
«me
 =
NULL
)

2168 
Sètus
 = -
EINVAL
;

2169 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "===>π_io˘l_£ç¨am:: (iw¥ivËNŸ Suµ‹àSë Comm™d [%s=%s]\n", 
this_ch¨
, 
vÆue
);

2172  
Sètus
;

2173 
	}
}

2175 c⁄° 
iw_h™dÀr
 
	gπ_h™dÀr
[] =

2177 (
iw_h™dÀr
Ë
NULL
,

2178 (
iw_h™dÀr
Ë
π_io˘l_giw«me
,

2179 (
iw_h™dÀr
Ë
NULL
,

2180 (
iw_h™dÀr
Ë
NULL
,

2181 (
iw_h™dÀr
Ë
π_io˘l_siw‰eq
,

2182 (
iw_h™dÀr
Ë
π_io˘l_giw‰eq
,

2183 (
iw_h™dÀr
Ë
π_io˘l_siwmode
,

2184 (
iw_h™dÀr
Ë
π_io˘l_giwmode
,

2185 (
iw_h™dÀr
Ë
NULL
,

2186 (
iw_h™dÀr
Ë
NULL
,

2187 (
iw_h™dÀr
Ë
NULL
 ,

2188 (
iw_h™dÀr
Ë
π_io˘l_giwønge
,

2189 (
iw_h™dÀr
Ë
NULL
 ,

2190 (
iw_h™dÀr
Ë
NULL
 ,

2191 (
iw_h™dÀr
Ë
NULL
 ,

2192 (
iw_h™dÀr
Ë
NULL
 ,

2193 (
iw_h™dÀr
Ë
NULL
,

2194 (
iw_h™dÀr
Ë
NULL
,

2195 (
iw_h™dÀr
Ë
NULL
,

2196 (
iw_h™dÀr
Ë
NULL
,

2197 (
iw_h™dÀr
Ë
π_io˘l_siw≠
,

2198 (
iw_h™dÀr
Ë
π_io˘l_giw≠
,

2199 (
iw_h™dÀr
Ë
NULL
,

2200 (
iw_h™dÀr
Ë
π_io˘l_iw≠li°
,

2201 #ifde‡
SIOCGIWSCAN


2202 (
iw_h™dÀr
Ë
π_io˘l_siwsˇn
,

2203 (
iw_h™dÀr
Ë
π_io˘l_giwsˇn
,

2205 (
iw_h™dÀr
Ë
NULL
,

2206 (
iw_h™dÀr
Ë
NULL
,

2208 (
iw_h™dÀr
Ë
π_io˘l_siwessid
,

2209 (
iw_h™dÀr
Ë
π_io˘l_giwessid
,

2210 (
iw_h™dÀr
Ë
π_io˘l_siwnickn
,

2211 (
iw_h™dÀr
Ë
π_io˘l_giwnickn
,

2212 (
iw_h™dÀr
Ë
NULL
,

2213 (
iw_h™dÀr
Ë
NULL
,

2214 (
iw_h™dÀr
Ë
NULL
,

2215 (
iw_h™dÀr
Ë
NULL
,

2216 (
iw_h™dÀr
Ë
π_io˘l_siwπs
,

2217 (
iw_h™dÀr
Ë
π_io˘l_giwπs
,

2218 (
iw_h™dÀr
Ë
π_io˘l_siw‰ag
,

2219 (
iw_h™dÀr
Ë
π_io˘l_giw‰ag
,

2220 (
iw_h™dÀr
Ë
NULL
,

2221 (
iw_h™dÀr
Ë
NULL
,

2222 (
iw_h™dÀr
Ë
NULL
,

2223 (
iw_h™dÀr
Ë
NULL
,

2224 (
iw_h™dÀr
Ë
π_io˘l_siwícode
,

2225 (
iw_h™dÀr
Ë
π_io˘l_giwícode
,

2226 (
iw_h™dÀr
Ë
NULL
,

2227 (
iw_h™dÀr
Ë
NULL
,

2228 (
iw_h™dÀr
Ë
NULL
,

2229 (
iw_h™dÀr
Ë
NULL
,

2230 #i‡
WIRELESS_EXT
 > 17

2232 (
iw_h™dÀr
Ë
π_io˘l_siwgíõ
,

2233 (
iw_h™dÀr
Ë
π_io˘l_giwgíõ
,

2235 (
iw_h™dÀr
Ë
π_io˘l_siwauth
,

2236 (
iw_h™dÀr
Ë
π_io˘l_giwauth
,

2238 (
iw_h™dÀr
Ë
π_io˘l_siwícodìxt
,

2239 (
iw_h™dÀr
Ë
π_io˘l_giwícodìxt
,

2241 (
iw_h™dÀr
Ë
π_io˘l_siwpmkß
,

2246 c⁄° 
iw_h™dÀr
 
	gπ_¥iv_h™dÀrs
[] = {

2247 (
iw_h™dÀr
Ë
NULL
,

2248 (
iw_h™dÀr
Ë
π_io˘l_£ç¨am
,

2251 c⁄° 
iw_h™dÀr_def
 
	gπ73_iw_h™dÀr_def
 =

2253 
	#N
(
a
Ë( (aË/  (a[0]))

	)

2254 .
°™d¨d
 = (
iw_h™dÀr
 *Ë
π_h™dÀr
,

2255 .
	gnum_°™d¨d
 = (
π_h™dÀr
Ë/ (
iw_h™dÀr
),

2256 .
	g¥iv©e
 = (
iw_h™dÀr
 *Ë
π_¥iv_h™dÀrs
,

2257 .
	gnum_¥iv©e
 = 
N
(
π_¥iv_h™dÀrs
),

2258 .
	g¥iv©e_¨gs
 = (
iw_¥iv_¨gs
 *Ë
¥ivèb
,

2259 .
	gnum_¥iv©e_¨gs
 = 
N
(
¥ivèb
),

2260 #i‡
WIRELESS_EXT
 > 15

2263 #i‡
WIRELESS_EXT
 > 20

2264 .
	ggë_wúñess_°©s
 = 
π73_gë_wúñess_°©s
,

2268 
INT
 
	$RTMPSëInf‹m©i⁄
(

2269 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

2270 
IN
 
OUT
 
i‰eq
 *
rq
,

2271 
IN
 
INT
 
cmd
)

2273 
iwªq
 *
wrq
 = (iwªq *Ë
rq
;

2274 
NDIS_802_11_SSID
 
Ssid
, *
pSsid
=
NULL
;

2275 
NDIS_802_11_MAC_ADDRESS
 
Bssid
;

2276 
RT_802_11_PHY_MODE
 
PhyMode
;

2277 
RT_802_11_STA_CONFIG
 
SèC⁄fig
, *
pSèC⁄fig
=
NULL
;

2278 
NDIS_802_11_RATES
 
¨yR©es
;

2279 
RT_802_11_PREAMBLE
 
PªambÀ
;

2280 
NDIS_802_11_WEP_STATUS
 
WïSètus
;

2281 
NDIS_802_11_AUTHENTICATION_MODE
 
AuthMode
;

2282 
NDIS_802_11_NETWORK_INFRASTRUCTURE
 
BssTy≥
;

2283 
NDIS_802_11_RTS_THRESHOLD
 
RtsThªsh
;

2284 
NDIS_802_11_FRAGMENTATION_THRESHOLD
 
FøgThªsh
;

2285 
NDIS_802_11_POWER_MODE
 
PowîMode
;

2286 
NDIS_802_11_TX_POWER_LEVEL
 
TxPowîLevñ
;

2287 
PNDIS_802_11_KEY
 
pKey
 = 
NULL
;

2288 
PNDIS_802_11_REMOVE_KEY
 
pRemoveKey
 = 
NULL
;

2289 
NDIS_802_11_CONFIGURATION
 
C⁄fig
, *
pC⁄fig
 = 
NULL
;

2290 
NDIS_802_11_NETWORK_TYPE
 
NëTy≥
;

2291 
ULONG
 
Now
;

2292 
ULONG
 
KeyIdx
;

2293 
INT
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

2294 
ULONG
 
A¡Div
;

2295 
BOOLEAN
 
RadioSèã
;

2296 
BOOLEAN
 
SèãMachöeTouched
 = 
FALSE
;

2298 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


2299 
PNDIS_802_11_WEP
 
pWïKey
 =
NULL
;

2300 
PNDIS_802_11_PMKID
 
pPmkId
 = 
NULL
;

2301 
BOOLEAN
 
IEEE8021xSèã
;

2302 
BOOLEAN
 
IEEE8021x_ªquúed_keys
;

2303 
BOOLEAN
 
w∑_suµliˇ¡_íabÀ
;

2306 
cmd
 & 0x7FFF) {

2307 
RT_OID_802_11_COUNTRY_REGION
:

2308 i‡(
wrq
->
u
.
d©a
.
Àngth
 < (
UCHAR
))

2309 
Sètus
 = -
EINVAL
;

2310 i‡(!(
pAd≠ãr
->
P‹tCfg
.
Cou¡ryRegi⁄
 & 0x80Ë&& !’Ad≠ãr->P‹tCfg.
Cou¡ryRegi⁄F‹AB™d
 & 0x80))

2312 
ULONG
 
Cou¡ry
;

2313 
UCHAR
 
TmpPhy
;

2315 
Sètus
 = 
	`c›y_‰om_u£r
(&
Cou¡ry
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2316 
pAd≠ãr
->
P‹tCfg
.
Cou¡ryRegi⁄
 = (
UCHAR
)(
Cou¡ry
 & 0x000000FF);

2317 
pAd≠ãr
->
P‹tCfg
.
Cou¡ryRegi⁄F‹AB™d
 = (
UCHAR
)((
Cou¡ry
 >> 8) & 0x000000FF);

2319 
TmpPhy
 = 
pAd≠ãr
->
P‹tCfg
.
PhyMode
;

2320 
pAd≠ãr
->
P‹tCfg
.
PhyMode
 = 0xff;

2322 
Sètus
 = 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
RT_OID_802_11_SET_PHY_MODE
, 
TRUE
, &
TmpPhy
, (TmpPhy));

2323 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::RT_OID_802_11_SET_COUNTRY_REGION (A:%d B/G:%d)\n", 
pAd≠ãr
->
P‹tCfg
.
Cou¡ryRegi⁄F‹AB™d
,

2324 
pAd≠ãr
->
P‹tCfg
.
Cou¡ryRegi⁄
);

2327 
OID_802_11_BSSID_LIST_SCAN
:

2328 
Now
 = 
jiffõs
;

2329 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_BSSID_LIST_SCAN, TxC¡ = %d \n", 
pAd≠ãr
->
BulkLa°O√SecCou¡
);

2331 #ifde‡
RALINK_ATE


2332 if(
pAd≠ãr
->
©e
.
Mode
 !
ATE_STASTART
)

2334 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "The driver is in ATE modeÇow\n");

2339 i‡(
pAd≠ãr
->
BulkLa°O√SecCou¡
 > 100)

2341 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "!!! Link UP, ignoreÅhis set::OID_802_11_BSSID_LIST_SCAN\n");

2343 
pAd≠ãr
->
P‹tCfg
.
SˇnC¡
 = 99;

2347 i‡((
	`OPSTATUS_TEST_FLAG
(
pAd≠ãr
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
)) &&

2348 ((
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA
) ||

2349 (
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAPSK
) ||

2350 (
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2
) ||

2351 (
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2PSK
)

2352 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


2353 || (
pAd≠ãr
->
P‹tCfg
.
IEEE8021X
 =
TRUE
)

2356 (
pAd≠ãr
->
P‹tCfg
.
P‹tSecuªd
 =
WPA_802_1X_PORT_NOT_SECURED
))

2358 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "!!! Link UP, Port Not Secured! ignoreÅhis set::OID_802_11_BSSID_LIST_SCAN\n");

2359 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

2360 
pAd≠ãr
->
P‹tCfg
.
SˇnC¡
 = 99;

2364 
Sètus
 = 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
OID_802_11_BSSID_LIST_SCAN
, 
TRUE
, 
NULL
, 0);

2366 
OID_802_11_SSID
:

2367 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_SSID
))

2368 
Sètus
 = -
EINVAL
;

2371 
Sètus
 = 
	`c›y_‰om_u£r
(&
Ssid
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2372 
pSsid
 = &
Ssid
;

2374 i‡(
pSsid
->
SsidLígth
 > 
MAX_LEN_OF_SSID
)

2375 
Sètus
 = -
EINVAL
;

2379 i‡(
pSsid
->
SsidLígth
 == 0)

2381 
	`mem˝y
(
pSsid
->
Ssid
, "", 0);

2384 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
OID_802_11_SSID
, 
TRUE
, 
pSsid
, (
NDIS_802_11_SSID
));

2385 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_SSID (Lí=%d,Ssid=%s)\n", 
pSsid
->
SsidLígth
,ÖSsid->
Ssid
);

2389 
OID_802_11_BSSID
:

2390 #ifde‡
RALINK_ATE


2391 if(
pAd≠ãr
->
©e
.
Mode
 !
ATE_STASTART
)

2393 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "The driver is in ATE modeÇow\n");

2394 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

2399 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_MAC_ADDRESS
))

2400 
Sètus
 = -
EINVAL
;

2403 
Sètus
 = 
	`c›y_‰om_u£r
(&
Bssid
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2405 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
RT_OID_802_11_BSSID
, 
TRUE
, &
Bssid
, 
wrq
->
u
.
d©a
.
Àngth
);

2406 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_802_11_BSSID %02x:%02x:%02x:%02x:%02x:%02x\n",

2407 
Bssid
[0], Bssid[1], Bssid[2], Bssid[3], Bssid[4], Bssid[5]);

2410 
RT_OID_802_11_RADIO
:

2411 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
BOOLEAN
))

2412 
Sètus
 = -
EINVAL
;

2415 
Sètus
 = 
	`c›y_‰om_u£r
(&
RadioSèã
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2416 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::RT_OID_802_11_RADIO (=%d)\n", 
RadioSèã
);

2417 i‡(
pAd≠ãr
->
P‹tCfg
.
bSwRadio
 !
RadioSèã
)

2419 
pAd≠ãr
->
P‹tCfg
.
bSwRadio
 = 
RadioSèã
;

2420 i‡(
pAd≠ãr
->
P‹tCfg
.
bRadio
 !’Ad≠ãr->P‹tCfg.
bHwRadio
 &&ÖAd≠ãr->P‹tCfg.
bSwRadio
))

2422 
pAd≠ãr
->
P‹tCfg
.
bRadio
 = (pAd≠ãr->P‹tCfg.
bHwRadio
 &&ÖAd≠ãr->P‹tCfg.
bSwRadio
);

2423 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
RT_OID_SET_RADIO
, 
TRUE
, 
NULL
, 0);

2428 
RT_OID_802_11_PHY_MODE
:

2429 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
RT_802_11_PHY_MODE
))

2430 
Sètus
 = -
EINVAL
;

2433 
Sètus
 = 
	`c›y_‰om_u£r
(&
PhyMode
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2434 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
RT_OID_802_11_PHY_MODE
, 
TRUE
, &
PhyMode
, (
RT_802_11_PHY_MODE
));

2435 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::RT_OID_802_11_PHY_MODE (=%d)\n", 
PhyMode
);

2438 
RT_OID_802_11_STA_CONFIG
:

2439 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
RT_802_11_STA_CONFIG
))

2440 
Sètus
 = -
EINVAL
;

2443 
Sètus
 = 
	`c›y_‰om_u£r
(&
SèC⁄fig
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2444 
pSèC⁄fig
 = &
SèC⁄fig
;

2445 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
RT_OID_802_11_STA_CONFIG
, 
TRUE
, 
pSèC⁄fig
, (
RT_802_11_STA_CONFIG
));

2447 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::RT_OID_802_11_SET_STA_CONFIG (Burst=%d,BGprot=%d,ShortSlot=%d,Adhoc=%d\n",

2448 
pSèC⁄fig
->
E«bÀTxBur°
,

2449 
pSèC⁄fig
->
U£BGPrŸe˘i⁄
,

2450 
pSèC⁄fig
->
U£Sh‹tSlŸTime
,

2451 
pSèC⁄fig
->
AdhocMode
);

2454 
OID_802_11_DESIRED_RATES
:

2455 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_RATES
))

2456 
Sètus
 = -
EINVAL
;

2459 
Sètus
 = 
	`c›y_‰om_u£r
(&
¨yR©es
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2460 
	`NdisZîoMem‹y
(
pAd≠ãr
->
P‹tCfg
.
DesúeR©e
, 
MAX_LEN_OF_SUPPORTED_RATES
);

2461 
	`NdisMoveMem‹y
(
pAd≠ãr
->
P‹tCfg
.
DesúeR©e
, &
¨yR©es
, (
NDIS_802_11_RATES
));

2462 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_802_11_DESIRED_RATES (%02x,%02x,%02x,%02x,%02x,%02x,%02x,%02x)\n",

2463 
pAd≠ãr
->
P‹tCfg
.
DesúeR©e
[0],pAdapter->PortCfg.DesireRate[1],

2464 
pAd≠ãr
->
P‹tCfg
.
DesúeR©e
[2],pAdapter->PortCfg.DesireRate[3],

2465 
pAd≠ãr
->
P‹tCfg
.
DesúeR©e
[4],pAdapter->PortCfg.DesireRate[5],

2466 
pAd≠ãr
->
P‹tCfg
.
DesúeR©e
[6],pAdapter->PortCfg.DesireRate[7] );

2468 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
RT_OID_UPDATE_TX_RATE
, 
TRUE
, 
NULL
, 0);

2471 
RT_OID_802_11_PREAMBLE
:

2472 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
RT_802_11_PREAMBLE
))

2473 
Sètus
 = -
EINVAL
;

2476 
Sètus
 = 
	`c›y_‰om_u£r
(&
PªambÀ
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2477 i‡((
PªambÀ
 =
Rt802_11PªambÀSh‹t
Ë|| (PªambÀ =
Rt802_11PªambÀL⁄g
Ë|| (PªambÀ =
Rt802_11PªambÀAuto
))

2479 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
RT_OID_802_11_PREAMBLE
, 
TRUE
, &
PªambÀ
, (
RT_802_11_PREAMBLE
));

2483 
Sètus
 = -
EINVAL
;

2486 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::RT_OID_802_11_SET_PREAMBLE (=%d)\n", 
PªambÀ
);

2489 
OID_802_11_WEP_STATUS
:

2490 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_WEP_STATUS
))

2491 
Sètus
 = -
EINVAL
;

2494 
Sètus
 = 
	`c›y_‰om_u£r
(&
WïSètus
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2496 i‡(
WïSètus
 <
Ndis802_11En¸y±i⁄3KeyAb£¡
)

2498 i‡(
pAd≠ãr
->
P‹tCfg
.
WïSètus
 != WepStatus)

2501 
pAd≠ãr
->
bC⁄figCh™ged
 = 
TRUE
;

2504 
pAd≠ãr
->
P‹tCfg
.
WïSètus
 = WepStatus;

2505 
pAd≠ãr
->
P‹tCfg
.
OrigWïSètus
 = 
WïSètus
;

2506 
pAd≠ãr
->
P‹tCfg
.
PaúCùhî
 = 
WïSètus
;

2507 
pAd≠ãr
->
P‹tCfg
.
GroupCùhî
 = 
WïSètus
;

2511 
Sètus
 = -
EINVAL
;

2514 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_WEP_STATUS (=%d)\n",
WïSètus
);

2517 
OID_802_11_AUTHENTICATION_MODE
:

2518 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_AUTHENTICATION_MODE
))

2519 
Sètus
 = -
EINVAL
;

2522 
Sètus
 = 
	`c›y_‰om_u£r
(&
AuthMode
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2523 i‡(
AuthMode
 > 
Ndis802_11AuthModeMax
)

2525 
Sètus
 = -
EINVAL
;

2530 i‡(
pAd≠ãr
->
P‹tCfg
.
AuthMode
 != AuthMode)

2533 
pAd≠ãr
->
bC⁄figCh™ged
 = 
TRUE
;

2535 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 = AuthMode;

2537 
pAd≠ãr
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_NOT_SECURED
;

2538 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_AUTHENTICATION_MODE (=%dË\n",
pAd≠ãr
->
P‹tCfg
.
AuthMode
);

2541 
OID_802_11_INFRASTRUCTURE_MODE
:

2542 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_NETWORK_INFRASTRUCTURE
))

2543 
Sètus
 = -
EINVAL
;

2546 
Sètus
 = 
	`c›y_‰om_u£r
(&
BssTy≥
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2547 i‡(
BssTy≥
 =
Ndis802_11IBSS
)

2549 i‡(
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 !
BSS_ADHOC
)

2552 i‡(
	`INFRA_ON
(
pAd≠ãr
))

2554 
	`RTUSBEnqueueI¡î«lCmd
(
pAd≠ãr
, 
RT_OID_LINK_DOWN
);

2556 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "NDIS_STATUS_MEDIA_DISCONNECT Event BB!\n");

2560 
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 = 
BSS_ADHOC
;

2561 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_802_11_INFRASTRUCTURE_MODE (AD-HOC)\n");

2563 i‡(
BssTy≥
 =
Ndis802_11In‰a°ru˘uª
)

2565 i‡(
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 !
BSS_INFRA
)

2569 i‡(
	`ADHOC_ON
(
pAd≠ãr
))

2570 
	`RTUSBEnqueueI¡î«lCmd
(
pAd≠ãr
, 
RT_OID_LINK_DOWN
);

2572 
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 = 
BSS_INFRA
;

2573 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_802_11_INFRASTRUCTURE_MODE (INFRA)\n");

2577 
Sètus
 = -
EINVAL
;

2578 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_802_11_INFRASTRUCTURE_MODE (unknown)\n");

2582 
pAd≠ãr
->
P‹tCfg
.
W∑Sèã
 = 
SS_NOTUSE
;

2585 
OID_802_11_REMOVE_WEP
:

2586 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_802_11_REMOVE_WEP\n");

2587 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_KEY_INDEX
)){

2588 
Sètus
 = -
EINVAL
;

2592 
KeyIdx
 = *(
NDIS_802_11_KEY_INDEX
 *Ë
wrq
->
u
.
d©a
.
poöãr
;

2594 i‡(
KeyIdx
 & 0x80000000)

2597 
Sètus
 = -
EINVAL
;

2601 
KeyIdx
 = KeyIdx & 0x0fffffff;

2602 i‡(
KeyIdx
 >= 4)

2604 
Sètus
 = -
EINVAL
;

2608 
pAd≠ãr
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 = 0;

2609 
pAd≠ãr
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = 
CIPHER_NONE
;

2610 
	`AsicRemoveSh¨edKeyE¡ry
(
pAd≠ãr
, 0, (
UCHAR
)
KeyIdx
);

2616 
RT_OID_802_11_RESET_COUNTERS
:

2617 
	`NdisZîoMem‹y
(&
pAd≠ãr
->
WœnCou¡îs
, (
COUNTER_802_11
));

2618 
	`NdisZîoMem‹y
(&
pAd≠ãr
->
Cou¡îs8023
, (
COUNTER_802_3
));

2619 
	`NdisZîoMem‹y
(&
pAd≠ãr
->
RÆökCou¡îs
, (
COUNTER_RALINK
));

2620 
pAd≠ãr
->
Cou¡îs8023
.
RxNoBuf„r
 = 0;

2621 
pAd≠ãr
->
Cou¡îs8023
.
GoodRe˚ives
 = 0;

2622 
pAd≠ãr
->
Cou¡îs8023
.
RxNoBuf„r
 = 0;

2623 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::RT_OID_802_11_RESET_COUNTERS (=%d)\n", 
pAd≠ãr
->
Cou¡îs8023
.
GoodRe˚ives
);

2625 
OID_802_11_RTS_THRESHOLD
:

2626 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_RTS_THRESHOLD
))

2627 
Sètus
 = -
EINVAL
;

2630 
Sètus
 = 
	`c›y_‰om_u£r
(&
RtsThªsh
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2631 i‡(
RtsThªsh
 > 
MAX_RTS_THRESHOLD
)

2632 
Sètus
 = -
EINVAL
;

2634 
pAd≠ãr
->
P‹tCfg
.
RtsThªshﬁd
 = (
USHORT
)
RtsThªsh
;

2636 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_RTS_THRESHOLD (=%d)\n",
RtsThªsh
);

2638 
OID_802_11_FRAGMENTATION_THRESHOLD
:

2639 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_FRAGMENTATION_THRESHOLD
))

2640 
Sètus
 = -
EINVAL
;

2643 
Sètus
 = 
	`c›y_‰om_u£r
(&
FøgThªsh
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2644 
pAd≠ãr
->
P‹tCfg
.
bFøgmítZîoDißbÀ
 = 
FALSE
;

2645 i‡(
FøgThªsh
 > 
MAX_FRAG_THRESHOLD
 || FøgThªsh < 
MIN_FRAG_THRESHOLD
)

2647 i‡(
FøgThªsh
 == 0)

2649 
pAd≠ãr
->
P‹tCfg
.
FøgmítThªshﬁd
 = 
MAX_FRAG_THRESHOLD
;

2650 
pAd≠ãr
->
P‹tCfg
.
bFøgmítZîoDißbÀ
 = 
TRUE
;

2653 
Sètus
 = -
EINVAL
;

2656 
pAd≠ãr
->
P‹tCfg
.
FøgmítThªshﬁd
 = (
USHORT
)
FøgThªsh
;

2658 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_FRAGMENTATION_THRESHOLD (=%dË\n",
FøgThªsh
);

2660 
OID_802_11_POWER_MODE
:

2661 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_POWER_MODE
))

2662 
Sètus
 = -
EINVAL
;

2665 
Sètus
 = 
	`c›y_‰om_u£r
(&
PowîMode
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2667 i‡(
PowîMode
 =
Ndis802_11PowîModeCAM
)

2670 
	`MlmeSëPsmBô
(
pAd≠ãr
, 
PWR_ACTIVE
);

2672 
	`OPSTATUS_SET_FLAG
(
pAd≠ãr
, 
fOP_STATUS_RECEIVE_DTIM
);

2673 i‡(
pAd≠ãr
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

2674 
pAd≠ãr
->
P‹tCfg
.
WödowsPowîMode
 = 
PowîMode
;

2675 
pAd≠ãr
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
PowîMode
;

2677 i‡(
PowîMode
 =
Ndis802_11PowîModeMAX_PSP
)

2682 i‡(
pAd≠ãr
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

2683 
pAd≠ãr
->
P‹tCfg
.
WödowsPowîMode
 = 
PowîMode
;

2684 
pAd≠ãr
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
PowîMode
;

2685 
	`OPSTATUS_SET_FLAG
(
pAd≠ãr
, 
fOP_STATUS_RECEIVE_DTIM
);

2686 
pAd≠ãr
->
P‹tCfg
.
DeÁu…Li°íCou¡
 = 5;

2688 i‡(
PowîMode
 =
Ndis802_11PowîModeFa°_PSP
)

2693 
	`OPSTATUS_SET_FLAG
(
pAd≠ãr
, 
fOP_STATUS_RECEIVE_DTIM
);

2694 i‡(
pAd≠ãr
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

2695 
pAd≠ãr
->
P‹tCfg
.
WödowsPowîMode
 = 
PowîMode
;

2696 
pAd≠ãr
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
PowîMode
;

2697 
pAd≠ãr
->
P‹tCfg
.
DeÁu…Li°íCou¡
 = 3;

2700 
Sètus
 = -
EINVAL
;

2702 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_POWER_MODE (=%d)\n",
PowîMode
);

2704 
OID_802_11_TX_POWER_LEVEL
:

2705 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_TX_POWER_LEVEL
))

2706 
Sètus
 = -
EINVAL
;

2709 
Sètus
 = 
	`c›y_‰om_u£r
(&
TxPowîLevñ
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2710 i‡(
TxPowîLevñ
 > 
MAX_TX_POWER_LEVEL
)

2711 
Sètus
 = -
EINVAL
;

2713 
pAd≠ãr
->
P‹tCfg
.
TxPowî
 = (
UCHAR
)
TxPowîLevñ
;

2715 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_TX_POWER_LEVEL (=%dË\n",
TxPowîLevñ
);

2717 
RT_OID_802_11_TX_POWER_LEVEL_1
:

2718 i‡(
wrq
->
u
.
d©a
.
Àngth
 < (
ULONG
))

2719 
Sètus
 = -
EINVAL
;

2722 
ULONG
 
PowîTemp
;

2724 
Sètus
 = 
	`c›y_‰om_u£r
(&
PowîTemp
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2725 i‡(
PowîTemp
 > 100)

2726 
PowîTemp
 = 0xffffffff;

2727 
pAd≠ãr
->
P‹tCfg
.
TxPowîDeÁu…
 = 
PowîTemp
;

2732 
pAd≠ãr
->
P‹tCfg
.
TxPowîPî˚¡age
 =ÖAd≠ãr->P‹tCfg.
TxPowîDeÁu…
;

2733 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::RT_OID_802_11_TX_POWER_LEVEL_1 (=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
TxPowîPî˚¡age
);

2736 
OID_802_11_PRIVACY_FILTER
:

2737 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_PRIVACY_FILTER
))

2738 
Sètus
 = -
EINVAL
;

2741 
NDIS_802_11_PRIVACY_FILTER
 
Fûãr
;

2743 
Sètus
 = 
	`c›y_‰om_u£r
(&
Fûãr
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2744 i‡((
Fûãr
 =
Ndis802_11PrivFûãrAc˚±AŒ
Ë|| (Fûã∏=
Ndis802_11PrivFûãr8021xWEP
))

2745 
pAd≠ãr
->
P‹tCfg
.
PrivacyFûãr
 = 
Fûãr
;

2747 
Sètus
 = -
EINVAL
;

2749 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_PRIVACY_FILTER (=%dË\n",
pAd≠ãr
->
P‹tCfg
.
PrivacyFûãr
);

2751 
OID_802_11_NETWORK_TYPE_IN_USE
:

2752 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_NETWORK_TYPE
))

2753 
Sètus
 = -
EINVAL
;

2756 
Sètus
 = 
	`c›y_‰om_u£r
(&
NëTy≥
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2757 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
OID_802_11_NETWORK_TYPE_IN_USE
, 
TRUE
, &
NëTy≥
, 
wrq
->
u
.
d©a
.
Àngth
);

2758 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_NETWORK_TYPE_IN_USE (=%d)\n",
NëTy≥
);

2762 
OID_802_11_RX_ANTENNA_SELECTED
:

2763 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_ANTENNA
))

2764 
Sètus
 = -
EINVAL
;

2767 
Sètus
 = 
	`c›y_‰om_u£r
(&
A¡Div
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2768 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
OID_802_11_RX_ANTENNA_SELECTED
, 
FALSE
, &
A¡Div
, 
wrq
->
u
.
d©a
.
Àngth
);

2771 
OID_802_11_TX_ANTENNA_SELECTED
:

2772 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_ANTENNA
))

2773 
Sètus
 = -
EINVAL
;

2776 
Sètus
 = 
	`c›y_‰om_u£r
(&
A¡Div
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2777 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
OID_802_11_TX_ANTENNA_SELECTED
, 
FALSE
, &
A¡Div
, 
wrq
->
u
.
d©a
.
Àngth
);

2781 
RT_OID_802_11_ADD_WPA
:

2782 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "!!!!!!!!!!!!!!!!!!!!!Set::RT_OID_802_11_ADD_WPA !!\n");

2783 
pKey
 = 
	`kmÆloc
(
wrq
->
u
.
d©a
.
Àngth
, 
MEM_ALLOC_FLAG
);

2784 if(
pKey
 =
NULL
)

2786 
Sètus
 = -
ENOMEM
;

2790 
Sètus
 = 
	`c›y_‰om_u£r
(
pKey
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2791 i‡(
pKey
->
Lígth
 !
wrq
->
u
.
d©a
.
Àngth
)

2793 
Sètus
 = -
EINVAL
;

2794 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::RT_OID_802_11_ADD_WPA, Failed!!\n");

2798 i‡((
pAd≠ãr
->
P‹tCfg
.
AuthMode
 !
Ndis802_11AuthModeWPAPSK
) &&\

2799 (
pAd≠ãr
->
P‹tCfg
.
AuthMode
 !
Ndis802_11AuthModeWPA2PSK
) &&\

2800 (
pAd≠ãr
->
P‹tCfg
.
AuthMode
 !
Ndis802_11AuthModeWPAN⁄e
) )

2802 
Sètus
 = -
EOPNOTSUPP
;

2803 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::RT_OID_802_11_ADD_WPA, Failed!! [AuthMode != WPAPSK/WPA2PSK/WPANONE]\n");

2805 i‡((
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAPSK
) ||\

2806 (
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2PSK
) )

2808 
INT
 
i
;

2810 
pAd≠ãr
->
P‹tCfg
.
PskKey
.
KeyLí
 = (
UCHAR
Ë
pKey
->
KeyLígth
;

2811 
	`NdisMoveMem‹y
(
pAd≠ãr
->
P‹tCfg
.
PskKey
.
Key
, &
pKey
->
KeyM©îül
,ÖKey->
KeyLígth
);

2814 
pAd≠ãr
->
P‹tCfg
.
W∑Sèã
 = 
SS_START
;

2816 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"PskKey = Lí = %d \¿",
pKey
->
KeyLígth
);

2817 
i
 = 0; i < 32; i++)

2819 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"%02x:", 
pAd≠ãr
->
P‹tCfg
.
PskKey
.
Key
[
i
]);

2821 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"\n");

2824 
pAd≠ãr
->
P‹tCfg
.
W∑Sèã
 = 
SS_START
;

2825 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::RT_OID_802_11_ADD_WPA (id=0x%x, Lí=%d-byã)\n", 
pKey
->
KeyIndex
,ÖKey->
KeyLígth
);

2829 
Sètus
 = 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
OID_802_11_ADD_KEY
, 
TRUE
, 
pKey
,ÖKey->
Lígth
);

2832 
	`k‰ì
(
pKey
);

2834 
OID_802_11_REMOVE_KEY
:

2835 
pRemoveKey
 = 
	`kmÆloc
(
wrq
->
u
.
d©a
.
Àngth
, 
MEM_ALLOC_FLAG
);

2836 if(
pRemoveKey
 =
NULL
)

2838 
Sètus
 = -
ENOMEM
;

2842 
Sètus
 = 
	`c›y_‰om_u£r
(
pRemoveKey
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2843 i‡(
pRemoveKey
->
Lígth
 !
wrq
->
u
.
d©a
.
Àngth
)

2845 
Sètus
 = -
EINVAL
;

2846 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_802_11_REMOVE_KEY, Failed!!\n");

2850 
Sètus
 = 
	`RTMPRemoveKeyS™ôy
(
pAd≠ãr
, 
pRemoveKey
);

2851 i‡(
Sètus
 =
NDIS_STATUS_SUCCESS
)

2853 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
OID_802_11_REMOVE_KEY
, 
TRUE
, 
pRemoveKey
, 
wrq
->
u
.
d©a
.
Àngth
);

2856 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_REMOVE_KEY (id=0x%x, Lí=%d-byã)\n", 
pRemoveKey
->
KeyIndex
,ÖRemoveKey->
Lígth
);

2857 
	`k‰ì
(
pRemoveKey
);

2860 
OID_802_11_ADD_KEY
:

2861 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "!!!!!!!!!!!!!!!!!!!!!Set::OID_802_11_ADD_KEY !!\n");

2862 
pKey
 = 
	`kmÆloc
(
wrq
->
u
.
d©a
.
Àngth
, 
MEM_ALLOC_FLAG
);

2863 if(
pKey
 =
NULL
)

2865 
Sètus
 = -
ENOMEM
;

2869 
Sètus
 = 
	`c›y_‰om_u£r
(
pKey
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2870 i‡(
pKey
->
Lígth
 !
wrq
->
u
.
d©a
.
Àngth
)

2872 
Sètus
 = -
EINVAL
;

2873 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_802_11_ADD_KEY, Failed!!\n");

2877 i‡(
pAd≠ãr
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
)

2881 if(
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAN⁄e
)

2883 
	`NdisMoveMem‹y
(
pKey
->
BSSID
, 
BROADCAST_ADDR
, 6);

2886 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
OID_802_11_ADD_KEY
, 
TRUE
, 
pKey
,ÖKey->
Lígth
);

2890 
Sètus
 = 
	`RTMPWPAWïKeyS™ôy
(
pAd≠ãr
, 
pKey
);

2891 i‡(
Sètus
 =
NDIS_STATUS_SUCCESS
)

2892 
	`RTUSBEnqueueCmdFromNdis
(
pAd≠ãr
, 
OID_802_11_ADD_KEY_WEP
, 
TRUE
, 
pKey
, 
wrq
->
u
.
d©a
.
Àngth
);

2895 
KeyIdx
 = 
pKey
->
KeyIndex
 & 0x0fffffff;

2896 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_ADD_KEY (id=0x%x, Lí=%d-byã)\n", 
KeyIdx
, 
pKey
->
KeyLígth
);

2898 
	`k‰ì
(
pKey
);

2900 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


2901 
OID_802_11_SET_IEEE8021X
:

2902 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
BOOLEAN
))

2903 
Sètus
 = -
EINVAL
;

2906 
Sètus
 = 
	`c›y_‰om_u£r
(&
IEEE8021xSèã
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2907 
pAd≠ãr
->
P‹tCfg
.
IEEE8021X
 = 
IEEE8021xSèã
;

2911 if(
pAd≠ãr
->
P‹tCfg
.
IEEE8021X
 =
FALSE
 &&ÖAd≠ãr->P‹tCfg.
AuthMode
 < 
Ndis802_11AuthModeWPA
 )

2913 
idx
;

2915 
idx
 = 
pAd≠ãr
->
P‹tCfg
.
DeÁu…KeyId
;

2918 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "Set WEP keyÅo Asic for static wep mode =>\n");

2920 if(
pAd≠ãr
->
P‹tCfg
.
DesúeSh¨edKey
[
idx
].
KeyLí
 != 0)

2922 
pAd≠ãr
->
Sh¨edKey
[
idx
].
KeyLí
 =ÖAd≠ãr->
P‹tCfg
.
DesúeSh¨edKey
[idx].KeyLen;

2923 
	`NdisMoveMem‹y
(
pAd≠ãr
->
Sh¨edKey
[
idx
].
Key
,ÖAd≠ãr->
P‹tCfg
.
DesúeSh¨edKey
[idx].Key,ÖAd≠ãr->Sh¨edKey[idx].
KeyLí
);

2925 
pAd≠ãr
->
Sh¨edKey
[
idx
].
CùhîAlg
 =ÖAd≠ãr->
P‹tCfg
.
DesúeSh¨edKey
[idx].CipherAlg;

2927 
	`AsicAddSh¨edKeyE¡ry
(
pAd≠ãr
, 0, (
UCHAR
)
idx
,ÖAd≠ãr->
Sh¨edKey
[idx].
CùhîAlg
,ÖAd≠ãr->Sh¨edKey[idx].
Key
, 
NULL
, NULL);

2934 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_SET_IEEE8021X (=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
IEEE8021X
);

2937 
OID_802_11_SET_IEEE8021X_REQUIRE_KEY
:

2938 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
BOOLEAN
))

2939 
Sètus
 = -
EINVAL
;

2942 
Sètus
 = 
	`c›y_‰om_u£r
(&
IEEE8021x_ªquúed_keys
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2943 
pAd≠ãr
->
P‹tCfg
.
IEEE8021x_ªquúed_keys
 = IEEE8021x_required_keys;

2944 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_SET_IEEE8021X_REQUIRE_KEY (%d)\n", 
pAd≠ãr
->
P‹tCfg
.
IEEE8021x_ªquúed_keys
);

2948 
OID_802_11_ADD_WEP
:

2949 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "!!!!!!!!!!!!!!!!!!!!!Set::OID_802_11_ADD_WEP !!\n");

2950 
pWïKey
 = 
	`kmÆloc
(
wrq
->
u
.
d©a
.
Àngth
, 
MEM_ALLOC_FLAG
);

2952 if(
pWïKey
 =
NULL
)

2954 
Sètus
 = -
ENOMEM
;

2955 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_802_11_ADD_WEP, Failed!!\n");

2958 
Sètus
 = 
	`c›y_‰om_u£r
(
pWïKey
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

2959 i‡(
pWïKey
->
Lígth
 !
wrq
->
u
.
d©a
.
Àngth
)

2961 
Sètus
 = -
EINVAL
;

2962 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_802_11_ADD_WEP, Failed (length mismatch)!!\n");

2967 
KeyIdx
 = 
pWïKey
->
KeyIndex
 & 0x0fffffff;

2970 i‡(
KeyIdx
 > 4)

2972 
Sètus
 = -
EINVAL
;

2973 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_802_11_ADD_WEP, Failed (KeyIdx must be smallerÅhan 4)!!\n");

2980 if(
pAd≠ãr
->
P‹tCfg
.
P‹tSecuªd
 =
WPA_802_1X_PORT_SECURED
)

2982 
UCHAR
 
CùhîAlg
;

2984 
pAd≠ãr
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 = (
UCHAR
Ë
pWïKey
->
KeyLígth
;

2985 
	`NdisMoveMem‹y
(
pAd≠ãr
->
Sh¨edKey
[
KeyIdx
].
Key
, &
pWïKey
->
KeyM©îül
,ÖWïKey->
KeyLígth
);

2987 i‡(
pWïKey
->
KeyLígth
 == 5)

2988 
CùhîAlg
 = 
CIPHER_WEP64
;

2990 
CùhîAlg
 = 
CIPHER_WEP128
;

2992 
pAd≠ãr
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = CipherAlg;

2994 i‡(
pWïKey
->
KeyIndex
 & 0x80000000)

2997 
pAd≠ãr
->
P‹tCfg
.
DeÁu…KeyId
 = (
UCHAR
Ë
KeyIdx
;

3001 
	`AsicAddSh¨edKeyE¡ry
(
pAd≠ãr
, 0, (
UCHAR
)
KeyIdx
, 
CùhîAlg
,ÖAd≠ãr->
Sh¨edKey
[KeyIdx].
Key
, 
NULL
, NULL);

3003 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_ADD_WEP (id=0x%x, Lí=%d-byã), P‹àSecuªd\n", 
pWïKey
->
KeyIndex
,ÖWïKey->
KeyLígth
);

3008 
UCHAR
 
CùhîAlg
;

3010 
pAd≠ãr
->
P‹tCfg
.
DesúeSh¨edKey
[
KeyIdx
].
KeyLí
 = (
UCHAR
Ë
pWïKey
->
KeyLígth
;

3011 
	`NdisMoveMem‹y
(
pAd≠ãr
->
P‹tCfg
.
DesúeSh¨edKey
[
KeyIdx
].
Key
, &
pWïKey
->
KeyM©îül
,ÖWïKey->
KeyLígth
);

3013 i‡(
pWïKey
->
KeyLígth
 == 5)

3014 
CùhîAlg
 = 
CIPHER_WEP64
;

3016 
CùhîAlg
 = 
CIPHER_WEP128
;

3018 
pAd≠ãr
->
P‹tCfg
.
DesúeSh¨edKey
[
KeyIdx
].
CùhîAlg
 = CipherAlg;

3020 i‡(
pWïKey
->
KeyIndex
 & 0x80000000)

3023 
pAd≠ãr
->
P‹tCfg
.
DeÁu…KeyId
 = (
UCHAR
Ë
KeyIdx
;

3026 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::OID_802_11_ADD_WEP (id=0x%x, Lí=%d-byã), P‹àNŸ Secuªd\n", 
pWïKey
->
KeyIndex
,ÖWïKey->
KeyLígth
);

3031 
	`k‰ì
(
pWïKey
);

3034 
OID_802_11_CONFIGURATION
:

3035 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
NDIS_802_11_CONFIGURATION
))

3036 
Sètus
 = -
EINVAL
;

3039 
Sètus
 = 
	`c›y_‰om_u£r
(&
C⁄fig
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

3040 
pC⁄fig
 = &
C⁄fig
;

3042 i‡((
pC⁄fig
->
Bóc⁄Pîiod
 >= 20) && (pConfig->BeaconPeriod <=400))

3043 
pAd≠ãr
->
P‹tCfg
.
Bóc⁄Pîiod
 = (
USHORT
Ë
pC⁄fig
->BeaconPeriod;

3045 
pAd≠ãr
->
P‹tCfg
.
AtimWö
 = (
USHORT
Ë
pC⁄fig
->
ATIMWödow
;

3046 
	`MAP_KHZ_TO_CHANNEL_ID
(
pC⁄fig
->
DSC⁄fig
, 
pAd≠ãr
->
P‹tCfg
.
Ch™√l
);

3050 
pAd≠ãr
->
MlmeAux
.
Ch™√l
 =ÖAd≠ãr->
P‹tCfg
.Channel;

3052 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_802_11_CONFIGURATION (BeacnPeriod=%d,AtimW=%d,Ch=%d)\n",

3053 
pC⁄fig
->
Bóc⁄Pîiod
,ÖC⁄fig->
ATIMWödow
, 
pAd≠ãr
->
P‹tCfg
.
Ch™√l
);

3055 
pAd≠ãr
->
bC⁄figCh™ged
 = 
TRUE
;

3058 
OID_802_11_DISASSOCIATE
:

3059 #ifde‡
RALINK_ATE


3060 if(
pAd≠ãr
->
©e
.
Mode
 !
ATE_STASTART
)

3062 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "The driver is in ATE modeÇow\n");

3063 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

3069 
pAd≠ãr
->
MlmeAux
.
CuºReqIsFromNdis
 = 
TRUE
;

3071 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_802_11_DISASSOCIATE \n");

3073 i‡(
	`INFRA_ON
(
pAd≠ãr
))

3075 i‡(
pAd≠ãr
->
Mlme
.
C¡lMachöe
.
CuºSèã
 !
CNTL_IDLE
)

3077 
	`MlmeEnqueue
(
pAd≠ãr
,

3078 
MLME_CNTL_STATE_MACHINE
,

3079 
RT_CMD_RESET_MLME
,

3081 
NULL
);

3084 
	`MlmeEnqueue
(
pAd≠ãr
,

3085 
MLME_CNTL_STATE_MACHINE
,

3086 
OID_802_11_DISASSOCIATE
,

3088 
NULL
);

3090 
SèãMachöeTouched
 = 
TRUE
;

3093 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


3094 
OID_SET_COUNTERMEASURES
:

3095 i‡(
wrq
->
u
.
∑øm
.
vÆue
)

3097 
pAd≠ãr
->
P‹tCfg
.
bBlockAssoc
 = 
TRUE
;

3098 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_SET_COUNTERMEASURES bBlockAssoc=TRUE \n");

3103 
pAd≠ãr
->
P‹tCfg
.
bBlockAssoc
 = 
FALSE
;

3104 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set::OID_SET_COUNTERMEASURES bBlockAssoc=FALSE \n");

3107 
OID_802_11_PMKID
:

3108 
pPmkId
 = 
	`kmÆloc
(
wrq
->
u
.
d©a
.
Àngth
, 
MEM_ALLOC_FLAG
);

3110 if(
pPmkId
 =
NULL
) {

3111 
Sètus
 = -
ENOMEM
;

3114 
Sètus
 = 
	`c›y_‰om_u£r
(
pPmkId
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

3116 
	`DBGPRINT
(
RT_DEBUG_OFF
, "Set::OID_802_11_PMKID \n");

3122 i‡(
pPmkId
->
BSSIDInfoCou¡
 == 0)

3124 
ULONG
 
CachedIdx
;

3126 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s(): IW_PMKSA_FLUSH\n", 
__FUNCTION__
);

3127 
CachedIdx
 = 0; CachedIdx < 
pAd≠ãr
->
P‹tCfg
.
SavedPMKNum
; CachedIdx++)

3128 
	`NdisZîoMem‹y
(&
pAd≠ãr
->
P‹tCfg
.
SavedPMK
[
CachedIdx
], (
BSSID_INFO
));

3129 
pAd≠ãr
->
P‹tCfg
.
SavedPMKNum
 = 0;

3134 
PBSSID_INFO
 
pBssIdInfo
;

3135 
ULONG
 
BssIdx
;

3136 
ULONG
 
CachedIdx
;

3138 
BssIdx
 = 0; BssIdx < 
pPmkId
->
BSSIDInfoCou¡
; BssIdx++)

3141 
pBssIdInfo
 = (
PBSSID_INFO
Ë((
PUCHAR
Ë
pPmkId
 + 2 * (
ULONG
Ë+ 
BssIdx
 * (
BSSID_INFO
));

3143 
CachedIdx
 = 0; CachedIdx < 
pAd≠ãr
->
P‹tCfg
.
SavedPMKNum
; CachedIdx++)

3146 i‡(
	`NdisEquÆMem‹y
(
pBssIdInfo
->
BSSID
, 
pAd≠ãr
->
P‹tCfg
.
SavedPMK
[
CachedIdx
].BSSID, (
NDIS_802_11_MAC_ADDRESS
)))

3151 i‡(
CachedIdx
 < 
PMKID_NO
)

3153 
	`DBGPRINT
(
RT_DEBUG_OFF
, "Upd©êOID_802_11_PMKID, idx = %d\n", 
CachedIdx
);

3154 
	`NdisMoveMem‹y
(&
pAd≠ãr
->
P‹tCfg
.
SavedPMK
[
CachedIdx
], 
pBssIdInfo
, (
BSSID_INFO
));

3155 
pAd≠ãr
->
P‹tCfg
.
SavedPMKNum
++;

3161 
CachedIdx
 = (
pBssIdInfo
->
BSSID
[5] % 
PMKID_NO
);

3162 
	`DBGPRINT
(
RT_DEBUG_OFF
, "Upd©êOID_802_11_PMKID, idx = %d\n", 
CachedIdx
);

3163 
	`NdisMoveMem‹y
(&
pAd≠ãr
->
P‹tCfg
.
SavedPMK
[
CachedIdx
], 
pBssIdInfo
, (
BSSID_INFO
));

3168 
RT_OID_WPA_SUPPLICANT_SUPPORT
:

3169 i‡(
wrq
->
u
.
d©a
.
Àngth
 !(
BOOLEAN
))

3170 
Sètus
 = -
EINVAL
;

3173 
Sètus
 = 
	`c›y_‰om_u£r
(&
w∑_suµliˇ¡_íabÀ
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

3174 
pAd≠ãr
->
P‹tCfg
.
WPA_Suµliˇ¡
 = 
w∑_suµliˇ¡_íabÀ
;

3175 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::RT_OID_WPA_SUPPLICANT_SUPPORT (=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
WPA_Suµliˇ¡
);

3181 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së::unknow¿IOCTL'†subcmd = 0x%08x\n", 
cmd
);

3182 
Sètus
 = -
EOPNOTSUPP
;

3187  
Sètus
;

3189 
	}
}

3191 
INT
 
	$RTMPQuîyInf‹m©i⁄
(

3192 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

3193 
IN
 
OUT
 
i‰eq
 *
rq
,

3194 
IN
 
INT
 
cmd
)

3196 
iwªq
 *
wrq
 = (iwªq *Ë
rq
;

3197 
NDIS_802_11_BSSID_LIST_EX
 *
pBssidLi°
 = 
NULL
;

3198 
PNDIS_WLAN_BSSID_EX
 
pBss
;

3199 
NDIS_802_11_SSID
 
Ssid
;

3200 
NDIS_802_11_CONFIGURATION
 
C⁄figuøti⁄
;

3201 
RT_802_11_LINK_STATUS
 
LökSètus
;

3202 
RT_802_11_STA_CONFIG
 
SèC⁄fig
;

3203 
NDIS_802_11_STATISTICS
 
Sèti°ics
;

3204 
NDIS_802_11_RTS_THRESHOLD
 
RtsThªsh
;

3205 
NDIS_802_11_FRAGMENTATION_THRESHOLD
 
FøgThªsh
;

3206 
NDIS_802_11_POWER_MODE
 
PowîMode
;

3207 
NDIS_802_11_NETWORK_INFRASTRUCTURE
 
BssTy≥
;

3208 
RT_802_11_PREAMBLE
 
PªamTy≥
;

3209 
NDIS_802_11_AUTHENTICATION_MODE
 
AuthMode
;

3210 
NDIS_802_11_WEP_STATUS
 
WïSètus
;

3211 
RT_VERSION_INFO
 
DrivîVîsi⁄Info
;

3212 
NDIS_MEDIA_STATE
 
MedüSèã
;

3213 
ULONG
 
BssBufSize
;

3214 
ULONG
 
BssLí
;

3215 
ULONG
 
ulInfo
 = 0;

3216 
PUCHAR
 
pBuf
 = 
NULL
;

3217 
PUCHAR
 
pPå
;

3218 
INT
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

3219 
UCHAR
 
Paddög
;

3220 
UINT
 
i
;

3221 
BOOLEAN
 
RadioSèã
;

3222 
ULONG
 
Nëw‹kTy≥Li°
[4];

3223 
UINT
 
we_vîsi⁄_compûed
;

3225 
cmd
) {

3226 
RT_OID_DEVICE_NAME
:

3227 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Query::RT_OID_DEVICE_NAME\n");

3228 
wrq
->
u
.
d©a
.
Àngth
 = (
NIC_DEVICE_NAME
);

3229 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, 
NIC_DEVICE_NAME
, wrq->u.d©a.
Àngth
);

3231 
RT_OID_VERSION_INFO
:

3232 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Query::RT_OID_VERSION_INFO \n");

3233 
DrivîVîsi⁄Info
.
DrivîVîsi⁄W
 = 
DRV_MAJORVERSION
;

3234 
DrivîVîsi⁄Info
.
DrivîVîsi⁄X
 = 
DRV_MINORVERSION
;

3235 
DrivîVîsi⁄Info
.
DrivîVîsi⁄Y
 = 
DRV_SUBVERSION
;

3236 
DrivîVîsi⁄Info
.
DrivîVîsi⁄Z
 = 
DRV_TESTVERSION
;

3237 
DrivîVîsi⁄Info
.
DrivîBuûdYór
 = 
DRV_YEAR
;

3238 
DrivîVîsi⁄Info
.
DrivîBuûdM⁄th
 = 
DRV_MONTH
;

3239 
DrivîVîsi⁄Info
.
DrivîBuûdDay
 = 
DRV_DAY
;

3240 
wrq
->
u
.
d©a
.
Àngth
 = (
RT_VERSION_INFO
);

3241 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
DrivîVîsi⁄Info
, wrq->u.d©a.
Àngth
);

3243 
OID_802_11_BSSID_LIST
:

3244 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::OID_802_11_BSSID_LIST (%d BSSÑëu∫ed)\n",
pAd≠ãr
->
SˇnTab
.
BssNr
);

3246 
BssBufSize
 = (
ULONG
);

3248 
i
 = 0; i < 
pAd≠ãr
->
SˇnTab
.
BssNr
; i++)

3251 
Paddög
 = 4 - (
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
V¨IELí
 & 0x0003);

3252 i‡(
Paddög
 == 4)

3253 
Paddög
 = 0;

3255 
BssBufSize
 +((
NDIS_WLAN_BSSID_EX
Ë- 1 + (
NDIS_802_11_FIXED_IEs
Ë+ 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
V¨IELí
 + 
Paddög
);

3259 
BssBufSize
 += 256;

3261 
pBuf
 = 
	`kmÆloc
(
BssBufSize
, 
MEM_ALLOC_FLAG
);

3262 if(
pBuf
 =
NULL
)

3264 
Sètus
 = -
ENOMEM
;

3268 
	`NdisZîoMem‹y
(
pBuf
, 
BssBufSize
);

3269 
pBssidLi°
 = (
PNDIS_802_11_BSSID_LIST_EX
Ë
pBuf
;

3270 
pBssidLi°
->
NumbîOfIãms
 = 
pAd≠ãr
->
SˇnTab
.
BssNr
;

3273 
BssLí
 = 4;

3276 
pPå
 = (
PUCHAR
Ë&
pBssidLi°
->
Bssid
[0];

3277 
i
 = 0; i < 
pAd≠ãr
->
SˇnTab
.
BssNr
; i++)

3279 
pBss
 = (
PNDIS_WLAN_BSSID_EX
Ë
pPå
;

3280 
	`NdisMoveMem‹y
(&
pBss
->
MacAddªss
, &
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
Bssid
, 
MAC_ADDR_LEN
);

3281 i‡((
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
Hiddí
 =1Ë&& (pAd≠ãr->
P‹tCfg
.
bShowHiddíSSID
 =
FALSE
))

3283 
pBss
->
Ssid
.
SsidLígth
 = 0;

3287 
pBss
->
Ssid
.
SsidLígth
 = 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
SsidLí
;

3288 
	`NdisMoveMem‹y
(
pBss
->
Ssid
.Ssid, 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].Ssid,ÖAd≠ãr->SˇnTab.BssE¡ry[i].
SsidLí
);

3290 
pBss
->
Privacy
 = 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].Privacy;

3291 
pBss
->
Rssi
 = 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].Rssò-ÖAd≠ãr->
BbpRssiToDbmDñè
;

3293 
pBss
->
Nëw‹kTy≥InU£
 = 
	`Nëw‹kTy≥InU£S™ôy
(
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
Ch™√l
,

3294 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
SupR©e
,

3295 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
SupR©eLí
,

3296 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
ExtR©e
,

3297 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
ExtR©eLí
);

3299 
pBss
->
C⁄figuøti⁄
.
Lígth
 = (
NDIS_802_11_CONFIGURATION
);

3300 
pBss
->
C⁄figuøti⁄
.
Bóc⁄Pîiod
 = 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].BeaconPeriod;

3301 
pBss
->
C⁄figuøti⁄
.
ATIMWödow
 = 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
AtimWö
;

3303 
	`MAP_CHANNEL_ID_TO_KHZ
(
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
Ch™√l
, 
pBss
->
C⁄figuøti⁄
.
DSC⁄fig
);

3305 i‡(
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
BssTy≥
 =
BSS_INFRA
)

3306 
pBss
->
In‰a°ru˘uªMode
 = 
Ndis802_11In‰a°ru˘uª
;

3308 
pBss
->
In‰a°ru˘uªMode
 = 
Ndis802_11IBSS
;

3310 
	`NdisMoveMem‹y
(
pBss
->
Suµ‹ãdR©es
, 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
SupR©e
,ÖAd≠ãr->SˇnTab.BssE¡ry[i].
SupR©eLí
);

3313 
	`NdisMoveMem‹y
(
pBss
->
Suµ‹ãdR©es
 + 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
SupR©eLí
,

3314 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
ExtR©e
,

3315 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
ExtR©eLí
);

3317 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"BSS#%d - %s, Ch %d = %d Khz, Sup+ExtÑate# = %d\n",

3318 
i
,
pBss
->
Ssid
.Ssid,

3319 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
Ch™√l
,

3320 
pBss
->
C⁄figuøti⁄
.
DSC⁄fig
,

3321 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
SupR©eLí
 +ÖAd≠ãr->SˇnTab.BssE¡ry[i].
ExtR©eLí
);

3324 i‡(
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
V¨IELí
 == 0)

3326 
pBss
->
IELígth
 = (
NDIS_802_11_FIXED_IEs
);

3327 
	`NdisMoveMem‹y
(
pBss
->
IEs
, &
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
FixIEs
, (
NDIS_802_11_FIXED_IEs
));

3329 
pPå
 =ÖPå + (
NDIS_WLAN_BSSID_EX
Ë- 1 + (
NDIS_802_11_FIXED_IEs
);

3333 
pBss
->
IELígth
 = (
NDIS_802_11_FIXED_IEs
Ë+ 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
V¨IELí
;

3335 
pPå
 =ÖPå + (
NDIS_WLAN_BSSID_EX
Ë- 1 + (
NDIS_802_11_FIXED_IEs
);

3336 
	`NdisMoveMem‹y
(
pBss
->
IEs
, &
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
FixIEs
, (
NDIS_802_11_FIXED_IEs
));

3337 
	`NdisMoveMem‹y
(
pPå
, 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
V¨IEs
,ÖAd≠ãr->SˇnTab.BssE¡ry[i].
V¨IELí
);

3338 
pPå
 +
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
V¨IELí
;

3341 
Paddög
 = 4 - (
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
V¨IELí
 & 0x0003);

3342 i‡(
Paddög
 == 4)

3343 
Paddög
 = 0;

3344 
pPå
 +
Paddög
;

3346 
pBss
->
Lígth
 = (
NDIS_WLAN_BSSID_EX
Ë- 1 + (
NDIS_802_11_FIXED_IEs
Ë+ 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
V¨IELí
 + 
Paddög
;

3347 
BssLí
 +
pBss
->
Lígth
;

3349 
wrq
->
u
.
d©a
.
Àngth
 = 
BssLí
;

3350 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, 
pBssidLi°
, wrq->u.d©a.
Àngth
);

3351 
	`k‰ì
(
pBssidLi°
);

3353 
OID_802_3_CURRENT_ADDRESS
:

3354 
wrq
->
u
.
d©a
.
Àngth
 = 
MAC_ADDR_LEN
;

3355 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
pAd≠ãr
->
CuºítAddªss
, wrq->u.d©a.
Àngth
);

3356 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Query::OID_802_3_CURRENT_ADDRESS \n");

3358 
OID_GEN_MEDIA_CONNECT_STATUS
:

3359 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Query::OID_GEN_MEDIA_CONNECT_STATUS \n");

3360 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd≠ãr
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

3361 
MedüSèã
 = 
NdisMedüSèãC⁄√˘ed
;

3363 
MedüSèã
 = 
NdisMedüSèãDisc⁄√˘ed
;

3365 
wrq
->
u
.
d©a
.
Àngth
 = (
NDIS_MEDIA_STATE
);

3366 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
MedüSèã
, wrq->u.d©a.
Àngth
);

3368 
OID_802_11_BSSID
:

3369 i‡(
	`INFRA_ON
(
pAd≠ãr
Ë|| 
	`ADHOC_ON
(pAdapter))

3371 
wrq
->
u
.
d©a
.
Àngth
 = (
NDIS_802_11_MAC_ADDRESS
);

3372 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
pAd≠ãr
->
P‹tCfg
.
Bssid
, wrq->u.d©a.
Àngth
);

3374 
	`DBGPRINT
(
RT_DEBUG_INFO
, "IOCTL::SIOCGIWAP(=%02x:%02x:%02x:%02x:%02x:%02x)\n",

3375 
pAd≠ãr
->
P‹tCfg
.
Bssid
[0],pAdapter->PortCfg.Bssid[1],pAdapter->PortCfg.Bssid[2],

3376 
pAd≠ãr
->
P‹tCfg
.
Bssid
[3],pAdapter->PortCfg.Bssid[4],pAdapter->PortCfg.Bssid[5]);

3381 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Query::OID_802_11_BSSID(=EMPTY)\n");

3382 
Sètus
 = -
ENOTCONN
;

3385 
OID_802_11_SSID
:

3386 
Ssid
.
SsidLígth
 = 
pAd≠ãr
->
P‹tCfg
.
SsidLí
;

3387 
	`NdisZîoMem‹y
(
Ssid
.Ssid, 
MAX_LEN_OF_SSID
);

3388 
	`NdisMoveMem‹y
(
Ssid
.Ssid, 
pAd≠ãr
->
P‹tCfg
.Ssid, Ssid.
SsidLígth
);

3389 
wrq
->
u
.
d©a
.
Àngth
 = (
NDIS_802_11_SSID
);

3390 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
Ssid
, wrq->u.d©a.
Àngth
);

3391 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::OID_802_11_SSID (Lí=%d, ssid=%s)\n", 
Ssid
.
SsidLígth
,Ssid.Ssid);

3393 
RT_OID_802_11_QUERY_LINK_STATUS
:

3394 
LökSètus
.
CuºTxR©e
 = 
R©eIdTo500Kbps
[
pAd≠ãr
->
P‹tCfg
.
TxR©e
];

3395 
LökSètus
.
Ch™√lQuÆôy
 = 
pAd≠ãr
->
Mlme
.ChannelQuality;

3396 
LökSètus
.
RxByãCou¡
 = 
pAd≠ãr
->
RÆökCou¡îs
.
Re˚ivedByãCou¡
;

3397 
LökSètus
.
TxByãCou¡
 = 
pAd≠ãr
->
RÆökCou¡îs
.
TønsmôãdByãCou¡
;

3398 
wrq
->
u
.
d©a
.
Àngth
 = (
RT_802_11_LINK_STATUS
);

3399 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
LökSètus
, wrq->u.d©a.
Àngth
);

3400 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Query::RT_OID_802_11_QUERY_LINK_STATUS\n");

3402 
OID_802_11_CONFIGURATION
:

3403 
C⁄figuøti⁄
.
Lígth
 = (
NDIS_802_11_CONFIGURATION
);

3404 
C⁄figuøti⁄
.
Bóc⁄Pîiod
 = 
pAd≠ãr
->
P‹tCfg
.BeaconPeriod;

3405 
C⁄figuøti⁄
.
ATIMWödow
 = 
pAd≠ãr
->
P‹tCfg
.
AtimWö
;

3406 
	`MAP_CHANNEL_ID_TO_KHZ
(
pAd≠ãr
->
P‹tCfg
.
Ch™√l
, 
C⁄figuøti⁄
.
DSC⁄fig
);

3407 
wrq
->
u
.
d©a
.
Àngth
 = (
NDIS_802_11_CONFIGURATION
);

3408 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
C⁄figuøti⁄
, wrq->u.d©a.
Àngth
);

3409 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Query::OID_802_11_CONFIGURATION(BeaconPeriod=%d,AtimW=%d,Channel=%d) \n",

3410 
C⁄figuøti⁄
.
Bóc⁄Pîiod
, C⁄figuøti⁄.
ATIMWödow
, 
pAd≠ãr
->
P‹tCfg
.
Ch™√l
);

3412 
OID_802_11_RSSI_TRIGGER
:

3413 
ulInfo
 = 
pAd≠ãr
->
P‹tCfg
.
La°Rssi
 -ÖAd≠ãr->
BbpRssiToDbmDñè
;

3414 
wrq
->
u
.
d©a
.
Àngth
 = (
ulInfo
);

3415 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
ulInfo
, wrq->u.d©a.
Àngth
);

3416 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::OID_802_11_RSSI_TRIGGER(=%d)\n", 
ulInfo
);

3418 
OID_802_11_STATISTICS
:

3419 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Query::OID_802_11_STATISTICS \n");

3422 
	`NICUpd©eRawCou¡îs
(
pAd≠ãr
);

3425 i‡(
pAd≠ãr
->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
QuadP¨t
 <ÖAd≠ãr->WœnCou¡îs.
RëryCou¡
.QuadPart)

3426 
pAd≠ãr
->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
QuadP¨t
 =ÖAd≠ãr->WœnCou¡îs.
RëryCou¡
.QuadPart;

3428 
Sèti°ics
.
TønsmôãdFøgmítCou¡
.
QuadP¨t
 = 
pAd≠ãr
->
WœnCou¡îs
.TransmittedFragmentCount.QuadPart;

3429 
Sèti°ics
.
Mu…iˇ°TønsmôãdFømeCou¡
.
QuadP¨t
 = 
pAd≠ãr
->
WœnCou¡îs
.MulticastTransmittedFrameCount.QuadPart;

3430 
Sèti°ics
.
FaûedCou¡
.
QuadP¨t
 = 
pAd≠ãr
->
WœnCou¡îs
.FailedCount.QuadPart;

3431 
Sèti°ics
.
RëryCou¡
.
QuadP¨t
 = 
pAd≠ãr
->
WœnCou¡îs
.RetryCount.QuadPart;

3432 
Sèti°ics
.
Mu…ùÀRëryCou¡
.
QuadP¨t
 = 
pAd≠ãr
->
WœnCou¡îs
.MultipleRetryCount.QuadPart;

3433 
Sèti°ics
.
RTSSuc˚ssCou¡
.
QuadP¨t
 = 
pAd≠ãr
->
WœnCou¡îs
.RTSSuccessCount.QuadPart;

3434 
Sèti°ics
.
RTSFaûuªCou¡
.
QuadP¨t
 = 
pAd≠ãr
->
WœnCou¡îs
.RTSFailureCount.QuadPart;

3435 
Sèti°ics
.
ACKFaûuªCou¡
.
QuadP¨t
 = 
pAd≠ãr
->
WœnCou¡îs
.ACKFailureCount.QuadPart;

3436 
Sèti°ics
.
FømeDu∂iˇãCou¡
.
QuadP¨t
 = 
pAd≠ãr
->
WœnCou¡îs
.FrameDuplicateCount.QuadPart;

3437 
Sèti°ics
.
Re˚ivedFøgmítCou¡
.
QuadP¨t
 = 
pAd≠ãr
->
WœnCou¡îs
.ReceivedFragmentCount.QuadPart;

3438 
Sèti°ics
.
Mu…iˇ°Re˚ivedFømeCou¡
.
QuadP¨t
 = 
pAd≠ãr
->
WœnCou¡îs
.MulticastReceivedFrameCount.QuadPart;

3439 #ifde‡
DBG


3440 
Sèti°ics
.
FCSEº‹Cou¡
 = 
pAd≠ãr
->
RÆökCou¡îs
.
RólFcsEºCou¡
;

3442 
Sèti°ics
.
FCSEº‹Cou¡
.
QuadP¨t
 = 
pAd≠ãr
->
WœnCou¡îs
.FCSErrorCount.QuadPart;

3443 
Sèti°ics
.
FømeDu∂iˇãCou¡
.
vv
.
LowP¨t
 = 
pAd≠ãr
->
WœnCou¡îs
.FrameDuplicateCount.vv.LowPart / 100;

3445 
wrq
->
u
.
d©a
.
Àngth
 = (
NDIS_802_11_STATISTICS
);

3446 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
Sèti°ics
, wrq->u.d©a.
Àngth
);

3448 
OID_GEN_RCV_OK
:

3449 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Query::OID_GEN_RCV_OK \n");

3450 
ulInfo
 = 
pAd≠ãr
->
Cou¡îs8023
.
GoodRe˚ives
;

3451 
wrq
->
u
.
d©a
.
Àngth
 = (
ulInfo
);

3452 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
ulInfo
, wrq->u.d©a.
Àngth
);

3454 
OID_GEN_RCV_NO_BUFFER
:

3455 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Query::OID_GEN_RCV_NO_BUFFER \n");

3456 
ulInfo
 = 
pAd≠ãr
->
Cou¡îs8023
.
RxNoBuf„r
;

3457 
wrq
->
u
.
d©a
.
Àngth
 = (
ulInfo
);

3458 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
ulInfo
, wrq->u.d©a.
Àngth
);

3460 
RT_OID_802_11_PHY_MODE
:

3461 
ulInfo
 = (
ULONG
)
pAd≠ãr
->
P‹tCfg
.
PhyMode
;

3462 
wrq
->
u
.
d©a
.
Àngth
 = (
ulInfo
);

3463 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
ulInfo
, wrq->u.d©a.
Àngth
);

3464 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::RT_OID_802_11_PHY_MODE (=%d)\n", 
ulInfo
);

3466 
RT_OID_802_11_STA_CONFIG
:

3467 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Query::RT_OID_802_11_STA_CONFIG\n");

3468 
SèC⁄fig
.
E«bÀTxBur°
 = 
pAd≠ãr
->
P‹tCfg
.
bE«bÀTxBur°
;

3469 
SèC⁄fig
.
E«bÀTurboR©e
 = 0;

3470 
SèC⁄fig
.
U£BGPrŸe˘i⁄
 = 
pAd≠ãr
->
P‹tCfg
.UseBGProtection;

3471 
SèC⁄fig
.
U£Sh‹tSlŸTime
 = 
pAd≠ãr
->
P‹tCfg
.UseShortSlotTime;

3472 
SèC⁄fig
.
AdhocMode
 = 
pAd≠ãr
->
P‹tCfg
.AdhocMode;

3473 
SèC⁄fig
.
HwRadioSètus
 = (
pAd≠ãr
->
P‹tCfg
.
bHwRadio
 =
TRUE
) ? 1 : 0;

3474 
SèC⁄fig
.
Rsv1
 = 0;

3475 
SèC⁄fig
.
Sy°emEº‹Bôm≠
 = 
pAd≠ãr
->SystemErrorBitmap;

3476 
wrq
->
u
.
d©a
.
Àngth
 = (
RT_802_11_STA_CONFIG
);

3477 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
SèC⁄fig
, wrq->u.d©a.
Àngth
);

3479 
OID_802_11_RTS_THRESHOLD
:

3480 
RtsThªsh
 = 
pAd≠ãr
->
P‹tCfg
.
RtsThªshﬁd
;

3481 
wrq
->
u
.
d©a
.
Àngth
 = (
RtsThªsh
);

3482 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
RtsThªsh
, wrq->u.d©a.
Àngth
);

3483 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::OID_802_11_RTS_THRESHOLD(=%d)\n", 
RtsThªsh
);

3485 
OID_802_11_FRAGMENTATION_THRESHOLD
:

3486 
FøgThªsh
 = 
pAd≠ãr
->
P‹tCfg
.
FøgmítThªshﬁd
;

3487 i‡(
pAd≠ãr
->
P‹tCfg
.
bFøgmítZîoDißbÀ
 =
TRUE
)

3488 
FøgThªsh
 = 0;

3489 
wrq
->
u
.
d©a
.
Àngth
 = (
FøgThªsh
);

3490 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
FøgThªsh
, wrq->u.d©a.
Àngth
);

3491 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::OID_802_11_FRAGMENTATION_THRESHOLD(=%d)\n", 
FøgThªsh
);

3493 
OID_802_11_POWER_MODE
:

3494 
PowîMode
 = 
pAd≠ãr
->
P‹tCfg
.
WödowsPowîMode
;

3495 
wrq
->
u
.
d©a
.
Àngth
 = (
PowîMode
);

3496 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
PowîMode
, wrq->u.d©a.
Àngth
);

3497 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::OID_802_11_POWER_MODE(=%d)\n", 
PowîMode
);

3499 
RT_OID_802_11_RADIO
:

3500 
RadioSèã
 = (
BOOLEAN
Ë
pAd≠ãr
->
P‹tCfg
.
bSwRadio
;

3501 
wrq
->
u
.
d©a
.
Àngth
 = (
RadioSèã
);

3502 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
RadioSèã
, wrq->u.d©a.
Àngth
);

3503 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::RT_OID_802_11_QUERY_RADIO (=%d)\n", 
RadioSèã
);

3505 
OID_802_11_INFRASTRUCTURE_MODE
:

3506 i‡(
	`ADHOC_ON
(
pAd≠ãr
))

3507 
BssTy≥
 = 
Ndis802_11IBSS
;

3508 i‡(
	`INFRA_ON
(
pAd≠ãr
))

3509 
BssTy≥
 = 
Ndis802_11In‰a°ru˘uª
;

3511 
BssTy≥
 = 
Ndis802_11AutoUnknown
;

3513 
wrq
->
u
.
d©a
.
Àngth
 = (
BssTy≥
);

3514 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
BssTy≥
, wrq->u.d©a.
Àngth
);

3515 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::OID_802_11_INFRASTRUCTURE_MODE(=%d)\n", 
BssTy≥
);

3517 
RT_OID_802_11_PREAMBLE
:

3518 
PªamTy≥
 = 
pAd≠ãr
->
P‹tCfg
.
TxPªambÀ
;

3519 
wrq
->
u
.
d©a
.
Àngth
 = (
PªamTy≥
);

3520 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
PªamTy≥
, wrq->u.d©a.
Àngth
);

3521 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::RT_OID_802_11_PREAMBLE(=%d)\n", 
PªamTy≥
);

3523 
OID_802_11_AUTHENTICATION_MODE
:

3524 
AuthMode
 = 
pAd≠ãr
->
P‹tCfg
.AuthMode;

3525 
wrq
->
u
.
d©a
.
Àngth
 = (
AuthMode
);

3526 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
AuthMode
, wrq->u.d©a.
Àngth
);

3527 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::OID_802_11_AUTHENTICATION_MODE(=%d)\n", 
AuthMode
);

3529 
OID_802_11_WEP_STATUS
:

3530 
WïSètus
 = 
pAd≠ãr
->
P‹tCfg
.WepStatus;

3531 
wrq
->
u
.
d©a
.
Àngth
 = (
WïSètus
);

3532 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
WïSètus
, wrq->u.d©a.
Àngth
);

3533 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::OID_802_11_WEP_STATUS(=%d)\n", 
WïSètus
);

3535 
OID_802_11_TX_POWER_LEVEL
:

3536 
wrq
->
u
.
d©a
.
Àngth
 = (
ULONG
);

3537 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
pAd≠ãr
->
P‹tCfg
.
TxPowî
, wrq->u.d©a.
Àngth
);

3538 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::OID_802_11_TX_POWER_LEVEL %x\n",
pAd≠ãr
->
P‹tCfg
.
TxPowî
);

3540 
RT_OID_802_11_TX_POWER_LEVEL_1
:

3541 
wrq
->
u
.
d©a
.
Àngth
 = (
ULONG
);

3542 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
pAd≠ãr
->
P‹tCfg
.
TxPowîPî˚¡age
, wrq->u.d©a.
Àngth
);

3543 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::RT_OID_802_11_TX_POWER_LEVEL_1 (=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
TxPowîPî˚¡age
);

3545 
OID_802_11_NETWORK_TYPES_SUPPORTED
:

3546 i‡((
pAd≠ãr
->
RfIcTy≥
 =
RFIC_5226
Ë|| (pAd≠ãr->RfIcTy≥ =
RFIC_5225
))

3548 
Nëw‹kTy≥Li°
[0] = 3;

3549 
Nëw‹kTy≥Li°
[1] = 
Ndis802_11DS
;

3550 
Nëw‹kTy≥Li°
[2] = 
Ndis802_11OFDM24
;

3551 
Nëw‹kTy≥Li°
[3] = 
Ndis802_11OFDM5
;

3552 
wrq
->
u
.
d©a
.
Àngth
 = 16;

3553 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
Nëw‹kTy≥Li°
[0], wrq->u.d©a.
Àngth
);

3557 
Nëw‹kTy≥Li°
[0] = 2;

3558 
Nëw‹kTy≥Li°
[1] = 
Ndis802_11DS
;

3559 
Nëw‹kTy≥Li°
[2] = 
Ndis802_11OFDM24
;

3560 
wrq
->
u
.
d©a
.
Àngth
 = 12;

3561 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
Nëw‹kTy≥Li°
[0], wrq->u.d©a.
Àngth
);

3563 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Query::OID_802_11_NETWORK_TYPES_SUPPORTED\n");

3565 
OID_802_11_NETWORK_TYPE_IN_USE
:

3566 
wrq
->
u
.
d©a
.
Àngth
 = (
ULONG
);

3567 i‡(
pAd≠ãr
->
P‹tCfg
.
PhyMode
 =
PHY_11A
)

3568 
ulInfo
 = 
Ndis802_11OFDM5
;

3569 i‡((
pAd≠ãr
->
P‹tCfg
.
PhyMode
 =
PHY_11BG_MIXED
Ë|| (pAd≠ãr->P‹tCfg.PhyModê=
PHY_11G
))

3570 
ulInfo
 = 
Ndis802_11OFDM24
;

3572 
ulInfo
 = 
Ndis802_11DS
;

3573 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
ulInfo
, wrq->u.d©a.
Àngth
);

3574 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Quîy::OID_802_11_NETWORK_TYPE_IN_USE(=%d)\n", 
ulInfo
);

3576 
RT_OID_802_11_QUERY_LAST_RX_RATE
:

3577 
ulInfo
 = (
ULONG
)
pAd≠ãr
->
La°RxR©e
;

3578 
wrq
->
u
.
d©a
.
Àngth
 = (
ulInfo
);

3579 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
ulInfo
, wrq->u.d©a.
Àngth
);

3580 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::RT_OID_802_11_QUERY_LAST_RX_RATE (=%d)\n", 
ulInfo
);

3582 
RT_OID_802_11_QUERY_EEPROM_VERSION
:

3583 
wrq
->
u
.
d©a
.
Àngth
 = (
ULONG
);

3584 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
pAd≠ãr
->
EïromVîsi⁄
, wrq->u.d©a.
Àngth
);

3585 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Quîy::RT_OID_802_11_QUERY_EEPROM_VERSION (=%d)\n", 
pAd≠ãr
->
EïromVîsi⁄
);

3587 
RT_OID_802_11_QUERY_FIRMWARE_VERSION
:

3588 
wrq
->
u
.
d©a
.
Àngth
 = (
ULONG
);

3589 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
pAd≠ãr
->
Fúmw¨eVîsi⁄
, wrq->u.d©a.
Àngth
);

3590 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Quîy::RT_OID_802_11_QUERY_FIRMWARE_VERSION (=%d)\n", 
pAd≠ãr
->
Fúmw¨eVîsi⁄
);

3592 
RT_OID_802_11_QUERY_NOISE_LEVEL
:

3594 
wrq
->
u
.
d©a
.
Àngth
 = (
UCHAR
);

3595 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
pAd≠ãr
->
BbpWrôeL©ch
[17], wrq->u.d©a.
Àngth
);

3596 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::RT_OID_802_11_QUERY_NOISE_LEVEL (=%d)\n", 
pAd≠ãr
->
BbpWrôeL©ch
[17]);

3598 
RT_OID_802_11_EXTRA_INFO
:

3599 
wrq
->
u
.
d©a
.
Àngth
 = (
ULONG
);

3600 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
pAd≠ãr
->
ExåaInfo
, wrq->u.d©a.
Àngth
);

3601 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::RT_OID_802_11_EXTRA_INFO (=%d)\n", 
pAd≠ãr
->
ExåaInfo
);

3603 
RT_OID_802_11_QUERY_PIDVID
:

3604 
wrq
->
u
.
d©a
.
Àngth
 = (
ULONG
);

3605 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
pAd≠ãr
->
Víd‹Desc
, wrq->u.d©a.
Àngth
);

3606 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Quîy::RT_OID_802_11_QUERY_PIDVID (=%d)\n", 
pAd≠ãr
->
Víd‹Desc
);

3608 
RT_OID_WE_VERSION_COMPILED
:

3609 
wrq
->
u
.
d©a
.
Àngth
 = (
UINT
);

3610 
we_vîsi⁄_compûed
 = 
WIRELESS_EXT
;

3611 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, &
we_vîsi⁄_compûed
, wrq->u.d©a.
Àngth
);

3612 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Quîy::RT_OID_WE_VERSION_COMPILED (=%d)\n", 
we_vîsi⁄_compûed
);

3616 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Quîy::unknow¿IOCTL'†subcmd = 0x%08x\n", 
cmd
);

3617 
Sètus
 = -
EOPNOTSUPP
;

3620  
Sètus
;

3621 
	}
}

3623 
INT
 
	$π73_io˘l
(

3624 
IN
 
√t_devi˚
 *
√t_dev
,

3625 
IN
 
OUT
 
i‰eq
 *
rq
,

3626 
IN
 
INT
 
cmd
)

3628 
RTMP_ADAPTER
 *
pAd
 = 
	`RTMP_OS_NETDEV_GET_PRIV
(
√t_dev
);

3629 
iwªq
 *
wrq
 = (iwªq *Ë
rq
;

3630 
iw_poöt
 *
îq
 = 
NULL
;

3631 
iw_‰eq
 *
‰q
 = 
NULL
;

3632 
NDIS_802_11_SSID
 
Ssid
, *
pSsid
=
NULL
;

3633 
NDIS_802_11_NETWORK_INFRASTRUCTURE
 
BssTy≥
 = 
Ndis802_11In‰a°ru˘uª
;

3634 
NDIS_802_11_RTS_THRESHOLD
 
RtsThªsh
;

3635 
NDIS_802_11_FRAGMENTATION_THRESHOLD
 
FøgThªsh
;

3636 
NDIS_802_11_MAC_ADDRESS
 
Bssid
;

3637 
BOOLEAN
 
SèãMachöeTouched
 = 
FALSE
;

3638 
INT
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

3639 
USHORT
 
subcmd
;

3640 
ch™
=-1, 
ödex
=0, 
Àn
=0, 
i
=0;

3643 
pAd
 = 
	`RTMP_OS_NETDEV_GET_PRIV
(
√t_dev
);

3644 
pAd
->
io˘l_if_ty≥
 = 
INT_MAIN
;

3647 i‡–(
	`RTMP_TEST_FLAG
(
pAd
 , 
fRTMP_ADAPTER_NIC_NOT_EXIST
)) ||

3648 (
	`RTMP_TEST_FLAG
(
pAd
 , 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)))

3650 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::remove inÖrogress!\n");

3651  -
ENETDOWN
;

3654 i‡((
√t_dev
->
Êags
 & 
IFF_UP
) == 0)

3655  -
ENETDOWN
;

3657 i‡(
pAd
->
RTUSBCmdThr_pid
 < 0)

3658  -
ENETDOWN
;

3660 
cmd
)

3662 
SIOCGIFHWADDR
:

3663 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCGIFHWADDR\n");

3664 
	`mem˝y
(
wrq
->
u
.
«me
, 
pAd
->
CuºítAddªss
, 
ETH_ALEN
);

3665 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCGIFHWADDR(=%02x:%02x:%02x:%02x:%02x:%02x)\n",

3666 
pAd
->
CuºítAddªss
[0],pAd->CurrentAddress[1],pAd->CurrentAddress[2],

3667 
pAd
->
CuºítAddªss
[3],pAd->CurrentAddress[4],pAd->CurrentAddress[5]);

3669 
SIOCGIWNAME
:

3670 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCGIWNAME\n");

3671 
	`°r˝y
(
wrq
->
u
.
«me
, "RT73 WLAN");

3673 
SIOCSIWESSID
:

3674 
îq
 = &
wrq
->
u
.
essid
;

3675 
	`mem£t
(&
Ssid
, 0x00, (
NDIS_802_11_SSID
));

3676 i‡(
îq
->
Êags
)

3678 i‡(
îq
->
Àngth
 > 
IW_ESSID_MAX_SIZE
)

3680 
Sètus
 = -
E2BIG
;

3684 
Sètus
 = 
	`c›y_‰om_u£r
(
Ssid
.Ssid, 
îq
->
poöãr
, (îq->
Àngth
 - 1));

3685 
Ssid
.
SsidLígth
 = 
îq
->
Àngth
 - 1;

3689 
Ssid
.
SsidLígth
 = 0;

3690 
	`mem˝y
(
pSsid
->
Ssid
, "", 0);

3692 
pSsid
 = &
Ssid
;

3693 i‡(
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 !
CNTL_IDLE
)

3695 
	`MlmeEnqueue
(
pAd
,

3696 
MLME_CNTL_STATE_MACHINE
,

3697 
RT_CMD_RESET_MLME
,

3699 
NULL
);

3703 i‡(
pAd
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
)

3705 
	`NdisZîoMem‹y
(
pAd
->
MlmeAux
.
Ssid
, 
MAX_LEN_OF_SSID
);

3706 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
Ssid
, Ssid.Ssid, Ssid.
SsidLígth
);

3707 
pAd
->
MlmeAux
.
SsidLí
 = 
Ssid
.
SsidLígth
;

3710 
	`MlmeEnqueue
(
pAd
,

3711 
MLME_CNTL_STATE_MACHINE
,

3712 
OID_802_11_SSID
,

3713 (
NDIS_802_11_SSID
),

3714 (
VOID
 *)
pSsid
);

3716 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

3717 
SèãMachöeTouched
 = 
TRUE
;

3719 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCSIWESSID[cmd=0x%x] (Lí=%d,Ssid=%s)\n", 
SIOCSIWESSID
, 
pSsid
->
SsidLígth
,ÖSsid->
Ssid
);

3721 
SIOCGIWESSID
:

3722 
îq
 = &
wrq
->
u
.
essid
;

3724 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

3726 
îq
->
Êags
=1;

3727 
îq
->
Àngth
 = 
pAd
->
P‹tCfg
.
SsidLí
;

3728 
Sètus
 = 
	`c›y_to_u£r
(
îq
->
poöãr
, 
pAd
->
P‹tCfg
.
Ssid
,Érq->
Àngth
);

3732 
îq
->
Êags
=0;

3733 
îq
->
Àngth
=0;

3735 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCGIWESSID (Lí=%d, ssid=%lu...)\n", 
îq
->
Àngth
, (Îrq->
poöãr
);

3737 
SIOCSIWNWID
:

3738 
SIOCGIWNWID
:

3739 
Sètus
 = -
EOPNOTSUPP
;

3741 
SIOCSIWFREQ
:

3742 
‰q
 = &
wrq
->
u
.
‰eq
;

3743 if((
‰q
->
e
 =0Ë&& (‰q->
m
 <= 1000))

3744 
ch™
 = 
‰q
->
m
;

3746 
	`MAP_KHZ_TO_CHANNEL_ID
–(
‰q
->
m
 /100Ë, 
ch™
);

3747 
pAd
->
P‹tCfg
.
Ch™√l
 = 
ch™
;

3748 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCSIWFREQ[cmd=0x%x] (Ch™√l=%d)\n", 
SIOCSIWFREQ
, 
pAd
->
P‹tCfg
.
Ch™√l
);

3750 
SIOCGIWFREQ
:

3751 
wrq
->
u
.
‰eq
.
m
 = 
pAd
->
P‹tCfg
.
Ch™√l
;

3752 
wrq
->
u
.
‰eq
.
e
 = 0;

3753 
wrq
->
u
.
‰eq
.
i
 = 0;

3755 
SIOCSIWNICKN
:

3756 
îq
 = &
wrq
->
u
.
d©a
;

3757 i‡(
îq
->
Êags
)

3759 i‡(
îq
->
Àngth
 <
IW_ESSID_MAX_SIZE
)

3760 
Sètus
 = 
	`c›y_‰om_u£r
(
pAd
->
nickn
, 
îq
->
poöãr
,Érq->
Àngth
);

3762 
Sètus
 = -
E2BIG
;

3765 
SIOCGIWNICKN
:

3766 
îq
 = &
wrq
->
u
.
d©a
;

3767 
îq
->
Àngth
 = 
	`°æí
(
pAd
->
nickn
);

3768 
Sètus
 = 
	`c›y_to_u£r
(
îq
->
poöãr
, 
pAd
->
nickn
,Érq->
Àngth
);

3771 
SIOCGIWRATE
:

3772 
wrq
->
u
.
bôøã
.
vÆue
 = 
R©eIdTo500Kbps
[
pAd
->
P‹tCfg
.
TxR©e
] * 500000;

3773 
wrq
->
u
.
bôøã
.
dißbÀd
 = 0;

3775 
SIOCSIWRATE
:

3776 
	`RTMPSëDesúedR©es
(
pAd
, 
wrq
->
u
.
bôøã
.
vÆue
);

3778 
SIOCGIWRTS
:

3779 
wrq
->
u
.
πs
.
vÆue
 = (
INT
Ë
pAd
->
P‹tCfg
.
RtsThªshﬁd
;

3780 
wrq
->
u
.
πs
.
dißbÀd
 = (wrq->u.πs.
vÆue
 =
MAX_RTS_THRESHOLD
);

3781 
wrq
->
u
.
πs
.
fixed
 = 1;

3783 
SIOCSIWRTS
:

3784 
RtsThªsh
 = 
wrq
->
u
.
πs
.
vÆue
;

3785 i‡(
wrq
->
u
.
πs
.
dißbÀd
)

3786 
RtsThªsh
 = 
MAX_RTS_THRESHOLD
;

3788 if((
RtsThªsh
 > 0Ë&& (RtsThªsh <
MAX_RTS_THRESHOLD
))

3789 
pAd
->
P‹tCfg
.
RtsThªshﬁd
 = (
USHORT
)
RtsThªsh
;

3790 i‡(
RtsThªsh
 == 0)

3791 
pAd
->
P‹tCfg
.
RtsThªshﬁd
 = 
MAX_RTS_THRESHOLD
;

3793 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCSIWRTS (=%d)\n", 
pAd
->
P‹tCfg
.
RtsThªshﬁd
);

3795 
SIOCGIWFRAG
:

3796 
wrq
->
u
.
‰ag
.
vÆue
 = (
INT
Ë
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
;

3797 
wrq
->
u
.
‰ag
.
dißbÀd
 = (wrq->u.‰ag.
vÆue
 >
MAX_FRAG_THRESHOLD
);

3798 
wrq
->
u
.
‰ag
.
fixed
 = 1;

3800 
SIOCSIWFRAG
:

3801 
FøgThªsh
 = 
wrq
->
u
.
‰ag
.
vÆue
;

3802 i‡(
wrq
->
u
.
πs
.
dißbÀd
)

3803 
FøgThªsh
 = 
MAX_FRAG_THRESHOLD
;

3805 i‡–(
FøgThªsh
 >
MIN_FRAG_THRESHOLD
Ë&& (FøgThªsh <
MAX_FRAG_THRESHOLD
))

3806 
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
 = (
USHORT
)
FøgThªsh
;

3807 i‡(
FøgThªsh
 == 0)

3808 
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
 = 
MAX_FRAG_THRESHOLD
;

3810 i‡(
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
 =
MAX_FRAG_THRESHOLD
)

3811 
pAd
->
P‹tCfg
.
bFøgmítZîoDißbÀ
 = 
TRUE
;

3813 
pAd
->
P‹tCfg
.
bFøgmítZîoDißbÀ
 = 
FALSE
;

3815 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCSIWFRAG (=%d)\n", 
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
);

3817 
SIOCGIWENCODE
:

3818 
ödex
 = (
wrq
->
u
.
ícodög
.
Êags
 & 
IW_ENCODE_INDEX
) - 1;

3819 i‡((
ödex
 < 0Ë|| (ödex >
NR_WEP_KEYS
))

3820 
ödex
 = 
pAd
->
P‹tCfg
.
DeÁu…KeyId
;

3822 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeO≥n
)

3823 
wrq
->
u
.
ícodög
.
Êags
 = 
IW_ENCODE_OPEN
;

3824 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeSh¨ed
)

3825 
wrq
->
u
.
ícodög
.
Êags
 = 
IW_ENCODE_RESTRICTED
;

3827 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11WEPDißbÀd
)

3828 
wrq
->
u
.
ícodög
.
Êags
 |
IW_ENCODE_DISABLED
;

3831 if(
wrq
->
u
.
ícodög
.
poöãr
)

3833 
wrq
->
u
.
ícodög
.
Àngth
 = 
pAd
->
Sh¨edKey
[
ödex
].
KeyLí
;

3834 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
ícodög
.
poöãr
,

3835 
pAd
->
Sh¨edKey
[
ödex
].
Key
,

3836 
pAd
->
Sh¨edKey
[
ödex
].
KeyLí
);

3837 
wrq
->
u
.
ícodög
.
Êags
 |(
ödex
 + 1);

3841 
SIOCSIWENCODE
:

3842 
ödex
 = (
wrq
->
u
.
ícodög
.
Êags
 & 
IW_ENCODE_INDEX
) - 1;

3844 if((
ödex
 < 0Ë|| (ödex >
NR_WEP_KEYS
))

3845 
ödex
 = 
pAd
->
P‹tCfg
.
DeÁu…KeyId
;

3847 if(
wrq
->
u
.
ícodög
.
poöãr
)

3849 
Àn
 = 
wrq
->
u
.
ícodög
.
Àngth
;

3850 if(
Àn
 > 
WEP_LARGE_KEY_LEN
)

3851 
Àn
 = 
WEP_LARGE_KEY_LEN
;

3853 
	`mem£t
(
pAd
->
Sh¨edKey
[
ödex
].
Key
, 0x00, 
MAX_LEN_OF_KEY
);

3854 
Sètus
 = 
	`c›y_‰om_u£r
(
pAd
->
Sh¨edKey
[
ödex
].
Key
,

3855 
wrq
->
u
.
ícodög
.
poöãr
, 
Àn
);

3856 
pAd
->
Sh¨edKey
[
ödex
].
KeyLí
 = 
Àn
 <
WEP_SMALL_KEY_LEN
 ? WEP_SMALL_KEY_LEN : 
WEP_LARGE_KEY_LEN
;

3858 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 = (
UCHAR
Ë
ödex
;

3859 i‡(
wrq
->
u
.
ícodög
.
Êags
 & 
IW_ENCODE_DISABLED
)

3860 
pAd
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11WEPDißbÀd
;

3862 
pAd
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11WEPE«bÀd
;

3864 i‡(
wrq
->
u
.
ícodög
.
Êags
 & 
IW_ENCODE_RESTRICTED
)

3865 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeSh¨ed
;

3867 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeO≥n
;

3869 if(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11WEPDißbÀd
)

3870 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeO≥n
;

3872 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCSIWENCODE Key[%x] => \n", 
ödex
);

3873 
i
 = 0; i < 
Àn
; i++)

3875 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%02x:", 
pAd
->
Sh¨edKey
[
ödex
].
Key
[
i
]);

3876 i‡(
i
%16 == 15)

3877 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "\n");

3879 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "\n");

3881 
SIOCGIWAP
:

3882 i‡(
	`INFRA_ON
(
pAd
Ë|| 
	`ADHOC_ON
(pAd))

3884 
wrq
->
u
.
≠_addr
.
ß_Ámûy
 = 
ARPHRD_ETHER
;

3885 
	`mem˝y
(
wrq
->
u
.
≠_addr
.
ß_d©a
, &
pAd
->
P‹tCfg
.
Bssid
, 
ETH_ALEN
);

3886 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCGIWAP(=%02x:%02x:%02x:%02x:%02x:%02x)\n",

3887 
pAd
->
P‹tCfg
.
Bssid
[0],pAd->PortCfg.Bssid[1],pAd->PortCfg.Bssid[2],

3888 
pAd
->
P‹tCfg
.
Bssid
[3],pAd->PortCfg.Bssid[4],pAd->PortCfg.Bssid[5]);

3892 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCGIWAP(=EMPTY)\n");

3893 
Sètus
 = -
ENOTCONN
;

3896 
SIOCSIWAP
:

3897 
Sètus
 = 
	`c›y_‰om_u£r
(&
Bssid
, &
wrq
->
u
.
≠_addr
.
ß_d©a
, (
NDIS_802_11_MAC_ADDRESS
));

3898 i‡(
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 !
CNTL_IDLE
)

3900 
	`MlmeEnqueue
(
pAd
,

3901 
MLME_CNTL_STATE_MACHINE
,

3902 
RT_CMD_RESET_MLME
,

3904 
NULL
);

3907 
	`MlmeEnqueue
(
pAd
,

3908 
MLME_CNTL_STATE_MACHINE
,

3909 
OID_802_11_BSSID
,

3910 (
NDIS_802_11_MAC_ADDRESS
),

3911 (
VOID
 *)&
Bssid
);

3912 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

3913 
SèãMachöeTouched
 = 
TRUE
;

3914 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCSIWAP %02x:%02x:%02x:%02x:%02x:%02x\n",

3915 
Bssid
[0], Bssid[1], Bssid[2], Bssid[3], Bssid[4], Bssid[5]);

3917 
SIOCGIWMODE
:

3918 i‡(
	`ADHOC_ON
(
pAd
))

3920 
BssTy≥
 = 
Ndis802_11IBSS
;

3921 
wrq
->
u
.
mode
 = 
IW_MODE_ADHOC
;

3923 i‡(
	`INFRA_ON
(
pAd
))

3925 
BssTy≥
 = 
Ndis802_11In‰a°ru˘uª
;

3926 
wrq
->
u
.
mode
 = 
IW_MODE_INFRA
;

3930 
BssTy≥
 = 
Ndis802_11AutoUnknown
;

3931 
wrq
->
u
.
mode
 = 
IW_MODE_AUTO
;

3933 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCGIWMODE(=%d)\n", 
BssTy≥
);

3935 
SIOCSIWMODE
:

3936 if(
wrq
->
u
.
mode
 =
IW_MODE_ADHOC
)

3938 i‡(
pAd
->
P‹tCfg
.
BssTy≥
 !
BSS_ADHOC
)

3941 
pAd
->
bC⁄figCh™ged
 = 
TRUE
;

3943 
pAd
->
P‹tCfg
.
BssTy≥
 = 
BSS_ADHOC
;

3944 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCSIWMODE (AD-HOC)\n");

3946 i‡(
wrq
->
u
.
mode
 =
IW_MODE_INFRA
)

3948 i‡(
pAd
->
P‹tCfg
.
BssTy≥
 !
BSS_INFRA
)

3951 
pAd
->
bC⁄figCh™ged
 = 
TRUE
;

3953 
pAd
->
P‹tCfg
.
BssTy≥
 = 
BSS_INFRA
;

3954 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCSIWMODE (INFRA)\n");

3958 
Sètus
 = -
EINVAL
;

3959 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::SIOCSIWMODE (unknown)\n");

3962 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_NOTUSE
;

3964 
SIOCGIWSENS
:

3965 
SIOCSIWSENS
:

3966 
SIOCGIWPOWER
:

3967 
SIOCSIWPOWER
:

3968 
SIOCGIWTXPOW
:

3969 
SIOCSIWTXPOW
:

3970 
SIOCGIWRANGE
:

3971 
SIOCGIWRETRY
:

3972 
SIOCSIWRETRY
:

3973 
Sètus
 = -
EOPNOTSUPP
;

3975 
RT_PRIV_IOCTL
:

3976 
subcmd
 = 
wrq
->
u
.
d©a
.
Êags
;

3977 if–
subcmd
 & 
OID_GET_SET_TOGGLE
)

3978 
Sètus
 = 
	`RTMPSëInf‹m©i⁄
(
pAd
, 
rq
, 
subcmd
);

3980 
Sètus
 = 
	`RTMPQuîyInf‹m©i⁄
(
pAd
, 
rq
, 
subcmd
);

3982 
SIOCGIWPRIV
:

3983 i‡(
wrq
->
u
.
d©a
.
poöãr
) {

3984 i‡–
	`ac˚ss_ok
(
VERIFY_WRITE
, 
wrq
->
u
.
d©a
.
poöãr
, (
¥ivèb
)Ë!
TRUE
)

3986 
wrq
->
u
.
d©a
.
Àngth
 = (
¥ivèb
) / (privtab[0]);

3987 i‡(
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, 
¥ivèb
, (privtab)))

3988 
Sètus
 = -
EFAULT
;

3991 
RTPRIV_IOCTL_SHOW
:

3993 
CHAR
 *
this_ch¨
;

3994 
CHAR
 *
vÆue
 = 
NULL
;

3996 if–
	`ac˚ss_ok
(
VERIFY_READ
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
Ë!
TRUE
)

3999 (
this_ch¨
 = 
	`°r£p
((**)&
wrq
->
u
.
d©a
.
poöãr
, ",")Ë!
NULL
)

4001 i‡(!*
this_ch¨
)

4004 
PRTMP_PRIVATE_SHOW_PROC
 = 
RTMP_PRIVATE_SHOW_SUPPORT_PROC
; PRTMP_PRIVATE_SHOW_PROC->
«me
; PRTMP_PRIVATE_SHOW_PROC++)

4006 i‡(!
	`°rcmp
(
this_ch¨
, 
PRTMP_PRIVATE_SHOW_PROC
->
«me
))

4008 if(!
PRTMP_PRIVATE_SHOW_PROC
->
	`£t_¥oc
(
pAd
, 
vÆue
))

4010 
Sètus
 = -
EINVAL
;

4016 if(
PRTMP_PRIVATE_SHOW_PROC
->
«me
 =
NULL
)

4018 
Sètus
 = -
EINVAL
;

4019 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::(iw¥ivËComm™dÇŸ Suµ‹à[%s=%s]\n", 
this_ch¨
, 
vÆue
);

4025 
RTPRIV_IOCTL_SET
:

4027 
CHAR
 *
this_ch¨
;

4028 
CHAR
 *
vÆue
;

4030 if–
	`ac˚ss_ok
(
VERIFY_READ
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
)!=
TRUE
 )

4033 
this_ch¨
 = 
	`kmÆloc
(
wrq
->
u
.
d©a
.
Àngth
, 
MEM_ALLOC_FLAG
);

4034 if(
this_ch¨
 =
NULL
)

4036 
Sètus
 = -
ENOMEM
;

4040 
Sètus
 = 
	`c›y_‰om_u£r
(
this_ch¨
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

4042 i‡(!*
this_ch¨
)

4045 i‡((
vÆue
 = 
	`π°rchr
(
this_ch¨
, '=')Ë!
NULL
)

4046 *
vÆue
++ = 0;

4048 i‡(!
vÆue
)

4052 i‡(!*
vÆue
 && (
	`°rcmp
(
this_ch¨
, "SSID") != 0))

4055 
PRTMP_PRIVATE_SET_PROC
 = 
RTMP_PRIVATE_SUPPORT_PROC
; PRTMP_PRIVATE_SET_PROC->
«me
; PRTMP_PRIVATE_SET_PROC++)

4057 i‡(!
	`°rcmp
(
this_ch¨
, 
PRTMP_PRIVATE_SET_PROC
->
«me
))

4059 if(!
PRTMP_PRIVATE_SET_PROC
->
	`£t_¥oc
(
pAd
, 
vÆue
))

4061 
Sètus
 = -
EINVAL
;

4067 if(
PRTMP_PRIVATE_SET_PROC
->
«me
 =
NULL
)

4069 
Sètus
 = -
EINVAL
;

4070 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::(iw¥ivËComm™dÇŸ Suµ‹à[%s=%s]\n", 
this_ch¨
, 
vÆue
);

4073 
	`k‰ì
(
this_ch¨
);

4076 
RTPRIV_IOCTL_GSITESURVEY
:

4077 
	`RTMPIo˘lGëSôeSurvey
(
pAd
, 
wrq
);

4080 
RTPRIV_IOCTL_STATISTICS
:

4081 
	`RTMPIo˘lSèti°ics
(
pAd
, 
wrq
);

4083 #ifde‡
DBG


4084 
RTPRIV_IOCTL_BBP
:

4085 
	`RTMPIo˘lBBP
(
pAd
, 
wrq
);

4088 
RTPRIV_IOCTL_MAC
:

4089 
	`RTMPIo˘lMAC
(
pAd
, 
wrq
);

4091 #ifde‡
RALINK_ATE


4092 
RTPRIV_IOCTL_E2P
:

4093 
	`RTMPIo˘lE2PROM
(
pAd
, 
wrq
);

4100 
RTPRIV_IOCTL_AUTH
:

4101 
Sètus
 = 
	`RTMPIo˘lSëAuth
(
pAd
, 
wrq
);

4103 
RTPRIV_IOCTL_WEPSTATUS
:

4104 
Sètus
 = 
	`RTMPIo˘lSëEn¸yp
(
pAd
, 
wrq
);

4106 
RTPRIV_IOCTL_WPAPSK
:

4107 
Sètus
 = 
	`RTMPIo˘lSëW∑psk
(
pAd
, 
wrq
);

4109 
RTPRIV_IOCTL_PSM
:

4110 
Sètus
 = 
	`RTMPIo˘lSëPsm
(
pAd
, 
wrq
);

4113 
RTPRIV_IOCTL_GETRAAPCFG
:

4114 
	`RTMPIo˘lGëRaAPCfg
(
pAd
, 
wrq
);

4117 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "IOCTL::unknow¿IOCTL'†cmd = 0x%08x\n", 
cmd
);

4118 i‡(
cmd
 == 0x89F1)

4119 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

4121 
Sètus
 = -
EOPNOTSUPP
;

4126 if(
SèãMachöeTouched
)

4127 
	`RTUSBMlmeUp
(
pAd
);

4130  
Sètus
;

4131 
	}
}

4148 
NDIS_STATUS
 
	$RTMPWPAAddKeyProc
(

4149 
IN
 
PRTMP_ADAPTER
 
pAd
,

4150 
IN
 
PVOID
 
pBuf
)

4152 
PNDIS_802_11_KEY
 
pKey
;

4153 
ULONG
 
KeyIdx
;

4156 
PUCHAR
 
pTxMic
, 
pRxMic
;

4157 
BOOLEAN
 
bTxKey
;

4158 
BOOLEAN
 
bPaúwi£
;

4159 
BOOLEAN
 
bKeyRSC
;

4161 
BOOLEAN
 
bAuthítiˇt‹
;

4163 
pKey
 = (
PNDIS_802_11_KEY
Ë
pBuf
;

4164 
KeyIdx
 = 
pKey
->
KeyIndex
 & 0xff;

4166 
bTxKey
 = (
pKey
->
KeyIndex
 & 0x80000000Ë? 
TRUE
 : 
FALSE
;

4168 
bPaúwi£
 = (
pKey
->
KeyIndex
 & 0x40000000Ë? 
TRUE
 : 
FALSE
;

4170 
bKeyRSC
 = (
pKey
->
KeyIndex
 & 0x20000000Ë? 
TRUE
 : 
FALSE
;

4172 
bAuthítiˇt‹
 = (
pKey
->
KeyIndex
 & 0x10000000Ë? 
TRUE
 : 
FALSE
;

4177 i‡(
bPaúwi£
)

4180 i‡(
KeyIdx
 != 0)

4181 (
NDIS_STATUS_FAILURE
);

4184 i‡(
bTxKey
 =
FALSE
)

4185 (
NDIS_STATUS_FAILURE
);

4188 i‡(
	`MAC_ADDR_EQUAL
(
pKey
->
BSSID
, 
BROADCAST_ADDR
))

4189 (
NDIS_STATUS_FAILURE
);

4193 i‡((
pAd
->
P‹tCfg
.
PaúCùhî
 =
Ndis802_11En¸y±i⁄2E«bÀd
Ë&& (
pKey
->
KeyLígth
 !
LEN_TKIP_KEY
))

4194 (
NDIS_STATUS_FAILURE
);

4196 
pAd
->
Sh¨edKey
[
KeyIdx
].
Ty≥
 = 
PAIRWISE_KEY
;

4198 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2
)

4201 
	`RTMPIndiˇãWPA2Sètus
(
pAd
);

4207 i‡((! 
	`MAC_ADDR_EQUAL
(
pKey
->
BSSID
, 
BROADCAST_ADDR
)) &&

4208 (! 
	`MAC_ADDR_EQUAL
(
pKey
->
BSSID
, 
pAd
->
P‹tCfg
.
Bssid
)))

4209 (
NDIS_STATUS_FAILURE
);

4212 i‡(
KeyIdx
 >
GROUP_KEY_NO
)

4213 (
NDIS_STATUS_FAILURE
);

4215 
pAd
->
Sh¨edKey
[
KeyIdx
].
Ty≥
 = 
GROUP_KEY
;

4220 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAN⁄e
)

4223 
pTxMic
 = (
PUCHAR
Ë(&
pKey
->
KeyM©îül
) + 16;

4224 
pRxMic
 = 
pTxMic
;

4226 i‡(
bAuthítiˇt‹
 =
TRUE
)

4228 
pTxMic
 = (
PUCHAR
Ë(&
pKey
->
KeyM©îül
) + 16;

4229 
pRxMic
 = (
PUCHAR
Ë(&
pKey
->
KeyM©îül
) + 24;

4233 
pRxMic
 = (
PUCHAR
Ë(&
pKey
->
KeyM©îül
) + 16;

4234 
pTxMic
 = (
PUCHAR
Ë(&
pKey
->
KeyM©îül
) + 24;

4238 i‡(
bKeyRSC
 =
TRUE
)

4239 
	`NdisMoveMem‹y
(
pAd
->
Sh¨edKey
[
KeyIdx
].
RxTsc
, &
pKey
->
KeyRSC
, 6);

4241 
	`NdisZîoMem‹y
(
pAd
->
Sh¨edKey
[
KeyIdx
].
RxTsc
, 6);

4245 
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 = (
UCHAR
Ë
pKey
->
KeyLígth
;

4246 
	`NdisMoveMem‹y
(
pAd
->
Sh¨edKey
[
KeyIdx
].
Key
, &
pKey
->
KeyM©îül
, 16);

4247 i‡(
pKey
->
KeyLígth
 =
LEN_TKIP_KEY
)

4250 
	`NdisMoveMem‹y
(
pAd
->
Sh¨edKey
[
KeyIdx
].
RxMic
, 
pRxMic
, 8);

4251 
	`NdisMoveMem‹y
(
pAd
->
Sh¨edKey
[
KeyIdx
].
TxMic
, 
pTxMic
, 8);

4257 
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 = 16;

4259 
	`COPY_MAC_ADDR
(
pAd
->
Sh¨edKey
[
KeyIdx
].
BssId
, 
pKey
->
BSSID
);

4262 
pAd
->
Sh¨edKey
[
KeyIdx
].
TxTsc
[0] = 1;

4263 
pAd
->
Sh¨edKey
[
KeyIdx
].
TxTsc
[1] = 0;

4264 
pAd
->
Sh¨edKey
[
KeyIdx
].
TxTsc
[2] = 0;

4265 
pAd
->
Sh¨edKey
[
KeyIdx
].
TxTsc
[3] = 0;

4266 
pAd
->
Sh¨edKey
[
KeyIdx
].
TxTsc
[4] = 0;

4267 
pAd
->
Sh¨edKey
[
KeyIdx
].
TxTsc
[5] = 0;

4270 i‡(
bTxKey
 =
TRUE
)

4271 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 = (
UCHAR
Ë
KeyIdx
;

4273 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

4274 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = 
CIPHER_AES
;

4275 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
)

4276 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = 
CIPHER_TKIP
;

4277 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄1E«bÀd
)

4279 i‡(
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 == 5)

4280 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = 
CIPHER_WEP64
;

4281 i‡(
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 == 13)

4282 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = 
CIPHER_WEP128
;

4284 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = 
CIPHER_NONE
;

4287 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = 
CIPHER_NONE
;

4289 i‡((
pAd
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
Ë&& (pAd->P‹tCfg.AuthModê!
Ndis802_11AuthModeWPAN⁄e
))

4294 i‡(!
bPaúwi£
)

4296 i‡(
pAd
->
P‹tCfg
.
GroupCùhî
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

4297 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = 
CIPHER_AES
;

4298 i‡(
pAd
->
P‹tCfg
.
GroupCùhî
 =
Ndis802_11En¸y±i⁄2E«bÀd
)

4299 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = 
CIPHER_TKIP
;

4303 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "pAd->Sh¨edKey[%d].CùhîAlg = %d\n", 
KeyIdx
, 
pAd
->
Sh¨edKey
[KeyIdx].
CùhîAlg
);

4306 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "%†Key #%d", 
CùhîName
[
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
],KeyIdx);

4307 
i
 = 0; i < 16; i++)

4309 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "%02x:", 
pAd
->
Sh¨edKey
[
KeyIdx
].
Key
[
i
]);

4311 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "\n Rx MIC Key = ");

4312 
i
 = 0; i < 8; i++)

4314 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "%02x:", 
pAd
->
Sh¨edKey
[
KeyIdx
].
RxMic
[
i
]);

4316 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "\n Tx MIC Key = ");

4317 
i
 = 0; i < 8; i++)

4319 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "%02x:", 
pAd
->
Sh¨edKey
[
KeyIdx
].
TxMic
[
i
]);

4321 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "\n RxTSC = ");

4322 
i
 = 0; i < 6; i++)

4324 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "%02x:", 
pAd
->
Sh¨edKey
[
KeyIdx
].
RxTsc
[
i
]);

4326 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "\n BSSID:%02x:%02x:%02x:%02x:%02x:%02x \n",

4327 
pKey
->
BSSID
[0],pKey->BSSID[1],pKey->BSSID[2],pKey->BSSID[3],pKey->BSSID[4],pKey->BSSID[5]);

4329 
	`AsicAddSh¨edKeyE¡ry
(
pAd
,

4331 (
UCHAR
)
KeyIdx
,

4332 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
,

4333 
pAd
->
Sh¨edKey
[
KeyIdx
].
Key
,

4334 
pAd
->
Sh¨edKey
[
KeyIdx
].
TxMic
,

4335 
pAd
->
Sh¨edKey
[
KeyIdx
].
RxMic
);

4337 i‡(
pAd
->
Sh¨edKey
[
KeyIdx
].
Ty≥
 =
GROUP_KEY
)

4340 
pAd
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_SECURED
;

4344 
pAd
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_PASS_4_WAY
;

4348  (
NDIS_STATUS_SUCCESS
);

4349 
	}
}

4366 
NDIS_STATUS
 
	$RTMPWPARemoveKeyProc
(

4367 
IN
 
PRTMP_ADAPTER
 
pAd
,

4368 
IN
 
PVOID
 
pBuf
)

4370 
PNDIS_802_11_REMOVE_KEY
 
pKey
;

4371 
ULONG
 
KeyIdx
;

4372 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_FAILURE
;

4373 
BOOLEAN
 
bTxKey
;

4374 
BOOLEAN
 
bPaúwi£
;

4375 
BOOLEAN
 
bKeyRSC
;

4377 
BOOLEAN
 
bAuthítiˇt‹
;

4378 
INT
 
i
;

4380 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"---> RTMPWPARemoveKeyProc\n");

4382 
pKey
 = (
PNDIS_802_11_REMOVE_KEY
Ë
pBuf
;

4383 
KeyIdx
 = 
pKey
->
KeyIndex
 & 0xff;

4385 
bTxKey
 = (
pKey
->
KeyIndex
 & 0x80000000Ë? 
TRUE
 : 
FALSE
;

4387 
bPaúwi£
 = (
pKey
->
KeyIndex
 & 0x40000000Ë? 
TRUE
 : 
FALSE
;

4389 
bKeyRSC
 = (
pKey
->
KeyIndex
 & 0x20000000Ë? 
TRUE
 : 
FALSE
;

4391 
bAuthítiˇt‹
 = (
pKey
->
KeyIndex
 & 0x10000000Ë? 
TRUE
 : 
FALSE
;

4394 i‡(
bTxKey
 =
TRUE
)

4395 (
NDIS_STATUS_FAILURE
);

4398 i‡(
bPaúwi£
)

4402 
i
 = 0; i < 
SHARE_KEY_NUM
; i++)

4404 i‡(
	`MAC_ADDR_EQUAL
(
pAd
->
Sh¨edKey
[
i
].
BssId
, 
pKey
->
BSSID
))

4406 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"RTMPWPARemoveKeyProc(KeyIdx=%d)\n", 
i
);

4407 
pAd
->
Sh¨edKey
[
i
].
KeyLí
 = 0;

4408 
pAd
->
Sh¨edKey
[
i
].
CùhîAlg
 = 
CIPHER_NONE
;

4409 
	`AsicRemoveSh¨edKeyE¡ry
(
pAd
, 0, (
UCHAR
)
i
);

4410 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

4420 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"RTMPWPARemoveKeyProc(KeyIdx=%d)\n", 
KeyIdx
);

4421 
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 = 0;

4422 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = 
CIPHER_NONE
;

4423 
	`AsicRemoveSh¨edKeyE¡ry
(
pAd
, 0, (
UCHAR
)
KeyIdx
);

4424 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

4427  (
Sètus
);

4428 
	}
}

4446 
VOID
 
	$RTMPIndiˇãWPA2Sètus
(

4447 
IN
 
PRTMP_ADAPTER
 
pAd
)

4451 
NDIS_802_11_STATUS_TYPE
 
Sètus
;

4452 
NDIS_802_11_PMKID_CANDIDATE_LIST
 
Li°
;

4453 } 
C™did©e
;

4456 
C™did©e
.
Sètus
 = 
Ndis802_11SètusTy≥_PMKID_C™did©eLi°
;

4457 
C™did©e
.
Li°
.
Vîsi⁄
 = 1;

4459 
C™did©e
.
Li°
.
NumC™did©es
 = 1;

4460 
	`NdisMoveMem‹y
(&
C™did©e
.
Li°
.
C™did©eLi°
[0].
BSSID
, 
pAd
->
P‹tCfg
.
Bssid
, 6);

4461 
C™did©e
.
Li°
.
C™did©eLi°
[0].
Fœgs
 = 0;

4465 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RTMPIndicateWPA2Status\n");

4466 
	}
}

4482 
VOID
 
	$RTMPWPARemoveAŒKeys
(

4483 
IN
 
PRTMP_ADAPTER
 
pAd
)

4485 
INT
 
i
;

4487 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"RTMPWPARemoveAŒKeys(AuthMode=%d, WïSètus=%d)\n", 
pAd
->
P‹tCfg
.
AuthMode
,ÖAd->P‹tCfg.
WïSètus
);

4491 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAN⁄e
)

4494 
i
 = 0; i < 
SHARE_KEY_NUM
; i++)

4502 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"ªmovê%†key #%d\n", 
CùhîName
[
pAd
->
Sh¨edKey
[
i
].
CùhîAlg
], i);

4503 
pAd
->
Sh¨edKey
[
i
].
CùhîAlg
 = 
CIPHER_NONE
;

4504 
pAd
->
Sh¨edKey
[
i
].
KeyLí
 = 0;

4505 
	`AsicRemoveSh¨edKeyE¡ry
(
pAd
, 0, (
UCHAR
)
i
);

4508 
	}
}

4522 
VOID
 
	$RTMPSëPhyMode
(

4523 
IN
 
PRTMP_ADAPTER
 
pAd
,

4524 
IN
 
ULONG
 
phymode
)

4526 
INT
 
i
;

4528 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"RTMPSëPhyMode(=%dË%d \n", 
phymode
,
pAd
->
P‹tCfg
.
PhyMode
);

4533 i‡((
pAd
->
RfIcTy≥
 =
RFIC_5226
Ë|| (pAd->RfIcTy≥ =
RFIC_5225
))

4535 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"RFIC[%d], Phymode(=%d)\n", 
pAd
->
RfIcTy≥
, 
phymode
);

4537 i‡((
pAd
->
RfIcTy≥
 =
RFIC_2528
Ë|| (pAd->RfIcTy≥ =
RFIC_2527
Ë|| (pAd->RfIcTy≥ =
RFIC_3020
))

4539 i‡((
phymode
 =
PHY_11A
Ë|| (phymodê=
PHY_11ABG_MIXED
))

4540 
phymode
 = 
PHY_11BG_MIXED
;

4541 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"RFIC[%d], Phymode(=%d)\n", 
pAd
->
RfIcTy≥
, 
phymode
);

4545 i‡(
pAd
->
P‹tCfg
.
PhyMode
 =
phymode
)

4548 
pAd
->
P‹tCfg
.
PhyMode
 = (
UCHAR
)
phymode
;

4549 
	`BuûdCh™√lLi°
(
pAd
);

4552 
i
 = 0; i < 
pAd
->
Ch™√lLi°Num
; i++)

4554 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 =pAd->
Ch™√lLi°
[
i
].Channel)

4557 i‡(
i
 =
pAd
->
Ch™√lLi°Num
)

4558 
pAd
->
P‹tCfg
.
Ch™√l
 = 
	`Fú°Ch™√l
(pAd);

4560 
	`NdisZîoMem‹y
(
pAd
->
P‹tCfg
.
SupR©e
, 
MAX_LEN_OF_SUPPORTED_RATES
);

4561 
	`NdisZîoMem‹y
(
pAd
->
P‹tCfg
.
ExtR©e
, 
MAX_LEN_OF_SUPPORTED_RATES
);

4562 
	`NdisZîoMem‹y
(
pAd
->
P‹tCfg
.
DesúeR©e
, 
MAX_LEN_OF_SUPPORTED_RATES
);

4563 
phymode
) {

4564 
PHY_11B
:

4565 
pAd
->
P‹tCfg
.
SupR©e
[0] = 0x82;

4566 
pAd
->
P‹tCfg
.
SupR©e
[1] = 0x84;

4567 
pAd
->
P‹tCfg
.
SupR©e
[2] = 0x8B;

4568 
pAd
->
P‹tCfg
.
SupR©e
[3] = 0x96;

4569 
pAd
->
P‹tCfg
.
SupR©eLí
 = 4;

4570 
pAd
->
P‹tCfg
.
ExtR©eLí
 = 0;

4571 
pAd
->
P‹tCfg
.
DesúeR©e
[0] = 2;

4572 
pAd
->
P‹tCfg
.
DesúeR©e
[1] = 4;

4573 
pAd
->
P‹tCfg
.
DesúeR©e
[2] = 11;

4574 
pAd
->
P‹tCfg
.
DesúeR©e
[3] = 22;

4577 
PHY_11G
:

4578 
PHY_11BG_MIXED
:

4579 
PHY_11ABG_MIXED
:

4580 
pAd
->
P‹tCfg
.
SupR©e
[0] = 0x82;

4581 
pAd
->
P‹tCfg
.
SupR©e
[1] = 0x84;

4582 
pAd
->
P‹tCfg
.
SupR©e
[2] = 0x8B;

4583 
pAd
->
P‹tCfg
.
SupR©e
[3] = 0x96;

4584 
pAd
->
P‹tCfg
.
SupR©e
[4] = 0x12;

4585 
pAd
->
P‹tCfg
.
SupR©e
[5] = 0x24;

4586 
pAd
->
P‹tCfg
.
SupR©e
[6] = 0x48;

4587 
pAd
->
P‹tCfg
.
SupR©e
[7] = 0x6c;

4588 
pAd
->
P‹tCfg
.
SupR©eLí
 = 8;

4589 
pAd
->
P‹tCfg
.
ExtR©e
[0] = 0x8C;

4590 
pAd
->
P‹tCfg
.
ExtR©e
[1] = 0x98;

4591 
pAd
->
P‹tCfg
.
ExtR©e
[2] = 0xb0;

4592 
pAd
->
P‹tCfg
.
ExtR©e
[3] = 0x60;

4593 
pAd
->
P‹tCfg
.
ExtR©eLí
 = 4;

4594 
pAd
->
P‹tCfg
.
DesúeR©e
[0] = 2;

4595 
pAd
->
P‹tCfg
.
DesúeR©e
[1] = 4;

4596 
pAd
->
P‹tCfg
.
DesúeR©e
[2] = 11;

4597 
pAd
->
P‹tCfg
.
DesúeR©e
[3] = 22;

4598 
pAd
->
P‹tCfg
.
DesúeR©e
[4] = 12;

4599 
pAd
->
P‹tCfg
.
DesúeR©e
[5] = 18;

4600 
pAd
->
P‹tCfg
.
DesúeR©e
[6] = 24;

4601 
pAd
->
P‹tCfg
.
DesúeR©e
[7] = 36;

4602 
pAd
->
P‹tCfg
.
DesúeR©e
[8] = 48;

4603 
pAd
->
P‹tCfg
.
DesúeR©e
[9] = 72;

4604 
pAd
->
P‹tCfg
.
DesúeR©e
[10] = 96;

4605 
pAd
->
P‹tCfg
.
DesúeR©e
[11] = 108;

4608 
PHY_11A
:

4609 
pAd
->
P‹tCfg
.
SupR©e
[0] = 0x8C;

4610 
pAd
->
P‹tCfg
.
SupR©e
[1] = 0x12;

4611 
pAd
->
P‹tCfg
.
SupR©e
[2] = 0x98;

4612 
pAd
->
P‹tCfg
.
SupR©e
[3] = 0x24;

4613 
pAd
->
P‹tCfg
.
SupR©e
[4] = 0xb0;

4614 
pAd
->
P‹tCfg
.
SupR©e
[5] = 0x48;

4615 
pAd
->
P‹tCfg
.
SupR©e
[6] = 0x60;

4616 
pAd
->
P‹tCfg
.
SupR©e
[7] = 0x6c;

4617 
pAd
->
P‹tCfg
.
SupR©eLí
 = 8;

4618 
pAd
->
P‹tCfg
.
ExtR©eLí
 = 0;

4619 
pAd
->
P‹tCfg
.
DesúeR©e
[0] = 12;

4620 
pAd
->
P‹tCfg
.
DesúeR©e
[1] = 18;

4621 
pAd
->
P‹tCfg
.
DesúeR©e
[2] = 24;

4622 
pAd
->
P‹tCfg
.
DesúeR©e
[3] = 36;

4623 
pAd
->
P‹tCfg
.
DesúeR©e
[4] = 48;

4624 
pAd
->
P‹tCfg
.
DesúeR©e
[5] = 72;

4625 
pAd
->
P‹tCfg
.
DesúeR©e
[6] = 96;

4626 
pAd
->
P‹tCfg
.
DesúeR©e
[7] = 108;

4633 
	`MlmeUpd©eTxR©es
(
pAd
, 
FALSE
);

4634 
	`AsicSëSlŸTime
(
pAd
, (
BOOLEAN
ÌAd->
P‹tCfg
.
U£Sh‹tSlŸTime
);

4636 
pAd
->
P‹tCfg
.
B™dSèã
 = 
UNKNOWN_BAND
;

4638 
	}
}

4640 
VOID
 
	$RTMPSëDesúedR©es
(

4641 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

4642 
IN
 
LONG
 
R©es
)

4644 
NDIS_802_11_RATES
 
¨yR©es
;

4646 
	`mem£t
(&
¨yR©es
, 0x00, (
NDIS_802_11_RATES
));

4647 
pAd≠ãr
->
P‹tCfg
.
PhyMode
)

4649 
PHY_11A
:

4650 
R©es
)

4653 
¨yR©es
[0] = 0x0c;

4656 
¨yR©es
[0] = 0x12;

4659 
¨yR©es
[0] = 0x18;

4662 
¨yR©es
[0] = 0x24;

4665 
¨yR©es
[0] = 0x30;

4668 
¨yR©es
[0] = 0x48;

4671 
¨yR©es
[0] = 0x60;

4674 
¨yR©es
[0] = 0x6c;

4678 
¨yR©es
[0] = 0x6c;

4679 
¨yR©es
[1] = 0x60;

4680 
¨yR©es
[2] = 0x48;

4681 
¨yR©es
[3] = 0x30;

4682 
¨yR©es
[4] = 0x24;

4683 
¨yR©es
[5] = 0x18;

4684 
¨yR©es
[6] = 0x12;

4685 
¨yR©es
[7] = 0x0c;

4689 
PHY_11BG_MIXED
:

4690 
PHY_11B
:

4691 
PHY_11ABG_MIXED
:

4693 
R©es
)

4696 
¨yR©es
[0] = 0x02;

4699 
¨yR©es
[0] = 0x04;

4702 
¨yR©es
[0] = 0x0b;

4705 
¨yR©es
[0] = 0x16;

4708 
¨yR©es
[0] = 0x0c;

4711 
¨yR©es
[0] = 0x12;

4714 
¨yR©es
[0] = 0x18;

4717 
¨yR©es
[0] = 0x24;

4720 
¨yR©es
[0] = 0x30;

4723 
¨yR©es
[0] = 0x48;

4726 
¨yR©es
[0] = 0x60;

4729 
¨yR©es
[0] = 0x6c;

4733 i‡(
pAd≠ãr
->
P‹tCfg
.
PhyMode
 =
PHY_11B
)

4735 
¨yR©es
[0] = 0x16;

4736 
¨yR©es
[1] = 0x0b;

4737 
¨yR©es
[2] = 0x04;

4738 
¨yR©es
[3] = 0x02;

4742 
¨yR©es
[0] = 0x6c;

4743 
¨yR©es
[1] = 0x60;

4744 
¨yR©es
[2] = 0x48;

4745 
¨yR©es
[3] = 0x30;

4746 
¨yR©es
[4] = 0x16;

4747 
¨yR©es
[5] = 0x0b;

4748 
¨yR©es
[6] = 0x04;

4749 
¨yR©es
[7] = 0x02;

4756 
	`NdisZîoMem‹y
(
pAd≠ãr
->
P‹tCfg
.
DesúeR©e
, 
MAX_LEN_OF_SUPPORTED_RATES
);

4757 
	`NdisMoveMem‹y
(
pAd≠ãr
->
P‹tCfg
.
DesúeR©e
, &
¨yR©es
, (
NDIS_802_11_RATES
));

4758 
	`DBGPRINT
(
RT_DEBUG_TRACE
, " RTMPSetDesiredRates (%02x,%02x,%02x,%02x,%02x,%02x,%02x,%02x)\n",

4759 
pAd≠ãr
->
P‹tCfg
.
DesúeR©e
[0],pAdapter->PortCfg.DesireRate[1],

4760 
pAd≠ãr
->
P‹tCfg
.
DesúeR©e
[2],pAdapter->PortCfg.DesireRate[3],

4761 
pAd≠ãr
->
P‹tCfg
.
DesúeR©e
[4],pAdapter->PortCfg.DesireRate[5],

4762 
pAd≠ãr
->
P‹tCfg
.
DesúeR©e
[6],pAdapter->PortCfg.DesireRate[7] );

4764 
	`MlmeUpd©eTxR©es
(
pAd≠ãr
, 
FALSE
);

4765 
	}
}

4767 
INT
 
	$Së_DrivîVîsi⁄_Proc
(

4768 
IN
 
PRTMP_ADAPTER
 
pAd
,

4769 
IN
 
PUCHAR
 
¨g
)

4771 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Drivî vîsi⁄-%s\n", 
DRIVER_VERSION
);

4773  
TRUE
;

4774 
	}
}

4785 
INT
 
	$Së_Cou¡ryRegi⁄_Proc
(

4786 
IN
 
PRTMP_ADAPTER
 
pAd
,

4787 
IN
 
PUCHAR
 
¨g
)

4789 
ULONG
 
ªgi⁄
;

4791 
ªgi⁄
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

4794 i‡(
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄
 & 0x80)

4796 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Set_CountryRegion_Proc::parameter of CountryRegion inÉeprom isÖrogrammed \n");

4797  
FALSE
;

4800 if(
ªgi⁄
 <
REGION_MAXIMUM_BG_BAND
)

4802 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄
 = (
UCHAR
Ë
ªgi⁄
;

4806 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Set_CountryRegion_Proc::parameters out ofÑange\n");

4807  
FALSE
;

4811 
	`BuûdCh™√lLi°
(
pAd
);

4813 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Cou¡ryRegi⁄_Proc::(Cou¡ryRegi⁄=%d)\n", 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄
);

4815  
TRUE
;

4816 
	}
}

4827 
INT
 
	$Së_Cou¡ryRegi⁄AB™d_Proc
(

4828 
IN
 
PRTMP_ADAPTER
 
pAd
,

4829 
IN
 
PUCHAR
 
¨g
)

4831 
ULONG
 
ªgi⁄
;

4833 
ªgi⁄
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

4836 i‡(
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄F‹AB™d
 & 0x80)

4838 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Set_CountryRegionABand_Proc::parameter of CountryRegion inÉeprom isÖrogrammed \n");

4839  
FALSE
;

4842 if(
ªgi⁄
 <
REGION_MAXIMUM_A_BAND
)

4844 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄F‹AB™d
 = (
UCHAR
Ë
ªgi⁄
;

4848 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Set_CountryRegionABand_Proc::parameters out ofÑange\n");

4849  
FALSE
;

4853 
	`BuûdCh™√lLi°
(
pAd
);

4855 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Cou¡ryRegi⁄AB™d_Proc::(Cou¡ryRegi⁄=%d)\n", 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄F‹AB™d
);

4857  
TRUE
;

4858 
	}
}

4868 
INT
 
	$Së_SSID_Proc
(

4869 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

4870 
IN
 
PUCHAR
 
¨g
)

4872 
NDIS_802_11_SSID
 
Ssid
, *
pSsid
=
NULL
;

4873 
BOOLEAN
 
SèãMachöeTouched
 = 
FALSE
;

4874 
suc˚ss
 = 
TRUE
;

4876 if–
	`°æí
(
¨g
Ë<
MAX_LEN_OF_SSID
)

4879 
	`NdisZîoMem‹y
(&
Ssid
, 
MAX_LEN_OF_SSID
);

4880 i‡(
	`°æí
(
¨g
) != 0)

4882 
	`NdisMoveMem‹y
(
Ssid
.Ssid, 
¨g
, 
	`°æí
(arg));

4883 
Ssid
.
SsidLígth
 = 
	`°æí
(
¨g
);

4887 
Ssid
.
SsidLígth
 = 0;

4888 
	`mem˝y
(
Ssid
.Ssid, "", 0);

4891 
pSsid
 = &
Ssid
;

4893 i‡(
pAd≠ãr
->
Mlme
.
C¡lMachöe
.
CuºSèã
 !
CNTL_IDLE
)

4895 
	`MlmeEnqueue
(
pAd≠ãr
,

4896 
MLME_CNTL_STATE_MACHINE
,

4897 
RT_CMD_RESET_MLME
,

4899 
NULL
);

4903 i‡(
pAd≠ãr
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
)

4905 
	`NdisZîoMem‹y
(
pAd≠ãr
->
MlmeAux
.
Ssid
, 
MAX_LEN_OF_SSID
);

4906 
	`NdisMoveMem‹y
(
pAd≠ãr
->
MlmeAux
.
Ssid
, Ssid.Ssid, Ssid.
SsidLígth
);

4907 
pAd≠ãr
->
MlmeAux
.
SsidLí
 = 
Ssid
.
SsidLígth
;

4910 
	`MlmeEnqueue
(
pAd≠ãr
,

4911 
MLME_CNTL_STATE_MACHINE
,

4912 
OID_802_11_SSID
,

4913 (
NDIS_802_11_SSID
),

4914 (
VOID
 *)
pSsid
);

4916 
SèãMachöeTouched
 = 
TRUE
;

4917 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_SSID_Proc::(Lí=%d,Ssid=%s)\n", 
Ssid
.
SsidLígth
, Ssid.Ssid);

4920 
suc˚ss
 = 
FALSE
;

4922 i‡(
SèãMachöeTouched
)

4923 
	`RTUSBMlmeUp
(
pAd≠ãr
);

4925  
suc˚ss
;

4926 
	}
}

4936 
INT
 
	$Së_WúñessMode_Proc
(

4937 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

4938 
IN
 
PUCHAR
 
¨g
)

4940 
ULONG
 
WúñessMode
;

4941 
suc˚ss
 = 
TRUE
;

4943 
WúñessMode
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

4945 i‡((
WúñessMode
 =
PHY_11BG_MIXED
Ë|| (WúñessModê=
PHY_11B
) ||

4946 (
WúñessMode
 =
PHY_11A
Ë|| (WúñessModê=
PHY_11ABG_MIXED
) ||

4947 (
WúñessMode
 =
PHY_11G
))

4950 i‡((
pAd≠ãr
->
RfIcTy≥
 !
RFIC_5226
Ë&& (pAd≠ãr->RfIcTy≥ !
RFIC_5225
))

4952 i‡((
WúñessMode
 =
PHY_11A
Ë|| (WúñessModê=
PHY_11ABG_MIXED
))

4954 
	`DBGPRINT_ERR
("!!!!! NŸ suµ‹àA b™d i¿RfIcTy≥%d\n", 
pAd≠ãr
->
RfIcTy≥
);

4955  
FALSE
;

4959 
	`RTMPSëPhyMode
(
pAd≠ãr
, 
WúñessMode
);

4961 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_WúñessMode_Proc::(=%d)\n", 
WúñessMode
);

4963  
suc˚ss
;

4967 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Set_WirelessMode_Proc::parameters out ofÑange\n");

4968  
FALSE
;

4970 
	}
}

4980 
INT
 
	$Së_TxR©e_Proc
(

4981 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

4982 
IN
 
PUCHAR
 
¨g
)

4984 
ULONG
 
TxR©e
;

4985 
suc˚ss
 = 
TRUE
;

4987 
TxR©e
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

4989 i‡((
pAd≠ãr
->
P‹tCfg
.
PhyMode
 =
PHY_11B
 && 
TxR©e
 <= 4) ||\

4990 ((
pAd≠ãr
->
P‹tCfg
.
PhyMode
 =
PHY_11BG_MIXED
 ||ÖAd≠ãr->P‹tCfg.PhyModê=
PHY_11ABG_MIXED
Ë&& 
TxR©e
 <= 12) ||\

4991 ((
pAd≠ãr
->
P‹tCfg
.
PhyMode
 =
PHY_11A
 ||ÖAd≠ãr->P‹tCfg.PhyModê=
PHY_11G
Ë&& (
TxR©e
 == 0 ||(TxRate > 4 && TxRate <= 12))))

4993 i‡(
TxR©e
 == 0)

4994 
	`RTMPSëDesúedR©es
(
pAd≠ãr
, -1);

4996 
	`RTMPSëDesúedR©es
(
pAd≠ãr
, (
LONG
Ë(
R©eIdToMbps
[
TxR©e
-1] * 1000000));

4998 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_TxR©e_Proc::(TxR©e=%d)\n", 
TxR©e
);

5000  
suc˚ss
;

5004 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Set_TxRate_Proc::parameters out ofÑange\n");

5005  
FALSE
;

5007 
	}
}

5017 
INT
 
	$Së_Ch™√l_Proc
(

5018 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5019 
IN
 
PUCHAR
 
¨g
)

5021 
suc˚ss
 = 
TRUE
;

5022 
UCHAR
 
Ch™√l
;

5024 
Ch™√l
 = (
UCHAR
Ë
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

5026 i‡(
	`Ch™√lS™ôy
(
pAd≠ãr
, 
Ch™√l
Ë=
TRUE
)

5028 
pAd≠ãr
->
P‹tCfg
.
Ch™√l
 = Channel;

5030 i‡(
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 =
BSS_ADHOC
)

5031 
pAd≠ãr
->
P‹tCfg
.
AdhocCh™√l
 =ÖAd≠ãr->P‹tCfg.
Ch™√l
;

5033 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Ch™√l_Proc::(Ch™√l=%d)\n", 
Ch™√l
);

5036 
suc˚ss
 = 
FALSE
;

5038  
suc˚ss
;

5039 
	}
}

5041 #ifde‡
DBG


5050 
INT
 
	$Së_Debug_Proc
(

5051 
IN
 
PRTMP_ADAPTER
 
pAd
,

5052 
IN
 
PUCHAR
 
¨g
)

5054 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==> Set_Debug_Proc *******************\n");

5056 if(
	`sim∂e_°πﬁ
(
¨g
, 0, 10Ë<
RT_DEBUG_LOUD
)

5057 
RTDebugLevñ
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

5059 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<=Së_Debug_Proc(RTDebugLevñ = %d)\n", 
RTDebugLevñ
);

5061  
TRUE
;

5062 
	}
}

5073 
INT
 
	$Së_BGPrŸe˘i⁄_Proc
(

5074 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5075 
IN
 
PUCHAR
 
¨g
)

5078 
	`sim∂e_°πﬁ
(
¨g
, 0, 10))

5081 
pAd≠ãr
->
P‹tCfg
.
U£BGPrŸe˘i⁄
 = 0;

5084 
pAd≠ãr
->
P‹tCfg
.
U£BGPrŸe˘i⁄
 = 1;

5087 
pAd≠ãr
->
P‹tCfg
.
U£BGPrŸe˘i⁄
 = 2;

5090  
FALSE
;

5092 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_BGPrŸe˘i⁄_Proc::(BGPrŸe˘i⁄=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
U£BGPrŸe˘i⁄
);

5094  
TRUE
;

5095 
	}
}

5105 
INT
 
	$Së_TxPªambÀ_Proc
(

5106 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5107 
IN
 
PUCHAR
 
¨g
)

5109 
RT_802_11_PREAMBLE
 
PªambÀ
;

5111 
PªambÀ
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

5112 
PªambÀ
)

5114 
Rt802_11PªambÀSh‹t
:

5115 
pAd≠ãr
->
P‹tCfg
.
TxPªambÀ
 = 
PªambÀ
;

5116 
	`MlmeSëTxPªambÀ
(
pAd≠ãr
, 
Rt802_11PªambÀSh‹t
);

5118 
Rt802_11PªambÀL⁄g
:

5119 
Rt802_11PªambÀAuto
:

5122 
pAd≠ãr
->
P‹tCfg
.
TxPªambÀ
 = 
PªambÀ
;

5123 
	`MlmeSëTxPªambÀ
(
pAd≠ãr
, 
Rt802_11PªambÀL⁄g
);

5126  
FALSE
;

5129 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_TxPªambÀ_Proc::(TxPªambÀ=%d)\n", 
PªambÀ
);

5131  
TRUE
;

5132 
	}
}

5142 
INT
 
	$Së_RTSThªshﬁd_Proc
(

5143 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5144 
IN
 
PUCHAR
 
¨g
)

5146 
NDIS_802_11_RTS_THRESHOLD
 
RtsThªsh
;

5148 
RtsThªsh
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

5150 if((
RtsThªsh
 > 0Ë&& (RtsThªsh <
MAX_RTS_THRESHOLD
))

5151 
pAd≠ãr
->
P‹tCfg
.
RtsThªshﬁd
 = (
USHORT
)
RtsThªsh
;

5152 i‡(
RtsThªsh
 == 0)

5153 
pAd≠ãr
->
P‹tCfg
.
RtsThªshﬁd
 = 
MAX_RTS_THRESHOLD
;

5155  
FALSE
;

5157 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_RTSThªshﬁd_Proc::(RTSThªshﬁd=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
RtsThªshﬁd
);

5158  
TRUE
;

5159 
	}
}

5169 
INT
 
	$Së_FøgThªshﬁd_Proc
(

5170 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5171 
IN
 
PUCHAR
 
¨g
)

5173 
NDIS_802_11_FRAGMENTATION_THRESHOLD
 
FøgThªsh
;

5175 
FøgThªsh
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

5177 i‡–(
FøgThªsh
 >
MIN_FRAG_THRESHOLD
Ë&& (FøgThªsh <
MAX_FRAG_THRESHOLD
))

5178 
pAd≠ãr
->
P‹tCfg
.
FøgmítThªshﬁd
 = (
USHORT
)
FøgThªsh
;

5179 i‡(
FøgThªsh
 == 0)

5180 
pAd≠ãr
->
P‹tCfg
.
FøgmítThªshﬁd
 = 
MAX_FRAG_THRESHOLD
;

5182  
FALSE
;

5184 i‡(
pAd≠ãr
->
P‹tCfg
.
FøgmítThªshﬁd
 =
MAX_FRAG_THRESHOLD
)

5185 
pAd≠ãr
->
P‹tCfg
.
bFøgmítZîoDißbÀ
 = 
TRUE
;

5187 
pAd≠ãr
->
P‹tCfg
.
bFøgmítZîoDißbÀ
 = 
FALSE
;

5189 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_FøgThªshﬁd_Proc::(FøgThªshﬁd=%d)\n", 
FøgThªsh
);

5191  
TRUE
;

5192 
	}
}

5202 
INT
 
	$Së_TxBur°_Proc
(

5203 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5204 
IN
 
PUCHAR
 
¨g
)

5206 
ULONG
 
TxBur°
;

5208 
TxBur°
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

5210 i‡(
TxBur°
 == 1)

5211 
pAd≠ãr
->
P‹tCfg
.
bE«bÀTxBur°
 = 
TRUE
;

5212 i‡(
TxBur°
 == 0)

5213 
pAd≠ãr
->
P‹tCfg
.
bE«bÀTxBur°
 = 
FALSE
;

5215  
FALSE
;

5217 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_TxBur°_Proc::(TxBur°=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
bE«bÀTxBur°
);

5219  
TRUE
;

5220 
	}
}

5230 
INT
 
	$Së_AdhocModeR©e_Proc
(

5231 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5232 
IN
 
PUCHAR
 
¨g
)

5234 
ULONG
 
AdhocMode
;

5236 
AdhocMode
 = (
ULONG
)
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

5238 i‡(
AdhocMode
 > 4)

5239  
FALSE
;

5241 i‡(
pAd≠ãr
->
P‹tCfg
.
AdhocMode
 != AdhocMode)

5243 
pAd≠ãr
->
P‹tCfg
.
AdhocMode
 = AdhocMode;

5244 
	`MlmeUpd©eTxR©es
(
pAd≠ãr
, 
FALSE
);

5245 
	`MakeIbssBóc⁄
(
pAd≠ãr
);

5246 
	`AsicE«bÀIbssSync
(
pAd≠ãr
);

5249 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_AdhocModeR©e_Proc::(AdhocMode=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
AdhocMode
);

5251  
TRUE
;

5252 
	}
}

5253 #ifde‡
AGGREGATION_SUPPORT


5262 
INT
 
	$Së_PktAggªg©e_Proc
(

5263 
IN
 
PRTMP_ADAPTER
 
pAd
,

5264 
IN
 
PUCHAR
 
¨g
)

5266 
ULONG
 
aggª
;

5268 
aggª
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

5270 i‡(
aggª
 == 1)

5271 
pAd
->
P‹tCfg
.
bAggªg©i⁄C≠abÀ
 = 
TRUE
;

5272 i‡(
aggª
 == 0)

5273 
pAd
->
P‹tCfg
.
bAggªg©i⁄C≠abÀ
 = 
FALSE
;

5275  
FALSE
;

5277 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_PktAggªg©e_Proc::(AGGRE=%d)\n", 
pAd
->
P‹tCfg
.
bAggªg©i⁄C≠abÀ
);

5279  
TRUE
;

5280 
	}
}

5291 
INT
 
	$Së_TurboR©e_Proc
(

5292 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5293 
IN
 
PUCHAR
 
¨g
)

5295 
ULONG
 
TurboR©e
;

5297 
TurboR©e
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

5299 i‡(
TurboR©e
 == 1)

5300 
pAd≠ãr
->
P‹tCfg
.
E«bÀTurboR©e
 = 
TRUE
;

5301 i‡(
TurboR©e
 == 0)

5302 
pAd≠ãr
->
P‹tCfg
.
E«bÀTurboR©e
 = 
FALSE
;

5304  
FALSE
;

5306 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_TurboR©e_Proc::(TurboR©e=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
E«bÀTurboR©e
);

5308  
TRUE
;

5309 
	}
}

5319 
INT
 
	$Së_WmmC≠abÀ_Proc
(

5320 
IN
 
PRTMP_ADAPTER
 
pAd
,

5321 
IN
 
PUCHAR
 
¨g
)

5323 
BOOLEAN
 
bWmmC≠abÀ
;

5325 
bWmmC≠abÀ
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

5327 i‡(
bWmmC≠abÀ
 == 1)

5328 
pAd
->
P‹tCfg
.
bWmmC≠abÀ
 = 
TRUE
;

5329 i‡(
bWmmC≠abÀ
 == 0)

5330 
pAd
->
P‹tCfg
.
bWmmC≠abÀ
 = 
FALSE
;

5332  
FALSE
;

5334 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_WmmC≠abÀ_Proc::(bWmmC≠abÀ=%d)\n", 
pAd
->
P‹tCfg
.
bWmmC≠abÀ
);

5336  
TRUE
;

5337 
	}
}

5348 
INT
 
	$Së_IEEE80211H_Proc
(

5349 
IN
 
PRTMP_ADAPTER
 
pAd
,

5350 
IN
 
PUCHAR
 
¨g
)

5352 
ULONG
 
õì80211h
;

5354 
õì80211h
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

5356 i‡(
õì80211h
 == 1)

5357 
pAd
->
P‹tCfg
.
bIEEE80211H
 = 
TRUE
;

5358 i‡(
õì80211h
 == 0)

5359 
pAd
->
P‹tCfg
.
bIEEE80211H
 = 
FALSE
;

5361  
FALSE
;

5363 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_IEEE80211H_Proc::(IEEE80211H=%d)\n", 
pAd
->
P‹tCfg
.
bIEEE80211H
);

5365  
TRUE
;

5366 
	}
}

5376 
INT
 
	$Së_Nëw‹kTy≥_Proc
(

5377 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5378 
IN
 
PUCHAR
 
¨g
)

5380 i‡(
	`°rcmp
(
¨g
, "Adhoc") == 0)

5382 i‡(
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 !
BSS_ADHOC
)

5385 i‡(
	`INFRA_ON
(
pAd≠ãr
))

5386 
	`RTUSBEnqueueI¡î«lCmd
(
pAd≠ãr
, 
RT_OID_LINK_DOWN
);

5388 
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 = 
BSS_ADHOC
;

5392 i‡(
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 !
BSS_INFRA
)

5395 i‡(
	`ADHOC_ON
(
pAd≠ãr
))

5396 
	`RTUSBEnqueueI¡î«lCmd
(
pAd≠ãr
, 
RT_OID_LINK_DOWN
);

5398 
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 = 
BSS_INFRA
;

5402 
pAd≠ãr
->
P‹tCfg
.
W∑Sèã
 = 
SS_NOTUSE
;

5404 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Nëw‹kTy≥_Proc::(Nëw‹kTy≥=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
BssTy≥
);

5406  
TRUE
;

5407 
	}
}

5417 
INT
 
	$Së_AuthMode_Proc
(

5418 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5419 
IN
 
PUCHAR
 
¨g
)

5421 i‡((
	`°rcmp
(
¨g
, "WEPAUTO") == 0) || (strcmp(arg, "wepauto") == 0))

5422 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeAutoSwôch
;

5423 i‡((
	`°rcmp
(
¨g
, "OPEN") == 0) || (strcmp(arg, "open") == 0))

5424 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeO≥n
;

5425 i‡((
	`°rcmp
(
¨g
, "SHARED") == 0) || (strcmp(arg, "shared") == 0))

5426 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeSh¨ed
;

5427 i‡((
	`°rcmp
(
¨g
, "WPAPSK") == 0) || (strcmp(arg, "wpapsk") == 0))

5428 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeWPAPSK
;

5429 i‡((
	`°rcmp
(
¨g
, "WPANONE") == 0) || (strcmp(arg, "wpanone") == 0))

5430 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeWPAN⁄e
;

5431 i‡((
	`°rcmp
(
¨g
, "WPA2PSK") == 0) || (strcmp(arg, "wpa2psk") == 0))

5432 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeWPA2PSK
;

5433 i‡((
	`°rcmp
(
¨g
, "WPA") == 0) || (strcmp(arg, "wpa") == 0))

5434 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeWPA
;

5436  
FALSE
;

5438 
pAd≠ãr
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_NOT_SECURED
;

5440 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_AuthMode_Proc::(AuthMode=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
AuthMode
);

5442  
TRUE
;

5443 
	}
}

5453 
INT
 
	$Së_En¸ypTy≥_Proc
(

5454 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5455 
IN
 
PUCHAR
 
¨g
)

5457 i‡((
	`°rcmp
(
¨g
, "NONE") == 0) || (strcmp(arg, "none") == 0))

5459 
pAd≠ãr
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11WEPDißbÀd
;

5460 
pAd≠ãr
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11WEPDißbÀd
;

5461 
pAd≠ãr
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11WEPDißbÀd
;

5463 i‡((
	`°rcmp
(
¨g
, "WEP") == 0) || (strcmp(arg, "wep") == 0))

5465 
pAd≠ãr
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11WEPE«bÀd
;

5466 
pAd≠ãr
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11WEPE«bÀd
;

5467 
pAd≠ãr
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11WEPE«bÀd
;

5469 i‡((
	`°rcmp
(
¨g
, "TKIP") == 0) || (strcmp(arg, "tkip") == 0))

5471 
pAd≠ãr
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

5472 
pAd≠ãr
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

5473 
pAd≠ãr
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

5475 i‡((
	`°rcmp
(
¨g
, "AES") == 0) || (strcmp(arg, "aes") == 0))

5477 
pAd≠ãr
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

5478 
pAd≠ãr
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

5479 
pAd≠ãr
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

5482  
FALSE
;

5484 
	`RTMPMakeRSNIE
(
pAd≠ãr
,ÖAd≠ãr->
P‹tCfg
.
GroupCùhî
);

5488 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_En¸ypTy≥_Proc::(En¸ypTy≥=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
WïSètus
);

5490  
TRUE
;

5491 
	}
}

5501 
INT
 
	$Së_DeÁu…KeyID_Proc
(

5502 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5503 
IN
 
PUCHAR
 
¨g
)

5505 
ULONG
 
KeyIdx
;

5507 
KeyIdx
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

5508 if((
KeyIdx
 >= 1 ) && (KeyIdx <= 4))

5509 
pAd≠ãr
->
P‹tCfg
.
DeÁu…KeyId
 = (
UCHAR
Ë(
KeyIdx
 - 1 );

5511  
FALSE
;

5513 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_DeÁu…KeyID_Proc::(DeÁu…KeyID=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
DeÁu…KeyId
);

5515  
TRUE
;

5516 
	}
}

5526 
INT
 
	$Së_Key1_Proc
(

5527 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5528 
IN
 
PUCHAR
 
¨g
)

5530 
KeyLí
;

5531 
i
;

5532 
UCHAR
 
CùhîAlg
=
CIPHER_WEP64
;

5535 i‡(
pAd≠ãr
->
P‹tCfg
.
WïSètus
 !
Ndis802_11WEPE«bÀd
 ||\

5536 
pAd≠ãr
->
P‹tCfg
.
DeÁu…KeyId
 != 0)

5537  
TRUE
;

5539 
KeyLí
 = 
	`°æí
(
¨g
);

5541 
KeyLí
)

5544 
pAd≠ãr
->
Sh¨edKey
[0].
KeyLí
 = KeyLen;

5545 
	`mem˝y
(
pAd≠ãr
->
Sh¨edKey
[0].
Key
, 
¨g
, 
KeyLí
);

5546 
CùhîAlg
 = 
CIPHER_WEP64
;

5547 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key1_Proc::(Key1=%†™dÅy≥=%s)\n", 
¨g
, "Ascii");

5550 
i
=0; i < 
KeyLí
; i++)

5552 if–!
	`isxdigô
(*(
¨g
+
i
)) )

5553  
FALSE
;

5555 
pAd≠ãr
->
Sh¨edKey
[0].
KeyLí
 = KeyLen / 2 ;

5556 
	`AtoH
(
¨g
, 
pAd≠ãr
->
Sh¨edKey
[0].
Key
, 
KeyLí
 / 2);

5557 
CùhîAlg
 = 
CIPHER_WEP64
;

5558 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key1_Proc::(Key1=%†™dÅy≥=%s)\n", 
¨g
, "Hex");

5561 
pAd≠ãr
->
Sh¨edKey
[0].
KeyLí
 = KeyLen;

5562 
	`mem˝y
(
pAd≠ãr
->
Sh¨edKey
[0].
Key
, 
¨g
, 
KeyLí
);

5563 
CùhîAlg
 = 
CIPHER_WEP128
;

5564 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key1_Proc::(Key1=%†™dÅy≥=%s)\n", 
¨g
, "Ascii");

5567 
i
=0; i < 
KeyLí
; i++)

5569 if–!
	`isxdigô
(*(
¨g
+
i
)) )

5570  
FALSE
;

5572 
pAd≠ãr
->
Sh¨edKey
[0].
KeyLí
 = KeyLen / 2 ;

5573 
	`AtoH
(
¨g
, 
pAd≠ãr
->
Sh¨edKey
[0].
Key
, 
KeyLí
 / 2);

5574 
CùhîAlg
 = 
CIPHER_WEP128
;

5575 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key1_Proc::(Key1=%†™dÅy≥=%s)\n", 
¨g
, "Hex");

5578 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key1_Proc::InvÆidárgumíà(=%s)\n", 
¨g
);

5579  
FALSE
;

5582 
pAd≠ãr
->
Sh¨edKey
[0].
CùhîAlg
 = CipherAlg;

5585 i‡(
pAd≠ãr
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
)

5589 
	`AsicAddSh¨edKeyE¡ry
(
pAd≠ãr
,

5592 
pAd≠ãr
->
Sh¨edKey
[0].
CùhîAlg
,

5593 
pAd≠ãr
->
Sh¨edKey
[0].
Key
,

5594 
NULL
,

5595 
NULL
);

5598  
TRUE
;

5599 
	}
}

5609 
INT
 
	$Së_Key2_Proc
(

5610 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5611 
IN
 
PUCHAR
 
¨g
)

5613 
KeyLí
;

5614 
i
;

5615 
UCHAR
 
CùhîAlg
=
CIPHER_WEP64
;

5617 i‡(
pAd≠ãr
->
P‹tCfg
.
WïSètus
 !
Ndis802_11WEPE«bÀd
 ||\

5618 
pAd≠ãr
->
P‹tCfg
.
DeÁu…KeyId
 != 1)

5619  
TRUE
;

5621 
KeyLí
 = 
	`°æí
(
¨g
);

5623 
KeyLí
)

5626 
pAd≠ãr
->
Sh¨edKey
[1].
KeyLí
 = KeyLen;

5627 
	`mem˝y
(
pAd≠ãr
->
Sh¨edKey
[1].
Key
, 
¨g
, 
KeyLí
);

5628 
CùhîAlg
 = 
CIPHER_WEP64
;

5629 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key2_Proc::(Key2=%†™dÅy≥=%s)\n", 
¨g
, "Ascii");

5632 
i
=0; i < 
KeyLí
; i++)

5634 if–!
	`isxdigô
(*(
¨g
+
i
)) )

5635  
FALSE
;

5637 
pAd≠ãr
->
Sh¨edKey
[1].
KeyLí
 = KeyLen / 2 ;

5638 
	`AtoH
(
¨g
, 
pAd≠ãr
->
Sh¨edKey
[1].
Key
, 
KeyLí
 / 2);

5639 
CùhîAlg
 = 
CIPHER_WEP64
;

5640 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key2_Proc::(Key2=%†™dÅy≥=%s)\n", 
¨g
, "Hex");

5643 
pAd≠ãr
->
Sh¨edKey
[1].
KeyLí
 = KeyLen;

5644 
	`mem˝y
(
pAd≠ãr
->
Sh¨edKey
[1].
Key
, 
¨g
, 
KeyLí
);

5645 
CùhîAlg
 = 
CIPHER_WEP128
;

5646 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key2_Proc::(Key2=%†™dÅy≥=%s)\n", 
¨g
, "Ascii");

5649 
i
=0; i < 
KeyLí
; i++)

5651 if–!
	`isxdigô
(*(
¨g
+
i
)) )

5652  
FALSE
;

5654 
pAd≠ãr
->
Sh¨edKey
[1].
KeyLí
 = KeyLen / 2 ;

5655 
	`AtoH
(
¨g
, 
pAd≠ãr
->
Sh¨edKey
[1].
Key
, 
KeyLí
 / 2);

5656 
CùhîAlg
 = 
CIPHER_WEP128
;

5657 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key2_Proc::(Key2=%†™dÅy≥=%s)\n", 
¨g
, "Hex");

5660 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key2_Proc::InvÆidárgumíà(=%s)\n", 
¨g
);

5661  
FALSE
;

5663 
pAd≠ãr
->
Sh¨edKey
[1].
CùhîAlg
 = CipherAlg;

5666 i‡(
pAd≠ãr
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
)

5670 
	`AsicAddSh¨edKeyE¡ry
(
pAd≠ãr
,

5673 
pAd≠ãr
->
Sh¨edKey
[1].
CùhîAlg
,

5674 
pAd≠ãr
->
Sh¨edKey
[1].
Key
,

5675 
NULL
,

5676 
NULL
);

5679  
TRUE
;

5680 
	}
}

5690 
INT
 
	$Së_Key3_Proc
(

5691 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5692 
IN
 
PUCHAR
 
¨g
)

5694 
KeyLí
;

5695 
i
;

5696 
UCHAR
 
CùhîAlg
=
CIPHER_WEP64
;

5698 i‡(
pAd≠ãr
->
P‹tCfg
.
WïSètus
 !
Ndis802_11WEPE«bÀd
 ||\

5699 
pAd≠ãr
->
P‹tCfg
.
DeÁu…KeyId
 != 2)

5700  
TRUE
;

5702 
KeyLí
 = 
	`°æí
(
¨g
);

5704 
KeyLí
)

5707 
pAd≠ãr
->
Sh¨edKey
[2].
KeyLí
 = KeyLen;

5708 
	`mem˝y
(
pAd≠ãr
->
Sh¨edKey
[2].
Key
, 
¨g
, 
KeyLí
);

5709 
CùhîAlg
 = 
CIPHER_WEP64
;

5710 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key3_Proc::(Key3=%†™dÅy≥=%s)\n", 
¨g
, "Ascii");

5713 
i
=0; i < 
KeyLí
; i++)

5715 if–!
	`isxdigô
(*(
¨g
+
i
)) )

5716  
FALSE
;

5718 
pAd≠ãr
->
Sh¨edKey
[2].
KeyLí
 = KeyLen / 2 ;

5719 
	`AtoH
(
¨g
, 
pAd≠ãr
->
Sh¨edKey
[2].
Key
, 
KeyLí
 / 2);

5720 
CùhîAlg
 = 
CIPHER_WEP64
;

5721 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key3_Proc::(Key3=%†™dÅy≥=%s)\n", 
¨g
, "Hex");

5724 
pAd≠ãr
->
Sh¨edKey
[2].
KeyLí
 = KeyLen;

5725 
	`mem˝y
(
pAd≠ãr
->
Sh¨edKey
[2].
Key
, 
¨g
, 
KeyLí
);

5726 
CùhîAlg
 = 
CIPHER_WEP128
;

5727 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key3_Proc::(Key3=%†™dÅy≥=%s)\n", 
¨g
, "Ascii");

5730 
i
=0; i < 
KeyLí
; i++)

5732 if–!
	`isxdigô
(*(
¨g
+
i
)) )

5733  
FALSE
;

5735 
pAd≠ãr
->
Sh¨edKey
[2].
KeyLí
 = KeyLen / 2 ;

5736 
	`AtoH
(
¨g
, 
pAd≠ãr
->
Sh¨edKey
[2].
Key
, 
KeyLí
 / 2);

5737 
CùhîAlg
 = 
CIPHER_WEP128
;

5738 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key3_Proc::(Key3=%†™dÅy≥=%s)\n", 
¨g
, "Hex");

5741 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key3_Proc::InvÆidárgumíà(=%s)\n", 
¨g
);

5742  
FALSE
;

5744 
pAd≠ãr
->
Sh¨edKey
[2].
CùhîAlg
 = CipherAlg;

5747 i‡(
pAd≠ãr
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
)

5751 
	`AsicAddSh¨edKeyE¡ry
(
pAd≠ãr
,

5754 
pAd≠ãr
->
Sh¨edKey
[2].
CùhîAlg
,

5755 
pAd≠ãr
->
Sh¨edKey
[2].
Key
,

5756 
NULL
,

5757 
NULL
);

5760  
TRUE
;

5761 
	}
}

5771 
INT
 
	$Së_Key4_Proc
(

5772 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5773 
IN
 
PUCHAR
 
¨g
)

5775 
KeyLí
;

5776 
i
;

5777 
UCHAR
 
CùhîAlg
=
CIPHER_WEP64
;

5779 i‡(
pAd≠ãr
->
P‹tCfg
.
WïSètus
 !
Ndis802_11WEPE«bÀd
 ||\

5780 
pAd≠ãr
->
P‹tCfg
.
DeÁu…KeyId
 != 3)

5781  
TRUE
;

5783 
KeyLí
 = 
	`°æí
(
¨g
);

5785 
KeyLí
)

5788 
pAd≠ãr
->
Sh¨edKey
[3].
KeyLí
 = KeyLen;

5789 
	`mem˝y
(
pAd≠ãr
->
Sh¨edKey
[3].
Key
, 
¨g
, 
KeyLí
);

5790 
CùhîAlg
 = 
CIPHER_WEP64
;

5791 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key4_Proc::(Key4=%†™dÅy≥=%s)\n", 
¨g
, "Ascii");

5794 
i
=0; i < 
KeyLí
; i++)

5796 if–!
	`isxdigô
(*(
¨g
+
i
)) )

5797  
FALSE
;

5799 
pAd≠ãr
->
Sh¨edKey
[3].
KeyLí
 = KeyLen / 2 ;

5800 
	`AtoH
(
¨g
, 
pAd≠ãr
->
Sh¨edKey
[3].
Key
, 
KeyLí
 / 2);

5801 
CùhîAlg
 = 
CIPHER_WEP64
;

5802 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key4_Proc::(Key4=%†™dÅy≥=%s)\n", 
¨g
, "Hex");

5805 
pAd≠ãr
->
Sh¨edKey
[3].
KeyLí
 = KeyLen;

5806 
	`mem˝y
(
pAd≠ãr
->
Sh¨edKey
[3].
Key
, 
¨g
, 
KeyLí
);

5807 
CùhîAlg
 = 
CIPHER_WEP128
;

5808 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key4_Proc::(Key4=%†™dÅy≥=%s)\n", 
¨g
, "Ascii");

5811 
i
=0; i < 
KeyLí
; i++)

5813 if–!
	`isxdigô
(*(
¨g
+
i
)) )

5814  
FALSE
;

5816 
pAd≠ãr
->
Sh¨edKey
[3].
KeyLí
 = KeyLen / 2 ;

5817 
	`AtoH
(
¨g
, 
pAd≠ãr
->
Sh¨edKey
[3].
Key
, 
KeyLí
 / 2);

5818 
CùhîAlg
 = 
CIPHER_WEP128
;

5819 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key4_Proc::(Key4=%†™dÅy≥=%s)\n", 
¨g
, "Hex");

5822 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_Key4_Proc::InvÆidárgumíà(=%s)\n", 
¨g
);

5823  
FALSE
;

5825 
pAd≠ãr
->
Sh¨edKey
[3].
CùhîAlg
 = CipherAlg;

5828 i‡(
pAd≠ãr
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
)

5832 
	`AsicAddSh¨edKeyE¡ry
(
pAd≠ãr
,

5835 
pAd≠ãr
->
Sh¨edKey
[3].
CùhîAlg
,

5836 
pAd≠ãr
->
Sh¨edKey
[3].
Key
,

5837 
NULL
,

5838 
NULL
);

5841  
TRUE
;

5842 
	}
}

5852 
INT
 
	$Së_WPAPSK_Proc
(

5853 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5854 
IN
 
PUCHAR
 
¨g
)

5856 
UCHAR
 
keyM©îül
[40];

5857 
INT
 
Sètus
;

5859 i‡((
pAd≠ãr
->
P‹tCfg
.
AuthMode
 !
Ndis802_11AuthModeWPAPSK
) &&\

5860 (
pAd≠ãr
->
P‹tCfg
.
AuthMode
 !
Ndis802_11AuthModeWPA2PSK
) &&\

5861 (
pAd≠ãr
->
P‹tCfg
.
AuthMode
 !
Ndis802_11AuthModeWPAN⁄e
) )

5862  
TRUE
;

5864 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_WPAPSK_Proc::(WPAPSK=%s)\n", 
¨g
);

5866 
	`NdisZîoMem‹y
(
keyM©îül
, 40);

5869 
¨g
[
	`°æí
(arg)]='\0';

5871 i‡((
	`°æí
(
¨g
) < 8) || (strlen(arg) > 64))

5873 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së faûed!!(WPAPSK=%s), WPAPSK key-°rögÑequúed 8 ~ 64 ch¨a˘î†\n", 
¨g
);

5874  
FALSE
;

5877 i‡(
	`°æí
(
¨g
) == 64)

5879 
	`AtoH
(
¨g
, 
keyM©îül
, 32);

5880 
	`NdisMoveMem‹y
(
pAd≠ãr
->
P‹tCfg
.
PskKey
.
Key
, 
keyM©îül
, 32);

5884 
	`Passw‹dHash
((*)
¨g
, 
pAd≠ãr
->
MlmeAux
.
Ssid
,ÖAd≠ãr->MlmeAux.
SsidLí
, 
keyM©îül
);

5885 
	`NdisMoveMem‹y
(
pAd≠ãr
->
P‹tCfg
.
PskKey
.
Key
, 
keyM©îül
, 32);

5888 
	`RTMPMakeRSNIE
(
pAd≠ãr
,ÖAd≠ãr->
P‹tCfg
.
GroupCùhî
);

5890 if(
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 =
BSS_ADHOC
 &&\

5891 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAN⁄e
)

5894 
Sètus
 = 
	`RTMPWPAN⁄eAddKeyProc
(
pAd≠ãr
, &
keyM©îül
[0]);

5896 i‡(
Sètus
 !
NDIS_STATUS_SUCCESS
)

5897  
FALSE
;

5899 
pAd≠ãr
->
P‹tCfg
.
W∑Sèã
 = 
SS_NOTUSE
;

5904 
pAd≠ãr
->
P‹tCfg
.
W∑Sèã
 = 
SS_START
;

5907  
TRUE
;

5908 
	}
}

5923 
INT
 
	$Së_Re£tSètCou¡î_Proc
(

5924 
IN
 
PRTMP_ADAPTER
 
pAd
,

5925 
IN
 
PUCHAR
 
¨g
)

5927 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==>Set_ResetStatCounter_Proc\n");

5930 
	`NICUpd©eRawCou¡îs
(
pAd
);

5932 
	`NdisZîoMem‹y
(&
pAd
->
WœnCou¡îs
, (
COUNTER_802_11
));

5933 
	`NdisZîoMem‹y
(&
pAd
->
Cou¡îs8023
, (
COUNTER_802_3
));

5934 
	`NdisZîoMem‹y
(&
pAd
->
RÆökCou¡îs
, (
COUNTER_RALINK
));

5936  
TRUE
;

5937 
	}
}

5947 
INT
 
	$Së_PSMode_Proc
(

5948 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

5949 
IN
 
PUCHAR
 
¨g
)

5951 i‡(
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 =
BSS_INFRA
)

5953 i‡((
	`°rcmp
(
¨g
, "MAX_PSP") == 0) || (strcmp(arg, "max_psp") == 0))

5958 i‡(
pAd≠ãr
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

5959 
pAd≠ãr
->
P‹tCfg
.
WödowsPowîMode
 = 
Ndis802_11PowîModeMAX_PSP
;

5960 
pAd≠ãr
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
Ndis802_11PowîModeMAX_PSP
;

5961 
	`OPSTATUS_SET_FLAG
(
pAd≠ãr
, 
fOP_STATUS_RECEIVE_DTIM
);

5962 
pAd≠ãr
->
P‹tCfg
.
DeÁu…Li°íCou¡
 = 5;

5965 i‡((
	`°rcmp
(
¨g
, "Fast_PSP") == 0) || (strcmp(arg, "fast_psp") == 0) ||

5966 (
	`°rcmp
(
¨g
, "FAST_PSP") == 0))

5971 
	`OPSTATUS_SET_FLAG
(
pAd≠ãr
, 
fOP_STATUS_RECEIVE_DTIM
);

5972 i‡(
pAd≠ãr
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

5973 
pAd≠ãr
->
P‹tCfg
.
WödowsPowîMode
 = 
Ndis802_11PowîModeFa°_PSP
;

5974 
pAd≠ãr
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
Ndis802_11PowîModeFa°_PSP
;

5975 
pAd≠ãr
->
P‹tCfg
.
DeÁu…Li°íCou¡
 = 3;

5981 
	`MlmeSëPsmBô
(
pAd≠ãr
, 
PWR_ACTIVE
);

5982 
	`OPSTATUS_SET_FLAG
(
pAd≠ãr
, 
fOP_STATUS_RECEIVE_DTIM
);

5983 i‡(
pAd≠ãr
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

5984 
pAd≠ãr
->
P‹tCfg
.
WödowsPowîMode
 = 
Ndis802_11PowîModeCAM
;

5985 
pAd≠ãr
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
Ndis802_11PowîModeCAM
;

5988 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_PSMode_Proc::(PSMode=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
WödowsPowîMode
);

5991  
FALSE
;

5994  
TRUE
;

5995 
	}
}

5997 
INT
 
	$Së_TxQueSize_Proc
(

5998 
IN
 
PRTMP_ADAPTER
 
pAd
,

5999 
IN
 
PUCHAR
 
¨g
)

6001 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==> Set_TxQueSize_Proc *******************\n");

6003 
pAd
->
MaxTxQueueSize
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

6005 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<=Së_TxQueSize_Proc(%d)\n", 
pAd
->
MaxTxQueueSize
);

6007  
TRUE
;

6008 
	}
}

6010 #ifde‡
DBG


6029 
VOID
 
	$RTMPIo˘lBBP
(

6030 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

6031 
IN
 
iwªq
 *
wrq
)

6033 
CHAR
 *
this_ch¨
;

6034 
CHAR
 *
vÆue
;

6035 
UCHAR
 
ªgBBP
;

6036 
CHAR
 
msg
[2048];

6037 
CHAR
 
¨g
[255];

6038 
LONG
 
bbpId
;

6039 
LONG
 
bbpVÆue
;

6040 
BOOLEAN
 
bIsPrötAŒBBP
 = 
FALSE
;

6041 
INT
 
Sètus
 = 0;

6043 
	`DBGPRINT
(
RT_DEBUG_INFO
, "==>RTMPIoctlBBP\n");

6045 
	`mem£t
(
msg
, 0x00, 2048);

6046 i‡(
wrq
->
u
.
d©a
.
Àngth
 > 1)

6048 
Sètus
 = 
	`c›y_‰om_u£r
(
¨g
, 
wrq
->
u
.
d©a
.
poöãr
, (wrq->u.d©a.
Àngth
 > 255) ? 255 : wrq->u.data.length);

6049 
	`•rötf
(
msg
, "\n");

6052 
this_ch¨
 = 
¨g
;

6053 
	`DBGPRINT
(
RT_DEBUG_INFO
, "this_ch¨=%s\n", 
this_ch¨
);

6054 i‡(!*
this_ch¨
)

6055 
√xt
;

6057 i‡((
vÆue
 = 
	`π°rchr
(
this_ch¨
, '=')Ë!
NULL
)

6058 *
vÆue
++ = 0;

6060 i‡(!
vÆue
 || !*value)

6062 
	`DBGPRINT
(
RT_DEBUG_INFO
, "this_ch¨=%s, vÆue=%s\n", 
this_ch¨
, 
vÆue
);

6063 i‡(
	`ssˇnf
(
this_ch¨
, "%d", &(
bbpId
)) == 1)

6065 i‡(
bbpId
 <= 108)

6067 
	`RTUSBRódBBPRegi°î
(
pAd≠ãr
, 
bbpId
, &
ªgBBP
);

6068 
	`•rötf
(
msg
+
	`°æí
(msg), "R%02d[0x%02X]:%02X ", 
bbpId
, bbpId*2, 
ªgBBP
);

6069 
	`DBGPRINT
(
RT_DEBUG_INFO
, "msg=%s\n", 
msg
);

6073 
bIsPrötAŒBBP
 = 
TRUE
;

6074 
√xt
;

6079 
bIsPrötAŒBBP
 = 
TRUE
;

6080 
√xt
;

6085 
	`DBGPRINT
(
RT_DEBUG_INFO
, "this_ch¨=%s, vÆue=%s\n", 
this_ch¨
, 
vÆue
);

6086 i‡((
	`ssˇnf
(
this_ch¨
, "%d", &(
bbpId
)Ë=1Ë&& (ssˇnf(
vÆue
, "%x", &(
bbpVÆue
)) == 1))

6088 
	`DBGPRINT
(
RT_DEBUG_INFO
, "bbpID=%02d, vÆue=0x%x\n", 
bbpId
, 
bbpVÆue
);

6089 i‡(
bbpId
 <= 108)

6091 
	`RTUSBWrôeBBPRegi°î
(
pAd≠ãr
, (
UCHAR
)
bbpId
,(UCHARË
bbpVÆue
);

6093 
	`RTUSBRódBBPRegi°î
(
pAd≠ãr
, 
bbpId
, &
ªgBBP
);

6094 
	`•rötf
(
msg
+
	`°æí
(msg), "R%02d[0x%02X]:%02X\n", 
bbpId
, bbpId*2, 
ªgBBP
);

6095 
	`DBGPRINT
(
RT_DEBUG_INFO
, "msg=%s\n", 
msg
);

6099 
bIsPrötAŒBBP
 = 
TRUE
;

6100 
√xt
;

6105 
bIsPrötAŒBBP
 = 
TRUE
;

6106 
√xt
;

6111 
bIsPrötAŒBBP
 = 
TRUE
;

6113 
√xt
:

6114 i‡(
bIsPrötAŒBBP
)

6116 
	`mem£t
(
msg
, 0x00, 2048);

6117 
	`•rötf
(
msg
, "\n");

6118 
bbpId
 = 0; bbpId <= 108; bbpId++)

6120 
	`RTUSBRódBBPRegi°î
(
pAd≠ãr
, 
bbpId
, &
ªgBBP
);

6121 
	`•rötf
(
msg
+
	`°æí
(msg), "R%02d[0x%02X]:%02X ", 
bbpId
, bbpId*2, 
ªgBBP
);

6122 i‡(
bbpId
%5 == 4)

6123 
	`•rötf
(
msg
+
	`°æí
(msg), "\n");

6126 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "°æí(msg)=%d\n", 
	`°æí
(
msg
));

6127 
wrq
->
u
.
d©a
.
Àngth
 = 
	`°æí
(
msg
);

6128 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, 
msg
, wrq->u.d©a.
Àngth
);

6132 
	`DBGPRINT
(
RT_DEBUG_INFO
, "c›yÅÿu£∏[msg=%s]\n", 
msg
);

6134 
	`DBGPRINT
(
RT_DEBUG_INFO
, "°æí(msgË=%d\n", 
	`°æí
(
msg
));

6135 
wrq
->
u
.
d©a
.
Àngth
 = 
	`°æí
(
msg
);

6136 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, 
msg
, wrq->u.d©a.
Àngth
);

6138 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<==RTMPIoctlBBP\n\n");

6139 
	}
}

6158 
VOID
 
	$RTMPIo˘lMAC
(

6159 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

6160 
IN
 
iwªq
 *
wrq
)

6162 
CHAR
 *
this_ch¨
;

6163 
CHAR
 *
vÆue
;

6164 
INT
 
j
 = 0, 
k
 = 0;

6165 
CHAR
 
msg
[1024];

6166 
CHAR
 
¨g
[255];

6167 
ULONG
 
macAddr
 = 0;

6168 
UCHAR
 
ãmp
[16], 
ãmp2
[16];

6169 
ULONG
 
macVÆue
;

6170 
INT
 
Sètus
 = 0;

6172 
	`DBGPRINT
(
RT_DEBUG_INFO
, "==>RTMPIoctlMAC\n");

6173 
	`mem£t
(
msg
, 0x00, 1024);

6174 i‡(
wrq
->
u
.
d©a
.
Àngth
 > 1)

6176 
Sètus
 = 
	`c›y_‰om_u£r
(
¨g
, 
wrq
->
u
.
d©a
.
poöãr
, (wrq->u.d©a.
Àngth
 > 255) ? 255 : wrq->u.data.length);

6177 
	`•rötf
(
msg
, "\n");

6180 
this_ch¨
 = 
¨g
;

6181 
	`DBGPRINT
(
RT_DEBUG_INFO
, "this_ch¨=%s\n", 
this_ch¨
);

6182 i‡(!*
this_ch¨
)

6183 
√xt
;

6185 i‡((
vÆue
 = 
	`π°rchr
(
this_ch¨
, '=')Ë!
NULL
)

6186 *
vÆue
++ = 0;

6188 i‡(!
vÆue
 || !*value)

6190 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Ród:Åhis_ch¨=%s, såÀn=%d\n", 
this_ch¨
, 
	`°æí
(this_char));

6193 if(
	`°æí
(
this_ch¨
) > 4)

6194 
√xt
;

6196 
j
 = 
	`°æí
(
this_ch¨
);

6197 
j
-- > 0)

6199 if(
this_ch¨
[
j
] > 'f' ||Åhis_char[j] < '0')

6204 
k
 = 
j
 = 
	`°æí
(
this_ch¨
);

6205 
j
-- > 0)

6207 
this_ch¨
[4-
k
+
j
] =Åhis_char[j];

6210 
k
 < 4)

6211 
this_ch¨
[3-
k
++]='0';

6212 
this_ch¨
[4]='\0';

6214 if(
	`°æí
(
this_ch¨
) == 4)

6216 
	`AtoH
(
this_ch¨
, 
ãmp
, 4);

6217 
macAddr
 = *
ãmp
*256 +Åemp[1];

6218 i‡(
macAddr
 < 0xFFFF)

6220 
	`RTUSBRódMACRegi°î
(
pAd≠ãr
, 
macAddr
, &
macVÆue
);

6221 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MacAddr=%x, MacVÆue=%x\n", 
macAddr
, 
macVÆue
);

6222 
	`•rötf
(
msg
+
	`°æí
(msg), "[0x%08X]:%08X ", 
macAddr
 , 
macVÆue
);

6223 
	`DBGPRINT
(
RT_DEBUG_INFO
, "msg=%s\n", 
msg
);

6227 
√xt
;

6233 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Wrôe:Åhis_ch¨=%s, såÀn(vÆue)=%d, vÆue=%s\n", 
this_ch¨
, 
	`°æí
(
vÆue
), value);

6234 
	`mem˝y
(&
ãmp2
, 
vÆue
, 
	`°æí
(value));

6235 
ãmp2
[
	`°æí
(
vÆue
)] = '\0';

6238 if((
	`°æí
(
this_ch¨
Ë> 4Ë|| såÀn(
ãmp2
) > 8)

6239 
√xt
;

6241 
j
 = 
	`°æí
(
this_ch¨
);

6242 
j
-- > 0)

6244 if(
this_ch¨
[
j
] > 'f' ||Åhis_char[j] < '0')

6248 
j
 = 
	`°æí
(
ãmp2
);

6249 
j
-- > 0)

6251 if(
ãmp2
[
j
] > 'f' ||Åemp2[j] < '0')

6256 
k
 = 
j
 = 
	`°æí
(
this_ch¨
);

6257 
j
-- > 0)

6259 
this_ch¨
[4-
k
+
j
] =Åhis_char[j];

6262 
k
 < 4)

6263 
this_ch¨
[3-
k
++]='0';

6264 
this_ch¨
[4]='\0';

6267 
k
 = 
j
 = 
	`°æí
(
ãmp2
);

6268 
j
-- > 0)

6270 
ãmp2
[8-
k
+
j
] =Åemp2[j];

6273 
k
 < 8)

6274 
ãmp2
[7-
k
++]='0';

6275 
ãmp2
[8]='\0';

6278 
	`AtoH
(
this_ch¨
, 
ãmp
, 4);

6279 
macAddr
 = *
ãmp
*256 +Åemp[1];

6281 
	`AtoH
(
ãmp2
, 
ãmp
, 8);

6282 
macVÆue
 = *
ãmp
*256*256*256 +Åemp[1]*256*256 +Åemp[2]*256 +Åemp[3];

6285 i‡(
macAddr
 =(
HW_DEBUG_SETTING_BASE
 + 4))

6288 i‡(
macVÆue
 & 0x000000ff)

6290 
pAd≠ãr
->
BbpTunög
.
bE«bÀ
 = 
TRUE
;

6291 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"turn on R17Åuning\n");

6295 
UCHAR
 
R17
;

6296 
pAd≠ãr
->
BbpTunög
.
bE«bÀ
 = 
FALSE
;

6297 i‡(
pAd≠ãr
->
P‹tCfg
.
Ch™√l
 > 14)

6298 
R17
 = 
pAd≠ãr
->
BbpTunög
.
R17LowîBoundA
;

6300 
R17
 = 
pAd≠ãr
->
BbpTunög
.
R17LowîBoundG
;

6301 
	`RTUSBWrôeBBPRegi°î
(
pAd≠ãr
, 17, 
R17
);

6302 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"tu∫ of‡R17Åunög,Ñe°‹êtÿ0x%02x\n", 
R17
);

6307 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MacAddr=%02x, MacVÆue=0x%x\n", 
macAddr
, 
macVÆue
);

6309 
	`RTUSBWrôeMACRegi°î
(
pAd≠ãr
, 
macAddr
, 
macVÆue
);

6310 
	`•rötf
(
msg
+
	`°æí
(msg), "[0x%08X]:%08X ", 
macAddr
, 
macVÆue
);

6311 
	`DBGPRINT
(
RT_DEBUG_INFO
, "msg=%s\n", 
msg
);

6315 
√xt
:

6316 if(
	`°æí
(
msg
) == 1)

6317 
	`•rötf
(
msg
+
	`°æí
(msg), "===>Error command format!");

6318 
	`DBGPRINT
(
RT_DEBUG_INFO
, "c›yÅÿu£∏[msg=%s]\n", 
msg
);

6320 
	`DBGPRINT
(
RT_DEBUG_INFO
, "°æí(msgË=%d\n", 
	`°æí
(
msg
));

6321 
wrq
->
u
.
d©a
.
Àngth
 = 
	`°æí
(
msg
);

6322 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, 
msg
, wrq->u.d©a.
Àngth
);

6324 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<==RTMPIoctlMAC\n\n");

6325 
	}
}

6327 #ifde‡
RALINK_ATE


6345 
VOID
 
	$RTMPIo˘lE2PROM
(

6346 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

6347 
IN
 
iwªq
 *
wrq
)

6349 
CHAR
 *
this_ch¨
;

6350 
CHAR
 *
vÆue
;

6351 
INT
 
j
 = 0, 
k
 = 0;

6352 
CHAR
 
msg
[1024];

6353 
CHAR
 
¨g
[255];

6354 
USHORT
 
ìpAddr
 = 0;

6355 
UCHAR
 
ãmp
[16], 
ãmp2
[16];

6356 
USHORT
 
ìpVÆue
;

6357 
Sètus
;

6359 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==>RTMPIoctlE2PROM\n");

6360 
	`mem£t
(
msg
, 0x00, 1024);

6361 i‡(
wrq
->
u
.
d©a
.
Àngth
 > 1)

6363 
Sètus
 = 
	`c›y_‰om_u£r
(
¨g
, 
wrq
->
u
.
d©a
.
poöãr
, (wrq->u.d©a.
Àngth
 > 255) ? 255 : wrq->u.data.length);

6364 
	`•rötf
(
msg
, "\n");

6367 
this_ch¨
 = 
¨g
;

6368 
	`DBGPRINT
(
RT_DEBUG_INFO
, "this_ch¨=%s\n", 
this_ch¨
);

6371 i‡(!*
this_ch¨
)

6372 
√xt
;

6374 i‡((
vÆue
 = 
	`π°rchr
(
this_ch¨
, '=')Ë!
NULL
)

6375 *
vÆue
++ = 0;

6377 i‡(!
vÆue
 || !*value)

6379 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Ród:Åhis_ch¨=%s, såÀn=%d\n", 
this_ch¨
, 
	`°æí
(this_char));

6382 if(
	`°æí
(
this_ch¨
) > 4)

6383 
√xt
;

6385 
j
 = 
	`°æí
(
this_ch¨
);

6386 
j
-- > 0)

6388 if(
this_ch¨
[
j
] > 'f' ||Åhis_char[j] < '0')

6393 
k
 = 
j
 = 
	`°æí
(
this_ch¨
);

6394 
j
-- > 0)

6396 
this_ch¨
[4-
k
+
j
] =Åhis_char[j];

6399 
k
 < 4)

6400 
this_ch¨
[3-
k
++]='0';

6401 
this_ch¨
[4]='\0';

6403 if(
	`°æí
(
this_ch¨
) == 4)

6405 
	`AtoH
(
this_ch¨
, 
ãmp
, 4);

6406 
ìpAddr
 = *
ãmp
*256 +Åemp[1];

6407 i‡(
ìpAddr
 < 0xFFFF)

6409 
	`RTUSBRódEEPROM
(
pAd≠ãr
, 
ìpAddr
, (
PUCHAR
)&
ìpVÆue
, 2);

6410 
	`DBGPRINT
(
RT_DEBUG_INFO
, "ìpAddr=%x,ÉïVÆue=0x%x\n", 
ìpAddr
, 
ìpVÆue
);

6411 
	`•rötf
(
msg
+
	`°æí
(msg), "[0x%04X]:0x%02X ", 
ìpAddr
 , 
ìpVÆue
);

6412 
	`DBGPRINT
(
RT_DEBUG_INFO
, "msg=%s\n", 
msg
);

6416 
√xt
;

6422 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Wrôe:Åhis_ch¨=%s, såÀn(vÆue)=%d, vÆue=%s\n", 
this_ch¨
, 
	`°æí
(
vÆue
), value);

6423 
	`mem˝y
(&
ãmp2
, 
vÆue
, 
	`°æí
(value));

6424 
ãmp2
[
	`°æí
(
vÆue
)] = '\0';

6427 if((
	`°æí
(
this_ch¨
Ë> 4Ë|| såÀn(
ãmp2
) > 8)

6428 
√xt
;

6430 
j
 = 
	`°æí
(
this_ch¨
);

6431 
j
-- > 0)

6433 if(
this_ch¨
[
j
] > 'f' ||Åhis_char[j] < '0')

6436 
j
 = 
	`°æí
(
ãmp2
);

6437 
j
-- > 0)

6439 if(
ãmp2
[
j
] > 'f' ||Åemp2[j] < '0')

6444 
k
 = 
j
 = 
	`°æí
(
this_ch¨
);

6445 
j
-- > 0)

6447 
this_ch¨
[4-
k
+
j
] =Åhis_char[j];

6450 
k
 < 4)

6451 
this_ch¨
[3-
k
++]='0';

6452 
this_ch¨
[4]='\0';

6455 
k
 = 
j
 = 
	`°æí
(
ãmp2
);

6456 
j
-- > 0)

6458 
ãmp2
[4-
k
+
j
] =Åemp2[j];

6461 
k
 < 4)

6462 
ãmp2
[3-
k
++]='0';

6463 
ãmp2
[4]='\0';

6465 
	`AtoH
(
this_ch¨
, 
ãmp
, 4);

6466 
ìpAddr
 = *
ãmp
*256 +Åemp[1];

6468 
	`AtoH
(
ãmp2
, 
ãmp
, 4);

6469 
ìpVÆue
 = *
ãmp
*256 +Åemp[1];

6471 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ìpAddr=%02x,ÉïVÆue=0x%x\n", 
ìpAddr
, 
ìpVÆue
);

6473 
	`RTUSBWrôeEEPROM
(
pAd≠ãr
, 
ìpAddr
, (
PUCHAR
)&
ìpVÆue
, (eepValue));

6474 
	`•rötf
(
msg
+
	`°æí
(msg), "[0x%02X]:%02X ", 
ìpAddr
, 
ìpVÆue
);

6475 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "msg=%s\n", 
msg
);

6478 
√xt
:

6479 if(
	`°æí
(
msg
) == 1)

6480 
	`•rötf
(
msg
+
	`°æí
(msg), "===>Error command format!");

6483 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "c›yÅÿu£∏[msg=%s], msg_Àngth=%d\n", 
msg
, 
	`°æí
(msg));

6484 
wrq
->
u
.
d©a
.
Àngth
 = 
	`°æí
(
msg
);

6485 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, 
msg
, wrq->u.d©a.
Àngth
);

6487 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<==RTMPIoctlE2PROM\n");

6488 
	}
}

6509 
VOID
 
	$RTMPIo˘lSèti°ics
(

6510 
IN
 
PRTMP_ADAPTER
 
pAd
,

6511 
IN
 
iwªq
 *
wrq
)

6513 
msg
[1600];

6514 
INT
 
Sètus
=0;

6516 
	`mem£t
(
msg
, 0x00, 1600);

6517 
	`•rötf
(
msg
, "\n");

6519 
	`•rötf
(
msg
+
	`°æí
(msg), "Tx suc˚ss = %d\n", (
ULONG
)
pAd
->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
QuadP¨t
);

6520 
	`•rötf
(
msg
+
	`°æí
(msg), "Tx suc˚s†wôhouàªåy = %d\n", (
ULONG
)
pAd
->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
QuadP¨t
 - (ULONGÌAd->WœnCou¡îs.
RëryCou¡
.QuadPart);

6521 
	`•rötf
(
msg
+
	`°æí
(msg), "Tx suc˚s†a·îÑëry = %d\n", (
ULONG
)
pAd
->
WœnCou¡îs
.
RëryCou¡
.
QuadP¨t
);

6522 
	`•rötf
(
msg
+
	`°æí
(msg), "Tx faûÅÿRcv ACKá·îÑëry = %d\n", (
ULONG
)
pAd
->
WœnCou¡îs
.
FaûedCou¡
.
QuadP¨t
);

6523 
	`•rötf
(
msg
+
	`°æí
(msg), "RTS Suc˚s†Rcv CTS = %d\n", (
ULONG
)
pAd
->
WœnCou¡îs
.
RTSSuc˚ssCou¡
.
QuadP¨t
);

6524 
	`•rötf
(
msg
+
	`°æí
(msg), "RTS Faû Rcv CTS = %d\n", (
ULONG
)
pAd
->
WœnCou¡îs
.
RTSFaûuªCou¡
.
QuadP¨t
);

6526 
	`•rötf
(
msg
+
	`°æí
(msg), "Rx suc˚ss = %d\n", (
ULONG
)
pAd
->
WœnCou¡îs
.
Re˚ivedFøgmítCou¡
.
QuadP¨t
);

6527 
	`•rötf
(
msg
+
	`°æí
(msg), "Rx wôh CRC = %d\n", (
ULONG
)
pAd
->
WœnCou¡îs
.
FCSEº‹Cou¡
.
QuadP¨t
);

6528 
	`•rötf
(
msg
+
	`°æí
(msg), "Rx dr› duêtÿouào‡ªsour˚ = %d\n", (
ULONG
)
pAd
->
Cou¡îs8023
.
RxNoBuf„r
);

6529 
	`•rötf
(
msg
+
	`°æí
(msg), "Rx du∂iˇã føme = %d\n", (
ULONG
)
pAd
->
WœnCou¡îs
.
FømeDu∂iˇãCou¡
.
QuadP¨t
);

6531 
	`•rötf
(
msg
+
	`°æí
(msg), "FÆ£ CCA (⁄ê£c⁄d) = %d\n", (
ULONG
)
pAd
->
RÆökCou¡îs
.
O√SecFÆ£CCAC¡
);

6532 
	`•rötf
(
msg
+
	`°æí
(msg), "RSSI-A = %d\n", (
LONG
)(
pAd
->
P‹tCfg
.
La°Rssi
 -ÖAd->
BbpRssiToDbmDñè
));

6533 
	`•rötf
(
msg
+
	`°æí
(msg), "RSSI-B (i‡avaûabÀË = %d\n\n", (
LONG
)(
pAd
->
P‹tCfg
.
La°Rssi2
 -ÖAd->
BbpRssiToDbmDñè
));

6536 
	`DBGPRINT
(
RT_DEBUG_INFO
, "c›yÅÿu£∏[msg=%s]\n", 
msg
);

6537 
wrq
->
u
.
d©a
.
Àngth
 = 
	`°æí
(
msg
);

6538 
Sètus
 = 
	`c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, 
msg
, wrq->u.d©a.
Àngth
);

6540 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<==RTMPIoctlStatistics\n");

6541 
	}
}

6557 
CHAR
 *
	$GëEn¸y±Ty≥
(
CHAR
 
íc
, CHAR 
ícBôMode
)

6560 i‡(
ícBôMode
 =(
TKIPBIT
 | 
CCMPBIT
))

6563 if(
íc
 =
Ndis802_11WEPDißbÀd
)

6565 if(
íc
 =
Ndis802_11WEPE«bÀd
)

6567 if(
íc
 =
Ndis802_11En¸y±i⁄2E«bÀd
)

6569 if(
íc
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

6573 
	}
}

6575 
CHAR
 *
	$GëAuthMode
(
CHAR
 
auth
, CHAR 
authBôMode
)

6578 i‡(
authBôMode
 =(
WPA1PSKAKMBIT
 | 
WPA2PSKAKMBIT
))

6580 i‡(
authBôMode
 =(
WPA1AKMBIT
 | 
WPA2AKMBIT
))

6584 i‡(
authBôMode
 =(
WPA1AKMBIT
 | 
WPA1PSKAKMBIT
))

6586 i‡(
authBôMode
 =(
WPA2AKMBIT
 | 
WPA2PSKAKMBIT
))

6588 i‡(
authBôMode
 =(
WPA1AKMBIT
 | 
WPA1PSKAKMBIT
 | 
WPA2AKMBIT
 | 
WPA2PSKAKMBIT
))

6592 if(
auth
 =
Ndis802_11AuthModeO≥n
)

6594 if(
auth
 =
Ndis802_11AuthModeSh¨ed
)

6596 if(
auth
 =
Ndis802_11AuthModeWPA
)

6598 if(
auth
 =
Ndis802_11AuthModeWPAPSK
)

6600 if(
auth
 =
Ndis802_11AuthModeWPAN⁄e
)

6602 if(
auth
 =
Ndis802_11AuthModeWPA2
)

6604 if(
auth
 =
Ndis802_11AuthModeWPA2PSK
)

6608 
	}
}

6628 
	#LINE_LEN
 (8+8+36+20+12+20+12)

6629 
VOID
 
	`RTMPIo˘lGëSôeSurvey
(

	)

6630 
IN
 
PRTMP_ADAPTER
 
	gpAd≠ãr
,

6631 
IN
 
iwªq
 *
	gwrq
)

6633 
CHAR
 *
	gmsg
;

6634 
INT
 
	gi
=0;

6635 
INT
 
	gSètus
=0;

6636 
CHAR
 
	gSsid
[
MAX_LEN_OF_SSID
 +1];

6638 
	gmsg
 = (
CHAR
 *Ë
kmÆloc
((CHAR)*((
MAX_LEN_OF_BSS_TABLE
)*
LINE_LEN
), 
MEM_ALLOC_FLAG
);

6640 i‡(
	gmsg
 =
NULL
)

6645 
mem£t
(
msg
, 0 ,(
MAX_LEN_OF_BSS_TABLE
)*
LINE_LEN
 );

6646 
mem£t
(
Ssid
, 0 ,(
MAX_LEN_OF_SSID
+1) );

6648 
•rötf
(
msg
,"%s","\n");

6649 
•rötf
(
msg
+
°æí
(msg),"%-8s%-8s%-36s%-20s%-12s%-20s%-12s\n",

6651 
	gi
=0;i<
	gMAX_LEN_OF_BSS_TABLE
;i++)

6653 if–
	gpAd≠ãr
->
	gSˇnTab
.
	gBssE¡ry
[
i
].
	gCh™√l
==0)

6656 if((
°æí
(
msg
)+
	gLINE_LEN
 ) >((
MAX_LEN_OF_BSS_TABLE
)*
LINE_LEN
) )

6659 if((
°æí
(
msg
)+
	gLINE_LEN
 ) >
IW_SCAN_MAX_DATA
)

6662 
•rötf
(
msg
+
°æí
(msg),"%-8d", 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
Ch™√l
);

6663 
•rötf
(
msg
+
°æí
(msg),"%-8d", 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
Rssi
 -ÖAd≠ãr->
BbpRssiToDbmDñè
);

6665 
mem˝y
(
Ssid
, 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].Ssid,ÖAd≠ãr->SˇnTab.BssE¡ry[i].
SsidLí
);

6666 
	gSsid
[
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
	gSsidLí
] = '\0';

6667 
•rötf
(
msg
+
°æí
(msg),"%-36s", 
Ssid
);

6669 
•rötf
(
msg
+
°æí
(msg),"%02x:%02x:%02x:%02x:%02x:%02x ",

6670 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
Bssid
[0],

6671 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
Bssid
[1],

6672 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
Bssid
[2],

6673 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
Bssid
[3],

6674 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
Bssid
[4],

6675 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
Bssid
[5]);

6676 
•rötf
(
msg
+
°æí
(msg),"%-12s",
GëEn¸y±Ty≥
(
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
WïSètus
,

6677 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
PaúCùhîBôMode
));

6678 
•rötf
(
msg
+
°æí
(msg),"%-20s",
GëAuthMode
(
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
AuthMode
,

6679 
pAd≠ãr
->
SˇnTab
.
BssE¡ry
[
i
].
AuthBôMode
));

6680 i‡(
	gpAd≠ãr
->
	gSˇnTab
.
	gBssE¡ry
[
i
].
	gBssTy≥
 =
BSS_ADHOC
)

6681 
•rötf
(
msg
+
°æí
(msg),"%-12s\n", "Adhoc");

6683 
•rötf
(
msg
+
°æí
(msg),"%-12s\n", "Infra");

6686 
	gwrq
->
	gu
.
	gd©a
.
	gÀngth
 = 
°æí
(
msg
);

6687 
	gSètus
 = 
c›y_to_u£r
(
wrq
->
u
.
d©a
.
poöãr
, 
msg
, wrq->u.d©a.
Àngth
);

6688 
k‰ì
(
msg
);

6691 
VOID
 
	$RTMPMakeRSNIE
(

6692 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

6693 
IN
 
UCHAR
 
GroupCùhî
)

6696 i‡(
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2PSK
)

6698 
	`NdisMoveMem‹y
(
pAd≠ãr
->
P‹tCfg
.
RSN_IE
, 
CùhîW∑2Tem∂©e
, 
CùhîW∑2Tem∂©eLí
);

6700 
pAd≠ãr
->
P‹tCfg
.
RSN_IE
[7] = ((
GroupCùhî
 =
Ndis802_11En¸y±i⁄2E«bÀd
) ? 0x2 : 0x4);

6702 
pAd≠ãr
->
P‹tCfg
.
RSN_IE
[13] = (’Ad≠ãr->P‹tCfg.
PaúCùhî
 =
Ndis802_11En¸y±i⁄2E«bÀd
) ? 0x2 : 0x4);

6704 
pAd≠ãr
->
P‹tCfg
.
RSN_IE
[19] = (’Ad≠ãr->P‹tCfg.
AuthMode
 =
Ndis802_11AuthModeWPA2
) ? 0x1 : 0x2);

6706 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"WPA2PSK GroupC=%d, PaúC=%d\n",
pAd≠ãr
->
P‹tCfg
.
GroupCùhî
 ,

6707 
pAd≠ãr
->
P‹tCfg
.
PaúCùhî
);

6709 
pAd≠ãr
->
P‹tCfg
.
RSN_IELí
 = 
CùhîW∑2Tem∂©eLí
;

6711 i‡(
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAPSK
)

6713 
	`NdisMoveMem‹y
(
pAd≠ãr
->
P‹tCfg
.
RSN_IE
, 
CùhîW∑PskTkù
, 
CùhîW∑PskTkùLí
);

6715 
pAd≠ãr
->
P‹tCfg
.
RSN_IE
[11] = ((
GroupCùhî
 =
Ndis802_11En¸y±i⁄2E«bÀd
) ? 0x2 : 0x4);

6717 
pAd≠ãr
->
P‹tCfg
.
RSN_IE
[17] = (’Ad≠ãr->P‹tCfg.
PaúCùhî
 =
Ndis802_11En¸y±i⁄2E«bÀd
) ? 0x2 : 0x4);

6719 
pAd≠ãr
->
P‹tCfg
.
RSN_IE
[23] = (’Ad≠ãr->P‹tCfg.
AuthMode
 =
Ndis802_11AuthModeWPA
) ? 0x1 : 0x2);

6721 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"WPAPSK GroupC = %d, PaúC=%d , \¿",
pAd≠ãr
->
P‹tCfg
.
GroupCùhî
 ,

6722 
pAd≠ãr
->
P‹tCfg
.
PaúCùhî
);

6724 
pAd≠ãr
->
P‹tCfg
.
RSN_IELí
 = 
CùhîW∑PskTkùLí
;

6729 
pAd≠ãr
->
P‹tCfg
.
RSN_IELí
 = 0;

6731 
	}
}

6733 
NDIS_STATUS
 
	$RTMPWPAN⁄eAddKeyProc
(

6734 
IN
 
PRTMP_ADAPTER
 
pAd
,

6735 
IN
 
PVOID
 
pBuf
)

6737 
PNDIS_802_11_KEY
 
pKey
;

6738 
ULONG
 
KeyLí
;

6739 
ULONG
 
BufLí
;

6740 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

6741 
i
;

6743 
KeyLí
 = 32;

6744 
BufLí
 = (
NDIS_802_11_KEY
Ë+ 
KeyLí
 - 1;

6746 
pKey
 = 
	`kmÆloc
(
BufLí
, 
MEM_ALLOC_FLAG
);

6747 i‡(
pKey
 =
NULL
)

6749 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RTMPWPANoneAddKeyProc()állocate memory failed \n");

6750 
Sètus
 = 
NDIS_STATUS_FAILURE
;

6751  
Sètus
;

6754 
	`NdisZîoMem‹y
(
pKey
, 
BufLí
);

6755 
pKey
->
Lígth
 = 
BufLí
;

6756 
pKey
->
KeyIndex
 = 0x80000000;

6757 
pKey
->
KeyLígth
 = 
KeyLí
;

6758 
i
=0; i<6; i++)

6759 
pKey
->
BSSID
[
i
] = 0xff;

6761 
	`NdisMoveMem‹y
(
pKey
->
KeyM©îül
, 
pBuf
, 32);

6762 
	`RTMPWPAAddKeyProc
(
pAd
, 
pKey
);

6763 
	`k‰ì
(
pKey
);

6765  
Sètus
;

6766 
	}
}

6768 #ifde‡
RALINK_ATE


6769 
UCHAR
 
	gTem∂©eFøme
[24] = {0x08,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0xAA,0xBB,0x12,0x34,0x56,0x00,0x11,0x22,0xAA,0xBB,0xCC,0x00,0x00};

6785 #ifde‡
BIG_ENDIAN


6786 
ölöe
 
INT
 
£t_©e_¥oc_ölöe
(

6788 
INT
 
Së_ATE_Proc
(

6790 
IN
 
PRTMP_ADAPTER
 
pAd
,

6791 
IN
 
PUCHAR
 
¨g
)

6794 
UCHAR
 
BbpD©a
;

6795 
ULONG
 
MacD©a
;

6796 
UINT
 
i
=0, 
©emode
;

6797 
ULONG
 
ãmp
;

6798 
IrqFœgs
;

6800 
¥ötk
("===>Set_ATE_Proc\n");

6801 
RTUSBRódBBPRegi°î
(
pAd
, 63, &
BbpD©a
);

6802 
RTUSBRódMACRegi°î
(
pAd
, 
PHY_CSR1
, &
MacD©a
);

6804 
BbpD©a
 = 0;

6805 
MacD©a
 &= 0xFFFFFFFE;

6807 i‡(!
°rcmp
(
¨g
, "STASTOP"))

6809 
DBGPRINT
(
RT_DEBUG_TRACE
, "ATE: STASTOP\n");

6811 
©emode
 = 
pAd
->
©e
.
Mode
;

6812 
pAd
->
©e
.
Mode
 = 
ATE_STASTOP
;

6813 
pAd
->
©e
.
TxD⁄eCou¡
 =ÖAd->©e.
TxCou¡
;

6815 
RTUSBReje˘PídögPackës
(
pAd
);

6816 
RTUSBCÀ™UpD©aBulkOutQueue
(
pAd
);

6818 
MlmeSu•íd
(
pAd
, 
TRUE
);

6819 
RTMPC™˚lTimî
(&
pAd
->
Mlme
.
PîiodicTimî
);

6821 ((
©omic_ªad
(&
pAd
->
PídögRx
) > 0) ||

6822 (
pAd
->
BulkOutPídög
[0] =
TRUE
) ||

6823 (
pAd
->
BulkOutPídög
[1] =
TRUE
) ||

6824 (
pAd
->
BulkOutPídög
[2] =
TRUE
) ||

6825 (
pAd
->
BulkOutPídög
[3] =
TRUE
)Ë&& (pAd->
BulkFœgs
 != 0))

6827 i‡(
©omic_ªad
(&
pAd
->
PídögRx
) > 0)

6829 
DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "BulkIn IRP Pending!!!\n");

6830 
RTUSB_Víd‹Reque°
(
pAd
,

6832 
DEVICE_VENDOR_REQUEST_OUT
,

6836 
NULL
,

6840 i‡((
pAd
->
BulkOutPídög
[0] =
TRUE
) ||

6841 (
pAd
->
BulkOutPídög
[1] =
TRUE
) ||

6842 (
pAd
->
BulkOutPídög
[2] =
TRUE
) ||

6843 (
pAd
->
BulkOutPídög
[3] =
TRUE
))

6845 
DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "BulkOut IRP Pending!!!\n");

6846 i‡(
i
 == 0)

6848 
RTUSBC™˚lPídögBulkOutIRP
(
pAd
);

6849 
i
++;

6853 
RTMPu£cDñay
(500000);

6856 
LökDown
(
pAd
, 
FALSE
);

6857 
AsicE«bÀBssSync
(
pAd
);

6859 
√tif_°›_queue
(
pAd
->
√t_dev
);

6860 
RTMPSèti⁄St›
(
pAd
);

6861 
RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0257b032);

6864 
RTUSBRódMACRegi°î
(
pAd
, 
TXRX_CSR4
, &
ãmp
);

6865 
ãmp
 =Åemp & 0xFFFDFFFF;

6866 
RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR4
, 
ãmp
);

6868 
RTUSBWrôeBBPRegi°î
(
pAd
, 63, 
BbpD©a
);

6869 
RTUSBWrôeMACRegi°î
(
pAd
, 
PHY_CSR1
, 
MacD©a
);

6872 
©omic_£t
(&
pAd
->
BulkOutRemaöed
, 0);

6873 
NdisAcquúeSpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

6874 
pAd
->
C⁄töBulkOut
 = 
FALSE
;

6875 
pAd
->
C⁄töBulkIn
 = 
FALSE
;

6876 
NdisRñó£SpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

6877 
RTUSB_CLEAR_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_ATE
);

6881 i‡(!
°rcmp
(
¨g
, "STASTART"))

6883 
DBGPRINT
(
RT_DEBUG_TRACE
, "ATE: STASTART\n");

6884 
pAd
->
©e
.
Mode
 = 
ATE_STASTART
;

6887 (
©omic_ªad
(&
pAd
->
PídögRx
) > 0) ||

6888 (
pAd
->
BulkOutPídög
[0] =
TRUE
) ||

6889 (
pAd
->
BulkOutPídög
[1] =
TRUE
) ||

6890 (
pAd
->
BulkOutPídög
[2] =
TRUE
) ||

6891 (
pAd
->
BulkOutPídög
[3] =
TRUE
))

6893 i‡(
©omic_ªad
(&
pAd
->
PídögRx
) > 0)

6895 
DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "BulkIn IRP Pending!!!\n");

6896 
RTUSB_Víd‹Reque°
(
pAd
,

6898 
DEVICE_VENDOR_REQUEST_OUT
,

6902 
NULL
,

6906 i‡((
pAd
->
BulkOutPídög
[0] =
TRUE
) ||

6907 (
pAd
->
BulkOutPídög
[1] =
TRUE
) ||

6908 (
pAd
->
BulkOutPídög
[2] =
TRUE
) ||

6909 (
pAd
->
BulkOutPídög
[3] =
TRUE
))

6911 
DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "BulkOut IRP Pending!!!\n");

6912 i‡(
i
 == 0)

6914 
RTUSBC™˚lPídögBulkOutIRP
(
pAd
);

6915 
i
++;

6919 
RTMPu£cDñay
(500000);

6923 
RTUSBRódMACRegi°î
(
pAd
, 
TXRX_CSR4
, &
ãmp
);

6924 
ãmp
 =Åemp | 0x20000;

6925 
RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR4
, 
ãmp
);

6928 
MlmeResume
(
pAd
);

6929 
RTMPSëTimî
(
pAd
, &pAd->
Mlme
.
PîiodicTimî
, 
MLME_TASK_EXEC_INTV
);

6930 
RTUSBBulkRe˚ive
(
pAd
);

6933 
RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0256b032);

6936 
RTUSBWrôeBBPRegi°î
(
pAd
, 63, 
BbpD©a
);

6937 
RTUSBWrôeMACRegi°î
(
pAd
, 
PHY_CSR1
, 
MacD©a
);

6940 
©omic_£t
(&
pAd
->
BulkOutRemaöed
, 0);

6941 
NdisAcquúeSpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

6942 
pAd
->
C⁄töBulkOut
 = 
FALSE
;

6943 
pAd
->
C⁄töBulkIn
 = 
FALSE
;

6944 
NdisRñó£SpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

6947 i‡(!
°rcmp
(
¨g
, "TXCONT"))

6949 
DBGPRINT
(
RT_DEBUG_TRACE
, "ATE: TXCONT\n");

6951 
pAd
->
©e
.
Mode
 = 
ATE_TXCONT
;

6953 
BbpD©a
 |= 0x80;

6954 
MacD©a
 |= 0x00000001;

6956 
RTUSBWrôeBBPRegi°î
(
pAd
, 63, 
BbpD©a
);

6957 
RTUSBWrôeMACRegi°î
(
pAd
, 
PHY_CSR1
, 
MacD©a
);

6959 
RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0257b032);

6962 
ATEAsicSwôchCh™√l
(
pAd
,ÖAd->
©e
.
Ch™√l
);

6963 
AsicLockCh™√l
(
pAd
,ÖAd->
©e
.
Ch™√l
);

6964 
RTMPu£cDñay
(5000);

6967 
RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR8
, 0x120);

6969 
RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0257b032);

6972 
©omic_£t
(&
pAd
->
BulkOutRemaöed
,ÖAd->
©e
.
TxCou¡
);

6973 
DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "bulk ouàcou¡ = %d\n", 
©omic_ªad
(&
pAd
->
BulkOutRemaöed
));

6974 i‡(
©omic_ªad
(&
pAd
->
BulkOutRemaöed
) == 0)

6976 
NdisAcquúeSpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

6977 
pAd
->
C⁄töBulkOut
 = 
TRUE
;

6978 
NdisRñó£SpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

6982 
NdisAcquúeSpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

6983 
pAd
->
C⁄töBulkOut
 = 
FALSE
;

6984 
NdisRñó£SpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

6987 
ATE_RTMPSídNuŒFøme
(
pAd
);

6988 
RTUSB_SET_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_ATE
);

6991 
RTUSBKickBulkOut
(
pAd
);

6995 i‡(!
°rcmp
(
¨g
, "TXCARR"))

6997 
DBGPRINT
(
RT_DEBUG_TRACE
, "ATE: TXCARR\n");

6998 
pAd
->
©e
.
Mode
 = 
ATE_TXCARR
;

7000 
BbpD©a
 |= 0x40;

7001 
MacD©a
 |= 0x00000001;

7003 
RTUSBWrôeBBPRegi°î
(
pAd
, 63, 
BbpD©a
);

7004 
RTUSBWrôeMACRegi°î
(
pAd
, 
PHY_CSR1
, 
MacD©a
);

7006 
RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0257b032);

7008 
ATEAsicSwôchCh™√l
(
pAd
,ÖAd->
©e
.
Ch™√l
);

7009 
AsicLockCh™√l
(
pAd
,ÖAd->
©e
.
Ch™√l
);

7010 
RTMPu£cDñay
(5000);

7013 
RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR8
, 0x120);

7015 
RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0257b032);

7018 
©omic_£t
(&
pAd
->
BulkOutRemaöed
,ÖAd->
©e
.
TxCou¡
);

7019 
DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "bulk ouàcou¡ = %d\n", 
©omic_ªad
(&
pAd
->
BulkOutRemaöed
));

7020 i‡(
©omic_ªad
(&
pAd
->
BulkOutRemaöed
) == 0)

7022 
NdisAcquúeSpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

7023 
pAd
->
C⁄töBulkOut
 = 
TRUE
;

7024 
NdisRñó£SpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

7028 
NdisAcquúeSpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

7029 
pAd
->
C⁄töBulkOut
 = 
FALSE
;

7030 
NdisRñó£SpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

7033 
ATE_RTMPSídNuŒFøme
(
pAd
);

7034 
RTUSB_SET_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_ATE
);

7037 
RTUSBKickBulkOut
(
pAd
);

7041 i‡(!
°rcmp
(
¨g
, "TXFRAME"))

7043 
DBGPRINT
(
RT_DEBUG_TRACE
, "ATE: TXFRAME(Cou¡=%d)\n", 
pAd
->
©e
.
TxCou¡
);

7044 
pAd
->
©e
.
Mode
 = 
ATE_TXFRAME
;

7046 
RTUSBWrôeBBPRegi°î
(
pAd
, 63, 
BbpD©a
);

7047 
RTUSBWrôeMACRegi°î
(
pAd
, 
PHY_CSR1
, 
MacD©a
);

7049 
ATEAsicSwôchCh™√l
(
pAd
,ÖAd->
©e
.
Ch™√l
);

7050 
AsicLockCh™√l
(
pAd
,ÖAd->
©e
.
Ch™√l
);

7051 
RTMPu£cDñay
(5000);

7054 
RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR8
, 0x120);

7056 
RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0257b032);

7059 
©omic_£t
(&
pAd
->
BulkOutRemaöed
,ÖAd->
©e
.
TxCou¡
);

7060 
DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "bulk ouàcou¡ = %d\n", 
©omic_ªad
(&
pAd
->
BulkOutRemaöed
));

7061 i‡(
©omic_ªad
(&
pAd
->
BulkOutRemaöed
) == 0)

7063 
DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "SendÖacket countinue\n");

7064 
NdisAcquúeSpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

7065 
pAd
->
C⁄töBulkOut
 = 
TRUE
;

7066 
pAd
->
BulkOutPídög
[0] = 
FALSE
;

7067 
NdisRñó£SpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

7071 
DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "SendÖacket depand on counter\n");

7072 
NdisAcquúeSpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

7073 
pAd
->
C⁄töBulkOut
 = 
FALSE
;

7074 
pAd
->
BulkOutPídög
[0] = 
FALSE
;

7075 
NdisRñó£SpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

7078 
ATE_RTMPSídNuŒFøme
(
pAd
);

7079 
RTUSB_SET_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_ATE
);

7082 
RTUSBKickBulkOut
(
pAd
);

7087 i‡(!
°rcmp
(
¨g
, "RXFRAME"))

7089 
ULONG
 
ãmp
;

7090 
DBGPRINT
(
RT_DEBUG_TRACE
, "ATE: RXFRAME\n");

7092 
pAd
->
©e
.
Mode
 = 
ATE_RXFRAME
;

7094 
RTUSBWrôeBBPRegi°î
(
pAd
, 63, 
BbpD©a
);

7095 
RTUSBWrôeMACRegi°î
(
pAd
, 
PHY_CSR1
, 
MacD©a
);

7098 
ATEAsicSwôchCh™√l
(
pAd
,ÖAd->
©e
.
Ch™√l
);

7099 
AsicLockCh™√l
(
pAd
,ÖAd->
©e
.
Ch™√l
);

7100 
RTMPu£cDñay
(5000);

7103 
RTUSBRódMACRegi°î
(
pAd
, 
STA_CSR0
, &
ãmp
);

7104 
RTUSBRódMACRegi°î
(
pAd
, 
STA_CSR1
, &
ãmp
);

7105 
RTUSBRódMACRegi°î
(
pAd
, 
STA_CSR2
, &
ãmp
);

7107 
NdisAcquúeSpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

7108 
pAd
->
C⁄töBulkIn
 = 
TRUE
;

7109 
NdisRñó£SpöLock
(&
pAd
->
GíîicLock
, 
IrqFœgs
);

7112 
RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0256b032);

7115 
RTUSBBulkRe˚ive
(
pAd
);

7120 
DBGPRINT
(
RT_DEBUG_TRACE
, "ATE: Invalidárg!\n");

7121  
FALSE
;

7123 
RTMPu£cDñay
(5000);

7125  
TRUE
;

7128 #ifde‡
BIG_ENDIAN


7129 
INT
 
	$Së_ATE_Proc
(

7130 
IN
 
PRTMP_ADAPTER
 
pAd
,

7131 
IN
 
PUCHAR
 
¨g
)

7134  
	`£t_©e_¥oc_ölöe
(
pAd
, 
¨g
);

7135 
	}
}

7146 
INT
 
	$Së_ATE_DA_Proc
(

7147 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

7148 
IN
 
PUCHAR
 
¨g
)

7150 
CHAR
 *
vÆue
;

7151 
INT
 
i
;

7153 if(
	`°æí
(
¨g
) != 17)

7154  
FALSE
;

7156 
i
=0, 
vÆue
 = 
	`r°πok
(
¨g
,":"); vÆue; vÆuêr°πok(
NULL
,":"))

7158 if((
	`°æí
(
vÆue
Ë!2Ë|| (!
	`isxdigô
(*value)) || (!isxdigit(*(value+1))) )

7159  
FALSE
;

7161 
	`AtoH
(
vÆue
, &
pAd≠ãr
->
©e
.
Addr1
[
i
++], 2);

7164 if(
i
 != 6)

7165  
FALSE
;

7167 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set_ATE_DA_Proc (DA = %2X:%2X:%2X:%2X:%2X:%2X)\n",

7168 
pAd≠ãr
->
©e
.
Addr1
[0],ÖAdapter->ate.Addr1[1],ÖAdapter->ate.Addr1[2],

7169 
pAd≠ãr
->
©e
.
Addr1
[3],ÖAdapter->ate.Addr1[4],ÖAdapter->ate.Addr1[5]);

7171  
TRUE
;

7172 
	}
}

7182 
INT
 
	$Së_ATE_SA_Proc
(

7183 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

7184 
IN
 
PUCHAR
 
¨g
)

7186 
CHAR
 *
vÆue
;

7187 
INT
 
i
;

7189 if(
	`°æí
(
¨g
) != 17)

7190  
FALSE
;

7192 
i
=0, 
vÆue
 = 
	`r°πok
(
¨g
,":"); vÆue; vÆuêr°πok(
NULL
,":"))

7194 if((
	`°æí
(
vÆue
Ë!2Ë|| (!
	`isxdigô
(*value)) || (!isxdigit(*(value+1))) )

7195  
FALSE
;

7197 
	`AtoH
(
vÆue
, &
pAd≠ãr
->
©e
.
Addr2
[
i
++], 2);

7201 if(
i
 != 6)

7202  
FALSE
;

7204 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set_ATE_SA_Proc (DA = %2X:%2X:%2X:%2X:%2X:%2X)\n",

7205 
pAd≠ãr
->
©e
.
Addr2
[0],ÖAdapter->ate.Addr2[1],ÖAdapter->ate.Addr2[2],

7206 
pAd≠ãr
->
©e
.
Addr2
[3],ÖAdapter->ate.Addr2[4],ÖAdapter->ate.Addr2[5]);

7208  
TRUE
;

7209 
	}
}

7219 
INT
 
	$Së_ATE_BSSID_Proc
(

7220 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

7221 
IN
 
PUCHAR
 
¨g
)

7223 
CHAR
 *
vÆue
;

7224 
INT
 
i
;

7226 if(
	`°æí
(
¨g
) != 17)

7227  
FALSE
;

7229 
i
=0, 
vÆue
 = 
	`r°πok
(
¨g
,":"); vÆue; vÆuêr°πok(
NULL
,":"))

7231 if((
	`°æí
(
vÆue
Ë!2Ë|| (!
	`isxdigô
(*value)) || (!isxdigit(*(value+1))) )

7232  
FALSE
;

7234 
	`AtoH
(
vÆue
, &
pAd≠ãr
->
©e
.
Addr3
[
i
++], 2);

7237 if(
i
 != 6)

7238  
FALSE
;

7240 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Set_ATE_BSSID_Proc (DA = %2X:%2X:%2X:%2X:%2X:%2X)\n",

7241 
pAd≠ãr
->
©e
.
Addr3
[0],ÖAdapter->ate.Addr3[1],ÖAdapter->ate.Addr3[2],

7242 
pAd≠ãr
->
©e
.
Addr3
[3],ÖAdapter->ate.Addr3[4],ÖAdapter->ate.Addr3[5]);

7244  
TRUE
;

7245 
	}
}

7255 
INT
 
	$Së_ATE_CHANNEL_Proc
(

7256 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

7257 
IN
 
PUCHAR
 
¨g
)

7259 
pAd≠ãr
->
©e
.
Ch™√l
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

7261 if((
pAd≠ãr
->
©e
.
Ch™√l
 < 1) || (pAdapter->ate.Channel > 200))

7263 
pAd≠ãr
->
©e
.
Ch™√l
 = 1;

7264 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Set_ATE_CHANNEL_Proc::Out ofÑange\n");

7265  
FALSE
;

7268 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_ATE_CHANNEL_Pro¯(ATE Ch™√»%d)\n", 
pAd≠ãr
->
©e
.
Ch™√l
);

7270  
TRUE
;

7271 
	}
}

7281 
INT
 
	$Së_ATE_TX_POWER_Proc
(

7282 
IN
 
PRTMP_ADAPTER
 
pAd
,

7283 
IN
 
PUCHAR
 
¨g
)

7285 
ULONG
 
R3
;

7286 
UCHAR
 
Bbp94
 = 0;

7288 
pAd
->
©e
.
TxPowî
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

7290 i‡((
pAd
->
©e
.
TxPowî
 > 36) || (pAd->ate.TxPower < -6))

7292 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Së_ATE_TX_POWER_Proc::Ouào‡øngê(VÆue=%d)\n", 
pAd
->
©e
.
TxPowî
);

7293  
FALSE
;

7296 i‡(
pAd
->
©e
.
TxPowî
 > 31)

7301 
R3
 = 31;

7302 i‡(
pAd
->
©e
.
TxPowî
 <= 36)

7303 
Bbp94
 = 
BBPR94_DEFAULT
 + (
UCHAR
Ë(
pAd
->
©e
.
TxPowî
 - 31);

7305 i‡(
pAd
->
©e
.
TxPowî
 < 0)

7310 
R3
 = 0;

7311 i‡(
pAd
->
©e
.
TxPowî
 >= -6)

7312 
Bbp94
 = 
BBPR94_DEFAULT
 + 
pAd
->
©e
.
TxPowî
;

7317 
R3
 = (
ULONG
Ë
pAd
->
©e
.
TxPowî
;

7318 
Bbp94
 = 
BBPR94_DEFAULT
;

7321 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_ATE_TX_POWER_Pro¯(TxPowî=%d, R3=%d, BBP_R94=%d)\n", 
pAd
->
©e
.
TxPowî
, 
R3
, 
Bbp94
);

7323 
R3
 = R3 << 9;

7324 
R3
 |(
pAd
->
L©chRfRegs
.R3 & 0xffffc1ff);

7325 
pAd
->
L©chRfRegs
.
R3
 = R3;

7327 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R1
);

7328 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R2
);

7329 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R3
);

7330 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R4
);

7332 i‡(
Bbp94
 > 0)

7333 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R94
, 
Bbp94
);

7335  
TRUE
;

7336 
	}
}

7347 
INT
 
	$Së_ATE_TX_FREQOFFSET_Proc
(

7348 
IN
 
PRTMP_ADAPTER
 
pAd
,

7349 
IN
 
PUCHAR
 
¨g
)

7351 
ULONG
 
R4
;

7353 
pAd
->
©e
.
RFFªqOff£t
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

7355 if(
pAd
->
©e
.
RFFªqOff£t
 >= 64)

7357 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Set_ATE_TX_FREQOFFSET_Proc::Out ofÑange\n");

7358  
FALSE
;

7361 
R4
 = 
pAd
->
©e
.
RFFªqOff£t
 << 12;

7362 
R4
 |(
pAd
->
L©chRfRegs
.R4 & (~0x0003f000));

7363 
pAd
->
L©chRfRegs
.
R4
 = R4;

7365 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R1
);

7366 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R2
);

7367 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R4
);

7368 
	`RTUSBWrôeRFRegi°î
(
pAd
,ÖAd->
L©chRfRegs
.
R4
);

7370 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_ATE_TX_FREQOFFSET_Pro¯(RFFªqOff£à%d)\n", 
pAd
->
©e
.
RFFªqOff£t
);

7372  
TRUE
;

7373 
	}
}

7383 
INT
 
	$Së_ATE_TX_LENGTH_Proc
(

7384 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

7385 
IN
 
PUCHAR
 
¨g
)

7387 
pAd≠ãr
->
©e
.
TxLígth
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

7389 if((
pAd≠ãr
->
©e
.
TxLígth
 < 24) || (pAdapter->ate.TxLength > 1500))

7391 
pAd≠ãr
->
©e
.
TxLígth
 = 1500;

7392 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Set_ATE_TX_LENGTH_Proc::Out ofÑange\n");

7393  
FALSE
;

7396 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_ATE_TX_LENGTH_Pro¯(TxLígth = %d)\n", 
pAd≠ãr
->
©e
.
TxLígth
);

7398  
TRUE
;

7399 
	}
}

7409 
INT
 
	$Së_ATE_TX_COUNT_Proc
(

7410 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

7411 
IN
 
PUCHAR
 
¨g
)

7413 
pAd≠ãr
->
©e
.
TxCou¡
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

7415 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_ATE_TX_COUNT_Pro¯(TxCou¡ = %d)\n", 
pAd≠ãr
->
©e
.
TxCou¡
);

7417  
TRUE
;

7418 
	}
}

7428 
INT
 
	$Së_ATE_TX_RATE_Proc
(

7429 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

7430 
IN
 
PUCHAR
 
¨g
)

7432 
pAd≠ãr
->
©e
.
TxR©e
 = 
	`sim∂e_°πﬁ
(
¨g
, 0, 10);

7434 if(
pAd≠ãr
->
©e
.
TxR©e
 > 
RATE_54
)

7436 
pAd≠ãr
->
©e
.
TxR©e
 = 
RATE_11
;

7437 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Set_ATE_TX_RATE_Proc::Out ofÑange\n");

7438  
FALSE
;

7441 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së_ATE_TX_RATE_Pro¯(TxR©ê%d)\n", 
pAd≠ãr
->
©e
.
TxR©e
);

7443  
TRUE
;

7444 
	}
}

7446 
VOID
 
	$RTMPSèti⁄St›
(

7447 
IN
 
PRTMP_ADAPTER
 
pAd
)

7450 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==> RTMPStationStop\n");

7452 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
AssocTimî
);

7453 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
RóssocTimî
);

7454 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
DißssocTimî
);

7455 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
AuthTimî
);

7456 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
Bóc⁄Timî
);

7457 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
SˇnTimî
);

7458 
	`RTMPC™˚lTimî
(&
pAd
->
Mlme
.
PîiodicTimî
);

7461 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<== RTMPStationStop\n");

7463 
	}
}

7465 
VOID
 
	$RTMPSèti⁄Sèπ
(

7466 
IN
 
PRTMP_ADAPTER
 
pAd
)

7469 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "==> RTMPStationStart\n");

7471 
pAd
->
Mlme
.
PîiodicTimî
.
Timî
.
expúes
 = 
jiffõs
 + 
MLME_TASK_EXEC_INTV
;

7472 
	`add_timî
(&
pAd
->
Mlme
.
PîiodicTimî
.
Timî
);

7474 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<== RTMPStationStart\n");

7476 
	}
}

7483 
VOID
 
	$ATEAsicSwôchCh™√l
(

7484 
IN
 
PRTMP_ADAPTER
 
pAd
,

7485 
IN
 
UCHAR
 
Ch™√l
)

7487 
ULONG
 
R3
, 
R4
;

7488 
UCHAR
 
ödex
, 
BbpReg
;

7491 if(
pAd
->
©e
.
RFFªqOff£t
 != 0)

7492 
pAd
->
RfFªqOff£t
 =ÖAd->
©e
.
RFFªqOff£t
;

7495 
	`AsicA¡í«Sñe˘
(
pAd
, 
Ch™√l
);

7497 
R3
 = 
pAd
->
©e
.
TxPowî
 << 9;

7499 
pAd
->
RfIcTy≥
)

7501 
RFIC_2528
:

7502 
ödex
 = 0; index < 
NUM_OF_2528_CHNL
; index++)

7504 i‡(
Ch™√l
 =
RF2528RegTabÀ
[
ödex
].Channel)

7506 
R3
 = R3 | (
RF2528RegTabÀ
[
ödex
].R3 & 0xffffc1ff);

7507 
R4
 = (
RF2528RegTabÀ
[
ödex
].R4 & (~0x0003f000)Ë| (
pAd
->
RfFªqOff£t
 << 12);

7510 
pAd
->
L©chRfRegs
.
Ch™√l
 = Channel;

7511 
pAd
->
L©chRfRegs
.
R1
 = 
RF2528RegTabÀ
[
ödex
].R1;

7512 
pAd
->
L©chRfRegs
.
R2
 = 
RF2528RegTabÀ
[
ödex
].R2;

7513 
pAd
->
L©chRfRegs
.
R3
 = R3;

7514 
pAd
->
L©chRfRegs
.
R4
 = R4;

7521 
RFIC_5226
:

7522 
ödex
 = 0; index < 
NUM_OF_5226_CHNL
; index++)

7524 i‡(
Ch™√l
 =
RF5226RegTabÀ
[
ödex
].Channel)

7526 
R3
 = R3 | (
RF5226RegTabÀ
[
ödex
].R3 & 0xffffc1ff);

7527 
R4
 = (
RF5226RegTabÀ
[
ödex
].R4 & (~0x0003f000)Ë| (
pAd
->
RfFªqOff£t
 << 12);

7530 
pAd
->
L©chRfRegs
.
Ch™√l
 = Channel;

7531 
pAd
->
L©chRfRegs
.
R1
 = 
RF5226RegTabÀ
[
ödex
].R1;

7532 
pAd
->
L©chRfRegs
.
R2
 = 
RF5226RegTabÀ
[
ödex
].R2;

7533 
pAd
->
L©chRfRegs
.
R3
 = R3;

7534 
pAd
->
L©chRfRegs
.
R4
 = R4;

7541 
RFIC_5225
:

7542 
RFIC_2527
:

7543 
ödex
 = 0; index < 
NUM_OF_5225_CHNL
; index++)

7545 i‡(
Ch™√l
 =
RF5225RegTabÀ
[
ödex
].Channel)

7547 
R3
 = R3 | (
RF5225RegTabÀ
[
ödex
].R3 & 0xffffc1ff);

7548 
R4
 = (
RF5225RegTabÀ
[
ödex
].R4 & (~0x0003f000)Ë| (
pAd
->
RfFªqOff£t
 << 12);

7551 
pAd
->
L©chRfRegs
.
Ch™√l
 = Channel;

7552 
pAd
->
L©chRfRegs
.
R1
 = 
RF5225RegTabÀ
[
ödex
].R1;

7553 
pAd
->
L©chRfRegs
.
R2
 = 
RF5225RegTabÀ
[
ödex
].R2;

7554 
pAd
->
L©chRfRegs
.
R3
 = R3;

7555 
pAd
->
L©chRfRegs
.
R4
 = R4;

7561 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R3
, &
BbpReg
);

7562 i‡((
pAd
->
RfIcTy≥
 =
RFIC_5225
Ë|| (pAd->RfIcTy≥ =
RFIC_2527
))

7563 
BbpReg
 &= 0xFE;

7565 
BbpReg
 |= 0x01;

7566 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R3
, 
BbpReg
);

7577 i‡(
Ch™√l
 > 14)

7578 
	`RTMPu£cDñay
(1000);

7580 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ATEAsicSwitchChannel(RF=%d, Pwr=%d)Åo #%d, R1=0x%08x, R2=0x%08x, R3=0x%08x, R4=0x%08x\n",

7581 
pAd
->
RfIcTy≥
,

7582 (
R3
 & 0x00003e00) >> 9,

7583 
Ch™√l
,

7584 
pAd
->
L©chRfRegs
.
R1
,

7585 
pAd
->
L©chRfRegs
.
R2
,

7586 
pAd
->
L©chRfRegs
.
R3
,

7587 
pAd
->
L©chRfRegs
.
R4
);

7588 
	}
}

7592 
INT
 
	$RTMPIo˘lSëAuth
(

7593 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

7594 
IN
 
iwªq
 *
wrq
)

7596 
CHAR
 
¨g
[1];

7597 
INT
 
Sètus
 = 0;

7599 i‡(
wrq
->
u
.
d©a
.
Àngth
 != 1)

7601 
Sètus
 = -
EINVAL
;

7602  (
Sètus
);

7607 
Sètus
 = 
	`c›y_‰om_u£r
(
¨g
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

7609 i‡(
¨g
[0] == 1)

7610 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeO≥n
;

7611 i‡(
¨g
[0] == 2)

7612 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeSh¨ed
;

7613 i‡(
¨g
[0] == 3)

7614 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeWPAPSK
;

7615 i‡(
¨g
[0] == 4)

7616 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeWPA2PSK
;

7617 i‡(
¨g
[0] == 5)

7618 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeWPAN⁄e
;

7621 
Sètus
 = -
EINVAL
;

7622  (
Sètus
);

7627 
pAd≠ãr
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_NOT_SECURED
;

7628 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RTMPIo˘lSëAuth::(AuthMode=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
AuthMode
);

7630  (
Sètus
);

7631 
	}
}

7633 
INT
 
	$RTMPIo˘lSëEn¸yp
(

7634 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

7635 
IN
 
iwªq
 *
wrq
)

7637 
CHAR
 
¨g
[1];

7638 
INT
 
Sètus
 = 0;

7640 i‡(
wrq
->
u
.
d©a
.
Àngth
 != 1)

7642 
Sètus
 = -
EINVAL
;

7643  (
Sètus
);

7647 
Sètus
 = 
	`c›y_‰om_u£r
(
¨g
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

7649 i‡(
¨g
[0] == 1)

7651 
pAd≠ãr
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11WEPDißbÀd
;

7652 
pAd≠ãr
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11WEPDißbÀd
;

7653 
pAd≠ãr
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11WEPDißbÀd
;

7655 i‡(
¨g
[0] == 2)

7657 
pAd≠ãr
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11WEPE«bÀd
;

7658 
pAd≠ãr
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11WEPE«bÀd
;

7659 
pAd≠ãr
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11WEPE«bÀd
;

7662 i‡(
¨g
[0] == 3)

7664 
pAd≠ãr
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

7665 
pAd≠ãr
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

7666 
pAd≠ãr
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

7669 i‡(
¨g
[0] == 4)

7671 
pAd≠ãr
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

7672 
pAd≠ãr
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

7673 
pAd≠ãr
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

7678 
Sètus
 = -
EINVAL
;

7679  (
Sètus
);

7684 
	`RTMPMakeRSNIE
(
pAd≠ãr
,ÖAd≠ãr->
P‹tCfg
.
GroupCùhî
);

7687 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RTMPIo˘lSëEn¸yp::(En¸ypTy≥=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
WïSètus
);

7689  (
Sètus
);

7690 
	}
}

7692 
INT
 
	$RTMPIo˘lSëW∑psk
(

7693 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

7694 
IN
 
iwªq
 *
wrq
)

7696 
CHAR
 
¨g
[128];

7697 
UCHAR
 
keyM©îül
[40];

7698 
INT
 
Sètus
 = 0;

7700 i‡((
pAd≠ãr
->
P‹tCfg
.
AuthMode
 !
Ndis802_11AuthModeWPAPSK
) &&\

7701 (
pAd≠ãr
->
P‹tCfg
.
AuthMode
 !
Ndis802_11AuthModeWPA2PSK
) &&\

7702 (
pAd≠ãr
->
P‹tCfg
.
AuthMode
 !
Ndis802_11AuthModeWPAN⁄e
) )

7703  
TRUE
;

7705 
Sètus
 = 
	`c›y_‰om_u£r
(
¨g
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

7707 
	`NdisZîoMem‹y
(
keyM©îül
, 40);

7710 
¨g
[
	`°æí
(arg)]='\0';

7712 i‡((
wrq
->
u
.
d©a
.
Àngth
 < 8) || (wrq->u.data.length > 64))

7714 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Së faûed!!(WPAPSK=%s), WPAPSK key-°rögÑequúed 8 ~ 64 ch¨a˘î†\n", 
¨g
);

7715 
Sètus
 = -
EINVAL
;

7716  (
Sètus
);

7718 i‡(
wrq
->
u
.
d©a
.
Àngth
 == 64)

7720 
	`AtoH
(
¨g
, 
keyM©îül
, 32);

7721 
	`NdisMoveMem‹y
(
pAd≠ãr
->
P‹tCfg
.
PskKey
.
Key
, 
keyM©îül
, 32);

7725 
	`Passw‹dHash
((*)
¨g
, 
pAd≠ãr
->
MlmeAux
.
Ssid
,ÖAd≠ãr->MlmeAux.
SsidLí
, 
keyM©îül
);

7726 
	`NdisMoveMem‹y
(
pAd≠ãr
->
P‹tCfg
.
PskKey
.
Key
, 
keyM©îül
, 32);

7729 
	`RTMPMakeRSNIE
(
pAd≠ãr
,ÖAd≠ãr->
P‹tCfg
.
GroupCùhî
);

7731 if(
pAd≠ãr
->
P‹tCfg
.
BssTy≥
 =
BSS_ADHOC
 &&\

7732 
pAd≠ãr
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAN⁄e
)

7735 
Sètus
 = 
	`RTMPWPAN⁄eAddKeyProc
(
pAd≠ãr
, &
keyM©îül
[0]);

7737 i‡(
Sètus
 !
NDIS_STATUS_SUCCESS
)

7738  -
ENOMEM
;

7740 
pAd≠ãr
->
P‹tCfg
.
W∑Sèã
 = 
SS_NOTUSE
;

7745 
pAd≠ãr
->
P‹tCfg
.
W∑Sèã
 = 
SS_START
;

7748 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RTMPIo˘lSëW∑psk::(WPAPSK=%s)\n", 
¨g
);

7750  (
Sètus
);

7751 
	}
}

7753 
INT
 
	$RTMPIo˘lSëPsm
(

7754 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

7755 
IN
 
iwªq
 *
wrq
)

7757 
CHAR
 
¨g
[1];

7758 
INT
 
Sètus
 = 0;

7760 i‡(
wrq
->
u
.
d©a
.
Àngth
 != 1)

7762 
Sètus
 = -
EINVAL
;

7763  (
Sètus
);

7767 
Sètus
 = 
	`c›y_‰om_u£r
(
¨g
, 
wrq
->
u
.
d©a
.
poöãr
, wrq->u.d©a.
Àngth
);

7769 i‡(
¨g
[0] == 0)

7773 
	`MlmeSëPsmBô
(
pAd≠ãr
, 
PWR_ACTIVE
);

7774 
	`OPSTATUS_SET_FLAG
(
pAd≠ãr
, 
fOP_STATUS_RECEIVE_DTIM
);

7775 i‡(
pAd≠ãr
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

7776 
pAd≠ãr
->
P‹tCfg
.
WödowsPowîMode
 = 
Ndis802_11PowîModeCAM
;

7777 
pAd≠ãr
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
Ndis802_11PowîModeCAM
;

7779 i‡(
¨g
[0] == 1)

7784 i‡(
pAd≠ãr
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

7785 
pAd≠ãr
->
P‹tCfg
.
WödowsPowîMode
 = 
Ndis802_11PowîModeMAX_PSP
;

7786 
pAd≠ãr
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
Ndis802_11PowîModeMAX_PSP
;

7787 
	`OPSTATUS_SET_FLAG
(
pAd≠ãr
, 
fOP_STATUS_RECEIVE_DTIM
);

7788 
pAd≠ãr
->
P‹tCfg
.
DeÁu…Li°íCou¡
 = 5;

7791 i‡(
¨g
[0] == 2)

7796 
	`OPSTATUS_SET_FLAG
(
pAd≠ãr
, 
fOP_STATUS_RECEIVE_DTIM
);

7797 i‡(
pAd≠ãr
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

7798 
pAd≠ãr
->
P‹tCfg
.
WödowsPowîMode
 = 
Ndis802_11PowîModeFa°_PSP
;

7799 
pAd≠ãr
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
Ndis802_11PowîModeFa°_PSP
;

7800 
pAd≠ãr
->
P‹tCfg
.
DeÁu…Li°íCou¡
 = 3;

7804 
Sètus
 = -
EINVAL
;

7805  (
Sètus
);

7810 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RTMPIo˘lSëPsm::(PSMode=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
WödowsPowîMode
);

7811  (
Sètus
);

7813 
	}
}

7815 
VOID
 
	$RTMPIo˘lGëRaAPCfg
(

7816 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

7817 
IN
 
iwªq
 *
wrq
)

7819 
pAd≠ãr
->
P‹tCfg
.
bGëAPC⁄fig
 = 
TRUE
;

7820 
	`EnqueueProbeReque°
(
pAd≠ãr
);

7821 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RTMPIo˘lGëRaAPCfg::(bGëAPC⁄fig=%d)\n", 
pAd≠ãr
->
P‹tCfg
.
bGëAPC⁄fig
);

7823 
	}
}

	@rtmp_init.c

40 
	~"π_c⁄fig.h
"

42 #i‡
LINUX_VERSION_CODE
 >
KERNEL_VERSION
(2,5,0)

43 
	#RT_USB_ALLOC_URB
(
iso
Ë
	`usb_Æloc_urb
(iso, 
GFP_ATOMIC
);

	)

45 
	#RT_USB_ALLOC_URB
(
iso
Ë
	`usb_Æloc_urb
(iso);

	)

48 
UCHAR
 
	gBIT8
[] = {0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80};

49 
ULONG
 
	gBIT32
[] = {0x00000001, 0x00000002, 0x00000004, 0x00000008,

58 * 
	gCùhîName
[] = {"none","wep64","wep128","TKIP","AES","CKIP64","CKIP128"};

60 c⁄° 
	gccôt_16TabÀ
[] = {

94 
	#ByãCRC16
(
v
, 
¸c
) \

95 ()((
¸c
 << 8Ë^ 
ccôt_16TabÀ
[((¸¯>> 8Ë^ (
v
)Ë& 255])

	)

101 
BBP_REG_PAIR
 
	gBBPRegTabÀ
[] = {

129 
	#NUM_BBP_REG_PARMS
 ((
BBPRegTabÀ
Ë/ (
BBP_REG_PAIR
))

	)

135 
RTMP_REG_PAIR
 
	gMACRegTabÀ
[] = {

136 {
TXRX_CSR0
, 0x025fb032},

137 {
TXRX_CSR1
, 0x9eaa9eaf},

138 {
TXRX_CSR2
, 0x8a8b8c8d},

139 {
TXRX_CSR3
, 0x00858687},

140 {
TXRX_CSR7
, 0x2E31353B},

141 {
TXRX_CSR8
, 0x2a2a2a2c},

142 {
TXRX_CSR15
, 0x0000000f},

143 {
MAC_CSR6
, 0x00000fff},

144 {
MAC_CSR8
, 0x016c030a},

145 {
MAC_CSR10
, 0x00000718},

146 {
MAC_CSR12
, 0x00000004},

147 {
MAC_CSR13
, 0x00007f00},

148 {
SEC_CSR0
, 0x00000000},

149 {
SEC_CSR1
, 0x00000000},

150 {
SEC_CSR5
, 0x00000000},

151 {
PHY_CSR1
, 0x000023b0},

152 {
PHY_CSR5
, 0x00040a06},

153 {
PHY_CSR6
, 0x00080606},

154 {
PHY_CSR7
, 0x00000408},

155 {
AIFSN_CSR
, 0x00002273},

156 {
CWMIN_CSR
, 0x00002344},

157 {
CWMAX_CSR
, 0x000034aa},

159 
	#NUM_MAC_REG_PARMS
 ((
MACRegTabÀ
Ë/ (
RTMP_REG_PAIR
))

	)

162 
UCHAR
 
	gFúmw¨eImage
[] =

382 
	#FIRMAREIMAGE_LENGTH
 ( (
Fúmw¨eImage
Ë/ (
UCHAR
))

	)

383 
	#FIRMWARE_MAJOR_VERSION
 2

	)

384 
	#FIRMWARE_MINOR_VERSION
 2

	)

386 
VOID
 
	$Cª©eThªads
–
√t_devi˚
 *
√t_dev
 )

388 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
√t_dev
);

389 
pid_t
 
pid_numbî
 = -1;

392 
pAd
->
MLMEThr_pid

THREAD_PID_INIT_VALUE
;

394 
pid_numbî
 = 
	`kî√l_thªad
(
MlmeThªad
, 
pAd
, 
CLONE_VM
);

395 i‡(
pid_numbî
 < 0) {

396 
	`¥ötk
 (
KERN_WARNING
 "%s: u«bÀÅÿ°¨àmlmêthªad\n",
pAd
->
√t_dev
->
«me
);

399 
pAd
->
MLMEThr_pid
=
	`GET_PID
(
pid_numbî
);

402 
	`waô_f‹_com∂ëi⁄
(&(
pAd
->
MlmeThªadNŸify
));

405 
pAd
->
RTUSBCmdThr_pid

THREAD_PID_INIT_VALUE
;

407 
pid_numbî
 = 
	`kî√l_thªad
(
RTUSBCmdThªad
, 
pAd
, 
CLONE_VM
);

408 i‡(
pid_numbî
 < 0) {

409 
	`¥ötk
 (
KERN_WARNING
 "%s: u«bÀÅÿ°¨àRTUSBCmdÅhªad\n",
pAd
->
√t_dev
->
«me
);

412 
pAd
->
RTUSBCmdThr_pid
=
	`GET_PID
(
pid_numbî
);

415 
	`waô_f‹_com∂ëi⁄
(&(
pAd
->
CmdThªadNŸify
));

416 
	}
}

418 
NDIS_STATUS
 
	$NICInôTønsmô
(

419 
IN
 
PRTMP_ADAPTER
 
pAd
 )

421 
UCHAR
 
i
, 
acidx
;

422 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

423 
PTX_CONTEXT
 
pPsPﬁlC⁄ãxt
 = &(
pAd
->
PsPﬁlC⁄ãxt
);

424 
PTX_CONTEXT
 
pNuŒC⁄ãxt
 = &(
pAd
->
NuŒC⁄ãxt
);

425 
PTX_CONTEXT
 
pRTSC⁄ãxt
 = &(
pAd
->
RTSC⁄ãxt
);

427 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"--> NICInitTransmit\n");

430 
i
 = 0; i < 4; i++)

433 
	`InôülizeQueueHódî
(&
pAd
->
SídTxWaôQueue
[
i
]);

435 
pAd
->
NextTxIndex
[
i
] = 0;

436 
pAd
->
TxRögTŸÆNumbî
[
i
] = 0;

437 
pAd
->
NextBulkOutIndex
[
i
] = 0;

438 
pAd
->
BulkOutPídög
[
i
] = 
FALSE
;

441 
pAd
->
Priv©eInfo
.
TxRögFuŒC¡
 = 0;

443 
pAd
->
NextRxBulkInIndex
 = 0;

444 
pAd
->
NextMLMEIndex
 = 0;

445 
pAd
->
PushMgmtIndex
 = 0;

446 
pAd
->
P›MgmtIndex
 = 0;

447 
	`©omic_£t
(&
pAd
->
MgmtQueueSize
, 0);

448 
	`©omic_£t
(&
pAd
->
TxCou¡
, 0);

450 
pAd
->
PrioRögFú°Index
 = 0;

451 
pAd
->
PrioRögTxC¡
 = 0;

458 
acidx
 = 0;ácidx < 4;ácidx++)

460  
i
0; i < 
TX_RING_SIZE
; i++ )

462 
PTX_CONTEXT
 
pTxC⁄ãxt
 = &(
pAd
->
TxC⁄ãxt
[
acidx
][
i
]);

465 
pTxC⁄ãxt
->
pUrb
 = 
	`RT_USB_ALLOC_URB
(0);

466 if(
pTxC⁄ãxt
->
pUrb
 =
NULL
){

467 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

468 
d⁄e
;

470 
pTxC⁄ãxt
->
Tøns„rBuf„r
(
PTX_BUFFER
Ë
	`kmÆloc
((
TX_BUFFER
), 
GFP_KERNEL
);

471 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

472 if(!
pTxC⁄ãxt
->
Tøns„rBuf„r
){

473 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"NotÉnough memory\n");

474 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

475 
out1
;

478 
	`NdisZîoMem‹y
(
pTxC⁄ãxt
->
Tøns„rBuf„r
, (
TX_BUFFER
));

480 
pTxC⁄ãxt
->
pAd
 =ÖAd;

481 
pTxC⁄ãxt
->
InU£
 = 
FALSE
;

482 
pTxC⁄ãxt
->
IRPPídög
 = 
FALSE
;

490  
i
0; i < 
PRIO_RING_SIZE
; i++ )

492 
PTX_CONTEXT
 
pMLMEC⁄ãxt
 = &(
pAd
->
MLMEC⁄ãxt
[
i
]);

494 
pMLMEC⁄ãxt
->
pUrb
 = 
	`RT_USB_ALLOC_URB
(0);

495 if(
pMLMEC⁄ãxt
->
pUrb
 =
NULL
){

496 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

497 
out1
;

500 
pMLMEC⁄ãxt
->
Tøns„rBuf„r
(
PTX_BUFFER
Ë
	`kmÆloc
((
TX_BUFFER
), 
GFP_KERNEL
);

501 if(!
pMLMEC⁄ãxt
->
Tøns„rBuf„r
){

502 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"NotÉnough memory\n");

503 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

504 
out2
;

507 
	`NdisZîoMem‹y
(
pMLMEC⁄ãxt
->
Tøns„rBuf„r
, (
TX_BUFFER
));

508 
pMLMEC⁄ãxt
->
pAd
 =ÖAd ;

509 
pMLMEC⁄ãxt
->
InU£
 = 
FALSE
;

510 
pMLMEC⁄ãxt
->
IRPPídög
 = 
FALSE
;

517 
i
 = 0; i < 
BEACON_RING_SIZE
; i++)

519 
PTX_CONTEXT
 
pBóc⁄C⁄ãxt
 = &(
pAd
->
Bóc⁄C⁄ãxt
[
i
]);

520 
pBóc⁄C⁄ãxt
->
pUrb
 = 
	`RT_USB_ALLOC_URB
(0);

521 if(
pBóc⁄C⁄ãxt
->
pUrb
 =
NULL
){

522 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

523 
out2
;

526 
pBóc⁄C⁄ãxt
->
Tøns„rBuf„r
(
PTX_BUFFER
Ë
	`kmÆloc
((
TX_BUFFER
), 
GFP_KERNEL
);

527 if(!
pBóc⁄C⁄ãxt
->
Tøns„rBuf„r
){

528 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"NotÉnough memory\n");

529 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

530 
out3
;

532 
	`NdisZîoMem‹y
(
pBóc⁄C⁄ãxt
->
Tøns„rBuf„r
, (
TX_BUFFER
));

534 
pBóc⁄C⁄ãxt
->
pAd
 =ÖAd;

535 
pBóc⁄C⁄ãxt
->
InU£
 = 
FALSE
;

536 
pBóc⁄C⁄ãxt
->
IRPPídög
 = 
FALSE
;

543 
pNuŒC⁄ãxt
->
pUrb
 = 
	`RT_USB_ALLOC_URB
(0);

544 if(
pNuŒC⁄ãxt
->
pUrb
 =
NULL
){

545 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

546 
out3
;

549 
pNuŒC⁄ãxt
->
Tøns„rBuf„r
(
PTX_BUFFER
Ë
	`kmÆloc
((
TX_BUFFER
), 
GFP_KERNEL
);

550 if(!
pNuŒC⁄ãxt
->
Tøns„rBuf„r
){

551 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"NotÉnough memory\n");

552 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

553 
out4
;

556 
	`NdisZîoMem‹y
(
pNuŒC⁄ãxt
->
Tøns„rBuf„r
, (
TX_BUFFER
));

557 
pNuŒC⁄ãxt
->
pAd
 =ÖAd;

558 
pNuŒC⁄ãxt
->
InU£
 = 
FALSE
;

559 
pNuŒC⁄ãxt
->
IRPPídög
 = 
FALSE
;

564 
pRTSC⁄ãxt
->
pUrb
 = 
	`RT_USB_ALLOC_URB
(0);

565 if(
pRTSC⁄ãxt
->
pUrb
 =
NULL
){

566 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

567 
out4
;

570 
pRTSC⁄ãxt
->
Tøns„rBuf„r
(
PTX_BUFFER
Ë
	`kmÆloc
((
TX_BUFFER
), 
GFP_KERNEL
);

571 if(!
pRTSC⁄ãxt
->
Tøns„rBuf„r
){

572 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"NotÉnough memory\n");

573 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

574 
out5
;

577 
	`NdisZîoMem‹y
(
pRTSC⁄ãxt
->
Tøns„rBuf„r
, (
TX_BUFFER
));

578 
pRTSC⁄ãxt
->
pAd
 =ÖAd;

579 
pRTSC⁄ãxt
->
InU£
 = 
FALSE
;

580 
pRTSC⁄ãxt
->
IRPPídög
 = 
FALSE
;

586 
pPsPﬁlC⁄ãxt
->
pUrb
 = 
	`RT_USB_ALLOC_URB
(0);

587 if(
pPsPﬁlC⁄ãxt
->
pUrb
 =
NULL
){

588 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

589 
out5
;

592 
pPsPﬁlC⁄ãxt
->
Tøns„rBuf„r
(
PTX_BUFFER
Ë
	`kmÆloc
((
TX_BUFFER
), 
GFP_KERNEL
);

593 if(!
pPsPﬁlC⁄ãxt
->
Tøns„rBuf„r
){

594 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"NotÉnough memory\n");

595 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

596 
out6
;

599 
	`NdisZîoMem‹y
(
pPsPﬁlC⁄ãxt
->
Tøns„rBuf„r
, (
TX_BUFFER
));

600 
pPsPﬁlC⁄ãxt
->
pAd
 =ÖAd;

601 
pPsPﬁlC⁄ãxt
->
InU£
 = 
FALSE
;

602 
pPsPﬁlC⁄ãxt
->
IRPPídög
 = 
FALSE
;

604 } 
FALSE
);

606  
Sètus
;

609 
out6
:

610 i‡(
NULL
 !
pPsPﬁlC⁄ãxt
->
pUrb
)

612 
	`RTUSB_UNLINK_URB
(
pPsPﬁlC⁄ãxt
->
pUrb
);

613 
	`usb_‰ì_urb
(
pPsPﬁlC⁄ãxt
->
pUrb
);

614 
pPsPﬁlC⁄ãxt
->
pUrb
 = 
NULL
;

616 i‡(
NULL
 !
pPsPﬁlC⁄ãxt
->
Tøns„rBuf„r
)

618 
	`k‰ì
(
pPsPﬁlC⁄ãxt
->
Tøns„rBuf„r
);

619 
pPsPﬁlC⁄ãxt
->
Tøns„rBuf„r
 = 
NULL
;

621 
out5
:

622 i‡(
NULL
 !
pRTSC⁄ãxt
->
pUrb
)

624 
	`RTUSB_UNLINK_URB
(
pRTSC⁄ãxt
->
pUrb
);

625 
	`usb_‰ì_urb
(
pRTSC⁄ãxt
->
pUrb
);

626 
pRTSC⁄ãxt
->
pUrb
 = 
NULL
;

628 i‡(
NULL
 !
pRTSC⁄ãxt
->
Tøns„rBuf„r
)

630 
	`k‰ì
(
pRTSC⁄ãxt
->
Tøns„rBuf„r
);

631 
pRTSC⁄ãxt
->
Tøns„rBuf„r
 = 
NULL
;

633 
out4
:

634 i‡(
NULL
 !
pNuŒC⁄ãxt
->
pUrb
)

636 
	`RTUSB_UNLINK_URB
(
pNuŒC⁄ãxt
->
pUrb
);

637 
	`usb_‰ì_urb
(
pNuŒC⁄ãxt
->
pUrb
);

638 
pNuŒC⁄ãxt
->
pUrb
 = 
NULL
;

640 i‡(
NULL
 !
pNuŒC⁄ãxt
->
Tøns„rBuf„r
)

642 
	`k‰ì
(
pNuŒC⁄ãxt
->
Tøns„rBuf„r
);

643 
pNuŒC⁄ãxt
->
Tøns„rBuf„r
 = 
NULL
;

645 
out3
:

646 
i
 = 0; i < 
BEACON_RING_SIZE
; i++)

648 
PTX_CONTEXT
 
pBóc⁄C⁄ãxt
 = &(
pAd
->
Bóc⁄C⁄ãxt
[
i
]);

649 i‡–
NULL
 !
pBóc⁄C⁄ãxt
->
pUrb
 )

651 
	`RTUSB_UNLINK_URB
(
pBóc⁄C⁄ãxt
->
pUrb
);

652 
	`usb_‰ì_urb
(
pBóc⁄C⁄ãxt
->
pUrb
);

653 
pBóc⁄C⁄ãxt
->
pUrb
 = 
NULL
;

656 i‡–
NULL
 !
pBóc⁄C⁄ãxt
->
Tøns„rBuf„r
 )

658 
	`k‰ì
–
pBóc⁄C⁄ãxt
->
Tøns„rBuf„r
);

659 
pBóc⁄C⁄ãxt
->
Tøns„rBuf„r
 = 
NULL
;

662 
out2
:

663  
i
0; i < 
PRIO_RING_SIZE
; i++ )

665 
PTX_CONTEXT
 
pMLMEC⁄ãxt
 = &(
pAd
->
MLMEC⁄ãxt
[
i
]);

667 i‡–
NULL
 !
pMLMEC⁄ãxt
->
pUrb
 )

669 
	`RTUSB_UNLINK_URB
(
pMLMEC⁄ãxt
->
pUrb
);

670 
	`usb_‰ì_urb
(
pMLMEC⁄ãxt
->
pUrb
);

671 
pMLMEC⁄ãxt
->
pUrb
 = 
NULL
;

674 i‡–
NULL
 !
pMLMEC⁄ãxt
->
Tøns„rBuf„r
 )

676 
	`k‰ì
–
pMLMEC⁄ãxt
->
Tøns„rBuf„r
);

677 
pMLMEC⁄ãxt
->
Tøns„rBuf„r
 = 
NULL
;

680 
out1
:

681 
acidx
 = 0;ácidx < 4;ácidx++)

683  
i
0; i < 
TX_RING_SIZE
; i++ )

685 
PTX_CONTEXT
 
pTxC⁄ãxt
 = &(
pAd
->
TxC⁄ãxt
[
acidx
][
i
]);

687 i‡–
NULL
 !
pTxC⁄ãxt
->
pUrb
 )

689 
	`RTUSB_UNLINK_URB
(
pTxC⁄ãxt
->
pUrb
);

690 
	`usb_‰ì_urb
(
pTxC⁄ãxt
->
pUrb
);

691 
pTxC⁄ãxt
->
pUrb
 = 
NULL
;

693 i‡–
NULL
 !
pTxC⁄ãxt
->
Tøns„rBuf„r
 )

695 
	`k‰ì
–
pTxC⁄ãxt
->
Tøns„rBuf„r
);

696 
pTxC⁄ãxt
->
Tøns„rBuf„r
 = 
NULL
;

701 
d⁄e
:

702  
Sètus
;

703 
	}
}

726 
NDIS_STATUS
 
	$NICInôRecv
(

727 
IN
 
PRTMP_ADAPTER
 
pAd
)

729 
UCHAR
 
i
;

730 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

733 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"--> NICInitRecv\n");

734 
pAd
->
NextRxBulkInIndex
 = 0;

735 
	`©omic_£t
–&
pAd
->
PídögRx
, 0);

736 
i
 = 0; i < 
RX_RING_SIZE
; i++)

738 
PRX_CONTEXT
 
pRxC⁄ãxt
 = &(
pAd
->
RxC⁄ãxt
[
i
]);

739 
pRxC⁄ãxt
->
pUrb
 = 
	`RT_USB_ALLOC_URB
(0);

740 if(
pRxC⁄ãxt
->
pUrb
 =
NULL
)

742 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

743 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"-->ÖRxContext->pUrb == NULL\n");

747 
pRxC⁄ãxt
->
Tøns„rBuf„r
(
PUCHAR
Ë
	`kmÆloc
(
BUFFER_SIZE
, 
MEM_ALLOC_FLAG
);

748 if(!
pRxC⁄ãxt
->
Tøns„rBuf„r
)

750 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"NotÉnough memory\n");

751 
Sètus
 = 
NDIS_STATUS_RESOURCES
;

755 
	`NdisZîoMem‹y
(
pRxC⁄ãxt
->
Tøns„rBuf„r
, 
BUFFER_SIZE
);

757 
pRxC⁄ãxt
->
pAd
 =ÖAd;

758 
pRxC⁄ãxt
->
InU£
 = 
FALSE
;

759 
pRxC⁄ãxt
->
IRPPídög
 = 
FALSE
;

762 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"<-- NICInitRecv\n");

763  
Sètus
;

764 
	}
}

783 
VOID
 
	$Rñó£Ad≠ãr
(

784 
IN
 
PRTMP_ADAPTER
 
pAd
,

785 
IN
 
BOOLEAN
 
IsFªe
,

786 
IN
 
BOOLEAN
 
IsO∆yTx
)

788 
UINT
 
i
, 
acidx
;

789 
PTX_CONTEXT
 
pNuŒC⁄ãxt
 = &
pAd
->
NuŒC⁄ãxt
;

790 
PTX_CONTEXT
 
pPsPﬁlC⁄ãxt
 = &
pAd
->
PsPﬁlC⁄ãxt
;

791 
PTX_CONTEXT
 
pRTSC⁄ãxt
 = &
pAd
->
RTSC⁄ãxt
;

793 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "---> ReleaseAdapter\n");

795 i‡(!
IsO∆yTx
)

798 
i
 = 0; i < 
RX_RING_SIZE
; i++)

800 
PRX_CONTEXT
 
pRxC⁄ãxt
 = &(
pAd
->
RxC⁄ãxt
[
i
]);

802 i‡(
pRxC⁄ãxt
->
pUrb
 !
NULL
)

804 
	`RTUSB_UNLINK_URB
(
pRxC⁄ãxt
->
pUrb
);

805 i‡(
IsFªe
)

806 
	`usb_‰ì_urb
(
pRxC⁄ãxt
->
pUrb
);

807 
pRxC⁄ãxt
->
pUrb
 = 
NULL
;

809 i‡(
pRxC⁄ãxt
->
Tøns„rBuf„r
 !
NULL
)

811 
	`k‰ì
(
pRxC⁄ãxt
->
Tøns„rBuf„r
);

812 
pRxC⁄ãxt
->
Tøns„rBuf„r
 = 
NULL
;

819 i‡(
NULL
 !
pPsPﬁlC⁄ãxt
->
pUrb
)

821 
	`RTUSB_UNLINK_URB
(
pPsPﬁlC⁄ãxt
->
pUrb
);

822 i‡(
IsFªe
)

823 
	`usb_‰ì_urb
(
pPsPﬁlC⁄ãxt
->
pUrb
);

824 
pPsPﬁlC⁄ãxt
->
pUrb
 = 
NULL
;

826 i‡(
NULL
 !
pPsPﬁlC⁄ãxt
->
Tøns„rBuf„r
)

828 
	`k‰ì
(
pPsPﬁlC⁄ãxt
->
Tøns„rBuf„r
);

829 
pPsPﬁlC⁄ãxt
->
Tøns„rBuf„r
 = 
NULL
;

833 i‡(
NULL
 !
pNuŒC⁄ãxt
->
pUrb
)

835 
	`RTUSB_UNLINK_URB
(
pNuŒC⁄ãxt
->
pUrb
);

836 i‡(
IsFªe
)

837 
	`usb_‰ì_urb
(
pNuŒC⁄ãxt
->
pUrb
);

838 
pNuŒC⁄ãxt
->
pUrb
 = 
NULL
;

840 i‡(
NULL
 !
pNuŒC⁄ãxt
->
Tøns„rBuf„r
)

842 
	`k‰ì
(
pNuŒC⁄ãxt
->
Tøns„rBuf„r
);

843 
pNuŒC⁄ãxt
->
Tøns„rBuf„r
 = 
NULL
;

847 i‡(
NULL
 !
pRTSC⁄ãxt
->
pUrb
)

849 
	`RTUSB_UNLINK_URB
(
pRTSC⁄ãxt
->
pUrb
);

850 i‡(
IsFªe
)

851 
	`usb_‰ì_urb
(
pRTSC⁄ãxt
->
pUrb
);

852 
pRTSC⁄ãxt
->
pUrb
 = 
NULL
;

854 i‡(
NULL
 !
pRTSC⁄ãxt
->
Tøns„rBuf„r
)

856 
	`k‰ì
(
pRTSC⁄ãxt
->
Tøns„rBuf„r
);

857 
pRTSC⁄ãxt
->
Tøns„rBuf„r
 = 
NULL
;

861 
i
 = 0; i < 
BEACON_RING_SIZE
; i++)

863 
PTX_CONTEXT
 
pBóc⁄C⁄ãxt
 = &(
pAd
->
Bóc⁄C⁄ãxt
[
i
]);

864 i‡–
NULL
 !
pBóc⁄C⁄ãxt
->
pUrb
 )

866 
	`RTUSB_UNLINK_URB
(
pBóc⁄C⁄ãxt
->
pUrb
);

867 i‡(
IsFªe
)

868 
	`usb_‰ì_urb
(
pBóc⁄C⁄ãxt
->
pUrb
);

869 
pBóc⁄C⁄ãxt
->
pUrb
 = 
NULL
;

872 i‡–
NULL
 !
pBóc⁄C⁄ãxt
->
Tøns„rBuf„r
 )

874 
	`k‰ì
–
pBóc⁄C⁄ãxt
->
Tøns„rBuf„r
);

875 
pBóc⁄C⁄ãxt
->
Tøns„rBuf„r
 = 
NULL
;

880  
i
0; i < 
PRIO_RING_SIZE
; i++ )

882 
PTX_CONTEXT
 
pMLMEC⁄ãxt
 = &(
pAd
->
MLMEC⁄ãxt
[
i
]);

884 i‡–
NULL
 !
pMLMEC⁄ãxt
->
pUrb
 )

886 
	`RTUSB_UNLINK_URB
(
pMLMEC⁄ãxt
->
pUrb
);

887 i‡(
IsFªe
)

888 
	`usb_‰ì_urb
(
pMLMEC⁄ãxt
->
pUrb
);

889 
pMLMEC⁄ãxt
->
pUrb
 = 
NULL
;

892 i‡–
NULL
 !
pMLMEC⁄ãxt
->
Tøns„rBuf„r
 )

894 
	`k‰ì
–
pMLMEC⁄ãxt
->
Tøns„rBuf„r
);

895 
pMLMEC⁄ãxt
->
Tøns„rBuf„r
 = 
NULL
;

900 
acidx
 = 0;ácidx < 4;ácidx++)

902  
i
0; i < 
TX_RING_SIZE
; i++ )

904 
PTX_CONTEXT
 
pTxC⁄ãxt
 = &(
pAd
->
TxC⁄ãxt
[
acidx
][
i
]);

906 i‡–
NULL
 !
pTxC⁄ãxt
->
pUrb
 )

908 
	`RTUSB_UNLINK_URB
(
pTxC⁄ãxt
->
pUrb
);

909 i‡(
IsFªe
)

910 
	`usb_‰ì_urb
(
pTxC⁄ãxt
->
pUrb
);

911 
pTxC⁄ãxt
->
pUrb
 = 
NULL
;

914 i‡–
NULL
 !
pTxC⁄ãxt
->
Tøns„rBuf„r
 )

916 
	`k‰ì
–
pTxC⁄ãxt
->
Tøns„rBuf„r
);

917 
pTxC⁄ãxt
->
Tøns„rBuf„r
 = 
NULL
;

922 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<--- ReleaseAdapter\n");

924 
	}
}

944 
NDIS_STATUS
 
	$RTMPInôAd≠ãrBlock
(

945 
IN
 
PRTMP_ADAPTER
 
pAd
)

947 
NDIS_STATUS
 
Sètus
=
NDIS_STATUS_SUCCESS
;

948 
UINT
 
i
;

949 
PCmdQElmt
 
cmdqñmt
;

951 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "--> RTMPInitAdapterBlock\n");

954 
pAd
->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
vv
.
LowP¨t
 = 0;

955 
pAd
->
WœnCou¡îs
.
Mu…iˇ°TønsmôãdFømeCou¡
.
vv
.
LowP¨t
 =0;

956 
pAd
->
WœnCou¡îs
.
FaûedCou¡
.
vv
.
LowP¨t
 =0;

957 
pAd
->
WœnCou¡îs
.
NoRëryCou¡
.
vv
.
LowP¨t
 =0;

958 
pAd
->
WœnCou¡îs
.
RëryCou¡
.
vv
.
LowP¨t
 =0;

959 
pAd
->
WœnCou¡îs
.
Mu…ùÀRëryCou¡
.
vv
.
LowP¨t
 =0;

960 
pAd
->
WœnCou¡îs
.
RTSSuc˚ssCou¡
.
vv
.
LowP¨t
 =0;

961 
pAd
->
WœnCou¡îs
.
RTSFaûuªCou¡
.
vv
.
LowP¨t
 =0;

962 
pAd
->
WœnCou¡îs
.
ACKFaûuªCou¡
.
vv
.
LowP¨t
 =0;

963 
pAd
->
WœnCou¡îs
.
FømeDu∂iˇãCou¡
.
vv
.
LowP¨t
 =0;

964 
pAd
->
WœnCou¡îs
.
Re˚ivedFøgmítCou¡
.
vv
.
LowP¨t
 =0;

965 
pAd
->
WœnCou¡îs
.
Mu…iˇ°Re˚ivedFømeCou¡
.
vv
.
LowP¨t
 =0;

966 
pAd
->
WœnCou¡îs
.
FCSEº‹Cou¡
.
vv
.
LowP¨t
 =0;

968 
pAd
->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
vv
.
HighP¨t
 = 0;

969 
pAd
->
WœnCou¡îs
.
Mu…iˇ°TønsmôãdFømeCou¡
.
vv
.
HighP¨t
 =0;

970 
pAd
->
WœnCou¡îs
.
FaûedCou¡
.
vv
.
HighP¨t
 =0;

971 
pAd
->
WœnCou¡îs
.
NoRëryCou¡
.
vv
.
HighP¨t
 =0;

972 
pAd
->
WœnCou¡îs
.
RëryCou¡
.
vv
.
HighP¨t
 =0;

973 
pAd
->
WœnCou¡îs
.
Mu…ùÀRëryCou¡
.
vv
.
HighP¨t
 =0;

974 
pAd
->
WœnCou¡îs
.
RTSSuc˚ssCou¡
.
vv
.
HighP¨t
 =0;

975 
pAd
->
WœnCou¡îs
.
RTSFaûuªCou¡
.
vv
.
HighP¨t
 =0;

976 
pAd
->
WœnCou¡îs
.
ACKFaûuªCou¡
.
vv
.
HighP¨t
 =0;

977 
pAd
->
WœnCou¡îs
.
FømeDu∂iˇãCou¡
.
vv
.
HighP¨t
 =0;

978 
pAd
->
WœnCou¡îs
.
Re˚ivedFøgmítCou¡
.
vv
.
HighP¨t
 =0;

979 
pAd
->
WœnCou¡îs
.
Mu…iˇ°Re˚ivedFømeCou¡
.
vv
.
HighP¨t
 =0;

980 
pAd
->
WœnCou¡îs
.
FCSEº‹Cou¡
.
vv
.
HighP¨t
 =0;

982 
pAd
->
MacRegWrôe_Pro˚ssög
=0;

985 
i
 = 0; i < 
COMMAND_QUEUE_SIZE
; i++)

987 
cmdqñmt
 = &(
pAd
->
CmdQEÀmíts
[
i
]);

988 
	`NdisZîoMem‹y
(
cmdqñmt
, (
CmdQElmt
));

989 
cmdqñmt
->
buf„r
 = 
NULL
;

990 
cmdqñmt
->
CmdFromNdis
 = 
FALSE
;

991 
cmdqñmt
->
InU£
 = 
FALSE
;

993 
	`RTUSBInôülizeCmdQ
(&
pAd
->
CmdQ
);

995 
	`öô_MUTEX
(&(
pAd
->
usbdev_£m≠h‹e
));

996 
	`öô_MUTEX_LOCKED
(&(
pAd
->
mlme_£m≠h‹e
));

997 
	`öô_MUTEX_LOCKED
(&(
pAd
->
RTUSBCmd_£m≠h‹e
));

999 
	`öô_MUTEX_LOCKED
(&(
pAd
->
MaCRegWrôe_£m≠h‹e
));

1000 
	`öô_com∂ëi⁄
 (&
pAd
->
MlmeThªadNŸify
);

1001 
	`öô_com∂ëi⁄
 (&
pAd
->
CmdThªadNŸify
);

1004 
	`RTUSBMacRegUp
(
pAd
);

1007 
	`NdisAŒoˇãSpöLock
(&
pAd
->
MLMEQLock
);

1008 
	`NdisAŒoˇãSpöLock
(&
pAd
->
BulkOutLock
[0]);

1009 
	`NdisAŒoˇãSpöLock
(&
pAd
->
BulkOutLock
[1]);

1010 
	`NdisAŒoˇãSpöLock
(&
pAd
->
BulkOutLock
[2]);

1011 
	`NdisAŒoˇãSpöLock
(&
pAd
->
BulkOutLock
[3]);

1012 
	`NdisAŒoˇãSpöLock
(&
pAd
->
CmdQLock
);

1013 
	`NdisAŒoˇãSpöLock
(&
pAd
->
SídTxWaôQueueLock
[0]);

1014 
	`NdisAŒoˇãSpöLock
(&
pAd
->
SídTxWaôQueueLock
[1]);

1015 
	`NdisAŒoˇãSpöLock
(&
pAd
->
SídTxWaôQueueLock
[2]);

1016 
	`NdisAŒoˇãSpöLock
(&
pAd
->
SídTxWaôQueueLock
[3]);

1017 
	`NdisAŒoˇãSpöLock
(&
pAd
->
DeQueueLock
[0]);

1018 
	`NdisAŒoˇãSpöLock
(&
pAd
->
DeQueueLock
[1]);

1019 
	`NdisAŒoˇãSpöLock
(&
pAd
->
DeQueueLock
[2]);

1020 
	`NdisAŒoˇãSpöLock
(&
pAd
->
DeQueueLock
[3]);

1021 
	`NdisAŒoˇãSpöLock
(&
pAd
->
D©aQLock
[0]);

1022 
	`NdisAŒoˇãSpöLock
(&
pAd
->
D©aQLock
[1]);

1023 
	`NdisAŒoˇãSpöLock
(&
pAd
->
D©aQLock
[2]);

1024 
	`NdisAŒoˇãSpöLock
(&
pAd
->
D©aQLock
[3]);

1026 
	`NdisAŒoˇãSpöLock
(&
pAd
->
MLMEWaôQueueLock
);

1027 
	`NdisAŒoˇãSpöLock
(&
pAd
->
DeMGMTQueueLock
);

1029 
	`NdisAŒoˇãSpöLock
(&
pAd
->
TxRögLock
);

1031 } 
FALSE
);

1033 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<-- RTMPInitAdapterBlock\n");

1035  
Sètus
;

1036 
	}
}

1038 
NDIS_STATUS
 
	$RTUSBWrôeHWMACAddªss
(

1039 
IN
 
PRTMP_ADAPTER
 
pAd
)

1041 
MAC_CSR2_STRUC
 
SèMacReg0
;

1042 
MAC_CSR3_STRUC
 
SèMacReg1
;

1043 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

1045 i‡(
pAd
->
bLoˇlAdmöMAC
 !
TRUE
)

1047 
pAd
->
CuºítAddªss
[0] =ÖAd->
Pîm™ítAddªss
[0];

1048 
pAd
->
CuºítAddªss
[1] =ÖAd->
Pîm™ítAddªss
[1];

1049 
pAd
->
CuºítAddªss
[2] =ÖAd->
Pîm™ítAddªss
[2];

1050 
pAd
->
CuºítAddªss
[3] =ÖAd->
Pîm™ítAddªss
[3];

1051 
pAd
->
CuºítAddªss
[4] =ÖAd->
Pîm™ítAddªss
[4];

1052 
pAd
->
CuºítAddªss
[5] =ÖAd->
Pîm™ítAddªss
[5];

1055 
SèMacReg0
.
fõld
.
Byã0
 = 
pAd
->
CuºítAddªss
[0];

1056 
SèMacReg0
.
fõld
.
Byã1
 = 
pAd
->
CuºítAddªss
[1];

1057 
SèMacReg0
.
fõld
.
Byã2
 = 
pAd
->
CuºítAddªss
[2];

1058 
SèMacReg0
.
fõld
.
Byã3
 = 
pAd
->
CuºítAddªss
[3];

1059 
SèMacReg1
.
fõld
.
Byã4
 = 
pAd
->
CuºítAddªss
[4];

1060 
SèMacReg1
.
fõld
.
Byã5
 = 
pAd
->
CuºítAddªss
[5];

1061 
SèMacReg1
.
fõld
.
U2MeMask
 = 0xff;

1063 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "Local MAC = %02x:%02x:%02x:%02x:%02x:%02x\n",

1064 
pAd
->
CuºítAddªss
[0],ÖAd->CurrentAddress[1],ÖAd->CurrentAddress[2],

1065 
pAd
->
CuºítAddªss
[3],ÖAd->CurrentAddress[4],ÖAd->CurrentAddress[5]);

1067 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR2
, 
SèMacReg0
.
w‹d
);

1068 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR3
, 
SèMacReg1
.
w‹d
);

1070  
Sètus
;

1071 
	}
}

1089 
VOID
 
	$NICRódEEPROMP¨amëîs
(

1090 
IN
 
PRTMP_ADAPTER
 
pAd
)

1092 
USHORT
 
i
, 
vÆue
, 
vÆue2
;

1093 
EEPROM_ANTENNA_STRUC
 
A¡í«
;

1094 
EEPROM_VERSION_STRUC
 
Vîsi⁄
;

1095 
CHAR
 
Ch™√lTxPowî
[
MAX_NUM_OF_CHANNELS
];

1096 
EEPROM_LED_STRUC
 
LedSëtög
;

1097 
UCHAR
 
MacAddr
[
MAC_ADDR_LEN
];

1098 
UCHAR
 
DeÁu…VÆue
[2*
NUM_EEPROM_BBP_PARMS
];

1100 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "--> NICReadEEPROMParameters\n");

1103 
	`RTUSBRódEEPROM
(
pAd
, 
EEPROM_MAC_ADDRESS_BASE_OFFSET
, 
MacAddr
, 
MAC_ADDR_LEN
);

1104 
	`NdisMoveMem‹y
–
pAd
->
Pîm™ítAddªss
, 
MacAddr
, 
MAC_ADDR_LEN
);

1105 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "Local MAC = %02x:%02x:%02x:%02x:%02x:%02x\n",

1106 
pAd
->
Pîm™ítAddªss
[0],ÖAd->PermanentAddress[1],ÖAd->PermanentAddress[2],

1107 
pAd
->
Pîm™ítAddªss
[3],ÖAd->PermanentAddress[4],ÖAd->PermanentAddress[5]);

1111 
i
 = 0; i < 14; i++)

1112 
pAd
->
TxPowî
[
i
].
Ch™√l
 = i + 1;

1114 
i
 = 0; i < 8; i++)

1115 
pAd
->
TxPowî
[
i
 + 14].
Ch™√l
 = 36 + i * 4;

1117 
i
 = 0; i < 11; i++)

1118 
pAd
->
TxPowî
[
i
 + 22].
Ch™√l
 = 100 + i * 4;

1120 
i
 = 0; i < 5; i++)

1121 
pAd
->
TxPowî
[
i
 + 33].
Ch™√l
 = 149 + i * 4;

1124 
i
 = 0; i < 4; i++)

1125 
pAd
->
TxPowî
[
i
 + 38].
Ch™√l
 = 34 + i * 4;

1129 
	`RTUSBRódEEPROM
(
pAd
, 
EEPROM_VERSION_OFFSET
, (
PUCHAR
)&
Vîsi⁄
.
w‹d
, 2);

1130 
pAd
->
EïromVîsi⁄
 = 
Vîsi⁄
.
fõld
.Vîsi⁄ + Vîsi⁄.fõld.
F´Rñó£Numbî
 * 256;

1131 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "E2PROM: Vîsi⁄ = %d, FAEÑñó£ #%d\n", 
Vîsi⁄
.
fõld
.Vîsi⁄, Vîsi⁄.fõld.
F´Rñó£Numbî
);

1134 
	`RTUSBRódEEPROM
(
pAd
, 
EEPROM_BBP_BASE_OFFSET
, 
DeÁu…VÆue
, 2 * 
NUM_EEPROM_BBP_PARMS
);

1135 
	`NdisMoveMem‹y
((
PUCHAR
)(
pAd
->
EEPROMDeÁu…VÆue
), 
DeÁu…VÆue
, 2 * 
NUM_EEPROM_BBP_PARMS
);

1142 #ifde‡
BIG_ENDIAN


1143 
A¡í«
.
w‹d
 = 
	`SWAP16
(
pAd
->
EEPROMDeÁu…VÆue
[0]);

1145 
A¡í«
.
w‹d
 = 
pAd
->
EEPROMDeÁu…VÆue
[0];

1148 i‡(
A¡í«
.
fõld
.
Dy«micTxAgcC⁄åﬁ
 == 1)

1149 
pAd
->
bAutoTxAgcA
 =ÖAd->
bAutoTxAgcG
 = 
TRUE
;

1151 
pAd
->
bAutoTxAgcA
 =ÖAd->
bAutoTxAgcG
 = 
FALSE
;

1156 i‡((
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11ABG_MIXED
Ë|| (pAd->P‹tCfg.PhyModê=
PHY_11A
))

1161 i‡((
A¡í«
.
fõld
.
RfIcTy≥
 =
RFIC_2528
Ë|| (A¡í«.fõld.RfIcTy≥ =
RFIC_2527
) ||

1162 (
A¡í«
.
fõld
.
RfIcTy≥
 =
RFIC_3020
))

1163 
pAd
->
P‹tCfg
.
PhyMode
 = 
PHY_11BG_MIXED
;

1168 i‡((
pAd
->
P‹tCfg
.
AdhocMode
 =
ADHOC_11A
Ë|| (pAd->P‹tCfg.AdhocModê=
ADHOC_11ABG_MIXED
))

1173 i‡((
A¡í«
.
fõld
.
RfIcTy≥
 =
RFIC_2528
Ë|| (A¡í«.fõld.RfIcTy≥ =
RFIC_2527
) ||

1174 (
A¡í«
.
fõld
.
RfIcTy≥
 =
RFIC_3020
))

1175 
pAd
->
P‹tCfg
.
AdhocMode
 = 
ADHOC_11BG_MIXED
;

1185 
	`RTUSBRódEEPROM
(
pAd
, 
EEPROM_G_TX_PWR_OFFSET
, 
Ch™√lTxPowî
, 2 * 
NUM_EEPROM_TX_G_PARMS
);

1186 
i
 = 0; i < 2 * 
NUM_EEPROM_TX_G_PARMS
; i++)

1188 i‡((
Ch™√lTxPowî
[
i
] > 36) || (ChannelTxPower[i] < -6))

1189 
pAd
->
TxPowî
[
i
].
Powî
 = 24;

1191 
pAd
->
TxPowî
[
i
].
Powî
 = 
Ch™√lTxPowî
[i];

1193 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "TxÖowî f‹ ch™√»%d : %0x\n", 
pAd
->
TxPowî
[
i
].
Ch™√l
,ÖAd->TxPowî[i].
Powî
);

1198 
	`RTUSBRódEEPROM
(
pAd
, 
EEPROM_A_TX_PWR_OFFSET
, 
Ch™√lTxPowî
, 
MAX_NUM_OF_A_CHANNELS
);

1199 
i
 = 0; i < 
MAX_NUM_OF_A_CHANNELS
; i++)

1201 i‡((
Ch™√lTxPowî
[
i
] > 36) || (ChannelTxPower[i] < -6))

1202 
pAd
->
TxPowî
[
i
 + 14].
Powî
 = 24;

1204 
pAd
->
TxPowî
[
i
 + 14].
Powî
 = 
Ch™√lTxPowî
[i];

1205 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "TxÖowî f‹ ch™√»%d : %0x\n", 
pAd
->
TxPowî
[
i
 + 14].
Ch™√l
,ÖAd->TxPowî[ò+ 14].
Powî
);

1213 
	`RTUSBRódEEPROM
(
pAd
, 
EEPROM_J52_TX_PWR_OFFSET
, 
Ch™√lTxPowî
, 6);

1215 
i
 = 0; i < 4; i++)

1217 
	`ASSERT
(
pAd
->
TxPowî
[
J52_CHANNEL_START_OFFSET
 + 
i
].
Ch™√l
 == 34 + i * 4);

1218 i‡((
Ch™√lTxPowî
[
i
] > 36) || (ChannelTxPower[i] < -6))

1219 
pAd
->
TxPowî
[
J52_CHANNEL_START_OFFSET
 + 
i
].
Powî
 = 24;

1221 
pAd
->
TxPowî
[
J52_CHANNEL_START_OFFSET
 + 
i
].
Powî
 = 
Ch™√lTxPowî
[i + 1];

1223 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "TxÖowî f‹ ch™√»%d : %0x\n", 
pAd
->
TxPowî
[
J52_CHANNEL_START_OFFSET
 + 
i
].
Ch™√l
,ÖAd->TxPowî[J52_CHANNEL_START_OFFSET + i].
Powî
);

1229 
	`RTUSBRódEEPROM
(
pAd
, 
EEPROM_BG_TSSI_CALIBRAION
, 
Ch™√lTxPowî
, 10);

1230 
pAd
->
TssiMöusBound¨yG
[4] = 
Ch™√lTxPowî
[0];

1231 
pAd
->
TssiMöusBound¨yG
[3] = 
Ch™√lTxPowî
[1];

1232 
pAd
->
TssiMöusBound¨yG
[2] = 
Ch™√lTxPowî
[2];

1233 
pAd
->
TssiMöusBound¨yG
[1] = 
Ch™√lTxPowî
[3];

1234 
pAd
->
TssiPlusBound¨yG
[1] = 
Ch™√lTxPowî
[4];

1235 
pAd
->
TssiPlusBound¨yG
[2] = 
Ch™√lTxPowî
[5];

1236 
pAd
->
TssiPlusBound¨yG
[3] = 
Ch™√lTxPowî
[6];

1237 
pAd
->
TssiPlusBound¨yG
[4] = 
Ch™√lTxPowî
[7];

1238 
pAd
->
TssiRefG
 = 
Ch™√lTxPowî
[8];

1239 
pAd
->
TxAgcSãpG
 = 
Ch™√lTxPowî
[9];

1240 
pAd
->
TxAgcCom≥nßãG
 = 0;

1241 
pAd
->
TssiMöusBound¨yG
[0] =ÖAd->
TssiRefG
;

1242 
pAd
->
TssiPlusBound¨yG
[0] =ÖAd->
TssiRefG
;

1245 i‡(
pAd
->
TssiRefG
 == 0xff)

1246 
pAd
->
bAutoTxAgcG
 = 
FALSE
;

1248 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"E2PROM: G Tssi[-4 .. +4] = %d %d %d %d - %d -%d %d %d %d, step=%d,Åuning=%d\n",

1249 
pAd
->
TssiMöusBound¨yG
[4],ÖAd->TssiMinusBoundaryG[3],ÖAd->TssiMinusBoundaryG[2],ÖAd->TssiMinusBoundaryG[1],

1250 
pAd
->
TssiRefG
,

1251 
pAd
->
TssiPlusBound¨yG
[1],ÖAd->TssiPlusBoundaryG[2],ÖAd->TssiPlusBoundaryG[3],ÖAd->TssiPlusBoundaryG[4],

1252 
pAd
->
TxAgcSãpG
,ÖAd->
bAutoTxAgcG
);

1256 
	`RTUSBRódEEPROM
(
pAd
, 
EEPROM_A_TSSI_CALIBRAION
, 
Ch™√lTxPowî
, 10);

1257 
pAd
->
TssiMöusBound¨yA
[4] = 
Ch™√lTxPowî
[0];

1258 
pAd
->
TssiMöusBound¨yA
[3] = 
Ch™√lTxPowî
[1];

1259 
pAd
->
TssiMöusBound¨yA
[2] = 
Ch™√lTxPowî
[2];

1260 
pAd
->
TssiMöusBound¨yA
[1] = 
Ch™√lTxPowî
[3];

1261 
pAd
->
TssiPlusBound¨yA
[1] = 
Ch™√lTxPowî
[4];

1262 
pAd
->
TssiPlusBound¨yA
[2] = 
Ch™√lTxPowî
[5];

1263 
pAd
->
TssiPlusBound¨yA
[3] = 
Ch™√lTxPowî
[6];

1264 
pAd
->
TssiPlusBound¨yA
[4] = 
Ch™√lTxPowî
[7];

1265 
pAd
->
TssiRefA
 = 
Ch™√lTxPowî
[8];

1266 
pAd
->
TxAgcSãpA
 = 
Ch™√lTxPowî
[9];

1267 
pAd
->
TxAgcCom≥nßãA
 = 0;

1268 
pAd
->
TssiMöusBound¨yA
[0] =ÖAd->
TssiRefA
;

1269 
pAd
->
TssiPlusBound¨yA
[0] =ÖAd->
TssiRefA
;

1272 i‡(
pAd
->
TssiRefA
 == 0xff)

1273 
pAd
->
bAutoTxAgcA
 = 
FALSE
;

1275 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"E2PROM: A Tssi[-4 .. +4] = %d %d %d %d - %d -%d %d %d %d, step=%d,Åuning=%d\n",

1276 
pAd
->
TssiMöusBound¨yA
[4],ÖAd->TssiMinusBoundaryA[3],ÖAd->TssiMinusBoundaryA[2],ÖAd->TssiMinusBoundaryA[1],

1277 
pAd
->
TssiRefA
,

1278 
pAd
->
TssiPlusBound¨yA
[1],ÖAd->TssiPlusBoundaryA[2],ÖAd->TssiPlusBoundaryA[3],ÖAd->TssiPlusBoundaryA[4],

1279 
pAd
->
TxAgcSãpA
,ÖAd->
bAutoTxAgcA
);

1281 
pAd
->
BbpRssiToDbmDñè
 = 0x79;

1283 
	`RTUSBRódEEPROM
(
pAd
, 
EEPROM_FREQ_OFFSET
, (
PUCHAR
Ë&
vÆue
, 2);

1284 i‡((
vÆue
 & 0xFF00) == 0xFF00)

1286 
pAd
->
RFProgSeq
 = 0;

1290 
pAd
->
RFProgSeq
 = (
vÆue
 & 0x0300) >> 8;

1293 
vÆue
 &= 0x00FF;

1294 i‡(
vÆue
 != 0x00FF)

1295 
pAd
->
RfFªqOff£t
 = (
ULONG
Ë
vÆue
;

1297 
pAd
->
RfFªqOff£t
 = 0;

1298 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "E2PROM: RF fªq off£t=0x%x\n", 
pAd
->
RfFªqOff£t
);

1301 
vÆue
 = 
pAd
->
EEPROMDeÁu…VÆue
[2] >> 8;

1302 
vÆue2
 = 
pAd
->
EEPROMDeÁu…VÆue
[2] & 0x00FF;

1303 i‡((
vÆue
 <
REGION_MAXIMUM_BG_BAND
Ë&& (
vÆue2
 <
REGION_MAXIMUM_A_BAND
))

1305 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄
 = ((
UCHAR
Ë
vÆue
) | 0x80;

1306 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄F‹AB™d
 = ((
UCHAR
Ë
vÆue2
) | 0x80;

1313 
	`RTUSBRódEEPROM
(
pAd
, 
EEPROM_RSSI_BG_OFFSET
, (
PUCHAR
Ë&
vÆue
, 2);

1314 
pAd
->
BGRssiOff£t1
 = 
vÆue
 & 0x00ff;

1315 
pAd
->
BGRssiOff£t2
 = (
vÆue
 >> 8);

1318 i‡((
pAd
->
BGRssiOff£t1
 < -10) || (pAd->BGRssiOffset1 > 10))

1319 
pAd
->
BGRssiOff£t1
 = 0;

1322 i‡((
pAd
->
BGRssiOff£t2
 < -10) || (pAd->BGRssiOffset2 > 10))

1323 
pAd
->
BGRssiOff£t2
 = 0;

1325 
	`RTUSBRódEEPROM
(
pAd
, 
EEPROM_RSSI_A_OFFSET
, (
PUCHAR
Ë&
vÆue
, 2);

1326 
pAd
->
ARssiOff£t1
 = 
vÆue
 & 0x00ff;

1327 
pAd
->
ARssiOff£t2
 = (
vÆue
 >> 8);

1330 i‡((
pAd
->
ARssiOff£t1
 < -10) || (pAd->ARssiOffset1 > 10))

1331 
pAd
->
ARssiOff£t1
 = 0;

1334 i‡((
pAd
->
ARssiOff£t2
 < -10) || (pAd->ARssiOffset2 > 10))

1335 
pAd
->
ARssiOff£t2
 = 0;

1340 
	`RTUSBRódEEPROM
(
pAd
, 
EEPROM_LED_OFFSET
, (
PUCHAR
)&
LedSëtög
.
w‹d
, 2);

1341 i‡(
LedSëtög
.
w‹d
 == 0xFFFF)

1346 
LedSëtög
.
fõld
.
Pﬁ¨ôyRDY_G
 = 0;

1347 
LedSëtög
.
fõld
.
Pﬁ¨ôyRDY_A
 = 0;

1348 
LedSëtög
.
fõld
.
Pﬁ¨ôyACT
 = 0;

1349 
LedSëtög
.
fõld
.
Pﬁ¨ôyGPIO_0
 = 0;

1350 
LedSëtög
.
fõld
.
Pﬁ¨ôyGPIO_1
 = 0;

1351 
LedSëtög
.
fõld
.
Pﬁ¨ôyGPIO_2
 = 0;

1352 
LedSëtög
.
fõld
.
Pﬁ¨ôyGPIO_3
 = 0;

1353 
LedSëtög
.
fõld
.
Pﬁ¨ôyGPIO_4
 = 0;

1354 
LedSëtög
.
fõld
.
LedMode
 = 
LED_MODE_DEFAULT
;

1356 
pAd
->
LedC¡l
.
w‹d
 = 0;

1357 
pAd
->
LedC¡l
.
fõld
.
LedMode
 = 
LedSëtög
.field.LedMode;

1358 
pAd
->
LedC¡l
.
fõld
.
Pﬁ¨ôyRDY_G
 = 
LedSëtög
.field.PolarityRDY_G;

1359 
pAd
->
LedC¡l
.
fõld
.
Pﬁ¨ôyRDY_A
 = 
LedSëtög
.field.PolarityRDY_A;

1360 
pAd
->
LedC¡l
.
fõld
.
Pﬁ¨ôyACT
 = 
LedSëtög
.field.PolarityACT;

1361 
pAd
->
LedC¡l
.
fõld
.
Pﬁ¨ôyGPIO_0
 = 
LedSëtög
.field.PolarityGPIO_0;

1362 
pAd
->
LedC¡l
.
fõld
.
Pﬁ¨ôyGPIO_1
 = 
LedSëtög
.field.PolarityGPIO_1;

1363 
pAd
->
LedC¡l
.
fõld
.
Pﬁ¨ôyGPIO_2
 = 
LedSëtög
.field.PolarityGPIO_2;

1364 
pAd
->
LedC¡l
.
fõld
.
Pﬁ¨ôyGPIO_3
 = 
LedSëtög
.field.PolarityGPIO_3;

1365 
pAd
->
LedC¡l
.
fõld
.
Pﬁ¨ôyGPIO_4
 = 
LedSëtög
.field.PolarityGPIO_4;

1367 
	`RTUSBRódEEPROM
(
pAd
, 
EEPROM_TXPOWER_DELTA_OFFSET
, (
PUCHAR
)&
vÆue
, 2);

1368 
vÆue
 = value & 0x00ff;

1369 i‡(
vÆue
 != 0xff)

1371 
pAd
->
TxPowîDñèC⁄fig
.
vÆue
 = (
UCHAR
) value;

1372 i‡(
pAd
->
TxPowîDñèC⁄fig
.
fõld
.
DñèVÆue
 > 0x04)

1373 
pAd
->
TxPowîDñèC⁄fig
.
fõld
.
DñèVÆue
 = 0x04;

1376 
pAd
->
TxPowîDñèC⁄fig
.
fõld
.
TxPowîE«bÀ
 = 
FALSE
;

1378 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<-- NICReadEEPROMParameters\n");

1379 
	}
}

1397 
VOID
 
	$NICInôAsicFromEEPROM
(

1398 
IN
 
PRTMP_ADAPTER
 
pAd
)

1400 
ULONG
 
d©a
;

1401 
USHORT
 
i
;

1402 
ULONG
 
MiscMode
;

1403 
EEPROM_ANTENNA_STRUC
 
A¡í«
;

1404 
EEPROM_NIC_CONFIG2_STRUC
 
NicC⁄fig2
;

1406 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "--> NICInitAsicFromEEPROM\n");

1408 
i
 = 3; i < 
NUM_EEPROM_BBP_PARMS
; i++)

1410 
UCHAR
 
BbpRegIdx
, 
BbpVÆue
;

1412 i‡((
pAd
->
EEPROMDeÁu…VÆue
[
i
] != 0xFFFF) && (pAd->EEPROMDefaultValue[i] != 0))

1414 
BbpRegIdx
 = (
UCHAR
)(
pAd
->
EEPROMDeÁu…VÆue
[
i
] >> 8);

1415 
BbpVÆue
 = (
UCHAR
)(
pAd
->
EEPROMDeÁu…VÆue
[
i
] & 0xff);

1416 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BbpRegIdx
, 
BbpVÆue
);

1420 #ifde‡
BIG_ENDIAN


1421 
A¡í«
.
w‹d
 = 
	`SWAP16
(
pAd
->
EEPROMDeÁu…VÆue
[0]);

1423 
A¡í«
.
w‹d
 = 
pAd
->
EEPROMDeÁu…VÆue
[0];

1426 i‡(
A¡í«
.
w‹d
 == 0xFFFF)

1428 
A¡í«
.
w‹d
 = 0;

1429 
A¡í«
.
fõld
.
RfIcTy≥
 = 
RFIC_5226
;

1430 
A¡í«
.
fõld
.
H¨dw¨eRadioC⁄åﬁ
 = 0;

1431 
A¡í«
.
fõld
.
Dy«micTxAgcC⁄åﬁ
 = 0;

1432 
A¡í«
.
fõld
.
FømeTy≥
 = 0;

1433 
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 = 2;

1434 
A¡í«
.
fõld
.
TxDeÁu…A¡í«
 = 2;

1435 
A¡í«
.
fõld
.
NumOfA¡í«
 = 2;

1436 
	`DBGPRINT
(
RT_DEBUG_WARN
, "E2PROMÉº‹, h¨d codêa†0x%04x\n", 
A¡í«
.
w‹d
);

1439 
pAd
->
RfIcTy≥
 = (
UCHAR
Ë
A¡í«
.
fõld
.RfIcType;

1440 
	`DBGPRINT
(
RT_DEBUG_WARN
, "pAd->RfIcTy≥ = %d\n", 
pAd
->
RfIcTy≥
);

1446 i‡((
pAd
->
RfIcTy≥
 =
RFIC_5225
Ë|| (pAd->RfIcTy≥ =
RFIC_2527
Ë|| (pAd->RfIcTy≥ =
RFIC_3020
))

1448 
	`RTUSBRódMACRegi°î
(
pAd
, 
PHY_CSR1
, &
MiscMode
);

1449 
MiscMode
 |= 0x10000;

1450 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
PHY_CSR1
, 
MiscMode
);

1454 
pAd
->
A¡í«
.
w‹d
 = Antenna.word;

1457 i‡(
A¡í«
.
fõld
.
H¨dw¨eRadioC⁄åﬁ
 == 1)

1459 
pAd
->
P‹tCfg
.
bH¨dw¨eRadio
 = 
TRUE
;

1462 
	`RTUSBRódMACRegi°î
(
pAd
, 
MAC_CSR13
, &
d©a
);

1468 i‡((
d©a
 & 0x80) == 0)

1470 
pAd
->
P‹tCfg
.
bHwRadio
 = 
FALSE
;

1472 
pAd
->
ExåaInfo
 = 
HW_RADIO_OFF
;

1476 
pAd
->
P‹tCfg
.
bH¨dw¨eRadio
 = 
FALSE
;

1478 
pAd
->
P‹tCfg
.
bRadio
 =ÖAd->P‹tCfg.
bSwRadio
 &&ÖAd->P‹tCfg.
bHwRadio
;

1480 i‡(
pAd
->
P‹tCfg
.
bRadio
 =
FALSE
)

1482 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR10
, 0x00001818);

1483 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
);

1485 
	`RTMPSëLED
(
pAd
, 
LED_RADIO_OFF
);

1489 
	`RTMPSëLED
(
pAd
, 
LED_RADIO_ON
);

1492 #ifde‡
BIG_ENDIAN


1493 
NicC⁄fig2
.
w‹d
 = 
	`SWAP16
(
pAd
->
EEPROMDeÁu…VÆue
[1]);

1495 
NicC⁄fig2
.
w‹d
 = 
pAd
->
EEPROMDeÁu…VÆue
[1];

1497 i‡(
NicC⁄fig2
.
w‹d
 == 0xffff)

1499 
NicC⁄fig2
.
w‹d
 = 0;

1502 
pAd
->
NicC⁄fig2
.
w‹d
 = NicConfig2.word;

1504 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Use Hw Radio Control Pin=%d; if used Pin=%d;\n",

1505 
pAd
->
P‹tCfg
.
bH¨dw¨eRadio
,ÖAd->PortCfg.bHardwareRadio);

1507 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RFIC=%d, LED mode=%d\n", 
pAd
->
RfIcTy≥
,ÖAd->
LedC¡l
.
fõld
.
LedMode
);

1509 
pAd
->
P‹tCfg
.
B™dSèã
 = 
UNKNOWN_BAND
;

1511 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<-- NICInitAsicFromEEPROM\n");

1512 
	}
}

1530 
NDIS_STATUS
 
	$NICInôülizeAsic
(

1531 
IN
 
PRTMP_ADAPTER
 
pAd
)

1533 
ULONG
 
Index
, 
Cou¡î
;

1534 
UCHAR
 
VÆue
 = 0xff;

1535 
ULONG
 
Vîsi⁄
;

1536 
MAC_CSR12_STRUC
 
MacC§12
;

1538 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "--> NICInitializeAsic\n");

1540 
	`RTUSBRódMACRegi°î
(
pAd
, 
MAC_CSR0
, &
Vîsi⁄
);

1543 
Index
 = 0; Index < 
NUM_MAC_REG_PARMS
; Index++)

1545 
	`RTUSBWrôeMACRegi°î
(
pAd
, (
USHORT
)
MACRegTabÀ
[
Index
].
Regi°î
, MACRegTabÀ[Index].
VÆue
);

1549 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR1
, 0x3);

1550 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR1
, 0x0);

1555 
Index
 = 0;

1558 
	`RTUSBRódMACRegi°î
(
pAd
, 
MAC_CSR12
, &
MacC§12
.
w‹d
);

1560 i‡(
MacC§12
.
fõld
.
BbpRfSètus
 == 1)

1563 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR12
, 0x4);

1564 
	`RTMPu£cDñay
(1000);

1565 } 
Index
++ < 1000);

1568 
Index
 = 0;

1571 
	`RTUSBRódBBPRegi°î
(
pAd
, 
BBP_R0
, &
VÆue
);

1572 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "BBP vîsi⁄ = %d\n", 
VÆue
);

1573 } (++
Index
 < 100Ë&& ((
VÆue
 == 0xff) || (Value == 0x00)));

1576 
Index
 = 0; Index < 
NUM_BBP_REG_PARMS
; Index++)

1578 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBPRegTabÀ
[
Index
].
Regi°î
, BBPRegTabÀ[Index].
VÆue
);

1582 
	`RTUSBRódMACRegi°î
(
pAd
, 
STA_CSR0
, &
Cou¡î
);

1583 
	`RTUSBRódMACRegi°î
(
pAd
, 
STA_CSR1
, &
Cou¡î
);

1584 
	`RTUSBRódMACRegi°î
(
pAd
, 
STA_CSR2
, &
Cou¡î
);

1587 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR1
, 0x4);

1589 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<-- NICInitializeAsic\n");

1591  
NDIS_STATUS_SUCCESS
;

1592 
	}
}

1611 
VOID
 
	$NICIssueRe£t
(

1612 
IN
 
PRTMP_ADAPTER
 
pAd
)

1615 
	}
}

1631 
BOOLEAN
 
	$NICCheckF‹H™g
(

1632 
IN
 
PRTMP_ADAPTER
 
pAd
)

1634  (
FALSE
);

1635 
	}
}

1653 
VOID
 
	$NICUpd©eRawCou¡îs
(

1654 
IN
 
PRTMP_ADAPTER
 
pAd
)

1656 
ULONG
 
OldVÆue
;

1657 
STA_CSR0_STRUC
 
SèC§0
;

1658 
STA_CSR1_STRUC
 
SèC§1
;

1659 
STA_CSR2_STRUC
 
SèC§2
;

1660 
STA_CSR3_STRUC
 
SèC§3
;

1661 
STA_CSR4_STRUC
 
SèC§4
;

1662 
STA_CSR5_STRUC
 
SèC§5
;

1664 
	`RTUSBRódMACRegi°î
(
pAd
, 
STA_CSR0
, &
SèC§0
.
w‹d
);

1667 
pAd
->
Priv©eInfo
.
PhyRxEºC¡
 +
SèC§0
.
fõld
.
Pl˝Eº
;

1670 
OldVÆue

pAd
->
WœnCou¡îs
.
FCSEº‹Cou¡
.
vv
.
LowP¨t
;

1671 
pAd
->
WœnCou¡îs
.
FCSEº‹Cou¡
.
vv
.
LowP¨t
 +(
SèC§0
.
fõld
.
CrcEº
);

1672 i‡(
pAd
->
WœnCou¡îs
.
FCSEº‹Cou¡
.
vv
.
LowP¨t
 < 
OldVÆue
)

1673 
pAd
->
WœnCou¡îs
.
FCSEº‹Cou¡
.
vv
.
HighP¨t
++;

1676 
OldVÆue
 = 
pAd
->
RÆökCou¡îs
.
RólFcsEºCou¡
.
vv
.
LowP¨t
;

1677 
pAd
->
RÆökCou¡îs
.
RólFcsEºCou¡
.
vv
.
LowP¨t
 +
SèC§0
.
fõld
.
CrcEº
;

1678 i‡(
pAd
->
RÆökCou¡îs
.
RólFcsEºCou¡
.
vv
.
LowP¨t
 < 
OldVÆue
)

1679 
pAd
->
RÆökCou¡îs
.
RólFcsEºCou¡
.
vv
.
HighP¨t
++;

1683 
	`RTUSBRódMACRegi°î
(
pAd
, 
STA_CSR1
, &
SèC§1
.
w‹d
);

1684 
pAd
->
RÆökCou¡îs
.
O√SecFÆ£CCAC¡
 +
SèC§1
.
fõld
.
FÆ£Cˇ
;

1687 
	`RTUSBRódMACRegi°î
(
pAd
, 
STA_CSR2
, &
SèC§2
.
w‹d
);

1688 
pAd
->
Cou¡îs8023
.
RxNoBuf„r
 +(
SèC§2
.
fõld
.
RxOvîÊowCou¡
 + SèC§2.fõld.
RxFifoOvîÊowCou¡
);

1691 
	`RTUSBRódMACRegi°î
(
pAd
, 
STA_CSR3
, &
SèC§3
.
w‹d
);

1692 
pAd
->
RÆökCou¡îs
.
O√SecBóc⁄SítC¡
 +
SèC§3
.
fõld
.
TxBóc⁄Cou¡
;

1694 
	`RTUSBRódMACRegi°î
(
pAd
, 
STA_CSR4
, &
SèC§4
.
w‹d
);

1695 
	`RTUSBRódMACRegi°î
(
pAd
, 
STA_CSR5
, &
SèC§5
.
w‹d
);

1698 
OldVÆue
 = 
pAd
->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
vv
.
LowP¨t
;

1699 
pAd
->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
vv
.
LowP¨t
 +(
SèC§4
.
fõld
.
TxO√RëryCou¡
 + SèC§4.fõld.
TxNoRëryCou¡
 + 
SèC§5
.fõld.
TxMu…iRëryCou¡
);

1700 i‡(
pAd
->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
vv
.
LowP¨t
 < 
OldVÆue
)

1702 
pAd
->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
vv
.
HighP¨t
++;

1706 
OldVÆue
 = 
pAd
->
WœnCou¡îs
.
RëryCou¡
.
vv
.
LowP¨t
;

1707 
pAd
->
WœnCou¡îs
.
NoRëryCou¡
.
vv
.
LowP¨t
 +
SèC§4
.
fõld
.
TxNoRëryCou¡
;

1708 i‡(
pAd
->
WœnCou¡îs
.
NoRëryCou¡
.
vv
.
LowP¨t
 < 
OldVÆue
)

1710 
pAd
->
WœnCou¡îs
.
NoRëryCou¡
.
vv
.
HighP¨t
++;

1714 
OldVÆue
 = 
pAd
->
WœnCou¡îs
.
RëryCou¡
.
vv
.
LowP¨t
;

1715 
pAd
->
WœnCou¡îs
.
RëryCou¡
.
vv
.
LowP¨t
 +(
SèC§4
.
fõld
.
TxO√RëryCou¡
 +
SèC§5
.fõld.
TxMu…iRëryCou¡
);

1716 i‡(
pAd
->
WœnCou¡îs
.
RëryCou¡
.
vv
.
LowP¨t
 < 
OldVÆue
)

1718 
pAd
->
WœnCou¡îs
.
RëryCou¡
.
vv
.
HighP¨t
++;

1721 
OldVÆue
 = 
pAd
->
WœnCou¡îs
.
FaûedCou¡
.
vv
.
LowP¨t
;

1722 
pAd
->
WœnCou¡îs
.
FaûedCou¡
.
vv
.
LowP¨t
 +
SèC§5
.
fõld
.
TxRëryFaûCou¡
;

1723 i‡(
pAd
->
WœnCou¡îs
.
FaûedCou¡
.
vv
.
LowP¨t
 < 
OldVÆue
)

1725 
pAd
->
WœnCou¡îs
.
FaûedCou¡
.
vv
.
HighP¨t
++;

1729 
pAd
->
RÆökCou¡îs
.
O√SecTxNoRëryOkCou¡
 = 
SèC§4
.
fõld
.
TxNoRëryCou¡
;

1730 
pAd
->
RÆökCou¡îs
.
O√SecTxRëryOkCou¡
 = 
SèC§4
.
fõld
.
TxO√RëryCou¡
 + 
SèC§5
.fõld.
TxMu…iRëryCou¡
;

1731 
pAd
->
RÆökCou¡îs
.
O√SecTxFaûCou¡
 = 
SèC§5
.
fõld
.
TxRëryFaûCou¡
;

1732 
pAd
->
RÆökCou¡îs
.
O√SecFÆ£CCAC¡
 = 
SèC§1
.
fõld
.
FÆ£Cˇ
;

1733 
pAd
->
RÆökCou¡îs
.
O√SecRxOkC¡
 =ÖAd->RÆökCou¡îs.
RxCou¡
;

1734 
pAd
->
RÆökCou¡îs
.
RxCou¡
 = 0;

1735 
pAd
->
RÆökCou¡îs
.
O√SecRxFcsEºC¡
 = 
SèC§0
.
fõld
.
CrcEº
;

1736 
pAd
->
RÆökCou¡îs
.
O√SecBóc⁄SítC¡
 = 
SèC§3
.
fõld
.
TxBóc⁄Cou¡
;

1737 
	}
}

1756 
VOID
 
	$NICRe£tFromEº‹
(

1757 
IN
 
PRTMP_ADAPTER
 
pAd
)

1759 
	`NICInôülizeAsic
(
pAd
);

1760 #ifdef 
INIT_FROM_EEPROM


1761 
	`NICInôAsicFromEEPROM
(
pAd
);

1763 
	`RTUSBWrôeHWMACAddªss
(
pAd
);

1765 
	}
}

1772 
RTMP_OS_FD
 
	$RtmpOSFûeO≥n
(*
pP©h
, 
Êag
, 
mode
)

1774 
fûe
 *
fûePå
;

1776 
fûePå
 = 
	`fûp_›í
(
pP©h
, 
Êag
, 0);

1777 i‡(
	`IS_ERR
(
fûePå
))

1779 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "%s(): Eº‹ %ld o≥nög %s\n", 
__FUNCTION__
, -
	`PTR_ERR
(
fûePå
), 
pP©h
);

1782  (
RTMP_OS_FD
)
fûePå
;

1783 
	}
}

1785 
	$RtmpOSFûeClo£
(
RTMP_OS_FD
 
osfd
)

1787 
	`fûp_˛o£
(
osfd
, 
NULL
);

1789 
	}
}

1792 
	$RtmpOSFûeSìk
(
RTMP_OS_FD
 
osfd
, 
off£t
)

1794 
osfd
->
f_pos
 = 
off£t
;

1795 
	}
}

1798 
	$RtmpOSFûeRód
(
RTMP_OS_FD
 
osfd
, *
pD©aPå
, 
ªadLí
)

1801 i‡(
osfd
->
f_›
 && osfd->f_›->
ªad
)

1803  
osfd
->
f_›
->
	`ªad
(osfd, 
pD©aPå
, 
ªadLí
, &osfd->
f_pos
);

1807 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "no fileÑead method\n");

1810 
	}
}

1813 
	$RtmpOSFûeWrôe
(
RTMP_OS_FD
 
osfd
, *
pD©aPå
, 
wrôeLí
)

1815  
osfd
->
f_›
->
	`wrôe
(osfd, 
pD©aPå
, (
size_t
)
wrôeLí
, &osfd->
f_pos
);

1816 
	}
}

1818 
	$RtmpOSFSInfoCh™ge
(
RTMP_OS_FS_INFO
 *
pOSFSInfo
, 
BOOLEAN
 
bSë
)

1820 i‡(
bSë
)

1824 #i‡
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2,6,29)

1825 
pOSFSInfo
->
fsuid

cuºít
->fsuid;

1826 
pOSFSInfo
->
fsgid
 = 
cuºít
->fsgid;

1827 
cuºít
->
fsuid
 = cuºít->
fsgid
 = 0;

1829 
pOSFSInfo
->
fsuid
 = 
	`cuºít_fsuid
();

1830 
pOSFSInfo
->
fsgid
 = 
	`cuºít_fsgid
();

1832 
pOSFSInfo
->
fs
 = 
	`gë_fs
();

1833 
	`£t_fs
(
KERNEL_DS
);

1837 
	`£t_fs
(
pOSFSInfo
->
fs
);

1838 #i‡
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2,6,29)

1839 
cuºít
->
fsuid
 = 
pOSFSInfo
->fsuid;

1840 
cuºít
->
fsgid
 = 
pOSFSInfo
->fsgid;

1843 
	}
}

1860 
NDIS_STATUS
 
	$NICLﬂdFúmw¨e
(

1861 
IN
 
PRTMP_ADAPTER
 
pAd
)

1863 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

1864 
PUCHAR
 
§c
 = 
NULL
;

1865 
fûe
 *
§cf
;

1866 
INT
 
ªtvÆ
 = 0,
i
;

1868 
PUCHAR
 
pFúmw¨eImage
;

1869 
UINT
 
FûeLígth
 = 0;

1870 
INT
 
ªt
;

1872 
RTMP_OS_FS_INFO
 
osFSInfo
;

1874 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"--> NICLoadFirmware\n");

1875 
pAd
->
Fúmw¨eVîsi⁄
 = (
FIRMWARE_MAJOR_VERSION
 << 8Ë+ 
FIRMWARE_MINOR_VERSION
;

1877 
§c
 = 
RT2573_IMAGE_FILE_NAME
;

1880 
	`RtmpOSFSInfoCh™ge
(&
osFSInfo
, 
TRUE
);

1882 
pFúmw¨eImage
 = 
	`kmÆloc
(
MAX_FIRMWARE_IMAGE_SIZE
, 
MEM_ALLOC_FLAG
);

1883 i‡(
pFúmw¨eImage
 =
NULL
)

1885 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "NICLoadFirmware-Memoryállocate fail\n");

1886 
Sètus
 = 
NDIS_STATUS_FAILURE
;

1887 
out
;

1892 
§cf
 = 
	`RtmpOSFûeO≥n
(
§c
, 
O_RDONLY
, 0);

1896 i‡(
	`IS_ERR
(
§cf
))

1898 
Sètus
 = 
NDIS_STATUS_FAILURE
;

1899 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "--> Eº‹ %ld o≥nög %s\n", -
	`PTR_ERR
(
§cf
),
§c
);

1904 
	`mem£t
(
pFúmw¨eImage
, 0x00, 
MAX_FIRMWARE_IMAGE_SIZE
);

1907 
FûeLígth
 = 
	`RtmpOSFûeRód
(
§cf
, 
pFúmw¨eImage
, 
MAX_FIRMWARE_IMAGE_SIZE
);

1909 i‡(
FûeLígth
 !
MAX_FIRMWARE_IMAGE_SIZE
)

1911 
	`DBGPRINT_ERR
("NICLﬂdFúmw¨e:Éº‹ fûêÀngth (=%dËöÑt73.bö\n",
FûeLígth
);

1912 
Sètus
 = 
NDIS_STATUS_FAILURE
;

1916 
PUCHAR
 
±r
 = 
pFúmw¨eImage
;

1917 
USHORT
 
¸c
 = 0;

1919 
i
=0; i<(
MAX_FIRMWARE_IMAGE_SIZE
-2); i++, 
±r
++)

1920 
¸c
 = 
	`ByãCRC16
(*
±r
, crc);

1921 
¸c
 = 
	`ByãCRC16
(0x00, crc);

1922 
¸c
 = 
	`ByãCRC16
(0x00, crc);

1924 i‡((
pFúmw¨eImage
[
MAX_FIRMWARE_IMAGE_SIZE
-2] !(
UCHAR
)(
¸c
>>8)) ||

1925 (
pFúmw¨eImage
[
MAX_FIRMWARE_IMAGE_SIZE
-1] !(
UCHAR
)(
¸c
)))

1927 
	`DBGPRINT_ERR
("NICLoadFirmware: CRC = 0x%02x 0x%02xÉrror, should be 0x%02x 0x%02x\n",

1928 
pFúmw¨eImage
[
MAX_FIRMWARE_IMAGE_SIZE
-2],ÖFirmwareImage[MAX_FIRMWARE_IMAGE_SIZE-1],

1929 (
UCHAR
)(
¸c
>>8), (UCHAR)(crc) );

1931 i‡(
ªtvÆ
)

1933 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "--> Eº‹ %d closög %s\n", -
ªtvÆ
, 
§c
);

1936 
Sètus
 = 
NDIS_STATUS_FAILURE
;

1941 i‡((
pAd
->
Fúmw¨eVîsi⁄
Ë> ((
pFúmw¨eImage
[
MAX_FIRMWARE_IMAGE_SIZE
-4] << 8) +ÖFirmwareImage[MAX_FIRMWARE_IMAGE_SIZE-3]))

1943 
	`DBGPRINT_ERR
("NICLoadFirmware: Ver=%d.%d,Üocal Ver=%d.%d, used FirmwareImageÅalbe instead\n",

1944 
pFúmw¨eImage
[
MAX_FIRMWARE_IMAGE_SIZE
-4],ÖFirmwareImage[MAX_FIRMWARE_IMAGE_SIZE-3],

1945 
FIRMWARE_MAJOR_VERSION
, 
FIRMWARE_MINOR_VERSION
);

1947 
Sètus
 = 
NDIS_STATUS_FAILURE
;

1951 
pAd
->
Fúmw¨eVîsi⁄
 = (
pFúmw¨eImage
[
MAX_FIRMWARE_IMAGE_SIZE
-4] << 8) +ÖFirmwareImage[MAX_FIRMWARE_IMAGE_SIZE-3];

1952 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"NICLﬂdFúmw¨êOK: CRC = 0x%04x vî=%d.%d\n", 
¸c
,

1953 
pFúmw¨eImage
[
MAX_FIRMWARE_IMAGE_SIZE
-4],ÖFirmwareImage[MAX_FIRMWARE_IMAGE_SIZE-3]);

1962 i‡(
	`IS_FILE_OPEN_ERR
(
§cf
))

1966 
ªtvÆ
 = 
	`RtmpOSFûeClo£
(
§cf
);

1967 i‡(
ªtvÆ
)

1969 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "--> Eº‹ %d closög %s\n", -
ªtvÆ
, 
§c
);

1977 i‡(
Sètus
 !
NDIS_STATUS_SUCCESS
)

1979 
FûeLígth
 = 
FIRMAREIMAGE_LENGTH
;

1980 
	`mem£t
(
pFúmw¨eImage
, 0x00, 
FûeLígth
);

1981 
	`NdisMoveMem‹y
(
pFúmw¨eImage
, &
Fúmw¨eImage
[0], 
FûeLígth
);

1982 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

1984 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "NICLoadFirmware failed, usedÜocal Firmware(v %d.%d) instead\n",

1985 
FIRMWARE_MAJOR_VERSION
, 
FIRMWARE_MINOR_VERSION
);

1989 
i
 = 0; i < 
FûeLígth
; i = i + 4)

1991 
ªt
 = 
	`RTUSBMu…iWrôe
(
pAd
, 
FIRMWARE_IMAGE_BASE
 + 
i
, 
pFúmw¨eImage
 + i, 4);

1993 i‡(
ªt
 < 0)

1995 
Sètus
 = 
NDIS_STATUS_FAILURE
;

2001 
out
:

2002 i‡(
pFúmw¨eImage
 !
NULL
)

2003 
	`k‰ì
(
pFúmw¨eImage
);

2005 
	`RtmpOSFSInfoCh™ge
(&
osFSInfo
, 
FALSE
);

2007 i‡(
Sètus
 =
NDIS_STATUS_SUCCESS
)

2009 
	`RTUSBFúmw¨eRun
(
pAd
);

2014 
	`RTMPSëLED
(
pAd
, 
LED_LINK_DOWN
);

2018 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"<-- NICLﬂdFúmw¨ê(§c=%s)\n", 
§c
);

2021  
Sètus
;

2022 
	}
}

2039 
PUCHAR
 
	$RTMPFödSe˘i⁄
(

2040 
IN
 
PCHAR
 
buf„r
)

2042 
CHAR
 
ãmp_buf
[255];

2043 
PUCHAR
 
±r
;

2045 
	`°r˝y
(
ãmp_buf
, "[");

2046 
	`°rˇt
(
ãmp_buf
, "Default");

2047 
	`°rˇt
(
ãmp_buf
, "]");

2050 if((
±r
 = 
	`π°r°r
(
buf„r
, 
ãmp_buf
)Ë!
NULL
)

2051  (
±r
+
	`°æí
("\n"));

2053  
NULL
;

2054 
	}
}

2061 * 
	$π°r°r
(c⁄° * 
s1
,c⁄° * 
s2
)

2063 
INT
 
l1
, 
l2
;

2065 
l2
 = 
	`°æí
(
s2
);

2066 i‡(!
l2
)

2067  (*Ë
s1
;

2069 
l1
 = 
	`°æí
(
s1
);

2071 
l1
 >
l2
)

2073 
l1
--;

2074 i‡(!
	`memcmp
(
s1
,
s2
,
l2
))

2075  (*Ë
s1
;

2076 
s1
++;

2079  
NULL
;

2080 
	}
}

2088 * 
	g__r°πok
;

2089 * 
	$r°πok
(* 
s
,c⁄° * 
˘
)

2091 *
sbegö
, *
£nd
;

2093 
sbegö
 = 
s
 ? s : 
__r°πok
;

2094 i‡(!
sbegö
)

2096  
NULL
;

2099 
sbegö
 +
	`°r•n
(sbegö,
˘
);

2100 i‡(*
sbegö
 == '\0')

2102 
__r°πok
 = 
NULL
;

2103 –
NULL
 );

2106 
£nd
 = 
	`°Ωbrk
–
sbegö
, 
˘
);

2107 i‡(
£nd
 && *send != '\0')

2108 *
£nd
++ = '\0';

2110 
__r°πok
 = 
£nd
;

2112  (
sbegö
);

2113 
	}
}

2135 
INT
 
	$RTMPGëKeyP¨amëî
(

2136 
IN
 
PCHAR
 
key
,

2137 
OUT
 
PCHAR
 
de°
,

2138 
IN
 
INT
 
de°size
,

2139 
IN
 
PCHAR
 
buf„r
)

2141 
CHAR
 *
ãmp_buf1
;

2142 
CHAR
 *
ãmp_buf2
;

2143 
CHAR
 *
°¨t_±r
;

2144 
CHAR
 *
íd_±r
;

2145 
CHAR
 *
±r
;

2146 
CHAR
 *
off£t
 = 0;

2147 
INT
 
Àn
;

2149 
	#MAX_PARAM_BUFFER_SIZE
 2048

	)

2151 
ãmp_buf1
 = 
	`kmÆloc
(
MAX_PARAM_BUFFER_SIZE
, 
MEM_ALLOC_FLAG
);

2152 if(
ãmp_buf1
 =
NULL
)

2153  (
FALSE
);

2155 
ãmp_buf2
 = 
	`kmÆloc
(
MAX_PARAM_BUFFER_SIZE
, 
MEM_ALLOC_FLAG
);

2156 if(
ãmp_buf2
 =
NULL
)

2158 
	`k‰ì
(
ãmp_buf1
);

2159  (
FALSE
);

2163 if((
off£t
 = 
	`RTMPFödSe˘i⁄
(
buf„r
)Ë=
NULL
)

2165 
	`k‰ì
(
ãmp_buf1
);

2166 
	`k‰ì
(
ãmp_buf2
);

2167  (
FALSE
);

2170 
	`°r˝y
(
ãmp_buf1
, "\n");

2171 
	`°rˇt
(
ãmp_buf1
, 
key
);

2172 
	`°rˇt
(
ãmp_buf1
, "=");

2175 if((
°¨t_±r
=
	`π°r°r
(
off£t
, 
ãmp_buf1
))==
NULL
)

2177 
	`k‰ì
(
ãmp_buf1
);

2178 
	`k‰ì
(
ãmp_buf2
);

2179  (
FALSE
);

2182 
°¨t_±r
+=
	`°æí
("\n");

2184 if((
íd_±r
=
	`π°r°r
(
°¨t_±r
, "\n"))==
NULL
)

2185 
íd_±r
=
°¨t_±r
+
	`°æí
(start_ptr);

2187 i‡(
íd_±r
<
°¨t_±r
)

2189 
	`k‰ì
(
ãmp_buf1
);

2190 
	`k‰ì
(
ãmp_buf2
);

2191  (
FALSE
);

2194 
	`mem˝y
(
ãmp_buf2
, 
°¨t_±r
, 
íd_±r
-start_ptr);

2195 
ãmp_buf2
[
íd_±r
-
°¨t_±r
]='\0';

2196 
Àn
 = 
	`°æí
(
ãmp_buf2
);

2197 
	`°r˝y
(
ãmp_buf1
, 
ãmp_buf2
);

2198 if((
°¨t_±r
=
	`π°r°r
(
ãmp_buf1
, "=")Ë=
NULL
)

2200 
	`k‰ì
(
ãmp_buf1
);

2201 
	`k‰ì
(
ãmp_buf2
);

2202  (
FALSE
);

2205 
	`°r˝y
(
ãmp_buf2
, 
°¨t_±r
+1);

2206 
±r
 = 
ãmp_buf2
;

2208 *
±r
 != 0x00)

2210 if–(*
±r
 == ' ') || (*ptr == '\t') )

2211 
±r
++;

2216 
Àn
 = 
	`°æí
(
±r
);

2217 
	`mem£t
(
de°
, 0x00, 
de°size
);

2218 
	`°∫˝y
(
de°
, 
±r
, 
Àn
 >
de°size
 ? destsize:Üen);

2220 
	`k‰ì
(
ãmp_buf1
);

2221 
	`k‰ì
(
ãmp_buf2
);

2222  
TRUE
;

2223 
	}
}

2225 
	$πmp_ªad_key_∑rms_‰om_fûe
(
IN
 
PRTMP_ADAPTER
 
pAd
, *
tmpbuf
, *
buf„r
)

2227 
tok_°r
[16];

2228 
INT
 
idx
;

2229 
ULONG
 
KeyTy≥
;

2230 
ULONG
 
KeyLí
;

2231 
ULONG
 
KeyIdx
;

2232 
UCHAR
 
CùhîAlg
 = 
CIPHER_WEP64
;

2235 if(
	`RTMPGëKeyP¨amëî
("DeÁu…KeyID", 
tmpbuf
, 25, 
buf„r
))

2237 
KeyIdx
 = 
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2238 if((
KeyIdx
 >= 1 ) && (KeyIdx <= 4))

2239 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 = (
UCHAR
Ë(
KeyIdx
 - 1 );

2241 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 = 0;

2243 
	`DBGPRINT
(
RT_DEBUG_TRACE
, " DeÁu…KeyID(0~3)=%d\n", 
pAd
->
P‹tCfg
.
DeÁu…KeyId
);

2246 
idx
=0; idx<4; idx++)

2249 
	`•rötf
(
tok_°r
, "Key%dTy≥", 
idx
+1);

2251 if(
	`RTMPGëKeyP¨amëî
(
tok_°r
, 
tmpbuf
, 32, 
buf„r
))

2253 
KeyTy≥
 = 
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2255 
	`•rötf
(
tok_°r
, "Key%dSå", 
idx
+1);

2257 if(
	`RTMPGëKeyP¨amëî
(
tok_°r
, 
tmpbuf
, 128, 
buf„r
))

2259 
KeyLí
 = 
	`°æí
(
tmpbuf
);

2260 if(
KeyTy≥
 == 0)

2262 if–(
KeyLí
 == 10) || (KeyLen == 26))

2264 
pAd
->
Sh¨edKey
[
idx
].
KeyLí
 = KeyLen / 2;

2265 
	`AtoH
(
tmpbuf
, 
pAd
->
Sh¨edKey
[
idx
].
Key
, 
KeyLí
 / 2);

2266 i‡(
KeyLí
 == 10)

2267 
CùhîAlg
 = 
CIPHER_WEP64
;

2269 
CùhîAlg
 = 
CIPHER_WEP128
;

2270 
pAd
->
Sh¨edKey
[
idx
].
CùhîAlg
 = CipherAlg;

2272 
	`DBGPRINT
(
RT_DEBUG_TRACE
, " Key%dSå=%†™dÅy≥=%s\n", 
idx
+1, 
tmpbuf
, (
KeyTy≥
==0) ? "Hex":"Ascii");

2276 
	`DBGPRINT
(
RT_DEBUG_ERROR
, " Key%dSå i†InvÆid keyÜígth!\n", 
idx
+1);

2281 if–(
KeyLí
 == 5) || (KeyLen == 13))

2283 
pAd
->
Sh¨edKey
[
idx
].
KeyLí
 = KeyLen;

2284 
	`NdisMoveMem‹y
(
pAd
->
Sh¨edKey
[
idx
].
Key
, 
tmpbuf
, 
KeyLí
);

2285 i‡(
KeyLí
 == 5)

2286 
CùhîAlg
 = 
CIPHER_WEP64
;

2288 
CùhîAlg
 = 
CIPHER_WEP128
;

2289 
pAd
->
Sh¨edKey
[
idx
].
CùhîAlg
 = CipherAlg;

2291 
	`DBGPRINT
(
RT_DEBUG_TRACE
, " Key%dSå=%†™dÅy≥=%s\n", 
idx
+1, 
tmpbuf
, (
KeyTy≥
==0) ? "Hex":"Ascii");

2295 
	`DBGPRINT
(
RT_DEBUG_ERROR
, " Key%dSå i†InvÆid keyÜígth!\n", 
idx
+1);

2301 
	}
}

2321 
VOID
 
	$RTMPRódP¨amëîsFromFûe
(

2322 
IN
 
PRTMP_ADAPTER
 
pAd
)

2324 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

2325 
PUCHAR
 
§c
;

2326 
fûe
 *
§cf
;

2327 
INT
 
ªtvÆ
;

2328 
RTMP_OS_FS_INFO
 
osFSInfo
;

2329 
UCHAR
 *
buf„r
, *
mpoﬁ
;

2330 
CHAR
 *
tmpbuf
;

2331 
UCHAR
 
keyM©îül
[40];

2332 
UCHAR
 
Ch™√l
;

2333 
ULONG
 
ulInfo
;

2334 
UCHAR
 
ucInfo
;

2335 
RT_802_11_PREAMBLE
 
PªambÀ
;

2338 
§c
 = 
PROFILE_PATH
;

2343 
mpoﬁ
 = 
	`kmÆloc
((
CHAR
)*(2*
MAX_INI_BUFFER_SIZE
+10), 
MEM_ALLOC_FLAG
);

2344 i‡(
mpoﬁ
 =
NULL
)

2346 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "NotÉnough memory\n");

2347 
d⁄e
;

2351 
	`RtmpOSFSInfoCh™ge
(&
osFSInfo
, 
TRUE
);

2353 i‡(
§c
 && *src)

2355 
§cf
 = 
	`RtmpOSFûeO≥n
(
§c
, 
O_RDONLY
, 0);

2356 i‡(
	`IS_FILE_OPEN_ERR
(
§cf
))

2358 
Sètus
 = 
NDIS_STATUS_FAILURE
;

2359 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "--> Eº‹ %ld o≥nög %s\n", -
	`PTR_ERR
(
§cf
),
§c
);

2363 
pAd
->
P‹tCfg
.
bGëAPC⁄fig
 = 
FALSE
;

2365 i‡(
§cf
->
f_›
 && srcf->f_›->
ªad
)

2367 
buf„r
 = (
UCHAR
 *Ë((()(
mpoﬁ
+3)) & (()~(0x03)));

2368 
tmpbuf
 = (
UCHAR
 *Ë((()(
mpoﬁ
+ 
MAX_INI_BUFFER_SIZE
 +3)) & (()~(0x03)));

2369 
	`mem£t
(
buf„r
, 0x00, 
MAX_INI_BUFFER_SIZE
);

2370 
	`mem£t
(
tmpbuf
, 0x00, 
MAX_INI_BUFFER_SIZE
);

2373 
ªtvÆ
 = 
	`RtmpOSFûeRód
(
§cf
, 
mpoﬁ
, 
MAX_INI_BUFFER_SIZE
);

2374 i‡(
ªtvÆ
 < 0)

2376 
Sètus
 = 
NDIS_STATUS_FAILURE
;

2377 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "--> Ród %†îr‹ %d\n", 
§c
, -
ªtvÆ
);

2383 i‡(
	`RTMPGëKeyP¨amëî
("Cou¡ryRegi⁄", 
tmpbuf
, 255, 
buf„r
))

2385 
ucInfo
 = (
UCHAR
Ë
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2386 i‡(
ucInfo
 <
REGION_MAXIMUM_BG_BAND
)

2387 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄
 = 
ucInfo
;

2390 
ucInfo
 = 0;

2391 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄
 = 
ucInfo
;

2393 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(Cou¡ryRegi⁄=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄
);

2396 if(
	`RTMPGëKeyP¨amëî
("Cou¡ryRegi⁄AB™d", 
tmpbuf
, 25, 
buf„r
))

2398 
ucInfo
 = (
UCHAR
Ë
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2399 i‡(
ucInfo
 <
REGION_MAXIMUM_A_BAND
)

2400 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄F‹AB™d
 = 
ucInfo
;

2403 
ucInfo
 = 7;

2404 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄F‹AB™d
 = 
ucInfo
;

2406 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(Cou¡ryRegi⁄AB™d=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄F‹AB™d
);

2409 
	`mem£t
(
tmpbuf
, 0x00, 255);

2410 i‡(
	`RTMPGëKeyP¨amëî
("SSID", 
tmpbuf
, 64, 
buf„r
))

2412 i‡(
	`°æí
(
tmpbuf
) <= 32)

2414 
pAd
->
P‹tCfg
.
SsidLí
 = (
UCHAR
Ë
	`°æí
(
tmpbuf
);

2415 
	`mem˝y
(
pAd
->
P‹tCfg
.
Ssid
, 
tmpbuf
,ÖAd->P‹tCfg.
SsidLí
);

2417 
pAd
->
MlmeAux
.
AutoRec⁄√˘SsidLí
 =ÖAd->
P‹tCfg
.
SsidLí
;

2418 
	`mem˝y
(
pAd
->
MlmeAux
.
AutoRec⁄√˘Ssid
, 
tmpbuf
,ÖAd->MlmeAux.
AutoRec⁄√˘SsidLí
);

2419 
pAd
->
MlmeAux
.
SsidLí
 =ÖAd->
P‹tCfg
.SsidLen;

2420 
	`NdisZîoMem‹y
(
pAd
->
MlmeAux
.
Ssid
, 
MAX_LEN_OF_SSID
);

2421 
	`mem˝y
(
pAd
->
MlmeAux
.
Ssid
, 
tmpbuf
,ÖAd->MlmeAux.
SsidLí
);

2423 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(SSID=%s)\n", 
__FUNCTION__
, 
tmpbuf
);

2428 i‡(
	`RTMPGëKeyP¨amëî
("Nëw‹kTy≥", 
tmpbuf
, 25, 
buf„r
))

2430 
pAd
->
bC⁄figCh™ged
 = 
TRUE
;

2431 i‡(
	`°rcmp
(
tmpbuf
, "Adhoc") == 0)

2432 
pAd
->
P‹tCfg
.
BssTy≥
 = 
BSS_ADHOC
;

2434 
pAd
->
P‹tCfg
.
BssTy≥
 = 
BSS_INFRA
;

2437 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(Nëw‹kTy≥=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
BssTy≥
);

2440 i‡(
	`RTMPGëKeyP¨amëî
("WúñessMode", 
tmpbuf
, 10, 
buf„r
))

2442 
i
=0;

2444 
ulInfo
 = (
ULONG
)
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2447 
i
 = 0; i < 14; i++)

2448 
pAd
->
TxPowî
[
i
].
Ch™√l
 = i + 1;

2450 
i
 = 0; i < 8; i++)

2451 
pAd
->
TxPowî
[
i
 + 14].
Ch™√l
 = 36 + i * 4;

2453 
i
 = 0; i < 11; i++)

2454 
pAd
->
TxPowî
[
i
 + 22].
Ch™√l
 = 100 + i * 4;

2456 
i
 = 0; i < 5; i++)

2457 
pAd
->
TxPowî
[
i
 + 33].
Ch™√l
 = 149 + i * 4;

2460 
i
 = 0; i < 4; i++)

2461 
pAd
->
TxPowî
[
i
 + 38].
Ch™√l
 = 34 + i * 4;

2463 i‡((
ulInfo
 =
PHY_11BG_MIXED
Ë|| (ulInfÿ=
PHY_11B
) ||

2464 (
ulInfo
 =
PHY_11A
Ë|| (ulInfÿ=
PHY_11ABG_MIXED
) ||

2465 (
ulInfo
 =
PHY_11G
))

2467 
pAd
->
P‹tCfg
.
PhyMode
 = 0xff;

2468 
	`RTMPSëPhyMode
(
pAd
, 
ulInfo
);

2470 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(WúñessMode=%d)\n", 
__FUNCTION__
, 
ulInfo
);

2474 i‡(
	`RTMPGëKeyP¨amëî
("TxR©e", 
tmpbuf
, 10, 
buf„r
))

2476 
ulInfo
 = (
ULONG
)
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2478 i‡((
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11B
 && 
ulInfo
 <= 4) ||\

2479 ((
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11BG_MIXED
 ||ÖAd->P‹tCfg.PhyModê=
PHY_11ABG_MIXED
Ë&& 
ulInfo
 <= 12) ||\

2480 ((
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11A
 ||ÖAd->P‹tCfg.PhyModê=
PHY_11G
Ë&& (
ulInfo
 == 0 ||(ulInfo > 4 && ulInfo <= 12))))

2482 i‡(
ulInfo
 == 0)

2483 
	`RTMPSëDesúedR©es
(
pAd
, -1);

2485 
	`RTMPSëDesúedR©es
(
pAd
, (
LONG
Ë(
R©eIdToMbps
[
ulInfo
-1] * 1000000));

2489 
ulInfo
 = 0;

2490 
	`RTMPSëDesúedR©es
(
pAd
, -1);

2492 
pAd
->
P‹tCfg
.
DeÁu…MaxDesúedR©e
 = (
UCHAR
)
ulInfo
;

2493 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(TxR©e=%d)\n", 
__FUNCTION__
, 
ulInfo
);

2496 i‡(
	`RTMPGëKeyP¨amëî
("Ch™√l", 
tmpbuf
, 10, 
buf„r
))

2498 
Ch™√l
 = (
UCHAR
Ë
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2499 
pAd
->
P‹tCfg
.
AdhocCh™√l
 = 
Ch™√l
;

2501 i‡(
	`Ch™√lS™ôy
(
pAd
, 
Ch™√l
Ë=
TRUE
)

2504 
pAd
->
P‹tCfg
.
Ch™√l
 = Channel;

2506 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(Ch™√l=%d)\n", 
__FUNCTION__
, 
Ch™√l
);

2510 i‡(
	`RTMPGëKeyP¨amëî
("BGPrŸe˘i⁄", 
tmpbuf
, 10, 
buf„r
))

2512 
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10))

2515 
pAd
->
P‹tCfg
.
U£BGPrŸe˘i⁄
 = 1;

2518 
pAd
->
P‹tCfg
.
U£BGPrŸe˘i⁄
 = 2;

2522 
pAd
->
P‹tCfg
.
U£BGPrŸe˘i⁄
 = 0;

2525 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(BGPrŸe˘i⁄=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
U£BGPrŸe˘i⁄
);

2528 i‡(
	`RTMPGëKeyP¨amëî
("TxPªambÀ", 
tmpbuf
, 10, 
buf„r
))

2530 
PªambÀ
 = 
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2531 
PªambÀ
)

2533 
Rt802_11PªambÀSh‹t
:

2534 
pAd
->
P‹tCfg
.
TxPªambÀ
 = 
PªambÀ
;

2535 
	`MlmeSëTxPªambÀ
(
pAd
, 
Rt802_11PªambÀSh‹t
);

2537 
Rt802_11PªambÀL⁄g
:

2538 
Rt802_11PªambÀAuto
:

2542 
pAd
->
P‹tCfg
.
TxPªambÀ
 = 
PªambÀ
;

2543 
	`MlmeSëTxPªambÀ
(
pAd
, 
Rt802_11PªambÀL⁄g
);

2545 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(TxPªambÀ=%d)\n", 
__FUNCTION__
, 
PªambÀ
);

2548 i‡(
	`RTMPGëKeyP¨amëî
("RTSThªshﬁd", 
tmpbuf
, 10, 
buf„r
))

2550 
ulInfo
 = 
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2552 if((
ulInfo
 > 0Ë&& (ulInfÿ<
MAX_RTS_THRESHOLD
))

2553 
pAd
->
P‹tCfg
.
RtsThªshﬁd
 = (
USHORT
)
ulInfo
;

2555 
pAd
->
P‹tCfg
.
RtsThªshﬁd
 = 
MAX_RTS_THRESHOLD
;

2557 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(RTSThªshﬁd=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
RtsThªshﬁd
);

2560 i‡(
	`RTMPGëKeyP¨amëî
("FøgThªshﬁd", 
tmpbuf
, 10, 
buf„r
))

2562 
ulInfo
 = 
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2564 i‡–(
ulInfo
 >
MIN_FRAG_THRESHOLD
Ë&& (ulInfÿ<
MAX_FRAG_THRESHOLD
))

2565 
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
 = (
USHORT
)
ulInfo
;

2567 
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
 = 
MAX_FRAG_THRESHOLD
;

2569 i‡(
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
 =
MAX_FRAG_THRESHOLD
)

2570 
pAd
->
P‹tCfg
.
bFøgmítZîoDißbÀ
 = 
TRUE
;

2572 
pAd
->
P‹tCfg
.
bFøgmítZîoDißbÀ
 = 
FALSE
;

2574 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(FøgThªshﬁd=%d)\n", 
__FUNCTION__
, 
ulInfo
);

2577 i‡(
	`RTMPGëKeyP¨amëî
("TxBur°", 
tmpbuf
, 10, 
buf„r
))

2579 
ulInfo
 = 
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2581 i‡(
ulInfo
 == 1)

2582 
pAd
->
P‹tCfg
.
bE«bÀTxBur°
 = 
TRUE
;

2584 
pAd
->
P‹tCfg
.
bE«bÀTxBur°
 = 
FALSE
;

2586 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(TxBur°=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
bE«bÀTxBur°
);

2589 #ifde‡
AGGREGATION_SUPPORT


2591 if(
	`RTMPGëKeyP¨amëî
("PktAggªg©e", 
tmpbuf
, 10, 
buf„r
))

2593 if(
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10) != 0)

2594 
pAd
->
P‹tCfg
.
bAggªg©i⁄C≠abÀ
 = 
TRUE
;

2596 
pAd
->
P‹tCfg
.
bAggªg©i⁄C≠abÀ
 = 
FALSE
;

2598 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(PktAggªg©e=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
bAggªg©i⁄C≠abÀ
);

2601 
pAd
->
P‹tCfg
.
bAggªg©i⁄C≠abÀ
 = 
FALSE
;

2605 i‡(
	`RTMPGëKeyP¨amëî
("TurboR©e", 
tmpbuf
, 10, 
buf„r
))

2607 
ulInfo
 = 
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2609 i‡(
ulInfo
 == 1)

2610 
pAd
->
P‹tCfg
.
E«bÀTurboR©e
 = 
TRUE
;

2612 
pAd
->
P‹tCfg
.
E«bÀTurboR©e
 = 
FALSE
;

2614 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(TurboR©e=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
E«bÀTurboR©e
);

2619 if(
	`RTMPGëKeyP¨amëî
("WmmC≠abÀ", 
tmpbuf
, 32, 
buf„r
))

2621 if(
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10) != 0)

2622 
pAd
->
P‹tCfg
.
bWmmC≠abÀ
 = 
TRUE
;

2624 
pAd
->
P‹tCfg
.
bWmmC≠abÀ
 = 
FALSE
;

2626 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(WmmC≠abÀ=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
bWmmC≠abÀ
);

2629 if(
	`RTMPGëKeyP¨amëî
("AckPﬁicy", 
tmpbuf
, 32, 
buf„r
))

2631 
INT
 
i
;

2632 
PUCHAR
 
ma˝å
;

2634 
i
 = 0, 
ma˝å
 = 
	`r°πok
(
tmpbuf
,";"); ma˝å; ma˝å =Ñ°πok(
NULL
,";"), i++)

2636 
pAd
->
P‹tCfg
.
AckPﬁicy
[
i
] = (
UCHAR
)
	`sim∂e_°πﬁ
(
ma˝å
, 0, 10);

2638 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(AckPﬁicy[%d]=%d)\n", 
__FUNCTION__
, 
i
, 
pAd
->
P‹tCfg
.
AckPﬁicy
[i]);

2642 
pAd
->
P‹tCfg
.
bWmmC≠abÀ
 = 
FALSE
;

2646 if(
	`RTMPGëKeyP¨amëî
("IEEE80211H", 
tmpbuf
, 10, 
buf„r
))

2648 if(
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10) != 0)

2649 
pAd
->
P‹tCfg
.
bIEEE80211H
 = 
TRUE
;

2651 
pAd
->
P‹tCfg
.
bIEEE80211H
 = 
FALSE
;

2653 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(IEEE80211H=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
bIEEE80211H
);

2656 i‡(
	`RTMPGëKeyP¨amëî
("PSMode", 
tmpbuf
, 10, 
buf„r
))

2658 i‡(
pAd
->
P‹tCfg
.
BssTy≥
 =
BSS_INFRA
)

2660 i‡((
	`°rcmp
(
tmpbuf
, "MAX_PSP") == 0) || (strcmp(tmpbuf, "max_psp") == 0))

2665 i‡(
pAd
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

2666 
pAd
->
P‹tCfg
.
WödowsPowîMode
 = 
Ndis802_11PowîModeMAX_PSP
;

2667 
pAd
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
Ndis802_11PowîModeMAX_PSP
;

2668 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_RECEIVE_DTIM
);

2669 
pAd
->
P‹tCfg
.
DeÁu…Li°íCou¡
 = 5;

2671 i‡((
	`°rcmp
(
tmpbuf
, "Fast_PSP") == 0) || (strcmp(tmpbuf, "fast_psp") == 0)

2672 || (
	`°rcmp
(
tmpbuf
, "FAST_PSP") == 0))

2677 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_RECEIVE_DTIM
);

2678 i‡(
pAd
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

2679 
pAd
->
P‹tCfg
.
WödowsPowîMode
 = 
Ndis802_11PowîModeFa°_PSP
;

2680 
pAd
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
Ndis802_11PowîModeFa°_PSP
;

2681 
pAd
->
P‹tCfg
.
DeÁu…Li°íCou¡
 = 3;

2686 
	`MlmeSëPsmBô
(
pAd
, 
PWR_ACTIVE
);

2687 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_RECEIVE_DTIM
);

2688 i‡(
pAd
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

2689 
pAd
->
P‹tCfg
.
WödowsPowîMode
 = 
Ndis802_11PowîModeCAM
;

2690 
pAd
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
Ndis802_11PowîModeCAM
;

2692 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(PSMode=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
WödowsPowîMode
);

2696 i‡(
	`RTMPGëKeyP¨amëî
("AdhocOfdm", 
tmpbuf
, 32, 
buf„r
))

2698 
ulInfo
 = 
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2700 i‡(
ulInfo
 <
ADHOC_11ABG_MIXED
)

2701 
pAd
->
P‹tCfg
.
AdhocMode
 = 
ulInfo
;

2703 
pAd
->
P‹tCfg
.
AdhocMode
 = 0;

2705 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(AdhocOfdm=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
AdhocMode
);

2708 i‡(
	`RTMPGëKeyP¨amëî
("Fa°Rﬂmög", 
tmpbuf
, 32, 
buf„r
))

2710 
ulInfo
 = 
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2712 i‡(
ulInfo
 == 1)

2713 
pAd
->
P‹tCfg
.
bFa°Rﬂmög
 = 
TRUE
;

2715 
pAd
->
P‹tCfg
.
bFa°Rﬂmög
 = 
FALSE
;

2717 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(Fa°Rﬂmög=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
bFa°Rﬂmög
);

2720 i‡(
	`RTMPGëKeyP¨amëî
("RﬂmThªshﬁd", 
tmpbuf
, 32, 
buf„r
))

2722 
ulInfo
 = 
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10);

2724 i‡(
ulInfo
 > 90 || ulInfo < 60)

2725 
pAd
->
P‹tCfg
.
dBmToRﬂm
 = 70;

2727 
pAd
->
P‹tCfg
.
dBmToRﬂm
 = 
ulInfo
;

2729 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(RﬂmThªshﬁd=%d)\n", 
__FUNCTION__
, (-1)*(
pAd
->
P‹tCfg
.
dBmToRﬂm
));

2733 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


2734 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
FALSE
)

2738 i‡(
	`RTMPGëKeyP¨amëî
("AuthMode", 
tmpbuf
, 32, 
buf„r
))

2740 i‡((
	`°rcmp
(
tmpbuf
, "WEPAUTO") == 0) || (strcmp(tmpbuf, "wepauto") == 0))

2741 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeAutoSwôch
;

2742 i‡((
	`°rcmp
(
tmpbuf
, "SHARED") == 0) || (strcmp(tmpbuf, "shared") == 0))

2743 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeSh¨ed
;

2744 i‡((
	`°rcmp
(
tmpbuf
, "WPAPSK") == 0) || (strcmp(tmpbuf, "wpapsk") == 0))

2745 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeWPAPSK
;

2746 i‡((
	`°rcmp
(
tmpbuf
, "WPANONE") == 0) || (strcmp(tmpbuf, "wpanone") == 0))

2747 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeWPAN⁄e
;

2748 i‡((
	`°rcmp
(
tmpbuf
, "WPA2PSK") == 0) || (strcmp(tmpbuf, "wpa2psk") == 0))

2749 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeWPA2PSK
;

2750 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


2751 i‡((
	`°rcmp
(
tmpbuf
, "WPA") == 0) || (strcmp(tmpbuf, "wpa") == 0))

2752 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeWPA
;

2753 i‡((
	`°rcmp
(
tmpbuf
, "WPA2") == 0) || (strcmp(tmpbuf, "wpa2") == 0))

2754 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeWPA2
;

2757 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeO≥n
;

2759 
pAd
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_NOT_SECURED
;

2760 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(AuthMode=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
AuthMode
);

2763 i‡(
	`RTMPGëKeyP¨amëî
("En¸ypTy≥", 
tmpbuf
, 32, 
buf„r
))

2765 i‡((
	`°rcmp
(
tmpbuf
, "WEP") == 0) || (strcmp(tmpbuf, "wep") == 0))

2767 
pAd
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11WEPE«bÀd
;

2768 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11WEPE«bÀd
;

2769 
pAd
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11WEPE«bÀd
;

2771 i‡((
	`°rcmp
(
tmpbuf
, "TKIP") == 0) || (strcmp(tmpbuf, "tkip") == 0))

2773 
pAd
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

2774 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

2775 
pAd
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

2777 i‡((
	`°rcmp
(
tmpbuf
, "AES") == 0) || (strcmp(tmpbuf, "aes") == 0))

2779 
pAd
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

2780 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

2781 
pAd
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

2785 
pAd
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11WEPDißbÀd
;

2786 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11WEPDißbÀd
;

2787 
pAd
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11WEPDißbÀd
;

2789 
	`RTMPMakeRSNIE
(
pAd
,ÖAd->
P‹tCfg
.
GroupCùhî
);

2790 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(En¸ypTy≥=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
WïSètus
);

2793 i‡(
	`RTMPGëKeyP¨amëî
("WPAPSK", 
tmpbuf
, 255, 
buf„r
))

2795 
îr
=0;

2798 
tmpbuf
[
	`°æí
(tmpbuf)]='\0';

2800 i‡((
pAd
->
P‹tCfg
.
AuthMode
 !
Ndis802_11AuthModeWPAPSK
) &&\

2801 (
pAd
->
P‹tCfg
.
AuthMode
 !
Ndis802_11AuthModeWPA2PSK
) &&\

2802 (
pAd
->
P‹tCfg
.
AuthMode
 !
Ndis802_11AuthModeWPAN⁄e
) )

2804 
îr
 = 1;

2806 i‡((
	`°æí
(
tmpbuf
) >= 8) && (strlen(tmpbuf) < 64))

2808 
	`Passw‹dHash
((*)
tmpbuf
, 
pAd
->
P‹tCfg
.
Ssid
,ÖAd->P‹tCfg.
SsidLí
, 
keyM©îül
);

2809 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
PskKey
.
Key
, 
keyM©îül
, 32);

2812 i‡(
	`°æí
(
tmpbuf
) == 64)

2814 
	`AtoH
(
tmpbuf
, 
keyM©îül
, 32);

2815 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
PskKey
.
Key
, 
keyM©îül
, 32);

2819 
îr
 = 1;

2820 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "%s::(WPAPSK key-°rögÑequúed 8 ~ 64 ch¨a˘îs!)\n", 
__FUNCTION__
);

2823 i‡(
îr
 == 0)

2825 
	`RTMPMakeRSNIE
(
pAd
,ÖAd->
P‹tCfg
.
GroupCùhî
);

2827 i‡((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAPSK
) ||\

2828 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2PSK
))

2832 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_START
;

2834 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAN⁄e
)

2838 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_START
;

2840 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(WPAPSK=%s)\n", 
__FUNCTION__
, 
tmpbuf
);

2844 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(DeÁu…KeyID, KeyTy≥, KeySå !!!!!!!!!)\n", 
__FUNCTION__
);

2845 
	`πmp_ªad_key_∑rms_‰om_fûe
(
pAd
, 
tmpbuf
, 
buf„r
);

2850 i‡((
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11WEPE«bÀd
) &&\

2851 ((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeO≥n
) ||\

2852 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeSh¨ed
) ||\

2853 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeAutoSwôch
)))

2855 
idx
;

2856 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


2857 
KeyIdx
 = 
pAd
->
P‹tCfg
.
DeÁu…KeyId
;

2860 
pAd
->
P‹tCfg
.
DesúeSh¨edKey
[
KeyIdx
].
KeyLí
 =ÖAd->
Sh¨edKey
[KeyIdx].KeyLen;

2861 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
DesúeSh¨edKey
[
KeyIdx
].
Key
,ÖAd->
Sh¨edKey
[KeyIdx].Key,ÖAd->Sh¨edKey[KeyIdx].
KeyLí
);

2862 
pAd
->
P‹tCfg
.
DesúeSh¨edKey
[
KeyIdx
].
CùhîAlg
 =ÖAd->
Sh¨edKey
[KeyIdx].CipherAlg;

2865 
idx
=0; idx<4; idx++)

2867 i‡(
pAd
->
Sh¨edKey
[
idx
].
KeyLí
 > 0)

2868 
	`AsicAddSh¨edKeyE¡ry
(
pAd
,

2870 
idx
,

2871 
pAd
->
Sh¨edKey
[
idx
].
CùhîAlg
,

2872 
pAd
->
Sh¨edKey
[
idx
].
Key
,

2873 
NULL
,

2874 
NULL
);

2878 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


2879 i‡(
	`RTMPGëKeyP¨amëî
("N©iveW∑", 
tmpbuf
, 10, 
buf„r
))

2881 
i
;

2883 if(
	`sim∂e_°πﬁ
(
tmpbuf
, 0, 10) == 1)

2885 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeO≥n
;

2886 
pAd
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11En¸y±i⁄DißbÀd
;

2887 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11En¸y±i⁄DißbÀd
;

2888 
pAd
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11En¸y±i⁄DißbÀd
;

2889 
pAd
->
P‹tCfg
.
bMixCùhî
 = 
FALSE
;

2890 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 = 0;

2892 
pAd
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_NOT_SECURED
;

2893 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_NOTUSE
;

2895 
	`RTMPWPARemoveAŒKeys
(
pAd
);

2897 
pAd
->
P‹tCfg
.
bAutoRec⁄√˘
 = 
FALSE
;

2898 
pAd
->
P‹tCfg
.
WPA_Suµliˇ¡
 = 
TRUE
;

2899 
pAd
->
P‹tCfg
.
bN©iveW∑
 = 
TRUE
;

2903 
pAd
->
P‹tCfg
.
bN©iveW∑
 = 
FALSE
;

2905 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s::(N©iveW∑=%d)\n", 
__FUNCTION__
, 
pAd
->
P‹tCfg
.
bN©iveW∑
);

2914 
Sètus
 = 
NDIS_STATUS_FAILURE
;

2915 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "--> %†d€†nŸ havê®wrôêmëhod\n", 
§c
);

2919 i‡(
	`IS_FILE_OPEN_ERR
(
§cf
))

2923 
ªtvÆ
 = 
	`RtmpOSFûeClo£
(
§cf
);

2924 i‡(
ªtvÆ
)

2926 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "--> Eº‹ %d closög %s\n", -
ªtvÆ
, 
§c
);

2933 
d⁄e
:

2935 i‡(
mpoﬁ
 !
NULL
)

2936 
	`k‰ì
(
mpoﬁ
);

2938 
	`RtmpOSFSInfoCh™ge
(&
osFSInfo
, 
FALSE
);

2940 
	}
}

2942 #i‚de‡
BIG_ENDIAN


2960 
ULONG
 
	$RTMPEquÆMem‹y
(

2961 
IN
 
PVOID
 
pSrc1
,

2962 
IN
 
PVOID
 
pSrc2
,

2963 
IN
 
ULONG
 
Lígth
)

2965 
PUCHAR
 
pMem1
;

2966 
PUCHAR
 
pMem2
;

2967 
ULONG
 
Index
 = 0;

2969 
pMem1
 = (
PUCHAR
Ë
pSrc1
;

2970 
pMem2
 = (
PUCHAR
Ë
pSrc2
;

2972 
Index
 = 0; Index < 
Lígth
; Index++)

2974 i‡(
pMem1
[
Index
] !
pMem2
[Index])

2980 i‡(
Index
 =
Lígth
)

2988 
	}
}

3009 
ULONG
 
	$RTMPCom∑ªMem‹y
(

3010 
IN
 
PVOID
 
pSrc1
,

3011 
IN
 
PVOID
 
pSrc2
,

3012 
IN
 
ULONG
 
Lígth
)

3014 
PUCHAR
 
pMem1
;

3015 
PUCHAR
 
pMem2
;

3016 
ULONG
 
Index
 = 0;

3018 
pMem1
 = (
PUCHAR
Ë
pSrc1
;

3019 
pMem2
 = (
PUCHAR
Ë
pSrc2
;

3021 
Index
 = 0; Index < 
Lígth
; Index++)

3023 i‡(
pMem1
[
Index
] > 
pMem2
[Index])

3025 i‡(
pMem1
[
Index
] < 
pMem2
[Index])

3031 
	}
}

3050 
VOID
 
	$RTMPZîoMem‹y
(

3051 
IN
 
PVOID
 
pSrc
,

3052 
IN
 
ULONG
 
Lígth
)

3054 
	`mem£t
(
pSrc
, 0, 
Lígth
);

3055 
	}
}

3057 
VOID
 
	$RTMPFûlMem‹y
(

3058 
IN
 
PVOID
 
pSrc
,

3059 
IN
 
ULONG
 
Lígth
,

3060 
IN
 
UCHAR
 
Fûl
)

3062 
	`mem£t
(
pSrc
, 
Fûl
, 
Lígth
);

3063 
	}
}

3083 
VOID
 
	$RTMPMoveMem‹y
(

3084 
OUT
 
PVOID
 
pDe°
,

3085 
IN
 
PVOID
 
pSrc
,

3086 
IN
 
ULONG
 
Lígth
)

3088 #ifde‡
RTMP_EMBEDDED


3089 if(
Lígth
 <= 8)

3091 *(((
PUCHAR
)
pDe°
)++Ë*(((PUCHAR)
pSrc
)++);

3092 if(--
Lígth
 == 0) ;

3093 *(((
PUCHAR
)
pDe°
)++Ë*(((PUCHAR)
pSrc
)++);

3094 if(--
Lígth
 == 0) ;

3095 *(((
PUCHAR
)
pDe°
)++Ë*(((PUCHAR)
pSrc
)++);

3096 if(--
Lígth
 == 0) ;

3097 *(((
PUCHAR
)
pDe°
)++Ë*(((PUCHAR)
pSrc
)++);

3098 if(--
Lígth
 == 0) ;

3099 *(((
PUCHAR
)
pDe°
)++Ë*(((PUCHAR)
pSrc
)++);

3100 if(--
Lígth
 == 0) ;

3101 *(((
PUCHAR
)
pDe°
)++Ë*(((PUCHAR)
pSrc
)++);

3102 if(--
Lígth
 == 0) ;

3103 *(((
PUCHAR
)
pDe°
)++Ë*(((PUCHAR)
pSrc
)++);

3104 if(--
Lígth
 == 0) ;

3105 *(((
PUCHAR
)
pDe°
)++Ë*(((PUCHAR)
pSrc
)++);

3106 if(--
Lígth
 == 0) ;

3109 
	`mem˝y
(
pDe°
, 
pSrc
, 
Lígth
);

3111 
	`mem˝y
(
pDe°
, 
pSrc
, 
Lígth
);

3113 
	}
}

3131 
VOID
 
	$P‹tCfgInô
(

3132 
IN
 
PRTMP_ADAPTER
 
pAd
)

3134 
UINT
 
i
;

3136 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "--> PortCfgInit\n");

3141 
i
 = 0; i < 
SHARE_KEY_NUM
; i++)

3143 
pAd
->
Sh¨edKey
[
i
].
KeyLí
 = 0;

3144 
pAd
->
Sh¨edKey
[
i
].
CùhîAlg
 = 
CIPHER_NONE
;

3147 
pAd
->
A¡í«
.
fõld
.
TxDeÁu…A¡í«
 = 2;

3148 
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 = 2;

3149 
pAd
->
A¡í«
.
fõld
.
NumOfA¡í«
 = 2;

3151 
pAd
->
LedC¡l
.
fõld
.
LedMode
 = 
LED_MODE_DEFAULT
;

3152 
pAd
->
LedIndiˇt‹Såígth
 = 0;

3153 
pAd
->
bAutoTxAgcA
 = 
FALSE
;

3154 
pAd
->
bAutoTxAgcG
 = 
FALSE
;

3155 
pAd
->
RfIcTy≥
 = 
RFIC_5226
;

3157 
pAd
->
P‹tCfg
.
Dsifs
 = 10;

3158 
pAd
->
P‹tCfg
.
PrivacyFûãr
 = 
Ndis802_11PrivFûãrAc˚±AŒ
;

3159 
pAd
->
P‹tCfg
.
TxPowî
 = 100;

3160 
pAd
->
P‹tCfg
.
TxPowîPî˚¡age
 = 0xffffffff;

3161 
pAd
->
P‹tCfg
.
TxPowîDeÁu…
 = 0xffffffff;

3162 
pAd
->
P‹tCfg
.
TxPªambÀ
 = 
Rt802_11PªambÀAuto
;

3163 
pAd
->
P‹tCfg
.
bU£ZîoToDißbÀFøgmít
 = 
FALSE
;

3164 
pAd
->
P‹tCfg
.
RtsThªshﬁd
 = 2347;

3165 
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
 = 2346;

3166 
pAd
->
P‹tCfg
.
dBmToRﬂm
 = 70;

3167 
pAd
->
P‹tCfg
.
U£BGPrŸe˘i⁄
 = 0;

3168 
pAd
->
P‹tCfg
.
bE«bÀTxBur°
 = 0;

3169 
pAd
->
P‹tCfg
.
PhyMode
 = 0xff;

3170 
pAd
->
P‹tCfg
.
B™dSèã
 = 
UNKNOWN_BAND
;

3171 
pAd
->
P‹tCfg
.
U£Sh‹tSlŸTime
 = 
TRUE
;

3173 
pAd
->
bAc˚±Dúe˘
 = 
TRUE
;

3174 
pAd
->
bAc˚±Mu…iˇ°
 = 
FALSE
;

3175 
pAd
->
bAc˚±Brﬂdˇ°
 = 
TRUE
;

3176 
pAd
->
bAc˚±AŒMu…iˇ°
 = 
TRUE
;

3178 
pAd
->
bLoˇlAdmöMAC
 = 
FALSE
;

3181 
pAd
->
P‹tCfg
.
Rad¨Dëe˘
.
CSPîiod
 = 10;

3182 
pAd
->
P‹tCfg
.
Rad¨Dëe˘
.
CSCou¡
 = 0;

3183 
pAd
->
P‹tCfg
.
Rad¨Dëe˘
.
RDMode
 = 
RD_NORMAL_MODE
;

3189 
pAd
->
P‹tCfg
.
Psm
 = 
PWR_ACTIVE
;

3190 
pAd
->
P‹tCfg
.
Bóc⁄Pîiod
 = 100;

3192 
pAd
->
P‹tCfg
.
SˇnC¡
 = 0;

3194 
pAd
->
P‹tCfg
.
AuthMode
 = 
Ndis802_11AuthModeO≥n
;

3195 
pAd
->
P‹tCfg
.
WïSètus
 = 
Ndis802_11En¸y±i⁄DißbÀd
;

3196 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
Ndis802_11En¸y±i⁄DißbÀd
;

3197 
pAd
->
P‹tCfg
.
GroupCùhî
 = 
Ndis802_11En¸y±i⁄DißbÀd
;

3198 
pAd
->
P‹tCfg
.
bMixCùhî
 = 
FALSE
;

3199 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 = 0;

3202 
pAd
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_NOT_SECURED
;

3203 
pAd
->
P‹tCfg
.
La°MicEº‹Time
 = 0;

3204 
pAd
->
P‹tCfg
.
MicEºC¡
 = 0;

3205 
pAd
->
P‹tCfg
.
bBlockAssoc
 = 
FALSE
;

3206 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_NOTUSE
;

3208 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


3209 
pAd
->
P‹tCfg
.
wx_auth_Æg
 = 0;

3211 
pAd
->
P‹tCfg
.
wx_√ed_sync
 = 0;

3212 
pAd
->
P‹tCfg
.
wx_groupCùhî
 = 0;

3213 
pAd
->
P‹tCfg
.
wx_key_mgmt
 = 0;

3214 
pAd
->
P‹tCfg
.
wx_∑úwi£
 = 0;

3215 
pAd
->
P‹tCfg
.
wx_w∑_vîsi⁄
 = 0;

3216 
pAd
->
P‹tCfg
.
bN©iveW∑
 = 
FALSE
;

3219 
pAd
->
P‹tCfg
.
RssiTriggî
 = 0;

3220 
pAd
->
P‹tCfg
.
La°Rssi
 = 0;

3221 
pAd
->
P‹tCfg
.
La°Rssi2
 = 0;

3222 
pAd
->
P‹tCfg
.
AvgRssi
 = 0;

3223 
pAd
->
P‹tCfg
.
AvgRssiX8
 = 0;

3224 
pAd
->
P‹tCfg
.
RssiTriggîMode
 = 
RSSI_TRIGGERED_UPON_BELOW_THRESHOLD
;

3225 
pAd
->
P‹tCfg
.
AtimWö
 = 0;

3226 
pAd
->
P‹tCfg
.
DeÁu…Li°íCou¡
 = 3;

3227 
pAd
->
P‹tCfg
.
BssTy≥
 = 
BSS_INFRA
;

3228 
pAd
->
P‹tCfg
.
AdhocMode
 = 0;

3231 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_RECEIVE_DTIM
);

3232 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_ADHOC_ON
);

3233 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_INFRA_ON
);

3236 
pAd
->
P‹tCfg
.
PhyMode
 = 
PHY_11ABG_MIXED
;

3237 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_SHORT_PREAMBLE_INUSED
);

3240 
pAd
->
P‹tCfg
.
WödowsPowîMode
 = 
Ndis802_11PowîModeCAM
;

3241 
pAd
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
Ndis802_11PowîModeCAM
;

3242 
pAd
->
P‹tCfg
.
bWödowsACCAME«bÀ
 = 
FALSE
;

3244 
	`RTMPInôTimî
(
pAd
, &pAd->
P‹tCfg
.
QuickRe•⁄eF‹R©eUpTimî
, 
	`GET_TIMER_FUNCTION
(
SèQuickRe•⁄eF‹R©eUpExec
),ÖAd, 
FALSE
);

3245 
pAd
->
P‹tCfg
.
QuickRe•⁄eF‹R©eUpTimîRu¬ög
 = 
FALSE
;

3248 
pAd
->
P‹tCfg
.
bHwRadio
 = 
TRUE
;

3249 
pAd
->
P‹tCfg
.
bSwRadio
 = 
TRUE
;

3250 
pAd
->
P‹tCfg
.
bRadio
 = 
TRUE
;

3251 
pAd
->
P‹tCfg
.
bH¨dw¨eRadio
 = 
FALSE
;

3252 
pAd
->
P‹tCfg
.
bShowHiddíSSID
 = 
FALSE
;

3255 
pAd
->
P‹tCfg
.
bAutoRec⁄√˘
 = 
TRUE
;

3265 
pAd
->
P‹tCfg
.
La°SˇnTime
 = 0;

3268 
pAd
->
ExåaInfo
 = 
EXTRA_INFO_CLEAR
;

3271 
pAd
->
bC⁄figCh™ged
 = 
FALSE
;

3278 
pAd
->
BbpTunög
.
bE«bÀ
 = 
TRUE
;

3279 
pAd
->
BbpTunög
.
R17LowîBoundG
 = 0x20;

3280 
pAd
->
BbpTunög
.
R17UµîBoundG
 = 0x40;

3281 
pAd
->
BbpTunög
.
R17LowîBoundA
 = 0x28;

3282 
pAd
->
BbpTunög
.
R17UµîBoundA
 = 0x48;

3283 
pAd
->
BbpTunög
.
R17LowîUµîSñe˘
 = 0;

3284 
pAd
->
BbpTunög
.
FÆ£CˇLowîThªshﬁd
 = 100;

3285 
pAd
->
BbpTunög
.
FÆ£CˇUµîThªshﬁd
 = 512;

3286 
pAd
->
BbpTunög
.
R17Dñè
 = 4;

3288 
pAd
->
Bbp94
 = 
BBPR94_DEFAULT
;

3289 
pAd
->
BbpF‹CCK
 = 
FALSE
;

3292 
pAd
->
P‹tCfg
.
IEEE8021X
 = 0;

3293 
pAd
->
P‹tCfg
.
IEEE8021x_ªquúed_keys
 = 0;

3294 
pAd
->
P‹tCfg
.
WPA_Suµliˇ¡
 = 
FALSE
;

3297 
pAd
->
MaxTxQueueSize
 = 
MAX_TX_QUEUE_SIZE
;

3306 #ifde‡
RALINK_ATE


3307 
	`mem£t
(&
pAd
->
©e
, 0, (
ATE_INFO
));

3308 
pAd
->
©e
.
Mode
 = 
ATE_STASTART
;

3309 
pAd
->
©e
.
TxCou¡
 = 
TX_RING_SIZE
;

3310 
pAd
->
©e
.
TxLígth
 = 1024;

3311 
pAd
->
©e
.
TxR©e
 = 
RATE_11
;

3312 
pAd
->
©e
.
Ch™√l
 = 1;

3313 
pAd
->
©e
.
RFFªqOff£t
 = 0;

3314 
pAd
->
©e
.
Addr1
[0] = 0x00;

3315 
pAd
->
©e
.
Addr1
[1] = 0x11;

3316 
pAd
->
©e
.
Addr1
[2] = 0x22;

3317 
pAd
->
©e
.
Addr1
[3] = 0xAA;

3318 
pAd
->
©e
.
Addr1
[4] = 0xBB;

3319 
pAd
->
©e
.
Addr1
[5] = 0xCC;

3320 
	`mem˝y
(
pAd
->
©e
.
Addr2
,ÖAd->©e.
Addr1
, 
MAC_ADDR_LEN
);

3321 
	`mem˝y
(
pAd
->
©e
.
Addr3
,ÖAd->©e.
Addr1
, 
MAC_ADDR_LEN
);

3324 
	`RTMPInôTimî
(
pAd
, &pAd->
P‹tCfg
.
W∑DißssocAndBlockAssocTimî
, &
W∑DißssocApAndBlockAssoc
,ÖAd, 
FALSE
);

3325 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<-- PortCfgInit\n");

3327 
	}
}

3329 
UCHAR
 
	$BtoH
(

3330 
IN
 
CHAR
 
ch
)

3332 i‡(
ch
 >= '0' && ch <= '9')  (ch - '0');

3333 i‡(
ch
 >= 'A' && ch <= 'F')  (ch - 'A' + 0xA);

3334 i‡(
ch
 >= 'a' && ch <= 'f')  (ch - 'a' + 0xA);

3336 
	}
}

3351 
VOID
 
	$AtoH
(

3352 
IN
 
CHAR
 *
§c
,

3353 
OUT
 
UCHAR
 *
de°
,

3354 
IN
 
INT
 
de°Àn
)

3356 
CHAR
 *
§˝å
;

3357 
PUCHAR
 
de°Temp
;

3359 
§˝å
 = 
§c
;

3360 
de°Temp
 = (
PUCHAR
Ë
de°
;

3362 
de°Àn
--)

3364 *
de°Temp
 = 
	`BtoH
(*
§˝å
++) << 4;

3365 *
de°Temp
 +
	`BtoH
(*
§˝å
++);

3366 
de°Temp
++;

3368 
	}
}

3370 
VOID
 
	$RTMPP©chMacBbpBug
(

3371 
IN
 
PRTMP_ADAPTER
 
pAd
)

3374 
ULONG
 
Index
;

3377 
Index
 = 0; Index < 
NUM_BBP_REG_PARMS
; Index++)

3379 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBPRegTabÀ
[
Index
].
Regi°î
, (
UCHAR
)BBPRegTabÀ[Index].
VÆue
);

3383 
	`AsicSwôchCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

3384 
	`AsicLockCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

3387 
	`NICInôAsicFromEEPROM
(
pAd
);

3389 
	}
}

3392 
VOID
 
	$RTMPu£cDñay
(

3393 
IN
 
ULONG
 
u£c
)

3395 
ULONG
 
i
;

3397 
i
 = 0; i < (
u£c
 / 50); i++)

3398 
	`udñay
(50);

3400 i‡(
u£c
 % 50)

3401 
	`udñay
(
u£c
 % 50);

3402 
	}
}

3421 
VOID
 
	$RTMPSëLED
(

3422 
IN
 
PRTMP_ADAPTER
 
pAd
,

3423 
IN
 
UCHAR
 
Sètus
)

3425 
Sètus
)

3427 
LED_LINK_DOWN
:

3428 
pAd
->
LedC¡l
.
fõld
.
LökGSètus
 = 0;

3429 
pAd
->
LedC¡l
.
fõld
.
LökASètus
 = 0;

3430 
pAd
->
LedIndiˇt‹Såígth
 = 0;

3431 
	`RTUSBSëLED
(
pAd
,ÖAd->
LedC¡l
,ÖAd->
LedIndiˇt‹Såígth
);

3433 
LED_LINK_UP
:

3434 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 <= 14)

3437 
pAd
->
LedC¡l
.
fõld
.
LökGSètus
 = 1;

3438 
pAd
->
LedC¡l
.
fõld
.
LökASètus
 = 0;

3443 
pAd
->
LedC¡l
.
fõld
.
LökGSètus
 = 0;

3444 
pAd
->
LedC¡l
.
fõld
.
LökASètus
 = 1;

3447 
	`RTUSBSëLED
(
pAd
,ÖAd->
LedC¡l
,ÖAd->
LedIndiˇt‹Såígth
);

3449 
LED_RADIO_ON
:

3450 
pAd
->
LedC¡l
.
fõld
.
RadioSètus
 = 1;

3451 
	`RTUSBSëLED
(
pAd
,ÖAd->
LedC¡l
,ÖAd->
LedIndiˇt‹Såígth
);

3453 
LED_HALT
:

3455 
LED_RADIO_OFF
:

3456 
pAd
->
LedC¡l
.
fõld
.
RadioSètus
 = 0;

3457 
pAd
->
LedC¡l
.
fõld
.
LökGSètus
 = 0;

3458 
pAd
->
LedC¡l
.
fõld
.
LökASètus
 = 0;

3459 
pAd
->
LedIndiˇt‹Såígth
 = 0;

3460 
	`RTUSBSëLED
(
pAd
,ÖAd->
LedC¡l
,ÖAd->
LedIndiˇt‹Såígth
);

3463 
	`DBGPRINT
(
RT_DEBUG_WARN
, "RTMPSëLED::Unknow¿Sètu†%d\n", 
Sètus
);

3466 
	}
}

3493 
VOID
 
	$RTMPSëSig«lLED
(

3494 
IN
 
PRTMP_ADAPTER
 
pAd
,

3495 
IN
 
NDIS_802_11_RSSI
 
Dbm
)

3497 
USHORT
 
nLed
 = 0;

3499 i‡(
Dbm
 <= -90)

3500 
nLed
 = 0;

3501 i‡(
Dbm
 <= -81)

3502 
nLed
 = 1;

3503 i‡(
Dbm
 <= -71)

3504 
nLed
 = 2;

3505 i‡(
Dbm
 <= -67)

3506 
nLed
 = 3;

3507 i‡(
Dbm
 <= -57)

3508 
nLed
 = 4;

3510 
nLed
 = 5;

3515 i‡((
pAd
->
LedIndiˇt‹Såígth
 !
nLed
) &&

3516 (
pAd
->
LedC¡l
.
fõld
.
LedMode
 =
LED_MODE_SIGNAL_STREGTH
))

3518 
pAd
->
LedIndiˇt‹Såígth
 = 
nLed
;

3519 
	`RTUSBSëLED
(
pAd
,ÖAd->
LedC¡l
,ÖAd->
LedIndiˇt‹Såígth
);

3521 
	}
}

3523 
VOID
 
	$RTMPCckBbpTunög
(

3524 
IN
 
PRTMP_ADAPTER
 
pAd
,

3525 
IN
 
UINT
 
TxR©e
)

3527 
CHAR
 
Bbp94
 = 0xFF;

3528 
USHORT
 
VÆue
 = 0;

3533 i‡(
pAd
->
TxPowîDñèC⁄fig
.
fõld
.
TxPowîE«bÀ
 =
FALSE
)

3536 i‡((
TxR©e
 < 
RATE_FIRST_OFDM_RATE
) &&

3537 (
pAd
->
BbpF‹CCK
 =
FALSE
))

3539 
Bbp94
 = 
pAd
->Bbp94;

3541 i‡(
pAd
->
TxPowîDñèC⁄fig
.
fõld
.
Ty≥
 == 1)

3543 
Bbp94
 +
pAd
->
TxPowîDñèC⁄fig
.
fõld
.
DñèVÆue
;

3547 
Bbp94
 -
pAd
->
TxPowîDñèC⁄fig
.
fõld
.
DñèVÆue
;

3549 
pAd
->
BbpF‹CCK
 = 
TRUE
;

3551 i‡((
TxR©e
 >
RATE_FIRST_OFDM_RATE
) &&

3552 (
pAd
->
BbpF‹CCK
 =
TRUE
))

3554 
Bbp94
 = 
pAd
->Bbp94;

3555 
pAd
->
BbpF‹CCK
 = 
FALSE
;

3558 i‡((
Bbp94
 >= 0) && (Bbp94 <= 0x0C))

3560 
VÆue
 = (
Bbp94
 << 8Ë+ 
BBP_R94
;

3561 
	`RTUSBEnqueueCmdFromNdis
(
pAd
, 
RT_OID_VENDOR_WRITE_BBP
, 
TRUE
, (
PVOID
Ë&
VÆue
, (Value));

3563 
	}
}

3584 
VOID
 
	$RTMPInôTimî
(

3585 
IN
 
PRTMP_ADAPTER
 
pAd
,

3586 
IN
 
PRALINK_TIMER_STRUCT
 
pTimî
,

3587 
IN
 
PVOID
 
pTimîFunc
,

3588 
IN
 
PVOID
 
pD©a
,

3589 
IN
 
BOOLEAN
 
Rïót
)

3591 
pTimî
->
VÆid
 = 
TRUE
;

3592 
pTimî
->
Rïót
 = Repeat;

3593 
pTimî
->
Sèã
 = 
FALSE
;

3594 
pTimî
->
cookõ
 = (
ULONG
)
pD©a
;

3597 
	`öô_timî
(&
pTimî
->
TimîObj
);

3598 
pTimî
->
TimîObj
.
d©a
 = ()pTimer;

3599 
pTimî
->
TimîObj
.
fun˘i⁄
 = 
pTimîFunc
;

3601 
	}
}

3621 
VOID
 
	$RTMPSëTimî
(

3622 
IN
 
PRALINK_TIMER_STRUCT
 
pTimî
,

3623 
IN
 
ULONG
 
VÆue
)

3625 i‡(
pTimî
->
VÆid
)

3628 i‡(
	`timî_≥ndög
(&
pTimî
->
TimîObj
))

3630 
	`dñ_timî_sync
(&
pTimî
->
TimîObj
);

3633 
pTimî
->
TimîVÆue
 = 
VÆue
;

3634 
pTimî
->
Sèã
 = 
FALSE
;

3635 
VÆue
 = ((VÆue*
HZ
) / 1000);

3636 
pTimî
->
TimîObj
.
expúes
 = 
jiffõs
 + 
VÆue
;

3637 
	`add_timî
(&
pTimî
->
TimîObj
);

3641 
	`DBGPRINT_ERR
("RTMPSetTimer failed, Timer hasn't been initialize!\n");

3643 
	}
}

3673 
VOID
 
	$RTMPModTimî
(

3674 
IN
 
PRALINK_TIMER_STRUCT
 
pTimî
,

3675 
IN
 
ULONG
 
VÆue
)

3677 i‡(
pTimî
->
VÆid
)

3679 
pTimî
->
TimîVÆue
 = 
VÆue
;

3680 
pTimî
->
Sèã
 = 
FALSE
;

3685 
	`DBGPRINT_ERR
("RTMPSetTimer failed, Timer hasn't been initialize!\n");

3687 
	}
}

3706 
VOID
 
	$RTMPC™˚lTimî
(

3707 
IN
 
PRALINK_TIMER_STRUCT
 
pTimî
,

3708 
OUT
 
BOOLEAN
 *
pC™˚Œed
)

3710 i‡(
pTimî
->
VÆid
)

3712 i‡(
pTimî
->
Sèã
 =
FALSE
)

3715 if(
	`timî_≥ndög
(&
pTimî
->
TimîObj
))

3716 *
pC™˚Œed
 = 
	`dñ_timî_sync
(&
pTimî
->
TimîObj
);

3718 *
pC™˚Œed
 = 
TRUE
;

3721 *
pC™˚Œed
=
pTimî
->
Sèã
;

3723 i‡(*
pC™˚Œed
 =
TRUE
)

3724 
pTimî
->
Sèã
 = 
TRUE
;

3726 if(*
pC™˚Œed
==
FALSE
)

3727 
	`DBGPRINT_ERR
("CancelTimer failed ...............!\n");

3730 
	`DBGPRINT_ERR
("NdisMCancelTimer failed, Timer hasn't been initialize!\n");

3731 
	}
}

	@rtmp_main.c

40 
	~"π_c⁄fig.h
"

42 
ULONG
 
	gRTDebugLevñ
 = 
RT_DEBUG_TRACE
;

44 *
	gho°«me
 = "";

45 #i‡
LINUX_VERSION_CODE
 <
KERNEL_VERSION
(2,6,12)

46 
MODULE_PARM
 (
ho°«me
, "s");

48 
moduÀ_∑øm
 (
ho°«me
, 
ch¨p
, 0);

50 
MODULE_PARM_DESC
 (
ho°«me
, "Host Name");

56 
MODULE_AUTHOR
("Paul Lin <paul_lin@ralinktech.com>");

57 
MODULE_DESCRIPTION
("RT73 Wireless Lan Linux Driver");

60 
MODULE_LICENSE
("GPL");

66 
	gmlme_kûl
;

67 
	gRTUSBCmd_kûl
;

70 c⁄° 
iw_h™dÀr_def
 
π73_iw_h™dÀr_def
;

74 
usb_devi˚_id
 
	gπusb_usb_id
[] = 
RT73_USB_DEVICES
;

75 
INT
 c⁄° 
	gπusb_usb_id_Àn
 = (
πusb_usb_id
Ë/ (
usb_devi˚_id
);

76 
MODULE_DEVICE_TABLE
(
usb
, 
πusb_usb_id
);

79 #i‚de‡
PF_NOFREEZE


80 
	#PF_NOFREEZE
 0

	)

83 
usb_πusb_öô_devi˚
(

84 
√t_devi˚
 *
√t_dev
);

86 
usb_πusb_˛o£_devi˚
(

87 
IN
 
PRTMP_ADAPTER
 
pAd
);

94 #i‡
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,5,0)

97 
usb_πusb_disc⁄√˘
(
usb_devi˚
 *
dev
, *
±r
);

98 *
usb_πusb_¥obe
(
usb_devi˚
 *
dev
, 
UINT
 
öãrÁ˚
,

99 c⁄° 
usb_devi˚_id
 *
id_èbÀ
);

101 
usb_drivî
 
	gπusb_drivî
 = {

102 
«me
:"rt73",

103 
¥obe
:
usb_πusb_¥obe
,

104 
disc⁄√˘
:
usb_πusb_disc⁄√˘
,

105 
id_èbÀ
:
πusb_usb_id
,

114 
usb_πusb_¥obe
 (
usb_öãrÁ˚
 *
ötf
,

115 c⁄° 
usb_devi˚_id
 *
id
);

117 
usb_πusb_disc⁄√˘
(
usb_öãrÁ˚
 *
ötf
);

119 #ifde‡
CONFIG_PM


120 
π73_su•íd
(
usb_öãrÁ˚
 *
ötf
, 
pm_mesßge_t
 
°©e
);

121 
π73_ªsume
(
usb_öãrÁ˚
 *
ötf
);

124 
usb_drivî
 
	gπusb_drivî
 = {

125 #i‡
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,15)

126 .
ow√r
 = 
THIS_MODULE
,

128 .
	g«me
="rt73",

129 .
	g¥obe
=
usb_πusb_¥obe
,

130 .
	gdisc⁄√˘
=
usb_πusb_disc⁄√˘
,

131 .
	gid_èbÀ
=
πusb_usb_id
,

132 #ifde‡
CONFIG_PM


133 .
	gsu•íd
 = 
π73_su•íd
,

134 .
	gªsume
 = 
π73_ªsume
,

142 
	#CSR_REG_BASE
 
MAC_CSR0


	)

143 
	#CSR_REG_SIZE
 0x04b0

	)

144 
	#EEPROM_BASE
 0x0000

	)

145 
	#EEPROM_SIZE
 0x0100

	)

147 #ifde‡
CONFIG_PM


149 
	$π73_su•íd
(
usb_öãrÁ˚
 *
ötf
, 
pm_mesßge_t
 
°©e
)

151 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTER)
NULL
;

153 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"--->Ñt73_suspend()\n");

155 
pAd
 = 
	`usb_gë_ötfd©a
(
ötf
);

159 
	`RTUSB_Víd‹Reque°
(
pAd
,

161 
DEVICE_VENDOR_REQUEST_OUT
,

165 
NULL
,

169 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
);

170 
	`MlmeRadioOff
(
pAd
);

172 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"<---Ñt73_suspend()\n");

174 
	}
}

177 
	$π73_ªsume
(
usb_öãrÁ˚
 *
ötf
)

179 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTER)
NULL
;

181 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"--->Ñt73_resume()\n");

183 
pAd
 = 
	`usb_gë_ötfd©a
(
ötf
);

185 
	`MlmeRadioOn
(
pAd
);

186 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
);

188 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"<---Ñt73_resume()\n");

191 
	}
}

195 
	$π73_gë_drvöfo
(
√t_devi˚
 *
√t_dev
,

196 
ëhtoﬁ_drvöfo
 *
drvöfo
)

198 
PRTMP_ADAPTER
 
pAd
 = 
	`RTMP_OS_NETDEV_GET_PRIV
(
√t_dev
);

200 
	`°r˝y
(
drvöfo
->
drivî
, 
NIC_DEVICE_NAME
);

201 
	`°r˝y
(
drvöfo
->
vîsi⁄
, 
DRIVER_VERSION
);

203 
	`¢¥ötf
(
drvöfo
->
fw_vîsi⁄
, (drvöfo->fw_vîsi⁄), "%d(%d)", 
pAd
->
Fúmw¨eVîsi⁄
,ÖAd->
EïromVîsi⁄
);

204 
	`usb_make_∑th
(
pAd
->
pUsb_Dev
, 
drvöfo
->
bus_öfo
, (drvinfo->bus_info));

205 
	}
}

208 
	$π73_gë_ªgs_Àn
(
√t_devi˚
 *
√t_dev
)

210  
CSR_REG_SIZE
;

211 
	}
}

214 
	$π73_gë_ªgs
(
√t_devi˚
 *
√t_dev
,

215 
ëhtoﬁ_ªgs
 *
ªgs
, *
d©a
)

217 
PRTMP_ADAPTER
 
pAd
 = 
	`RTMP_OS_NETDEV_GET_PRIV
(
√t_dev
);

218 
cou¡î
;

220 
ªgs
->
Àn
 = 
CSR_REG_SIZE
;

222 
cou¡î
 = 0; cou¡î < 
CSR_REG_SIZE
; cou¡î +(
UINT32
)) {

223 
	`RTUSBRódMACRegi°î
(
pAd
, 
CSR_REG_BASE
 + 
cou¡î
, (
PULONG
)
d©a
);

224 
d©a
 +(
UINT32
);

226 
	}
}

229 
uöt32
 
	$π73_ëhtoﬁ_gë_lök
(
√t_devi˚
 *
dev
)

231 
RTMP_ADAPTER
 *
pAd
;

233 
	`ASSERT
((
dev
));

234 
pAd
 = (
PRTMP_ADAPTER
Ë
	`RTMP_OS_NETDEV_GET_PRIV
(
dev
);

237 (
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
));

238 
	}
}

241 
	$π73_gë_ì¥om_Àn
(
√t_devi˚
 *
√t_dev
)

243  
EEPROM_SIZE
;

244 
	}
}

247 
	$π73_gë_ì¥om
(
√t_devi˚
 *
√t_dev
,

248 
ëhtoﬁ_ì¥om
 *
ì¥om
, 
u8
 *
d©a
)

250 
PRTMP_ADAPTER
 
pAd
 = 
	`RTMP_OS_NETDEV_GET_PRIV
(
√t_dev
);

251 
cou¡î
;

253 
cou¡î
 = 
ì¥om
->
off£t
; cou¡î <Éïrom->
Àn
; cou¡î +(
USHORT
)) {

254 
USHORT
 
vÆue
 = 0;

255 
	`RTUSBRódEEPROM
(
pAd
, 
CSR_REG_BASE
 + 
cou¡î
, (
PUCHAR
)&
vÆue
, (
USHORT
));

256 
	`mem˝y
(
d©a
, &
vÆue
, (
USHORT
));

257 
d©a
 +(
USHORT
);

261 
	}
}

263 #i‡
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,19)

264 
ëhtoﬁ_›s
 
	gπ73_ëhtoﬁ_›s
 = {

266 c⁄° 
ëhtoﬁ_›s
 
π73_ëhtoﬁ_›s
 = {

268 .
gë_drvöfo
 = 
π73_gë_drvöfo
,

269 .
	ggë_ªgs_Àn
 = 
π73_gë_ªgs_Àn
,

270 .
	ggë_ªgs
 = 
π73_gë_ªgs
,

271 .
	ggë_lök
 = 
π73_ëhtoﬁ_gë_lök
,

272 .
	ggë_ì¥om_Àn
 = 
π73_gë_ì¥om_Àn
,

273 .
	ggë_ì¥om
 = 
π73_gë_ì¥om
,

279 
√t_devi˚_°©s
 *
	$π73_gë_ëhî_°©s
(

280 
IN
 
√t_devi˚
 *
√t_dev
)

282 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
√t_dev
);

284 
	`DBGPRINT
(
RT_DEBUG_INFO
, "rt73_get_ether_stats --->\n");

286 
pAd
->
°©s
.
rx_∑ckës
 =ÖAd->
WœnCou¡îs
.
Re˚ivedFøgmítCou¡
.
vv
.
LowP¨t
;

287 
pAd
->
°©s
.
tx_∑ckës
 =ÖAd->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
vv
.
LowP¨t
;

289 
pAd
->
°©s
.
rx_byãs
pAd->
RÆökCou¡îs
.
Re˚ivedByãCou¡
;

290 
pAd
->
°©s
.
tx_byãs
 =ÖAd->
RÆökCou¡îs
.
TønsmôãdByãCou¡
;

292 
pAd
->
°©s
.
rx_îr‹s
 =ÖAd->
Cou¡îs8023
.
RxEº‹s
;

293 
pAd
->
°©s
.
tx_îr‹s
 =ÖAd->
Cou¡îs8023
.
TxEº‹s
;

295 
pAd
->
°©s
.
rx_dr›≥d
 =ÖAd->
Cou¡îs8023
.
RxNoBuf„r
;

296 
pAd
->
°©s
.
tx_dr›≥d
 =ÖAd->
WœnCou¡îs
.
FaûedCou¡
.
vv
.
LowP¨t
;

298 
pAd
->
°©s
.
mu…iˇ°
 =ÖAd->
WœnCou¡îs
.
Mu…iˇ°Re˚ivedFømeCou¡
.
vv
.
LowP¨t
;

299 
pAd
->
°©s
.
cﬁlisi⁄s
 =ÖAd->
Cou¡îs8023
.
O√Cﬁlisi⁄
 +ÖAd->Cou¡îs8023.
M‹eCﬁlisi⁄s
;

301 
pAd
->
°©s
.
rx_Àngth_îr‹s
 = 0;

302 
pAd
->
°©s
.
rx_ovî_îr‹s
 =ÖAd->
Cou¡îs8023
.
RxNoBuf„r
;

303 
pAd
->
°©s
.
rx_¸c_îr‹s
 = 0;

304 
pAd
->
°©s
.
rx_‰ame_îr‹s
 =ÖAd->
Cou¡îs8023
.
RcvAlignmítEº‹s
;

305 
pAd
->
°©s
.
rx_fifo_îr‹s
 =ÖAd->
Cou¡îs8023
.
RxNoBuf„r
;

306 
pAd
->
°©s
.
rx_mis£d_îr‹s
 = 0;

309 
pAd
->
°©s
.
tx_ab‹ãd_îr‹s
 = 0;

310 
pAd
->
°©s
.
tx_ˇºõr_îr‹s
 = 0;

311 
pAd
->
°©s
.
tx_fifo_îr‹s
 = 0;

312 
pAd
->
°©s
.
tx_hóπbót_îr‹s
 = 0;

313 
pAd
->
°©s
.
tx_wödow_îr‹s
 = 0;

316 
pAd
->
°©s
.
rx_com¥es£d
 = 0;

317 
pAd
->
°©s
.
tx_com¥es£d
 = 0;

319  &
pAd
->
°©s
;

320 
	}
}

321 #i‡(
WIRELESS_EXT
 >= 12)

339 
	$π_abs
(
¨g
Ë{  (¨g<0)? -¨g :árg;
	}
}

340 
iw_°©i°ics
 *
	$π73_gë_wúñess_°©s
(

341 
IN
 
√t_devi˚
 *
√t_dev
)

343 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
√t_dev
);

345 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "rt73_get_wireless_stats --->\n");

349 
pAd
->
iw_°©s
.
°©us
 = 0;

351 
pAd
->
iw_°©s
.
quÆ
.quÆ =ÖAd->
Mlme
.
Ch™√lQuÆôy
;

352 #ifde‡
RTMP_EMBEDDED


353 
pAd
->
iw_°©s
.
quÆ
.
Àvñ
 = 
	`π_abs
’Ad->
P‹tCfg
.
La°Rssi
);

355 
pAd
->
iw_°©s
.
quÆ
.
Àvñ
 = 
	`abs
’Ad->
P‹tCfg
.
La°Rssi
);

357 
pAd
->
iw_°©s
.
quÆ
.
Àvñ
 +256 -ÖAd->
BbpRssiToDbmDñè
;

359 
pAd
->
iw_°©s
.
quÆ
.
noi£
 = (pAd->
BbpWrôeL©ch
[17] >ÖAd->
BbpTunög
.
R17UµîBoundG
Ë?ÖAd->BbpTunög.R17UµîBoundG : ((
ULONG
)ÖAd->BbpWriteLatch[17]);

360 
pAd
->
iw_°©s
.
quÆ
.
noi£
 += 256 - 143;

361 
pAd
->
iw_°©s
.
quÆ
.
upd©ed
 = 1;

363 
pAd
->
iw_°©s
.
disˇrd
.
nwid
 = 0;

364 
pAd
->
iw_°©s
.
miss
.
bóc⁄
 = 0;

368  &
pAd
->
iw_°©s
;

369 
	}
}

372 
VOID
 
	$RTUSBHÆt
(

373 
IN
 
PRTMP_ADAPTER
 
pAd
,

374 
IN
 
BOOLEAN
 
IsFªe
)

376 
BOOLEAN
 
TimîC™˚Œed
;

378 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "====> RTUSBHalt\n");

385 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
);

387 
	`RTUSBCÀ™UpMLMEWaôQueue
(
pAd
);

388 
	`RTUSBCÀ™UpMLMEBulkOutQueue
(
pAd
);

390 
	`RTMPC™˚lTimî
(&
pAd
->
P‹tCfg
.
QuickRe•⁄eF‹R©eUpTimî
,&
TimîC™˚Œed
);

391 
	`RTMPC™˚lTimî
(&
pAd
->
RxA¡
.
RxA¡DivîsôyTimî
,&
TimîC™˚Œed
);

394 
	`MlmeHÆt
(
pAd
);

397 
	`RTMPu£cDñay
(50000);

403 
	`RTUSBC™˚lPídögIRPs
(
pAd
);

406 
	`Rñó£Ad≠ãr
(
pAd
, 
IsFªe
, 
FALSE
);

408 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
);

409 
	}
}

411 
	$usb_πusb_˛o£_devi˚
(

412 
IN
 
PRTMP_ADAPTER
 
pAd
)

414 
i
 = 0;

415 
ªt
;

417 
	`DECLARE_WAIT_QUEUE_HEAD
 (
u∆ök_wakeup
);

418 
	`DECLARE_WAITQUEUE
 (
waô
, 
cuºít
);

420 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "-->usb_rtusb_close_device \n");

423 
	`add_waô_queue
 (&
u∆ök_wakeup
, &
waô
);

424 
pAd
->
waô
 = &
u∆ök_wakeup
;

427 (
i
 < 25Ë&& 
	`©omic_ªad
(&
pAd
->
PídögRx
) > 0)

429 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2,6,9)

430 
	`m¶ìp
(
UNLINK_TIMEOUT_MS
);

432 
i
++;

435 
pAd
->
waô
 = 
NULL
;

436 
	`ªmove_waô_queue
 (&
u∆ök_wakeup
, &
waô
);

438 i‡(
pAd
->
MLMEThr_pid
 >= 0)

440 
mlme_kûl
 = 1;

441 
	`RTUSBMlmeUp
(
pAd
);

442 
	`wmb
();

443 
ªt
 = 
	`KILL_THREAD_PID
 (
pAd
->
MLMEThr_pid
, 
SIGTERM
, 1);

444 i‡(
ªt
)

446 
	`¥ötk
 (
KERN_WARNING
 "%s: u«bÀÅÿMlmêthªad \n", 
pAd
->
√t_dev
->
«me
);

448 
	`waô_f‹_com∂ëi⁄
 (&
pAd
->
MlmeThªadNŸify
);

450 
pAd
->
MLMEThr_pid
 = 
THREAD_PID_INIT_VALUE
;

453 i‡(
pAd
->
RTUSBCmdThr_pid
>= 0)

455 
RTUSBCmd_kûl
 = 1;

456 
	`RTUSBCMDUp
(
pAd
);

457 
	`wmb
();

458 
ªt
 = 
	`KILL_THREAD_PID
 (
pAd
->
RTUSBCmdThr_pid
, 
SIGTERM
, 1);

459 i‡(
ªt
)

461 
	`¥ötk
 (
KERN_WARNING
 "%s: u«bÀÅÿRTUSBCmdÅhªad \n", 
pAd
->
√t_dev
->
«me
);

463 
	`waô_f‹_com∂ëi⁄
 (&
pAd
->
CmdThªadNŸify
);

465 
pAd
->
RTUSBCmdThr_pid

THREAD_PID_INIT_VALUE
;

468 
	`RTUSBHÆt
(
pAd
, 
TRUE
);

469 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_REMOVE_IN_PROGRESS
);

470 
	`èskÀt_kûl
(&
pAd
->
rx_bh
);

474 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"<--usb_rtusb_close_device \n");

477 
	}
}

479 
	$usb_πusb_›í
(
√t_devi˚
 *
√t_dev
)

481 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
√t_dev
);

482 
UCHAR
 
TmpPhy
;

483 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

487 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s-->\n", 
__FUNCTION__
);

489 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2,5,0)

490 i‡(!
	`åy_moduÀ_gë
(
THIS_MODULE
))

492 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "%s: c™nŸÑe£rvêmoduÀ\n", 
__FUNCTION__
);

496 
MOD_INC_USE_COUNT
;

499 
	`P‹tCfgInô
(
pAd
);

503 
ULONG
 
MacC§0
 = 0, 
Index
 = 0;

507 
Sètus
 = 
	`RTUSBRódMACRegi°î
(
pAd
, 
MAC_CSR0
, &
MacC§0
);

509 i‡(
MacC§0
 != 0)

512 
	`RTMPu£cDñay
(1000);

513 } 
Index
++ < 1000);

514 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Inô: MAC_CSR0=0x%08x, Sètus=0x%08x\n", 
MacC§0
, 
Sètus
);

519 #ifde‡ 
READ_PROFILE_FROM_FILE


520 
	`RTMPRódP¨amëîsFromFûe
(
pAd
);

527 #ifde‡
INIT_FROM_EEPROM


528 
	`NICRódEEPROMP¨amëîs
(
pAd
);

529 
	`NICInôAsicFromEEPROM
(
pAd
);

531 
	`RTUSBWrôeHWMACAddªss
(
pAd
);

534 i‡(
pAd
->
NicC⁄fig2
.
fõld
.
Exã∫ÆLNA
)

536 
pAd
->
BbpTunög
.
R17LowîBoundA
 += 0x10;

537 
pAd
->
BbpTunög
.
R17UµîBoundA
 += 0x10;

538 
pAd
->
BbpTunög
.
R17LowîBoundG
 += 0x10;

539 
pAd
->
BbpTunög
.
R17UµîBoundG
 += 0x10;

545 
TmpPhy
 = 
pAd
->
P‹tCfg
.
PhyMode
;

547 
	`RTMPSëPhyMode
(
pAd
, 
TmpPhy
);

550 i‡(
pAd
->
P‹tCfg
.
DeÁu…MaxDesúedR©e
 == 0)

551 
	`RTMPSëDesúedR©es
(
pAd
, -1);

553 
	`RTMPSëDesúedR©es
(
pAd
, (
LONG
Ë(
R©eIdToMbps
[pAd->
P‹tCfg
.
DeÁu…MaxDesúedR©e
 - 1] * 1000000));

555 
	`¥ötk
("=> usb_rtusb_open\n");

556 i‡(
	`VIRTUAL_IF_NUM
(
pAd
) == 0)

558 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR10
, 0x0718);

561 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
);

562 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_REMOVE_IN_PROGRESS
);

564 i‡(!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
))

566 
	`RTUSBBulkRe˚ive
(
pAd
);

567 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x025eb032);

569 
	`AsicSwôchCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

570 
	`AsicLockCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

572 
	`VIRTUAL_IF_INC
(
pAd
);

574 
	`√tif_°¨t_queue
(
√t_dev
);

575 
	`√tif_ˇºõr_⁄
(
√t_dev
);

576 
	`√tif_wake_queue
(
√t_dev
);

578 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s<--\n", 
__FUNCTION__
);

581 
	}
}

583 
	$usb_πusb_˛o£
(
√t_devi˚
 *
√t_dev
)

585 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
√t_dev
);

586 
i
 = 0;

587 
MLME_DISASSOC_REQ_STRUCT
 
DisReq
;

588 
MLME_QUEUE_ELEM
 
MsgEÀm
;

589 
waô_queue_hód_t
 
waô
;

594 
	`öô_waôqueue_hód
(&
waô
);

596 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s-->\n", 
__FUNCTION__
);

598 
	`√tif_ˇºõr_off
(
pAd
->
√t_dev
);

599 
	`√tif_°›_queue
(
pAd
->
√t_dev
);

601 i‡(
	`INFRA_ON
(
pAd
))

603 
	`COPY_MAC_ADDR
(
DisReq
.
Addr
, 
pAd
->
P‹tCfg
.
Bssid
);

604 
DisReq
.
Rós⁄
 = 
REASON_DISASSOC_STA_LEAVING
;

606 
MsgEÀm
.
Machöe
 = 
ASSOC_STATE_MACHINE
;

607 
MsgEÀm
.
MsgTy≥
 = 
MT2_MLME_DISASSOC_REQ
;

608 
MsgEÀm
.
MsgLí
 = (
MLME_DISASSOC_REQ_STRUCT
);

609 
	`NdisMoveMem‹y
(
MsgEÀm
.
Msg
, &
DisReq
, (
MLME_DISASSOC_REQ_STRUCT
));

611 
	`MlmeDißssocReqA˘i⁄
(
pAd
, &
MsgEÀm
);

612 
	`waô_evít_öãºu±ibÀ_timeout
(
waô
,0,
HZ
/1000);

615 
	`VIRTUAL_IF_DEC
(
pAd
);

616 i‡(
	`VIRTUAL_IF_NUM
(
pAd
) == 0)

618 
i
=0;i<10 || 
pAd
->
CmdH™dÀrIsRu¬ög
==
TRUE
;i++)

619 
	`waô_evít_öãºu±ibÀ_timeout
(
waô
,0,
HZ
/1000);

621 
i
=0;i<10 || 
pAd
->
Mlme
.
bRu¬ög
==
TRUE
;i++)

622 
	`waô_evít_öãºu±ibÀ_timeout
(
waô
,0,
HZ
/1000);

627 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR10
, 0x0018);

628 
i
=0; i<10; i++)

630 
	`RTMPSídNuŒFøme
(
pAd
, 
RATE_6
);

631 
	`RTMPu£cDñay
(1000);

635 
	`AsicDißbÀSync
(
pAd
);

637 
	`RTMPSëLED
(
pAd
, 
LED_HALT
);

638 
	`©omic_£t
(&
pAd
->
PídögRx
, 0);

641 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


647 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2,5,0)

648 
	`moduÀ_put
(
THIS_MODULE
);

650 
MOD_DEC_USE_COUNT
;

653 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s<--\n", 
__FUNCTION__
);

655 
	}
}

657 
INT
 
	$usb_πusb_£ndpkt
(

658 
IN
 
sk_buff
 *
pSkb
,

659 
IN
 
√t_devi˚
 *
√t_dev
)

663  
	`RTMPSídPackës
(
pSkb
, 
√t_dev
);

664 
	}
}

666 
	$usb_πusb_öô_devi˚
(
√t_devi˚
 *
√t_dev
)

668 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTERË
	`RTMP_OS_NETDEV_GET_PRIV
(
√t_dev
);

669 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

670 
UCHAR
 
TmpPhy
;

672 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s-->\n", 
__FUNCTION__
);

675 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
);

678 
	`èskÀt_öô
(&
pAd
->
rx_bh
, 
RTUSBBulkRxH™dÀ
, ()pAd);

681 
	`P‹tCfgInô
(
pAd
);

685 
Sètus
 = 
	`RTMPInôAd≠ãrBlock
(
pAd
);

686 i‡(
Sètus
 !
NDIS_STATUS_SUCCESS
)

688  
Sètus
;

694 
Sètus
 = 
	`NICInôTønsmô
(
pAd
);

695 i‡(
Sètus
 !
NDIS_STATUS_SUCCESS
)

697  
Sètus
;

703 
Sètus
 = 
	`NICInôRecv
(
pAd
);

704 i‡(
Sètus
 !
NDIS_STATUS_SUCCESS
)

706 
out
;

712 
ULONG
 
MacC§0
 = 0, 
Index
 = 0;

716 
Sètus
 = 
	`RTUSBRódMACRegi°î
(
pAd
, 
MAC_CSR0
, &
MacC§0
);

718 i‡(
MacC§0
 != 0)

721 
	`RTMPu£cDñay
(1000);

722 } 
Index
++ < 1000);

723 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Inô: MAC_CSR0=0x%08x, Sètus=0x%08x\n", 
MacC§0
, 
Sètus
);

727 
Sètus
 = 
	`NICLﬂdFúmw¨e
(
pAd
);

728 if(
Sètus
 !
NDIS_STATUS_SUCCESS
)

730 
out
;

734 
	`NICInôülizeAsic
(
pAd
);

736 #ifde‡
BLOCK_NET_IF


737 
	`öôblockQueueTab
(
pAd
);

741 #ifde‡ 
READ_PROFILE_FROM_FILE


742 
	`RTMPRódP¨amëîsFromFûe
(
pAd
);

749 #ifdef 
INIT_FROM_EEPROM


750 
	`NICRódEEPROMP¨amëîs
(
pAd
);

751 
	`NICInôAsicFromEEPROM
(
pAd
);

753 
	`RTUSBWrôeHWMACAddªss
(
pAd
);

756 i‡(
pAd
->
NicC⁄fig2
.
fõld
.
Exã∫ÆLNA
)

758 
pAd
->
BbpTunög
.
R17LowîBoundA
 += 0x10;

759 
pAd
->
BbpTunög
.
R17UµîBoundA
 += 0x10;

760 
pAd
->
BbpTunög
.
R17LowîBoundG
 += 0x10;

761 
pAd
->
BbpTunög
.
R17UµîBoundG
 += 0x10;

766 
TmpPhy
 = 
pAd
->
P‹tCfg
.
PhyMode
;

767 
pAd
->
P‹tCfg
.
PhyMode
 = 0xff;

768 
	`RTMPSëPhyMode
(
pAd
, 
TmpPhy
);

770 i‡(
pAd
->
P‹tCfg
.
DeÁu…MaxDesúedR©e
 == 0)

771 
	`RTMPSëDesúedR©es
(
pAd
, -1);

773 
	`RTMPSëDesúedR©es
(
pAd
, (
LONG
Ë(
R©eIdToMbps
[pAd->
P‹tCfg
.
DeÁu…MaxDesúedR©e
 - 1] * 1000000));

778 
Sètus
 = 
	`MlmeInô
(
pAd
);

779 if(
Sètus
 !
NDIS_STATUS_SUCCESS
)

781 
out
;

785 
mlme_kûl
 = 0;

786 
RTUSBCmd_kûl
 =0;

787 
	`Cª©eThªads
(
√t_dev
);

790 
	`COPY_MAC_ADDR
(
pAd
->
√t_dev
->
dev_addr
,ÖAd->
CuºítAddªss
);

793 
pAd
->
Víd‹Desc
 = 0x148F2573;

795 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s<--\n", 
__FUNCTION__
);

799 
out
:

800 
	`Rñó£Ad≠ãr
(
pAd
, 
TRUE
, 
FALSE
);

801  
Sètus
;

803 
	}
}

805 
INT
 
	$MlmeThªad
(

806 
IN
 * 
C⁄ãxt
)

808 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTER)
C⁄ãxt
;

810 #i‡
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2,5,0)

811 
	`d´m⁄ize
();

813 
	`d´m⁄ize
("rt73");

815 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2,5,0)

816 
	`Ælow_sig«l
(
SIGTERM
);

818 
cuºít
->
Êags
 |
PF_NOFREEZE
;

820 
	`com∂ëe
(&(
pAd
->
MlmeThªadNŸify
));

824 
°©us
;

826 
°©us
 = 
	`down_öãºu±ibÀ
(&
pAd
->
mlme_£m≠h‹e
);

827 i‡(
°©us
 != 0)

830 i‡(
mlme_kûl
)

833 
	`MlmeH™dÀr
(
pAd
);

851 
	`com∂ëe_™d_exô
 (&
pAd
->
MlmeThªadNŸify
, 0);

852 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<---MlmeThread\n");

854 
	}
}

856 
INT
 
	$RTUSBCmdThªad
(

857 
IN
 * 
C⁄ãxt
)

859 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTER)
C⁄ãxt
;

862 #i‡
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2,5,0)

863 
	`d´m⁄ize
();

865 
	`d´m⁄ize
("rt73");

867 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2,5,0)

868 
	`Ælow_sig«l
(
SIGTERM
);

870 
cuºít
->
Êags
 |
PF_NOFREEZE
;

872 
	`com∂ëe
(&(
pAd
->
CmdThªadNŸify
));

876 
°©us
;

877 
°©us
 = 
	`down_öãºu±ibÀ
(&(
pAd
->
RTUSBCmd_£m≠h‹e
));

878 i‡(
°©us
 != 0)

881 i‡(
RTUSBCmd_kûl
)

883 
pAd
->
CmdH™dÀrIsRu¬ög
=
TRUE
;

884 
	`CMDH™dÀr
(
pAd
);

885 
pAd
->
CmdH™dÀrIsRu¬ög
=
FALSE
;

902 
	`com∂ëe_™d_exô
 (&
pAd
->
CmdThªadNŸify
, 0);

903 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<---RTUSBCmdThread\n");

905 
	}
}

907 #i‡
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,5,0)

908 *
	$usb_πusb_¥obe
(
usb_devi˚
 *
dev
, 
UINT
 
öãrÁ˚
,

909 c⁄° 
usb_devi˚_id
 *
id_èbÀ
)

911 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTER)
NULL
;

912 
i
;

913 
√t_devi˚
 *
√tdev
;

914 
ªs
 = -
ENOMEM
;

916 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s-->\n", 
__FUNCTION__
);

918 
i
 = 0; i < 
πusb_usb_id_Àn
; i++)

920 i‡(
dev
->
des¸ùt‹
.
idVíd‹
 =
πusb_usb_id
[
i
].idVendor &&

921 
dev
->
des¸ùt‹
.
idProdu˘
 =
πusb_usb_id
[
i
].idProduct)

923 
	`¥ötk
("idVíd‹ = 0x%x, idProdu˘ = 0x%x \n",
dev
->
des¸ùt‹
.
idVíd‹
, dev->des¸ùt‹.
idProdu˘
);

927 i‡(
i
 =
πusb_usb_id_Àn
) {

928 
	`¥ötk
("Device DescriptorÇot matching\n");

929  
NULL
;

932 
√tdev
 = 
	`Æloc_ëhîdev
((
PRTMP_ADAPTER
));

933 if(!
√tdev
)

935 
	`¥ötk
("alloc_etherdev failed\n");

937 
MOD_DEC_USE_COUNT
;

938 
	`usb_dec_dev_u£
(
dev
);

939  
NULL
;

942 
√tdev
->
¥iv
 = (
PVOID
)
	`vmÆloc
((
RTMP_ADAPTER
));

943 
pAd
 = 
√tdev
->
¥iv
;

945 if(
pAd
 =
NULL
)

947 
	`k‰ì
(
pAd
->
√t_dev
);

948 
	`¥ötk
("vmalloc failed\n");

949  
NULL
;

952 
	`NdisZîoMem‹y
(
pAd
, (
RTMP_ADAPTER
));

953 
pAd
->
√t_dev
 = 
√tdev
;

954 
	`√tif_°›_queue
(
√tdev
);

955 
pAd
->
c⁄fig
 = 
dev
->config;

956 
pAd
->
pUsb_Dev

dev
;

957 
	`SET_MODULE_OWNER
(
pAd
->
√t_dev
);

958 
	`ëhî_£tup
(
pAd
->
√t_dev
);

960 
√tdev
->
¥iv_Êags
 = 
INT_MAIN
;

961 
√tdev
->
›í
 = 
usb_πusb_›í
;

962 
√tdev
->
h¨d_°¨t_xmô
 = 
usb_πusb_£ndpkt
;

963 
√tdev
->
°›
 = 
usb_πusb_˛o£
;

964 
√tdev
->
¥iv
 = 
pAd
;

965 
√tdev
->
gë_°©s
 = 
π73_gë_ëhî_°©s
;

966 #i‡(
WIRELESS_EXT
 >= 12)

967 #i‡
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2,6,20)

968 
√tdev
->
gë_wúñess_°©s
 = 
π73_gë_wúñess_°©s
;

970 
√tdev
->
wúñess_h™dÀrs
 = (
iw_h™dÀr_def
 *Ë&
π73_iw_h™dÀr_def
;

972 
√tdev
->
do_io˘l
 = 
π73_io˘l
;

973 
pAd
->
√t_dev
->
h¨d_hódî_Àn
 = 14;

974 
pAd
->
√t_dev
->
mtu
 = 1500;

975 
pAd
->
√t_dev
->
addr_Àn
 = 6;

977 
pAd
->
√t_dev
->
weight
 = 64;

979 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
);

982 
i
=0;

983 
¶Ÿ_«me
[
IFNAMSIZ
];

984 
√t_devi˚
 *
devi˚
;

985 
usb_öãrÁ˚
 *
iÂ
&
dev
->
a˘c⁄fig
->
öãrÁ˚
[interface];

986 
usb_öãrÁ˚_des¸ùt‹
 *
as
;

987 
usb_ídpoöt_des¸ùt‹
 *
ï
;

989 
i
 = 0; i < 8; i++)

991 
	`•rötf
(
¶Ÿ_«me
, "øusb%d", 
i
);

993 
	`ªad_lock_bh
(&
dev_ba£_lock
);

995 
devi˚
 = 
dev_ba£
; devi˚ !
NULL
; devi˚ = devi˚->
√xt
)

998 i‡(
	`°∫cmp
(
devi˚
->
«me
, 
¶Ÿ_«me
, 4) == 0)

1003 
	`ªad_u∆ock_bh
(&
dev_ba£_lock
);

1005 if(
devi˚
 =
NULL
) ;

1008 if(
i
 == 8)

1010 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Noávailable slotÇame\n");

1011  
NULL
;

1014 
	`•rötf
(
pAd
->
√t_dev
->
«me
, "øusb%d", 
i
);

1015 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "usb devi˚Çamê%s\n",
pAd
->
√t_dev
->
«me
);

1019 
as
 = 
iÂ
->
Æt£âög
 + iÂ->
a˘_Æt£âög
;

1020 
ï
 = 
as
->
ídpoöt
;

1022 
pAd
->
BulkOutMaxPackëSize
 = (
USHORT
)
ï
[
i
].
wMaxPackëSize
;

1023 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "BulkOutMaxPackëSizê %d\n", 
pAd
->
BulkOutMaxPackëSize
);

1026 
ªs
 = 
	`ªgi°î_√tdev
(
pAd
->
√t_dev
);

1027 i‡(
ªs
)

1028 
out
;

1030 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
);

1032 i‡(
	`usb_πusb_öô_devi˚
(
pAd
->
√t_dev
)!=
NDIS_STATUS_SUCCESS
)

1033 
out
;

1036 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s<--\n", 
__FUNCTION__
);

1038  
pAd
;

1040 
out
:

1041 
	`¥ötk
("ªgi°î_√tdev faûedÉº=%d\n",
ªs
);

1042  
NULL
;

1043 
	}
}

1046 
	$usb_πusb_disc⁄√˘
(
usb_devi˚
 *
dev
, *
±r
)

1048 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTERË
±r
;

1049 
√t_devi˚
 *
√t_dev
 = 
NULL
;

1051 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s-->\n", 
__FUNCTION__
);

1053 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
);

1055 i‡(!
pAd
)

1058 i‡(
pAd
)

1059 
	`usb_πusb_˛o£_devi˚
(
pAd
);

1062 
	`udñay
(1);

1067 
√t_dev
 = 
pAd
->net_dev;

1068 if(
pAd
->
√t_dev
 !
NULL
)

1070 
	`¥ötk
("unregister_netdev()\n");

1071 
	`uƒegi°î_√tdev
 (
pAd
->
√t_dev
);

1073 
	`udñay
(1);

1074 
	`udñay
(1);

1077 
	`v‰ì
(
pAd
);

1079 i‡(
√t_dev
 !
NULL
)

1080 
	`k‰ì
(
√t_dev
);

1082 
MOD_IN_USE
 > 0) {

1083 
MOD_DEC_USE_COUNT
;

1085 
	`udñay
(1);

1087 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s<--\n", 
__FUNCTION__
);

1089 
	}
}

1092 
	$usb_πusb_¥obe
 (
usb_öãrÁ˚
 *
ötf
,

1093 c⁄° 
usb_devi˚_id
 *
id
)

1095 
usb_devi˚
 *
dev
 = 
	`öãrÁ˚_to_usbdev
(
ötf
);

1096 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTER)
NULL
;

1097 
i
;

1098 
√t_devi˚
 *
√tdev
;

1099 
ªs
 = -
ENOMEM
;

1101 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s-->\n", 
__FUNCTION__
);

1103 
	`usb_gë_dev
(
dev
);

1104 
i
 = 0; i < 
πusb_usb_id_Àn
; i++)

1106 i‡(
dev
->
des¸ùt‹
.
idVíd‹
 =
πusb_usb_id
[
i
].idVendor &&

1107 
dev
->
des¸ùt‹
.
idProdu˘
 =
πusb_usb_id
[
i
].idProduct)

1109 
	`¥ötk
("idVíd‹ = 0x%x, idProdu˘ = 0x%x \n",
dev
->
des¸ùt‹
.
idVíd‹
, dev->des¸ùt‹.
idProdu˘
);

1113 i‡(
i
 =
πusb_usb_id_Àn
) {

1114 
	`¥ötk
("Device DescriptorÇot matching\n");

1115  
ªs
;

1118 
√tdev
 = 
	`Æloc_ëhîdev
((
PRTMP_ADAPTER
));

1119 if(!
√tdev
)

1121 
	`¥ötk
("alloc_etherdev failed\n");

1122  
ªs
;

1126 
	`RTMP_OS_NETDEV_SET_PRIV
(
√tdev
,(
PVOID
)
	`vmÆloc
((
RTMP_ADAPTER
)));

1127 
pAd
=
	`RTMP_OS_NETDEV_GET_PRIV
(
√tdev
);

1132 if(!
pAd
)

1134 
	`‰ì_√tdev
(
√tdev
);

1135 
	`¥ötk
("vmalloc failed\n");

1136  
ªs
;

1139 
	`NdisZîoMem‹y
(
pAd
, (
RTMP_ADAPTER
));

1140 
pAd
->
√t_dev
 = 
√tdev
;

1141 
	`√tif_°›_queue
(
√tdev
);

1142 
pAd
->
c⁄fig
 = &
dev
->c⁄fig->
desc
;

1143 
pAd
->
pUsb_Dev
 = 
dev
;

1145 #i‡
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2,6,24)

1146 
	`SET_MODULE_OWNER
(
pAd
->
√t_dev
);

1150 
	`ëhî_£tup
(
pAd
->
√t_dev
);

1152 
√tdev
->
¥iv_Êags
 = 
INT_MAIN
;

1153 
√tdev
->
›í
 = 
usb_πusb_›í
;

1154 
√tdev
->
°›
 = 
usb_πusb_˛o£
;

1156 
√tdev
->
h¨d_°¨t_xmô
 = 
usb_πusb_£ndpkt
;

1157 
√tdev
->
gë_°©s
 = 
π73_gë_ëhî_°©s
;

1159 #i‡(
WIRELESS_EXT
 >= 12)

1160 #i‡
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2,6,20)

1161 
√tdev
->
gë_wúñess_°©s
 = 
π73_gë_wúñess_°©s
;

1163 
√tdev
->
wúñess_h™dÀrs
 = (
iw_h™dÀr_def
 *Ë&
π73_iw_h™dÀr_def
;

1165 
√tdev
->
do_io˘l
 = 
π73_io˘l
;

1167 
pAd
->
√t_dev
->
h¨d_hódî_Àn
 = 14;

1168 
pAd
->
√t_dev
->
mtu
 = 1500;

1169 
pAd
->
√t_dev
->
addr_Àn
 = 6;

1172 #i‡
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2,6,24)

1173 
pAd
->
√t_dev
->
weight
 = 64;

1177 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
);

1179 
pAd
->
MLMEThr_pid

THREAD_PID_INIT_VALUE
;

1180 
pAd
->
RTUSBCmdThr_pid

THREAD_PID_INIT_VALUE
;

1182 #i‡(
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2,5,0))

1183 
	`SET_ETHTOOL_OPS
(
pAd
->
√t_dev
, &
π73_ëhtoﬁ_›s
);

1185 #i‡(
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2,6,0))

1186 
	`SET_NETDEV_DEV
(
pAd
->
√t_dev
, &(
ötf
->
dev
));

1191 
i
=0;

1192 
¶Ÿ_«me
[
IFNAMSIZ
];

1193 
usb_ho°_öãrÁ˚
 *
iÁ˚_desc
;

1194 
usb_ídpoöt_des¸ùt‹
 *
ídpoöt
;

1195 
√t_devi˚
 *
devi˚
;

1197 
i
 = 0; i < 8; i++)

1199 
	`•rötf
(
¶Ÿ_«me
, "øusb%d", 
i
);

1201 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2,6,24)

1202 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2,6,26)

1203 
devi˚
 = 
	`dev_gë_by_«me
(
	`dev_√t
(
√tdev
), 
¶Ÿ_«me
);

1205 
devi˚
 = 
	`dev_gë_by_«me
(
√tdev
->
nd_√t
, 
¶Ÿ_«me
);

1208 
devi˚
 = 
	`dev_gë_by_«me
(
¶Ÿ_«me
);

1213 i‡(
devi˚
 =
NULL
)

1221 
	`dev_put
(
devi˚
);

1224 if(
i
 == 8)

1226 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Noávailable slotÇame\n");

1227  
ªs
;

1230 
	`•rötf
(
pAd
->
√t_dev
->
«me
, "øusb%d", 
i
);

1231 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "usb devi˚Çamê%s\n", 
pAd
->
√t_dev
->
«me
);

1235 
iÁ˚_desc
 = 
ötf
->
cur_Æt£âög
;

1238 
ídpoöt
 = &
iÁ˚_desc
->ídpoöt[
i
].
desc
;

1241 
pAd
->
BulkOutMaxPackëSize
 = (
USHORT
)
ídpoöt
->
wMaxPackëSize
;

1242 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "BulkOutMaxPackëSizê %d\n", 
pAd
->
BulkOutMaxPackëSize
);

1246 
ªs
 = 
	`ªgi°î_√tdev
(
pAd
->
√t_dev
);

1247 i‡(
ªs
)

1248 
out
;

1250 
	`usb_£t_ötfd©a
(
ötf
, 
pAd
);

1252 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
);

1254 i‡(
	`usb_πusb_öô_devi˚
(
pAd
->
√t_dev
)!=
NDIS_STATUS_SUCCESS
)

1255 
out
;

1258 
pAd
->
ProbeFöish
 = 
TRUE
;

1262 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s<--\n", 
__FUNCTION__
);

1266 
out
:

1267 
	`¥ötk
("ªgi°î_√tdev faûedÉº=%d\n",
ªs
);

1268 
	`‰ì_√tdev
(
√tdev
);

1271 
	}
}

1273 
	$usb_πusb_disc⁄√˘
(
usb_öãrÁ˚
 *
ötf
)

1275 
√t_devi˚
 *
√t_dev
 = 
NULL
;

1276 
usb_devi˚
 *
dev
 = 
	`öãrÁ˚_to_usbdev
(
ötf
);

1277 
PRTMP_ADAPTER
 
pAd
 = (PRTMP_ADAPTER)
NULL
;

1278 
pAd
 = 
	`usb_gë_ötfd©a
(
ötf
);

1280 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s-->\n", 
__FUNCTION__
);

1282 
	`usb_£t_ötfd©a
(
ötf
, 
NULL
);

1283 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
);

1284 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "unregister usbnet usb-%s-%s\n",

1285 
dev
->
bus
->
bus_«me
, dev->
dev∑th
);

1287 i‡(!
pAd
)

1290 i‡(
pAd
)

1291 
	`usb_πusb_˛o£_devi˚
(
pAd
);

1294 
	`udñay
(1);

1298 
√t_dev
 = 
pAd
->net_dev;

1299 if(
pAd
->
√t_dev
!
NULL
)

1301 
	`¥ötk
("unregister_netdev()\n");

1302 
	`uƒegi°î_√tdev
 (
pAd
->
√t_dev
);

1304 
	`udñay
(1);

1305 
	`Êush_scheduÀd_w‹k
 ();

1306 
	`udñay
(1);

1309 
	`v‰ì
(
pAd
);

1311 i‡(
√t_dev
 !
NULL
)

1312 
	`‰ì_√tdev
(
√t_dev
);

1314 
	`usb_put_dev
(
dev
);

1315 
	`udñay
(1);

1317 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s<--\n", 
__FUNCTION__
);

1319 
	}
}

1326 
INT
 
__öô
 
	$usb_πusb_öô
()

1328 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s-->\n", 
__FUNCTION__
);

1330  
	`usb_ªgi°î
(&
πusb_drivî
);

1331 
	}
}

1336 
VOID
 
__exô
 
	$usb_πusb_exô
()

1338 
	`udñay
(1);

1339 
	`udñay
(1);

1340 
	`usb_dîegi°î
(&
πusb_drivî
);

1342 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s<--\n", 
__FUNCTION__
);

1343 
	}
}

1345 
moduÀ_öô
(
usb_πusb_öô
);

1346 
moduÀ_exô
(
usb_πusb_exô
);

	@rtmp_tkip.c

38 
	~"π_c⁄fig.h
"

41 
	#ROL32
–
A
, 
n
 ) \

42 –((
A
Ë<< (
n
)Ë| ( ((A)>>(32-“))Ë& ( (1UL << (n)Ë- 1 ) ) )

	)

43 
	#ROR32
–
A
, 
n
 ) 
	`ROL32
–(A), 32-“Ë)

	)

45 
UINT
 
	gTkù_Sbox_Lowî
[256] =

81 
UINT
 
	gTkù_Sbox_Uµî
[256] =

121 
UCHAR
 
	gSboxTabÀ
[256] =

157 
VOID
 
x‹_32
(

158 
IN
 
PUCHAR
 
a
,

159 
IN
 
PUCHAR
 
b
,

160 
OUT
 
PUCHAR
 
out
);

162 
VOID
 
x‹_128
(

163 
IN
 
PUCHAR
 
a
,

164 
IN
 
PUCHAR
 
b
,

165 
OUT
 
PUCHAR
 
out
);

167 
VOID
 
√xt_key
(

168 
IN
 
PUCHAR
 
key
,

169 
IN
 
INT
 
round
);

171 
VOID
 
byã_sub
(

172 
IN
 
PUCHAR
 
ö
,

173 
OUT
 
PUCHAR
 
out
);

175 
VOID
 
shi·_row
(

176 
IN
 
PUCHAR
 
ö
,

177 
OUT
 
PUCHAR
 
out
);

179 
VOID
 
mix_cﬁumn
(

180 
IN
 
PUCHAR
 
ö
,

181 
OUT
 
PUCHAR
 
out
);

183 
UCHAR
 
RTMPCkùSbox
(

184 
IN
 
UCHAR
 
a
);

203 
ULONG
 
	$RTMPTkùGëUI¡32
(

204 
IN
 
PUCHAR
 
pMICKey
)

206 
ULONG
 
ªs
 = 0;

207 
INT
 
i
;

209 
i
 = 0; i < 4; i++)

211 
ªs
 |(*
pMICKey
++Ë<< (8 * 
i
);

214  
ªs
;

215 
	}
}

234 
VOID
 
	$RTMPTkùPutUI¡32
(

235 
IN
 
OUT
 
PUCHAR
 
pD°
,

236 
IN
 
ULONG
 
vÆ
)

238 
INT
 
i
;

240 
i
 = 0; i < 4; i++)

242 *
pD°
++ = (
UCHAR
Ë(
vÆ
 & 0xff);

243 
vÆ
 >>= 8;

245 
	}
}

264 
VOID
 
	$RTMPTkùSëMICKey
(

265 
IN
 
PTKIP_KEY_INFO
 
pTkù
,

266 
IN
 
PUCHAR
 
pMICKey
)

269 
pTkù
->
K0
 = 
	`RTMPTkùGëUI¡32
(
pMICKey
);

270 
pTkù
->
K1
 = 
	`RTMPTkùGëUI¡32
(
pMICKey
 + 4);

272 
pTkù
->
L
 =ÖTkù->
K0
;

273 
pTkù
->
R
 =ÖTkù->
K1
;

274 
pTkù
->
nByãsInM
 = 0;

275 
pTkù
->
M
 = 0;

276 
	}
}

295 
VOID
 
	$RTMPTkùAµídByã
(

296 
IN
 
PTKIP_KEY_INFO
 
pTkù
,

297 
IN
 
UCHAR
 
uCh¨
)

300 
pTkù
->
M
 |(
uCh¨
 << (8*ÖTkù->
nByãsInM
));

301 
pTkù
->
nByãsInM
++;

303 if–
pTkù
->
nByãsInM
 >= 4 )

305 
pTkù
->
L
 ^pTkù->
M
;

306 
pTkù
->
R
 ^
	`ROL32
–pTkù->
L
, 17 );

307 
pTkù
->
L
 +pTkù->
R
;

308 
pTkù
->
R
 ^(’Tkù->
L
 & 0xff00ff00) >> 8) | ((pTkip->L & 0x00ff00ff) << 8);

309 
pTkù
->
L
 +pTkù->
R
;

310 
pTkù
->
R
 ^
	`ROL32
–pTkù->
L
, 3 );

311 
pTkù
->
L
 +pTkù->
R
;

312 
pTkù
->
R
 ^
	`ROR32
–pTkù->
L
, 2 );

313 
pTkù
->
L
 +pTkù->
R
;

315 
pTkù
->
M
 = 0;

316 
pTkù
->
nByãsInM
 = 0;

318 
	}
}

338 
VOID
 
	$RTMPTkùAµíd
(

339 
IN
 
PTKIP_KEY_INFO
 
pTkù
,

340 
IN
 
PUCHAR
 
pSrc
,

341 
IN
 
UINT
 
nByãs
)

344 
nByãs
 > 0)

346 
	`RTMPTkùAµídByã
(
pTkù
, *
pSrc
++);

347 
nByãs
--;

349 
	}
}

367 
VOID
 
	$RTMPTkùGëMIC
(

368 
IN
 
PTKIP_KEY_INFO
 
pTkù
)

371 
	`RTMPTkùAµídByã
(
pTkù
, 0x5a );

372 
	`RTMPTkùAµídByã
(
pTkù
, 0 );

373 
	`RTMPTkùAµídByã
(
pTkù
, 0 );

374 
	`RTMPTkùAµídByã
(
pTkù
, 0 );

375 
	`RTMPTkùAµídByã
(
pTkù
, 0 );

377  
pTkù
->
nByãsInM
 != 0 )

379 
	`RTMPTkùAµídByã
(
pTkù
, 0 );

382 
	`RTMPTkùPutUI¡32
(
pTkù
->
MIC
,ÖTkù->
L
);

383 
	`RTMPTkùPutUI¡32
(
pTkù
->
MIC
 + 4,ÖTkù->
R
);

384 
	}
}

406 
VOID
 
	$RTMPInôTkùEngöe
(

407 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

408 
IN
 
PUCHAR
 
pKey
,

409 
IN
 
UCHAR
 
KeyId
,

410 
IN
 
PUCHAR
 
pTA
,

411 
IN
 
PUCHAR
 
pMICKey
,

412 
IN
 
PUCHAR
 
pTSC
,

413 
OUT
 
PULONG
 
pIV16
,

414 
OUT
 
PULONG
 
pIV32
)

416 
TKIP_IV
 
tkùIv
;

419 
	`NdisZîoMem‹y
(&
tkùIv
, (
TKIP_IV
));

420 
tkùIv
.
IV16
.
fõld
.
rc0
 = *(
pTSC
 + 1);

421 
tkùIv
.
IV16
.
fõld
.
rc1
 = (tkùIv.IV16.fõld.
rc0
 | 0x20) & 0x7f;

422 
tkùIv
.
IV16
.
fõld
.
rc2
 = *
pTSC
;

423 
tkùIv
.
IV16
.
fõld
.
CONTROL
.fõld.
ExtIV
 = 1;

424 
tkùIv
.
IV16
.
fõld
.
CONTROL
.fõld.
KeyID
 = 
KeyId
;

425 
	`NdisMoveMem‹y
(&
tkùIv
.
IV32
, (
pTSC
 + 2), 4);

427 #ifde‡
BIG_ENDIAN


428 *
pIV16
 = (
tkùIv
.
IV16
.
fõld
.
rc0
<<24Ë| (tkùIv.IV16.fõld.
rc1
<<16Ë| (tkùIv.IV16.fõld.
rc2
<<8Ë| (tkùIv.IV16.fõld.
CONTROL
.
Byã
);

430 *
pIV16
 = 
tkùIv
.
IV16
.
w‹d
;

432 *
pIV32
 = 
tkùIv
.
IV32
;

433 
	}
}

456 
VOID
 
	$RTMPInôMICEngöe
(

457 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

458 
IN
 
PUCHAR
 
pKey
,

459 
IN
 
PUCHAR
 
pDA
,

460 
IN
 
PUCHAR
 
pSA
,

461 
IN
 
UCHAR
 
U£rPri‹ôy
,

462 
IN
 
PUCHAR
 
pMICKey
)

464 
ULONG
 
Pri‹ôy
 = 
U£rPri‹ôy
;

467 
	`RTMPTkùSëMICKey
(&
pAd≠ãr
->
Priv©eInfo
.
Tx
, 
pMICKey
);

469 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Tx
, 
pDA
, 
MAC_ADDR_LEN
);

471 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Tx
, 
pSA
, 
MAC_ADDR_LEN
);

473 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Tx
, (
PUCHAR
)&
Pri‹ôy
, 4);

474 
	}
}

498 
BOOLEAN
 
	$RTMPTkùCom∑ªMICVÆue
(

499 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

500 
IN
 
PUCHAR
 
pSrc
,

501 
IN
 
PUCHAR
 
pDA
,

502 
IN
 
PUCHAR
 
pSA
,

503 
IN
 
PUCHAR
 
pMICKey
,

504 
IN
 
UINT
 
Lí
)

506 
UCHAR
 
OldMic
[8];

507 
ULONG
 
Pri‹ôy
 = 0;

508 
INT
 
i
;

511 
	`RTMPTkùSëMICKey
(&
pAd≠ãr
->
Priv©eInfo
.
Rx
, 
pMICKey
);

513 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Rx
, 
pDA
, 
MAC_ADDR_LEN
);

515 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Rx
, 
pSA
, 
MAC_ADDR_LEN
);

517 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Rx
, (
PUCHAR
)&
Pri‹ôy
, 4);

520 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Rx
, 
pSrc
, 
Lí
);

523 
	`NdisMoveMem‹y
(
OldMic
, 
pSrc
 + 
Lí
, 8);

526 
	`RTMPTkùGëMIC
(&
pAd≠ãr
->
Priv©eInfo
.
Rx
);

530 if(!
	`NdisEquÆMem‹y
(
pAd≠ãr
->
Priv©eInfo
.
Rx
.
MIC
, 
OldMic
, 8))

532 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "! TKIP MIC Error !\n");

533 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "Orig MIC value =");

534 
i
 = 0; i < 8; i++)

536 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "%02x:", 
OldMic
[
i
]);

538 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "\n");

539 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "Calculated MIC value =");

540 
i
 = 0; i < 8; i++)

542 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "%02x:", 
pAd≠ãr
->
Priv©eInfo
.
Rx
.
MIC
[
i
]);

544 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "\n");

545  (
FALSE
);

547  (
TRUE
);

548 
	}
}

573 
BOOLEAN
 
	$RTMPTkùCom∑ªMICVÆueWôhLLC
(

574 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

575 
IN
 
PUCHAR
 
pLLC
,

576 
IN
 
PUCHAR
 
pSrc
,

577 
IN
 
PUCHAR
 
pDA
,

578 
IN
 
PUCHAR
 
pSA
,

579 
IN
 
PUCHAR
 
pMICKey
,

580 
IN
 
UINT
 
Lí
)

582 
UCHAR
 
OldMic
[8];

583 
ULONG
 
Pri‹ôy
 = 0;

584 
INT
 
i
;

587 
	`RTMPTkùSëMICKey
(&
pAd≠ãr
->
Priv©eInfo
.
Rx
, 
pMICKey
);

589 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Rx
, 
pDA
, 
MAC_ADDR_LEN
);

591 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Rx
, 
pSA
, 
MAC_ADDR_LEN
);

593 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Rx
, (
PUCHAR
)&
Pri‹ôy
, 4);

596 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Rx
, 
pLLC
, 8);

599 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Rx
, 
pSrc
, 
Lí
);

602 
	`NdisMoveMem‹y
(
OldMic
, 
pSrc
 + 
Lí
, 8);

605 
	`RTMPTkùGëMIC
(&
pAd≠ãr
->
Priv©eInfo
.
Rx
);

609 if(!
	`NdisEquÆMem‹y
(
pAd≠ãr
->
Priv©eInfo
.
Rx
.
MIC
, 
OldMic
, 8))

611 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "! TKIP MIC Error !\n");

612 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "Orig MIC value =");

613 
i
 = 0; i < 8; i++)

615 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "%02x:", 
OldMic
[
i
]);

617 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "\n");

618 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "Calculated MIC value =");

619 
i
 = 0; i < 8; i++)

621 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "%02x:", 
pAd≠ãr
->
Priv©eInfo
.
Rx
.
MIC
[
i
]);

623 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "\n");

624  (
FALSE
);

626  (
TRUE
);

627 
	}
}

648 
VOID
 
	$RTMPCÆcuœãMICVÆue
(

649 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

650 
IN
 
sk_buff
 *
pSkb
,

651 
IN
 
PUCHAR
 
pEnˇp
,

652 
IN
 
PCIPHER_KEY
 
pKey
)

654 
PVOID
 
pVútuÆAddªss
;

655 
UINT
 
Lígth
;

656 
PUCHAR
 
pSrc
;

657 
UCHAR
 
U£rPri‹ôy
;

659 
pVútuÆAddªss
 = 
pSkb
->
d©a
;

660 
Lígth
 = 
pSkb
->
Àn
;

662 
U£rPri‹ôy
 = 
	`RTMP_GET_PACKET_UP
(
pSkb
);

663 
pSrc
 = (
PUCHAR
Ë
pVútuÆAddªss
;

666 
	`RTMPInôMICEngöe
(

667 
pAd≠ãr
,

668 
pKey
->
Key
,

669 
pSrc
,

670 
pSrc
 + 6,

671 
U£rPri‹ôy
,

672 
pKey
->
TxMic
);

674 i‡(
pEnˇp
 !
NULL
)

677 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Tx
, 
pEnˇp
, 6);

679 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Tx
, 
pSrc
 + 12, 2);

681 
Lígth
 -= 14;

682 
pSrc
 += 14;

685 i‡(
Lígth
 > 0)

687 
	`RTMPTkùAµíd
(&
pAd≠ãr
->
Priv©eInfo
.
Tx
, 
pSrc
, 
Lígth
);

689 } 
FALSE
);

692 
	`RTMPTkùGëMIC
(&
pAd≠ãr
->
Priv©eInfo
.
Tx
);

693 
	}
}

702 
UINT
 
	$tkù_sbox
(
UINT
 
ödex
)

704 
UINT
 
ödex_low
;

705 
UINT
 
ödex_high
;

706 
UINT
 
À·
, 
right
;

708 
ödex_low
 = (
ödex
 % 256);

709 
ödex_high
 = ((
ödex
 >> 8) % 256);

711 
À·
 = 
Tkù_Sbox_Lowî
[
ödex_low
] + (
Tkù_Sbox_Uµî
[index_low] * 256);

712 
right
 = 
Tkù_Sbox_Uµî
[
ödex_high
] + (
Tkù_Sbox_Lowî
[index_high] * 256);

714  (
À·
 ^ 
right
);

715 
	}
}

717 
UINT
 
	$rŸr1
(
UINT
 
a
)

719 
b
;

721 i‡((
a
 & 0x01) == 0x01)

723 
b
 = (
a
 >> 1) | 0x8000;

727 
b
 = (
a
 >> 1) & 0x7fff;

729 
b
 = b % 65536;

730  
b
;

731 
	}
}

733 
VOID
 
	$RTMPTkùMixKey
(

734 
UCHAR
 *
key
,

735 
UCHAR
 *
è
,

736 
ULONG
 
≤l
,

737 
ULONG
 
≤h
,

738 
UCHAR
 *
rc4key
,

739 
UINT
 *
p1k
)

742 
UINT
 
tsc0
;

743 
UINT
 
tsc1
;

744 
UINT
 
tsc2
;

746 
UINT
 
µk0
;

747 
UINT
 
µk1
;

748 
UINT
 
µk2
;

749 
UINT
 
µk3
;

750 
UINT
 
µk4
;

751 
UINT
 
µk5
;

753 
INT
 
i
;

754 
INT
 
j
;

756 
tsc0
 = ()((
≤h
 >> 16) % 65536);

757 
tsc1
 = ()(
≤h
 % 65536);

758 
tsc2
 = ()(
≤l
 % 65536);

761 
p1k
[0] = 
tsc1
;

762 
p1k
[1] = 
tsc0
;

763 
p1k
[2] = (
UINT
)(
è
[0] + (ta[1]*256));

764 
p1k
[3] = (
UINT
)(
è
[2] + (ta[3]*256));

765 
p1k
[4] = (
UINT
)(
è
[4] + (ta[5]*256));

768 
i
=0; i<8; i++)

770 
j
 = 2*(
i
 & 1);

771 
p1k
[0] = (p1k[0] + 
	`tkù_sbox
–’1k[4] ^ ((256*
key
[1+
j
]) + key[j])) % 65536 )) % 65536;

772 
p1k
[1] = (p1k[1] + 
	`tkù_sbox
–’1k[0] ^ ((256*
key
[5+
j
]) + key[4+j])) % 65536 )) % 65536;

773 
p1k
[2] = (p1k[2] + 
	`tkù_sbox
–’1k[1] ^ ((256*
key
[9+
j
]) + key[8+j])) % 65536 )) % 65536;

774 
p1k
[3] = (p1k[3] + 
	`tkù_sbox
–’1k[2] ^ ((256*
key
[13+
j
]) + key[12+j])) % 65536 )) % 65536;

775 
p1k
[4] = (p1k[4] + 
	`tkù_sbox
–’1k[3] ^ (((256*
key
[1+
j
]) + key[j]))) % 65536 )) % 65536;

776 
p1k
[4] = (p1k[4] + 
i
) % 65536;

780 
µk0
 = 
p1k
[0];

781 
µk1
 = 
p1k
[1];

782 
µk2
 = 
p1k
[2];

783 
µk3
 = 
p1k
[3];

784 
µk4
 = 
p1k
[4];

785 
µk5
 = (
p1k
[4] + 
tsc2
) % 65536;

788 
µk0
 =Öpk0 + 
	`tkù_sbox
–(
µk5
 ^ ((256*
key
[1]) + key[0])) % 65536);

789 
µk1
 =Öpk1 + 
	`tkù_sbox
–(
µk0
 ^ ((256*
key
[3]) + key[2])) % 65536);

790 
µk2
 =Öpk2 + 
	`tkù_sbox
–(
µk1
 ^ ((256*
key
[5]) + key[4])) % 65536);

791 
µk3
 =Öpk3 + 
	`tkù_sbox
–(
µk2
 ^ ((256*
key
[7]) + key[6])) % 65536);

792 
µk4
 =Öpk4 + 
	`tkù_sbox
–(
µk3
 ^ ((256*
key
[9]) + key[8])) % 65536);

793 
µk5
 =Öpk5 + 
	`tkù_sbox
–(
µk4
 ^ ((256*
key
[11]) + key[10])) % 65536);

795 
µk0
 =Öpk0 + 
	`rŸr1
(
µk5
 ^ ((256*
key
[13]) + key[12]));

796 
µk1
 =Öpk1 + 
	`rŸr1
(
µk0
 ^ ((256*
key
[15]) + key[14]));

797 
µk2
 =Öpk2 + 
	`rŸr1
(
µk1
);

798 
µk3
 =Öpk3 + 
	`rŸr1
(
µk2
);

799 
µk4
 =Öpk4 + 
	`rŸr1
(
µk3
);

800 
µk5
 =Öpk5 + 
	`rŸr1
(
µk4
);

805 
tsc0
 = ()((
≤h
 >> 16) % 65536);

806 
tsc1
 = ()(
≤h
 % 65536);

807 
tsc2
 = ()(
≤l
 % 65536);

809 
rc4key
[0] = (
tsc2
 >> 8) % 256;

810 
rc4key
[1] = (((
tsc2
 >> 8) % 256) | 0x20) & 0x7f;

811 
rc4key
[2] = 
tsc2
 % 256;

812 
rc4key
[3] = ((
µk5
 ^ ((256*
key
[1]) + key[0])) >> 1) % 256;

814 
rc4key
[4] = 
µk0
 % 256;

815 
rc4key
[5] = (
µk0
 >> 8) % 256;

817 
rc4key
[6] = 
µk1
 % 256;

818 
rc4key
[7] = (
µk1
 >> 8) % 256;

820 
rc4key
[8] = 
µk2
 % 256;

821 
rc4key
[9] = (
µk2
 >> 8) % 256;

823 
rc4key
[10] = 
µk3
 % 256;

824 
rc4key
[11] = (
µk3
 >> 8) % 256;

826 
rc4key
[12] = 
µk4
 % 256;

827 
rc4key
[13] = (
µk4
 >> 8) % 256;

829 
rc4key
[14] = 
µk5
 % 256;

830 
rc4key
[15] = (
µk5
 >> 8) % 256;

831 
	}
}

840 
	$c⁄°ru˘_mic_hódî1
(

841 *
mic_hódî1
,

842 
hódî_Àngth
,

843 *
mpdu
)

845 
mic_hódî1
[0] = ()((
hódî_Àngth
 - 2) / 256);

846 
mic_hódî1
[1] = ()((
hódî_Àngth
 - 2) % 256);

847 
mic_hódî1
[2] = 
mpdu
[0] & 0xcf;

848 
mic_hódî1
[3] = 
mpdu
[1] & 0xc7;

849 
mic_hódî1
[4] = 
mpdu
[4];

850 
mic_hódî1
[5] = 
mpdu
[5];

851 
mic_hódî1
[6] = 
mpdu
[6];

852 
mic_hódî1
[7] = 
mpdu
[7];

853 
mic_hódî1
[8] = 
mpdu
[8];

854 
mic_hódî1
[9] = 
mpdu
[9];

855 
mic_hódî1
[10] = 
mpdu
[10];

856 
mic_hódî1
[11] = 
mpdu
[11];

857 
mic_hódî1
[12] = 
mpdu
[12];

858 
mic_hódî1
[13] = 
mpdu
[13];

859 
mic_hódî1
[14] = 
mpdu
[14];

860 
mic_hódî1
[15] = 
mpdu
[15];

861 
	}
}

869 
	$c⁄°ru˘_mic_hódî2
(

870 *
mic_hódî2
,

871 *
mpdu
,

872 
a4_exi°s
,

873 
qc_exi°s
)

875 
i
;

877 
i
 = 0; i<16; i++Ë
mic_hódî2
[i]=0x00;

879 
mic_hódî2
[0] = 
mpdu
[16];

880 
mic_hódî2
[1] = 
mpdu
[17];

881 
mic_hódî2
[2] = 
mpdu
[18];

882 
mic_hódî2
[3] = 
mpdu
[19];

883 
mic_hódî2
[4] = 
mpdu
[20];

884 
mic_hódî2
[5] = 
mpdu
[21];

887 
mic_hódî2
[6] = 
mpdu
[22] & 0x0f;

888 
mic_hódî2
[7] = 0x00;

890 i‡((!
qc_exi°s
Ë& 
a4_exi°s
)

892 
i
=0;i<6;i++Ë
mic_hódî2
[8+i] = 
mpdu
[24+i];

896 i‡(
qc_exi°s
 && (!
a4_exi°s
))

898 
mic_hódî2
[8] = 
mpdu
[24] & 0x0f;

899 
mic_hódî2
[9] = 
mpdu
[25] & 0x00;

902 i‡(
qc_exi°s
 && 
a4_exi°s
)

904 
i
=0;i<6;i++Ë
mic_hódî2
[8+i] = 
mpdu
[24+i];

906 
mic_hódî2
[14] = 
mpdu
[30] & 0x0f;

907 
mic_hódî2
[15] = 
mpdu
[31] & 0x00;

909 
	}
}

917 
	$c⁄°ru˘_mic_iv
(

918 *
mic_iv
,

919 
qc_exi°s
,

920 
a4_exi°s
,

921 *
mpdu
,

922 
∑ylﬂd_Àngth
,

923 *
≤_ve˘‹
)

925 
i
;

927 
mic_iv
[0] = 0x59;

928 i‡(
qc_exi°s
 && 
a4_exi°s
)

929 
mic_iv
[1] = 
mpdu
[30] & 0x0f;

930 i‡(
qc_exi°s
 && !
a4_exi°s
)

931 
mic_iv
[1] = 
mpdu
[24] & 0x0f;

932 i‡(!
qc_exi°s
)

933 
mic_iv
[1] = 0x00;

934 
i
 = 2; i < 8; i++)

935 
mic_iv
[
i
] = 
mpdu
[i + 8];

936 #ifde‡
CONSISTENT_PN_ORDER


937 
i
 = 8; i < 14; i++)

938 
mic_iv
[
i
] = 
≤_ve˘‹
[i - 8];

940 
i
 = 8; i < 14; i++)

941 
mic_iv
[
i
] = 
≤_ve˘‹
[13 - i];

943 
i
 = (
∑ylﬂd_Àngth
 / 256);

944 
i
 = (
∑ylﬂd_Àngth
 % 256);

945 
mic_iv
[14] = (Ë(
∑ylﬂd_Àngth
 / 256);

946 
mic_iv
[15] = (Ë(
∑ylﬂd_Àngth
 % 256);

948 
	}
}

957 
	$bôwi£_x‹
(*
öa
, *
öb
, *
out
)

959 
i
;

960 
i
=0; i<16; i++)

962 
out
[
i
] = 
öa
[i] ^ 
öb
[i];

964 
	}
}

967 
	$´s128k128d
(*
key
, *
d©a
, *
cùhîãxt
)

969 
round
;

970 
i
;

971 
öãrmedüãa
[16];

972 
öãrmedüãb
[16];

973 
round_key
[16];

975 
i
=0; i<16; i++Ë
round_key
[i] = 
key
[i];

977 
round
 = 0;Ñound < 11;Ñound++)

979 i‡(
round
 == 0)

981 
	`x‹_128
(
round_key
, 
d©a
, 
cùhîãxt
);

982 
	`√xt_key
(
round_key
, 
round
);

984 i‡(
round
 == 10)

986 
	`byã_sub
(
cùhîãxt
, 
öãrmedüãa
);

987 
	`shi·_row
(
öãrmedüãa
, 
öãrmedüãb
);

988 
	`x‹_128
(
öãrmedüãb
, 
round_key
, 
cùhîãxt
);

992 
	`byã_sub
(
cùhîãxt
, 
öãrmedüãa
);

993 
	`shi·_row
(
öãrmedüãa
, 
öãrmedüãb
);

994 
	`mix_cﬁumn
(&
öãrmedüãb
[0], &
öãrmedüãa
[0]);

995 
	`mix_cﬁumn
(&
öãrmedüãb
[4], &
öãrmedüãa
[4]);

996 
	`mix_cﬁumn
(&
öãrmedüãb
[8], &
öãrmedüãa
[8]);

997 
	`mix_cﬁumn
(&
öãrmedüãb
[12], &
öãrmedüãa
[12]);

998 
	`x‹_128
(
öãrmedüãa
, 
round_key
, 
cùhîãxt
);

999 
	`√xt_key
(
round_key
, 
round
);

1003 
	}
}

1005 
	$c⁄°ru˘_˘r_¥ñﬂd
(

1006 *
˘r_¥ñﬂd
,

1007 
a4_exi°s
,

1008 
qc_exi°s
,

1009 *
mpdu
,

1010 *
≤_ve˘‹
,

1011 
c
)

1014 
i
 = 0;

1015 
i
=0; i<16; i++Ë
˘r_¥ñﬂd
[i] = 0x00;

1016 
i
 = 0;

1018 
˘r_¥ñﬂd
[0] = 0x01;

1019 i‡(
qc_exi°s
 && 
a4_exi°s
Ë
˘r_¥ñﬂd
[1] = 
mpdu
[30] & 0x0f;

1020 i‡(
qc_exi°s
 && !
a4_exi°s
Ë
˘r_¥ñﬂd
[1] = 
mpdu
[24] & 0x0f;

1022 
i
 = 2; i < 8; i++)

1023 
˘r_¥ñﬂd
[
i
] = 
mpdu
[i + 8];

1024 #ifde‡
CONSISTENT_PN_ORDER


1025 
i
 = 8; i < 14; i++)

1026 
˘r_¥ñﬂd
[
i
] = 
≤_ve˘‹
[i - 8];

1028 
i
 = 8; i < 14; i++)

1029 
˘r_¥ñﬂd
[
i
] = 
≤_ve˘‹
[13 - i];

1031 
˘r_¥ñﬂd
[14] = (Ë(
c
 / 256);

1032 
˘r_¥ñﬂd
[15] = (Ë(
c
 % 256);

1034 
	}
}

1041 
BOOLEAN
 
	$RTMPSo·De¸y±TKIP
(

1042 
IN
 
PRTMP_ADAPTER
 
pAd
,

1043 
IN
 
PUCHAR
 
pD©a
,

1044 
IN
 
ULONG
 
D©aByãC¡
,

1045 
IN
 
UCHAR
 
U£rPri‹ôy
,

1046 
IN
 
PCIPHER_KEY
 
pW∑Key
)

1048 
UCHAR
 
KeyID
;

1049 
UINT
 
HódîLí
;

1050 
UCHAR
 
fc0
;

1051 
UCHAR
 
fc1
;

1052 
USHORT
 
fc
;

1053 
UINT
 
‰ame_ty≥
;

1054 
UINT
 
‰ame_subty≥
;

1055 
UINT
 
‰om_ds
;

1056 
UINT
 
to_ds
;

1057 
INT
 
a4_exi°s
;

1058 
INT
 
qc_exi°s
;

1059 
USHORT
 
duøti⁄
;

1060 
USHORT
 
£q_c⁄åﬁ
;

1061 
USHORT
 
qos_c⁄åﬁ
;

1062 
UCHAR
 
TA
[
MAC_ADDR_LEN
];

1063 
UCHAR
 
DA
[
MAC_ADDR_LEN
];

1064 
UCHAR
 
SA
[
MAC_ADDR_LEN
];

1065 
UCHAR
 
RC4Key
[16];

1066 
UINT
 
p1k
[5];

1067 
ULONG
 
≤l
;

1068 
ULONG
 
≤h
;

1069 
UINT
 
num_blocks
;

1070 
UINT
 
∑ylﬂd_ªmaödî
;

1071 
ARCFOURCONTEXT
 
ArcFourC⁄ãxt
;

1072 
ULONG
 
¸c32
 = 0;

1073 
ULONG
 
åaûfcs
 = 0;

1074 
UCHAR
 
MIC
[8];

1075 
UCHAR
 
TøûMIC
[8];

1077 #ifde‡
BIG_ENDIAN


1078 
	`RTMPFømeEndünCh™ge
(
pAd
, (
PUCHAR
)
pD©a
, 
DIR_READ
, 
FALSE
);

1081 
fc0
 = *
pD©a
;

1082 
fc1
 = *(
pD©a
 + 1);

1084 
fc
 = *((
PUSHORT
)
pD©a
);

1086 
‰ame_ty≥
 = ((
fc0
 >> 2) & 0x03);

1087 
‰ame_subty≥
 = ((
fc0
 >> 4) & 0x0f);

1089 
‰om_ds
 = (
fc1
 & 0x2) >> 1;

1090 
to_ds
 = (
fc1
 & 0x1);

1092 
a4_exi°s
 = (
‰om_ds
 & 
to_ds
);

1093 
qc_exi°s
 = ((
‰ame_subty≥
 == 0x08) ||

1094 (
‰ame_subty≥
 == 0x09) ||

1095 (
‰ame_subty≥
 == 0x0a) ||

1096 (
‰ame_subty≥
 == 0x0b)

1099 
HódîLí
 = 24;

1100 i‡(
a4_exi°s
)

1101 
HódîLí
 += 6;

1103 
KeyID
 = *((
PUCHAR
)(
pD©a
+ 
HódîLí
 + 3));

1104 
KeyID
 = KeyID >> 6;

1106 i‡(
pW∑Key
[
KeyID
].
KeyLí
 == 0)

1108 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RTMPSo·De¸y±TKIP faûed!(KeyID[%d] Lígth c™ÇŸ bê0)\n", 
KeyID
);

1109  
FALSE
;

1112 
duøti⁄
 = *((
PUSHORT
)(
pD©a
+2));

1114 
£q_c⁄åﬁ
 = *((
PUSHORT
)(
pD©a
+22));

1116 i‡(
qc_exi°s
)

1118 i‡(
a4_exi°s
)

1120 
qos_c⁄åﬁ
 = *((
PUSHORT
)(
pD©a
+30));

1124 
qos_c⁄åﬁ
 = *((
PUSHORT
)(
pD©a
+24));

1128 i‡(
to_ds
 =0 && 
‰om_ds
 == 1)

1130 
	`NdisMoveMem‹y
(
DA
, 
pD©a
+4, 
MAC_ADDR_LEN
);

1131 
	`NdisMoveMem‹y
(
SA
, 
pD©a
+16, 
MAC_ADDR_LEN
);

1132 
	`NdisMoveMem‹y
(
TA
, 
pD©a
+10, 
MAC_ADDR_LEN
);

1134 i‡(
to_ds
 =0 && 
‰om_ds
 == 0 )

1136 
	`NdisMoveMem‹y
(
TA
, 
pD©a
+10, 
MAC_ADDR_LEN
);

1137 
	`NdisMoveMem‹y
(
DA
, 
pD©a
+4, 
MAC_ADDR_LEN
);

1138 
	`NdisMoveMem‹y
(
SA
, 
pD©a
+10, 
MAC_ADDR_LEN
);

1140 i‡(
to_ds
 =1 && 
‰om_ds
 == 0)

1142 
	`NdisMoveMem‹y
(
SA
, 
pD©a
+10, 
MAC_ADDR_LEN
);

1143 
	`NdisMoveMem‹y
(
TA
, 
pD©a
+10, 
MAC_ADDR_LEN
);

1144 
	`NdisMoveMem‹y
(
DA
, 
pD©a
+16, 
MAC_ADDR_LEN
);

1146 i‡(
to_ds
 =1 && 
‰om_ds
 == 1)

1148 
	`NdisMoveMem‹y
(
TA
, 
pD©a
+10, 
MAC_ADDR_LEN
);

1149 
	`NdisMoveMem‹y
(
DA
, 
pD©a
+16, 
MAC_ADDR_LEN
);

1150 
	`NdisMoveMem‹y
(
SA
, 
pD©a
+22, 
MAC_ADDR_LEN
);

1153 
num_blocks
 = (
D©aByãC¡
 - 16) / 16;

1154 
∑ylﬂd_ªmaödî
 = (
D©aByãC¡
 - 16) % 16;

1156 
≤l
 = (*(
pD©a
 + 
HódîLí
)) * 256 + *(pData + HeaderLen + 2);

1157 
≤h
 = *((
PULONG
)(
pD©a
 + 
HódîLí
 + 4));

1158 
	`RTMPTkùMixKey
(
pW∑Key
[
KeyID
].
Key
, 
TA
, 
≤l
, 
≤h
, 
RC4Key
, 
p1k
);

1160 
	`ARCFOUR_INIT
(&
ArcFourC⁄ãxt
, 
RC4Key
, 16);

1162 
	`ARCFOUR_DECRYPT
(&
ArcFourC⁄ãxt
, 
pD©a
 + 
HódîLí
,ÖD©®+ HódîLí + 8, 
D©aByãC¡
 - HeaderLen - 8);

1163 
	`NdisMoveMem‹y
(&
åaûfcs
, 
pD©a
 + 
D©aByãC¡
 - 8 - 4, 4);

1164 
¸c32
 = 
	`RTMP_CALC_FCS32
(
PPPINITFCS32
, 
pD©a
 + 
HódîLí
, 
D©aByãC¡
 - HeaderLen - 8 - 4);

1165 
¸c32
 ^= 0xffffffff;

1167 #i‚de‡
BIG_ENDIAN


1168 if(
¸c32
 !
åaûfcs
)

1170 if(
¸c32
 !
	`SWAP32
(
åaûfcs
))

1173 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RTMPSoftDecryptTKIP, WEP Data ICV Error !\n");

1175  (
FALSE
);

1178 
	`NdisMoveMem‹y
(
TøûMIC
, 
pD©a
 + 
D©aByãC¡
 - 8 - 8 - 4, 8);

1179 
	`RTMPInôMICEngöe
(
pAd
, 
pW∑Key
[
KeyID
].
Key
, 
DA
, 
SA
, 
U£rPri‹ôy
,ÖW∑Key[KeyID].
RxMic
);

1180 
	`RTMPTkùAµíd
(&
pAd
->
Priv©eInfo
.
Tx
, 
pD©a
 + 
HódîLí
, 
D©aByãC¡
 - HeaderLen - 8 - 12);

1181 
	`RTMPTkùGëMIC
(&
pAd
->
Priv©eInfo
.
Tx
);

1182 
	`NdisMoveMem‹y
(
MIC
, 
pAd
->
Priv©eInfo
.
Tx
.MIC, 8);

1184 i‡(!
	`NdisEquÆMem‹y
(
MIC
, 
TøûMIC
, 8))

1186 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "RTMPSoftDecryptTKIP, WEP Data MIC Error !\n");

1188  (
FALSE
);

1191 #ifde‡
BIG_ENDIAN


1192 
	`RTMPFømeEndünCh™ge
(
pAd
, (
PUCHAR
)
pD©a
, 
DIR_READ
, 
FALSE
);

1195  
TRUE
;

1196 
	}
}

1201 
BOOLEAN
 
	$RTMPSo·De¸y±AES
(

1202 
IN
 
PRTMP_ADAPTER
 
pAd
,

1203 
IN
 
PUCHAR
 
pD©a
,

1204 
IN
 
ULONG
 
D©aByãC¡
,

1205 
IN
 
PCIPHER_KEY
 
pW∑Key
)

1207 
UCHAR
 
KeyID
;

1208 
UINT
 
HódîLí
;

1209 
UCHAR
 
PN
[6];

1210 
UINT
 
∑ylﬂd_Àn
;

1211 
UINT
 
num_blocks
;

1212 
UINT
 
∑ylﬂd_ªmaödî
;

1213 
USHORT
 
fc
;

1214 
UCHAR
 
fc0
;

1215 
UCHAR
 
fc1
;

1216 
UINT
 
‰ame_ty≥
;

1217 
UINT
 
‰ame_subty≥
;

1218 
UINT
 
‰om_ds
;

1219 
UINT
 
to_ds
;

1220 
INT
 
a4_exi°s
;

1221 
INT
 
qc_exi°s
;

1222 
UCHAR
 
´s_out
[16];

1223 
∑ylﬂd_ödex
;

1224 
UINT
 
i
;

1225 
UCHAR
 
˘r_¥ñﬂd
[16];

1226 
UCHAR
 
chaö_buf„r
[16];

1227 
UCHAR
 
∑dded_buf„r
[16];

1228 
UCHAR
 
mic_iv
[16];

1229 
UCHAR
 
mic_hódî1
[16];

1230 
UCHAR
 
mic_hódî2
[16];

1231 
UCHAR
 
MIC
[8];

1232 
UCHAR
 
TøûMIC
[8];

1234 #ifde‡
BIG_ENDIAN


1235 
	`RTMPFømeEndünCh™ge
(
pAd
, (
PUCHAR
)
pD©a
, 
DIR_READ
, 
FALSE
);

1238 
fc0
 = *
pD©a
;

1239 
fc1
 = *(
pD©a
 + 1);

1241 
fc
 = *((
PUSHORT
)
pD©a
);

1243 
‰ame_ty≥
 = ((
fc0
 >> 2) & 0x03);

1244 
‰ame_subty≥
 = ((
fc0
 >> 4) & 0x0f);

1246 
‰om_ds
 = (
fc1
 & 0x2) >> 1;

1247 
to_ds
 = (
fc1
 & 0x1);

1249 
a4_exi°s
 = (
‰om_ds
 & 
to_ds
);

1250 
qc_exi°s
 = ((
‰ame_subty≥
 == 0x08) ||

1251 (
‰ame_subty≥
 == 0x09) ||

1252 (
‰ame_subty≥
 == 0x0a) ||

1253 (
‰ame_subty≥
 == 0x0b)

1256 
HódîLí
 = 24;

1257 i‡(
a4_exi°s
)

1258 
HódîLí
 += 6;

1260 
KeyID
 = *((
PUCHAR
)(
pD©a
+ 
HódîLí
 + 3));

1261 
KeyID
 = KeyID >> 6;

1263 i‡(
pW∑Key
[
KeyID
].
KeyLí
 == 0)

1265 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RTMPSo·De¸y±AES faûed!(KeyID[%d] Lígth c™ÇŸ bê0)\n", 
KeyID
);

1266  
FALSE
;

1269 
PN
[0] = *(
pD©a
+ 
HódîLí
);

1270 
PN
[1] = *(
pD©a
+ 
HódîLí
 + 1);

1271 
PN
[2] = *(
pD©a
+ 
HódîLí
 + 4);

1272 
PN
[3] = *(
pD©a
+ 
HódîLí
 + 5);

1273 
PN
[4] = *(
pD©a
+ 
HódîLí
 + 6);

1274 
PN
[5] = *(
pD©a
+ 
HódîLí
 + 7);

1276 
∑ylﬂd_Àn
 = 
D©aByãC¡
 - 
HódîLí
 - 8 - 8;

1277 
∑ylﬂd_ªmaödî
 = (
∑ylﬂd_Àn
) % 16;

1278 
num_blocks
 = (
∑ylﬂd_Àn
) / 16;

1280 
	`DBGPRINT
(
RT_DEBUG_INFO
, "So·De¸y±AES:Öaylﬂd = %d,Çum_block†%d,Öaylﬂd_ªmaödî = %d\n", 
∑ylﬂd_Àn
, 
num_blocks
, 
∑ylﬂd_ªmaödî
);

1283 
∑ylﬂd_ödex
 = 
HódîLí
 + 8;

1285 
i
=0; i< 
num_blocks
; i++)

1287 
	`c⁄°ru˘_˘r_¥ñﬂd
(
˘r_¥ñﬂd
,

1288 
a4_exi°s
,

1289 
qc_exi°s
,

1290 
pD©a
,

1291 
PN
,

1292 
i
+1 );

1294 
	`´s128k128d
(
pW∑Key
[
KeyID
].
Key
, 
˘r_¥ñﬂd
, 
´s_out
);

1296 
	`bôwi£_x‹
(
´s_out
, 
pD©a
 + 
∑ylﬂd_ödex
, 
chaö_buf„r
);

1299 
j
;

1300 
	`¥ötk
("chaö_buf„r[%d]: ", 
i
+1);

1301 
j
 = 0; j < 16; j++)

1303 
	`¥ötk
("%02x ", 
chaö_buf„r
[
j
]);

1305 
	`¥ötk
("\n");

1308 
	`NdisMoveMem‹y
(
pD©a
 + 
∑ylﬂd_ödex
 - 8, 
chaö_buf„r
, 16);

1309 
∑ylﬂd_ödex
 += 16;

1316 i‡(
∑ylﬂd_ªmaödî
 > 0)

1318 
	`c⁄°ru˘_˘r_¥ñﬂd
(
˘r_¥ñﬂd
,

1319 
a4_exi°s
,

1320 
qc_exi°s
,

1321 
pD©a
,

1322 
PN
,

1323 
num_blocks
 + 1);

1325 
	`NdisZîoMem‹y
(
∑dded_buf„r
, 16);

1326 
	`NdisMoveMem‹y
(
∑dded_buf„r
, 
pD©a
 + 
∑ylﬂd_ödex
, 
∑ylﬂd_ªmaödî
);

1328 
	`´s128k128d
(
pW∑Key
[
KeyID
].
Key
, 
˘r_¥ñﬂd
, 
´s_out
);

1330 
	`bôwi£_x‹
(
´s_out
, 
∑dded_buf„r
, 
chaö_buf„r
);

1333 
j
;

1334 
	`¥ötk
("chaö_buf„r[%d]: ", 
num_blocks
 + 1);

1335 
j
 = 0; j < 
∑ylﬂd_ªmaödî
; j++)

1337 
	`¥ötk
("%02x ", 
chaö_buf„r
[
j
]);

1339 
	`¥ötk
("\n");

1342 
	`NdisMoveMem‹y
(
pD©a
 + 
∑ylﬂd_ödex
 - 8, 
chaö_buf„r
, 
∑ylﬂd_ªmaödî
);

1343 
∑ylﬂd_ödex
 +
∑ylﬂd_ªmaödî
;

1349 
	`c⁄°ru˘_˘r_¥ñﬂd
(
˘r_¥ñﬂd
,

1350 
a4_exi°s
,

1351 
qc_exi°s
,

1352 
pD©a
,

1353 
PN
,

1355 
	`NdisZîoMem‹y
(
∑dded_buf„r
, 16);

1356 
	`NdisMoveMem‹y
(
∑dded_buf„r
, 
pD©a
 + 
∑ylﬂd_ödex
, 8);

1358 
	`´s128k128d
(
pW∑Key
[
KeyID
].
Key
, 
˘r_¥ñﬂd
, 
´s_out
);

1360 
	`bôwi£_x‹
(
´s_out
, 
∑dded_buf„r
, 
chaö_buf„r
);

1362 
	`NdisMoveMem‹y
(
TøûMIC
, 
chaö_buf„r
, 8);

1366 
	`¥ötk
("chain_buffer: ");

1367 
i
 = 0; i < 16; i++)

1369 
	`¥ötk
("%02x ", 
chaö_buf„r
[
i
]);

1371 
	`¥ötk
("\n");

1380 *(
pD©a
 + 1) = *(pData + 1) | 0x40;

1384 
∑ylﬂd_ödex
 = 
HódîLí
;

1386 
	`c⁄°ru˘_mic_iv
(

1387 
mic_iv
,

1388 
qc_exi°s
,

1389 
a4_exi°s
,

1390 
pD©a
,

1391 
∑ylﬂd_Àn
,

1392 
PN
);

1394 
	`c⁄°ru˘_mic_hódî1
(

1395 
mic_hódî1
,

1396 
HódîLí
,

1397 
pD©a
);

1399 
	`c⁄°ru˘_mic_hódî2
(

1400 
mic_hódî2
,

1401 
pD©a
,

1402 
a4_exi°s
,

1403 
qc_exi°s
);

1405 
	`´s128k128d
(
pW∑Key
[
KeyID
].
Key
, 
mic_iv
, 
´s_out
);

1406 
	`bôwi£_x‹
(
´s_out
, 
mic_hódî1
, 
chaö_buf„r
);

1407 
	`´s128k128d
(
pW∑Key
[
KeyID
].
Key
, 
chaö_buf„r
, 
´s_out
);

1408 
	`bôwi£_x‹
(
´s_out
, 
mic_hódî2
, 
chaö_buf„r
);

1409 
	`´s128k128d
(
pW∑Key
[
KeyID
].
Key
, 
chaö_buf„r
, 
´s_out
);

1412 
i
 = 0; i < 
num_blocks
; i++)

1414 
	`bôwi£_x‹
(
´s_out
, 
pD©a
 + 
∑ylﬂd_ödex
, 
chaö_buf„r
);

1415 
∑ylﬂd_ödex
 += 16;

1416 
	`´s128k128d
(
pW∑Key
[
KeyID
].
Key
, 
chaö_buf„r
, 
´s_out
);

1420 i‡(
∑ylﬂd_ªmaödî
 > 0)

1422 
	`NdisZîoMem‹y
(
∑dded_buf„r
, 16);

1423 
	`NdisMoveMem‹y
(
∑dded_buf„r
, 
pD©a
 + 
∑ylﬂd_ödex
, 
∑ylﬂd_ªmaödî
);

1425 
	`bôwi£_x‹
(
´s_out
, 
∑dded_buf„r
, 
chaö_buf„r
);

1426 
	`´s128k128d
(
pW∑Key
[
KeyID
].
Key
, 
chaö_buf„r
, 
´s_out
);

1431 
	`¥ötk
("aes_out: ");

1432 
i
 = 0; i < 16; i++)

1434 
	`¥ötk
("%02x ", 
´s_out
[
i
]);

1436 
	`¥ötk
("\n");

1441 
i
 = 0 ; i < 8; i++Ë
MIC
[i] = 
´s_out
[i];

1443 i‡(!
	`NdisEquÆMem‹y
(
MIC
, 
TøûMIC
, 8))

1445 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "RTMPSoftDecryptAES, MIC Error !\n");

1446  
FALSE
;

1449 #ifde‡
BIG_ENDIAN


1450 
	`RTMPFømeEndünCh™ge
(
pAd
, (
PUCHAR
)
pD©a
, 
DIR_READ
, 
FALSE
);

1453  
TRUE
;

1454 
	}
}

1461 
VOID
 
	$x‹_128
(

1462 
IN
 
PUCHAR
 
a
,

1463 
IN
 
PUCHAR
 
b
,

1464 
OUT
 
PUCHAR
 
out
)

1466 
INT
 
i
;

1468 
i
=0;i<16; i++)

1470 
out
[
i
] = 
a
[i] ^ 
b
[i];

1472 
	}
}

1474 
VOID
 
	$√xt_key
(

1475 
IN
 
PUCHAR
 
key
,

1476 
IN
 
INT
 
round
)

1478 
UCHAR
 
rc⁄
;

1479 
UCHAR
 
sbox_key
[4];

1480 
UCHAR
 
rc⁄_èbÀ
[12] =

1486 
sbox_key
[0] = 
	`RTMPCkùSbox
(
key
[13]);

1487 
sbox_key
[1] = 
	`RTMPCkùSbox
(
key
[14]);

1488 
sbox_key
[2] = 
	`RTMPCkùSbox
(
key
[15]);

1489 
sbox_key
[3] = 
	`RTMPCkùSbox
(
key
[12]);

1491 
rc⁄
 = 
rc⁄_èbÀ
[
round
];

1493 
	`x‹_32
(&
key
[0], 
sbox_key
, &key[0]);

1494 
key
[0] = key[0] ^ 
rc⁄
;

1496 
	`x‹_32
(&
key
[4], &key[0], &key[4]);

1497 
	`x‹_32
(&
key
[8], &key[4], &key[8]);

1498 
	`x‹_32
(&
key
[12], &key[8], &key[12]);

1499 
	}
}

1501 
VOID
 
	$x‹_32
(

1502 
IN
 
PUCHAR
 
a
,

1503 
IN
 
PUCHAR
 
b
,

1504 
OUT
 
PUCHAR
 
out
)

1506 
INT
 
i
;

1508 
i
=0;i<4; i++)

1510 
out
[
i
] = 
a
[i] ^ 
b
[i];

1512 
	}
}

1514 
VOID
 
	$byã_sub
(

1515 
IN
 
PUCHAR
 
ö
,

1516 
OUT
 
PUCHAR
 
out
)

1518 
INT
 
i
;

1520 
i
=0; i< 16; i++)

1522 
out
[
i
] = 
	`RTMPCkùSbox
(
ö
[i]);

1524 
	}
}

1526 
UCHAR
 
	$RTMPCkùSbox
(

1527 
IN
 
UCHAR
 
a
)

1529  
SboxTabÀ
[()
a
];

1530 
	}
}

1532 
VOID
 
	$shi·_row
(

1533 
IN
 
PUCHAR
 
ö
,

1534 
OUT
 
PUCHAR
 
out
)

1536 
out
[0] = 
ö
[0];

1537 
out
[1] = 
ö
[5];

1538 
out
[2] = 
ö
[10];

1539 
out
[3] = 
ö
[15];

1540 
out
[4] = 
ö
[4];

1541 
out
[5] = 
ö
[9];

1542 
out
[6] = 
ö
[14];

1543 
out
[7] = 
ö
[3];

1544 
out
[8] = 
ö
[8];

1545 
out
[9] = 
ö
[13];

1546 
out
[10] = 
ö
[2];

1547 
out
[11] = 
ö
[7];

1548 
out
[12] = 
ö
[12];

1549 
out
[13] = 
ö
[1];

1550 
out
[14] = 
ö
[6];

1551 
out
[15] = 
ö
[11];

1552 
	}
}

1554 
VOID
 
	$mix_cﬁumn
(

1555 
IN
 
PUCHAR
 
ö
,

1556 
OUT
 
PUCHAR
 
out
)

1558 
INT
 
i
;

1559 
UCHAR
 
add1b
[4];

1560 
UCHAR
 
add1bf7
[4];

1561 
UCHAR
 
rŸl
[4];

1562 
UCHAR
 
sw≠_hÆfs
[4];

1563 
UCHAR
 
™df7
[4];

1564 
UCHAR
 
rŸr
[4];

1565 
UCHAR
 
ãmp
[4];

1566 
UCHAR
 
ãmpb
[4];

1568 
i
=0 ; i<4; i++)

1570 i‡((
ö
[
i
] & 0x80)== 0x80)

1571 
add1b
[
i
] = 0x1b;

1573 
add1b
[
i
] = 0x00;

1576 
sw≠_hÆfs
[0] = 
ö
[2];

1577 
sw≠_hÆfs
[1] = 
ö
[3];

1578 
sw≠_hÆfs
[2] = 
ö
[0];

1579 
sw≠_hÆfs
[3] = 
ö
[1];

1581 
rŸl
[0] = 
ö
[3];

1582 
rŸl
[1] = 
ö
[0];

1583 
rŸl
[2] = 
ö
[1];

1584 
rŸl
[3] = 
ö
[2];

1586 
™df7
[0] = 
ö
[0] & 0x7f;

1587 
™df7
[1] = 
ö
[1] & 0x7f;

1588 
™df7
[2] = 
ö
[2] & 0x7f;

1589 
™df7
[3] = 
ö
[3] & 0x7f;

1591 
i
 = 3; i>0; i--)

1593 
™df7
[
i
] =ándf7[i] << 1;

1594 i‡((
™df7
[
i
-1] & 0x80) == 0x80)

1596 
™df7
[
i
] = (andf7[i] | 0x01);

1599 
™df7
[0] =ándf7[0] << 1;

1600 
™df7
[0] =ándf7[0] & 0xfe;

1602 
	`x‹_32
(
add1b
, 
™df7
, 
add1bf7
);

1604 
	`x‹_32
(
ö
, 
add1bf7
, 
rŸr
);

1606 
ãmp
[0] = 
rŸr
[0];

1607 
rŸr
[0] =Ñotr[1];

1608 
rŸr
[1] =Ñotr[2];

1609 
rŸr
[2] =Ñotr[3];

1610 
rŸr
[3] = 
ãmp
[0];

1612 
	`x‹_32
(
add1bf7
, 
rŸr
, 
ãmp
);

1613 
	`x‹_32
(
sw≠_hÆfs
, 
rŸl
,
ãmpb
);

1614 
	`x‹_32
(
ãmp
, 
ãmpb
, 
out
);

1615 
	}
}

	@rtmp_type.h

39 #i‚de‡
__RTMP_TYPE_H__


40 
	#__RTMP_TYPE_H__


	)

45 
	#PACKED
 
	`__©åibuã__
 ((
∑cked
))

	)

48 
	tUINT8
;

49 
	tUINT16
;

50 
	tUINT32
;

51 
	tUINT64
;

52 
	tINT32
;

55 #i‚de‡
Wö32


56 
	#Wö32


	)

67 #ifde‡
NDIS50_MINIPORT


69 
	tUINT16
;

71 
	t__öt64
 
	tUINT64
;

79 
	#SWAP16
(
x
) \

80 ((
UINT16
)( \

81 (((
UINT16
)(
x
) & (UINT16) 0x00ffU) << 8) | \

82 (((
UINT16
)(
x
Ë& (UINT16Ë0xff00UË>> 8Ë))

	)

84 
	#SWAP32
(
x
) \

85 ((
UINT32
)( \

86 (((
UINT32
)(
x
) & (UINT32) 0x000000ffUL) << 24) | \

87 (((
UINT32
)(
x
) & (UINT32) 0x0000ff00UL) << 8) | \

88 (((
UINT32
)(
x
) & (UINT32) 0x00ff0000UL) >> 8) | \

89 (((
UINT32
)(
x
Ë& (UINT32Ë0xff000000ULË>> 24Ë))

	)

91 
	#SWAP64
(
x
) \

92 ((
UINT64
)( \

93 (
UINT64
)(((UINT64)(
x
) & (UINT64) 0x00000000000000ffULL) << 56) | \

94 (
UINT64
)(((UINT64)(
x
) & (UINT64) 0x000000000000ff00ULL) << 40) | \

95 (
UINT64
)(((UINT64)(
x
) & (UINT64) 0x0000000000ff0000ULL) << 24) | \

96 (
UINT64
)(((UINT64)(
x
) & (UINT64) 0x00000000ff000000ULL) << 8) | \

97 (
UINT64
)(((UINT64)(
x
) & (UINT64) 0x000000ff00000000ULL) >> 8) | \

98 (
UINT64
)(((UINT64)(
x
) & (UINT64) 0x0000ff0000000000ULL) >> 24) | \

99 (
UINT64
)(((UINT64)(
x
) & (UINT64) 0x00ff000000000000ULL) >> 40) | \

100 (
UINT64
)(((UINT64)(
x
Ë& (UINT64Ë0xff00000000000000ULLË>> 56Ë))

	)

102 #ifde‡
BIG_ENDIAN


104 
	#˝u2À64
(
x
Ë
	`SWAP64
((x))

	)

105 
	#À2˝u64
(
x
Ë
	`SWAP64
((x))

	)

106 
	#˝u2À32
(
x
Ë
	`SWAP32
((x))

	)

107 
	#À2˝u32
(
x
Ë
	`SWAP32
((x))

	)

108 
	#˝u2À16
(
x
Ë
	`SWAP16
((x))

	)

109 
	#À2˝u16
(
x
Ë
	`SWAP16
((x))

	)

110 
	#˝u2be64
(
x
Ë((
UINT64
)(x))

	)

111 
	#be2˝u64
(
x
Ë((
UINT64
)(x))

	)

112 
	#˝u2be32
(
x
Ë((
UINT32
)(x))

	)

113 
	#be2˝u32
(
x
Ë((
UINT32
)(x))

	)

114 
	#˝u2be16
(
x
Ë((
UINT16
)(x))

	)

115 
	#be2˝u16
(
x
Ë((
UINT16
)(x))

	)

119 
	#˝u2À64
(
x
Ë((
UINT64
)(x))

	)

120 
	#À2˝u64
(
x
Ë((
UINT64
)(x))

	)

121 
	#˝u2À32
(
x
Ë((
UINT32
)(x))

	)

122 
	#À2˝u32
(
x
Ë((
UINT32
)(x))

	)

123 
	#˝u2À16
(
x
Ë((
UINT16
)(x))

	)

124 
	#À2˝u16
(
x
Ë((
UINT16
)(x))

	)

125 
	#˝u2be64
(
x
Ë
	`SWAP64
((x))

	)

126 
	#be2˝u64
(
x
Ë
	`SWAP64
((x))

	)

127 
	#˝u2be32
(
x
Ë
	`SWAP32
((x))

	)

128 
	#be2˝u32
(
x
Ë
	`SWAP32
((x))

	)

129 
	#˝u2be16
(
x
Ë
	`SWAP16
((x))

	)

130 
	#be2˝u16
(
x
Ë
	`SWAP16
((x))

	)

137 
	s_RALINK_TIMER_STRUCT
 {

138 
BOOLEAN
 
	mVÆid
;

139 
timî_li°
 
	mTimîObj
;

140 
ULONG
 
	mTimîVÆue
;

141 
BOOLEAN
 
	mSèã
;

142 
BOOLEAN
 
	mRïót
;

143 
ULONG
 
	mcookõ
;

144 } 
	tRALINK_TIMER_STRUCT
, *
	tPRALINK_TIMER_STRUCT
;

146 
PACKED
 
	t_RSN_IE_HEADER_STRUCT
 {

147 
UCHAR
 
	gEid
;

148 
UCHAR
 
	gLígth
;

149 
USHORT
 
	gVîsi⁄
;

150 } 
	tRSN_IE_HEADER_STRUCT
, *
	tPRSN_IE_HEADER_STRUCT
;

153 
PACKED
 
	t_CIPHER_SUITE_STRUCT
 {

154 
UCHAR
 
	gOui
[3];

155 
UCHAR
 
	gTy≥
;

156 } 
	tCIPHER_SUITE_STRUCT
, *
	tPCIPHER_SUITE_STRUCT
;

159 
PACKED
 
	t_AKM_SUITE_STRUCT
 {

160 
UCHAR
 
	gOui
[3];

161 
UCHAR
 
	gTy≥
;

162 } 
	tAKM_SUITE_STRUCT
, *
	tPAKM_SUITE_STRUCT
;

164 #ifde‡
BIG_ENDIAN


165 
	s_RSN_CAPABILITY
 {

166 
USHORT
 
	mPªAuth
:1;

167 
USHORT
 
	mNoPaúwi£
:1;

168 
USHORT
 
	mPTKSARïœyC¡
:2;

169 
USHORT
 
	mGTKSARïœyC¡
:2;

170 
USHORT
 
	mRsv
:10;

171 } 
	tRSN_CAPABILITY
, *
	tPRSN_CAPABILITY
;

174 
	s_RSN_CAPABILITY
 {

175 
USHORT
 
	mRsv
:10;

176 
USHORT
 
	mGTKSARïœyC¡
:2;

177 
USHORT
 
	mPTKSARïœyC¡
:2;

178 
USHORT
 
	mNoPaúwi£
:1;

179 
USHORT
 
	mPªAuth
:1;

180 } 
	tRSN_CAPABILITY
, *
	tPRSN_CAPABILITY
;

183 
	s_CIPHER_KEY
 {

184 
UCHAR
 
	mBssId
[6];

185 
UCHAR
 
	mCùhîAlg
;

186 
UCHAR
 
	mKeyLí
;

187 
UCHAR
 
	mKey
[16];

188 
UCHAR
 
	mRxMic
[8];

189 
UCHAR
 
	mTxMic
[8];

190 
UCHAR
 
	mTxTsc
[6];

191 
UCHAR
 
	mRxTsc
[6];

192 
UCHAR
 
	mTy≥
;

193 } 
	tCIPHER_KEY
, *
	tPCIPHER_KEY
;

	@rtmp_wep.c

38 
	~"π_c⁄fig.h
"

40 
ULONG
 
	gFCSTAB_32
[256] =

108 
UCHAR
 
	gWEPKEY
[] = {

136 
VOID
 
	$RTMPInôWïEngöe
(

137 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

138 
IN
 
PUCHAR
 
pKey
,

139 
IN
 
UCHAR
 
KeyId
,

140 
IN
 
UCHAR
 
KeyLí
,

141 
IN
 
OUT
 
PUCHAR
 
pDe°
)

143 
UINT
 
i
;

145 
pAd≠ãr
->
Priv©eInfo
.
FCSCRC32
 = 
PPPINITFCS32
;

146 
	`NdisMoveMem‹y
(
WEPKEY
 + 3, 
pKey
, 
KeyLí
);

148 
i
 = 0; i < 3; i++)

149 
WEPKEY
[
i
] = 
	`R™domByã
(
pAd≠ãr
);

150 
	`ARCFOUR_INIT
(&
pAd≠ãr
->
Priv©eInfo
.
WEPCONTEXT
, 
WEPKEY
, 
KeyLí
 + 3);

152 
	`NdisMoveMem‹y
(
pDe°
, 
WEPKEY
, 3);

153 *(
pDe°
+3Ë(
KeyId
 << 6);

155 
	}
}

176 
VOID
 
	$RTMPEn¸y±D©a
(

177 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

178 
IN
 
PUCHAR
 
pSrc
,

179 
IN
 
PUCHAR
 
pDe°
,

180 
IN
 
UINT
 
Lí
)

182 
pAd≠ãr
->
Priv©eInfo
.
FCSCRC32
 = 
	`RTMP_CALC_FCS32
’Ad≠ãr->Priv©eInfo.FCSCRC32, 
pSrc
, 
Lí
);

183 
	`ARCFOUR_ENCRYPT
(&
pAd≠ãr
->
Priv©eInfo
.
WEPCONTEXT
, 
pDe°
, 
pSrc
, 
Lí
);

184 
	}
}

205 
BOOLEAN
 
	$RTMPDe¸y±D©a
(

206 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

207 
IN
 
PUCHAR
 
pSrc
,

208 
IN
 
UINT
 
Lí
)

210 
ULONG
 
åaûfcs
;

211 
ULONG
 
¸c32
;

212 
UCHAR
 
KeyIdx
;

214 
	`NdisMoveMem‹y
(
WEPKEY
, 
pSrc
, 3);

216 
KeyIdx
 = (*(
pSrc
 + 3) & 0xc0) >> 6;

217 i‡(
pAd≠ãr
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 == 0)

218  (
FALSE
);

220 
	`NdisMoveMem‹y
(
WEPKEY
 + 3, 
pAd≠ãr
->
Sh¨edKey
[
KeyIdx
].
Key
,ÖAd≠ãr->Sh¨edKey[KeyIdx].
KeyLí
);

221 
	`ARCFOUR_INIT
(&
pAd≠ãr
->
Priv©eInfo
.
WEPCONTEXT
, 
WEPKEY
,ÖAd≠ãr->
Sh¨edKey
[
KeyIdx
].
KeyLí
 + 3);

222 
	`ARCFOUR_DECRYPT
(&
pAd≠ãr
->
Priv©eInfo
.
WEPCONTEXT
, 
pSrc
,ÖSr¯+ 4, 
Lí
 - 4);

223 
	`NdisMoveMem‹y
(&
åaûfcs
, 
pSrc
 + 
Lí
 - 8, 4);

224 
¸c32
 = 
	`RTMP_CALC_FCS32
(
PPPINITFCS32
, 
pSrc
, 
Lí
 - 8);

225 
¸c32
 ^= 0xffffffff;

226 #i‚de‡
BIG_ENDIAN


227 if(
¸c32
 !
åaûfcs
)

229 if(
¸c32
 !
	`SWAP32
(
åaûfcs
))

232 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "! WEP Data CRC Error !\n");

233  (
FALSE
);

235  (
TRUE
);

236 
	}
}

257 
VOID
 
	$ARCFOUR_INIT
(

258 
IN
 
PARCFOURCONTEXT
 
Ctx
,

259 
IN
 
PUCHAR
 
pKey
,

260 
IN
 
UINT
 
KeyLí
)

262 
UCHAR
 
t
, 
u
;

263 
UINT
 
keyödex
;

264 
UINT
 
°©eödex
;

265 
PUCHAR
 
°©e
;

266 
UINT
 
cou¡î
;

268 
°©e
 = 
Ctx
->
STATE
;

269 
Ctx
->
X
 = 0;

270 
Ctx
->
Y
 = 0;

271 
cou¡î
 = 0; counter < 256; counter++)

272 
°©e
[
cou¡î
] = (
UCHAR
)counter;

273 
keyödex
 = 0;

274 
°©eödex
 = 0;

275 
cou¡î
 = 0; counter < 256; counter++)

277 
t
 = 
°©e
[
cou¡î
];

278 
°©eödex
 = (°©eödex + 
pKey
[
keyödex
] + 
t
) & 0xff;

279 
u
 = 
°©e
[
°©eödex
];

280 
°©e
[
°©eödex
] = 
t
;

281 
°©e
[
cou¡î
] = 
u
;

282 i‡(++
keyödex
 >
KeyLí
)

283 
keyödex
 = 0;

285 
	}
}

303 
UCHAR
 
	$ARCFOUR_BYTE
(

304 
IN
 
PARCFOURCONTEXT
 
Ctx
)

306 
UINT
 
x
;

307 
UINT
 
y
;

308 
UCHAR
 
sx
, 
sy
;

309 
PUCHAR
 
°©e
;

311 
°©e
 = 
Ctx
->
STATE
;

312 
x
 = (
Ctx
->
X
 + 1) & 0xff;

313 
sx
 = 
°©e
[
x
];

314 
y
 = (
sx
 + 
Ctx
->
Y
) & 0xff;

315 
sy
 = 
°©e
[
y
];

316 
Ctx
->
X
 = 
x
;

317 
Ctx
->
Y
 = 
y
;

318 
°©e
[
y
] = 
sx
;

319 
°©e
[
x
] = 
sy
;

321 (
°©e
[(
sx
 + 
sy
) & 0xff]);

323 
	}
}

344 
VOID
 
	$ARCFOUR_DECRYPT
(

345 
IN
 
PARCFOURCONTEXT
 
Ctx
,

346 
IN
 
PUCHAR
 
pDe°
,

347 
IN
 
PUCHAR
 
pSrc
,

348 
IN
 
UINT
 
Lí
)

350 
UINT
 
i
;

352 
i
 = 0; i < 
Lí
; i++)

353 
pDe°
[
i
] = 
pSrc
[i] ^ 
	`ARCFOUR_BYTE
(
Ctx
);

354 
	}
}

375 
VOID
 
	$ARCFOUR_ENCRYPT
(

376 
IN
 
PARCFOURCONTEXT
 
Ctx
,

377 
IN
 
PUCHAR
 
pDe°
,

378 
IN
 
PUCHAR
 
pSrc
,

379 
IN
 
UINT
 
Lí
)

381 
UINT
 
i
;

383 
i
 = 0; i < 
Lí
; i++)

384 
pDe°
[
i
] = 
pSrc
[i] ^ 
	`ARCFOUR_BYTE
(
Ctx
);

385 
	}
}

405 
ULONG
 
	$RTMP_CALC_FCS32
(

406 
IN
 
ULONG
 
Fcs
,

407 
IN
 
PUCHAR
 
Cp
,

408 
IN
 
INT
 
Lí
)

410 
Lí
--)

411 
Fcs
 = (((FcsË>> 8Ë^ 
FCSTAB_32
[((FcsË^ (*
Cp
++)) & 0xff]);

413  (
Fcs
);

414 
	}
}

433 
VOID
 
	$RTMPSëICV
(

434 
IN
 
PRTMP_ADAPTER
 
pAd≠ãr
,

435 
IN
 
PUCHAR
 
pDe°
)

437 
pAd≠ãr
->
Priv©eInfo
.
FCSCRC32
 ^= 0xffffffff;

439 #ifde‡
BIG_ENDIAN


440 
pAd≠ãr
->
Priv©eInfo
.
FCSCRC32
 = 
	`SWAP32
(pAdapter->PrivateInfo.FCSCRC32);

443 
	`ARCFOUR_ENCRYPT
(&
pAd≠ãr
->
Priv©eInfo
.
WEPCONTEXT
, 
pDe°
, (
PUCHAR
Ë&pAd≠ãr->Priv©eInfo.
FCSCRC32
, 4);

444 
	}
}

	@rtmp_wext.c

40 
	~"πmp_wext.h
"

43 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


45 
	$wext_nŸify_evít_assoc
(

46 
RTMP_ADAPTER
 *
pAd
,

47 
USHORT
 
iweCmd
,

48 
assoc
)

50 
	#WEXT_ASSOCINFO_PREFIX
 "ASSOCINFO(ReqIEs="

	)

51 
	#WEXT_ASSOCINFO_MIDFIX
 " Re•IEs="

	)

52 
	#WEXT_ASSOCINFO_POSTFIX
 ")"

	)

54 
iwªq_d©a
 
wrqu
;

55 *
pAssocInfo
, *
p
, *
õs
;

56 
i
, 
öfoLí
;

58 i‡(
assoc
)

60 
	`¥ötk
("ReqV¨IELí=%d! Re•IELí=%d!\n", 
pAd
->
P‹tCfg
.
ReqV¨IELí
,ÖAd->P‹tCfg.
ResV¨IELí
);

61 
öfoLí
 = (
WEXT_ASSOCINFO_PREFIX
Ë+ 
pAd
->
P‹tCfg
.
ReqV¨IELí
 * 2 +

62 (
WEXT_ASSOCINFO_MIDFIX
Ë+ 
pAd
->
P‹tCfg
.
ResV¨IELí
 * 2 +

63 (
WEXT_ASSOCINFO_POSTFIX
) + 1;

64 
	`¥ötk
("öfoLí=%d!\n", 
öfoLí
);

66 i‡(
öfoLí
 > 
IW_CUSTOM_MAX
)

68 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s():assocInfÿtoÿœrgêtÿ£ndÅÿu£∏•a˚! (Àn=%d)\n", 
__FUNCTION__
, 
öfoLí
);

72 
pAssocInfo
 = 
	`kmÆloc
(
öfoLí
, 
MEM_ALLOC_FLAG
);

73 i‡(!
pAssocInfo
)

75 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "%s():Æloˇã mem‹y f‹ássocInfÿÁûed!\n", 
__FUNCTION__
);

78 
	`NdisZîoMem‹y
(
pAssocInfo
, 
öfoLí
);

86 
p
 = 
pAssocInfo
;

87 
p
 +
	`•rötf
’, 
WEXT_ASSOCINFO_PREFIX
);

90 
õs
 = &
pAd
->
P‹tCfg
.
ReqV¨IEs
[0];

91 
i
 = 0; i < 
pAd
->
P‹tCfg
.
ReqV¨IELí
; i++)

92 
p
 +
	`•rötf
’, "%02x", 
õs
[
i
]);

95 
p
 +
	`•rötf
’, 
WEXT_ASSOCINFO_MIDFIX
);

98 
õs
 = &
pAd
->
P‹tCfg
.
ResV¨IEs
[0];

99 
i
 = 0; i < 
pAd
->
P‹tCfg
.
ResV¨IELí
; i++)

100 
p
 +
	`•rötf
’, "%02x", 
õs
[
i
]);

103 
p
 +
	`•rötf
’, 
WEXT_ASSOCINFO_POSTFIX
);

105 
wrqu
.
d©a
.
Àngth
 = 
öfoLí
;

106 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "addög %d byãs\n", 
wrqu
.
d©a
.
Àngth
);

107 
	`¥ötk
("%s():AssocInfo=\n\t%s!\n", 
__FUNCTION__
, 
pAssocInfo
);

108 
	`wúñess_£nd_evít
(
pAd
->
√t_dev
, 
IWEVCUSTOM
, &
wrqu
, 
pAssocInfo
);

110 
	`k‰ì
(
pAssocInfo
);

115 
	`NdisZîoMem‹y
(&
wrqu
, (wrqu));

116 
wrqu
.
≠_addr
.
ß_Ámûy
 = 
ARPHRD_ETHER
;

117 i‡(
assoc
)

118 
	`NdisMoveMem‹y
(
wrqu
.
≠_addr
.
ß_d©a
, 
pAd
->
MlmeAux
.
Bssid
, 
MAC_ADDR_LEN
);

120 
	`NdisZîoMem‹y
(
wrqu
.
≠_addr
.
ß_d©a
, 
MAC_ADDR_LEN
);

122 
	`wúñess_£nd_evít
(
pAd
->
√t_dev
, 
iweCmd
, &
wrqu
, 
NULL
);

126 
	}
}

129 
	$wext2Rtmp_Securôy_Wøµî
(
RTMP_ADAPTER
 *
pAd
)

132 #i‡
WIRELESS_EXT
 > 17

133 
authMode
 = 
Ndis802_11En¸y±i⁄DißbÀd
;

134 
wïSètus
;

139 
	`¥ötk
("Before wrapper, AuthMode=%d, wepStatus=%d,ÖCipher=%d, gCipher=%d, IEEE8021X=%d\n",

140 
pAd
->
P‹tCfg
.
AuthMode
,ÖAd->P‹tCfg.
WïSètus
,ÖAd->P‹tCfg.
PaúCùhî
,

141 
pAd
->
P‹tCfg
.
GroupCùhî
,ÖAd->P‹tCfg.
IEEE8021X
);

143 
pAd
->
P‹tCfg
.
IEEE8021X
 = 
FALSE
;

145 i‡(
pAd
->
P‹tCfg
.
RSN_IELí
 =0 ||ÖAd->P‹tCfg.
wx_w∑_vîsi⁄
 =
IW_AUTH_WPA_VERSION_DISABLED
)

147 i‡(
pAd
->
P‹tCfg
.
wx_auth_Æg
 & 
IW_AUTH_ALG_SHARED_KEY
)

149 i‡(
pAd
->
P‹tCfg
.
wx_auth_Æg
 & 
IW_AUTH_ALG_OPEN_SYSTEM
)

150 
authMode
 = 
Ndis802_11AuthModeAutoSwôch
;

152 
authMode
 = 
Ndis802_11AuthModeSh¨ed
;

156 
authMode
 = 
Ndis802_11AuthModeO≥n
;

159 if((
pAd
->
P‹tCfg
.
RSN_IE
[0] =
WPA2RSNIE
) ||

160 (
pAd
->
P‹tCfg
.
wx_w∑_vîsi⁄
 =
IW_AUTH_WPA_VERSION_WPA2
))

162 i‡(
pAd
->
P‹tCfg
.
wx_key_mgmt
 =
IW_AUTH_KEY_MGMT_PSK
)

163 
authMode
 = 
Ndis802_11AuthModeWPA2PSK
;

165 
authMode
 = 
Ndis802_11AuthModeWPA2
;

168 if((
pAd
->
P‹tCfg
.
RSN_IE
[0] =
WPARSNIE
) ||

169 (
pAd
->
P‹tCfg
.
wx_w∑_vîsi⁄
 =
IW_AUTH_WPA_VERSION_WPA
))

171 i‡(
pAd
->
P‹tCfg
.
wx_key_mgmt
 =
IW_AUTH_KEY_MGMT_PSK
)

172 
authMode
 = 
Ndis802_11AuthModeWPAPSK
;

174 
authMode
 = 
Ndis802_11AuthModeWPA
;

179 i‡(
pAd
->
P‹tCfg
.
wx_key_mgmt
 =
IW_AUTH_KEY_MGMT_802_1X
)

180 
pAd
->
P‹tCfg
.
IEEE8021X
 = 
TRUE
;

182  -
EINVAL
;

186 
pAd
->
P‹tCfg
.
wx_∑úwi£
)

188 
IW_AUTH_CIPHER_NONE
:

189 i‡(
pAd
->
P‹tCfg
.
wx_groupCùhî
 =
IW_AUTH_CIPHER_CCMP
)

190 
wïSètus
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

191 i‡(
pAd
->
P‹tCfg
.
wx_groupCùhî
 =
IW_AUTH_CIPHER_TKIP
)

192 
wïSètus
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

194 
wïSètus
 = 
Ndis802_11En¸y±i⁄DißbÀd
;

196 
IW_AUTH_CIPHER_WEP40
:

197 
IW_AUTH_CIPHER_WEP104
:

198 
wïSètus
 = 
Ndis802_11En¸y±i⁄1E«bÀd
;

200 
IW_AUTH_CIPHER_TKIP
:

201 
wïSètus
 = 
Ndis802_11En¸y±i⁄2E«bÀd
;

203 
IW_AUTH_CIPHER_CCMP
:

204 
wïSètus
 = 
Ndis802_11En¸y±i⁄3E«bÀd
;

207 
wïSètus
 = 
Ndis802_11En¸y±i⁄DißbÀd
;

211 i‡(
authMode
 !
pAd
->
P‹tCfg
.
AuthMode
 ||ÖAd->P‹tCfg.
WïSètus
 !
wïSètus
)

212 
pAd
->
bC⁄figCh™ged
 = 
TRUE
;

214 
pAd
->
P‹tCfg
.
AuthMode
 = 
authMode
;

215 
pAd
->
P‹tCfg
.
WïSètus
 = 
wïSètus
;

216 
pAd
->
P‹tCfg
.
OrigWïSètus
 = 
wïSètus
;

217 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
wïSètus
;

218 
pAd
->
P‹tCfg
.
GroupCùhî
 = 
wïSètus
;

220 
	`¥ötk
("A·î wøµî,ÅhêAuthMode=%d! wïSètus=%d!\n", 
pAd
->
P‹tCfg
.
AuthMode
,ÖAd->P‹tCfg.
WïSètus
);

225 
	}
}

	@rtmp_wext.h

40 #i‚de‡
__RTMP_WEXT_H__


41 
	#__RTMP_WEXT_H__


	)

43 
	~<√t/iw_h™dÀr.h
>

44 
	~"π_c⁄fig.h
"

47 
	#WPARSNIE
 0xdd

	)

48 
	#WPA2RSNIE
 0x30

	)

50 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


52 
wext_nŸify_evít_assoc
(

53 
RTMP_ADAPTER
 *
pAd
,

54 
USHORT
 
iweCmd
,

55 
assoc
);

57 
wext2Rtmp_Securôy_Wøµî
(

58 
RTMP_ADAPTER
 *
pAd
);

	@rtusb_bulk.c

40 
	~"π_c⁄fig.h
"

43 
	$RTusb_fûl_bulk_urb
 (
urb
 *
pUrb
,

44 
usb_devi˚
 *
pUsb_Dev
,

45 
bulkpùe
,

46 *
pTøns„rBuf
,

47 
BufSize
,

48 
usb_com∂ëe_t
 
Com∂ëe
,

49 *
pC⁄ãxt
)

52 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2,5,0)

53 
	`usb_fûl_bulk_urb
(
pUrb
, 
pUsb_Dev
, 
bulkpùe
, 
pTøns„rBuf
, 
BufSize
, 
Com∂ëe
, 
pC⁄ãxt
);

55 
	`FILL_BULK_URB
(
pUrb
, 
pUsb_Dev
, 
bulkpùe
, 
pTøns„rBuf
, 
BufSize
, 
Com∂ëe
, 
pC⁄ãxt
);

58 
	}
}

61 
VOID
 
	$RTUSBBulkOutD©aPackëCom∂ëe
(
purbb_t
 
pUrb
, 
±_ªgs
 *pt_regs)

63 
PTX_CONTEXT
 
pTxC⁄ãxt
;

64 
PRTMP_ADAPTER
 
pAd
;

65 
NTSTATUS
 
°©us
;

66 
UCHAR
 
BulkOutPùeId
;

67 
IrqFœgs
;

69 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->RTUSBBulkOutDataPacketComplete\n");

70 
pTxC⁄ãxt
(
PTX_CONTEXT
)
pUrb
->
c⁄ãxt
;

71 
pAd
 = 
pTxC⁄ãxt
->pAd;

72 
°©us
 = 
pUrb
->status;

75 
BulkOutPùeId
 = 
pTxC⁄ãxt
->BulkOutPipeId;

76 
pAd
->
BulkOutD©aO√SecCou¡
++;

78 i‡(
°©us
 =
USB_ST_NOERROR
)

80 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "BulkOutD©aPackëCom∂ëê%d (STATUS_SUCCESS)\n", 
BulkOutPùeId
);

82 i‡(
pTxC⁄ãxt
->
La°O√
 =
TRUE
)

84 
pAd
->
Cou¡îs
.
GoodTønsmôs
++;

85 
	`FREE_TX_RING
(
pAd
, 
BulkOutPùeId
, 
pTxC⁄ãxt
);

86 
pAd
->
TxRögTŸÆNumbî
[
BulkOutPùeId
]--;

88 i‡(
pAd
->
SídTxWaôQueue
[
BulkOutPùeId
].
Numbî
 > 0)

90 
	`RTMPDeQueuePackë
(
pAd
, 
BulkOutPùeId
);

95 i‡((!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)) &&

96 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) &&

97 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)) &&

98 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
)))

100 
	`FREE_TX_RING
(
pAd
, 
BulkOutPùeId
, 
pTxC⁄ãxt
);

101 
pAd
->
TxRögTŸÆNumbî
[
BulkOutPùeId
]--;

103 
	`RTUSB_SET_BULK_FLAG
(
pAd
, (
fRTUSB_BULK_OUT_DATA_FRAG
 << 
BulkOutPùeId
));

107 
pTxC⁄ãxt
->
La°O√
 !
TRUE
)

109 
	`FREE_TX_RING
(
pAd
, 
BulkOutPùeId
, 
pTxC⁄ãxt
);

110 
pAd
->
TxRögTŸÆNumbî
[
BulkOutPùeId
]--;

111 
pTxC⁄ãxt
 = &(
pAd
->
TxC⁄ãxt
[
BulkOutPùeId
][pAd->
NextBulkOutIndex
[BulkOutPipeId]]);

114 
	`FREE_TX_RING
(
pAd
, 
BulkOutPùeId
, 
pTxC⁄ãxt
);

115 
pAd
->
TxRögTŸÆNumbî
[
BulkOutPùeId
]--;

122 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "BulkOutD©aPackëCom∂ëê%d (STATUS_OTHER)\n", 
BulkOutPùeId
);

124 
pTxC⁄ãxt
->
La°O√
 !
TRUE
)

126 
	`FREE_TX_RING
(
pAd
, 
BulkOutPùeId
, 
pTxC⁄ãxt
);

127 
pAd
->
TxRögTŸÆNumbî
[
BulkOutPùeId
]--;

128 
pTxC⁄ãxt
 = &(
pAd
->
TxC⁄ãxt
[
BulkOutPùeId
][pAd->
NextBulkOutIndex
[BulkOutPipeId]]);

130 
	`FREE_TX_RING
(
pAd
, 
BulkOutPùeId
, 
pTxC⁄ãxt
);

131 
pAd
->
TxRögTŸÆNumbî
[
BulkOutPùeId
]--;

133 i‡((!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)) &&

134 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) &&

135 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)) &&

136 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
)))

138 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
);

140 
	`RTUSBEnqueueI¡î«lCmd
(
pAd
, 
RT_OID_USB_RESET_BULK_OUT
);

147 
pTxC⁄ãxt
 = &(
pAd
->
TxC⁄ãxt
[
BulkOutPùeId
][pAd->
NextBulkOutIndex
[BulkOutPipeId]]);

152 i‡((
pTxC⁄ãxt
->
bWaôögBulkOut
 =
TRUE
Ë&& !
	`RTUSB_TEST_BULK_FLAG
(
pAd
, (
fRTUSB_BULK_OUT_DATA_FRAG
 << 
BulkOutPùeId
)))

155 
	`RTUSB_SET_BULK_FLAG
(
pAd
, (
fRTUSB_BULK_OUT_DATA_NORMAL
 << 
BulkOutPùeId
));

159 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[
BulkOutPùeId
], 
IrqFœgs
);

160 
pAd
->
BulkOutPídög
[
BulkOutPùeId
] = 
FALSE
;

161 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[
BulkOutPùeId
], 
IrqFœgs
);

164 
	`RTUSBKickBulkOut
(
pAd
);

165 
	}
}

168 
VOID
 
	$RTUSBBulkOutNuŒFømeCom∂ëe
(
purbb_t
 
pUrb
, 
±_ªgs
 *pt_regs)

170 
PRTMP_ADAPTER
 
pAd
;

171 
PTX_CONTEXT
 
pNuŒC⁄ãxt
;

172 
NTSTATUS
 
°©us
;

173 
IrqFœgs
;

175 
pNuŒC⁄ãxt
(
PTX_CONTEXT
)
pUrb
->
c⁄ãxt
;

176 
pAd
 = 
pNuŒC⁄ãxt
->pAd;

178 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->RTUSBBulkOutNullFrameComplete\n");

181 
pNuŒC⁄ãxt
->
IRPPídög
 = 
FALSE
;

182 
pNuŒC⁄ãxt
->
InU£
 = 
FALSE
;

184 
°©us
 = 
pUrb
->status;

186 i‡(
°©us
 =
USB_ST_NOERROR
)

189 
	`RTMPDeQueuePackë
(
pAd
, 0);

194 i‡((!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)) &&

195 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) &&

196 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)) &&

197 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
)))

199 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "Bulk Out Null Frame Failed\n");

200 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
);

201 
	`RTUSBEnqueueI¡î«lCmd
(
pAd
, 
RT_OID_USB_RESET_BULK_OUT
);

206 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

207 
pAd
->
BulkOutPídög
[0] = 
FALSE
;

208 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

212 
	`RTUSBKickBulkOut
(
pAd
);

214 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<---RTUSBBulkOutNullFrameComplete\n");

216 
	}
}

219 
VOID
 
	$RTUSBBulkOutRTSFømeCom∂ëe
(
purbb_t
 
pUrb
, 
±_ªgs
 *pt_regs)

221 
PRTMP_ADAPTER
 
pAd
;

222 
PTX_CONTEXT
 
pRTSC⁄ãxt
;

223 
NTSTATUS
 
°©us
;

224 
IrqFœgs
;

226 
pRTSC⁄ãxt
(
PTX_CONTEXT
)
pUrb
->
c⁄ãxt
;

227 
pAd
 = 
pRTSC⁄ãxt
->pAd;

230 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->RTUSBBulkOutRTSFrameComplete\n");

233 
pRTSC⁄ãxt
->
IRPPídög
 = 
FALSE
;

234 
pRTSC⁄ãxt
->
InU£
 = 
FALSE
;

236 
°©us
 = 
pUrb
->status;

238 i‡(
°©us
 =
USB_ST_NOERROR
)

241 
	`RTMPDeQueuePackë
(
pAd
, 
pRTSC⁄ãxt
->
BulkOutPùeId
);

246 i‡((!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)) &&

247 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) &&

248 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)) &&

249 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
)))

251 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "Bulk Out RTS Frame Failed\n");

252 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
);

253 
	`RTUSBEnqueueI¡î«lCmd
(
pAd
, 
RT_OID_USB_RESET_BULK_OUT
);

258 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[
pRTSC⁄ãxt
->
BulkOutPùeId
], 
IrqFœgs
);

259 
pAd
->
BulkOutPídög
[
pRTSC⁄ãxt
->
BulkOutPùeId
] = 
FALSE
;

260 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[
pRTSC⁄ãxt
->
BulkOutPùeId
], 
IrqFœgs
);

264 
	`RTUSBKickBulkOut
(
pAd
);

266 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<---RTUSBBulkOutRTSFrameComplete\n");

268 
	}
}

271 
VOID
 
	$RTUSBBulkOutMLMEPackëCom∂ëe
(
purbb_t
 
pUrb
, 
±_ªgs
 *pt_regs)

273 
PTX_CONTEXT
 
pMLMEC⁄ãxt
;

274 
PRTMP_ADAPTER
 
pAd
;

275 
NTSTATUS
 
°©us
;

276 
IrqFœgs
;

278 
pMLMEC⁄ãxt
(
PTX_CONTEXT
)
pUrb
->
c⁄ãxt
;

279 
pAd
 = 
pMLMEC⁄ãxt
->pAd;

280 
°©us
 = 
pUrb
->status;

282 
pAd
->
PrioRögTxC¡
--;

283 i‡(
pAd
->
PrioRögTxC¡
 < 0)

284 
pAd
->
PrioRögTxC¡
 = 0;

286 
pAd
->
PrioRögFú°Index
++;

287 i‡(
pAd
->
PrioRögFú°Index
 >
PRIO_RING_SIZE
)

289 
pAd
->
PrioRögFú°Index
 = 0;

292 
	`DBGPRINT
(
RT_DEBUG_INFO
, "RTUSBBulkOutMLMEPacketComplete::PrioRingFirstIndex = %d, PrioRingTxCnt = %d, PopMgmtIndex = %d, PushMgmtIndex = %d, NextMLMEIndex = %d\n",

293 
pAd
->
PrioRögFú°Index
,

294 
pAd
->
PrioRögTxC¡
,ÖAd->
P›MgmtIndex
,ÖAd->
PushMgmtIndex
,ÖAd->
NextMLMEIndex
);

296 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->RTUSBBulkOutMLMEPacketComplete\n");

299 
pMLMEC⁄ãxt
->
IRPPídög
 = 
FALSE
;

300 
pMLMEC⁄ãxt
->
InU£
 = 
FALSE
;

301 
pMLMEC⁄ãxt
->
bWaôögBulkOut
 =
FALSE
;

303 i‡(
°©us
 =
USB_ST_NOERROR
)

306 
	`RTUSBDequeueMLMEPackë
(
pAd
);

311 i‡((!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)) &&

312 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) &&

313 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)) &&

314 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
)))

316 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "Bulk Out MLME Failed\n");

317 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
);

318 
	`RTUSBEnqueueI¡î«lCmd
(
pAd
, 
RT_OID_USB_RESET_BULK_OUT
);

322 
pMLMEC⁄ãxt
 = &
pAd
->
MLMEC⁄ãxt
[pAd->
PrioRögFú°Index
];

324 i‡–(
pAd
->
PrioRögTxC¡
 >1Ë&& (
pMLMEC⁄ãxt
->
bWaôögBulkOut
 =
TRUE
))

325 
	`RTUSB_SET_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_MLME
);

327 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

328 
pAd
->
BulkOutPídög
[0] = 
FALSE
;

329 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

333 
	`RTUSBKickBulkOut
(
pAd
);

335 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<---RTUSBBulkOutMLMEPacketComplete\n");

337 
	}
}

340 
VOID
 
	$RTUSBBulkOutPsPﬁlCom∂ëe
(
purbb_t
 
pUrb
,
±_ªgs
 *pt_regs)

342 
PRTMP_ADAPTER
 
pAd
;

343 
PTX_CONTEXT
 
pPsPﬁlC⁄ãxt
;

344 
NTSTATUS
 
°©us
;

345 
IrqFœgs
;

347 
pPsPﬁlC⁄ãxt
(
PTX_CONTEXT
)
pUrb
->
c⁄ãxt
;

348 
pAd
 = 
pPsPﬁlC⁄ãxt
->pAd;

350 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->RTUSBBulkOutPsPollComplete\n");

353 
pPsPﬁlC⁄ãxt
->
IRPPídög
 = 
FALSE
;

354 
pPsPﬁlC⁄ãxt
->
InU£
 = 
FALSE
;

356 
°©us
 = 
pUrb
->status;

357 i‡(
°©us
 =
USB_ST_NOERROR
)

360 
	`RTMPDeQueuePackë
(
pAd
, 0);

365 i‡((!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)) &&

366 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) &&

367 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)) &&

368 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
)))

370 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "Bulk Out PSPoll Failed\n");

371 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
);

372 
	`RTUSBEnqueueI¡î«lCmd
(
pAd
, 
RT_OID_USB_RESET_BULK_OUT
);

377 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

378 
pAd
->
BulkOutPídög
[0] = 
FALSE
;

379 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

383 
	`RTUSBKickBulkOut
(
pAd
);

385 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<---RTUSBBulkOutPsPollComplete\n");

387 
	}
}

412 
VOID
 
	$RTUSBBulkRxCom∂ëe
(
purbb_t
 
pUrb
, 
±_ªgs
 *pt_regs)

414 
PRX_CONTEXT
 
pRxC⁄ãxt
;

415 
PRTMP_ADAPTER
 
pAd
;

416 
NTSTATUS
 
°©us
;

418 
pRxC⁄ãxt
(
PRX_CONTEXT
)
pUrb
->
c⁄ãxt
;

419 
pAd
 = 
pRxC⁄ãxt
->pAd;

434 i‡–(
©omªad
 = (
	`©omic_ªad
(&
pRxC⁄ãxt
->
IΩLock
))Ë=
IRPLOCK_CANCE_START
)

436 
	`©omic_dec
(&
pAd
->
PídögRx
);

437 
	`©omic_£t
(&
pRxC⁄ãxt
->
IΩLock
, 
IRPLOCK_CANCE_COMPLETE
);

440 
°©us
 = 
pUrb
->status;

441 
	`©omic_£t
(&
pRxC⁄ãxt
->
IΩLock
, 
IRPLOCK_COMPLETED
);

442 if–
	`©omic_ªad
(&
pAd
->
PídögRx
) > 0)

443 
	`©omic_dec
(&
pAd
->
PídögRx
);

445 
°©us
)

450 -
ECONNRESET
:

451 -
ESHUTDOWN
:

453 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "==> RTUSBBulkRxCom∂ëêEº‹ codê%d\n", 
°©us
);

457 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "==> RTUSBBulkRxCom∂ëêUnKnow¿Eº‹ codê%d\n", 
°©us
);

461 i‡(
	`©omic_ªad
(&
pRxC⁄ãxt
->
IΩLock
Ë!
IRPLOCK_CANCE_START
)

463 
pAd
->
rx_bh
.
d©a
 = ()
pUrb
;

464 if(!
	`RTMP_TEST_FLAG
(
pAd
,
fRTMP_ADAPTER_HALT_IN_PROGRESS
))

465 
	`èskÀt_scheduÀ
(&
pAd
->
rx_bh
);

467 if(
pAd
->
BulkOutMaxPackëSize
 == 512)

469 
	`DBGPRINT
(
RT_DEBUG_INFO
, "In USB 2.0 Mode \n");

472 
	`RTUSBBulkRe˚ive
(
pAd
);

478 
	`DBGPRINT
(
RT_DEBUG_INFO
, "==> RTUSBBulkRxCom∂ëê (IΩLockË%d\n", 
	`©omic_ªad
(&
pRxC⁄ãxt
->
IΩLock
));

480 i‡((
°©us
 =
USB_ST_NOERROR
Ë&& (
	`©omic_ªad
(&
pRxC⁄ãxt
->
IΩLock
Ë!
IRPLOCK_CANCE_START
))

482 
	`RTUSBRxPackë
(
pUrb
);

488 
	`DBGPRINT
(
RT_DEBUG_TEMP
,"==> RTUSBBulkRxCom∂ëêEº‹ codê%d\n", 
°©us
);

489 
pRxC⁄ãxt
->
InU£
 = 
FALSE
;

491 i‡((!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)) &&

492 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKIN_RESET
)) &&

493 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) &&

494 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)))

496 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "Bulk In Failed\n");

497 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKIN_RESET
);

498 
	`RTUSBEnqueueI¡î«lCmd
(
pAd
, 
RT_OID_USB_RESET_BULK_IN
);

503 
	}
}

505 
VOID
 
	$RTUSBInôTxDesc
(

506 
IN
 
PRTMP_ADAPTER
 
pAd
,

507 
IN
 
PTX_CONTEXT
 
pTxC⁄ãxt
,

508 
IN
 
UCHAR
 
BulkOutPùeId
,

509 
IN
 
usb_com∂ëe_t
 
Func
)

511 
PURB
 
pUrb
;

512 
PUCHAR
 
pSrc
 = 
NULL
;

514 
pUrb
 = 
pTxC⁄ãxt
->pUrb;

515 
	`ASSERT
(
pUrb
);

518 
pTxC⁄ãxt
->
BulkOutPùeId
 = BulkOutPipeId;

520 
pSrc
 = (
PUCHAR
Ë&
pTxC⁄ãxt
->
Tøns„rBuf„r
->
TxDesc
;

524 
	`RTusb_fûl_bulk_urb
(
pUrb
,

525 
pAd
->
pUsb_Dev
,

526 
	`usb_¢dbulkpùe
(
pAd
->
pUsb_Dev
, 1),

527 
pSrc
,

528 
pTxC⁄ãxt
->
BulkOutSize
,

529 
Func
,

530 
pTxC⁄ãxt
);

532 
	}
}

534 
VOID
 
	$RTUSBInôRxDesc
(

535 
IN
 
PRTMP_ADAPTER
 
pAd
,

536 
IN
 
PRX_CONTEXT
 
pRxC⁄ãxt
)

538 
PURB
 
pUrb
;

540 
pUrb
 = 
pRxC⁄ãxt
->pUrb;

541 
	`ASSERT
(
pUrb
);

544 
	`RTusb_fûl_bulk_urb
(
pUrb
,

545 
pAd
->
pUsb_Dev
,

546 
	`usb_rcvbulkpùe
(
pAd
->
pUsb_Dev
, 1),

547 
pRxC⁄ãxt
->
Tøns„rBuf„r
,

548 
BUFFER_SIZE
,

549 
RTUSBBulkRxCom∂ëe
,

550 
pRxC⁄ãxt
);

551 
	}
}

566 
VOID
 
	$RTUSBBulkOutD©aPackë
(

567 
IN
 
PRTMP_ADAPTER
 
pAd
,

568 
IN
 
UCHAR
 
BulkOutPùeId
,

569 
IN
 
UCHAR
 
Index
)

571 
PTX_CONTEXT
 
pTxC⁄ãxt
;

572 
PURB
 
pUrb
;

573 
ªt
 = 0;

574 
IrqFœgs
;

576 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[
BulkOutPùeId
], 
IrqFœgs
);

577 i‡(
pAd
->
BulkOutPídög
[
BulkOutPùeId
] =
TRUE
)

579 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[
BulkOutPùeId
], 
IrqFœgs
);

582 
pAd
->
BulkOutPídög
[
BulkOutPùeId
] = 
TRUE
;

583 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[
BulkOutPùeId
], 
IrqFœgs
);

585 
pTxC⁄ãxt
 = &(
pAd
->
TxC⁄ãxt
[
BulkOutPùeId
][
Index
]);

588 
pAd
->
RÆökCou¡îs
.
TønsmôãdByãCou¡
 +
pTxC⁄ãxt
->
BulkOutSize
;

592 
	`RTUSB_CLEAR_BULK_FLAG
(
pAd
, (
fRTUSB_BULK_OUT_DATA_FRAG
 << 
BulkOutPùeId
));

593 
	`RTUSB_CLEAR_BULK_FLAG
(
pAd
, (
fRTUSB_BULK_OUT_DATA_NORMAL
 << 
BulkOutPùeId
));

595 i‡(
pTxC⁄ãxt
->
bWaôögBulkOut
 !
TRUE
)

597 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "RTUSBBulkOutDataPacket failed,ÖTxContext->bWaitingBulkOut != TRUE, Index %d, NextBulkOutIndex %d\n",

598 
Index
, 
pAd
->
NextBulkOutIndex
[
BulkOutPùeId
]);

599 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[
BulkOutPùeId
], 
IrqFœgs
);

600 
pAd
->
BulkOutPídög
[
BulkOutPùeId
] = 
FALSE
;

601 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[
BulkOutPùeId
], 
IrqFœgs
);

604 i‡(
pTxC⁄ãxt
->
BulkOutSize
 == 0)

612 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[
BulkOutPùeId
], 
IrqFœgs
);

614 
pTxC⁄ãxt
->
InU£
 = 
FALSE
;

615 
pTxC⁄ãxt
->
La°O√
 = 
FALSE
;

616 
pTxC⁄ãxt
->
IRPPídög
 = 
FALSE
;

617 
pTxC⁄ãxt
->
bWaôögBulkOut
 = 
FALSE
;

618 
pTxC⁄ãxt
->
BulkOutSize
= 0;

619 
pAd
->
NextBulkOutIndex
[
BulkOutPùeId
] = (pAd->NextBulkOutIndex[BulkOutPùeId] + 1Ë% 
TX_RING_SIZE
;

620 
pAd
->
BulkOutPídög
[
BulkOutPùeId
] = 
FALSE
;

621 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[
BulkOutPùeId
], 
IrqFœgs
);

625 i‡(!
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

630 
	`©omic_ªad
(&
pAd
->
TxCou¡
) > 0)

632 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "RTUSBBulkOutDataPacket failed, snice NdisMediaStateDisconnected discard NextBulkOutIndex %d, NextIndex = %d\n",

633 
pAd
->
NextBulkOutIndex
[
BulkOutPùeId
],ÖAd->
NextTxIndex
[BulkOutPipeId]);

635 
	`FREE_TX_RING
(
pAd
, 
BulkOutPùeId
, 
pTxC⁄ãxt
);

636 
pAd
->
TxRögTŸÆNumbî
[
BulkOutPùeId
]--;

637 
pTxC⁄ãxt
 = &(
pAd
->
TxC⁄ãxt
[
BulkOutPùeId
][pAd->
NextBulkOutIndex
[BulkOutPipeId]]);

640 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[
BulkOutPùeId
], 
IrqFœgs
);

641 
pAd
->
BulkOutPídög
[
BulkOutPùeId
] = 
FALSE
;

642 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[
BulkOutPùeId
], 
IrqFœgs
);

649 
	`RTUSBInôTxDesc
(
pAd
, 
pTxC⁄ãxt
, 
BulkOutPùeId
, 
RTUSBBulkOutD©aPackëCom∂ëe
);

652 
pTxC⁄ãxt
->
IRPPídög
 = 
TRUE
;

654 
pUrb
 = 
pTxC⁄ãxt
->pUrb;

655 if((
ªt
 = 
	`πusb_submô_urb
(
pUrb
))!=0)

657 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Submô Tx URB faûed %d\n", 
ªt
);

661 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<---RTUSBBulkOutDataPacket \n");

663 
	}
}

678 
VOID
 
	$RTUSBBulkOutNuŒFøme
(

679 
IN
 
PRTMP_ADAPTER
 
pAd
)

681 
PTX_CONTEXT
 
pNuŒC⁄ãxt
 = &(
pAd
->
NuŒC⁄ãxt
);

682 
PURB
 
pUrb
;

683 
ªt
 = 0;

684 
IrqFœgs
;

686 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

687 i‡(
pAd
->
BulkOutPídög
[0] =
TRUE
)

689 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

692 
pAd
->
BulkOutPídög
[0] = 
TRUE
;

693 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

696 
pAd
->
RÆökCou¡îs
.
TønsmôãdByãCou¡
 +
pNuŒC⁄ãxt
->
BulkOutSize
;

698 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->RTUSBBulkOutNullFrame \n");

701 
	`RTUSB_CLEAR_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_NULL
);

705 
	`RTUSBInôTxDesc
(
pAd
, 
pNuŒC⁄ãxt
, 0, 
RTUSBBulkOutNuŒFømeCom∂ëe
);

706 
pNuŒC⁄ãxt
->
IRPPídög
 = 
TRUE
;

708 
pUrb
 = 
pNuŒC⁄ãxt
->pUrb;

709 if((
ªt
 = 
	`πusb_submô_urb
(
pUrb
))!=0)

711 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"Submô Tx URB faûed %d\n", 
ªt
);

715 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<---RTUSBBulkOutNullFrame \n");

717 
	}
}

732 
VOID
 
	$RTUSBBulkOutRTSFøme
(

733 
IN
 
PRTMP_ADAPTER
 
pAd
)

735 
PTX_CONTEXT
 
pRTSC⁄ãxt
 = &(
pAd
->
RTSC⁄ãxt
);

736 
PURB
 
pUrb
;

737 
ªt
 = 0;

738 
IrqFœgs
;

739 
UCHAR
 
PùeID
=0;

741 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_NORMAL_4
))

742 
PùeID
= 3;

743 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_NORMAL_3
))

744 
PùeID
= 2;

745 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_NORMAL_2
))

746 
PùeID
= 1;

747 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_NORMAL
))

748 
PùeID
= 0;

751 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[
PùeID
], 
IrqFœgs
);

752 i‡(
pAd
->
BulkOutPídög
[
PùeID
] =
TRUE
)

754 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[
PùeID
], 
IrqFœgs
);

757 
pAd
->
BulkOutPídög
[
PùeID
] = 
TRUE
;

758 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[
PùeID
], 
IrqFœgs
);

761 
pAd
->
RÆökCou¡îs
.
TønsmôãdByãCou¡
 +
pRTSC⁄ãxt
->
BulkOutSize
;

763 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->RTUSBBulkOutRTSFrame \n");

766 
	`RTUSB_CLEAR_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_RTS
);

769 
	`RTUSBInôTxDesc
(
pAd
, 
pRTSC⁄ãxt
, 
PùeID
, 
RTUSBBulkOutRTSFømeCom∂ëe
);

770 
pRTSC⁄ãxt
->
IRPPídög
 = 
TRUE
;

772 
pUrb
 = 
pRTSC⁄ãxt
->pUrb;

773 if((
ªt
 = 
	`πusb_submô_urb
(
pUrb
))!=0)

775 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"Submô Tx URB faûed %d\n", 
ªt
);

779 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<---RTUSBBulkOutRTSFrame \n");

781 
	}
}

796 
VOID
 
	$RTUSBBulkOutMLMEPackë
(

797 
IN
 
PRTMP_ADAPTER
 
pAd
,

798 
IN
 
UCHAR
 
Index
)

800 
PTX_CONTEXT
 
pMLMEC⁄ãxt
;

801 
PURB
 
pUrb
;

802 
ªt
 = 0;

803 
IrqFœgs
;

805 
pMLMEC⁄ãxt
 = &
pAd
->
MLMEC⁄ãxt
[
Index
];

807 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

808 i‡(
pAd
->
BulkOutPídög
[0] =
TRUE
)

810 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

813 
pAd
->
BulkOutPídög
[0] = 
TRUE
;

814 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

817 
pAd
->
RÆökCou¡îs
.
TønsmôãdByãCou¡
 +
pMLMEC⁄ãxt
->
BulkOutSize
;

820 
	`RTUSB_CLEAR_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_MLME
);

822 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "RTUSBBulkOutMLMEPacket::PrioRingFirstIndex = %d, PrioRingTxCnt = %d, PopMgmtIndex = %d, PushMgmtIndex = %d, NextMLMEIndex = %d\n",

823 
pAd
->
PrioRögFú°Index
,

824 
pAd
->
PrioRögTxC¡
,ÖAd->
P›MgmtIndex
,ÖAd->
PushMgmtIndex
,ÖAd->
NextMLMEIndex
);

826 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->RTUSBBulkOutMLMEPacket\n");

830 
	`RTUSBInôTxDesc
(
pAd
, 
pMLMEC⁄ãxt
, 0, 
RTUSBBulkOutMLMEPackëCom∂ëe
);

831 
pMLMEC⁄ãxt
->
IRPPídög
 = 
TRUE
;

834 
pUrb
 = 
pMLMEC⁄ãxt
->pUrb;

835 if((
ªt
 = 
	`πusb_submô_urb
(
pUrb
))!=0)

837 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"Submô MLME URB faûed %d\n", 
ªt
);

841 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<---RTUSBBulkOutMLMEPacket \n");

843 
	}
}

858 
VOID
 
	$RTUSBBulkOutPsPﬁl
(

859 
IN
 
PRTMP_ADAPTER
 
pAd
)

861 
PTX_CONTEXT
 
pPsPﬁlC⁄ãxt
 = &(
pAd
->
PsPﬁlC⁄ãxt
);

862 
PURB
 
pUrb
;

863 
ªt
 = 0;

864 
IrqFœgs
;

866 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

867 i‡(
pAd
->
BulkOutPídög
[0] =
TRUE
)

869 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

872 
pAd
->
BulkOutPídög
[0] = 
TRUE
;

873 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

875 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->RTUSBBulkOutPsPoll \n");

878 
	`RTUSB_CLEAR_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_PSPOLL
);

882 
	`RTUSBInôTxDesc
(
pAd
, 
pPsPﬁlC⁄ãxt
, 0, 
RTUSBBulkOutPsPﬁlCom∂ëe
);

883 
pPsPﬁlC⁄ãxt
->
IRPPídög
 = 
TRUE
;

885 
pUrb
 = 
pPsPﬁlC⁄ãxt
->pUrb;

886 if((
ªt
 = 
	`πusb_submô_urb
(
pUrb
))!=0)

888 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"Submô Tx URB faûed %d\n", 
ªt
);

892 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<---RTUSBBulkOutPsPoll \n");

894 
	}
}

895 
	$dump_urb
(
urb
* 
purb
)

897 
	`¥ötk
("urb :0x%08lx\n", ()
purb
);

898 
	`¥ötk
("\tdev :0x%08lx\n", ()
purb
->
dev
);

900 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2,6,0)

901 
	`¥ötk
("\t\tdev->°©ê :0x%d\n", 
purb
->
dev
->
°©e
);

904 
	`¥ötk
("\çùê :0x%08x\n", 
purb
->
pùe
);

905 
	`¥ötk
("\t°©u† :%d\n", 
purb
->
°©us
);

906 
	`¥ötk
("\âøns„r_Êag† :0x%08x\n", 
purb
->
å™s„r_Êags
);

907 
	`¥ötk
("\âøns„r_buf„∏ :0x%08lx\n", ()
purb
->
å™s„r_buf„r
);

908 
	`¥ötk
("\âøns„r_buf„r_Àngth:%d\n", 
purb
->
å™s„r_buf„r_Àngth
);

909 
	`¥ötk
("\è˘uÆ_Àngth :%d\n", 
purb
->
a˘uÆ_Àngth
);

910 
	`¥ötk
("\t£tup_∑ckë :0x%08lx\n", ()
purb
->
£tup_∑ckë
);

911 
	`¥ötk
("\t°¨t_‰amê :%d\n", 
purb
->
°¨t_‰ame
);

912 
	`¥ötk
("\äumbî_of_∑ckë† :%d\n", 
purb
->
numbî_of_∑ckës
);

913 
	`¥ötk
("\töãrvÆ :%d\n", 
purb
->
öãrvÆ
);

914 
	`¥ötk
("\ãº‹_cou¡ :%d\n", 
purb
->
îr‹_cou¡
);

915 
	`¥ötk
("\tc⁄ãxà :0x%08lx\n", ()
purb
->
c⁄ãxt
);

916 
	`¥ötk
("\tcom∂ëê :0x%08lx\n", ()
purb
->
com∂ëe
);

918 
	}
}

941 
VOID
 
	$RTUSBBulkRe˚ive
(

942 
IN
 
PRTMP_ADAPTER
 
pAd
)

944 
PRX_CONTEXT
 
pRxC⁄ãxt
;

945 
PURB
 
pUrb
;

946 
ªt
 = 0;

948 i‡((
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
))||

949 (
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
))||

950 (
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_PIPE_IN_PROGRESS
)))

955 
	`DBGPRINT
(
RT_DEBUG_INFO
,"RTUSBBulkRe˚ive::ÖAd->NextRxBulkInIndex = %d\n",
pAd
->
NextRxBulkInIndex
);

958 
pRxC⁄ãxt
 = &(
pAd
->
RxC⁄ãxt
[pAd->
NextRxBulkInIndex
]);

959 
pRxC⁄ãxt
->
InU£
 = 
TRUE
;

960 
pAd
->
NextRxBulkInIndex
 = (pAd->NextRxBulkInIndex + 1Ë% 
RX_RING_SIZE
;

962 
	`©omic_£t
(&
pRxC⁄ãxt
->
IΩLock
, 
IRPLOCK_CANCELABLE
);

965 
	`NdisZîoMem‹y
(
pRxC⁄ãxt
->
Tøns„rBuf„r
, 
BUFFER_SIZE
);

966 
	`RTUSBInôRxDesc
(
pAd
, 
pRxC⁄ãxt
);

968 
pUrb
 = 
pRxC⁄ãxt
->pUrb;

969 if((
ªt
 = 
	`πusb_submô_urb
(
pUrb
))!=0)

971 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"Submô Rx URB faûed %d\n", 
ªt
);

975 
	`©omic_öc
(&
pAd
->
PídögRx
);

978 
	}
}

980 
VOID
 
	$RTUSBBulkRxH™dÀ
(

981 
IN
 
d©a
)

983 
purbb_t
 
pUrb
 = (purbb_t)
d©a
;

984 
PRTMP_ADAPTER
 
pAd
;

985 
PRX_CONTEXT
 
pRxC⁄ãxt
;

987 
pRxC⁄ãxt
 = (
PRX_CONTEXT
)
pUrb
->
c⁄ãxt
;

988 
pAd
 = 
pRxC⁄ãxt
->pAd;

991 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_REMOVE_IN_PROGRESS
))

994 if(
pUrb
->
°©us
 != 0)

996 
	`RTUSBBulkRe˚ive
(
pAd
);

1000 
	`RTUSBRxPackë
(
d©a
);

1002 
	}
}

1017 
VOID
 
	$RTUSBKickBulkOut
(

1018 
IN
 
PRTMP_ADAPTER
 
pAd
)

1021 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->RTUSBKickBulkOut\n");

1024 i‡(!(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)) &&

1025 !(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) &&

1026 !(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)) &&

1027 !(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_PIPE_IN_PROGRESS
)) &&

1028 #ifde‡
RALINK_ATE


1029 !(
pAd
->
©e
.
Mode
 !
ATE_STASTART
) &&

1031 !(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
)))

1035 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_FRAG
))

1037 i‡((!
	`LOCAL_TX_RING_EMPTY
(
pAd
, 0)) &&

1038 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
)))

1040 
	`RTUSBBulkOutD©aPackë
(
pAd
, 0,ÖAd->
NextBulkOutIndex
[0]);

1044 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_FRAG_2
))

1046 i‡((!
	`LOCAL_TX_RING_EMPTY
(
pAd
, 1)) &&

1047 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
)))

1049 
	`RTUSBBulkOutD©aPackë
(
pAd
, 1,ÖAd->
NextBulkOutIndex
[1]);

1053 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_FRAG_3
))

1055 i‡((!
	`LOCAL_TX_RING_EMPTY
(
pAd
, 2)) &&

1056 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
)))

1058 
	`RTUSBBulkOutD©aPackë
(
pAd
, 2,ÖAd->
NextBulkOutIndex
[2]);

1062 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_FRAG_4
))

1064 i‡((!
	`LOCAL_TX_RING_EMPTY
(
pAd
, 3)) &&

1065 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
)))

1067 
	`RTUSBBulkOutD©aPackë
(
pAd
, 3,ÖAd->
NextBulkOutIndex
[3]);

1072 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_PSPOLL
))

1074 
	`RTUSBBulkOutPsPﬁl
(
pAd
);

1077 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_MLME
))

1079 
	`RTUSBBulkOutMLMEPackë
(
pAd
,ÖAd->
PrioRögFú°Index
);

1083 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_NORMAL
))

1085 i‡((!
	`LOCAL_TX_RING_EMPTY
(
pAd
, 0)) &&

1086 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
)))

1088 
	`RTUSBBulkOutD©aPackë
(
pAd
, 0,ÖAd->
NextBulkOutIndex
[0]);

1092 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_NORMAL_2
))

1094 i‡((!
	`LOCAL_TX_RING_EMPTY
(
pAd
, 1)) &&

1095 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
)))

1097 
	`RTUSBBulkOutD©aPackë
(
pAd
, 1,ÖAd->
NextBulkOutIndex
[1]);

1101 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_NORMAL_3
))

1103 i‡((!
	`LOCAL_TX_RING_EMPTY
(
pAd
, 2)) &&

1104 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
)))

1106 
	`RTUSBBulkOutD©aPackë
(
pAd
, 2,ÖAd->
NextBulkOutIndex
[2]);

1110 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_NORMAL_4
))

1112 i‡((!
	`LOCAL_TX_RING_EMPTY
(
pAd
, 3)) &&

1113 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
)))

1115 
	`RTUSBBulkOutD©aPackë
(
pAd
, 3,ÖAd->
NextBulkOutIndex
[3]);

1120 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_NULL
))

1122 i‡(!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
))

1124 
	`RTUSBBulkOutNuŒFøme
(
pAd
);

1135 #ifde‡
RALINK_ATE


1137 if((
pAd
->
©e
.
Mode
 !
ATE_STASTART
) &&

1138 !(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)) &&

1139 !(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) &&

1140 !(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)) &&

1141 !(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_PIPE_IN_PROGRESS
)) &&

1142 !(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
)))

1144 i‡(
	`RTUSB_TEST_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_ATE
))

1146 
	`ATE_RTUSBBulkOutD©aPackë
(
pAd
);

1151 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<---RTUSBKickBulkOut\n");

1152 
	}
}

1167 
VOID
 
	$RTUSBCÀ™UpD©aBulkOutQueue
(

1168 
IN
 
PRTMP_ADAPTER
 
pAd
)

1170 
UCHAR
 
Idx
;

1171 
PTX_CONTEXT
 
pTxC⁄ãxt
;

1172 
IrqFœgs
;

1174 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "--->CleanUpDataBulkOutQueue\n");

1176 
Idx
 = 0; Idx < 4; Idx++)

1178 !
	`LOCAL_TX_RING_EMPTY
(
pAd
, 
Idx
))

1180 
pTxC⁄ãxt
 = &(
pAd
->
TxC⁄ãxt
[
Idx
][pAd->
NextBulkOutIndex
[Idx]]);

1181 
pTxC⁄ãxt
->
La°O√
 = 
FALSE
;

1182 
pTxC⁄ãxt
->
InU£
 = 
FALSE
;

1183 
pTxC⁄ãxt
->
bWaôögBulkOut
 = 
FALSE
;

1184 
pAd
->
NextBulkOutIndex
[
Idx
] = (pAd->NextBulkOutIndex[Idx] + 1Ë% 
TX_RING_SIZE
;

1186 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[
Idx
], 
IrqFœgs
);

1187 
pAd
->
BulkOutPídög
[
Idx
] = 
FALSE
;

1188 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[
Idx
], 
IrqFœgs
);

1191 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<---CleanUpDataBulkOutQueue\n");

1192 
	}
}

1207 
VOID
 
	$RTUSBCÀ™UpMLMEBulkOutQueue
(

1208 
IN
 
PRTMP_ADAPTER
 
pAd
)

1210 
IrqFœgs
;

1212 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "--->CleanUpMLMEBulkOutQueue\n");

1214 
	`NdisAcquúeSpöLock
(&
pAd
->
MLMEQLock
, 
IrqFœgs
);

1215 
pAd
->
PrioRögTxC¡
 > 0)

1217 
pAd
->
MLMEC⁄ãxt
[pAd->
PrioRögFú°Index
].
InU£
 = 
FALSE
;

1219 
pAd
->
PrioRögFú°Index
++;

1220 i‡(
pAd
->
PrioRögFú°Index
 >
PRIO_RING_SIZE
)

1222 
pAd
->
PrioRögFú°Index
 = 0;

1225 
pAd
->
PrioRögTxC¡
--;

1227 
	`NdisRñó£SpöLock
(&
pAd
->
MLMEQLock
, 
IrqFœgs
);

1229 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<---CleanUpMLMEBulkOutQueue\n");

1230 
	}
}

1245 
VOID
 
	$RTUSBC™˚lPídögBulkInIRP
(

1246 
IN
 
PRTMP_ADAPTER
 
pAd
)

1248 
PRX_CONTEXT
 
pRxC⁄ãxt
;

1249 
UINT
 
i
;

1251 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"--->RTUSBCancelPendingBulkInIRP\n");

1252  
i
 = 0; i < 
RX_RING_SIZE
; i++)

1255 
pRxC⁄ãxt
 = &(
pAd
->
RxC⁄ãxt
[
i
]);

1256 if(
	`©omic_ªad
(&
pRxC⁄ãxt
->
IΩLock
Ë=
IRPLOCK_CANCELABLE
)

1258 
	`RTUSB_UNLINK_URB
(
pRxC⁄ãxt
->
pUrb
);

1260 
	`©omic_£t
(&
pRxC⁄ãxt
->
IΩLock
, 
IRPLOCK_CANCE_START
);

1262 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"<---RTUSBCancelPendingBulkInIRP\n");

1263 
	}
}

1278 
VOID
 
	$RTUSBC™˚lPídögBulkOutIRP
(

1279 
IN
 
PRTMP_ADAPTER
 
pAd
)

1281 
PTX_CONTEXT
 
pTxC⁄ãxt
;

1282 
PTX_CONTEXT
 
pMLMEC⁄ãxt
;

1283 
PTX_CONTEXT
 
pBóc⁄C⁄ãxt
;

1284 
PTX_CONTEXT
 
pNuŒC⁄ãxt
;

1285 
PTX_CONTEXT
 
pPsPﬁlC⁄ãxt
;

1286 
PTX_CONTEXT
 
pRTSC⁄ãxt
;

1287 
UINT
 
i
, 
Idx
;

1288 
IrqFœgs
;

1290 
Idx
 = 0; Idx < 4; Idx++)

1292 
i
 = 0; i < 
TX_RING_SIZE
; i++)

1294 
pTxC⁄ãxt
 = &(
pAd
->
TxC⁄ãxt
[
Idx
][
i
]);

1296 i‡(
pTxC⁄ãxt
->
IRPPídög
 =
TRUE
)

1304 
	`RTUSB_UNLINK_URB
(
pTxC⁄ãxt
->
pUrb
);

1307 
	`RTMPu£cDñay
(200);

1312 
i
 = 0; i < 
PRIO_RING_SIZE
; i++)

1314 
pMLMEC⁄ãxt
 = &(
pAd
->
MLMEC⁄ãxt
[
i
]);

1316 if(
pMLMEC⁄ãxt
->
IRPPídög
 =
TRUE
)

1324 
	`RTUSB_UNLINK_URB
(
pMLMEC⁄ãxt
->
pUrb
);

1327 
	`RTMPu£cDñay
(200);

1331 
i
 = 0; i < 
BEACON_RING_SIZE
; i++)

1333 
pBóc⁄C⁄ãxt
 = &(
pAd
->
Bóc⁄C⁄ãxt
[
i
]);

1335 if(
pBóc⁄C⁄ãxt
->
IRPPídög
 =
TRUE
)

1343 
	`RTUSB_UNLINK_URB
(
pBóc⁄C⁄ãxt
->
pUrb
);

1346 
	`RTMPu£cDñay
(200);

1350 
pNuŒC⁄ãxt
 = &(
pAd
->
NuŒC⁄ãxt
);

1351 i‡(
pNuŒC⁄ãxt
->
IRPPídög
 =
TRUE
)

1352 
	`RTUSB_UNLINK_URB
(
pNuŒC⁄ãxt
->
pUrb
);

1354 
pRTSC⁄ãxt
 = &(
pAd
->
RTSC⁄ãxt
);

1355 i‡(
pRTSC⁄ãxt
->
IRPPídög
 =
TRUE
)

1356 
	`RTUSB_UNLINK_URB
(
pRTSC⁄ãxt
->
pUrb
);

1358 
pPsPﬁlC⁄ãxt
 = &(
pAd
->
PsPﬁlC⁄ãxt
);

1359 i‡(
pPsPﬁlC⁄ãxt
->
IRPPídög
 =
TRUE
)

1360 
	`RTUSB_UNLINK_URB
(
pPsPﬁlC⁄ãxt
->
pUrb
);

1362 
Idx
 = 0; Idx < 4; Idx++)

1364 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[
Idx
], 
IrqFœgs
);

1365 
pAd
->
BulkOutPídög
[
Idx
] = 
FALSE
;

1366 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[
Idx
], 
IrqFœgs
);

1368 
	}
}

1383 
VOID
 
	$RTUSBC™˚lPídögIRPs
(

1384 
IN
 
PRTMP_ADAPTER
 
pAd
)

1386 
	`RTUSBC™˚lPídögBulkInIRP
(
pAd
);

1387 
	`RTUSBC™˚lPídögBulkOutIRP
(
pAd
);

1388 
	}
}

1390 #ifde‡
RALINK_ATE


1391 
VOID
 
	$ATE_RTUSBBulkOutD©aPackëCom∂ëe
(
purbb_t
 
pUrb
, 
±_ªgs
 *pt_regs)

1393 
PRTMP_ADAPTER
 
pAd
;

1394 
PTX_CONTEXT
 
pNuŒC⁄ãxt
;

1395 
NTSTATUS
 
°©us
;

1396 
IrqFœgs
;

1397 
ULONG
 
OldVÆue
;

1399 
pNuŒC⁄ãxt
(
PTX_CONTEXT
)
pUrb
->
c⁄ãxt
;

1400 
pAd
 = 
pNuŒC⁄ãxt
->pAd;

1402 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->ATE_RTUSBBulkOutDataPacketComplete\n");

1405 
pNuŒC⁄ãxt
->
IRPPídög
 = 
FALSE
;

1406 
pNuŒC⁄ãxt
->
InU£
 = 
FALSE
;

1408 
°©us
 = 
pUrb
->status;

1410 i‡(
°©us
 =
USB_ST_NOERROR
)

1413 
	`RTMPDeQueuePackë
(
pAd
, 0);

1418 i‡((!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)) &&

1419 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) &&

1420 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)) &&

1421 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
)))

1423 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "Bulk Out Null Frame Failed\n");

1424 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
);

1425 
	`RTUSBEnqueueI¡î«lCmd
(
pAd
, 
RT_OID_USB_RESET_BULK_OUT
);

1430 i‡(
	`©omic_ªad
(&
pAd
->
BulkOutRemaöed
) > 0)

1432 
	`©omic_dec
(&
pAd
->
BulkOutRemaöed
);

1433 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Bulk OuàRemaöed = %d\n", 
	`©omic_ªad
(&
pAd
->
BulkOutRemaöed
));

1437 
OldVÆue
 = 
pAd
->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
vv
.
LowP¨t
;

1438 
pAd
->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
vv
.
LowP¨t
++;

1439 i‡(
pAd
->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
vv
.
LowP¨t
 < 
OldVÆue
)

1441 
pAd
->
WœnCou¡îs
.
TønsmôãdFøgmítCou¡
.
vv
.
HighP¨t
++;

1444 if(((
pAd
->
C⁄töBulkOut
 =
TRUE
 ) ||(
	`©omic_ªad
(&pAd->
BulkOutRemaöed
Ë> 0)Ë&& (pAd->
©e
.
Mode
 !
ATE_STASTART
))

1447 
	`DBGPRINT
(
RT_DEBUG_INFO
, "ContinBulkOut = TRUE \n");

1448 
	`RTUSB_SET_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_ATE
);

1452 
	`RTUSB_CLEAR_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_ATE
);

1455 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

1456 
pAd
->
BulkOutPídög
[0] = 
FALSE
;

1457 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

1460 
	`RTUSBKickBulkOut
(
pAd
);

1462 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<---ATE_RTUSBBulkOutDataPacketComplete\n");

1464 
	}
}

1467 
VOID
 
	$ATE_RTUSBBulkOutD©aPackë
(

1468 
IN
 
PRTMP_ADAPTER
 
pAd
)

1470 
PTX_CONTEXT
 
pNuŒC⁄ãxt
 = &(
pAd
->
NuŒC⁄ãxt
);

1471 
PURB
 
pUrb
;

1472 
ªt
 = 0;

1473 
IrqFœgs
;

1476 
	`ATE_RTMPSídNuŒFøme
(
pAd
);

1478 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->ATE_RTUSBBulkOutDataPacket \n");

1479 
	`NdisAcquúeSpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

1480 i‡(
pAd
->
BulkOutPídög
[0] =
TRUE
)

1482 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->ATE_RTUSBBulkOutDataPacket BulkOutPending \n");

1483 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

1486 
pAd
->
BulkOutPídög
[0] = 
TRUE
;

1487 
	`NdisRñó£SpöLock
(&
pAd
->
BulkOutLock
[0], 
IrqFœgs
);

1490 
pAd
->
RÆökCou¡îs
.
TønsmôãdByãCou¡
 +
pNuŒC⁄ãxt
->
BulkOutSize
;

1492 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->ATE_RTUSBBulkOutDataPacket \n");

1495 
	`RTUSB_CLEAR_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_ATE
);

1498 
	`RTUSBInôTxDesc
(
pAd
, 
pNuŒC⁄ãxt
, 0, 
ATE_RTUSBBulkOutD©aPackëCom∂ëe
);

1499 
pNuŒC⁄ãxt
->
IRPPídög
 = 
TRUE
;

1501 
pUrb
 = 
pNuŒC⁄ãxt
->pUrb;

1502 if((
ªt
 = 
	`πusb_submô_urb
(
pUrb
))!=0)

1504 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"Submô Tx URB faûed %d\n", 
ªt
);

1508 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<---ATE_RTUSBBulkOutDataPacket \n");

1510 
	}
}

	@rtusb_data.c

39 
	~"π_c⁄fig.h
"

40 
	~<√t/iw_h™dÀr.h
>

42 
UCHAR
 
Phy11BGNextR©eUpw¨d
[];

44 
UCHAR
 
	gSNAP_802_1H
[] = {0xaa, 0xaa, 0x03, 0x00, 0x00, 0x00};

45 
UCHAR
 
	gSNAP_BRIDGE_TUNNEL
[] = {0xaa, 0xaa, 0x03, 0x00, 0x00, 0xf8};

46 
UCHAR
 
	gEAPOL_LLC_SNAP
[]= {0xaa, 0xaa, 0x03, 0x00, 0x00, 0x00, 0x88, 0x8e};

47 
UCHAR
 
	gEAPOL
[] = {0x88, 0x8e};

49 
UCHAR
 
	gIPX
[] = {0x81, 0x37};

50 
UCHAR
 
	gAPPLE_TALK
[] = {0x80, 0xf3};

52 
UCHAR
 
	gR©eIdToPl˝Sig«l
[12] = {

57 
UCHAR
 
	gOfdmSig«lToR©eId
[16] = {

58 
RATE_54
, RATE_54, RATE_54, RATE_54,

59 
RATE_54
, RATE_54, RATE_54, RATE_54,

60 
RATE_48
, 
RATE_24
, 
RATE_12
, 
RATE_6
,

61 
RATE_54
, 
RATE_36
, 
RATE_18
, 
RATE_9
,

64 
UCHAR
 
	gdeÁu…_cwmö
[]={
CW_MIN_IN_BITS
, CW_MIN_IN_BITS, CW_MIN_IN_BITS-1, CW_MIN_IN_BITS-2};

65 
UCHAR
 
	gdeÁu…_cwmax
[]={
CW_MAX_IN_BITS
, CW_MAX_IN_BITS, 
CW_MIN_IN_BITS
, CW_MIN_IN_BITS-1};

66 
UCHAR
 
	gdeÁu…_°a_aif¢
[]={3,7,2,2};

68 
UCHAR
 
	gM≠U£rPri‹ôyToAc˚ssC©eg‹y
[8] = {
QID_AC_BE
, 
QID_AC_BK
, QID_AC_BK, QID_AC_BE, 
QID_AC_VI
, QID_AC_VI, 
QID_AC_VO
, QID_AC_VO};

72 
VOID
 
	$REPORT_ETHERNET_FRAME_TO_LLC
(

73 
IN
 
PRTMP_ADAPTER
 
pAd
,

74 
IN
 
PUCHAR
 
p8023hdr
,

75 
IN
 
PUCHAR
 
pD©a
,

76 
IN
 
ULONG
 
D©aSize
,

77 
IN
 
√t_devi˚
 *
√t_dev
)

79 
sk_buff
 *
pSkb
;

81 #ifde‡
RTMP_EMBEDDED


82 i‡((
pSkb
 = 
	`__dev_Æloc_skb
(
D©aSize
 + 
LENGTH_802_3
 + 2, 
GFP_DMA
|
GFP_ATOMIC
)Ë!
NULL
)

84 i‡((
pSkb
 = 
	`dev_Æloc_skb
(
D©aSize
 + 
LENGTH_802_3
 + 2)Ë!
NULL
)

88 
pSkb
->
dev
 = 
√t_dev
;

89 
	`skb_ª£rve
(
pSkb
, 2);

90 
	`mem˝y
(
	`skb_put
(
pSkb
, 
LENGTH_802_3
), 
p8023hdr
, LENGTH_802_3);

91 
	`mem˝y
(
	`skb_put
(
pSkb
, 
D©aSize
), 
pD©a
, DataSize);

92 
pSkb
->
¥Ÿocﬁ
 = 
	`ëh_ty≥_å™s
’Skb, 
√t_dev
);

94 
	`√tif_rx
(
pSkb
);

96 
pAd
->
√t_dev
->
œ°_rx
 = 
jiffõs
;

97 
pAd
->
°©s
.
rx_∑ckës
++;

99 
pAd
->
Cou¡îs8023
.
GoodRe˚ives
++;

101 
	}
}

103 
NDIS_STATUS
 
	$RTMPDe¸y±PktBySo·w¨e
(

104 
IN
 
PRTMP_ADAPTER
 
pAd
,

105 
IN
 
PUCHAR
 
pD©a
,

106 
IN
 
PRXD_STRUC
 
pRxD
)

108 
UCHAR
 
KeyIdx
 = 
pAd
->
P‹tCfg
.
DeÁu…KeyId
;

110 
	`DBGPRINT
(
RT_DEBUG_INFO
, "RTMPDecryptPktBySoftware ==>\n");

113 if(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11WEPE«bÀd
)

115 
UCHAR
 *
pPaylﬂd
 = (UCHAR *)
pD©a
 + 
LENGTH_802_11
;

117 i‡(
	`RTMPDe¸y±D©a
(
pAd
, 
pPaylﬂd
, 
pRxD
->
D©aByãC¡
 - 
LENGTH_802_11
Ë=
FALSE
)

119 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "ERROR : Software decrypt WEP data fails.\n");

120  (
NDIS_STATUS_FAILURE
);

124 
pRxD
->
D©aByãC¡
 -= 8;

125 
pRxD
->
CùhîAlg
 = 
CIPHER_WEP64
;

128 
	`DBGPRINT
(
RT_DEBUG_INFO
, "RTMPDecryptData WEP data Complete \n");

131 if(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
)

133 i‡(
	`RTMPSo·De¸y±TKIP
(
pAd
, 
pD©a
, 
pRxD
->
D©aByãC¡
, 0, &pAd->
Sh¨edKey
[
KeyIdx
]))

135 
	`DBGPRINT
(
RT_DEBUG_INFO
, "RTMPSoftDecryptTKIP Complete \n");

136 
pRxD
->
D©aByãC¡
 -= 20;

137 
pRxD
->
CùhîAlg
 = 
CIPHER_TKIP
;

141 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "ERROR : RTMPSoftDecryptTKIP Failed\n");

142  (
NDIS_STATUS_FAILURE
);

146 if(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

148 i‡(
	`RTMPSo·De¸y±AES
(
pAd
, 
pD©a
, 
pRxD
->
D©aByãC¡
, &pAd->
Sh¨edKey
[
KeyIdx
]))

150 
	`DBGPRINT
(
RT_DEBUG_INFO
, "RTMPSoftDecryptAES Complete \n");

151 
pRxD
->
D©aByãC¡
 -= 16;

152 
pRxD
->
CùhîAlg
 = 
CIPHER_AES
;

156 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "ERROR : RTMPSoftDecryptAES Failed\n");

157  (
NDIS_STATUS_FAILURE
);

162  (
NDIS_STATUS_FAILURE
);

165  (
NDIS_STATUS_SUCCESS
);

166 
	}
}

178 
	#REPORT_MGMT_FRAME_TO_MLME
(
_pAd
, 
_p80211hdr
, 
_pFøme
, 
_FømeSize
, 
_Rssi
, 
_Pl˝Sig«l
) \

180 
	`MlmeEnqueueF‹Recv
(
_pAd
, (
PFRAME_802_11
)
_p80211hdr
, (
UCHAR
)
_Rssi
, 
_FømeSize
, 
_pFøme
, (UCHAR)
_Pl˝Sig«l
); \

181 }

	)

186 
NDIS_STATUS
 
	$Sniff2ByãsFromNdisBuf„r
(

187 
IN
 
sk_buff
 *
pFú°Skb
,

188 
IN
 
UCHAR
 
DesúedOff£t
,

189 
OUT
 
PUCHAR
 
pByã0
,

190 
OUT
 
PUCHAR
 
pByã1
)

192 
PUCHAR
 
pBuf„rVA
;

193 
ULONG
 
Buf„rLí
, 
AccumuœãBuf„rLí
, 
Buf„rBegöOff£t
;

195 
pBuf„rVA
 = (
PVOID
)
pFú°Skb
->
d©a
;

196 
Buf„rLí
 = 
pFú°Skb
->
Àn
;

197 
Buf„rBegöOff£t
 = 0;

198 
AccumuœãBuf„rLí
 = 
Buf„rLí
;

200 *
pByã0
 = *(
PUCHAR
)(
pBuf„rVA
 + 
DesúedOff£t
 - 
Buf„rBegöOff£t
);

201 *
pByã1
 = *(
PUCHAR
)(
pBuf„rVA
 + 
DesúedOff£t
 - 
Buf„rBegöOff£t
 + 1);

202  
NDIS_STATUS_SUCCESS
;

203 
	}
}

223 
NDIS_STATUS
 
	$RTMPSídPackë
(

224 
IN
 
PRTMP_ADAPTER
 
pAd
,

225 
IN
 
sk_buff
 *
pSkb
)

227 
PUCHAR
 
pSrcBufVA
;

228 
UINT
 
AŒowFøgSize
;

229 
UCHAR
 
NumbîOfFøg
;

230 
UCHAR
 
RTSRequúed
;

231 
UCHAR
 
QueIdx
, 
U£rPri‹ôy
;

232 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

233 
PQUEUE_HEADER
 
pTxQueue
;

234 
UCHAR
 
PsMode
;

235 
IrqFœgs
;

237 
	`DBGPRINT
(
RT_DEBUG_INFO
, "====> RTMPSendPacket\n");

240 
pSrcBufVA
 = (
PVOID
)
pSkb
->
d©a
;

243 i‡(
pSrcBufVA
 =
NULL
)

247  
NDIS_STATUS_FAILURE
;

253 i‡((*((
PUCHAR
Ë
pSrcBufVA
) & 0x01) != 0)

256 
NumbîOfFøg
 = 1;

261 
AŒowFøgSize
 = (
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
Ë- 
LENGTH_802_11
 - 
LENGTH_CRC
;

264 
NumbîOfFøg
 = ((
pSkb
->
Àn
 - 
LENGTH_802_3
 + 
LENGTH_802_1_H
Ë/ 
AŒowFøgSize
) + 1;

266 i‡(((
pSkb
->
Àn
 - 
LENGTH_802_3
 + 
LENGTH_802_1_H
Ë% 
AŒowFøgSize
) == 0)

268 
NumbîOfFøg
--;

273 
	`RTMP_SET_PACKET_FRAGMENTS
(
pSkb
, 
NumbîOfFøg
);

280 i‡(
NumbîOfFøg
 > 1)

281 
RTSRequúed
 = (
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
 >ÖAd->P‹tCfg.
RtsThªshﬁd
) ? 1 : 0;

283 
RTSRequúed
 = (
pSkb
->
Àn
 > 
pAd
->
P‹tCfg
.
RtsThªshﬁd
) ? 1 : 0;

296 
	`RTMP_SET_PACKET_RTS
(
pSkb
, 
RTSRequúed
);

297 
	`RTMP_SET_PACKET_TXRATE
(
pSkb
, 
pAd
->
P‹tCfg
.
TxR©e
);

303 
U£rPri‹ôy
 = 0;

304 
QueIdx
 = 
QID_AC_BE
;

305 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_WMM_INUSED
))

307 
USHORT
 
PrŸocﬁ
;

308 
UCHAR
 
LlcS«pLí
 = 0, 
Byã0
, 
Byã1
;

312 
PrŸocﬁ
 = (
USHORT
)((
pSrcBufVA
[12] << 8) +ÖSrcBufVA[13]);

313 i‡(
PrŸocﬁ
 <= 1500)

316 i‡(
	`Sniff2ByãsFromNdisBuf„r
(
pSkb
, 
LENGTH_802_3
 + 6, &
Byã0
, &
Byã1
Ë!
NDIS_STATUS_SUCCESS
)

319 
PrŸocﬁ
 = (
USHORT
)((
Byã0
 << 8Ë+ 
Byã1
);

320 
LlcS«pLí
 = 8;

324 i‡(
PrŸocﬁ
 != 0x0800)

328 i‡(
	`Sniff2ByãsFromNdisBuf„r
(
pSkb
, 
LENGTH_802_3
 + 
LlcS«pLí
, &
Byã0
, &
Byã1
Ë!
NDIS_STATUS_SUCCESS
)

332 i‡((
Byã0
 & 0xf0) != 0x40)

335 
U£rPri‹ôy
 = (
Byã1
 & 0xe0) >> 5;

336 
QueIdx
 = 
M≠U£rPri‹ôyToAc˚ssC©eg‹y
[
U£rPri‹ôy
];

340 i‡(
pAd
->
P‹tCfg
.
APEdˇP¨m
.
bACM
[
QueIdx
])

342 
U£rPri‹ôy
 = 0;

343 
QueIdx
 = 
QID_AC_BE
;

345 } 
FALSE
);

348 
	`RTMP_SET_PACKET_UP
(
pSkb
, 
U£rPri‹ôy
);

351 
	`NdisAcquúeSpöLock
(&
pAd
->
SídTxWaôQueueLock
[
QueIdx
], 
IrqFœgs
);

353 
pTxQueue
 = &
pAd
->
SídTxWaôQueue
[
QueIdx
];

354 i‡(
pTxQueue
->
Numbî
 > 
pAd
->
MaxTxQueueSize
)

356 #ifde‡
BLOCK_NET_IF


357 
	`St›NëIfQueue
(
pAd
, 
QueIdx
, 
pSkb
);

359 
	`NdisRñó£SpöLock
(&
pAd
->
SídTxWaôQueueLock
[
QueIdx
], 
IrqFœgs
);

360  
NDIS_STATUS_FAILURE
;

367 i‡(
	`INFRA_ON
(
pAd
) )

370 
	`DBGPRINT
(
RT_DEBUG_INFO
, "Infrastructure -> Enqueue one frame\n");

373 
	`In£πTaûQueue
(
pTxQueue
, 
pSkb
);

374 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

375 #ifde‡
DBG


376 
pAd
->
RÆökCou¡îs
.
O√SecOsTxCou¡
[
QueIdx
]++;

382 
PsMode
 = 
PWR_ACTIVE
;

383 i‡(
PsMode
 =
PWR_ACTIVE
)

385 
	`DBGPRINT
(
RT_DEBUG_INFO
,"Ad-Hoc -> Enqueue one frame\n");

388 
	`In£πTaûQueue
(
pTxQueue
, 
pSkb
);

389 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

390 #ifde‡
DBG


391 
pAd
->
RÆökCou¡îs
.
O√SecOsTxCou¡
[
QueIdx
]++;

396 
	`NdisRñó£SpöLock
(&
pAd
->
SídTxWaôQueueLock
[
QueIdx
], 
IrqFœgs
);

397 
	`DBGPRINT
(
RT_DEBUG_INFO
, "<==== RTMPSendPacket\n");

398  (
Sètus
);

399 
	}
}

417 
INT
 
	$RTMPSídPackës
(

418 
IN
 
sk_buff
 *
pSkb
,

419 
IN
 
√t_devi˚
 *
√t_dev
)

421 
PRTMP_ADAPTER
 
pAd
 = 
	`RTMP_OS_NETDEV_GET_PRIV
(
√t_dev
);

422 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

423 
INT
 
Index
;

425 
	`DBGPRINT
(
RT_DEBUG_INFO
, "===> RTMPSendPackets\n");

427 #ifde‡
RALINK_ATE


428 i‡(
pAd
->
©e
.
Mode
 !
ATE_STASTART
)

430 
	`RTUSBFªeSkbBuf„r
(
pSkb
);

435 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
) ||

436 
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
))

439 
	`RTUSBFªeSkbBuf„r
(
pSkb
);

443 i‡(!
	`INFRA_ON
(
pAd
Ë&& !
	`ADHOC_ON
(pAd) )

445 
	`RTUSBFªeSkbBuf„r
(
pSkb
);

452 
	`RTMP_SET_PACKET_SOURCE
(
pSkb
, 
PKTSRC_NDIS
);

453 
pAd
->
RÆökCou¡îs
.
PídögNdisPackëCou¡
 ++;

455 
Sètus
 = 
	`RTMPSídPackë
(
pAd
, 
pSkb
);

456 i‡(
Sètus
 !
NDIS_STATUS_SUCCESS
)

459 
	`RELEASE_NDIS_PACKET
(
pAd
, 
pSkb
);

460 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"<---RTUSBSendPacketsÇot dequeue\n");

469 i‡((!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
)) &&

470 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
)) &&

471 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)) &&

472 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)))

474 
Index
 = 0; Index < 4; Index++)

476 if(
pAd
->
SídTxWaôQueue
[
Index
].
Numbî
 > 0)

478 
	`RTMPDeQueuePackë
(
pAd
, 
Index
);

484 
	`RTUSBKickBulkOut
(
pAd
);

486 
	`DBGPRINT
(
RT_DEBUG_INFO
, "<=== RTMPSendPackets\n");

489 
	}
}

511 #ifde‡
BIG_ENDIAN


512 
	gölöe


514 
NDIS_STATUS
 
	$RTUSBH¨dTønsmô
(

515 
IN
 
PRTMP_ADAPTER
 
pAd
,

516 
IN
 
sk_buff
 *
pSkb
,

517 
IN
 
UCHAR
 
NumbîRequúed
,

518 
IN
 
UCHAR
 
QueIdx
)

520 
UINT
 
LígthQosPAD
 =0;

521 
UINT
 
ByãsC›õd
;

522 
UINT
 
TxSize
;

523 
UINT
 
FªeMpduSize
;

524 
UINT
 
SrcRemaöögByãs
;

525 
USHORT
 
PrŸocﬁ
;

526 
UCHAR
 
FømeG≠
;

527 
HEADER_802_11
 
Hódî_802_11
;

528 
PHEADER_802_11
 
pHódî80211
;

529 
PUCHAR
 
pDe°
;

531 
PTX_CONTEXT
 
pTxC⁄ãxt
;

532 
PTXD_STRUC
 
pTxD
;

533 #ifde‡
BIG_ENDIAN


534 
PTXD_STRUC
 
pDe°TxD
;

535 
TXD_STRUC
 
TxD
;

538 
BOOLEAN
 
SèπOfFøme
;

539 
BOOLEAN
 
bEAPOLFøme
;

540 
ULONG
 
Iv16
;

541 
ULONG
 
Iv32
;

542 
BOOLEAN
 
MICFøg
;

544 
NDIS_802_11_WEP_STATUS
 
En¸y±Ty≥
 = 
Ndis802_11En¸y±i⁄DißbÀd
;

545 
ULONG
 
Tøns„rBuf„rLígth
;

546 
USHORT
 
AckDuøti⁄
 = 0;

547 
USHORT
 
En¸y±i⁄Ovîhód
 = 0;

548 
UCHAR
 
CùhîAlg
;

549 
BOOLEAN
 
bAckRequúed
;

550 
UCHAR
 
RëryMode
 = 
SHORT_RETRY
;

551 
UCHAR
 
U£rPri‹ôy
;

552 
UCHAR
 
MpduRequúed
, 
RtsRequúed
;

553 
UCHAR
 
TxR©e
;

554 
PCIPHER_KEY
 
pKey
 = 
NULL
 ;

555 
PUCHAR
 
pSrcBufVA
 = 
NULL
;

556 
ULONG
 
SrcBufLí
;

557 
PUCHAR
 
pExåaLlcS«pEnˇp
 = 
NULL
;

558 
UCHAR
 
KeyIdx
, 
KeyLígth
 = 0;

559 
UCHAR
 
KeyTabÀ
 = 
SHARED_KEY_TABLE
;

560 
PUCHAR
 
pWúñessPackë
;

561 
ULONG
 
NextMpduSize
;

562 
BOOLEAN
 
bRTS_CTSFøme
 = 
FALSE
;

563 
IrqFœgs
;

565 
	`DBGPRINT
(
RT_DEBUG_INFO
, "====> RTUSBHardTransmit\n");

567 i‡((
pAd
->
P‹tCfg
.
bIEEE80211H
 =1Ë&& (pAd->P‹tCfg.
Rad¨Dëe˘
.
RDMode
 !
RD_NORMAL_MODE
))

569 
	`DBGPRINT
(
RT_DEBUG_INFO
,"RTUSBHardTransmit -->Ñadar detectÇot inÇormal mode !!!\n");

570  (
NDIS_STATUS_FAILURE
);

573 
TxR©e
 = 
	`RTMP_GET_PACKET_TXRATE
(
pSkb
);

574 
MpduRequúed
 = 
	`RTMP_GET_PACKET_FRAGMENTS
(
pSkb
);

575 
RtsRequúed
 = 
	`RTMP_GET_PACKET_RTS
(
pSkb
);

576 
U£rPri‹ôy
 = 
	`RTMP_GET_PACKET_UP
(
pSkb
);

582 
pSrcBufVA
 = (
PVOID
)
pSkb
->
d©a
;

583 
SrcBufLí
 = 
pSkb
->
Àn
;

586 i‡(
pSrcBufVA
 =
NULL
)

588 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "pSrcBufVA == NULL\n");

589 (
NDIS_STATUS_RESOURCES
);

591 i‡(
SrcBufLí
 < 14)

593 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "RTUSBHardTransmit --> Skb bufferÉrror !!!\n");

594  (
NDIS_STATUS_FAILURE
);

600 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 <= 14)

606 i‡((
TxR©e
 !
RATE_1
Ë&& 
	`RTMPCheckDHCPFøme
(
pAd
, 
pSkb
))

607 
TxR©e
 = 
RATE_1
;

616 i‡((
TxR©e
 !
RATE_6
Ë&& 
	`RTMPCheckDHCPFøme
(
pAd
, 
pSkb
))

617 
TxR©e
 = 
RATE_6
;

624 i‡(
	`NdisEquÆMem‹y
(
EAPOL
, 
pSrcBufVA
 + 12, 2))

626 
bEAPOLFøme
 = 
TRUE
;

627 i‡(
pAd
->
P‹tCfg
.
MicEºC¡
 >= 2)

628 
pAd
->
P‹tCfg
.
MicEºC¡
++;

631 
bEAPOLFøme
 = 
FALSE
;

637 i‡(((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA
) ||

638 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAPSK
) ||

639 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2
) ||

640 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2PSK
)

641 #i‡
	`deföed
(
RALINK_WPA_SUPPLICANT_SUPPORT
Ë|| deföed(
NATIVE_WPA_SUPPLICANT_SUPPORT
)

642 || (
pAd
->
P‹tCfg
.
IEEE8021X
 =
TRUE
)

645 ((
pAd
->
P‹tCfg
.
P‹tSecuªd
 =
WPA_802_1X_PORT_NOT_SECURED
Ë|| (pAd->P‹tCfg.
MicEºC¡
 >= 2)) &&

646 (
bEAPOLFøme
 =
FALSE
))

648 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "RTUSBHardTransmit --> DropÖacket beforeÖort secured !!!\n");

649  (
NDIS_STATUS_FAILURE
);

655 i‡(*
pSrcBufVA
 & 0x01)

657 
bAckRequúed
 = 
FALSE
;

658 
	`INC_COUNTER64
(
pAd
->
WœnCou¡îs
.
Mu…iˇ°TønsmôãdFømeCou¡
);

659 
En¸y±Ty≥
 = 
pAd
->
P‹tCfg
.
GroupCùhî
;

663 
bAckRequúed
 = 
TRUE
;

664 
En¸y±Ty≥
 = 
pAd
->
P‹tCfg
.
PaúCùhî
;

668 i‡(
pAd
->
P‹tCfg
.
bE«bÀTxBur°
 && (pAd->
Sequí˚
 & 0x7))

669 
FømeG≠
 = 
IFS_SIFS
;

671 i‡(
pAd
->
P‹tCfg
.
APEdˇP¨m
.
bVÆid
 &&ÖAd->P‹tCfg.APEdˇP¨m.
Tx›
[
QueIdx
])

672 
FømeG≠
 = 
IFS_SIFS
;

675 
FømeG≠
 = 
IFS_BACKOFF
;

677 
PrŸocﬁ
 = *(
pSrcBufVA
 + 12) * 256 + *(pSrcBufVA + 13);

680 i‡(
PrŸocﬁ
 > 1500)

682 
pExåaLlcS«pEnˇp
 = 
SNAP_802_1H
;

683 i‡(
	`NdisEquÆMem‹y
(
IPX
, 
pSrcBufVA
 + 12, 2) ||

684 
	`NdisEquÆMem‹y
(
APPLE_TALK
, 
pSrcBufVA
 + 12, 2))

686 
pExåaLlcS«pEnˇp
 = 
SNAP_BRIDGE_TUNNEL
;

690 
pExåaLlcS«pEnˇp
 = 
NULL
;

694 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_DOZE
);

695 
pAd
->
P‹tCfg
.
Psm
 = 
PWR_ACTIVE
;

701 
pAd
->
Sequí˚
 = (’Ad->Sequí˚Ë+ 1Ë& (
MAX_SEQ_NUMBER
);

702 
	`MAKE_802_11_HEADER
(
pAd
, 
Hódî_802_11
, 
pSrcBufVA
,ÖAd->
Sequí˚
);

714 
KeyIdx
 = 0xff;

715 
KeyTabÀ
 = 
SHARED_KEY_TABLE
;

717 i‡(
bEAPOLFøme
)

719 
	`ASSERT
(
pAd
->
Sh¨edKey
[0].
CùhîAlg
 <
CIPHER_CKIP128
);

720 i‡((
pAd
->
Sh¨edKey
[0].
CùhîAlg
) &&

721 (
pAd
->
Sh¨edKey
[0].
KeyLí
) &&

722 ((
pAd
->
P‹tCfg
.
P‹tSecuªd
 =
WPA_802_1X_PORT_PASS_4_WAY
) ||

723 (
pAd
->
P‹tCfg
.
P‹tSecuªd
 =
WPA_802_1X_PORT_SECURED
)))

725 
CùhîAlg
 = 
pAd
->
Sh¨edKey
[0].CipherAlg;

726 
KeyIdx
 = 0;

727 
KeyLígth
 = 
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
;

730 i‡(
En¸y±Ty≥
 =
Ndis802_11En¸y±i⁄1E«bÀd
)

733 
KeyIdx
 = 
pAd
->
P‹tCfg
.
DeÁu…KeyId
;

734 
KeyLígth
 = 
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
;

736 i‡((
En¸y±Ty≥
 =
Ndis802_11En¸y±i⁄2E«bÀd
) ||

737 (
En¸y±Ty≥
 =
Ndis802_11En¸y±i⁄3E«bÀd
))

739 i‡(
Hódî_802_11
.
Addr1
[0] & 0x01)

740 
KeyIdx
 = 
pAd
->
P‹tCfg
.
DeÁu…KeyId
;

741 i‡(
pAd
->
Sh¨edKey
[0].
KeyLí
)

742 
KeyIdx
 = 0;

744 
KeyIdx
 = 
pAd
->
P‹tCfg
.
DeÁu…KeyId
;

746 
KeyLígth
 = 
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
;

749 i‡(
KeyIdx
 == 0xff)

750 
CùhîAlg
 = 
CIPHER_NONE
;

751 i‡((
En¸y±Ty≥
 =
Ndis802_11En¸y±i⁄DißbÀd
Ë|| (
KeyLígth
 == 0))

752 
CùhîAlg
 = 
CIPHER_NONE
;

755 
Hódî_802_11
.
FC
.
Wï
 = 1;

757 
CùhîAlg
 = 
pAd
->
Sh¨edKey
[
KeyIdx
].CipherAlg;

758 
pKey
 = &
pAd
->
Sh¨edKey
[
KeyIdx
];

763 
	`DBGPRINT
(
RT_DEBUG_INFO
,"RTUSBHardTransmit(bEAP=%d) - %s key#%d, KeyLen=%d\n",

764 
bEAPOLFøme
, 
CùhîName
[
CùhîAlg
], 
KeyIdx
, 
pAd
->
Sh¨edKey
[KeyIdx].
KeyLí
);

771 i‡((
MpduRequúed
 > 1Ë&& (
CùhîAlg
 =
CIPHER_TKIP
))

773 
pSkb
->
Àn
 += 8;

774 
CùhîAlg
 = 
CIPHER_TKIP_NO_MIC
;

785 i‡((
CùhîAlg
 =
CIPHER_WEP64
Ë|| (CùhîAlg =
CIPHER_WEP128
))

786 
En¸y±i⁄Ovîhód
 = 8;

787 i‡(
CùhîAlg
 =
CIPHER_TKIP_NO_MIC
)

788 
En¸y±i⁄Ovîhód
 = 12;

789 i‡(
CùhîAlg
 =
CIPHER_TKIP
)

790 
En¸y±i⁄Ovîhód
 = 20;

791 i‡(
CùhîAlg
 =
CIPHER_AES
)

792 
En¸y±i⁄Ovîhód
 = 16;

794 
En¸y±i⁄Ovîhód
 = 0;

797 
AckDuøti⁄
 = 
	`RTMPCÆcDuøti⁄
(
pAd
,ÖAd->
P‹tCfg
.
Ex≥˘edACKR©e
[
TxR©e
], 14);

801 i‡(
MpduRequúed
 > 1)

802 
NextMpduSize
 = 
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
;

805 
NextMpduSize
 = 
pSkb
->
Àn
 + 
LENGTH_802_11
 + 
LENGTH_CRC
 - 
LENGTH_802_3
;

806 i‡(
pExåaLlcS«pEnˇp
)

807 
NextMpduSize
 +
LENGTH_802_1_H
;

810 i‡(
RtsRequúed
 || 
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_RTS_PROTECTION_ENABLE
))

812 
	`RTMPSídRTSCTSFøme
(
pAd
,

813 
Hódî_802_11
.
Addr1
,

814 
NextMpduSize
 + 
En¸y±i⁄Ovîhód
,

815 
TxR©e
,

816 
pAd
->
P‹tCfg
.
RtsR©e
,

817 
AckDuøti⁄
,

818 
QueIdx
,

819 
FømeG≠
,

820 
SUBTYPE_RTS
);

823 
RëryMode
 = 
LONG_RETRY
;

824 
FømeG≠
 = 
IFS_SIFS
;

825 
bRTS_CTSFøme
 = 
TRUE
;

827 i‡(
RtsRequúed
)

828 
NumbîRequúed
--;

830 i‡((
pAd
->
P‹tCfg
.
TxR©e
 >
RATE_FIRST_OFDM_RATE
Ë&& 
	`OPSTATUS_TEST_FLAG
’Ad, 
fOP_STATUS_BG_PROTECTION_INUSED
))

832 
	`RTMPSídRTSCTSFøme
(
pAd
,

833 
Hódî_802_11
.
Addr1
,

834 
NextMpduSize
 + 
En¸y±i⁄Ovîhód
,

835 
TxR©e
,

836 
pAd
->
P‹tCfg
.
RtsR©e
,

837 
AckDuøti⁄
,

838 
QueIdx
,

839 
FømeG≠
,

840 
SUBTYPE_CTS
);

843 
RëryMode
 = 
LONG_RETRY
;

844 
FømeG≠
 = 
IFS_SIFS
;

845 
bRTS_CTSFøme
 = 
TRUE
;

855 
SrcRemaöögByãs
 = 
pSkb
->
Àn
 - 
LENGTH_802_3
;

856 
SrcBufLí
 -
LENGTH_802_3
;

858 
SèπOfFøme
 = 
TRUE
;

859 
MICFøg
 = 
FALSE
;

861 
	`NdisAcquúeSpöLock
(&
pAd
->
TxRögLock
, 
IrqFœgs
);

871 
pTxC⁄ãxt
 = &
pAd
->
TxC⁄ãxt
[
QueIdx
][pAd->
NextTxIndex
[QueIdx]];

873 i‡((
pTxC⁄ãxt
->
bWaôögBulkOut
 =
TRUE
Ë|| (pTxC⁄ãxt->
InU£
 == TRUE) ||

874 (
pAd
->
TxRögTŸÆNumbî
[
QueIdx
] >
TX_RING_SIZE
))

876 
	`DBGPRINT_ERR
("RTUSBHardTransmit: TX RING full\n");

877 
pAd
->
RÆökCou¡îs
.
TxRögEºCou¡
++;

878 
	`NdisRñó£SpöLock
(&
pAd
->
TxRögLock
, 
IrqFœgs
);

879  (
NDIS_STATUS_RESOURCES
);

881 
pTxC⁄ãxt
->
InU£
 = 
TRUE
;

884 
pAd
->
NextTxIndex
[
QueIdx
]++;

885 i‡(
pAd
->
NextTxIndex
[
QueIdx
] >
TX_RING_SIZE
)

887 
pAd
->
NextTxIndex
[
QueIdx
] = 0;

890 #i‚de‡
BIG_ENDIAN


891 
pTxD
 = (
PTXD_STRUC
Ë&
pTxC⁄ãxt
->
Tøns„rBuf„r
->
TxDesc
;

893 
pDe°TxD
 = (
PTXD_STRUC
Ë&
pTxC⁄ãxt
->
Tøns„rBuf„r
->
TxDesc
;

894 
TxD
 = *
pDe°TxD
;

895 
pTxD
 = &
TxD
;

896 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pTxD
, 
TYPE_TXD
);

898 
	`NdisZîoMem‹y
(
pTxD
, (
TXD_STRUC
));

899 
pWúñessPackë
 = 
pTxC⁄ãxt
->
Tøns„rBuf„r
->
u
.
WúñessPackë
;

905 
pTxD
->
IvOff£t
 = 
LENGTH_802_11
;

908 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_WMM_INUSED
))

909 
pTxD
->
IvOff£t
 += 2;

912 i‡((
CùhîAlg
 =
CIPHER_WEP64
Ë|| (CùhîAlg =
CIPHER_WEP128
))

914 
PUCHAR
 
pTmp
;

915 
pTmp
 = (
PUCHAR
Ë&
pTxD
->
Iv
;

916 *
pTmp
 = 
	`R™domByã
(
pAd
);

917 *(
pTmp
 + 1Ë
	`R™domByã
(
pAd
);

918 *(
pTmp
 + 2Ë
	`R™domByã
(
pAd
);

919 *(
pTmp
 + 3Ë(
KeyIdx
 << 6);

921 i‡((
CùhîAlg
 =
CIPHER_TKIP
Ë|| (CùhîAlg =
CIPHER_TKIP_NO_MIC
))

923 
UCHAR
 
kidx
;

925 
kidx
 = 
KeyIdx
;

927 
	`RTMPInôTkùEngöe
(

928 
pAd
,

929 
pKey
->
Key
,

930 
kidx
,

931 
Hódî_802_11
.
Addr2
,

932 
pKey
->
TxMic
,

933 
pKey
->
TxTsc
,

934 &
Iv16
,

935 &
Iv32
);

937 
	`NdisMoveMem‹y
(&
pTxD
->
Iv
, &
Iv16
, 4);

938 
	`NdisMoveMem‹y
(&
pTxD
->
Eiv
, &
Iv32
, 4);

939 
	`INC_TX_TSC
(
pKey
->
TxTsc
);

941 i‡(
CùhîAlg
 =
CIPHER_AES
)

943 
PUCHAR
 
pTmp
;

944 
UCHAR
 
kidx
;

946 
kidx
 = 
KeyIdx
;

948 
pTmp
 = (
PUCHAR
Ë&
Iv16
;

949 *
pTmp
 = 
pKey
->
TxTsc
[0];

950 *(
pTmp
 + 1Ë
pKey
->
TxTsc
[1];

951 *(
pTmp
 + 2) = 0;

952 *(
pTmp
 + 3Ë–
kidx
 << 6) | 0x20;

953 
Iv32
 = *(
PULONG
)(&
pKey
->
TxTsc
[2]);

955 
	`NdisMoveMem‹y
(&
pTxD
->
Iv
, &
Iv16
, 4);

956 
	`NdisMoveMem‹y
(&
pTxD
->
Eiv
, &
Iv32
, 4);

957 
	`INC_TX_TSC
(
pKey
->
TxTsc
);

968 
pDe°
 = 
pWúñessPackë
;

969 
	`NdisMoveMem‹y
(
pDe°
, &
Hódî_802_11
, (Header_802_11));

970 
pDe°
 +(
Hódî_802_11
);

980 i‡((
Hódî_802_11
.
Addr1
[0] & 0x01Ë|| 
MpduRequúed
 == 1)

982 
FªeMpduSize
 = 
MAX_FRAG_THRESHOLD
 - (
Hódî_802_11
Ë- 
LENGTH_CRC
;

986 
FªeMpduSize
 = 
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
 - (
Hódî_802_11
Ë- 
LENGTH_CRC
;

994 i‡(
Hódî_802_11
.
Føg
 == 0)

996 i‡(
pExåaLlcS«pEnˇp
)

998 i‡((
CùhîAlg
 =
CIPHER_TKIP_NO_MIC
Ë&& (
pKey
 !
NULL
))

1001 
	`RTMPCÆcuœãMICVÆue
(
pAd
, 
pSkb
, 
pExåaLlcS«pEnˇp
, 
pKey
);

1005 
	`NdisMoveMem‹y
(
pDe°
, 
pExåaLlcS«pEnˇp
, 6);

1006 
pDe°
 += 6;

1007 
	`NdisMoveMem‹y
(
pDe°
, 
pSrcBufVA
 + 12, 2);

1008 
pDe°
 += 2;

1009 
pSrcBufVA
 +
LENGTH_802_3
;

1010 
FªeMpduSize
 -
LENGTH_802_1_H
;

1015 i‡((
CùhîAlg
 =
CIPHER_TKIP_NO_MIC
Ë&& (
pKey
 !
NULL
))

1018 
	`RTMPCÆcuœãMICVÆue
(
pAd
, 
pSkb
, 
pExåaLlcS«pEnˇp
, 
pKey
);

1020 
pSrcBufVA
 +
LENGTH_802_3
;

1026 
ByãsC›õd
 = 0;

1029 i‡(
SrcBufLí
 >
FªeMpduSize
)

1033 
	`NdisMoveMem‹y
(
pDe°
, 
pSrcBufVA
, 
FªeMpduSize
);

1034 
ByãsC›õd
 +
FªeMpduSize
;

1035 
pSrcBufVA
 +
FªeMpduSize
;

1036 
pDe°
 +
FªeMpduSize
;

1037 
SrcBufLí
 -
FªeMpduSize
;

1044 
	`NdisMoveMem‹y
(
pDe°
, 
pSrcBufVA
, 
SrcBufLí
);

1045 
ByãsC›õd
 +
SrcBufLí
;

1046 
pDe°
 +
SrcBufLí
;

1047 
FªeMpduSize
 -
SrcBufLí
;

1057 if((
CùhîAlg
 =
CIPHER_TKIP_NO_MIC
) &&

1058 (
MICFøg
 =
FALSE
) &&

1059 (
pKey
 !
NULL
))

1062 
INT
 
i
;

1064 
SrcBufLí
 = 8;

1065 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "Calculated TX MIC value =");

1066 
i
 = 0; i < 8; i++)

1068 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "%02x:", 
pAd
->
Priv©eInfo
.
Tx
.
MIC
[
i
]);

1070 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "\n");

1072 i‡(
FªeMpduSize
 >
SrcBufLí
)

1074 
	`NdisMoveMem‹y
(
pDe°
, 
pAd
->
Priv©eInfo
.
Tx
.
MIC
, 
SrcBufLí
);

1075 
ByãsC›õd
 +
SrcBufLí
;

1076 
pDe°
 +
SrcBufLí
;

1077 
FªeMpduSize
 -
SrcBufLí
;

1078 
SrcBufLí
 = 0;

1082 
	`NdisMoveMem‹y
(
pDe°
, 
pAd
->
Priv©eInfo
.
Tx
.
MIC
, 
FªeMpduSize
);

1083 
ByãsC›õd
 +
FªeMpduSize
;

1084 
pSrcBufVA
 = 
pAd
->
Priv©eInfo
.
Tx
.
MIC
 + 
FªeMpduSize
;

1085 
pDe°
 +
FªeMpduSize
;

1086 
SrcBufLí
 -
FªeMpduSize
;

1087 
MICFøg
 = 
TRUE
;

1090 } 
FALSE
);

1093 i‡((
SèπOfFøme
 =
TRUE
Ë&& (
pExåaLlcS«pEnˇp
 !
NULL
))

1095 
TxSize
 = 
ByãsC›õd
 + 
LENGTH_802_11
 + 
LENGTH_802_1_H
 + 
LígthQosPAD
;

1099 
TxSize
 = 
ByãsC›õd
 + 
LENGTH_802_11
 + 
LígthQosPAD
;

1102 
SrcRemaöögByãs
 -
ByãsC›õd
;

1108 
pHódî80211
 = (
PHEADER_802_11
)
pWúñessPackë
;

1109 i‡(
SrcRemaöögByãs
 > 0)

1111 
ULONG
 
NextMpduSize
;

1113 
pHódî80211
->
FC
.
M‹eFøg
 = 1;

1114 
NextMpduSize
 = 
	`mö
((
ULONG
)
SrcRemaöögByãs
, (ULONG)
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
);

1116 i‡(
NextMpduSize
 < 
pAd
->
P‹tCfg
.
FøgmítThªshﬁd
)

1119 
pHódî80211
->
Duøti⁄
 = (3 * 
pAd
->
P‹tCfg
.
Dsifs
) +

1120 (2 * 
AckDuøti⁄
) +

1121 
	`RTMPCÆcDuøti⁄
(
pAd
, 
TxR©e
, 
NextMpduSize
 + 
En¸y±i⁄Ovîhód
 + 
LENGTH_802_11
 + 
LENGTH_CRC
);

1125 
pHódî80211
->
Duøti⁄
 = (3 * 
pAd
->
P‹tCfg
.
Dsifs
) +

1126 (2 * 
AckDuøti⁄
) +

1127 
	`RTMPCÆcDuøti⁄
(
pAd
, 
TxR©e
, 
NextMpduSize
 + 
En¸y±i⁄Ovîhód
);

1130 #ifde‡
BIG_ENDIAN


1131 
	`RTMPFømeEndünCh™ge
(
pAd
, (
PUCHAR
)
pHódî80211
, 
DIR_WRITE
, 
FALSE
);

1132 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pTxD
, 
TYPE_TXD
);

1133 *
pDe°TxD
 = 
TxD
;

1134 
pTxD
 = 
pDe°TxD
;

1136 
	`RTUSBWrôeTxDes¸ùt‹
(
pAd
, 
pTxD
, 
CùhîAlg
, 
KeyTabÀ
 , 
KeyIdx
, 
bAckRequúed
, 
TRUE
, 
FALSE
,

1137 
RëryMode
, 
FømeG≠
, 
TxR©e
, 
TxSize
, 
QueIdx
, 0, 
bRTS_CTSFøme
);

1139 
FømeG≠
 = 
IFS_SIFS
;

1140 
Hódî_802_11
.
Føg
 ++;

1144 
pHódî80211
->
FC
.
M‹eFøg
 = 0;

1145 i‡(
pHódî80211
->
Addr1
[0] & 0x01)

1146 
pHódî80211
->
Duøti⁄
 = 0;

1148 
pHódî80211
->
Duøti⁄
 = 
pAd
->
P‹tCfg
.
Dsifs
 + 
AckDuøti⁄
;

1150 i‡((
bEAPOLFøme
Ë&& (
TxR©e
 > 
RATE_6
))

1151 
TxR©e
 = 
RATE_6
;

1153 #ifde‡
BIG_ENDIAN


1154 
	`RTMPFømeEndünCh™ge
(
pAd
, (
PUCHAR
)
pHódî80211
, 
DIR_WRITE
, 
FALSE
);

1155 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pTxD
, 
TYPE_TXD
);

1156 *
pDe°TxD
 = 
TxD
;

1157 
pTxD
 = 
pDe°TxD
;

1159 
	`RTUSBWrôeTxDes¸ùt‹
(
pAd
, 
pTxD
, 
CùhîAlg
, 
KeyTabÀ
 , 
KeyIdx
, 
bAckRequúed
, 
FALSE
, FALSE,

1160 
RëryMode
, 
FømeG≠
, 
TxR©e
, 
TxSize
, 
QueIdx
, 0, 
bRTS_CTSFøme
);

1162 i‡(
pAd
->
SídTxWaôQueue
[
QueIdx
].
Numbî
 > 1)

1163 
pTxD
->
Bur°
 = 1;

1167 
Tøns„rBuf„rLígth
 = 
TxSize
 + (
TXD_STRUC
);

1169 i‡((
Tøns„rBuf„rLígth
 % 4) == 1)

1170 
Tøns„rBuf„rLígth
 += 3;

1171 i‡((
Tøns„rBuf„rLígth
 % 4) == 2)

1172 
Tøns„rBuf„rLígth
 += 2;

1173 i‡((
Tøns„rBuf„rLígth
 % 4) == 3)

1174 
Tøns„rBuf„rLígth
 += 1;

1177 i‡((
Tøns„rBuf„rLígth
 % 
pAd
->
BulkOutMaxPackëSize
) == 0)

1178 
Tøns„rBuf„rLígth
 += 4;

1180 
pTxC⁄ãxt
->
BulkOutSize
 = 
Tøns„rBuf„rLígth
;

1181 
pTxC⁄ãxt
->
bWaôögBulkOut
 = 
TRUE
;

1182 
	`RTUSB_SET_BULK_FLAG
(
pAd
, (
fRTUSB_BULK_OUT_DATA_NORMAL
 << 
QueIdx
));

1186 
SèπOfFøme
 = 
FALSE
;

1187 
NumbîRequúed
--;

1188 i‡(
NumbîRequúed
 == 0)

1190 
pTxC⁄ãxt
->
La°O√
 = 
TRUE
;

1194 
pTxC⁄ãxt
->
La°O√
 = 
FALSE
;

1197 
pAd
->
TxRögTŸÆNumbî
[
QueIdx
]++;

1198 
	`©omic_öc
(&
pAd
->
TxCou¡
);

1200 } 
NumbîRequúed
 > 0);

1202 
	`NdisRñó£SpöLock
(&
pAd
->
TxRögLock
, 
IrqFœgs
);

1210 i‡(
pAd
->
P‹tCfg
.
MicEºC¡
 >= 3)

1212 
MLME_DISASSOC_REQ_STRUCT
 
DißssocReq
;

1215 
	`¥ötk
("<0>MLME - disassociate with current APáfter sending second continuous EAPOL frame\n");

1216 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MLME - disassociate with current APáfter sending second continuous EAPOL frame\n");

1217 
	`DißssocP¨mFûl
(
pAd
, &
DißssocReq
,ÖAd->
P‹tCfg
.
Bssid
, 
REASON_MIC_FAILURE
);

1218 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_MLME_DISASSOC_REQ
,

1219 (
MLME_DISASSOC_REQ_STRUCT
), &
DißssocReq
);

1221 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_DISASSOC
;

1222 
pAd
->
P‹tCfg
.
bBlockAssoc
 = 
TRUE
;

1223 
	`¥ötk
("<0>bBlockAsso¯%d\n", 
pAd
->
P‹tCfg
.
bBlockAssoc
);

1228 
	`RELEASE_NDIS_PACKET
(
pAd
, 
pSkb
);

1229 
	`DBGPRINT
(
RT_DEBUG_INFO
, "<==== RTUSBHardTransmit\n");

1230  (
NDIS_STATUS_SUCCESS
);

1231 
	}
}

1254 
VOID
 
	$RTUSBMlmeH¨dTønsmô
(

1255 
IN
 
PRTMP_ADAPTER
 
pAd
,

1256 
IN
 
PMGMT_STRUC
 
pMgmt
)

1258 
PTX_CONTEXT
 
pMLMEC⁄ãxt
;

1259 
PTXD_STRUC
 
pTxD
;

1260 #ifde‡
BIG_ENDIAN


1261 
PTXD_STRUC
 
pDe°TxD
;

1262 
TXD_STRUC
 
TxD
;

1264 
PUCHAR
 
pDe°
;

1265 
PHEADER_802_11
 
pHódî_802_11
;

1266 
BOOLEAN
 
AckRequúed
, 
In£πTime°amp
;

1267 
ULONG
 
Tøns„rBuf„rLígth
;

1268 
PVOID
 
pBuf„r
 = 
pMgmt
->pBuffer;

1269 
ULONG
 
Lígth
 = 
pMgmt
->Length;

1270 
UCHAR
 
QueIdx
;

1271 
UCHAR
 
MlmeR©e
;

1273 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->MlmeHardTransmit\n");

1277 
pMLMEC⁄ãxt
 = &
pAd
->
MLMEC⁄ãxt
[pAd->
NextMLMEIndex
];

1278 
pMLMEC⁄ãxt
->
InU£
 = 
TRUE
;

1281 
pAd
->
NextMLMEIndex
++;

1282 i‡(
pAd
->
NextMLMEIndex
 >
PRIO_RING_SIZE
)

1284 
pAd
->
NextMLMEIndex
 = 0;

1287 
pDe°
 = 
pMLMEC⁄ãxt
->
Tøns„rBuf„r
->
u
.
WúñessPackë
;

1289 #i‚de‡
BIG_ENDIAN


1290 
pTxD
 = (
PTXD_STRUC
)(
pMLMEC⁄ãxt
->
Tøns„rBuf„r
);

1292 
pDe°TxD
 = (
PTXD_STRUC
)(
pMLMEC⁄ãxt
->
Tøns„rBuf„r
);

1293 
TxD
 = *
pDe°TxD
;

1294 
pTxD
 = &
TxD
;

1295 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pTxD
, 
TYPE_TXD
);

1297 
	`NdisZîoMem‹y
(
pTxD
, (
TXD_STRUC
));

1299 
pHódî_802_11
 = (
PHEADER_802_11
Ë
pBuf„r
;

1302 i‡(
pHódî_802_11
->
Addr1
[0] & 0x01)

1304 
MlmeR©e
 = 
pAd
->
P‹tCfg
.
BasicMlmeR©e
;

1308 
MlmeR©e
 = 
pAd
->
P‹tCfg
.MlmeRate;

1311 i‡((
pAd
->
L©chRfRegs
.
Ch™√l
 > 14Ë&& (
MlmeR©e
 < 
RATE_6
))

1312 
MlmeR©e
 = 
RATE_6
;

1314 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<---MlmeR©ê%d Ch™√»%d\n",
MlmeR©e
, 
pAd
->
L©chRfRegs
.
Ch™√l
 );

1320 i‡((
pHódî_802_11
->
FC
.
SubTy≥
 !
SUBTYPE_PROBE_REQ
Ë&& (
pAd
->
P‹tCfg
.
bIEEE80211H
 =1Ë&& (pAd->P‹tCfg.
Rad¨Dëe˘
.
RDMode
 !
RD_NORMAL_MODE
))

1322 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "RTUSBMlmeHardTransmit -->Ñadar detectÇot inÇormal mode !!!\n");

1327 i‡(
pHódî_802_11
->
FC
.
PwrMgmt
 !
PWR_SAVE
)

1329 
pHódî_802_11
->
FC
.
PwrMgmt
 = (
pAd
->
P‹tCfg
.
Psm
 =
PWR_SAVE
);

1332 
In£πTime°amp
 = 
FALSE
;

1333 i‡(
pHódî_802_11
->
FC
.
Ty≥
 =
BTYPE_CNTL
)

1335 
AckRequúed
 = 
FALSE
;

1339 
pAd
->
Sequí˚
 = (’Ad->Sequí˚Ë+ 1Ë& (
MAX_SEQ_NUMBER
);

1340 
pHódî_802_11
->
Sequí˚
 = 
pAd
->Sequence;

1342 i‡(
pHódî_802_11
->
Addr1
[0] & 0x01)

1344 
	`INC_COUNTER64
(
pAd
->
WœnCou¡îs
.
Mu…iˇ°TønsmôãdFømeCou¡
);

1345 
AckRequúed
 = 
FALSE
;

1346 
pHódî_802_11
->
Duøti⁄
 = 0;

1350 
AckRequúed
 = 
TRUE
;

1351 
pHódî_802_11
->
Duøti⁄
 = 
	`RTMPCÆcDuøti⁄
(
pAd
, 
MlmeR©e
, 14);

1352 i‡(
pHódî_802_11
->
FC
.
SubTy≥
 =
SUBTYPE_PROBE_RSP
)

1354 
In£πTime°amp
 = 
TRUE
;

1359 #ifde‡
BIG_ENDIAN


1360 
	`RTMPFømeEndünCh™ge
(
pAd
, (
PUCHAR
)
pBuf„r
, 
DIR_WRITE
, 
FALSE
);

1363 
	`NdisMoveMem‹y
(
pDe°
, 
pBuf„r
, 
Lígth
);

1369 
QueIdx
 = 
QID_AC_BE
;

1371 #ifde‡
BIG_ENDIAN


1372 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pTxD
, 
TYPE_TXD
);

1373 *
pDe°TxD
 = 
TxD
;

1374 
pTxD
 = 
pDe°TxD
;

1376 
	`RTUSBWrôeTxDes¸ùt‹
(
pAd
, 
pTxD
, 
CIPHER_NONE
, 0,0, 
AckRequúed
, 
FALSE
, FALSE, 
SHORT_RETRY
,

1377 
IFS_BACKOFF
, 
MlmeR©e
, 
Lígth
, 
QueIdx
, 
PID_MGMT_FRAME
, 
FALSE
);

1381 #ifde‡
DBG


1384 
UINT
 
i
;

1385 
PUCHAR
 
±r
 = (PUCHAR)
pDe°TxD
;

1387 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "pAd->NextMLMEIndex = %d *pDe°TxD :\n", 
pAd
->
NextMLMEIndex
);

1388 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "±∏%d\n",
±r
);

1389 
i
=0;i<64; i+=16)

1391 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x - %02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x\n",

1392 *
±r
,*(ptr+1),*(ptr+2),*(ptr+3),*(ptr+4),*(ptr+5),*(ptr+6),*(ptr+7),

1393 *(
±r
+8),*(ptr+9),*(ptr+10),*(ptr+11),*(ptr+12),*(ptr+13),*(ptr+14),*(ptr+15));

1394 
±r
 += 16;

1404 
Tøns„rBuf„rLígth
 = (
TXD_STRUC
Ë+ 
Lígth
;

1405 i‡((
Tøns„rBuf„rLígth
 % 2) == 1)

1406 
Tøns„rBuf„rLígth
++;

1409 i‡((
Tøns„rBuf„rLígth
 % 
pAd
->
BulkOutMaxPackëSize
) == 0)

1410 
Tøns„rBuf„rLígth
 += 2;

1412 
pMLMEC⁄ãxt
->
BulkOutSize
 = 
Tøns„rBuf„rLígth
;

1413 
pMLMEC⁄ãxt
->
bWaôögBulkOut
 = 
TRUE
;

1414 
	`RTUSB_SET_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_MLME
);

1415 
pAd
->
PrioRögTxC¡
++;

1417 
	}
}

1438 
NDIS_STATUS
 
	$RTUSBFªeDes¸ùt‹Reque°
(

1439 
IN
 
PRTMP_ADAPTER
 
pAd
,

1440 
IN
 
UCHAR
 
RögTy≥
,

1441 
IN
 
UCHAR
 
BulkOutPùeId
,

1442 
IN
 
UCHAR
 
NumbîRequúed
)

1444 
UCHAR
 
FªeNumbî
 = 0;

1445 
UINT
 
Index
;

1446 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_FAILURE
;

1448 
RögTy≥
)

1450 
TX_RING
:

1451 
Index
 = (
pAd
->
NextTxIndex
[
BulkOutPùeId
] + 1Ë% 
TX_RING_SIZE
;

1454 
PTX_CONTEXT
 
pTxD
 = &
pAd
->
TxC⁄ãxt
[
BulkOutPùeId
][
Index
];

1459 i‡(
pTxD
->
InU£
 =
FALSE
)

1462 
FªeNumbî
++;

1468 
Index
 = (Index + 1Ë% 
TX_RING_SIZE
;

1469 } 
FªeNumbî
 < 
NumbîRequúed
);

1471 i‡(
FªeNumbî
 >
NumbîRequúed
)

1473 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

1478 
PRIO_RING
:

1479 
Index
 = 
pAd
->
NextMLMEIndex
;

1482 
PTX_CONTEXT
 
pTxD
 = &
pAd
->
MLMEC⁄ãxt
[
Index
];

1487 i‡(
pTxD
->
InU£
 =
FALSE
)

1490 
FªeNumbî
++;

1497 
Index
 = (Index + 1Ë% 
PRIO_RING_SIZE
;

1498 } 
FªeNumbî
 < 
NumbîRequúed
);

1500 i‡(
FªeNumbî
 >
NumbîRequúed
)

1502 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

1507 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "--->RTUSBFreeDescriptorRequest() -----!! \n");

1512  (
Sètus
);

1513 
	}
}

1528 
VOID
 
	$RTUSBReje˘PídögPackës
(

1529 
IN
 
PRTMP_ADAPTER
 
pAd
)

1531 
UCHAR
 
Index
;

1532 
PQUEUE_HEADER
 
pQueue
;

1533 
sk_buff
 *
skb
;

1534 
IrqFœgs
;

1536 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "--->RejectPendingPackets\n");

1538 
Index
 = 0; Index < 4; Index++)

1540 
	`NdisAcquúeSpöLock
(&
pAd
->
SídTxWaôQueueLock
[
Index
], 
IrqFœgs
);

1541 
pAd
->
SídTxWaôQueue
[
Index
].
Hód
 !
NULL
)

1543 
pQueue
 = (
PQUEUE_HEADER
Ë&(
pAd
->
SídTxWaôQueue
[
Index
]);

1545 
skb
 = (
sk_buff
 *)
	`RemoveHódQueue
(
pQueue
);

1546 
	`RTUSBFªeSkbBuf„r
(
skb
);

1548 
	`NdisRñó£SpöLock
(&
pAd
->
SídTxWaôQueueLock
[
Index
], 
IrqFœgs
);

1551 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "<---RejectPendingPackets\n");

1552 
	}
}

1578 
VOID
 
	$RTUSBWrôeTxDes¸ùt‹
(

1579 
IN
 
PRTMP_ADAPTER
 
pAd
,

1580 
IN
 
PTXD_STRUC
 
pSour˚TxD
,

1581 
IN
 
UCHAR
 
CùhîAlg
,

1582 
IN
 
UCHAR
 
KeyTabÀ
,

1583 
IN
 
UCHAR
 
KeyIdx
,

1584 
IN
 
BOOLEAN
 
Ack
,

1585 
IN
 
BOOLEAN
 
Føgmít
,

1586 
IN
 
BOOLEAN
 
InsTime°amp
,

1587 
IN
 
UCHAR
 
RëryMode
,

1588 
IN
 
UCHAR
 
Ifs
,

1589 
IN
 
UINT
 
R©e
,

1590 
IN
 
ULONG
 
Lígth
,

1591 
IN
 
UCHAR
 
QueIdx
,

1592 
IN
 
UCHAR
 
PID
,

1593 
IN
 
BOOLEAN
 
bA·îRTSCTS
)

1595 
UINT
 
ResiduÆ
;

1597 
PTXD_STRUC
 
pTxD
;

1599 #i‚de‡
BIG_ENDIAN


1600 
pTxD
 = 
pSour˚TxD
;

1602 
TXD_STRUC
 
TxD
;

1604 
TxD
 = *
pSour˚TxD
;

1605 
pTxD
 = &
TxD
;

1606 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pTxD
, 
TYPE_TXD
);

1610 
pTxD
->
Ho°QId
 = 
QueIdx
;

1611 
pTxD
->
M‹eFøg
 = 
Føgmít
;

1612 
pTxD
->
ACK
 = 
Ack
;

1613 
pTxD
->
Time°amp
 = 
InsTime°amp
;

1614 
pTxD
->
RëryMd
 = 
RëryMode
;

1615 
pTxD
->
Ofdm
 = (
R©e
 < 
RATE_FIRST_OFDM_RATE
)? 0:1;

1616 
pTxD
->
IFS
 = 
Ifs
;

1617 
pTxD
->
PktId
 = 
PID
;

1618 
pTxD
->
Dr›
 = 1;

1619 
pTxD
->
HwSeq
 = 1;

1620 
pTxD
->
BbpTxPowî
 = 
DEFAULT_BBP_TX_POWER
;

1621 
pTxD
->
D©aByãC¡
 = 
Lígth
;

1623 
	`RTMPCckBbpTunög
(
pAd
, 
R©e
);

1626 
pTxD
->
CùhîAlg
 = CipherAlg;

1627 i‡(
CùhîAlg
 !
CIPHER_NONE
)

1629 
pTxD
->
KeyTabÀ
 = KeyTable;

1630 
pTxD
->
KeyIndex
 = 
KeyIdx
;

1631 
pTxD
->
TkùMic
 = 1;

1635 i‡(
CùhîAlg
 =
CIPHER_TKIP_NO_MIC
)

1637 
pTxD
->
CùhîAlg
 = 
CIPHER_TKIP
;

1638 
pTxD
->
TkùMic
 = 0;

1642 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_WMM_INUSED
))

1644 i‡((
pAd
->
P‹tCfg
.
APEdˇP¨m
.
bVÆid
Ë&& (
QueIdx
 <
QID_AC_VO
))

1646 
pTxD
->
Cwmö
 = 
pAd
->
P‹tCfg
.
APEdˇP¨m
.Cwmö[
QueIdx
];

1647 
pTxD
->
Cwmax
 = 
pAd
->
P‹tCfg
.
APEdˇP¨m
.Cwmax[
QueIdx
];

1648 
pTxD
->
Aif¢
 = 
pAd
->
P‹tCfg
.
APEdˇP¨m
.Aif¢[
QueIdx
];

1652 
	`DBGPRINT
(
RT_DEBUG_ERROR
," WMM in used but EDCAÇot valid ERROR !!\n)");

1657 i‡(
bA·îRTSCTS
)

1662 
pTxD
->
Cwmö
 = 0;

1663 
pTxD
->
Cwmax
 = 0;

1664 
pTxD
->
Aif¢
 = 1;

1665 
pTxD
->
IFS
 = 
IFS_BACKOFF
;

1669 
pTxD
->
Cwmö
 = 
CW_MIN_IN_BITS
;

1670 
pTxD
->
Cwmax
 = 
CW_MAX_IN_BITS
;

1671 
pTxD
->
Aif¢
 = 2;

1676 
pTxD
->
Pl˝Sig«l
 = 
R©eIdToPl˝Sig«l
[
R©e
];

1677 i‡(((
R©e
 =
RATE_2
Ë|| (R©ê=
RATE_5_5
Ë|| (R©ê=
RATE_11
)) &&

1678 (
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_SHORT_PREAMBLE_INUSED
)))

1680 
pTxD
->
Pl˝Sig«l
 |= 0x0008;

1684 
pTxD
->
Pl˝Sîvi˚
 = 4;

1687 
Lígth
 +
LENGTH_CRC
;

1688 
CùhîAlg
)

1690 
CIPHER_WEP64
: 
Lígth
 += 8; ;

1691 
CIPHER_WEP128
: 
Lígth
 += 8; ;

1692 
CIPHER_TKIP
: 
Lígth
 += 20; ;

1693 
CIPHER_AES
: 
Lígth
 += 16; ;

1694 
CIPHER_CKIP64
: 
Lígth
 += 8; ;

1695 
CIPHER_CKIP128
: 
Lígth
 += 8; ;

1696 
CIPHER_TKIP_NO_MIC
: 
Lígth
 += 12; ;

1700 i‡(
R©e
 < 
RATE_FIRST_OFDM_RATE
)

1702 i‡((
R©e
 =
RATE_1
Ë|| ( R©ê=
RATE_2
))

1704 
Lígth
 = Lígth * 8 / (
R©e
 + 1);

1708 
ResiduÆ
 = ((
Lígth
 * 16Ë% (11 * (1 + 
R©e
 - 
RATE_5_5
)));

1709 
Lígth
 = Lígth * 16 / (11 * (1 + 
R©e
 - 
RATE_5_5
));

1710 i‡(
ResiduÆ
 != 0)

1712 
Lígth
++;

1714 i‡((
ResiduÆ
 <(3 * (1 + 
R©e
 - 
RATE_5_5
))) && (Residual != 0))

1716 i‡(
R©e
 =
RATE_11
)

1717 
pTxD
->
Pl˝Sîvi˚
 |= 0x80;

1721 
pTxD
->
Pl˝LígthHigh
 = 
Lígth
 >> 8;

1722 
pTxD
->
Pl˝LígthLow
 = 
Lígth
 % 256;

1726 
pTxD
->
Pl˝LígthHigh
 = 
Lígth
 >> 6;

1727 
pTxD
->
Pl˝LígthLow
 = 
Lígth
 % 64;

1730 
pTxD
->
Bur°
 = 
Føgmít
;

1731 
pTxD
->
Bur°2
 =ÖTxD->
Bur°
;

1733 #ifde‡
BIG_ENDIAN


1734 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pTxD
, 
TYPE_TXD
);

1735 
	`WrôeBackToDes¸ùt‹
((
PUCHAR
)
pSour˚TxD
, (PUCHAR)
pTxD
, 
FALSE
, 
TYPE_TXD
);

1737 
	}
}

1759 
VOID
 
	$RTMPDeQueuePackë
(

1760 
IN
 
PRTMP_ADAPTER
 
pAd
,

1761 
IN
 
UCHAR
 
BulkOutPùeId
)

1763 
sk_buff
 *
pSkb
;

1764 
UCHAR
 
FøgmítRequúed
;

1765 
NDIS_STATUS
 
Sètus
;

1766 
UCHAR
 
Cou¡
 = 0;

1767 
PQUEUE_HEADER
 
pQueue
;

1768 
UCHAR
 
QueIdx
;

1769 
IrqFœgs
;

1771 
	`NdisAcquúeSpöLock
(&
pAd
->
DeQueueLock
[
BulkOutPùeId
], 
IrqFœgs
);

1772 i‡(
pAd
->
DeQueueRu¬ög
[
BulkOutPùeId
])

1774 
	`NdisRñó£SpöLock
(&
pAd
->
DeQueueLock
[
BulkOutPùeId
], 
IrqFœgs
);

1779 
pAd
->
DeQueueRu¬ög
[
BulkOutPùeId
] = 
TRUE
;

1780 
	`NdisRñó£SpöLock
(&
pAd
->
DeQueueLock
[
BulkOutPùeId
], 
IrqFœgs
);

1783 
QueIdx
 = 
BulkOutPùeId
;

1785 i‡(
pAd
->
TxRögTŸÆNumbî
[
BulkOutPùeId
])

1786 
	`DBGPRINT
(
RT_DEBUG_INFO
,"--RTMPDeQueuePackë %d TxRögTŸÆNumbî%d !!--\n", 
BulkOutPùeId
, (
INT
)
pAd
->
TxRögTŸÆNumbî
[BulkOutPipeId]);

1789 
	`NdisAcquúeSpöLock
(&
pAd
->
SídTxWaôQueueLock
[
BulkOutPùeId
], 
IrqFœgs
);

1792 
pQueue
 = &
pAd
->
SídTxWaôQueue
[
BulkOutPùeId
];

1795 (
pQueue
->
Hód
 !
NULL
Ë&& (
Cou¡
 < 
MAX_TX_PROCESS
))

1798 i‡–
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
) ||

1799 
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
) ||

1800 
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
))

1802 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"--RTMPDeQueuePackë %dÑe£t-ö-¥ogªs†!!--\n", 
BulkOutPùeId
);

1807 
pSkb
 = (
sk_buff
*)
	`RemoveHódQueue
(
pQueue
);

1812 
FøgmítRequúed
 = 
	`RTMP_GET_PACKET_FRAGMENTS
(
pSkb
Ë+ 
	`RTMP_GET_PACKET_RTS
(pSkb);

1814 i‡((
	`RTUSBFªeDes¸ùt‹Reque°
(
pAd
, 
TX_RING
, 
BulkOutPùeId
, 
FøgmítRequúed
Ë=
NDIS_STATUS_SUCCESS
))

1819 
	`NdisRñó£SpöLock
(&
pAd
->
SídTxWaôQueueLock
[
BulkOutPùeId
], 
IrqFœgs
);

1821 
Sètus
 = 
	`RTUSBH¨dTønsmô
(
pAd
, 
pSkb
, 
FøgmítRequúed
, 
QueIdx
);

1824 
	`NdisAcquúeSpöLock
(&
pAd
->
SídTxWaôQueueLock
[
BulkOutPùeId
], 
IrqFœgs
);

1826 i‡(
Sètus
 =
NDIS_STATUS_FAILURE
)

1829 
	`RTUSBFªeSkbBuf„r
(
pSkb
);

1832 i‡(
Sètus
 =
NDIS_STATUS_RESOURCES
)

1837 
	`In£πHódQueue
(
pQueue
, 
pSkb
);

1840 
Cou¡
++;

1844 
	`DBGPRINT
(
RT_DEBUG_INFO
,"--RTMPDeQueuePackë %d queuêfuŒ !! TxRögTŸÆNumbî%d !! FøgmítRequúed=%d !!\n", 
BulkOutPùeId
, (
INT
)
pAd
->
TxRögTŸÆNumbî
[BulkOutPùeId], 
FøgmítRequúed
);

1845 
	`In£πHódQueue
(
pQueue
, 
pSkb
);

1846 
pAd
->
Priv©eInfo
.
TxRögFuŒC¡
++;

1853 
	`NdisRñó£SpöLock
(&
pAd
->
SídTxWaôQueueLock
[
BulkOutPùeId
], 
IrqFœgs
);

1855 #ifde‡
BLOCK_NET_IF


1856 i‡((
pAd
->
blockQueueTab
[
QueIdx
].
SwTxQueueBlockFœg
 =
TRUE
)

1857 && (
pAd
->
TxSwQueue
[
QueIdx
].
Numbî
 < 1))

1859 
	`ªÀa£NëIf
(&
pAd
->
blockQueueTab
[
QueIdx
]);

1863 
	`NdisAcquúeSpöLock
(&
pAd
->
DeQueueLock
[
BulkOutPùeId
], 
IrqFœgs
);

1864 
pAd
->
DeQueueRu¬ög
[
BulkOutPùeId
] = 
FALSE
;

1865 
	`NdisRñó£SpöLock
(&
pAd
->
DeQueueLock
[
BulkOutPùeId
], 
IrqFœgs
);

1867 
	}
}

1876 
VOID
 
	$RTUSBRxPackë
(

1877 
IN
 
d©a
)

1879 
purbb_t
 
pUrb
 = (purbb_t)
d©a
;

1880 
PRTMP_ADAPTER
 
pAd
;

1881 
PRX_CONTEXT
 
pRxC⁄ãxt
;

1882 
PRXD_STRUC
 
pRxD
;

1883 #ifde‡
BIG_ENDIAN


1884 
PRXD_STRUC
 
pDe°RxD
;

1885 
RXD_STRUC
 
RxD
;

1887 
PHEADER_802_11
 
pHódî
;

1888 
PUCHAR
 
pD©a
;

1889 
PUCHAR
 
pDA
, 
pSA
;

1890 
NDIS_STATUS
 
Sètus
;

1891 
USHORT
 
D©aSize
, 
Msdu2Size
;

1892 
UCHAR
 
Hódî802_3
[14];

1893 
PCIPHER_KEY
 
pW∑Key
;

1895 
BOOLEAN
 
EAPOLFøme
;

1896 
√t_devi˚
 *
√t_dev
;

1898 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "--->RTUSBRxPacket\n");

1900 
pRxC⁄ãxt
 = (
PRX_CONTEXT
)
pUrb
->
c⁄ãxt
;

1901 
pAd
 = 
pRxC⁄ãxt
->pAd;

1902 
√t_dev
 = 
pAd
->net_dev;

1904 if–
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
) )

1909 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "BulkI¿a˘uÆÜígth(%d)\n", 
pRxC⁄ãxt
->
pUrb
->
a˘uÆ_Àngth
);

1910 i‡(
pRxC⁄ãxt
->
pUrb
->
a˘uÆ_Àngth
 >(
RXD_STRUC
)+ 
LENGTH_802_11
)

1912 
pD©a
 = 
pRxC⁄ãxt
->
Tøns„rBuf„r
;

1913 #i‚de‡
BIG_ENDIAN


1914 
pRxD
 = (
PRXD_STRUC
Ë
pD©a
;

1916 
pDe°RxD
 = (
PRXD_STRUC
Ë
pD©a
;

1917 
RxD
 = *
pDe°RxD
;

1918 
pRxD
 = &
RxD
;

1919 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pRxD
, 
TYPE_RXD
);

1923 
pHódî
 = (
PHEADER_802_11
Ë(
pD©a
 + (
RXD_STRUC
) );

1925 #ifde‡
BIG_ENDIAN


1926 
	`RTMPFømeEndünCh™ge
(
pAd
, (
PUCHAR
)
pHódî
, 
DIR_READ
, 
FALSE
);

1928 i‡(
pRxD
->
D©aByãC¡
 < 4)

1929 
Sètus
 = 
NDIS_STATUS_FAILURE
;

1933 
pAd
->
RÆökCou¡îs
.
Re˚ivedByãCou¡
 +(
pRxD
->
D©aByãC¡
 - 4);

1934 
pAd
->
RÆökCou¡îs
.
RxCou¡
 ++;

1937 
Sètus
 = 
	`RTMPCheckRxDes¸ùt‹
(
pAd
, 
pHódî
, 
pRxD
);

1940 i‡(
Sètus
 =
NDIS_STATUS_SUCCESS
)

1943 
Sètus
 = 
	`RTMPAµlyPackëFûãr
(
pAd
, 
pRxD
, 
pHódî
);

1947 i‡(
Sètus
 =
NDIS_STATUS_SUCCESS
)

1950 
	`INC_COUNTER64
(
pAd
->
WœnCou¡îs
.
Re˚ivedFøgmítCou¡
);

1955 
pAd
->
Cou¡îs
.
RxEº‹s
++;

1958 #ifde‡
RALINK_ATE


1959 if((!
pRxD
->
U2M
Ë&& 
pAd
->
©e
.
Mode
 !
ATE_STASTART
)

1961 
CHAR
 
RólRssi
;

1963 
RólRssi
 = 
	`C⁄vîtToRssi
(
pAd
, (
UCHAR
)
pRxD
->
Pl˝Rssi
, 
RSSI_NO_1
);

1964 
pAd
->
P‹tCfg
.
La°Rssi
 = 
RólRssi
 +ÖAd->
BbpRssiToDbmDñè
;

1965 
pAd
->
P‹tCfg
.
AvgRssiX8
 = (pAd->P‹tCfg.AvgRssiX8 -ÖAd->P‹tCfg.
AvgRssi
Ë+ÖAd->P‹tCfg.
La°Rssi
;

1966 
pAd
->
P‹tCfg
.
AvgRssi
 =ÖAd->P‹tCfg.
AvgRssiX8
 >> 3;

1978 i‡((
pRxD
->
U2M
Ë&& (
Sètus
 =
NDIS_STATUS_SUCCESS
Ë&& (
pHódî
->
FC
.
Ty≥
 !
BTYPE_CNTL
))

1980 i‡(
pHódî
->
FC
.
Rëry
)

1982 i‡(
	`RTMPSórchTu∂eCache
(
pAd
, 
pHódî
Ë=
TRUE
)

1986 
	`INC_COUNTER64
(
pAd
->
WœnCou¡îs
.
FømeDu∂iˇãCou¡
);

1987 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "du∂iˇã fømê%d\n", 
pHódî
->
Sequí˚
);

1988 
Sètus
 = 
NDIS_STATUS_FAILURE
;

1992 
	`RTMPUpd©eTu∂eCache
(
pAd
, 
pHódî
);

1997 
	`RTMPUpd©eTu∂eCache
(
pAd
, 
pHódî
);

2001 i‡((
pRxD
->
U2M
Ë|| ((
pHódî
->
FC
.
SubTy≥
 =
SUBTYPE_BEACON
Ë&& (
	`MAC_ADDR_EQUAL
(&
pAd
->
P‹tCfg
.
Bssid
, &pHódî->
Addr2
))))

2003 i‡((
pAd
->
A¡í«
.
fõld
.
NumOfA¡í«
 =2Ë&& (pAd->A¡í«.fõld.
TxDeÁu…A¡í«
 =0Ë&& (pAd->A¡í«.fõld.
RxDeÁu…A¡í«
 == 0))

2005 
	`COLLECT_RX_ANTENNA_AVERAGE_RSSI
(
pAd
, 
	`C⁄vîtToRssi
’Ad, (
UCHAR
)
pRxD
->
Pl˝Rssi
, 
RSSI_NO_1
), 0);

2006 
pAd
->
P‹tCfg
.
NumOfAvgRssiSam∂e
 ++;

2013 i‡(
Sètus
 =
NDIS_STATUS_SUCCESS
)

2018 i‡(
	`VIRTUAL_IF_NUM
(
pAd
)==0)

2022 
pD©a
 +
LENGTH_802_11
 + (
RXD_STRUC
);

2023 
D©aSize
 = (
USHORT
Ë
pRxD
->
D©aByãC¡
 - 
LENGTH_802_11
;

2028 i‡(
pHódî
->
FC
.
Ty≥
 =
BTYPE_DATA
)

2031 i‡–!
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
) )

2033 
	`DBGPRINT
(
RT_DEBUG_INFO
,"RxD⁄e- dr› DATA fømêbef‹êLINK UP÷í=%d)\n",
pRxD
->
D©aByãC¡
);

2036 
pAd
->
BulkInD©aO√SecCou¡
++;

2040 i‡(
pHódî
->
FC
.
SubTy≥
 & 0x08)

2042 
pD©a
 += 2;

2043 
D©aSize
 -= 2;

2047 
Msdu2Size
 = 0;

2048 i‡(
pHódî
->
FC
.
Ordî
)

2050 
Msdu2Size
 = *
pD©a
 + (*(pData+1) << 8);

2051 i‡((
Msdu2Size
 <1536Ë&& (Msdu2Sizê< 
D©aSize
))

2053 
pD©a
 += 2;

2054 
D©aSize
 -= 2;

2057 
Msdu2Size
 = 0;

2066 i‡(
	`RTMPEquÆMem‹y
(
EAPOL
, 
pD©a
 + 6, 2))

2067 
EAPOLFøme
 = 
TRUE
;

2069 
EAPOLFøme
 = 
FALSE
;

2071 i‡((
pRxD
->
MyBss
 =0Ë&& (
EAPOLFøme
 !
TRUE
))

2075 i‡((
pHódî
->
FC
.
SubTy≥
 & 0x04) == 0x04)

2077 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"RxD⁄e- dr› NULL føme(subty≥=%d)\n",
pHódî
->
FC
.
SubTy≥
);

2083 
pDA
 = 
pHódî
->
Addr1
;

2084 i‡(
	`INFRA_ON
(
pAd
))

2085 
pSA
 = 
pHódî
->
Addr3
;

2087 
pSA
 = 
pHódî
->
Addr2
;

2089 i‡(
pHódî
->
FC
.
Wï
)

2091 i‡(
pRxD
->
CùhîAlg
 =
CIPHER_NONE
)

2095 i‡(
pAd
->
Sh¨edKey
[
pRxD
->
KeyIndex
].
KeyLí
 == 0)

2103 i‡(((
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄1E«bÀd
) ||

2104 (
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
) ||

2105 (
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)) &&

2106 (
pAd
->
P‹tCfg
.
PrivacyFûãr
 =
Ndis802_11PrivFûãr8021xWEP
) &&

2107 (!
	`NdisEquÆMem‹y
(
EAPOL_LLC_SNAP
, 
pD©a
, 
LENGTH_802_1_H
)))

2116 i‡(
pRxD
->
Bˇ°
 ||ÖRxD->
Mˇ°
)

2118 
PUCHAR
 
pRemovedLLCSNAP
;

2119 
	`INC_COUNTER64
(
pAd
->
WœnCou¡îs
.
Mu…iˇ°Re˚ivedFømeCou¡
);

2122 i‡(
pHódî
->
FC
.
M‹eFøg
)

2128 i‡(
pHódî
->
FC
.
FrDs
 && 
	`MAC_ADDR_EQUAL
’Hódî->
Addr3
, 
pAd
->
CuºítAddªss
))

2134 
	`CONVERT_TO_802_3
(
Hódî802_3
, 
pDA
, 
pSA
, 
pD©a
, 
D©aSize
, 
pRemovedLLCSNAP
);

2135 
	`REPORT_ETHERNET_FRAME_TO_LLC
(
pAd
,
Hódî802_3
, 
pD©a
, 
D©aSize
, 
√t_dev
);

2136 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "!!!Ñï‹àBCAST DATAÅÿLLC (Àn=%dË!!!\n", 
D©aSize
);

2141 i‡(
pRxD
->
U2M
)

2143 
	`RECORD_LATEST_RX_DATA_RATE
(
pAd
, 
pRxD
);

2145 i‡(
pAd
->
P‹tCfg
.
WPA_Suµliˇ¡
 =
TRUE
)

2150 i‡(
pHódî
->
Føg
 == 0)

2152 i‡(
pHódî
->
FC
.
M‹eFøg
 =
FALSE
)

2154 if(
	`NdisEquÆMem‹y
(
EAPOL_LLC_SNAP
, 
pD©a
, 
LENGTH_802_1_H
))

2156 
PUCHAR
 
pRemovedLLCSNAP
;

2157 
suc˚ss
 = 0;

2160 i‡–
pAd
->
P‹tCfg
.
IEEE8021X
 =
TRUE


2161 && (
EAP_CODE_SUCCESS
 =
	`RTMPCheckWPA‰ameF‹E≠Code
(
pAd
, 
pD©a
, 
D©aSize
, 
LENGTH_802_1_H
)))

2163 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "Receive EAP-SUCCESS Packet\n");

2164 
pAd
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_SECURED
;

2166 
suc˚ss
 = 1;

2170 
	`CONVERT_TO_802_3
(
Hódî802_3
, 
pDA
, 
pSA
, 
pD©a
, 
D©aSize
, 
pRemovedLLCSNAP
);

2171 
	`REPORT_ETHERNET_FRAME_TO_LLC
(
pAd
, 
Hódî802_3
, 
pD©a
, 
D©aSize
, 
√t_dev
);

2172 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "!!!Ñï‹àEAPoL DATAÅÿLLC (Àn=%dË!!!\n", 
D©aSize
);

2174 if(
suc˚ss
)

2177 if(
pAd
->
P‹tCfg
.
IEEE8021x_ªquúed_keys
 == 0)

2179 
idx
;

2180 
idx
 = 
pAd
->
P‹tCfg
.
DeÁu…KeyId
;

2182 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "Set WEP keyÅo Asicágain =>\n");

2183 if(
pAd
->
P‹tCfg
.
DesúeSh¨edKey
[
idx
].
KeyLí
 != 0)

2185 
pAd
->
Sh¨edKey
[
idx
].
KeyLí
 =ÖAd->
P‹tCfg
.
DesúeSh¨edKey
[idx].KeyLen;

2186 
	`NdisMoveMem‹y
(
pAd
->
Sh¨edKey
[
idx
].
Key
,ÖAd->
P‹tCfg
.
DesúeSh¨edKey
[idx].Key,ÖAd->Sh¨edKey[idx].
KeyLí
);

2187 
pAd
->
Sh¨edKey
[
idx
].
CùhîAlg
 =ÖAd->
P‹tCfg
.
DesúeSh¨edKey
[idx].CipherAlg;

2188 
	`AsicAddSh¨edKeyE¡ry
(
pAd
, 0, (
UCHAR
)
idx
,ÖAd->
Sh¨edKey
[idx].
CùhîAlg
,ÖAd->Sh¨edKey[idx].
Key
, 
NULL
, NULL);

2197 i‡(
	`NdisEquÆMem‹y
(
EAPOL_LLC_SNAP
, 
pD©a
, 
LENGTH_802_1_H
))

2199 
	`NdisMoveMem‹y
(&
pAd
->
FøgFøme
.
Buf„r
[
LENGTH_802_3
], 
pD©a
, 
D©aSize
);

2200 
	`NdisMoveMem‹y
(
pAd
->
FøgFøme
.
Hódî802_3
, Hódî802_3, 
LENGTH_802_3
);

2201 
pAd
->
FøgFøme
.
RxSize
 = 
D©aSize
;

2202 
pAd
->
FøgFøme
.
Sequí˚
 = 
pHódî
->Sequence;

2203 
pAd
->
FøgFøme
.
La°Føg
 = 
pHódî
->
Føg
;

2213 i‡(
	`RTMPEquÆMem‹y
(
SNAP_802_1H
, (
PUCHAR
)&
pAd
->
FøgFøme
.
Buf„r
[
LENGTH_802_3
], 6))

2215 i‡((
pHódî
->
Sequí˚
 !
pAd
->
FøgFøme
.Sequí˚Ë||’Hódî->
Føg
 !’Ad->FøgFøme.
La°Føg
 + 1)))

2218 
	`NdisZîoMem‹y
(&
pAd
->
FøgFøme
, (
FRAGMENT_FRAME
));

2221 i‡((
pAd
->
FøgFøme
.
RxSize
 + 
D©aSize
Ë> 
MAX_FRAME_SIZE
)

2224 
	`NdisZîoMem‹y
(&
pAd
->
FøgFøme
, (
FRAGMENT_FRAME
));

2229 
	`NdisMoveMem‹y
(&
pAd
->
FøgFøme
.
Buf„r
[
LENGTH_802_3
 +ÖAd->FøgFøme.
RxSize
], 
pD©a
, 
D©aSize
);

2230 
pAd
->
FøgFøme
.
RxSize
 +
D©aSize
;

2231 
pAd
->
FøgFøme
.
La°Føg
 = 
pHódî
->
Føg
;

2233 
suc˚ss
 = 0;

2235 i‡(
pHódî
->
FC
.
M‹eFøg
 =
FALSE
)

2237 
BOOLEAN
 
CheckPktS™ôy
 = 
TRUE
;

2238 if(
pAd
->
FøgFøme
.
RxSize
 < (
LENGTH_802_1_H
 + 
LENGTH_EAPOL_H
))

2240 
CheckPktS™ôy
 = 
FALSE
;

2241 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "TotalÖkts size isÅoo small.\n");

2243 i‡(!
	`RTMPEquÆMem‹y
(
SNAP_802_1H
, (
PUCHAR
)&
pAd
->
FøgFøme
.
Buf„r
[
LENGTH_802_3
], 6))

2245 
CheckPktS™ôy
 = 
FALSE
;

2246 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Can't find SNAP_802_1HÖarameter.\n");

2248 i‡(!
	`RTMPEquÆMem‹y
(
EAPOL
, (
PUCHAR
)&
pAd
->
FøgFøme
.
Buf„r
[
LENGTH_802_3
 + 6], 2))

2250 
CheckPktS™ôy
 = 
FALSE
;

2251 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Can't find EAPOLÖarameter.\n");

2253 if(
pAd
->
FøgFøme
.
Buf„r
[
LENGTH_802_3
 + 9] > 
EAPOLASFAÀπ
)

2255 
CheckPktS™ôy
 = 
FALSE
;

2256 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Unknow¿EAPÅy≥(%d).\n",
pAd
->
FøgFøme
.
Buf„r
[
LENGTH_802_3
+9]);

2259 if(
CheckPktS™ôy
 =
FALSE
)

2261 
	`NdisZîoMem‹y
(&
pAd
->
FøgFøme
, (
FRAGMENT_FRAME
));

2264 i‡–
pAd
->
P‹tCfg
.
IEEE8021X
 =
TRUE
 )

2266 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "Receive EAP-SUCCESS Packet\n");

2267 
pAd
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_SECURED
;

2268 
suc˚ss
 = 1;

2271 
PUCHAR
 
pRemovedLLCSNAP
;

2272 
pD©a
 = &
pAd
->
FøgFøme
.
Buf„r
[
LENGTH_802_3
];

2273 
	`CONVERT_TO_802_3
(
pAd
->
FøgFøme
.
Hódî802_3
, 
pDA
, 
pSA
, 
pD©a
,ÖAd->FøgFøme.
RxSize
, 
pRemovedLLCSNAP
);

2274 
	`REPORT_ETHERNET_FRAME_TO_LLC
(
pAd
,ÖAd->
FøgFøme
.
Hódî802_3
, 
pD©a
,ÖAd->FøgFøme.
RxSize
, 
√t_dev
);

2276 if(
suc˚ss
)

2279 if(
pAd
->
P‹tCfg
.
IEEE8021x_ªquúed_keys
 == 0)

2281 
idx
;

2283 
idx
 = 
pAd
->
P‹tCfg
.
DeÁu…KeyId
;

2284 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "Set WEP keyÅo Asicágain =>\n");

2286 if(
pAd
->
P‹tCfg
.
DesúeSh¨edKey
[
idx
].
KeyLí
 != 0)

2288 
pAd
->
Sh¨edKey
[
idx
].
KeyLí
 =ÖAd->
P‹tCfg
.
DesúeSh¨edKey
[idx].KeyLen;

2289 
	`NdisMoveMem‹y
(
pAd
->
Sh¨edKey
[
idx
].
Key
,ÖAd->
P‹tCfg
.
DesúeSh¨edKey
[idx].Key,ÖAd->Sh¨edKey[idx].
KeyLí
);

2290 
pAd
->
Sh¨edKey
[
idx
].
CùhîAlg
 =ÖAd->
P‹tCfg
.
DesúeSh¨edKey
[idx].CipherAlg;

2291 
	`AsicAddSh¨edKeyE¡ry
(
pAd
, 0, (
UCHAR
)
idx
,ÖAd->
Sh¨edKey
[idx].
CùhîAlg
,ÖAd->Sh¨edKey[idx].
Key
, 
NULL
, NULL);

2297 
	`NdisZîoMem‹y
(&
pAd
->
FøgFøme
, (
FRAGMENT_FRAME
));

2308 i‡((
pHódî
->
Føg
 =0Ë&& (pHódî->
FC
.
M‹eFøg
 =
FALSE
))

2310 i‡(
	`NdisEquÆMem‹y
(
EAPOL_LLC_SNAP
, 
pD©a
, 
LENGTH_802_1_H
Ë&& (
pAd
->
P‹tCfg
.
W∑Sèã
 !
SS_NOTUSE
))

2317 
	`REPORT_MGMT_FRAME_TO_MLME
(
pAd
, 
pHódî
, 
pD©a
, 
D©aSize
, 
pRxD
->
Pl˝Rssi
,ÖRxD->
Pl˝Sig«l
);

2319 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "!!!Ñï‹àEAPOL/AIRONET DATAÅÿMLME (Àn=%dË!!!\n", 
D©aSize
);

2326 i‡(
pHódî
->
Føg
 == 0)

2328 
PUCHAR
 
pRemovedLLCSNAP
;

2329 
	`CONVERT_TO_802_3
(
Hódî802_3
, 
pDA
, 
pSA
, 
pD©a
, 
D©aSize
, 
pRemovedLLCSNAP
);

2330 
pAd
->
FøgFøme
.
Fœgs
 &= 0xFFFFFFFE;

2334 i‡(
pHódî
->
FC
.
M‹eFøg
 && 
pRemovedLLCSNAP
)

2336 
	`NdisMoveMem‹y
(
pAd
->
FøgFøme
.
Hódî802_11
, 
pHódî
, 
LENGTH_802_11
);

2337 
	`NdisMoveMem‹y
(
pAd
->
FøgFøme
.
Hódî_LLC
, 
pRemovedLLCSNAP
, 
LENGTH_802_1_H
);

2338 
pAd
->
FøgFøme
.
Fœgs
 |= 0x01;

2342 i‡(
pHódî
->
FC
.
M‹eFøg
 =
FALSE
)

2344 i‡((
pHódî
->
FC
.
Ordî
 =1Ë&& (
Msdu2Size
 > 0))

2346 
USHORT
 
Paylﬂd1Size
, 
Paylﬂd2Size
;

2347 
PUCHAR
 
pD©a2
;

2349 
pAd
->
RÆökCou¡îs
.
O√SecRxAggªg©i⁄Cou¡
 ++;

2350 
Paylﬂd1Size
 = 
D©aSize
 - 
Msdu2Size
;

2351 
Paylﬂd2Size
 = 
Msdu2Size
 - 
LENGTH_802_3
;

2353 
	`REPORT_ETHERNET_FRAME_TO_LLC
(
pAd
, 
Hódî802_3
, 
pD©a
, 
Paylﬂd1Size
, 
√t_dev
);

2354 
	`DBGPRINT
(
RT_DEBUG_INFO
, "!!!Ñeport segregated MSDU1Åo LLC (len=%d,Öroto=%02x:%02x) %02x:%02x:%02x:%02x-%02x:%02x:%02x:%02x\n",

2355 
LENGTH_802_3
+
Paylﬂd1Size
, 
Hódî802_3
[12], Header802_3[13],

2356 *
pD©a
, *(pData+1),*(pData+2),*(pData+3),*(pData+4),*(pData+5),*(pData+6),*(pData+7));

2358 
pD©a2
 = 
pD©a
 + 
Paylﬂd1Size
 + 
LENGTH_802_3
;

2359 
	`REPORT_ETHERNET_FRAME_TO_LLC
(
pAd
, 
pD©a
 + 
Paylﬂd1Size
, 
pD©a2
, 
Paylﬂd2Size
, 
√t_dev
);

2360 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "!!!Ñeport segregated MSDU2Åo LLC (len=%d,Öroto=%02x:%02x) %02x:%02x:%02x:%02x-%02x:%02x:%02x:%02x\n",

2361 
LENGTH_802_3
+
Paylﬂd2Size
, *(
pD©a2
 -2), *(pData2 - 1),

2362 *
pD©a2
, *(pData2+1),*(pData2+2),*(pData2+3),*(pData2+4),*(pData2+5),*(pData2+6),*(pData2+7));

2366 
	`REPORT_ETHERNET_FRAME_TO_LLC
(
pAd
, 
Hódî802_3
, 
pD©a
, 
D©aSize
, 
√t_dev
);

2367 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "!!!Ñeport DATA (no frag)Åo LLC (len=%d,Öroto=%02x:%02x) %02x:%02x:%02x:%02x-%02x:%02x:%02x:%02x\n",

2368 
D©aSize
, 
Hódî802_3
[12], Header802_3[13],

2369 *
pD©a
, *(pData+1),*(pData+2),*(pData+3),*(pData+4),*(pData+5),*(pData+6),*(pData+7));

2375 
	`NdisMoveMem‹y
(&
pAd
->
FøgFøme
.
Buf„r
[
LENGTH_802_3
], 
pD©a
, 
D©aSize
);

2376 
	`NdisMoveMem‹y
(
pAd
->
FøgFøme
.
Hódî802_3
, Hódî802_3, 
LENGTH_802_3
);

2377 
pAd
->
FøgFøme
.
RxSize
 = 
D©aSize
;

2378 
pAd
->
FøgFøme
.
Sequí˚
 = 
pHódî
->Sequence;

2379 
pAd
->
FøgFøme
.
La°Føg
 = 
pHódî
->
Føg
;

2386 i‡((
pHódî
->
Sequí˚
 !
pAd
->
FøgFøme
.Sequence) ||

2387 (
pHódî
->
Føg
 !(
pAd
->
FøgFøme
.
La°Føg
 + 1)))

2391 
	`NdisZîoMem‹y
(&
pAd
->
FøgFøme
, (
FRAGMENT_FRAME
));

2394 i‡((
pAd
->
FøgFøme
.
RxSize
 + 
D©aSize
Ë> 
MAX_FRAME_SIZE
)

2398 
	`NdisZîoMem‹y
(&
pAd
->
FøgFøme
, (
FRAGMENT_FRAME
));

2403 
	`NdisMoveMem‹y
(&
pAd
->
FøgFøme
.
Buf„r
[
LENGTH_802_3
 +ÖAd->FøgFøme.
RxSize
], 
pD©a
, 
D©aSize
);

2404 
pAd
->
FøgFøme
.
RxSize
 +
D©aSize
;

2405 
pAd
->
FøgFøme
.
La°Føg
 = 
pHódî
->
Føg
;

2408 i‡(
pHódî
->
FC
.
M‹eFøg
 =
FALSE
)

2411 i‡(
pAd
->
FøgFøme
.
Fœgs
 & 0x00000001)

2418 
	`NdisMoveMem‹y
(&
pAd
->
FøgFøme
.
Buf„r
[
LENGTH_802_3
 - 
LENGTH_802_1_H
],

2419 
pAd
->
FøgFøme
.
Hódî_LLC
,

2420 
LENGTH_802_1_H
);

2421 
pD©a
 = (
PUCHAR
Ë&
pAd
->
FøgFøme
.
Buf„r
[
LENGTH_802_3
 - 
LENGTH_802_1_H
];

2422 
D©aSize
 = (
USHORT
)
pAd
->
FøgFøme
.
RxSize
 + 
LENGTH_802_1_H
;

2426 
pD©a
 = (
PUCHAR
Ë&
pAd
->
FøgFøme
.
Buf„r
[
LENGTH_802_3
];

2427 
D©aSize
 = (
USHORT
)
pAd
->
FøgFøme
.
RxSize
;

2432 i‡(
pRxD
->
CùhîAlg
 =
CIPHER_TKIP
)

2434 
pW∑Key
 = &
pAd
->
Sh¨edKey
[0];

2437 
pAd
->
FøgFøme
.
RxSize
 -= 8;

2438 
D©aSize
 -= 8;

2461 i‡(
	`RTMPTkùCom∑ªMICVÆue
(

2462 
pAd
,

2463 
pD©a
,

2464 
pDA
,

2465 
pSA
,

2466 
pW∑Key
->
RxMic
,

2467 
D©aSize
Ë=
FALSE
)

2469 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
,"Rx MIC ValueÉrror 2\n");

2470 
	`RTMPRï‹tMicEº‹
(
pAd
, 
pW∑Key
);

2483 i‡((
pAd
->
FøgFøme
.
Fœgs
 & 0x00000001) &&

2484 
	`NdisEquÆMem‹y
(
EAPOL_LLC_SNAP
, 
pD©a
, 
LENGTH_802_1_H
Ë&& (
pAd
->
P‹tCfg
.
W∑Sèã
 !
SS_NOTUSE
))

2486 
	`REPORT_MGMT_FRAME_TO_MLME
(
pAd
,ÖAd->
FøgFøme
.
Hódî802_11
, 
pD©a
, 
D©aSize
, 
pRxD
->
Pl˝Rssi
,ÖRxD->
Pl˝Sig«l
);

2487 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "!!!Ñï‹àEAPOL/AIRONET DATAÅÿMLME (Àn=%dË!!!\n", 
D©aSize
);

2491 
pD©a
 = &
pAd
->
FøgFøme
.
Buf„r
[
LENGTH_802_3
];

2492 
	`REPORT_ETHERNET_FRAME_TO_LLC
(
pAd
,ÖAd->
FøgFøme
.
Hódî802_3
, 
pD©a
,ÖAd->FøgFøme.
RxSize
, 
√t_dev
);

2493 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "!!!Ñï‹àDATA (‰agmíãdËtÿLLC (Àn=%dË!!!\n", 
pAd
->
FøgFøme
.
RxSize
);

2503 i‡(
pHódî
->
FC
.
Ty≥
 =
BTYPE_MGMT
)

2507 
	`REPORT_MGMT_FRAME_TO_MLME
(
pAd
, 
pHódî
, 
pD©a
, 
D©aSize
, 
pRxD
->
Pl˝Rssi
,ÖRxD->
Pl˝Sig«l
);

2514 i‡(
pHódî
->
FC
.
Ty≥
 =
BTYPE_CNTL
)

2521 } 
FALSE
);

2525 i‡(
Sètus
 =
NDIS_STATUS_RESET
)

2527 
	`RTUSBEnqueueI¡î«lCmd
(
pAd
, 
RT_OID_USB_RESET_BULK_IN
);

2531 #ifde‡
BIG_ENDIAN


2532 
	`RTMPFømeEndünCh™ge
(
pAd
, (
PUCHAR
)
pHódî
, 
DIR_WRITE
, 
TRUE
);

2533 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pRxD
, 
TYPE_RXD
);

2534 
	`WrôeBackToDes¸ùt‹
((
PUCHAR
)
pDe°RxD
, (PUCHAR)
pRxD
, 
FALSE
, 
TYPE_RXD
);

2539 
pRxC⁄ãxt
->
InU£
 = 
FALSE
;

2541 if(
pAd
->
BulkOutMaxPackëSize
 == 512)

2543 i‡((!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)) &&

2544 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKIN_RESET
)) &&

2545 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
)) &&

2546 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) &&

2547 #ifde‡
RALINK_ATE


2548 (!(
pAd
->
©e
.
Mode
 !
ATE_STASTART
)) &&

2550 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)))

2552 
	`RTUSBBulkRe˚ive
(
pAd
);

2557 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "In USB 1.1 Mode \n");

2560 #ifde‡
RALINK_ATE


2562 if((
pAd
->
©e
.
Mode
 !
ATE_STASTART
Ë&& (pAd->
C⁄töBulkIn
 =
TRUE
))

2564 
	`RTUSBBulkRe˚ive
(
pAd
);

2571 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<---RTUSBRxPacket Complete\n");

2572 
	}
}

2587 
VOID
 
	$RTUSBDequeueMLMEPackë
(

2588 
IN
 
PRTMP_ADAPTER
 
pAd
)

2590 
PMGMT_STRUC
 
pMgmt
;

2591 
IrqFœgs
;

2592 
IrqFœgs2
;

2594 
	`DBGPRINT
(
RT_DEBUG_INFO
, "RTUSBDequeueMLMEPacket\n");

2596 
	`NdisAcquúeSpöLock
(&
pAd
->
DeMGMTQueueLock
, 
IrqFœgs2
);

2597 i‡(
pAd
->
DeMGMTQueueRu¬ög
)

2599 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "<---RTUSBDequeueMLMEPacket : DeMGMTQueueRunning\n");

2600 
	`NdisRñó£SpöLock
(&
pAd
->
DeMGMTQueueLock
, 
IrqFœgs2
);

2605 
pAd
->
DeMGMTQueueRu¬ög
 = 
TRUE
;

2606 
	`NdisRñó£SpöLock
(&
pAd
->
DeMGMTQueueLock
, 
IrqFœgs2
);

2609 
	`NdisAcquúeSpöLock
(&
pAd
->
MLMEWaôQueueLock
, 
IrqFœgs
);

2610 (
pAd
->
P›MgmtIndex
 !pAd->
PushMgmtIndex
Ë|| (
	`©omic_ªad
(&pAd->
MgmtQueueSize
) > 0))

2612 
pMgmt
 = &
pAd
->
MgmtRög
[pAd->
P›MgmtIndex
];

2614 i‡(
	`RTUSBFªeDes¸ùt‹Reque°
(
pAd
, 
PRIO_RING
, 0, 1Ë=
NDIS_STATUS_SUCCESS
)

2616 
	`©omic_dec
(&
pAd
->
MgmtQueueSize
);

2617 
pAd
->
P›MgmtIndex
 = (pAd->P›MgmtIndex + 1Ë% 
MGMT_RING_SIZE
;

2618 
	`NdisRñó£SpöLock
(&
pAd
->
MLMEWaôQueueLock
, 
IrqFœgs
);

2620 
	`RTUSBMlmeH¨dTønsmô
(
pAd
, 
pMgmt
);

2622 
	`MlmeFªeMem‹y
(
pAd
, 
pMgmt
->
pBuf„r
);

2623 
pMgmt
->
pBuf„r
 = 
NULL
;

2624 
pMgmt
->
VÆid
 = 
FALSE
;

2626 
	`NdisAcquúeSpöLock
(&
pAd
->
MLMEWaôQueueLock
, 
IrqFœgs
);

2630 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "nŸÉnough s∑˚ i¿PrioRög[pAd≠ãr->MgmtQueueSize=%d]\n", 
	`©omic_ªad
(&
pAd
->
MgmtQueueSize
));

2631 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RTUSBDequeueMLMEPacket::PrioRingFirstIndex = %d, PrioRingTxCnt = %d, PopMgmtIndex = %d, PushMgmtIndex = %d, NextMLMEIndex = %d\n",

2632 
pAd
->
PrioRögFú°Index
,ÖAd->
PrioRögTxC¡
,

2633 
pAd
->
P›MgmtIndex
,ÖAd->
PushMgmtIndex
,ÖAd->
NextMLMEIndex
);

2637 
	`NdisRñó£SpöLock
(&
pAd
->
MLMEWaôQueueLock
, 
IrqFœgs
);

2639 
	`NdisAcquúeSpöLock
(&
pAd
->
DeMGMTQueueLock
, 
IrqFœgs2
);

2640 
pAd
->
DeMGMTQueueRu¬ög
 = 
FALSE
;

2641 
	`NdisRñó£SpöLock
(&
pAd
->
DeMGMTQueueLock
, 
IrqFœgs2
);

2642 
	}
}

2657 
VOID
 
	$RTUSBCÀ™UpMLMEWaôQueue
(

2658 
IN
 
PRTMP_ADAPTER
 
pAd
)

2660 
PMGMT_STRUC
 
pMgmt
;

2661 
IrqFœgs
;

2663 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "--->CleanUpMLMEWaitQueue\n");

2665 
	`NdisAcquúeSpöLock
(&
pAd
->
MLMEWaôQueueLock
, 
IrqFœgs
);

2666 
pAd
->
P›MgmtIndex
 !pAd->
PushMgmtIndex
)

2668 
pMgmt
 = (
PMGMT_STRUC
)&
pAd
->
MgmtRög
[pAd->
P›MgmtIndex
];

2669 
	`MlmeFªeMem‹y
(
pAd
, 
pMgmt
->
pBuf„r
);

2670 
pMgmt
->
pBuf„r
 = 
NULL
;

2671 
pMgmt
->
VÆid
 = 
FALSE
;

2672 
	`©omic_dec
(&
pAd
->
MgmtQueueSize
);

2674 
pAd
->
P›MgmtIndex
++;

2675 i‡(
pAd
->
P›MgmtIndex
 >
MGMT_RING_SIZE
)

2677 
pAd
->
P›MgmtIndex
 = 0;

2680 
	`NdisRñó£SpöLock
(&
pAd
->
MLMEWaôQueueLock
, 
IrqFœgs
);

2682 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<---CleanUpMLMEWaitQueue\n");

2683 
	}
}

2701 
VOID
 
	$RTUSBSu•ídMsduTønsmissi⁄
(

2702 
IN
 
PRTMP_ADAPTER
 
pAd
)

2704 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"SCANNING, suspend MSDUÅransmission ...\n");

2710 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

2711 
	`RTUSBRódBBPRegi°î
(
pAd
, 17, &pAd->
BbpTunög
.
R17CuºítVÆue
);

2713 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
);

2714 
	}
}

2732 
VOID
 
	$RTUSBResumeMsduTønsmissi⁄
(

2733 
IN
 
PRTMP_ADAPTER
 
pAd
)

2735 
INT
 
Index
;

2737 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"SCAN done,Ñesume MSDUÅransmission ...\n");

2738 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
);

2743 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

2744 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17,ÖAd->
BbpTunög
.
R17CuºítVÆue
);

2746 i‡((!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)) &&

2747 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) &&

2748 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
)))

2751 
Index
 = 0; Index < 4; Index++)

2753 if(
pAd
->
SídTxWaôQueue
[
Index
].
Numbî
 > 0)

2755 
	`RTMPDeQueuePackë
(
pAd
, 
Index
);

2761 
	`RTUSBKickBulkOut
(
pAd
);

2762 
	}
}

2785 
VOID
 
	$Möù‹tMMReque°
(

2786 
IN
 
PRTMP_ADAPTER
 
pAd
,

2787 
IN
 
UCHAR
 
QueIdx
,

2788 
IN
 
PVOID
 
pBuf„r
,

2789 
IN
 
ULONG
 
Lígth
)

2791 
IrqFœgs
;

2793 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "---> MiniportMMRequest\n");

2795 i‡(
pBuf„r
)

2797 
PMGMT_STRUC
 
pMgmt
;

2800 
	`NdisAcquúeSpöLock
(&
pAd
->
MLMEWaôQueueLock
, 
IrqFœgs
);

2801 
pMgmt
 = (
PMGMT_STRUC
)&
pAd
->
MgmtRög
[pAd->
PushMgmtIndex
];

2803 i‡(
pMgmt
->
VÆid
 =
TRUE
)

2805 
	`NdisRñó£SpöLock
(&
pAd
->
MLMEWaôQueueLock
, 
IrqFœgs
);

2806 
	`MlmeFªeMem‹y
(
pAd
, 
pBuf„r
);

2807 
pAd
->
RÆökCou¡îs
.
MgmtRögFuŒCou¡
++;

2808 
	`DBGPRINT_RAW
(
RT_DEBUG_WARN
, "MiniportMMRequest (error:: MgmtRing full)\n");

2813 
pMgmt
->
pBuf„r
 =ÖBuffer;

2814 
pMgmt
->
Lígth
 = Length;

2815 
pMgmt
->
VÆid
 = 
TRUE
;

2816 
pAd
->
PushMgmtIndex
++;

2817 
	`©omic_öc
(&
pAd
->
MgmtQueueSize
);

2818 i‡(
pAd
->
PushMgmtIndex
 >
MGMT_RING_SIZE
)

2820 
pAd
->
PushMgmtIndex
 = 0;

2822 
	`NdisRñó£SpöLock
(&
pAd
->
MLMEWaôQueueLock
, 
IrqFœgs
);

2826 
	`DBGPRINT
(
RT_DEBUG_WARN
, "MiniportMMRequest (error:: NULL msg)\n");

2828 
	`RTUSBDequeueMLMEPackë
(
pAd
);

2832 i‡(
pAd
->
PrioRögTxC¡
 > 0)

2834 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_DOZE
))

2835 
	`AsicF‹˚Wakeup
(
pAd
);

2836 
	`RTUSBKickBulkOut
(
pAd
);

2839 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "<--- MiniportMMRequest\n");

2840 
	}
}

2860 
BOOLEAN
 
	$RTMPSórchTu∂eCache
(

2861 
IN
 
PRTMP_ADAPTER
 
pAd
,

2862 
IN
 
PHEADER_802_11
 
pHódî
)

2864 
INT
 
Index
;

2866 
Index
 = 0; Index < 
MAX_CLIENT
; Index++)

2868 i‡(
pAd
->
Tu∂eCache
[
Index
].
VÆid
 =
FALSE
)

2871 i‡(
	`MAC_ADDR_EQUAL
(
pAd
->
Tu∂eCache
[
Index
].
MacAddªss
, 
pHódî
->
Addr2
) &&

2872 (
pAd
->
Tu∂eCache
[
Index
].
Sequí˚
 =
pHódî
->Sequence) &&

2873 (
pAd
->
Tu∂eCache
[
Index
].
Føg
 =
pHódî
->Frag))

2876  (
TRUE
);

2879  (
FALSE
);

2880 
	}
}

2899 
VOID
 
	$RTMPUpd©eTu∂eCache
(

2900 
IN
 
PRTMP_ADAPTER
 
pAd
,

2901 
IN
 
PHEADER_802_11
 
pHódî
)

2903 
UCHAR
 
Index
;

2905 
Index
 = 0; Index < 
MAX_CLIENT
; Index++)

2907 i‡(
pAd
->
Tu∂eCache
[
Index
].
VÆid
 =
FALSE
)

2910 
	`COPY_MAC_ADDR
(
pAd
->
Tu∂eCache
[
Index
].
MacAddªss
, 
pHódî
->
Addr2
);

2911 
pAd
->
Tu∂eCache
[
Index
].
Sequí˚
 = 
pHódî
->Sequence;

2912 
pAd
->
Tu∂eCache
[
Index
].
Føg
 = 
pHódî
->Frag;

2913 
pAd
->
Tu∂eCache
[
Index
].
VÆid
 = 
TRUE
;

2914 
pAd
->
Tu∂eCacheLa°Upd©eIndex
 = 
Index
;

2915 
	`DBGPRINT
(
RT_DEBUG_INFO
,"DUPCHECK - Add E¡ry %d, MAC=%02x:%02x:%02x:%02x:%02x:%02x\n", 
Index
,

2916 
pAd
->
Tu∂eCache
[
Index
].
MacAddªss
[0],ÖAd->TupleCache[Index].MacAddress[1],

2917 
pAd
->
Tu∂eCache
[
Index
].
MacAddªss
[2],ÖAd->TupleCache[Index].MacAddress[3],

2918 
pAd
->
Tu∂eCache
[
Index
].
MacAddªss
[4],ÖAd->TupleCache[Index].MacAddress[5]);

2921 i‡(
	`MAC_ADDR_EQUAL
(
pAd
->
Tu∂eCache
[
Index
].
MacAddªss
, 
pHódî
->
Addr2
))

2924 
pAd
->
Tu∂eCache
[
Index
].
Sequí˚
 = 
pHódî
->Sequence;

2925 
pAd
->
Tu∂eCache
[
Index
].
Føg
 = 
pHódî
->Frag;

2932 i‡(
Index
 =
MAX_CLIENT
)

2934 
pAd
->
Tu∂eCacheLa°Upd©eIndex
 ++;

2935 i‡(
pAd
->
Tu∂eCacheLa°Upd©eIndex
 >
MAX_CLIENT
)

2936 
pAd
->
Tu∂eCacheLa°Upd©eIndex
 = 0;

2937 
Index
 = 
pAd
->
Tu∂eCacheLa°Upd©eIndex
;

2940 
	`COPY_MAC_ADDR
(
pAd
->
Tu∂eCache
[
Index
].
MacAddªss
, 
pHódî
->
Addr2
);

2941 
pAd
->
Tu∂eCache
[
Index
].
Sequí˚
 = 
pHódî
->Sequence;

2942 
pAd
->
Tu∂eCache
[
Index
].
Føg
 = 
pHódî
->Frag;

2943 
pAd
->
Tu∂eCache
[
Index
].
VÆid
 = 
TRUE
;

2944 
	`DBGPRINT
(
RT_DEBUG_INFO
,"DUPCHECK -Ñïœ˚ E¡ry %d, MAC=%02x:%02x:%02x:%02x:%02x:%02x\n", 
Index
,

2945 
pAd
->
Tu∂eCache
[
Index
].
MacAddªss
[0],ÖAd->TupleCache[Index].MacAddress[1],

2946 
pAd
->
Tu∂eCache
[
Index
].
MacAddªss
[2],ÖAd->TupleCache[Index].MacAddress[3],

2947 
pAd
->
Tu∂eCache
[
Index
].
MacAddªss
[4],ÖAd->TupleCache[Index].MacAddress[5]);

2949 
	}
}

2972 
NDIS_STATUS
 
	$RTMPAµlyPackëFûãr
(

2973 
IN
 
PRTMP_ADAPTER
 
pAd
,

2974 
IN
 
PRXD_STRUC
 
pRxD
,

2975 
IN
 
PHEADER_802_11
 
pHódî
)

2977 
UCHAR
 
i
;

2980 i‡(
pHódî
->
FC
.
Ty≥
 =
BTYPE_MGMT
)

2981 (
NDIS_STATUS_SUCCESS
);

2984 i‡(
pAd
->
P‹tCfg
.
MicEºC¡
 >= 2)

2986 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"Rx dropped by MIC countermeasure\n");

2987 (
NDIS_STATUS_FAILURE
);

2991 i‡(
pRxD
->
U2M
)

2993 i‡(
pAd
->
bAc˚±Dúe˘
 =
FALSE
)

2995 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"Rx U2M dropped by RX_FILTER\n");

2996 (
NDIS_STATUS_FAILURE
);

3001 i‡(
pRxD
->
Bˇ°
)

3003 i‡(
pAd
->
bAc˚±Brﬂdˇ°
 =
FALSE
)

3005 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"Rx BCAST dropped by RX_FILTER\n");

3006 (
NDIS_STATUS_FAILURE
);

3014 i‡(
pRxD
->
Mˇ°
)

3016 i‡(
pAd
->
bAc˚±AŒMu…iˇ°
 =
FALSE
)

3018 i‡(
pAd
->
bAc˚±Mu…iˇ°
 =
FALSE
)

3020 
	`DBGPRINT
(
RT_DEBUG_INFO
,"Rx MCAST dropped by RX_FILTER\n");

3021 (
NDIS_STATUS_FAILURE
);

3026 
i
 = 0; i < 
pAd
->
NumbîOfMˇ°Addªs£s
; i++)

3028 i‡(
	`MAC_ADDR_EQUAL
(
pHódî
->
Addr1
, 
pAd
->
Mˇ°TabÀ
[
i
]))

3033 i‡(
i
 =
pAd
->
NumbîOfMˇ°Addªs£s
)

3035 
	`DBGPRINT
(
RT_DEBUG_INFO
,"Rx MCAST %02x:%02x:%02x:%02x:%02x:%02x dropped by RX_FILTER\n",

3036 
pHódî
->
Addr1
[0],ÖHeader->Addr1[1],ÖHeader->Addr1[2],

3037 
pHódî
->
Addr1
[3],ÖHeader->Addr1[4],ÖHeader->Addr1[5]);

3038 (
NDIS_STATUS_FAILURE
);

3042 
	`DBGPRINT
(
RT_DEBUG_INFO
,"Accept multicast %02x:%02x:%02x:%02x:%02x:%02x\n",

3043 
pHódî
->
Addr1
[0],ÖHeader->Addr1[1],ÖHeader->Addr1[2],

3044 
pHódî
->
Addr1
[3],ÖHeader->Addr1[4],ÖHeader->Addr1[5]);

3053 (
NDIS_STATUS_FAILURE
);

3055 (
NDIS_STATUS_SUCCESS
);

3056 
	}
}

3075 
NDIS_STATUS
 
	$RTMPCheckRxDes¸ùt‹
(

3076 
IN
 
PRTMP_ADAPTER
 
pAd
,

3077 
IN
 
PHEADER_802_11
 
pHódî
,

3078 
IN
 
PRXD_STRUC
 
pRxD
)

3080 
PCIPHER_KEY
 
pW∑Key
;

3083 i‡–(
pRxD
->
Crc
))

3085 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "pRxD->CrcÉrror\n")

3086  (
NDIS_STATUS_FAILURE
);

3090 i‡(
pHódî
->
FC
.
ToDs
)

3091 (
NDIS_STATUS_FAILURE
);

3102 i‡(
pRxD
->
D©aByãC¡
 > 1600)

3105  (
NDIS_STATUS_FAILURE
);

3115 i‡(
pRxD
->
CùhîEº
)

3117 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"ERROR: CRC ok but CipherErr %d (len = %d, Mcast=%d, Cipher=%s, KeyId=%d)\n",

3118 
pRxD
->
CùhîEº
,

3119 
pRxD
->
D©aByãC¡
,

3120 
pRxD
->
Mˇ°
 |ÖRxD->
Bˇ°
,

3121 
CùhîName
[
pRxD
->
CùhîAlg
],

3122 
pRxD
->
KeyIndex
);

3127 i‡(
pRxD
->
CùhîEº
 == 2)

3129 
pW∑Key
 = &
pAd
->
Sh¨edKey
[
pRxD
->
KeyIndex
];

3130 
	`RTMPRï‹tMicEº‹
(
pAd
, 
pW∑Key
);

3131 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
,"Rx MIC ValueÉrror\n");

3134 i‡((
pRxD
->
CùhîAlg
 =
CIPHER_AES
) &&

3135 (
pHódî
->
Sequí˚
 =
pAd
->
FøgFøme
.Sequence))

3140  (
NDIS_STATUS_FAILURE
);

3143  (
NDIS_STATUS_FAILURE
);

3146  (
NDIS_STATUS_SUCCESS
);

3147 
	}
}

3149 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


3150 
	$ølök_mich´l_mic_Áûuª
(
√t_devi˚
 *
dev
, 
PCIPHER_KEY
 
pW∑Key
)

3152 
iwªq_d©a
 
wrqu
;

3153 
buf
[128];

3158 i‡(
pW∑Key
->
Ty≥
 =
PAIRWISE_KEY
)

3159 
	`•rötf
(
buf
, "MLME-MICHAELMICFAILURE.indication unicast");

3161 
	`•rötf
(
buf
, "MLME-MICHAELMICFAILURE.indication broadcast");

3162 
	`mem£t
(&
wrqu
, 0, (wrqu));

3163 
wrqu
.
d©a
.
Àngth
 = 
	`°æí
(
buf
);

3165 
	`wúñess_£nd_evít
(
dev
, 
IWEVCUSTOM
, &
wrqu
, 
buf
);

3166 
	}
}

3186 
VOID
 
	$RTMPRï‹tMicEº‹
(

3187 
IN
 
PRTMP_ADAPTER
 
pAd
,

3188 
IN
 
PCIPHER_KEY
 
pW∑Key
)

3190 
ULONG
 
Now
;

3191 
UCHAR
 
uniˇ°Key
 = (
pW∑Key
->
Ty≥
 =
PAIRWISE_KEY
 ? 1:0);

3194 
NDIS_802_11_STATUS_INDICATION
 
Sètus
;

3195 
NDIS_802_11_AUTHENTICATION_REQUEST
 
Reque°
;

3196 } 
Rï‹t
;

3198 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"@@@@@@@@@@@@@ snowcarey micÉrror 1 @@@@@@@@@@@@@@@\n");

3199 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


3200 i‡(
pAd
->
P‹tCfg
.
WPA_Suµliˇ¡
 =
TRUE
) {

3202 
	`ølök_mich´l_mic_Áûuª
(
pAd
->
√t_dev
, 
pW∑Key
);

3207 
Rï‹t
.
Sètus
.
SètusTy≥
 = 
Ndis802_11SètusTy≥_Authítiˇti⁄
;

3210 i‡(
pW∑Key
->
Ty≥
 =
PAIRWISE_KEY
)

3211 
Rï‹t
.
Reque°
.
Fœgs
 = 
NDIS_802_11_AUTH_REQUEST_PAIRWISE_ERROR
;

3213 
Rï‹t
.
Reque°
.
Fœgs
 = 
NDIS_802_11_AUTH_REQUEST_GROUP_ERROR
;

3216 
	`COPY_MAC_ADDR
(
Rï‹t
.
Reque°
.
Bssid
, 
pW∑Key
->
BssId
);

3219 
Rï‹t
.
Reque°
.
Lígth
 = (
NDIS_802_11_AUTHENTICATION_REQUEST
);

3222 
Now
 = 
jiffõs
;

3223 i‡(
pAd
->
P‹tCfg
.
MicEºC¡
 == 0)

3225 
pAd
->
P‹tCfg
.
MicEºC¡
++;

3226 
pAd
->
P‹tCfg
.
La°MicEº‹Time
 = 
Now
;

3228 i‡(
pAd
->
P‹tCfg
.
MicEºC¡
 == 1)

3231 i‡((
pAd
->
P‹tCfg
.
La°MicEº‹Time
 + (60 * 
HZ
)Ë< 
Now
)

3234 
pAd
->
P‹tCfg
.
La°MicEº‹Time
 = 
Now
;

3238 
pAd
->
P‹tCfg
.
La°MicEº‹Time
 = 
Now
;

3240 
pAd
->
P‹tCfg
.
MicEºC¡
++;

3243 
	`RTUSBReje˘PídögPackës
(
pAd
);

3244 
	`RTUSBCÀ™UpD©aBulkOutQueue
(
pAd
);

3255 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"@@@@@@@@@@@@@ snowcarey micÉrror 1 @@@@@@@@@@@@@@@\n");

3256 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
OID_802_11_MIC_FAILURE_REPORT_FRAME
, 2, &
uniˇ°Key
);

3257 
	`RTUSBMlmeUp
(
pAd
);

3259 i‡(
pAd
->
P‹tCfg
.
MicEºC¡
 == 2)

3260 
	`RTMPSëTimî
(&
pAd
->
P‹tCfg
.
W∑DißssocAndBlockAssocTimî
, 100);

3262 
	}
}

3273 
VOID
 
	$RTMPSídNuŒFøme
(

3274 
IN
 
PRTMP_ADAPTER
 
pAd
,

3275 
IN
 
UCHAR
 
TxR©e
)

3277 
PTX_CONTEXT
 
pNuŒC⁄ãxt
;

3278 
PTXD_STRUC
 
pTxD
;

3279 #ifde‡
BIG_ENDIAN


3280 
PTXD_STRUC
 
pDe°TxD
;

3281 
TXD_STRUC
 
TxD
;

3283 
UCHAR
 
QueIdx
 =
QID_AC_VO
;

3284 
PHEADER_802_11
 
pHdr80211
;

3285 
ULONG
 
Tøns„rBuf„rLígth
;

3287 #ifde‡
RALINK_ATE


3288 if(
pAd
->
©e
.
Mode
 !
ATE_STASTART
)

3294 if(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_WMM_INUSED
))

3296 
QueIdx
 =
QID_AC_VO
;

3300 
QueIdx
 =
QID_AC_BE
;

3303 i‡((
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)) ||

3304 (
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
)) ||

3305 (
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) ||

3306 (
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)))

3312 i‡(((
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA
) ||

3313 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAPSK
) ||

3314 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2
) ||

3315 (
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2PSK
)

3316 #ifde‡
RALINK_WPA_SUPPLICANT_SUPPORT


3317 || (
pAd
->
P‹tCfg
.
IEEE8021X
 =
TRUE
)

3320 (
pAd
->
P‹tCfg
.
P‹tSecuªd
 =
WPA_802_1X_PORT_NOT_SECURED
))

3325 
pNuŒC⁄ãxt
 = &(
pAd
->
NuŒC⁄ãxt
);

3326 i‡(
pNuŒC⁄ãxt
->
InU£
 =
FALSE
)

3329 
pNuŒC⁄ãxt
->
InU£
 = 
TRUE
;

3332 #i‚de‡
BIG_ENDIAN


3333 
pTxD
 = (
PTXD_STRUC
Ë&
pNuŒC⁄ãxt
->
Tøns„rBuf„r
->
TxDesc
;

3335 
pDe°TxD
 = (
PTXD_STRUC
Ë&
pNuŒC⁄ãxt
->
Tøns„rBuf„r
->
TxDesc
;

3336 
TxD
 = *
pDe°TxD
;

3337 
pTxD
 = &
TxD
;

3338 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pTxD
, 
TYPE_TXD
);

3340 
	`NdisZîoMem‹y
(
pTxD
, (
TXD_STRUC
));

3342 
pHdr80211
 = (
PHEADER_802_11
Ë&
pAd
->
NuŒC⁄ãxt
.
Tøns„rBuf„r
->
u
.
NuŒFøme
;

3343 
	`MgtMacHódîInô
(
pAd
, 
pHdr80211
, 
SUBTYPE_NULL_FUNC
, 1,ÖAd->
P‹tCfg
.
Bssid
,ÖAd->PortCfg.Bssid);

3344 
pHdr80211
->
Duøti⁄
 = 
	`RTMPCÆcDuøti⁄
(
pAd
, 
TxR©e
, 14);

3345 
pHdr80211
->
FC
.
Ty≥
 = 
BTYPE_DATA
;

3346 
pHdr80211
->
FC
.
PwrMgmt
 = (
pAd
->
P‹tCfg
.
Psm
 =
PWR_SAVE
);

3349 #ifde‡
BIG_ENDIAN


3350 
	`RTMPFømeEndünCh™ge
(
pAd
, (
PUCHAR
)
pHdr80211
, 
DIR_WRITE
, 
FALSE
);

3351 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pTxD
, 
TYPE_TXD
);

3352 *
pDe°TxD
 = 
TxD
;

3353 
pTxD
 = 
pDe°TxD
;

3355 
	`RTUSBWrôeTxDes¸ùt‹
(
pAd
, 
pTxD
, 
CIPHER_NONE
, 0,0, 
FALSE
, FALSE, FALSE, 
SHORT_RETRY
,

3356 
IFS_BACKOFF
, 
TxR©e
, (
HEADER_802_11
), 
QueIdx
, 
PID_MGMT_FRAME
, 
FALSE
);

3358 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - síd NULL Fømê@%d Mbps...\n", 
R©eIdToMbps
[
TxR©e
]);

3362 
Tøns„rBuf„rLígth
 = (
TXD_STRUC
Ë+ (
HEADER_802_11
);

3363 i‡((
Tøns„rBuf„rLígth
 % 2) == 1)

3364 
Tøns„rBuf„rLígth
++;

3365 i‡((
Tøns„rBuf„rLígth
 % 
pAd
->
BulkOutMaxPackëSize
) == 0)

3366 
Tøns„rBuf„rLígth
 += 2;

3369 
pNuŒC⁄ãxt
->
BulkOutSize
 = 
Tøns„rBuf„rLígth
;

3370 
	`RTUSB_SET_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_NULL
);

3373 
	`RTUSBKickBulkOut
(
pAd
);

3374 
	}
}

3376 
VOID
 
	$RTMPSídRTSCTSFøme
(

3377 
IN
 
PRTMP_ADAPTER
 
pAd
,

3378 
IN
 
PUCHAR
 
pDA
,

3379 
IN
 
ULONG
 
NextMpduSize
,

3380 
IN
 
UCHAR
 
TxR©e
,

3381 
IN
 
UCHAR
 
RTSR©e
,

3382 
IN
 
USHORT
 
AckDuøti⁄
,

3383 
IN
 
UCHAR
 
QueIdx
,

3384 
IN
 
UCHAR
 
FømeG≠
,

3385 
IN
 
UCHAR
 
Ty≥
)

3387 
PTX_CONTEXT
 
pTxC⁄ãxt
;

3388 
PTXD_STRUC
 
pTxD
;

3389 #ifde‡
BIG_ENDIAN


3390 
PTXD_STRUC
 
pDe°TxD
;

3391 
TXD_STRUC
 
TxD
;

3393 
PRTS_FRAME
 
pRtsFøme
;

3394 
PUCHAR
 
pBuf
;

3395 
ULONG
 
Lígth
 = 0;

3396 
ULONG
 
Tøns„rBuf„rLígth
 = 0;

3397 
IrqFœgs
;

3399 i‡((
Ty≥
 !
SUBTYPE_RTS
Ë&& ( Ty≥ !
SUBTYPE_CTS
))

3401 
	`DBGPRINT
(
RT_DEBUG_WARN
, "Making RTS/CTS Frame failed,ÅypeÇot matched!\n");

3404 i‡((
Ty≥
 =
SUBTYPE_RTS
Ë&& ((*
pDA
) & 0x01))

3406 i‡((*
pDA
) & 0x01)

3409 
	`DBGPRINT
(
RT_DEBUG_INFO
,"Not use RTS FrameÅoÖroect MCAST frame\n");

3414 
	`NdisAcquúeSpöLock
(&
pAd
->
TxRögLock
, 
IrqFœgs
);

3416 
pTxC⁄ãxt
 = &
pAd
->
TxC⁄ãxt
[
QueIdx
][pAd->
NextTxIndex
[QueIdx]];

3417 i‡(
pTxC⁄ãxt
->
InU£
 =
FALSE
)

3419 
pTxC⁄ãxt
->
InU£
 = 
TRUE
;

3420 
pTxC⁄ãxt
->
La°O√
 = 
FALSE
;

3421 
pAd
->
NextTxIndex
[
QueIdx
]++;

3422 i‡(
pAd
->
NextTxIndex
[
QueIdx
] >
TX_RING_SIZE
)

3424 
pAd
->
NextTxIndex
[
QueIdx
] = 0;

3427 #i‚de‡
BIG_ENDIAN


3428 
pTxD
 = (
PTXD_STRUC
Ë&
pTxC⁄ãxt
->
Tøns„rBuf„r
->
TxDesc
;

3430 
pDe°TxD
 = (
PTXD_STRUC
Ë&
pTxC⁄ãxt
->
Tøns„rBuf„r
->
TxDesc
;

3431 
TxD
 = *
pDe°TxD
;

3432 
pTxD
 = &
TxD
;

3433 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pTxD
, 
TYPE_TXD
);

3436 
pRtsFøme
 = (
PRTS_FRAME
Ë&
pTxC⁄ãxt
->
Tøns„rBuf„r
->
u
.
RTSFøme
;

3437 
pBuf
 = (
PUCHAR
Ë
pRtsFøme
;

3439 
	`NdisZîoMem‹y
(
pRtsFøme
, (
RTS_FRAME
));

3440 
pRtsFøme
->
FC
.
Ty≥
 = 
BTYPE_CNTL
;

3442 
pRtsFøme
->
Duøti⁄
 = (2 * 
pAd
->
P‹tCfg
.
Dsifs
Ë+ 
	`RTMPCÆcDuøti⁄
’Ad, 
TxR©e
, 
NextMpduSize
Ë+ 
AckDuøti⁄
;

3448 i‡(
Ty≥
 =
SUBTYPE_RTS
)

3450 
	`DBGPRINT
(
RT_DEBUG_INFO
,"Making RTS Frame\n");

3452 
pRtsFøme
->
FC
.
SubTy≥
 = 
SUBTYPE_RTS
;

3453 
	`COPY_MAC_ADDR
(
pRtsFøme
->
Addr1
, 
pDA
);

3454 
	`COPY_MAC_ADDR
(
pRtsFøme
->
Addr2
, 
pAd
->
CuºítAddªss
);

3457 
pRtsFøme
->
Duøti⁄
 +(
pAd
->
P‹tCfg
.
Dsifs
 + 
	`RTMPCÆcDuøti⁄
’Ad, 
RTSR©e
, 14));

3459 
Lígth
 = (
RTS_FRAME
);

3461 #ifde‡
BIG_ENDIAN


3462 
	`RTMPFømeEndünCh™ge
(
pAd
, (
PUCHAR
)
pRtsFøme
, 
DIR_WRITE
, 
FALSE
);

3463 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pTxD
, 
TYPE_TXD
);

3464 *
pDe°TxD
 = 
TxD
;

3465 
pTxD
 = 
pDe°TxD
;

3467 
	`RTUSBWrôeTxDes¸ùt‹
(
pAd
, 
pTxD
, 
CIPHER_NONE
, 0,0, 
TRUE
, TRUE, 
FALSE
, 
SHORT_RETRY
,

3468 
FømeG≠
, 
RTSR©e
, 
Lígth
, 
QueIdx
, 0, 
FALSE
);

3470 i‡(
Ty≥
 =
SUBTYPE_CTS
)

3472 
	`DBGPRINT
(
RT_DEBUG_INFO
,"Making CTS-to-self Frame\n");

3473 
pRtsFøme
->
FC
.
SubTy≥
 = 
SUBTYPE_CTS
;

3474 
	`COPY_MAC_ADDR
(
pRtsFøme
->
Addr1
, 
pAd
->
CuºítAddªss
);

3476 
Lígth
 = 10;

3478 #ifde‡
BIG_ENDIAN


3479 
	`RTMPFømeEndünCh™ge
(
pAd
, (
PUCHAR
)
pRtsFøme
, 
DIR_WRITE
, 
FALSE
);

3480 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pTxD
, 
TYPE_TXD
);

3481 *
pDe°TxD
 = 
TxD
;

3482 
pTxD
 = 
pDe°TxD
;

3484 
	`RTUSBWrôeTxDes¸ùt‹
(
pAd
, 
pTxD
, 
CIPHER_NONE
, 0,0, 
FALSE
, 
TRUE
, FALSE, 
SHORT_RETRY
,

3485 
FømeG≠
, 
RTSR©e
, 
Lígth
, 
QueIdx
, 0, 
FALSE
);

3490 
Tøns„rBuf„rLígth
 = (
TXD_STRUC
Ë+ 
Lígth
;

3491 i‡((
Tøns„rBuf„rLígth
 % 2) == 1)

3492 
Tøns„rBuf„rLígth
++;

3493 i‡((
Tøns„rBuf„rLígth
 % 
pAd
->
BulkOutMaxPackëSize
) == 0)

3494 
Tøns„rBuf„rLígth
 += 2;

3497 
pTxC⁄ãxt
->
BulkOutSize
 = 
Tøns„rBuf„rLígth
;

3498 
pTxC⁄ãxt
->
bWaôögBulkOut
 = 
TRUE
;

3501 
pAd
->
TxRögTŸÆNumbî
[
QueIdx
]++;

3502 
pTxC⁄ãxt
->
La°O√
 = 
TRUE
;

3503 
	`©omic_öc
(&
pAd
->
TxCou¡
);

3504 
	`NdisRñó£SpöLock
(&
pAd
->
TxRögLock
, 
IrqFœgs
);

3505 
	`RTUSB_SET_BULK_FLAG
(
pAd
, 
fRTUSB_BULK_OUT_DATA_NORMAL
 << 
QueIdx
);

3508 
	}
}

3529 
USHORT
 
	$RTMPCÆcDuøti⁄
(

3530 
IN
 
PRTMP_ADAPTER
 
pAd
,

3531 
IN
 
UCHAR
 
R©e
,

3532 
IN
 
ULONG
 
Size
)

3534 
ULONG
 
Duøti⁄
 = 0;

3536 i‡(
R©e
 < 
RATE_FIRST_OFDM_RATE
)

3538 i‡((
R©e
 > 
RATE_1
Ë&& (
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_SHORT_PREAMBLE_INUSED
)))

3539 
Duøti⁄
 = 96;

3541 
Duøti⁄
 = 192;

3543 
Duøti⁄
 +(
USHORT
)((
Size
 << 4Ë/ 
R©eIdTo500Kbps
[
R©e
]);

3544 i‡((
Size
 << 4Ë% 
R©eIdTo500Kbps
[
R©e
])

3545 
Duøti⁄
 ++;

3549 
Duøti⁄
 = 20 + 6;

3550 
Duøti⁄
 +4 * (
USHORT
)((11 + 
Size
 * 4Ë/ 
R©eIdTo500Kbps
[
R©e
]);

3551 i‡((11 + 
Size
 * 4Ë% 
R©eIdTo500Kbps
[
R©e
])

3552 
Duøti⁄
 += 4;

3555  (
USHORT
)
Duøti⁄
;

3557 
	}
}

3590 
BOOLEAN
 
	$RTMPCheckDHCPFøme
(

3591 
IN
 
PRTMP_ADAPTER
 
pAd
,

3592 
IN
 
sk_buff
 *
pSkb
)

3594 
PUCHAR
 
pSrc
;

3595 
ULONG
 
SrcLí
 = 0;

3597 
pSrc
 = (
PVOID
)
pSkb
->
d©a
;

3598 
SrcLí
 = 
pSkb
->
Àn
;

3601 i‡(
SrcLí
 >= 13)

3603 i‡((
pSrc
[12] == 0x08) && (pSrc[13] == 0x06))

3605 
	`DBGPRINT
(
RT_DEBUG_INFO
,"RTMPCheckDHCPFrame - ARPÖacket\n");

3606  
TRUE
;

3611 i‡(
SrcLí
 >= 37)

3614 i‡((
pSrc
[35] == 0x44) && (pSrc[37] == 0x43))

3616 
	`DBGPRINT
(
RT_DEBUG_INFO
,"RTMPCheckDHCPFrame - DHCPÖacket\n");

3617  
TRUE
;

3621  
FALSE
;

3622 
	}
}

3624 #ifde‡
RALINK_ATE


3626 
VOID
 
	$ATE_RTMPSídNuŒFøme
(

3627 
IN
 
PRTMP_ADAPTER
 
pAd
)

3629 
PTXD_STRUC
 
pTxD
;

3630 
HEADER_802_11
 
Hódî_802_11
;

3632 
PTX_CONTEXT
 
pNuŒC⁄ãxt
;

3633 
UCHAR
 
QueIdx
 =
QID_AC_VO
;

3634 
ULONG
 
Tøns„rBuf„rLígth
;

3637 
QueIdx
 =
QID_AC_BE
;

3639 
pNuŒC⁄ãxt
 = &(
pAd
->
NuŒC⁄ãxt
);

3640 i‡(
pNuŒC⁄ãxt
->
InU£
 =
FALSE
)

3643 
pNuŒC⁄ãxt
->
InU£
 = 
TRUE
;

3646 
	`NdisZîoMem‹y
(&
Hódî_802_11
, (
HEADER_802_11
));

3647 
	`NdisMoveMem‹y
(&
Hódî_802_11
.
Addr1
, 
pAd
->
©e
.Addr1, 
ETH_LENGTH_OF_ADDRESS
);

3648 
	`NdisMoveMem‹y
(&
Hódî_802_11
.
Addr2
, 
pAd
->
©e
.Addr2, 
ETH_LENGTH_OF_ADDRESS
);

3649 
	`NdisMoveMem‹y
(&
Hódî_802_11
.
Addr3
, 
pAd
->
©e
.Addr3, 
ETH_LENGTH_OF_ADDRESS
);

3650 
Hódî_802_11
.
Sequí˚
 = 
pAd
->Sequence;

3651 
Hódî_802_11
.
FC
.
Ty≥
 = 
BTYPE_DATA
;

3652 
Hódî_802_11
.
FC
.
PwrMgmt
 = 0;

3653 
Hódî_802_11
.
Føg
 = 0;

3654 
Hódî_802_11
.
FC
.
M‹eFøg
 = 0;

3655 
Hódî_802_11
.
Duøti⁄
 = 0;

3657 
pTxD
 = (
PTXD_STRUC
Ë&
pNuŒC⁄ãxt
->
Tøns„rBuf„r
->
TxDesc
;

3658 
	`NdisZîoMem‹y
(
pTxD
, (
PTXD_STRUC
));

3659 
	`NdisMoveMem‹y
(&
pNuŒC⁄ãxt
->
Tøns„rBuf„r
->
u
.
NuŒFøme
, &
Hódî_802_11
, (Header_802_11));

3662 
	`RTUSBWrôeTxDes¸ùt‹
(
pAd
, 
pTxD
, 
CIPHER_NONE
, 0,0, 
FALSE
, FALSE, FALSE, 
SHORT_RETRY
, 
IFS_BACKOFF
, (
UCHAR
ÌAd->
©e
.
TxR©e
,ÖAd->©e.
TxLígth
, 
QID_AC_BE
, 
PID_NULL_AT_HIGH_RATE
, FALSE);

3666 
Tøns„rBuf„rLígth
 = (
pAd
->
©e
.
TxLígth
-((
TXD_STRUC
Ë+ (
HEADER_802_11
))+((TXD_STRUC) + (HEADER_802_11)));

3668 i‡((
Tøns„rBuf„rLígth
 % 4) == 1)

3669 
Tøns„rBuf„rLígth
 += 3;

3670 i‡((
Tøns„rBuf„rLígth
 % 4) == 2)

3671 
Tøns„rBuf„rLígth
 += 2;

3672 i‡((
Tøns„rBuf„rLígth
 % 4) == 3)

3673 
Tøns„rBuf„rLígth
 += 1;

3675 i‡((
Tøns„rBuf„rLígth
 % 
pAd
->
BulkOutMaxPackëSize
) == 0)

3676 
Tøns„rBuf„rLígth
 += 4;

3679 
pNuŒC⁄ãxt
->
BulkOutSize
 = 
Tøns„rBuf„rLígth
;

3681 
	}
}

	@rtusb_io.c

39 
	~"π_c⁄fig.h
"

54 
NTSTATUS
 
	$RTUSBFúmw¨eRun
(

55 
IN
 
PRTMP_ADAPTER
 
pAd
)

57 
NTSTATUS
 
Sètus
;

59 
Sètus
 = 
	`RTUSB_Víd‹Reque°
(

60 
pAd
,

62 
DEVICE_VENDOR_REQUEST_OUT
,

66 
NULL
,

69  
Sètus
;

70 
	}
}

85 
NTSTATUS
 
	$RTUSBMu…iRód
(

86 
IN
 
PRTMP_ADAPTER
 
pAd
,

87 
IN
 
USHORT
 
Off£t
,

88 
OUT
 
PUCHAR
 
pD©a
,

89 
IN
 
USHORT
 
Àngth
)

91 
NTSTATUS
 
Sètus
;

93 
waô_queue_hód_t
 
waô
;

94 
	`öô_waôqueue_hód
(&
waô
);

96 ;
pAd
->
MacRegWrôe_Pro˚ssög
==1;)

97 
	`waô_evít_öãºu±ibÀ_timeout
(
waô
,0,1);

98 
	`RTUSBMacRegDown
(
pAd
);

101 
Sètus
 = 
	`RTUSB_Víd‹Reque°
(

102 
pAd
,

104 
DEVICE_VENDOR_REQUEST_IN
,

107 
Off£t
,

108 
pD©a
,

109 
Àngth
);

112 
	`RTUSBMacRegUp
(
pAd
);

114  
Sètus
;

115 
	}
}

117 
NTSTATUS
 
	$RTUSBSögÀWrôe
(

118 
IN
 
PRTMP_ADAPTER
 
pAd
,

119 
IN
 
USHORT
 
Off£t
,

120 
IN
 
USHORT
 
VÆue
)

124 
NTSTATUS
 
°©us
;

126 
°©us
 = 
	`RTUSB_Víd‹Reque°
(
pAd
,

128 
DEVICE_VENDOR_REQUEST_OUT
,

130 
VÆue
,

131 
Off£t
,

132 
NULL
,

136  
°©us
;

137 
	}
}

153 
NTSTATUS
 
	$RTUSBMu…iWrôe
(

154 
IN
 
PRTMP_ADAPTER
 
pAd
,

155 
IN
 
USHORT
 
Off£t
,

156 
IN
 
PUCHAR
 
pD©a
,

157 
IN
 
USHORT
 
Àngth
)

159 
NTSTATUS
 
Sètus
;

160 
USHORT
 
ödex
 = 0,
VÆue
;

161 
PUCHAR
 
pSrc
 = 
pD©a
;

162 
USHORT
 
ªsude
 = 0;

164 
waô_queue_hód_t
 
waô
;

165 
	`öô_waôqueue_hód
(&
waô
);

167 ;
pAd
->
MacRegWrôe_Pro˚ssög
==1;)

168 
	`waô_evít_öãºu±ibÀ_timeout
(
waô
,0,
HZ
/1000);

170 
	`RTUSBMacRegDown
(
pAd
);

171 
ªsude
 = 
Àngth
 % 2;

172 
Àngth
 +
ªsude
 ;

176 
VÆue
 =(
USHORT
)–*
pSrc
 | (*(pSrc + 1) << 8));

177 
Sètus
 = 
	`RTUSBSögÀWrôe
(
pAd
,
Off£t
 + 
ödex
,
VÆue
);

178 
ödex
 +=2;

179 
Àngth
 -= 2;

180 
pSrc
 =ÖSrc + 2;

181 }
Àngth
 > 0);

183 
	`RTUSBMacRegUp
(
pAd
);

184  
Sètus
;

185 
	}
}

200 
NTSTATUS
 
	$RTUSBRódMACRegi°î
(

201 
IN
 
PRTMP_ADAPTER
 
pAd
,

202 
IN
 
USHORT
 
Off£t
,

203 
OUT
 
PULONG
 
pVÆue
)

205 
NTSTATUS
 
Sètus
;

206 #ifde‡
BIG_ENDIAN


207 
ULONG
 
VÆue_Big
;

210 
waô_queue_hód_t
 
waô
;

211 
	`öô_waôqueue_hód
(&
waô
);

213 ;
pAd
->
MacRegWrôe_Pro˚ssög
==1;)

214 
	`waô_evít_öãºu±ibÀ_timeout
(
waô
,0,1);

216 
	`RTUSBMacRegDown
(
pAd
);

218 #ifde‡
BIG_ENDIAN


219 
Sètus
 = 
	`RTUSB_Víd‹Reque°
(

220 
pAd
,

222 
DEVICE_VENDOR_REQUEST_IN
,

225 
Off£t
,

226 &
VÆue_Big
,

229 *
pVÆue
 = 
	`SWAP32
(
VÆue_Big
);

231 
Sètus
 = 
	`RTUSB_Víd‹Reque°
(

232 
pAd
,

234 
DEVICE_VENDOR_REQUEST_IN
,

237 
Off£t
,

238 
pVÆue
,

242 
	`RTUSBMacRegUp
(
pAd
);

244  
Sètus
;

245 
	}
}

260 
NTSTATUS
 
	$RTUSBWrôeMACRegi°î
(

261 
IN
 
PRTMP_ADAPTER
 
pAd
,

262 
IN
 
USHORT
 
Off£t
,

263 
IN
 
ULONG
 
VÆue
)

265 
NTSTATUS
 
Sètus
;

267 
USHORT
 
va1
;

268 
USHORT
 
va2
;

270 
waô_queue_hód_t
 
waô
;

272 
	`öô_waôqueue_hód
(&
waô
);

274 ;
pAd
->
MacRegWrôe_Pro˚ssög
==1;)

275 
	`waô_evít_öãºu±ibÀ_timeout
(
waô
,0,1);

277 
	`RTUSBMacRegDown
(
pAd
);

279 
va1
=(
USHORT
)(
VÆue
 & 0xffff);

280 
va2
=(
USHORT
)((
VÆue
 & 0xffff0000) >> 16);

281 
Sètus
 = 
	`RTUSBSögÀWrôe
(
pAd
, 
Off£t
, 
va1
);

282 
Sètus
 = 
	`RTUSBSögÀWrôe
(
pAd
, 
Off£t
 + 2, 
va2
);

283 
	`RTUSBMacRegUp
(
pAd
);

284  
Sètus
;

287 
	}
}

302 
NTSTATUS
 
	$RTUSBSëLED
(

303 
IN
 
PRTMP_ADAPTER
 
pAd
,

304 
IN
 
MCU_LEDCS_STRUC
 
LedSètus
,

305 
IN
 
USHORT
 
LedIndiˇt‹Såígth
)

307 
NTSTATUS
 
Sètus
;

309 
waô_queue_hód_t
 
waô
;

310 
	`öô_waôqueue_hód
(&
waô
);

312 ;
pAd
->
MacRegWrôe_Pro˚ssög
==1;)

313 
	`waô_evít_öãºu±ibÀ_timeout
(
waô
,0,1);

315 
	`RTUSBMacRegDown
(
pAd
);

317 
Sètus
 = 
	`RTUSB_Víd‹Reque°
(

318 
pAd
,

320 
DEVICE_VENDOR_REQUEST_OUT
,

322 
LedSètus
.
w‹d
,

323 
LedIndiˇt‹Såígth
,

324 
NULL
,

326 
	`RTUSBMacRegUp
(
pAd
);

327  
Sètus
;

328 
	}
}

343 
NTSTATUS
 
	$RTUSBRódBBPRegi°î
(

344 
IN
 
PRTMP_ADAPTER
 
pAd
,

345 
IN
 
UCHAR
 
Id
,

346 
IN
 
PUCHAR
 
pVÆue
)

348 
PHY_CSR3_STRUC
 
PhyC§3
;

349 
UINT
 
i
 = 0;

354 
	`RTUSBRódMACRegi°î
(
pAd
, 
PHY_CSR3
, &
PhyC§3
.
w‹d
);

355 i‡(!(
PhyC§3
.
fõld
.
Busy
 =
BUSY
))

357 
i
++;

359 (
i
 < 
RETRY_LIMIT
Ë&& (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)));

361 i‡((
i
 =
RETRY_LIMIT
Ë|| (
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)))

366 *
pVÆue
 = 
pAd
->
BbpWrôeL©ch
[
Id
];

368 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "Retry countÉxhausted or deviceÑemoved!!!\n");

369  
STATUS_UNSUCCESSFUL
;

373 
PhyC§3
.
w‹d
 = 0;

374 
PhyC§3
.
fõld
.
fRód
 = 1;

375 
PhyC§3
.
fõld
.
Busy
 = 1;

376 
PhyC§3
.
fõld
.
RegNum
 = 
Id
;

377 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
PHY_CSR3
, 
PhyC§3
.
w‹d
);

379 
i
 = 0;

383 
	`RTUSBRódMACRegi°î
(
pAd
, 
PHY_CSR3
, &
PhyC§3
.
w‹d
);

384 i‡(!(
PhyC§3
.
fõld
.
Busy
 =
BUSY
))

386 *
pVÆue
 = (
UCHAR
)
PhyC§3
.
fõld
.
VÆue
;

389 
i
++;

391 (
i
 < 
RETRY_LIMIT
Ë&& (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)));

393 i‡((
i
 =
RETRY_LIMIT
Ë|| (
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)))

398 *
pVÆue
 = 
pAd
->
BbpWrôeL©ch
[
Id
];

400 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "Retry countÉxhausted or deviceÑemoved!!!\n");

401  
STATUS_UNSUCCESSFUL
;

404  
STATUS_SUCCESS
;

405 
	}
}

420 
NTSTATUS
 
	$RTUSBWrôeBBPRegi°î
(

421 
IN
 
PRTMP_ADAPTER
 
pAd
,

422 
IN
 
UCHAR
 
Id
,

423 
IN
 
UCHAR
 
VÆue
)

425 
PHY_CSR3_STRUC
 
PhyC§3
;

426 
UINT
 
i
 = 0;

431 
	`RTUSBRódMACRegi°î
(
pAd
, 
PHY_CSR3
, &
PhyC§3
.
w‹d
);

432 i‡(!(
PhyC§3
.
fõld
.
Busy
 =
BUSY
))

434 
i
++;

436 (
i
 < 
RETRY_LIMIT
Ë&& (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)));

438 i‡((
i
 =
RETRY_LIMIT
Ë|| (
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)))

440 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "Retry countÉxhausted or deviceÑemoved!!!\n");

441  
STATUS_UNSUCCESSFUL
;

445 
PhyC§3
.
w‹d
 = 0;

446 
PhyC§3
.
fõld
.
fRód
 = 0;

447 
PhyC§3
.
fõld
.
VÆue
 = Value;

448 
PhyC§3
.
fõld
.
Busy
 = 1;

449 
PhyC§3
.
fõld
.
RegNum
 = 
Id
;

450 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
PHY_CSR3
, 
PhyC§3
.
w‹d
);

452 
pAd
->
BbpWrôeL©ch
[
Id
] = 
VÆue
;

454  
STATUS_SUCCESS
;

455 
	}
}

470 
NTSTATUS
 
	$RTUSBWrôeRFRegi°î
(

471 
IN
 
PRTMP_ADAPTER
 
pAd
,

472 
IN
 
ULONG
 
VÆue
)

474 
PHY_CSR4_STRUC
 
PhyC§4
;

475 
UINT
 
i
 = 0;

479 
	`RTUSBRódMACRegi°î
(
pAd
, 
PHY_CSR4
, &
PhyC§4
.
w‹d
);

480 i‡(!(
PhyC§4
.
fõld
.
Busy
))

482 
i
++;

484 (
i
 < 
RETRY_LIMIT
Ë&& (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)));

486 i‡((
i
 =
RETRY_LIMIT
Ë|| (
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)))

488 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "Retry countÉxhausted or deviceÑemoved!!!\n");

489  
STATUS_UNSUCCESSFUL
;

492 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
PHY_CSR4
, 
VÆue
);

494  
STATUS_SUCCESS
;

495 
	}
}

510 
NTSTATUS
 
	$RTUSBRódEEPROM
(

511 
IN
 
PRTMP_ADAPTER
 
pAd
,

512 
IN
 
USHORT
 
Off£t
,

513 
OUT
 
PUCHAR
 
pD©a
,

514 
IN
 
USHORT
 
Àngth
)

516 
NTSTATUS
 
Sètus
;

518 
Sètus
 = 
	`RTUSB_Víd‹Reque°
(

519 
pAd
,

521 
DEVICE_VENDOR_REQUEST_IN
,

524 
Off£t
,

525 
pD©a
,

526 
Àngth
);

528  
Sètus
;

529 
	}
}

544 
NTSTATUS
 
	$RTUSBWrôeEEPROM
(

545 
IN
 
PRTMP_ADAPTER
 
pAd
,

546 
IN
 
USHORT
 
Off£t
,

547 
IN
 
PUCHAR
 
pD©a
,

548 
IN
 
USHORT
 
Àngth
)

550 
NTSTATUS
 
Sètus
;

552 
waô_queue_hód_t
 
waô
;

554 
	`öô_waôqueue_hód
(&
waô
);

556 ;
pAd
->
MacRegWrôe_Pro˚ssög
==1;)

557 
	`waô_evít_öãºu±ibÀ_timeout
(
waô
,0,1);

559 
	`RTUSBMacRegDown
(
pAd
);

561 
Sètus
 = 
	`RTUSB_Víd‹Reque°
(

562 
pAd
,

564 
DEVICE_VENDOR_REQUEST_OUT
,

567 
Off£t
,

568 
pD©a
,

569 
Àngth
);

570 
	`RTUSBMacRegUp
(
pAd
);

571  
Sètus
;

572 
	}
}

587 
NTSTATUS
 
	$RTUSBPutToSÀï
(

588 
IN
 
PRTMP_ADAPTER
 
pAd
)

590 
NTSTATUS
 
Sètus
;

592 
waô_queue_hód_t
 
waô
;

594 
	`öô_waôqueue_hód
(&
waô
);

596 ;
pAd
->
MacRegWrôe_Pro˚ssög
==1;)

597 
	`waô_evít_öãºu±ibÀ_timeout
(
waô
,0,1);

599 
	`RTUSBMacRegDown
(
pAd
);

601 
Sètus
 = 
	`RTUSB_Víd‹Reque°
(

602 
pAd
,

604 
DEVICE_VENDOR_REQUEST_OUT
,

608 
NULL
,

610 
	`RTUSBMacRegUp
(
pAd
);

611  
Sètus
;

612 
	}
}

627 
NTSTATUS
 
	$RTUSBWakeUp
(

628 
IN
 
PRTMP_ADAPTER
 
pAd
)

630 
NTSTATUS
 
Sètus
;

632 
waô_queue_hód_t
 
waô
;

634 
	`öô_waôqueue_hód
(&
waô
);

636 ;
pAd
->
MacRegWrôe_Pro˚ssög
==1;)

637 
	`waô_evít_öãºu±ibÀ_timeout
(
waô
,0,1);

639 
	`RTUSBMacRegDown
(
pAd
);

641 
Sètus
 = 
	`RTUSB_Víd‹Reque°
(

642 
pAd
,

644 
DEVICE_VENDOR_REQUEST_OUT
,

648 
NULL
,

650 
	`RTUSBMacRegUp
(
pAd
);

651  
Sètus
;

652 
	}
}

667 
VOID
 
	$RTUSBInôülizeCmdQ
(

668 
IN
 
PCmdQ
 
cmdq
)

670 
cmdq
->
hód
 = 
NULL
;

671 
cmdq
->
èû
 = 
NULL
;

672 
cmdq
->
size
 = 0;

673 
	}
}

688 
NDIS_STATUS
 
	$RTUSBEnqueueCmdFromNdis
(

689 
IN
 
PRTMP_ADAPTER
 
pAd
,

690 
IN
 
NDIS_OID
 
Oid
,

691 
IN
 
BOOLEAN
 
SëInf‹m©i⁄
,

692 
IN
 
PVOID
 
pInf‹m©i⁄Buf„r
,

693 
IN
 
ULONG
 
Inf‹m©i⁄Buf„rLígth
)

695 
PCmdQElmt
 
cmdqñmt
 = 
NULL
;

696 
IrqFœgs
;

698 i‡(
pAd
->
RTUSBCmdThr_pid
 < 0)

699  (
NDIS_STATUS_RESOURCES
);

701 
cmdqñmt
 = (
PCmdQElmt
Ë
	`kmÆloc
((
CmdQElmt
), 
MEM_ALLOC_FLAG
);

702 i‡(!
cmdqñmt
)

704 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"NotÉnough memory\n");

705 
	`k‰ì
((
PCmdQElmt
)
cmdqñmt
);

706  
NDIS_STATUS_RESOURCES
;

709 i‡((
Oid
 =
RT_OID_MULTI_READ_MAC
) ||

710 (
Oid
 =
RT_OID_VENDOR_READ_BBP
) ||

711 #ifde‡
DBG


712 (
Oid
 =
RT_OID_802_11_QUERY_HARDWARE_REGISTER
) ||

714 (
Oid
 =
RT_OID_USB_VENDOR_EEPROM_READ
))

716 
cmdqñmt
->
buf„r
 = 
pInf‹m©i⁄Buf„r
;

720 
cmdqñmt
->
buf„r
 = 
NULL
;

721 i‡(
pInf‹m©i⁄Buf„r
 !
NULL
)

723 
cmdqñmt
->
buf„r
 = 
	`kmÆloc
(
Inf‹m©i⁄Buf„rLígth
, 
MEM_ALLOC_FLAG
);

724 i‡((!
cmdqñmt
->
buf„r
) )

726 
	`k‰ì
((
PVOID
)
cmdqñmt
->
buf„r
);

727 
	`k‰ì
((
PCmdQElmt
)
cmdqñmt
);

728  (
NDIS_STATUS_RESOURCES
);

732 
	`NdisMoveMem‹y
(
cmdqñmt
->
buf„r
, 
pInf‹m©i⁄Buf„r
, 
Inf‹m©i⁄Buf„rLígth
);

733 
cmdqñmt
->
buf„æígth
 = 
Inf‹m©i⁄Buf„rLígth
;

737 
cmdqñmt
->
buf„æígth
 = 0;

740 
cmdqñmt
->
comm™d
 = 
Oid
;

741 
cmdqñmt
->
CmdFromNdis
 = 
TRUE
;

742 i‡(
SëInf‹m©i⁄
 =
TRUE
)

743 
cmdqñmt
->
SëO≥øti⁄
 = 
TRUE
;

745 
cmdqñmt
->
SëO≥øti⁄
 = 
FALSE
;

747 
	`NdisAcquúeSpöLock
(&
pAd
->
CmdQLock
, 
IrqFœgs
);

748 
	`EnqueueCmd
((&
pAd
->
CmdQ
), 
cmdqñmt
);

749 
	`NdisRñó£SpöLock
(&
pAd
->
CmdQLock
, 
IrqFœgs
);

751 
	`RTUSBCMDUp
(
pAd
);

753 i‡((
Oid
 =
OID_802_11_BSSID_LIST_SCAN
) ||

754 (
Oid
 =
RT_OID_802_11_BSSID
) ||

755 (
Oid
 =
OID_802_11_SSID
) ||

756 (
Oid
 =
OID_802_11_DISASSOCIATE
))

758 (
NDIS_STATUS_SUCCESS
);

761 (
NDIS_STATUS_SUCCESS
);

762 
	}
}

777 
VOID
 
	$RTUSBEnqueueI¡î«lCmd
(

778 
IN
 
PRTMP_ADAPTER
 
pAd
,

779 
IN
 
NDIS_OID
 
Oid
)

781 
PCmdQElmt
 
cmdqñmt
 = 
NULL
;

782 
IrqFœgs
;

784 i‡(
pAd
->
RTUSBCmdThr_pid
 < 0)

787 
Oid
)

789 
RT_OID_CHECK_GPIO
:

790 
cmdqñmt
 = &(
pAd
->
CmdQEÀmíts
[
CMD_CHECK_GPIO
]);

793 
RT_OID_PERIODIC_EXECUT
:

794 
cmdqñmt
 = &(
pAd
->
CmdQEÀmíts
[
CMD_PERIODIC_EXECUT
]);

798 
RT_OID_ASICLED_EXECUT
:

799 
cmdqñmt
 = &(
pAd
->
CmdQEÀmíts
[
CMD_ASICLED_EXECUT
]);

802 
RT_OID_UPDATE_TX_RATE
:

803 
cmdqñmt
 = &(
pAd
->
CmdQEÀmíts
[
CMD_UPDATE_TX_RATE
]);

806 
RT_OID_SET_PSM_BIT_SAVE
:

807 
cmdqñmt
 = &(
pAd
->
CmdQEÀmíts
[
CMD_SET_PSM_SAVE
]);

810 
RT_OID_LINK_DOWN
:

811 
cmdqñmt
 = &(
pAd
->
CmdQEÀmíts
[
CMD_LINK_DOWN
]);

814 
RT_OID_USB_RESET_BULK_IN
:

815 
cmdqñmt
 = &(
pAd
->
CmdQEÀmíts
[
CMD_RESET_BULKIN
]);

818 
RT_OID_USB_RESET_BULK_OUT
:

819 
cmdqñmt
 = &(
pAd
->
CmdQEÀmíts
[
CMD_RESET_BULKOUT
]);

822 
RT_OID_RESET_FROM_ERROR
:

823 
cmdqñmt
 = &(
pAd
->
CmdQEÀmíts
[
CMD_RESET_FROM_ERROR
]);

826 
RT_OID_RESET_FROM_NDIS
:

827 
cmdqñmt
 = &(
pAd
->
CmdQEÀmíts
[
CMD_RESET_FROM_NDIS
]);

830 
RT_PERFORM_SOFT_DIVERSITY
:

831 
cmdqñmt
 = &(
pAd
->
CmdQEÀmíts
[
CMD_SOFT_DIVERSITY
]);

834 
RT_OID_FORCE_WAKE_UP
:

835 
cmdqñmt
 = &(
pAd
->
CmdQEÀmíts
[
CMD_FORCE_WAKEUP
]);

838 
RT_OID_SET_PSM_BIT_ACTIVE
:

839 
cmdqñmt
 = &(
pAd
->
CmdQEÀmíts
[
CMD_SET_PSM_ACTIVE
]);

846 i‡((
cmdqñmt
 !
NULL
Ë&& (cmdqñmt->
InU£
 =
FALSE
Ë&& (
pAd
->
RTUSBCmdThr_pid
 > 0))

848 
cmdqñmt
->
InU£
 = 
TRUE
;

849 
cmdqñmt
->
comm™d
 = 
Oid
;

851 
	`NdisAcquúeSpöLock
(&
pAd
->
CmdQLock
, 
IrqFœgs
);

852 
	`EnqueueCmd
((&
pAd
->
CmdQ
), 
cmdqñmt
);

853 
	`NdisRñó£SpöLock
(&
pAd
->
CmdQLock
, 
IrqFœgs
);

855 
	`RTUSBCMDUp
(
pAd
);

857 
	}
}

872 
VOID
 
	$RTUSBDequeueCmd
(

873 
IN
 
PCmdQ
 
cmdq
,

874 
OUT
 
PCmdQElmt
 *
pcmdqñmt
)

876 *
pcmdqñmt
 = 
cmdq
->
hód
;

878 i‡(*
pcmdqñmt
 !
NULL
)

880 
cmdq
->
hód
 = cmdq->hód->
√xt
;

881 
cmdq
->
size
--;

882 i‡(
cmdq
->
size
 == 0)

883 
cmdq
->
èû
 = 
NULL
;

885 
	}
}

924 
INT
 
	$RTUSB_Víd‹Reque°
(

925 
IN
 
PRTMP_ADAPTER
 
pAd
,

926 
IN
 
ULONG
 
Tøns„rFœgs
,

927 
IN
 
UCHAR
 
Reque°Ty≥
,

928 
IN
 
UCHAR
 
Reque°
,

929 
IN
 
USHORT
 
VÆue
,

930 
IN
 
USHORT
 
Index
,

931 
IN
 
PVOID
 
Tøns„rBuf„r
,

932 
IN
 
ULONG
 
Tøns„rBuf„rLígth
)

934 
ªt
;

935 
RëryC¡
;

937 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
))

939 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"device disconnected\n");

942 i‡(
	`ö_öãºu±
())

944 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"in_interrupt,Ñeturn RTUSB_VendorRequest\n");

950 
RëryC¡
 = 0;

953 if–
Reque°Ty≥
 =
DEVICE_VENDOR_REQUEST_OUT
)

954 
ªt
=
	`usb_c⁄åﬁ_msg
(
pAd
->
pUsb_Dev
, 
	`usb_¢d˘æpùe
–pAd->pUsb_Dev, 0 ), 
Reque°
, 
Reque°Ty≥
, 
VÆue
,
Index
, 
Tøns„rBuf„r
, 
Tøns„rBuf„rLígth
, 
CONTROL_TIMEOUT_JIFFIES
);

955 if(
Reque°Ty≥
 =
DEVICE_VENDOR_REQUEST_IN
)

956 
ªt
=
	`usb_c⁄åﬁ_msg
(
pAd
->
pUsb_Dev
, 
	`usb_rcv˘æpùe
–pAd->pUsb_Dev, 0 ), 
Reque°
, 
Reque°Ty≥
, 
VÆue
,
Index
, 
Tøns„rBuf„r
, 
Tøns„rBuf„rLígth
, 
CONTROL_TIMEOUT_JIFFIES
);

959 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"vendorÑequest direction is failed\n");

960 
ªt
 = -1;

963 
	`DBGPRINT
(
RT_DEBUG_INFO
,"%x\t%x\t%x\t%x\n",
Reque°
,
Reque°Ty≥
,
VÆue
,
Index
);

965 if–
ªt
 >= 0)

968 
	`RTMPu£cDñay
(50 * 1000);

969 } 
RëryC¡
++ < 5);

971 i‡(
ªt
 < 0)

972 
	`DBGPRINT
(
RT_DEBUG_ERROR
,"USBVíd‹Reque° faûedÑë=%d \n",
ªt
);

974  
ªt
;

975 
	}
}

993 
NTSTATUS
 
	$RTUSB_Re£tDevi˚
(

994 
IN
 
PRTMP_ADAPTER
 
pAd
)

996 
NTSTATUS
 
Sètus
 = 
TRUE
;

998 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "--->USB_ResetDevice\n");

1000  
Sètus
;

1001 
	}
}

1003 
VOID
 
	$CMDH™dÀr
(

1004 
IN
 
PRTMP_ADAPTER
 
pAd
)

1006 
PCmdQElmt
 
cmdqñmt
;

1007 
PUCHAR
 
pD©a
;

1008 
NDIS_STATUS
 
NdisSètus
 = 
NDIS_STATUS_SUCCESS
;

1009 
IrqFœgs
;

1010 
ULONG
 
Now
;

1012 
pAd
->
CmdQ
.
size
 > 0)

1014 
NdisSètus
 = 
NDIS_STATUS_SUCCESS
;

1015 
	`NdisAcquúeSpöLock
(&
pAd
->
CmdQLock
, 
IrqFœgs
);

1016 
	`RTUSBDequeueCmd
(&
pAd
->
CmdQ
, &
cmdqñmt
);

1017 
	`NdisRñó£SpöLock
(&
pAd
->
CmdQLock
, 
IrqFœgs
);

1018 i‡(
cmdqñmt
 =
NULL
)

1020 
pD©a
 = 
cmdqñmt
->
buf„r
;

1023 
cmdqñmt
->
comm™d
)

1025 
RT_OID_CHECK_GPIO
:

1027 
ULONG
 
d©a
;

1029 
	`RTUSBRódMACRegi°î
(
pAd
, 
MAC_CSR13
, &
d©a
);

1030 i‡(
d©a
 & 0x80)

1032 
pAd
->
P‹tCfg
.
bHwRadio
 = 
TRUE
;

1036 
pAd
->
P‹tCfg
.
bHwRadio
 = 
FALSE
;

1038 i‡(
pAd
->
P‹tCfg
.
bRadio
 !’Ad->P‹tCfg.
bHwRadio
 &&ÖAd->P‹tCfg.
bSwRadio
))

1040 
pAd
->
P‹tCfg
.
bRadio
 = (pAd->P‹tCfg.
bHwRadio
 &&ÖAd->P‹tCfg.
bSwRadio
);

1041 i‡(
pAd
->
P‹tCfg
.
bRadio
 =
TRUE
)

1043 
	`MlmeRadioOn
(
pAd
);

1045 
pAd
->
ExåaInfo
 = 
EXTRA_INFO_CLEAR
;

1049 
	`MlmeRadioOff
(
pAd
);

1051 
pAd
->
ExåaInfo
 = 
HW_RADIO_OFF
;

1057 
RT_OID_PERIODIC_EXECUT
:

1059 
	`STAMlmePîiodicExec
(
pAd
);

1062 
OID_802_11_BSSID_LIST_SCAN
:

1064 i‡(
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 !
CNTL_IDLE
)

1066 
	`MlmeEnqueue
(
pAd
,

1067 
MLME_CNTL_STATE_MACHINE
,

1068 
RT_CMD_RESET_MLME
,

1070 
NULL
);

1073 
Now
 = 
jiffõs
;

1075 
pAd
->
P‹tCfg
.
SˇnC¡
 = 0;

1076 
pAd
->
P‹tCfg
.
La°SˇnTime
 = 
Now
;

1077 
	`MlmeEnqueue
(
pAd
,

1078 
MLME_CNTL_STATE_MACHINE
,

1079 
OID_802_11_BSSID_LIST_SCAN
,

1081 
NULL
);

1082 
	`RTUSBMlmeUp
(
pAd
);

1086 
RT_OID_802_11_BSSID
:

1089 i‡(
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 !
CNTL_IDLE
)

1091 
	`MlmeEnqueue
(
pAd
,

1092 
MLME_CNTL_STATE_MACHINE
,

1093 
RT_CMD_RESET_MLME
,

1095 
NULL
);

1099 
pAd
->
P‹tCfg
.
SˇnC¡
 = 0;

1101 
	`MlmeEnqueue
(
pAd
,

1102 
MLME_CNTL_STATE_MACHINE
,

1103 
OID_802_11_BSSID
,

1104 
cmdqñmt
->
buf„æígth
,

1105 
cmdqñmt
->
buf„r
);

1106 
	`RTUSBMlmeUp
(
pAd
);

1110 
OID_802_11_SSID
:

1112 i‡(
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 !
CNTL_IDLE
)

1114 
	`MlmeEnqueue
(
pAd
,

1115 
MLME_CNTL_STATE_MACHINE
,

1116 
RT_CMD_RESET_MLME
,

1118 
NULL
);

1123 
pAd
->
P‹tCfg
.
SˇnC¡
 = 0;

1124 
pAd
->
bC⁄figCh™ged
 = 
TRUE
;

1126 
	`MlmeEnqueue
(
pAd
,

1127 
MLME_CNTL_STATE_MACHINE
,

1128 
OID_802_11_SSID
,

1129 
cmdqñmt
->
buf„æígth
,

1130 
pD©a
);

1131 
	`RTUSBMlmeUp
(
pAd
);

1135 
OID_802_11_DISASSOCIATE
:

1137 i‡(
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 !
CNTL_IDLE
)

1139 
	`MlmeEnqueue
(
pAd
,

1140 
MLME_CNTL_STATE_MACHINE
,

1141 
RT_CMD_RESET_MLME
,

1143 
NULL
);

1147 
pAd
->
MlmeAux
.
CuºReqIsFromNdis
 = 
TRUE
;

1149 
	`MlmeEnqueue
(
pAd
,

1150 
MLME_CNTL_STATE_MACHINE
,

1151 
OID_802_11_DISASSOCIATE
,

1153 
NULL
);

1154 
	`RTUSBMlmeUp
(
pAd
);

1158 
OID_802_11_RX_ANTENNA_SELECTED
:

1161 
NDIS_802_11_ANTENNA
 
A¡í«
 = *(NDIS_802_11_ANTENNA *)
pD©a
;

1163 i‡(
A¡í«
 == 0)

1164 
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 = 1;

1165 if(
A¡í«
 == 1)

1166 
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 = 2;

1168 
pAd
->
A¡í«
.
fõld
.
RxDeÁu…A¡í«
 = 0;

1170 
pAd
->
P‹tCfg
.
B™dSèã
 = 
UNKNOWN_BAND
;

1171 
	`AsicA¡í«Sñe˘
(
pAd
,ÖAd->
L©chRfRegs
.
Ch™√l
);

1172 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CMDH™dÀr::OID_802_11_RX_ANTENNA_SELECTED (=%d)\n", 
A¡í«
);

1176 
OID_802_11_TX_ANTENNA_SELECTED
:

1178 
NDIS_802_11_ANTENNA
 
A¡í«
 = *(NDIS_802_11_ANTENNA *)
pD©a
;

1180 i‡(
A¡í«
 == 0)

1181 
pAd
->
A¡í«
.
fõld
.
TxDeÁu…A¡í«
 = 1;

1182 if(
A¡í«
 == 1)

1183 
pAd
->
A¡í«
.
fõld
.
TxDeÁu…A¡í«
 = 2;

1185 
pAd
->
A¡í«
.
fõld
.
TxDeÁu…A¡í«
 = 0;

1187 
pAd
->
P‹tCfg
.
B™dSèã
 = 
UNKNOWN_BAND
;

1188 
	`AsicA¡í«Sñe˘
(
pAd
,ÖAd->
L©chRfRegs
.
Ch™√l
);

1189 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CMDH™dÀr::OID_802_11_TX_ANTENNA_SELECTED (=%d)\n", 
A¡í«
);

1193 
RT_OID_802_11_QUERY_HARDWARE_REGISTER
:

1194 
NdisSètus
 = 
	`RTUSBQuîyH¨dW¨eRegi°î
(
pAd
, 
pD©a
);

1197 
RT_OID_802_11_SET_HARDWARE_REGISTER
:

1198 
NdisSètus
 = 
	`RTUSBSëH¨dW¨eRegi°î
(
pAd
, 
pD©a
);

1201 
RT_OID_MULTI_READ_MAC
:

1203 
USHORT
 
Off£t
 = *((
PUSHORT
)
pD©a
);

1204 
USHORT
 
Lígth
 = *((
PUSHORT
)(
pD©a
 + 2));

1205 
	`RTUSBMu…iRód
(
pAd
, 
Off£t
, 
pD©a
 + 4, 
Lígth
);

1209 
RT_OID_MULTI_WRITE_MAC
:

1211 
USHORT
 
Off£t
 = *((
PUSHORT
)
pD©a
);

1212 
USHORT
 
Lígth
 = *((
PUSHORT
)(
pD©a
 + 2));

1213 
	`RTUSBMu…iWrôe
(
pAd
, 
Off£t
, 
pD©a
 + 4, 
Lígth
);

1217 
RT_OID_USB_VENDOR_EEPROM_READ
:

1219 
USHORT
 
Off£t
 = *((
PUSHORT
)
pD©a
);

1220 
USHORT
 
Lígth
 = *((
PUSHORT
)(
pD©a
 + 2));

1221 
	`RTUSBRódEEPROM
(
pAd
, 
Off£t
, 
pD©a
 + 4, 
Lígth
);

1225 
RT_OID_USB_VENDOR_EEPROM_WRITE
:

1227 
USHORT
 
Off£t
 = *((
PUSHORT
)
pD©a
);

1229 
USHORT
 
Lígth
 = *((
PUSHORT
)(
pD©a
 + 2));

1230 
	`RTUSBWrôeEEPROM
(
pAd
, 
Off£t
, 
pD©a
 + 4, 
Lígth
);

1232 
USHORT
 
ResiduÆ
 = *((
PUSHORT
)(
pD©a
 + 2));

1233 
pD©a
 += 4;

1234 
ResiduÆ
 > 62)

1236 
	`RTUSBWrôeEEPROM
(
pAd
, 
Off£t
, 
pD©a
, 62);

1237 
Off£t
 += 62;

1238 
ResiduÆ
 -= 62;

1239 
pD©a
 += 62;

1241 
	`RTUSBWrôeEEPROM
(
pAd
, 
Off£t
, 
pD©a
, 
ResiduÆ
);

1246 
RT_OID_USB_VENDOR_ENTER_TESTMODE
:

1247 
	`RTUSB_Víd‹Reque°
(
pAd
,

1249 
DEVICE_VENDOR_REQUEST_OUT
,

1253 
NULL
,

1257 
RT_OID_USB_VENDOR_EXIT_TESTMODE
:

1258 
	`RTUSB_Víd‹Reque°
(
pAd
,

1260 
DEVICE_VENDOR_REQUEST_OUT
,

1264 
NULL
,

1267 
RT_OID_USB_RESET_BULK_OUT
:

1269 
INT
 
Index
;

1271 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "RT_OID_USB_RESET_BULK_OUT\n");

1273 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_PIPE_IN_PROGRESS
);

1275 
	`RTUSBReje˘PídögPackës
(
pAd
);

1276 
	`RTUSBC™˚lPídögBulkOutIRP
(
pAd
);

1277 
	`RTUSBCÀ™UpD©aBulkOutQueue
(
pAd
);

1279 
	`NICInôülizeAsic
(
pAd
);

1280 
	`Rñó£Ad≠ãr
(
pAd
, 
FALSE
, 
TRUE
);

1281 
	`NICInôTønsmô
(
pAd
);

1283 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_PIPE_IN_PROGRESS
);

1285 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
))

1287 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
);

1290 i‡(!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
))

1292 
Index
 = 0; Index < 4; Index++)

1294 if(
pAd
->
SídTxWaôQueue
[
Index
].
Numbî
 > 0)

1296 
	`RTMPDeQueuePackë
(
pAd
, 
Index
);

1300 
	`RTUSBKickBulkOut
(
pAd
);

1306 
RT_OID_USB_RESET_BULK_IN
:

1308 
i
;

1309 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
, "!!!!!RT_OID_USB_RESET_BULK_IN\n");

1310 
	`RTMP_SET_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_PIPE_IN_PROGRESS
);

1311 
	`NICInôülizeAsic
(
pAd
);

1313 
i
 = 0; i < 
RX_RING_SIZE
; i++)

1315 
PRX_CONTEXT
 
pRxC⁄ãxt
 = &(
pAd
->
RxC⁄ãxt
[
i
]);

1317 i‡(
pRxC⁄ãxt
->
pUrb
 !
NULL
)

1319 
	`RTUSB_UNLINK_URB
(
pRxC⁄ãxt
->
pUrb
);

1320 
	`usb_‰ì_urb
(
pRxC⁄ãxt
->
pUrb
);

1321 
pRxC⁄ãxt
->
pUrb
 = 
NULL
;

1323 i‡(
pRxC⁄ãxt
->
Tøns„rBuf„r
 !
NULL
)

1325 
	`k‰ì
(
pRxC⁄ãxt
->
Tøns„rBuf„r
);

1326 
pRxC⁄ãxt
->
Tøns„rBuf„r
 = 
NULL
;

1329 
	`NICInôRecv
(
pAd
);

1330 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_PIPE_IN_PROGRESS
);

1331 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKIN_RESET
))

1333 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKIN_RESET
);

1336 i‡(!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
))

1338 
	`RTUSBBulkRe˚ive
(
pAd
);

1339 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR0
, 0x0276b032);

1344 
RT_OID_802_11_STA_CONFIG
:

1346 
RT_802_11_STA_CONFIG
 *
pSèC⁄fig
 = (RT_802_11_STA_CONFIG *)
pD©a
;

1347 i‡(
pSèC⁄fig
->
E«bÀTxBur°
 !
pAd
->
P‹tCfg
.
bE«bÀTxBur°
)

1349 
pAd
->
P‹tCfg
.
bE«bÀTxBur°
 = (
pSèC⁄fig
->
E«bÀTxBur°
 == 1);

1351 i‡(
	`INFRA_ON
(
pAd
))

1353 i‡(
pAd
->
P‹tCfg
.
bE«bÀTxBur°
)

1356 i‡(
pAd
->
P‹tCfg
.
WïSètus
 !
Ndis802_11En¸y±i⁄DißbÀd
)

1365 i‡(
pAd
->
P‹tCfg
.
WïSètus
 !
Ndis802_11En¸y±i⁄DißbÀd
)

1366 
	`AsicSëSlŸTime
(
pAd
, (
BOOLEAN
ÌAd->
P‹tCfg
.
U£Sh‹tSlŸTime
);

1372 
pAd
->
P‹tCfg
.
U£BGPrŸe˘i⁄
 = 
pSèC⁄fig
->UseBGProtection;

1374 
pAd
->
P‹tCfg
.
U£Sh‹tSlŸTime
 = 1;

1375 i‡(
pAd
->
P‹tCfg
.
AdhocMode
 !
pSèC⁄fig
->AdhocMode)

1379 
pAd
->
P‹tCfg
.
AdhocMode
 = 
pSèC⁄fig
->AdhocMode;

1380 i‡(
pAd
->
P‹tCfg
.
BssTy≥
 =
BSS_ADHOC
)

1382 
	`MlmeUpd©eTxR©es
(
pAd
, 
FALSE
);

1383 
	`MakeIbssBóc⁄
(
pAd
);

1384 
	`AsicE«bÀIbssSync
(
pAd
);

1387 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CmdThread::RT_OID_802_11_SET_STA_CONFIG (Burst=%d,BGprot=%d,ShortSlot=%d,Adhoc=%d,Protection=%d\n",

1388 
pSèC⁄fig
->
E«bÀTxBur°
,

1389 
pSèC⁄fig
->
U£BGPrŸe˘i⁄
,

1390 
pSèC⁄fig
->
U£Sh‹tSlŸTime
,

1391 
pSèC⁄fig
->
AdhocMode
,

1392 
pAd
->
P‹tCfg
.
U£BGPrŸe˘i⁄
);

1396 
RT_OID_SET_PSM_BIT_SAVE
:

1397 
	`MlmeSëPsmBô
(
pAd
, 
PWR_SAVE
);

1398 
	`RTMPSídNuŒFøme
(
pAd
,ÖAd->
P‹tCfg
.
TxR©e
);

1401 
RT_OID_SET_RADIO
:

1402 i‡(
pAd
->
P‹tCfg
.
bRadio
 =
TRUE
)

1404 
	`MlmeRadioOn
(
pAd
);

1406 
pAd
->
ExåaInfo
 = 
EXTRA_INFO_CLEAR
;

1410 
	`MlmeRadioOff
(
pAd
);

1412 
pAd
->
ExåaInfo
 = 
SW_RADIO_OFF
;

1416 
RT_OID_RESET_FROM_ERROR
:

1417 
RT_OID_RESET_FROM_NDIS
:

1419 
UINT
 
i
 = 0;

1421 
	`RTUSBReje˘PídögPackës
(
pAd
);

1422 
	`RTUSBCÀ™UpD©aBulkOutQueue
(
pAd
);

1423 
	`MlmeSu•íd
(
pAd
, 
FALSE
);

1427 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR2
, 1);

1429 (
	`©omic_ªad
(&
pAd
->
PídögRx
) > 0) ||

1430 (
pAd
->
BulkOutPídög
[0] =
TRUE
) ||

1431 (
pAd
->
BulkOutPídög
[1] =
TRUE
) ||

1432 (
pAd
->
BulkOutPídög
[2] =
TRUE
) ||

1433 (
pAd
->
BulkOutPídög
[3] =
TRUE
))

1436 i‡(
	`©omic_ªad
(&
pAd
->
PídögRx
) > 0)

1438 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "BulkIn IRP Pending!!!\n");

1439 
	`RTUSB_Víd‹Reque°
(
pAd
,

1441 
DEVICE_VENDOR_REQUEST_OUT
,

1445 
NULL
,

1449 i‡((
pAd
->
BulkOutPídög
[0] =
TRUE
) ||

1450 (
pAd
->
BulkOutPídög
[1] =
TRUE
) ||

1451 (
pAd
->
BulkOutPídög
[2] =
TRUE
) ||

1452 (
pAd
->
BulkOutPídög
[3] =
TRUE
))

1454 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "BulkOut IRP Pending!!!\n");

1455 i‡(
i
 == 0)

1457 
	`RTUSBC™˚lPídögBulkOutIRP
(
pAd
);

1458 
i
++;

1462 
	`RTMPu£cDñay
(500000);

1465 
	`NICRe£tFromEº‹
(
pAd
);

1466 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HARDWARE_ERROR
))

1468 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_HARDWARE_ERROR
);

1470 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKIN_RESET
))

1472 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKIN_RESET
);

1474 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
))

1476 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_BULKOUT_RESET
);

1479 
	`RTMP_CLEAR_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
);

1481 i‡((!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RADIO_OFF
)) &&

1482 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
)) &&

1483 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
)))

1485 
	`MlmeResume
(
pAd
);

1486 
	`RTUSBBulkRe˚ive
(
pAd
);

1487 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
TXRX_CSR2
, 0x7e);

1492 
RT_OID_LINK_DOWN
:

1493 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "LinkDown(RT_OID_LINK_DOWN)\n");

1494 
	`LökDown
(
pAd
, 
TRUE
);

1497 
RT_OID_VENDOR_WRITE_BBP
:

1499 
UCHAR
 
Off£t
, 
VÆue
;

1500 
Off£t
 = *((
PUCHAR
)
pD©a
);

1501 
VÆue
 = *((
PUCHAR
)(
pD©a
 + 1));

1502 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "off£à0x%02x vÆuê0x%02x\n", 
Off£t
, 
VÆue
);

1503 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
Off£t
, 
VÆue
);

1507 
RT_OID_VENDOR_READ_BBP
:

1509 
UCHAR
 
Off£t
 = *((
PUCHAR
)
pD©a
);

1510 
PUCHAR
 
pVÆue
 = (PUCHAR)(
pD©a
 + 1);

1512 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "off£à0x%02x\n", 
Off£t
);

1513 
	`RTUSBRódBBPRegi°î
(
pAd
, 
Off£t
, 
pVÆue
);

1514 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "vÆuê0x%02x\n", *
pVÆue
);

1518 
RT_OID_VENDOR_WRITE_RF
:

1520 
ULONG
 
VÆue
 = *((
PULONG
)
pD©a
);

1522 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "vÆuê0x%08x\n", 
VÆue
);

1523 
	`RTUSBWrôeRFRegi°î
(
pAd
, 
VÆue
);

1527 
RT_OID_802_11_RESET_COUNTERS
:

1529 
UCHAR
 
VÆue
[22];

1531 
	`RTUSBMu…iRód
(
pAd
, 
STA_CSR0
, 
VÆue
, 24);

1535 
RT_OID_USB_VENDOR_RESET
:

1536 
	`RTUSB_Víd‹Reque°
(
pAd
,

1538 
DEVICE_VENDOR_REQUEST_OUT
,

1542 
NULL
,

1546 
RT_OID_USB_VENDOR_UNPLUG
:

1547 
	`RTUSB_Víd‹Reque°
(
pAd
,

1549 
DEVICE_VENDOR_REQUEST_OUT
,

1553 
NULL
,

1557 
RT_OID_USB_VENDOR_SWITCH_FUNCTION
:

1558 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR13
, 0x2121);

1559 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR14
, 0x1e1e);

1560 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
MAC_CSR1
, 3);

1561 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
PHY_CSR4
, 0xf);

1563 
	`RTUSB_Víd‹Reque°
(
pAd
,

1565 
DEVICE_VENDOR_REQUEST_OUT
,

1569 
NULL
,

1573 
RT_OID_VENDOR_FLIP_IQ
:

1575 
ULONG
 
VÆue1
, 
VÆue2
;

1576 
	`RTUSBRódMACRegi°î
(
pAd
, 
PHY_CSR5
, &
VÆue1
);

1577 
	`RTUSBRódMACRegi°î
(
pAd
, 
PHY_CSR6
, &
VÆue2
);

1578 i‡(*
pD©a
 == 1)

1580 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "I/Q Flip\n");

1581 
VÆue1
 = Value1 | 0x0004;

1582 
VÆue2
 = Value2 | 0x0004;

1586 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "I/Q Not Flip\n");

1587 
VÆue1
 = Value1 & 0xFFFB;

1588 
VÆue2
 = Value2 & 0xFFFB;

1590 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
PHY_CSR5
, 
VÆue1
);

1591 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
PHY_CSR6
, 
VÆue2
);

1595 
RT_OID_UPDATE_TX_RATE
:

1596 
	`MlmeUpd©eTxR©es
(
pAd
, 
FALSE
);

1597 i‡(
	`ADHOC_ON
(
pAd
))

1598 
	`MakeIbssBóc⁄
(
pAd
);

1601 
RT_OID_802_11_PREAMBLE
:

1603 
ULONG
 
PªambÀ
 = *((
PULONG
)(
cmdqñmt
->
buf„r
));

1604 i‡(
PªambÀ
 =
Rt802_11PªambÀSh‹t
)

1606 
pAd
->
P‹tCfg
.
TxPªambÀ
 = 
PªambÀ
;

1607 
	`MlmeSëTxPªambÀ
(
pAd
, 
Rt802_11PªambÀSh‹t
);

1609 i‡((
PªambÀ
 =
Rt802_11PªambÀL⁄g
Ë|| (PªambÀ =
Rt802_11PªambÀAuto
))

1613 
pAd
->
P‹tCfg
.
TxPªambÀ
 = 
PªambÀ
;

1614 
	`MlmeSëTxPªambÀ
(
pAd
, 
Rt802_11PªambÀL⁄g
);

1617 
NdisSètus
 = 
NDIS_STATUS_FAILURE
;

1618 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "CMDH™dÀr::RT_OID_802_11_SET_PREAMBLE (=%d)\n", 
PªambÀ
);

1621 
OID_802_11_NETWORK_TYPE_IN_USE
:

1623 
NDIS_802_11_NETWORK_TYPE
 
NëTy≥
 = *(
PNDIS_802_11_NETWORK_TYPE
)(
cmdqñmt
->
buf„r
);

1624 i‡(
NëTy≥
 =
Ndis802_11DS
)

1625 
	`RTMPSëPhyMode
(
pAd
, 
PHY_11B
);

1626 i‡(
NëTy≥
 =
Ndis802_11OFDM24
)

1627 
	`RTMPSëPhyMode
(
pAd
, 
PHY_11BG_MIXED
);

1628 i‡(
NëTy≥
 =
Ndis802_11OFDM5
)

1629 
	`RTMPSëPhyMode
(
pAd
, 
PHY_11A
);

1631 
NdisSètus
 = 
NDIS_STATUS_FAILURE
;

1632 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "CMDH™dÀr::OID_802_11_NETWORK_TYPE_IN_USE (=%d)\n",
NëTy≥
);

1636 
RT_OID_802_11_PHY_MODE
:

1638 
ULONG
 
phymode
 = *(ULONG *)(
cmdqñmt
->
buf„r
);

1639 
	`RTMPSëPhyMode
(
pAd
, 
phymode
);

1640 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "CMDH™dÀr::RT_OID_802_11_SET_PHY_MODE (=%d)\n", 
phymode
);

1645 
OID_802_11_WEP_STATUS
:

1647 
USHORT
 
VÆue
;

1648 
NDIS_802_11_WEP_STATUS
 
WïSètus
 = *(
PNDIS_802_11_WEP_STATUS
)
pD©a
;

1650 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "CMDHandler::66- OID_802_11_WEP_STATUS \n");

1653 i‡(
pAd
->
P‹tCfg
.
WïSètus
 != WepStatus)

1655 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "C⁄fig Ch™ged !!°©us%x \n", 
WïSètus
);

1658 
pAd
->
bC⁄figCh™ged
 = 
TRUE
;

1660 
pAd
->
P‹tCfg
.
WïSètus
 = WepStatus;

1661 
pAd
->
P‹tCfg
.
PaúCùhî
 = 
WïSètus
;

1662 
pAd
->
P‹tCfg
.
GroupCùhî
 = 
WïSètus
;

1665 i‡((
WïSètus
 =
Ndis802_11En¸y±i⁄1E«bÀd
) &&

1666 (
pAd
->
Sh¨edKey
[pAd->
P‹tCfg
.
DeÁu…KeyId
].
KeyLí
 != 0))

1668 i‡(
pAd
->
Sh¨edKey
[pAd->
P‹tCfg
.
DeÁu…KeyId
].
KeyLí
 <= 5)

1670 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "WEP64! \n");

1672 
pAd
->
Sh¨edKey
[pAd->
P‹tCfg
.
DeÁu…KeyId
].
CùhîAlg
 = 
CIPHER_WEP64
;

1676 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "WEP128! \n");

1678 
pAd
->
Sh¨edKey
[pAd->
P‹tCfg
.
DeÁu…KeyId
].
CùhîAlg
 = 
CIPHER_WEP128
;

1681 
	`RTUSBRódMACRegi°î_ﬁd
(
pAd
, 
TXRX_CSR0
, &
VÆue
);

1682 
VÆue
 &= 0xfe00;

1683 
VÆue
 |((
LENGTH_802_11
 << 3Ë| (
pAd
->
P‹tCfg
.
CùhîAlg
));

1684 
	`RTUSBWrôeMACRegi°î_ﬁd
(
pAd
, 
TXRX_CSR0
, 
VÆue
);

1687 i‡(
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
)

1689 
	`DBGPRINT
(
RT_DEBUG_ERROR
, " TKIP !!! \n");

1691 
pAd
->
Sh¨edKey
[pAd->
P‹tCfg
.
DeÁu…KeyId
].
CùhîAlg
 = 
CIPHER_TKIP
;

1693 
	`RTUSBRódMACRegi°î_ﬁd
(
pAd
, 
TXRX_CSR0
, &
VÆue
);

1694 
VÆue
 &= 0xfe00;

1695 
VÆue
 |((
LENGTH_802_11
 << 3Ë| (
pAd
->
P‹tCfg
.
CùhîAlg
));

1696 
	`RTUSBWrôeMACRegi°î_ﬁd
(
pAd
, 
TXRX_CSR0
, 
VÆue
);

1699 i‡(
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

1701 
	`DBGPRINT
(
RT_DEBUG_ERROR
, " AES !!! \n");

1702 
pAd
->
Sh¨edKey
[pAd->
P‹tCfg
.
DeÁu…KeyId
].
CùhîAlg
 = 
CIPHER_AES
;

1704 
	`RTUSBRódMACRegi°î_ﬁd
(
pAd
, 
TXRX_CSR0
, &
VÆue
);

1705 
VÆue
 &= 0xfe00;

1706 
VÆue
 |((
LENGTH_802_11
 << 3Ë| (
pAd
->
P‹tCfg
.
CùhîAlg
));

1707 
	`RTUSBWrôeMACRegi°î_ﬁd
(
pAd
, 
TXRX_CSR0
, 
VÆue
);

1710 i‡(
WïSètus
 =
Ndis802_11En¸y±i⁄DißbÀd
)

1712 
	`DBGPRINT
(
RT_DEBUG_ERROR
, " CIPHER_NONE !!! \n");

1714 
pAd
->
Sh¨edKey
[pAd->
P‹tCfg
.
DeÁu…KeyId
].
CùhîAlg
 = 
CIPHER_NONE
;

1716 
	`RTUSBRódMACRegi°î_ﬁd
(
pAd
, 
TXRX_CSR0
, &
VÆue
);

1717 
VÆue
 &= 0xfe00;

1718 
	`RTUSBWrôeMACRegi°î_ﬁd
(
pAd
, 
TXRX_CSR0
, 
VÆue
);

1722 
	`DBGPRINT
(
RT_DEBUG_ERROR
, " ERROR Cipher !!! \n");

1728 
OID_802_11_ADD_WEP
:

1730 
ULONG
 
KeyIdx
;

1731 
PNDIS_802_11_WEP
 
pWïKey
;

1733 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CMDHandler::OID_802_11_ADD_WEP \n");

1735 
pWïKey
 = (
PNDIS_802_11_WEP
)
pD©a
;

1736 
KeyIdx
 = 
pWïKey
->
KeyIndex
 & 0x0fffffff;

1739 i‡((
KeyIdx
 >4Ë|| ((
pWïKey
->
KeyLígth
 != 5) && (pWepKey->KeyLength != 13)))

1741 
NdisSètus
 = 
NDIS_STATUS_FAILURE
;

1742 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "CMDHandler::OID_802_11_ADD_WEP, INVALID_DATA!!\n");

1746 
UCHAR
 
CùhîAlg
;

1747 
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 = (
UCHAR
Ë
pWïKey
->
KeyLígth
;

1748 
	`NdisMoveMem‹y
(
pAd
->
Sh¨edKey
[
KeyIdx
].
Key
, &
pWïKey
->
KeyM©îül
,ÖWïKey->
KeyLígth
);

1749 
CùhîAlg
 = (
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 =5)? 
CIPHER_WEP64
 : 
CIPHER_WEP128
;

1750 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = CipherAlg;

1751 i‡(
pWïKey
->
KeyIndex
 & 0x80000000)

1754 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 = (
UCHAR
Ë
KeyIdx
;

1756 
	`AsicAddSh¨edKeyE¡ry
(
pAd
, 0, (
UCHAR
)
KeyIdx
, 
CùhîAlg
, 
pWïKey
->
KeyM©îül
, 
NULL
, NULL);

1757 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CMDH™dÀr::OID_802_11_ADD_WEP (KeyIdx=%d, Lí=%d-byã)\n", 
KeyIdx
, 
pWïKey
->
KeyLígth
);

1762 
OID_802_11_REMOVE_WEP
:

1764 
ULONG
 
KeyIdx
;

1767 
KeyIdx
 = *(
NDIS_802_11_KEY_INDEX
 *Ë
pD©a
;

1768 i‡(
KeyIdx
 & 0x80000000)

1770 
NdisSètus
 = 
NDIS_STATUS_FAILURE
;

1771 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "CMDHandler::OID_802_11_REMOVE_WEP, INVALID_DATA!!\n");

1775 
KeyIdx
 = KeyIdx & 0x0fffffff;

1776 i‡(
KeyIdx
 >= 4)

1778 
NdisSètus
 = 
NDIS_STATUS_FAILURE
;

1779 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "CMDH™dÀr::OID_802_11_REMOVE_WEP, InvÆid KeyIdx[=%d]!!\n", 
KeyIdx
);

1783 
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 = 0;

1784 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = 
CIPHER_NONE
;

1785 
	`AsicRemoveSh¨edKeyE¡ry
(
pAd
, 0, (
UCHAR
)
KeyIdx
);

1786 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CMDH™dÀr::OID_802_11_REMOVE_WEP (KeyIdx=%d)\n", 
KeyIdx
);

1792 
OID_802_11_ADD_KEY_WEP
:

1794 
PNDIS_802_11_KEY
 
pKey
;

1795 
ULONG
 
i
, 
KeyIdx
;

1797 
pKey
 = (
PNDIS_802_11_KEY
Ë
pD©a
;

1798 
KeyIdx
 = 
pKey
->
KeyIndex
 & 0x0fffffff;

1801 i‡(
KeyIdx
 >= 4)

1803 
NdisSètus
 = 
NDIS_STATUS_FAILURE
;

1804 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "CMDH™dÀr::OID_802_11_ADD_KEY_WEP, InvÆid KeyIdx[=%d]!!\n", 
KeyIdx
);

1808 
UCHAR
 
CùhîAlg
;

1810 
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 = (
UCHAR
Ë
pKey
->
KeyLígth
;

1811 
	`NdisMoveMem‹y
(
pAd
->
Sh¨edKey
[
KeyIdx
].
Key
, &
pKey
->
KeyM©îül
,ÖKey->
KeyLígth
);

1813 i‡(
pKey
->
KeyLígth
 == 5)

1814 
CùhîAlg
 = 
CIPHER_WEP64
;

1816 
CùhîAlg
 = 
CIPHER_WEP128
;

1821 i‡(
pKey
->
KeyLígth
 < 16)

1823 
i
 = 1; i < (16 / 
pKey
->
KeyLígth
); i++)

1825 
	`NdisMoveMem‹y
(&
pAd
->
Sh¨edKey
[
KeyIdx
].
Key
[
i
 * 
pKey
->
KeyLígth
],

1826 &
pKey
->
KeyM©îül
[0],

1827 
pKey
->
KeyLígth
);

1829 
	`NdisMoveMem‹y
(&
pAd
->
Sh¨edKey
[
KeyIdx
].
Key
[
i
 * 
pKey
->
KeyLígth
],

1830 &
pKey
->
KeyM©îül
[0],

1831 16 - (
i
 * 
pKey
->
KeyLígth
));

1834 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = CipherAlg;

1835 i‡(
pKey
->
KeyIndex
 & 0x80000000)

1838 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 = (
UCHAR
Ë
KeyIdx
;

1841 
	`AsicAddSh¨edKeyE¡ry
(
pAd
, 0, (
UCHAR
)
KeyIdx
, 
CùhîAlg
,ÖAd->
Sh¨edKey
[KeyIdx].
Key
, 
NULL
, NULL);

1842 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CMDHandler::OID_802_11_ADD_KEY_WEP (KeyIdx=%d, KeyLen=%d, CipherAlg=%d)\n",

1843 
pAd
->
P‹tCfg
.
DeÁu…KeyId
,ÖAd->
Sh¨edKey
[
KeyIdx
].
KeyLí
,ÖAd->Sh¨edKey[KeyIdx].
CùhîAlg
);

1848 
OID_802_11_ADD_KEY
:

1850 
PNDIS_802_11_KEY
 
pkey
 = (PNDIS_802_11_KEY)
pD©a
;

1852 
NdisSètus
 = 
	`RTMPWPAAddKeyProc
(
pAd
, 
pkey
);

1853 
	`RTUSBBulkRe˚ive
(
pAd
);

1854 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CMDHandler::OID_802_11_ADD_KEY\n");

1859 
RT_OID_802_11_REMOVE_WEP
:

1860 
OID_802_11_REMOVE_WEP
:

1862 
ULONG
 
KeyIdx
;

1865 
KeyIdx
 = *(
NDIS_802_11_KEY_INDEX
 *Ë
pD©a
;

1866 i‡(
KeyIdx
 & 0x80000000)

1868 
NdisSètus
 = 
NDIS_STATUS_FAILURE
;

1869 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "CMDHandler::OID_802_11_REMOVE_WEP, INVALID_DATA!!\n");

1873 
KeyIdx
 = KeyIdx & 0x0fffffff;

1874 i‡(
KeyIdx
 >= 4)

1876 
NdisSètus
 = 
NDIS_STATUS_FAILURE
;

1877 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "CMDHandler::OID_802_11_REMOVE_WEP, INVALID_DATA!!\n");

1889 
ULONG
 
KeyIdx
;

1894 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "CMDHandler::OID_802_11_REMOVE_WEP\n");

1899 
KeyIdx
 = *(
NDIS_802_11_KEY_INDEX
 *Ë
pD©a
;

1901 i‡(
KeyIdx
 & 0x80000000)

1908 
KeyIdx
 = KeyIdx & 0x0fffffff;

1909 i‡(
KeyIdx
 >= 4)

1915 
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 = 0;

1918 
	`AsicRemoveSh¨edKeyE¡ry
(
pAd
, 0, (
UCHAR
)
KeyIdx
);

1926 
OID_802_11_REMOVE_KEY
:

1928 
PNDIS_802_11_REMOVE_KEY
 
pRemoveKey
;

1929 
ULONG
 
KeyIdx
;

1931 
pRemoveKey
 = (
PNDIS_802_11_REMOVE_KEY
Ë
pD©a
;

1932 #ifde‡
NATIVE_WPA_SUPPLICANT_SUPPORT


1933 i‡(
pAd
->
P‹tCfg
.
bN©iveW∑
 =
TRUE
)

1935 if(
pRemoveKey
->
KeyIndex
 == 0xffffffff)

1939 
KeyIdx
 =0 ; KeyIdx < 
SHARE_KEY_NUM
; KeyIdx++)

1940 
	`AsicRemoveSh¨edKeyE¡ry
(
pAd
, 0, (
UCHAR
)
KeyIdx
);

1944 i‡(
pAd
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
)

1946 
NdisSètus
 = 
	`RTMPWPARemoveKeyProc
(
pAd
, 
pD©a
);

1947 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CMDHandler::RTMPWPARemoveKeyProc\n");

1951 
KeyIdx
 = 
pRemoveKey
->
KeyIndex
;

1953 i‡(
KeyIdx
 & 0x80000000)

1956 
NdisSètus
 = 
NDIS_STATUS_FAILURE
;

1957 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "CMDH™dÀr::OID_802_11_REMOVE_KEY, InvÆid KeyIdx[=%d]!!\n", 
KeyIdx
);

1961 
KeyIdx
 = KeyIdx & 0x0fffffff;

1962 i‡(
KeyIdx
 >= 4)

1964 
NdisSètus
 = 
NDIS_STATUS_FAILURE
;

1965 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "CMDH™dÀr::OID_802_11_REMOVE_KEY, InvÆid KeyIdx[=%d]!!\n", 
KeyIdx
);

1969 
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 = 0;

1970 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = 
CIPHER_NONE
;

1971 
	`AsicRemoveSh¨edKeyE¡ry
(
pAd
, 0, (
UCHAR
)
KeyIdx
);

1972 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CMDH™dÀr::AsicRemoveSh¨edKeyE¡ry(KeyIdx=%d)\n", 
KeyIdx
);

1980 
OID_802_11_POWER_MODE
:

1982 
NDIS_802_11_POWER_MODE
 
PowîMode
 = *(
PNDIS_802_11_POWER_MODE
Ë
pD©a
;

1983 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "CMDH™dÀr::OID_802_11_POWER_MODE (=%d)\n",
PowîMode
);

1986 i‡(
PowîMode
 =
Ndis802_11PowîModeCAM
)

1989 
	`MlmeSëPsmBô
(
pAd
, 
PWR_ACTIVE
);

1991 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_RECEIVE_DTIM
);

1992 i‡(
pAd
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

1993 
pAd
->
P‹tCfg
.
WödowsPowîMode
 = 
PowîMode
;

1994 
pAd
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
PowîMode
;

1996 i‡(
PowîMode
 =
Ndis802_11PowîModeMAX_PSP
)

2001 i‡(
pAd
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

2002 
pAd
->
P‹tCfg
.
WödowsPowîMode
 = 
PowîMode
;

2003 
pAd
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
PowîMode
;

2004 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_RECEIVE_DTIM
);

2005 
pAd
->
P‹tCfg
.
DeÁu…Li°íCou¡
 = 5;

2007 i‡(
PowîMode
 =
Ndis802_11PowîModeFa°_PSP
)

2012 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_RECEIVE_DTIM
);

2013 i‡(
pAd
->
P‹tCfg
.
bWödowsACCAME«bÀ
 =
FALSE
)

2014 
pAd
->
P‹tCfg
.
WödowsPowîMode
 = 
PowîMode
;

2015 
pAd
->
P‹tCfg
.
WödowsB©ãryPowîMode
 = 
PowîMode
;

2016 
pAd
->
P‹tCfg
.
DeÁu…Li°íCou¡
 = 3;

2021 
RT_PERFORM_SOFT_DIVERSITY
:

2022 
	`AsicRxA¡EvÆA˘i⁄
(
pAd
);

2025 
RT_OID_FORCE_WAKE_UP
:

2026 
	`AsicF‹˚Wakeup
(
pAd
);

2029 
RT_OID_SET_PSM_BIT_ACTIVE
:

2030 
	`MlmeSëPsmBô
(
pAd
, 
PWR_ACTIVE
);

2038 i‡(
cmdqñmt
->
CmdFromNdis
 =
TRUE
)

2040 i‡((
cmdqñmt
->
comm™d
 !
OID_802_11_BSSID_LIST_SCAN
) &&

2041 (
cmdqñmt
->
comm™d
 !
RT_OID_802_11_BSSID
) &&

2042 (
cmdqñmt
->
comm™d
 !
OID_802_11_SSID
) &&

2043 (
cmdqñmt
->
comm™d
 !
OID_802_11_DISASSOCIATE
))

2047 i‡((
cmdqñmt
->
comm™d
 !
RT_OID_MULTI_READ_MAC
) &&

2048 (
cmdqñmt
->
comm™d
 !
RT_OID_VENDOR_READ_BBP
) &&

2049 #ifde‡
DBG


2050 (
cmdqñmt
->
comm™d
 !
RT_OID_802_11_QUERY_HARDWARE_REGISTER
) &&

2052 (
cmdqñmt
->
comm™d
 !
RT_OID_USB_VENDOR_EEPROM_READ
))

2054 i‡(
cmdqñmt
->
buf„r
 !
NULL
)

2055 
	`k‰ì
(
cmdqñmt
->
buf„r
);

2058 
	`k‰ì
((
PCmdQElmt
)
cmdqñmt
);

2061 
cmdqñmt
->
InU£
 = 
FALSE
;

2064 
	}
}

2066 #ifde‡
DBG


2067 
	#HARDWARE_MAC
 0

	)

2068 
	#HARDWARE_BBP
 1

	)

2069 
	#HARDWARE_RF
 2

	)

2070 
NDIS_STATUS
 
	$RTUSBQuîyH¨dW¨eRegi°î
(

2071 
IN
 
PRTMP_ADAPTER
 
pAd
,

2072 
IN
 
PVOID
 
pBuf
)

2074 
PRT_802_11_HARDWARE_REGISTER
 
pH¨dw¨eRegi°î
;

2075 
ULONG
 
VÆue
;

2076 
USHORT
 
Off£t
;

2077 
UCHAR
 
bbpVÆue
;

2078 
UCHAR
 
bbpID
;

2079 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

2081 
pH¨dw¨eRegi°î
 = (
PRT_802_11_HARDWARE_REGISTER
Ë
pBuf
;

2083 i‡(
pH¨dw¨eRegi°î
->
H¨dw¨eTy≥
 =
HARDWARE_MAC
)

2086 i‡(
pH¨dw¨eRegi°î
->
Off£t
 > 0xF4)

2087 
Sètus
 = 
NDIS_STATUS_FAILURE
;

2089 
Off£t
 = (
USHORT
Ë
pH¨dw¨eRegi°î
->Offset;

2090 
	`RTUSBRódMACRegi°î
(
pAd
, 
Off£t
, &
VÆue
);

2091 
pH¨dw¨eRegi°î
->
D©a
 = 
VÆue
;

2092 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MAC:Off£t[0x%04x]=[0x%04x]\n", 
Off£t
, 
VÆue
);

2094 i‡(
pH¨dw¨eRegi°î
->
H¨dw¨eTy≥
 =
HARDWARE_BBP
)

2096 
bbpID
 = (
UCHAR
Ë
pH¨dw¨eRegi°î
->
Off£t
;

2098 
	`RTUSBRódBBPRegi°î
(
pAd
, 
bbpID
, &
bbpVÆue
);

2099 
pH¨dw¨eRegi°î
->
D©a
 = 
bbpVÆue
;

2100 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "BBP:ID[0x%02x]=[0x%02x]\n", 
bbpID
, 
bbpVÆue
);

2103 
Sètus
 = 
NDIS_STATUS_FAILURE
;

2105  
Sètus
;

2106 
	}
}

2108 
NDIS_STATUS
 
	$RTUSBSëH¨dW¨eRegi°î
(

2109 
IN
 
PRTMP_ADAPTER
 
pAd
,

2110 
IN
 
PVOID
 
pBuf
)

2112 
PRT_802_11_HARDWARE_REGISTER
 
pH¨dw¨eRegi°î
;

2113 
ULONG
 
VÆue
;

2114 
USHORT
 
Off£t
;

2115 
UCHAR
 
bbpVÆue
;

2116 
UCHAR
 
bbpID
;

2117 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

2119 
pH¨dw¨eRegi°î
 = (
PRT_802_11_HARDWARE_REGISTER
Ë
pBuf
;

2121 i‡(
pH¨dw¨eRegi°î
->
H¨dw¨eTy≥
 =
HARDWARE_MAC
)

2124 i‡(
pH¨dw¨eRegi°î
->
Off£t
 > 0xF4)

2125 
Sètus
 = 
NDIS_STATUS_FAILURE
;

2127 
Off£t
 = (
USHORT
Ë
pH¨dw¨eRegi°î
->Offset;

2128 
VÆue
 = (
ULONG
Ë
pH¨dw¨eRegi°î
->
D©a
;

2129 
	`RTUSBWrôeMACRegi°î
(
pAd
, 
Off£t
, 
VÆue
);

2130 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RT_OID_802_11_SET_HARDWARE_REGISTER (MAC off£t=0x%08x, d©a=0x%08x)\n", 
pH¨dw¨eRegi°î
->
Off£t
,ÖH¨dw¨eRegi°î->
D©a
);

2134 i‡((
pH¨dw¨eRegi°î
->
Off£t
 >
HW_DEBUG_SETTING_BASE
) &&

2135 (
pH¨dw¨eRegi°î
->
Off£t
 <
HW_DEBUG_SETTING_END
))

2138 i‡(
pH¨dw¨eRegi°î
->
Off£t
 =
HW_DEBUG_SETTING_BASE
)

2141 
ULONG
 
i§
, 
imr
, 
gimr
;

2142 
USHORT
 
tbâ
 = 3;

2144 
	`RTMP_IO_READ32
(
pAd
, 
MCU_INT_SOURCE_CSR
, &
i§
);

2145 
	`RTMP_IO_READ32
(
pAd
, 
MCU_INT_MASK_CSR
, &
imr
);

2146 
	`RTMP_IO_READ32
(
pAd
, 
INT_MASK_CSR
, &
gimr
);

2147 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SÀï %d TBTT, 8051 IMR=%08x, ISR=%08x, MAC IMR=%08x\n", 
tbâ
, 
imr
, 
i§
, 
gimr
);

2148 
	`AsicSÀïThíAutoWakeup
(
pAd
, 
tbâ
);

2152 i‡(
pH¨dw¨eRegi°î
->
Off£t
 =(
HW_DEBUG_SETTING_BASE
 + 4))

2155 i‡(
pH¨dw¨eRegi°î
->
D©a
 & 0x000000ff)

2157 
pAd
->
BbpTunög
.
bE«bÀ
 = 
TRUE
;

2158 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"turn on R17Åuning\n");

2162 
UCHAR
 
R17
;

2164 
pAd
->
BbpTunög
.
bE«bÀ
 = 
FALSE
;

2165 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
))

2167 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 > 14)

2168 
R17
 = 
pAd
->
BbpTunög
.
R17LowîBoundA
;

2170 
R17
 = 
pAd
->
BbpTunög
.
R17LowîBoundG
;

2171 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17, 
R17
);

2172 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"tu∫ of‡R17Åunög,Ñe°‹êtÿ0x%02x\n", 
R17
);

2177 i‡(
pH¨dw¨eRegi°î
->
Off£t
 =(
HW_DEBUG_SETTING_BASE
 + 8))

2179 
PUCHAR
 
pAckSå
[4] = {"NORMAL", "NO-ACK", "NO-EXPLICIT-ACK", "BLOCK-ACK"};

2180 
EDCA_PARM
 
DeÁu…EdˇP¨m
;

2183 
pAd
->
P‹tCfg
.
AckPﬁicy
[0] = ((
UCHAR
)
pH¨dw¨eRegi°î
->
D©a
 & 0x02) << 5;

2184 
pAd
->
P‹tCfg
.
AckPﬁicy
[1] = ((
UCHAR
)
pH¨dw¨eRegi°î
->
D©a
 & 0x02) << 5;

2185 
pAd
->
P‹tCfg
.
AckPﬁicy
[2] = ((
UCHAR
)
pH¨dw¨eRegi°î
->
D©a
 & 0x02) << 5;

2186 
pAd
->
P‹tCfg
.
AckPﬁicy
[3] = ((
UCHAR
)
pH¨dw¨eRegi°î
->
D©a
 & 0x02) << 5;

2187 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "ACKÖﬁicy = %s\n", 
pAckSå
[(
UCHAR
)
pH¨dw¨eRegi°î
->
D©a
 & 0x02]);

2190 i‡(
pH¨dw¨eRegi°î
->
D©a
 & 0x0000ff00)

2192 
	`NdisZîoMem‹y
(&
DeÁu…EdˇP¨m
, (
EDCA_PARM
));

2193 
DeÁu…EdˇP¨m
.
bVÆid
 = 
TRUE
;

2194 
DeÁu…EdˇP¨m
.
Aif¢
[0] = 3;

2195 
DeÁu…EdˇP¨m
.
Aif¢
[1] = 7;

2196 
DeÁu…EdˇP¨m
.
Aif¢
[2] = 2;

2197 
DeÁu…EdˇP¨m
.
Aif¢
[3] = 2;

2199 
DeÁu…EdˇP¨m
.
Cwmö
[0] = 4;

2200 
DeÁu…EdˇP¨m
.
Cwmö
[1] = 4;

2201 
DeÁu…EdˇP¨m
.
Cwmö
[2] = 3;

2202 
DeÁu…EdˇP¨m
.
Cwmö
[3] = 2;

2204 
DeÁu…EdˇP¨m
.
Cwmax
[0] = 10;

2205 
DeÁu…EdˇP¨m
.
Cwmax
[1] = 10;

2206 
DeÁu…EdˇP¨m
.
Cwmax
[2] = 4;

2207 
DeÁu…EdˇP¨m
.
Cwmax
[3] = 3;

2209 
DeÁu…EdˇP¨m
.
Tx›
[0] = 0;

2210 
DeÁu…EdˇP¨m
.
Tx›
[1] = 0;

2211 
DeÁu…EdˇP¨m
.
Tx›
[2] = 96;

2212 
DeÁu…EdˇP¨m
.
Tx›
[3] = 48;

2213 
	`AsicSëEdˇP¨m
(
pAd
, &
DeÁu…EdˇP¨m
);

2216 
	`AsicSëEdˇP¨m
(
pAd
, 
NULL
);

2219 i‡(
pH¨dw¨eRegi°î
->
Off£t
 =(
HW_DEBUG_SETTING_BASE
 + 12))

2221 i‡(
pH¨dw¨eRegi°î
->
D©a
)

2222 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_AGGREGATION_INUSED
);

2224 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_AGGREGATION_INUSED
);

2225 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AGGREGATION = %d\n", 
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_AGGREGATION_INUSED
));

2228 
Sètus
 = 
NDIS_STATUS_FAILURE
;

2231 i‡(
pH¨dw¨eRegi°î
->
H¨dw¨eTy≥
 =
HARDWARE_BBP
)

2233 
bbpID
 = (
UCHAR
Ë
pH¨dw¨eRegi°î
->
Off£t
;

2234 
bbpVÆue
 = (
UCHAR
Ë
pH¨dw¨eRegi°î
->
D©a
;

2235 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
bbpID
, 
bbpVÆue
);

2236 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "BBP:ID[0x%02x]=[0x%02x]\n", 
bbpID
, 
bbpVÆue
);

2239  
Sètus
;

2240 
	}
}

	@sanity.c

38 
	~"π_c⁄fig.h
"

39 
	~<√t/iw_h™dÀr.h
>

41 
UCHAR
 
	gWPA_OUI
[] = {0x00, 0x50, 0xf2, 0x01};

42 
UCHAR
 
	gRSN_OUI
[] = {0x00, 0x0f, 0xac};

43 
UCHAR
 
	gWME_INFO_ELEM
[] = {0x00, 0x50, 0xf2, 0x02, 0x00, 0x01};

44 
UCHAR
 
	gWME_PARM_ELEM
[] = {0x00, 0x50, 0xf2, 0x02, 0x01, 0x01};

45 
UCHAR
 
	gRALINK_OUI
[] = {0x00, 0x0c, 0x43};

55 
BOOLEAN
 
	$MlmeSˇnReqS™ôy
(

56 
IN
 
PRTMP_ADAPTER
 
pAd
,

57 
IN
 
VOID
 *
Msg
,

58 
IN
 
ULONG
 
MsgLí
,

59 
OUT
 
UCHAR
 *
pBssTy≥
,

60 
OUT
 
CHAR
 
Ssid
[],

61 
OUT
 
UCHAR
 *
pSsidLí
,

62 
OUT
 
UCHAR
 *
pSˇnTy≥
)

64 
MLME_SCAN_REQ_STRUCT
 *
Info
;

66 
Info
 = (
MLME_SCAN_REQ_STRUCT
 *)(
Msg
);

67 *
pBssTy≥
 = 
Info
->
BssTy≥
;

68 *
pSsidLí
 = 
Info
->
SsidLí
;

69 
	`NdisMoveMem‹y
(
Ssid
, 
Info
->Ssid, *
pSsidLí
);

70 *
pSˇnTy≥
 = 
Info
->
SˇnTy≥
;

72 i‡((*
pBssTy≥
 =
BSS_INFRA
 || *pBssTy≥ =
BSS_ADHOC
 || *pBssTy≥ =
BSS_ANY
) &&

73 (*
pSˇnTy≥
 =
SCAN_ACTIVE
 || *pSˇnTy≥ =
FAST_SCAN_ACTIVE
 || *pSˇnTy≥ =
SCAN_PASSIVE
))

74  
TRUE
;

77 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MlmeScanReqSanity fail - wrong BssType or ScanType\n");

78  
FALSE
;

80 
	}
}

90 
BOOLEAN
 
	$MlmeSèπReqS™ôy
(

91 
IN
 
PRTMP_ADAPTER
 
pAd
,

92 
IN
 
VOID
 *
Msg
,

93 
IN
 
ULONG
 
MsgLí
,

94 
OUT
 
CHAR
 
Ssid
[],

95 
OUT
 
UCHAR
 *
pSsidLí
)

97 
MLME_START_REQ_STRUCT
 *
Info
;

99 
Info
 = (
MLME_START_REQ_STRUCT
 *)(
Msg
);

101 i‡(
Info
->
SsidLí
 > 
MAX_LEN_OF_SSID
)

103 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MlmeStartReqSanity fail - wrong SSIDÜength\n");

104  
FALSE
;

107 *
pSsidLí
 = 
Info
->
SsidLí
;

108 
	`NdisMoveMem‹y
(
Ssid
, 
Info
->Ssid, *
pSsidLí
);

110  
TRUE
;

111 
	}
}

121 
BOOLEAN
 
	$MlmeAssocReqS™ôy
(

122 
IN
 
PRTMP_ADAPTER
 
pAd
,

123 
IN
 
VOID
 *
Msg
,

124 
IN
 
ULONG
 
MsgLí
,

125 
OUT
 
PUCHAR
 
pApAddr
,

126 
OUT
 
USHORT
 *
pC≠abûôyInfo
,

127 
OUT
 
ULONG
 *
pTimeout
,

128 
OUT
 
USHORT
 *
pLi°íI¡v
)

130 
MLME_ASSOC_REQ_STRUCT
 *
pInfo
;

132 
pInfo
 = (
MLME_ASSOC_REQ_STRUCT
 *)
Msg
;

133 *
pTimeout
 = 
pInfo
->
Timeout
;

134 
	`COPY_MAC_ADDR
(
pApAddr
, 
pInfo
->
Addr
);

135 *
pC≠abûôyInfo
 = 
pInfo
->
C≠abûôyInfo
;

136 *
pLi°íI¡v
 = 
pInfo
->
Li°íI¡v
;

138  
TRUE
;

139 
	}
}

149 
BOOLEAN
 
	$MlmeAuthReqS™ôy
(

150 
IN
 
PRTMP_ADAPTER
 
pAd
,

151 
IN
 
VOID
 *
Msg
,

152 
IN
 
ULONG
 
MsgLí
,

153 
OUT
 
PUCHAR
 
pAddr
,

154 
OUT
 
ULONG
 *
pTimeout
,

155 
OUT
 
USHORT
 *
pAlg
)

157 
MLME_AUTH_REQ_STRUCT
 *
pInfo
;

159 
pInfo
 = (
MLME_AUTH_REQ_STRUCT
 *)
Msg
;

160 
	`COPY_MAC_ADDR
(
pAddr
, 
pInfo
->
Addr
);

161 *
pTimeout
 = 
pInfo
->
Timeout
;

162 *
pAlg
 = 
pInfo
->
Alg
;

164 i‡(((*
pAlg
 =
Ndis802_11AuthModeSh¨ed
Ë||(*pAlg =
Ndis802_11AuthModeO≥n
)) &&

165 ((*
pAddr
 & 0x01) == 0))

167  
TRUE
;

171 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MlmeAuthReqSanity fail - wrongálgorithm\n");

172  
FALSE
;

174 
	}
}

184 
BOOLEAN
 
	$PìrAssocR•S™ôy
(

185 
IN
 
PRTMP_ADAPTER
 
pAd
,

186 
IN
 
VOID
 *
pMsg
,

187 
IN
 
ULONG
 
MsgLí
,

188 
OUT
 
PUCHAR
 
pAddr2
,

189 
OUT
 
USHORT
 *
pC≠abûôyInfo
,

190 
OUT
 
USHORT
 *
pSètus
,

191 
OUT
 
USHORT
 *
pAid
,

192 
OUT
 
UCHAR
 
SupR©e
[],

193 
OUT
 
UCHAR
 *
pSupR©eLí
,

194 
OUT
 
UCHAR
 
ExtR©e
[],

195 
OUT
 
UCHAR
 *
pExtR©eLí
,

196 
OUT
 
PEDCA_PARM
 
pEdˇP¨m
)

198 
CHAR
 
IeTy≥
, *
På
;

199 
PFRAME_802_11
 
pFøme
 = (PFRAME_802_11)
pMsg
;

200 
PEID_STRUCT
 
pEid
;

201 
ULONG
 
Lígth
 = 0;

203 
	`COPY_MAC_ADDR
(
pAddr2
, 
pFøme
->
Hdr
.
Addr2
);

204 
På
 = 
pFøme
->
O˘ë
;

205 
Lígth
 +
LENGTH_802_11
;

207 
	`NdisMoveMem‹y
(
pC≠abûôyInfo
, &
pFøme
->
O˘ë
[0], 2);

208 
Lígth
 += 2;

209 
	`NdisMoveMem‹y
(
pSètus
, &
pFøme
->
O˘ë
[2], 2);

210 
Lígth
 += 2;

212 *
pExtR©eLí
 = 0;

213 
pEdˇP¨m
->
bVÆid
 = 
FALSE
;

215 i‡(*
pSètus
 !
MLME_SUCCESS
)

216  
TRUE
;

218 
	`NdisMoveMem‹y
(
pAid
, &
pFøme
->
O˘ë
[4], 2);

219 
Lígth
 += 2;

224 *
pAid
 = (*pAid) & 0x3fff;

227 
IeTy≥
 = 
pFøme
->
O˘ë
[6];

228 *
pSupR©eLí
 = 
pFøme
->
O˘ë
[7];

229 i‡((
IeTy≥
 !
IE_SUPP_RATES
Ë|| (*
pSupR©eLí
 > 
MAX_LEN_OF_SUPPORTED_RATES
))

231 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "PeerAssocRspSanity fail - wrong SupportedRates IE\n");

232  
FALSE
;

235 
	`NdisMoveMem‹y
(
SupR©e
, &
pFøme
->
O˘ë
[8], *
pSupR©eLí
);

237 
Lígth
 = Lígth + 2 + *
pSupR©eLí
;

241 
pEid
 = (
PEID_STRUCT
Ë&
pFøme
->
O˘ë
[8 + (*
pSupR©eLí
)];

244 (
Lígth
 + 2 + 
pEid
->
Lí
Ë<
MsgLí
)

246 
pEid
->
Eid
)

248 
IE_EXT_SUPP_RATES
:

249 i‡(
pEid
->
Lí
 <
MAX_LEN_OF_SUPPORTED_RATES
)

251 
	`NdisMoveMem‹y
(
ExtR©e
, 
pEid
->
O˘ë
,ÖEid->
Lí
);

252 *
pExtR©eLí
 = 
pEid
->
Lí
;

256 
IE_VENDOR_SPECIFIC
:

258 i‡(
	`NdisEquÆMem‹y
(
pEid
->
O˘ë
, 
WME_PARM_ELEM
, 6Ë&& (pEid->
Lí
 == 24))

260 
PUCHAR
 
±r
;

261 
i
;

264 
pEdˇP¨m
->
bVÆid
 = 
TRUE
;

265 
pEdˇP¨m
->
bQAck
 = 
FALSE
;

266 
pEdˇP¨m
->
bQueueReque°
 = 
FALSE
;

267 
pEdˇP¨m
->
bTx›Reque°
 = 
FALSE
;

269 
pEdˇP¨m
->
EdˇUpd©eCou¡
 = 
pEid
->
O˘ë
[6] & 0x0f;

270 
±r
 = &
pEid
->
O˘ë
[8];

271 
i
=0; i<4; i++)

273 
UCHAR
 
aci
 = (*
±r
 & 0x60) >> 5;

274 
pEdˇP¨m
->
bACM
[
aci
] = (((*
±r
) & 0x10) == 0x10);

275 
pEdˇP¨m
->
Aif¢
[
aci
] = (*
±r
) & 0x0f;

276 
pEdˇP¨m
->
Cwmö
[
aci
] = *(
±r
+1) & 0x0f;

277 
pEdˇP¨m
->
Cwmax
[
aci
] = *(
±r
+1) >> 4;

278 
pEdˇP¨m
->
Tx›
[
aci
] = *(
±r
+2) + 256 * (*(ptr+3));

279 
±r
 += 4;

285 
IE_EDCA_PARAMETER
:

286 i‡(
pEid
->
Lí
 == 18)

288 
PUCHAR
 
±r
;

289 
i
;

290 
pEdˇP¨m
->
bVÆid
 = 
TRUE
;

291 
pEdˇP¨m
->
bQAck
 = 
pEid
->
O˘ë
[0] & 0x10;

292 
pEdˇP¨m
->
bQueueReque°
 = 
pEid
->
O˘ë
[0] & 0x20;

293 
pEdˇP¨m
->
bTx›Reque°
 = 
pEid
->
O˘ë
[0] & 0x40;

295 
pEdˇP¨m
->
EdˇUpd©eCou¡
 = 
pEid
->
O˘ë
[0] & 0x0f;

296 
±r
 = &
pEid
->
O˘ë
[2];

297 
i
=0; i<4; i++)

299 
UCHAR
 
aci
 = (*
±r
 & 0x60) >> 5;

300 
pEdˇP¨m
->
bACM
[
aci
] = (((*
±r
) & 0x10) == 0x10);

301 
pEdˇP¨m
->
Aif¢
[
aci
] = (*
±r
) & 0x0f;

302 
pEdˇP¨m
->
Cwmö
[
aci
] = *(
±r
+1) & 0x0f;

303 
pEdˇP¨m
->
Cwmax
[
aci
] = *(
±r
+1) >> 4;

304 
pEdˇP¨m
->
Tx›
[
aci
] = *(
±r
+2) + 256 * (*(ptr+3));

305 
±r
 += 4;

311 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "PìrAssocR•S™ôy - ign‹êuƒecognized EID = %d\n", 
pEid
->
Eid
);

315 
Lígth
 = Lígth + 2 + 
pEid
->
Lí
;

316 
pEid
 = (
PEID_STRUCT
)((
UCHAR
*ÌEid + 2 +ÖEid->
Lí
);

319  
TRUE
;

320 
	}
}

330 
BOOLEAN
 
	$PìrDißssocS™ôy
(

331 
IN
 
PRTMP_ADAPTER
 
pAd
,

332 
IN
 
VOID
 *
Msg
,

333 
IN
 
ULONG
 
MsgLí
,

334 
OUT
 
PUCHAR
 
pAddr2
,

335 
OUT
 
USHORT
 *
pRós⁄
)

337 
PFRAME_802_11
 
pFøme
 = (PFRAME_802_11)
Msg
;

339 
	`COPY_MAC_ADDR
(
pAddr2
, 
pFøme
->
Hdr
.
Addr2
);

340 
	`NdisMoveMem‹y
(
pRós⁄
, &
pFøme
->
O˘ë
[0], 2);

342  
TRUE
;

343 
	}
}

353 
BOOLEAN
 
	$PìrDóuthS™ôy
(

354 
IN
 
PRTMP_ADAPTER
 
pAd
,

355 
IN
 
VOID
 *
Msg
,

356 
IN
 
ULONG
 
MsgLí
,

357 
OUT
 
PUCHAR
 
pAddr2
,

358 
OUT
 
USHORT
 *
pRós⁄
)

360 
PFRAME_802_11
 
pFøme
 = (PFRAME_802_11)
Msg
;

362 
	`COPY_MAC_ADDR
(
pAddr2
, 
pFøme
->
Hdr
.
Addr2
);

363 
	`NdisMoveMem‹y
(
pRós⁄
, &
pFøme
->
O˘ë
[0], 2);

365  
TRUE
;

366 
	}
}

376 
BOOLEAN
 
	$PìrAuthS™ôy
(

377 
IN
 
PRTMP_ADAPTER
 
pAd
,

378 
IN
 
VOID
 *
Msg
,

379 
IN
 
ULONG
 
MsgLí
,

380 
OUT
 
PUCHAR
 
pAddr
,

381 
OUT
 
USHORT
 *
pAlg
,

382 
OUT
 
USHORT
 *
pSeq
,

383 
OUT
 
USHORT
 *
pSètus
,

384 
CHAR
 *
pChlgText
)

386 
PFRAME_802_11
 
pFøme
 = (PFRAME_802_11)
Msg
;

388 
	`COPY_MAC_ADDR
(
pAddr
, 
pFøme
->
Hdr
.
Addr2
);

389 
	`NdisMoveMem‹y
(
pAlg
, &
pFøme
->
O˘ë
[0], 2);

390 
	`NdisMoveMem‹y
(
pSeq
, &
pFøme
->
O˘ë
[2], 2);

391 
	`NdisMoveMem‹y
(
pSètus
, &
pFøme
->
O˘ë
[4], 2);

393 i‡(*
pAlg
 =
Ndis802_11AuthModeO≥n
)

395 i‡(*
pSeq
 == 1 || *pSeq == 2)

397  
TRUE
;

401 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "PeerAuthSanity fail - wrong Seg#\n");

402  
FALSE
;

405 i‡(*
pAlg
 =
Ndis802_11AuthModeSh¨ed
)

407 i‡(*
pSeq
 == 1 || *pSeq == 4)

409  
TRUE
;

411 i‡(*
pSeq
 == 2 || *pSeq == 3)

413 
	`NdisMoveMem‹y
(
pChlgText
, &
pFøme
->
O˘ë
[8], 
CIPHER_TEXT_LEN
);

414  
TRUE
;

418 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "PeerAuthSanity fail - wrong Seg#\n");

419  
FALSE
;

424 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "PeerAuthSanity fail - wrongálgorithm\n");

425  
FALSE
;

427 
	}
}

437 
BOOLEAN
 
	$PìrProbeReqS™ôy
(

438 
IN
 
PRTMP_ADAPTER
 
pAd
,

439 
IN
 
VOID
 *
Msg
,

440 
IN
 
ULONG
 
MsgLí
,

441 
OUT
 
PUCHAR
 
pAddr2
,

442 
OUT
 
CHAR
 
Ssid
[],

443 
OUT
 
UCHAR
 *
pSsidLí
)

445 
UCHAR
 
Idx
;

446 
UCHAR
 
R©eLí
;

447 
CHAR
 
IeTy≥
;

448 
PFRAME_802_11
 
pFøme
 = (PFRAME_802_11)
Msg
;

450 
	`COPY_MAC_ADDR
(
pAddr2
, 
pFøme
->
Hdr
.
Addr2
);

452 i‡((
pFøme
->
O˘ë
[0] !
IE_SSID
Ë|| (pFøme->O˘ë[1] > 
MAX_LEN_OF_SSID
))

454 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "PìrProbeReqS™ôy faû - wr⁄g SSID IE(Ty≥=%d,Lí=%d)\n",
pFøme
->
O˘ë
[0],pFrame->Octet[1]);

455  
FALSE
;

458 *
pSsidLí
 = 
pFøme
->
O˘ë
[1];

459 
	`NdisMoveMem‹y
(
Ssid
, &
pFøme
->
O˘ë
[2], *
pSsidLí
);

461 
Idx
 = *
pSsidLí
 + 2;

464 
IeTy≥
 = 
pFøme
->
O˘ë
[
Idx
];

465 
R©eLí
 = 
pFøme
->
O˘ë
[
Idx
 + 1];

466 i‡(
IeTy≥
 !
IE_SUPP_RATES
)

468 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "PìrProbeReqS™ôy faû - wr⁄g Suµ‹tR©e†IE(Ty≥=%d,Lí=%d)\n",
pFøme
->
O˘ë
[
Idx
],pFrame->Octet[Idx+1]);

469  
FALSE
;

473 i‡((
pAd
->
P‹tCfg
.
AdhocMode
 =2Ë&& (
R©eLí
 < 8))

474  (
FALSE
);

477  
TRUE
;

478 
	}
}

488 
BOOLEAN
 
	$PìrBóc⁄AndProbeR•S™ôy
(

489 
IN
 
PRTMP_ADAPTER
 
pAd
,

490 
IN
 
VOID
 *
Msg
,

491 
IN
 
ULONG
 
MsgLí
,

492 
OUT
 
PUCHAR
 
pAddr2
,

493 
OUT
 
PUCHAR
 
pBssid
,

494 
OUT
 
CHAR
 
Ssid
[],

495 
OUT
 
UCHAR
 *
pSsidLí
,

496 
OUT
 
UCHAR
 *
pBssTy≥
,

497 
OUT
 
USHORT
 *
pBóc⁄Pîiod
,

498 
OUT
 
UCHAR
 *
pCh™√l
,

499 
OUT
 
UCHAR
 *
pNewCh™√l
,

500 
OUT
 
LARGE_INTEGER
 *
pTime°amp
,

501 
OUT
 
CF_PARM
 *
pCfP¨m
,

502 
OUT
 
USHORT
 *
pAtimWö
,

503 
OUT
 
USHORT
 *
pC≠abûôyInfo
,

504 
OUT
 
UCHAR
 *
pEΩ
,

505 
OUT
 
UCHAR
 *
pDtimCou¡
,

506 
OUT
 
UCHAR
 *
pDtimPîiod
,

507 
OUT
 
UCHAR
 *
pBˇ°Fœg
,

508 
OUT
 
UCHAR
 *
pMesßgeToMe
,

509 
OUT
 
UCHAR
 
SupR©e
[],

510 
OUT
 
UCHAR
 *
pSupR©eLí
,

511 
OUT
 
UCHAR
 
ExtR©e
[],

512 
OUT
 
UCHAR
 *
pExtR©eLí
,

513 
OUT
 
UCHAR
 *
pCkùFœg
,

514 
OUT
 
UCHAR
 *
pAú⁄ëCñlPowîLimô
,

515 
OUT
 
PEDCA_PARM
 
pEdˇP¨m
,

516 
OUT
 
PQBSS_LOAD_PARM
 
pQbssLﬂd
,

517 
OUT
 
PQOS_CAPABILITY_PARM
 
pQosC≠abûôy
,

518 
OUT
 
ULONG
 *
pRÆökIe
,

520 
OUT
 
USHORT
 *
LígthVIE
,

521 
OUT
 
PNDIS_802_11_VARIABLE_IEs
 
pVIE
)

523 
CHAR
 *
På
, 
TimLí
;

524 
PFRAME_802_11
 
pFøme
;

525 
PEID_STRUCT
 
pEid
;

526 
UCHAR
 
SubTy≥
;

527 
UCHAR
 
S™ôy
;

528 
ULONG
 
Lígth
 = 0;

531 
S™ôy
 = 0;

533 *
pAtimWö
 = 0;

534 *
pEΩ
 = 0;

535 *
pDtimCou¡
 = 0;

536 *
pDtimPîiod
 = 0;

537 *
pBˇ°Fœg
 = 0;

538 *
pMesßgeToMe
 = 0;

539 *
pExtR©eLí
 = 0;

540 *
pCkùFœg
 = 0;

541 *
pAú⁄ëCñlPowîLimô
 = 0xFF;

542 *
LígthVIE
 = 0;

543 *
pRÆökIe
 = 0;

544 *
pNewCh™√l
 = 0;

545 
pCfP¨m
->
bVÆid
 = 
FALSE
;

546 
pQbssLﬂd
->
bVÆid
 = 
FALSE
;

547 
pEdˇP¨m
->
bVÆid
 = 
FALSE
;

548 
pQosC≠abûôy
->
bVÆid
 = 
FALSE
;

550 
pFøme
 = (
PFRAME_802_11
)
Msg
;

553 
SubTy≥
 = (
UCHAR
)
pFøme
->
Hdr
.
FC
.SubType;

556 
	`COPY_MAC_ADDR
(
pAddr2
, 
pFøme
->
Hdr
.
Addr2
);

557 
	`COPY_MAC_ADDR
(
pBssid
, 
pFøme
->
Hdr
.
Addr3
);

559 
På
 = 
pFøme
->
O˘ë
;

560 
Lígth
 +
LENGTH_802_11
;

563 
	`NdisMoveMem‹y
(
pTime°amp
, 
På
, 
TIMESTAMP_LEN
);

564 
På
 +
TIMESTAMP_LEN
;

565 
Lígth
 +
TIMESTAMP_LEN
;

568 
	`NdisMoveMem‹y
(
pBóc⁄Pîiod
, 
På
, 2);

569 
På
 += 2;

570 
Lígth
 += 2;

573 
	`NdisMoveMem‹y
(
pC≠abûôyInfo
, 
På
, 2);

574 
På
 += 2;

575 
Lígth
 += 2;

577 i‡(
	`CAP_IS_ESS_ON
(*
pC≠abûôyInfo
))

578 *
pBssTy≥
 = 
BSS_INFRA
;

580 *
pBssTy≥
 = 
BSS_ADHOC
;

582 
pEid
 = (
PEID_STRUCT
Ë
På
;

585 (
Lígth
 + 2 + 
pEid
->
Lí
Ë<
MsgLí
)

588 
pEid
->
Eid
)

590 
IE_SSID
:

592 i‡(
S™ôy
 & 0x1)

594 if(
pEid
->
Lí
 <
MAX_LEN_OF_SSID
)

596 
	`NdisMoveMem‹y
(
Ssid
, 
pEid
->
O˘ë
,ÖEid->
Lí
);

597 *
pSsidLí
 = 
pEid
->
Lí
;

598 
S™ôy
 |= 0x1;

602 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "PìrBóc⁄AndProbeR•S™ôy - wr⁄g IE_SSID (Àn=%d)\n",
pEid
->
Lí
);

603  
FALSE
;

607 
IE_SUPP_RATES
:

608 if(
pEid
->
Lí
 <
MAX_LEN_OF_SUPPORTED_RATES
)

610 
S™ôy
 |= 0x2;

611 
	`NdisMoveMem‹y
(
SupR©e
, 
pEid
->
O˘ë
,ÖEid->
Lí
);

612 *
pSupR©eLí
 = 
pEid
->
Lí
;

622 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "PìrBóc⁄AndProbeR•S™ôy - wr⁄g IE_SUPP_RATES (Àn=%d)\n",
pEid
->
Lí
);

623  
FALSE
;

627 
IE_FH_PARM
:

628 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "PeerBeaconAndProbeRspSanity(IE_FH_PARM) \n");

631 
IE_DS_PARM
:

632 if(
pEid
->
Lí
 == 1)

634 *
pCh™√l
 = *
pEid
->
O˘ë
;

635 i‡(
	`Ch™√lS™ôy
(
pAd
, *
pCh™√l
) == 0)

637 
	`DBGPRINT
(
RT_DEBUG_INFO
, "PìrBóc⁄AndProbeR•S™ôy - wr⁄g IE_DS_PARM (ch=%d)\n",*
pCh™√l
);

638  
FALSE
;

640 
S™ôy
 |= 0x4;

644 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "PìrBóc⁄AndProbeR•S™ôy - wr⁄g IE_DS_PARM (Àn=%d)\n",
pEid
->
Lí
);

645  
FALSE
;

649 
IE_CF_PARM
:

650 if(
pEid
->
Lí
 == 6)

652 
pCfP¨m
->
bVÆid
 = 
TRUE
;

653 
pCfP¨m
->
CÂCou¡
 = 
pEid
->
O˘ë
[0];

654 
pCfP¨m
->
CÂPîiod
 = 
pEid
->
O˘ë
[1];

655 
pCfP¨m
->
CÂMaxDuøti⁄
 = 
pEid
->
O˘ë
[2] + 256 *ÖEid->Octet[3];

656 
pCfP¨m
->
CÂDurRemaöög
 = 
pEid
->
O˘ë
[4] + 256 *ÖEid->Octet[5];

660 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "PeerBeaconAndProbeRspSanity - wrong IE_CF_PARM\n");

661  
FALSE
;

665 
IE_IBSS_PARM
:

666 if(
pEid
->
Lí
 == 2)

668 
	`NdisMoveMem‹y
(
pAtimWö
, 
pEid
->
O˘ë
,ÖEid->
Lí
);

672 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "PeerBeaconAndProbeRspSanity - wrong IE_IBSS_PARM\n");

673  
FALSE
;

677 
IE_TIM
:

678 if(
	`INFRA_ON
(
pAd
Ë&& 
SubTy≥
 =
SUBTYPE_BEACON
)

680 
	`GëTimBô
((
PUCHAR
)
pEid
, 
pAd
->
A˘iveCfg
.
Aid
, &
TimLí
, 
pBˇ°Fœg
, 
pDtimCou¡
, 
pDtimPîiod
, 
pMesßgeToMe
);

684 
IE_CHANNEL_SWITCH_ANNOUNCEMENT
:

685 if(
pEid
->
Lí
 == 3)

687 *
pNewCh™√l
 = 
pEid
->
O˘ë
[1];

694 
IE_VENDOR_SPECIFIC
:

696 i‡(
	`NdisEquÆMem‹y
(
pEid
->
O˘ë
, 
RALINK_OUI
, 3Ë&& (pEid->
Lí
 == 7))

698 *
pRÆökIe
 = 
pEid
->
O˘ë
[3];

700 i‡(
	`NdisEquÆMem‹y
(
pEid
->
O˘ë
, 
WPA_OUI
, 4))

703 
På
 = (
PUCHAR
Ë
pVIE
;

706 i‡((*
LígthVIE
 + 
pEid
->
Lí
 + 2Ë>
MAX_VIE_LEN
)

708 
	`DBGPRINT
(
RT_DEBUG_WARN
, "PeerBeaconAndProbeRspSanity - Variable IEs out ofÑesource [len(=%d) > MAX_VIE_LEN(=%d)]\n",

709 (*
LígthVIE
 + 
pEid
->
Lí
 + 2), 
MAX_VIE_LEN
);

713 
	`NdisMoveMem‹y
(
På
 + *
LígthVIE
, &
pEid
->
Eid
,ÖEid->
Lí
 + 2);

714 *
LígthVIE
 +(
pEid
->
Lí
 + 2);

716 i‡(
	`NdisEquÆMem‹y
(
pEid
->
O˘ë
, 
WME_PARM_ELEM
, 6Ë&& (pEid->
Lí
 == 24))

718 
PUCHAR
 
±r
;

719 
i
;

722 
pEdˇP¨m
->
bVÆid
 = 
TRUE
;

723 
pEdˇP¨m
->
bQAck
 = 
FALSE
;

724 
pEdˇP¨m
->
bQueueReque°
 = 
FALSE
;

725 
pEdˇP¨m
->
bTx›Reque°
 = 
FALSE
;

726 
pEdˇP¨m
->
EdˇUpd©eCou¡
 = 
pEid
->
O˘ë
[6] & 0x0f;

727 
±r
 = &
pEid
->
O˘ë
[8];

728 
i
=0; i<4; i++)

730 
UCHAR
 
aci
 = (*
±r
 & 0x60) >> 5;

731 
pEdˇP¨m
->
bACM
[
aci
] = (((*
±r
) & 0x10) == 0x10);

732 
pEdˇP¨m
->
Aif¢
[
aci
] = (*
±r
) & 0x0f;

733 
pEdˇP¨m
->
Cwmö
[
aci
] = *(
±r
+1) & 0x0f;

734 
pEdˇP¨m
->
Cwmax
[
aci
] = *(
±r
+1) >> 4;

735 
pEdˇP¨m
->
Tx›
[
aci
] = *(
±r
+2) + 256 * (*(ptr+3));

736 
±r
 += 4;

739 i‡(
	`NdisEquÆMem‹y
(
pEid
->
O˘ë
, 
WME_INFO_ELEM
, 6Ë&& (pEid->
Lí
 == 7))

742 
pEdˇP¨m
->
bVÆid
 = 
TRUE
;

743 
pEdˇP¨m
->
bQAck
 = 
FALSE
;

744 
pEdˇP¨m
->
bQueueReque°
 = 
FALSE
;

745 
pEdˇP¨m
->
bTx›Reque°
 = 
FALSE
;

746 
pEdˇP¨m
->
EdˇUpd©eCou¡
 = 
pEid
->
O˘ë
[6] & 0x0f;

749 
pEdˇP¨m
->
bACM
[
QID_AC_BE
] = 0;

750 
pEdˇP¨m
->
Aif¢
[
QID_AC_BE
] = 3;

751 
pEdˇP¨m
->
Cwmö
[
QID_AC_BE
] = 
CW_MIN_IN_BITS
;

752 
pEdˇP¨m
->
Cwmax
[
QID_AC_BE
] = 
CW_MAX_IN_BITS
;

753 
pEdˇP¨m
->
Tx›
[
QID_AC_BE
] = 0;

755 
pEdˇP¨m
->
bACM
[
QID_AC_BK
] = 0;

756 
pEdˇP¨m
->
Aif¢
[
QID_AC_BK
] = 7;

757 
pEdˇP¨m
->
Cwmö
[
QID_AC_BK
] = 
CW_MIN_IN_BITS
;

758 
pEdˇP¨m
->
Cwmax
[
QID_AC_BK
] = 
CW_MAX_IN_BITS
;

759 
pEdˇP¨m
->
Tx›
[
QID_AC_BK
] = 0;

761 
pEdˇP¨m
->
bACM
[
QID_AC_VI
] = 0;

762 
pEdˇP¨m
->
Aif¢
[
QID_AC_VI
] = 2;

763 
pEdˇP¨m
->
Cwmö
[
QID_AC_VI
] = 
CW_MIN_IN_BITS
-1;

764 
pEdˇP¨m
->
Cwmax
[
QID_AC_VI
] = 
CW_MAX_IN_BITS
;

765 
pEdˇP¨m
->
Tx›
[
QID_AC_VI
] = 96;

767 
pEdˇP¨m
->
bACM
[
QID_AC_VO
] = 0;

768 
pEdˇP¨m
->
Aif¢
[
QID_AC_VO
] = 2;

769 
pEdˇP¨m
->
Cwmö
[
QID_AC_VO
] = 
CW_MIN_IN_BITS
-2;

770 
pEdˇP¨m
->
Cwmax
[
QID_AC_VO
] = 
CW_MAX_IN_BITS
-1;

771 
pEdˇP¨m
->
Tx›
[
QID_AC_VO
] = 48;

779 i‡((*
LígthVIE
 + 
pEid
->
Lí
 + 2Ë>
MAX_VIE_LEN
)

781 
	`DBGPRINT
(
RT_DEBUG_WARN
, "PeerBeaconAndProbeRspSanity - Variable IEs out ofÑesource [len(=%d) > MAX_VIE_LEN(=%d)]\n",

782 (*
LígthVIE
 + 
pEid
->
Lí
 + 2), 
MAX_VIE_LEN
);

786 
På
 = (
PUCHAR
Ë
pVIE
;

787 
	`NdisMoveMem‹y
(
På
 + *
LígthVIE
, &
pEid
->
Eid
,ÖEid->
Lí
 + 2);

788 *
LígthVIE
 +(
pEid
->
Lí
 + 2);

793 
	`DBGPRINT
(
RT_DEBUG_INFO
, "PeerBeaconAndProbeRspSanity - Receive IE_WPA\n");

796 
IE_EXT_SUPP_RATES
:

797 i‡(
pEid
->
Lí
 <
MAX_LEN_OF_SUPPORTED_RATES
)

799 
	`NdisMoveMem‹y
(
ExtR©e
, 
pEid
->
O˘ë
,ÖEid->
Lí
);

800 *
pExtR©eLí
 = 
pEid
->
Lí
;

810 
IE_ERP
:

811 i‡(
pEid
->
Lí
 == 1)

813 *
pEΩ
 = (
UCHAR
)
pEid
->
O˘ë
[0];

818 
IE_RSN
:

820 i‡(
	`RTMPEquÆMem‹y
(
pEid
->
O˘ë
 + 2, 
RSN_OUI
, 3))

823 
På
 = (
PUCHAR
Ë
pVIE
;

826 i‡((*
LígthVIE
 + 
pEid
->
Lí
 + 2Ë>
MAX_VIE_LEN
)

828 
	`DBGPRINT
(
RT_DEBUG_WARN
, "PeerBeaconAndProbeRspSanity - Variable IEs out ofÑesource [len(=%d) > MAX_VIE_LEN(=%d)]\n",

829 (*
LígthVIE
 + 
pEid
->
Lí
 + 2), 
MAX_VIE_LEN
);

833 
	`NdisMoveMem‹y
(
På
 + *
LígthVIE
, &
pEid
->
Eid
,ÖEid->
Lí
 + 2);

834 *
LígthVIE
 +(
pEid
->
Lí
 + 2);

836 
	`DBGPRINT
(
RT_DEBUG_INFO
, "IE_RSNÜígth = %d\n", 
pEid
->
Lí
);

839 
IE_QBSS_LOAD
:

840 i‡(
pEid
->
Lí
 == 5)

842 
pQbssLﬂd
->
bVÆid
 = 
TRUE
;

843 
pQbssLﬂd
->
SèNum
 = 
pEid
->
O˘ë
[0] +ÖEid->Octet[1] * 256;

844 
pQbssLﬂd
->
Ch™√lUtûiz©i⁄
 = 
pEid
->
O˘ë
[2];

845 
pQbssLﬂd
->
RemaöögAdmissi⁄C⁄åﬁ
 = 
pEid
->
O˘ë
[3] +ÖEid->Octet[4] * 256;

849 
IE_EDCA_PARAMETER
:

850 i‡(
pEid
->
Lí
 == 18)

852 
PUCHAR
 
±r
;

853 
i
;

854 
pEdˇP¨m
->
bVÆid
 = 
TRUE
;

855 
pEdˇP¨m
->
bQAck
 = 
pEid
->
O˘ë
[0] & 0x10;

856 
pEdˇP¨m
->
bQueueReque°
 = 
pEid
->
O˘ë
[0] & 0x20;

857 
pEdˇP¨m
->
bTx›Reque°
 = 
pEid
->
O˘ë
[0] & 0x40;

859 
pEdˇP¨m
->
EdˇUpd©eCou¡
 = 
pEid
->
O˘ë
[0] & 0x0f;

860 
±r
 = &
pEid
->
O˘ë
[2];

861 
i
=0; i<4; i++)

863 
UCHAR
 
aci
 = (*
±r
 & 0x60) >> 5;

864 
pEdˇP¨m
->
bACM
[
aci
] = (((*
±r
) & 0x10) == 0x10);

865 
pEdˇP¨m
->
Aif¢
[
aci
] = (*
±r
) & 0x0f;

866 
pEdˇP¨m
->
Cwmö
[
aci
] = *(
±r
+1) & 0x0f;

867 
pEdˇP¨m
->
Cwmax
[
aci
] = *(
±r
+1) >> 4;

868 
pEdˇP¨m
->
Tx›
[
aci
] = *(
±r
+2) + 256 * (*(ptr+3));

869 
±r
 += 4;

874 
IE_QOS_CAPABILITY
:

876 i‡(
pEid
->
Lí
 == 1)

878 
pQosC≠abûôy
->
bVÆid
 = 
TRUE
;

879 
pQosC≠abûôy
->
bQAck
 = 
pEid
->
O˘ë
[0] & 0x01;

880 
pQosC≠abûôy
->
bQueueReque°
 = 
pEid
->
O˘ë
[0] & 0x02;

881 
pQosC≠abûôy
->
bTx›Reque°
 = 
pEid
->
O˘ë
[0] & 0x04;

883 
pQosC≠abûôy
->
EdˇUpd©eCou¡
 = 
pEid
->
O˘ë
[0] >> 4;

890 
	`DBGPRINT
(
RT_DEBUG_INFO
, "PìrBóc⁄AndProbeR•S™ôy - uƒecognized EID = %d\n", 
pEid
->
Eid
);

894 
Lígth
 = Lígth + 2 + 
pEid
->
Lí
;

895 
pEid
 = (
PEID_STRUCT
)((
UCHAR
*ÌEid + 2 +ÖEid->
Lí
);

899 i‡((
pAd
->
L©chRfRegs
.
Ch™√l
 > 14Ë&& ((
S™ôy
 & 0x04) == 0))

901 *
pCh™√l
 = 
pAd
->
L©chRfRegs
.
Ch™√l
;

902 
S™ôy
 |= 0x4;

905 i‡(
S™ôy
 != 0x7)

907 
	`DBGPRINT
(
RT_DEBUG_WARN
, "PìrBóc⁄AndProbeR•S™ôy - missög fõld, S™ôy=0x%02x\n", 
S™ôy
);

908  
FALSE
;

912  
TRUE
;

915 
	}
}

923 
BOOLEAN
 
	$GëTimBô
(

924 
IN
 
CHAR
 *
På
,

925 
IN
 
USHORT
 
Aid
,

926 
OUT
 
UCHAR
 *
TimLí
,

927 
OUT
 
UCHAR
 *
Bˇ°Fœg
,

928 
OUT
 
UCHAR
 *
DtimCou¡
,

929 
OUT
 
UCHAR
 *
DtimPîiod
,

930 
OUT
 
UCHAR
 *
MesßgeToMe
)

932 
UCHAR
 
BôC¡l
, 
N1
, 
N2
, 
MyByã
, 
MyBô
;

933 
CHAR
 *
IdxPå
;

935 
IdxPå
 = 
På
;

937 
IdxPå
 ++;

938 *
TimLí
 = *
IdxPå
;

941 
IdxPå
 ++;

942 *
DtimCou¡
 = *
IdxPå
;

945 
IdxPå
++;

946 *
DtimPîiod
 = *
IdxPå
;

949 
IdxPå
++;

950 
BôC¡l
 = *
IdxPå
;

952 i‡((*
DtimCou¡
 =0Ë&& (
BôC¡l
 & 0x01))

953 *
Bˇ°Fœg
 = 
TRUE
;

955 *
Bˇ°Fœg
 = 
FALSE
;

958 
N1
 = 
BôC¡l
 & 0xfe;

959 
N2
 = *
TimLí
 - 4 + 
N1
;

961 i‡((
Aid
 < (
N1
 << 3)Ë|| (Aid >((
N2
 + 1) << 3)))

962 *
MesßgeToMe
 = 
FALSE
;

965 
MyByã
 = (
Aid
 >> 3Ë- 
N1
;

966 
MyBô
 = 
Aid
 % 16 - ((
MyByã
 & 0x01)? 8:0);

968 
IdxPå
 +(
MyByã
 + 1);

973 i‡(*
IdxPå
 & (0x01 << 
MyBô
))

974 *
MesßgeToMe
 = 
TRUE
;

976 *
MesßgeToMe
 = 
FALSE
;

979  
TRUE
;

980 
	}
}

982 
UCHAR
 
	$Ch™√lS™ôy
(

983 
IN
 
PRTMP_ADAPTER
 
pAd
,

984 
IN
 
UCHAR
 
ch™√l
)

986 
i
;

988 
i
 = 0; i < 
pAd
->
Ch™√lLi°Num
; i ++)

990 i‡(
ch™√l
 =
pAd
->
Ch™√lLi°
[
i
].
Ch™√l
)

994 
	}
}

1015 
NDIS_802_11_NETWORK_TYPE
 
	$Nëw‹kTy≥InU£S™ôy
(

1016 
IN
 
UCHAR
 
Ch™√l
,

1017 
IN
 
UCHAR
 
SupR©e
[],

1018 
IN
 
UCHAR
 
SupR©eLí
,

1019 
IN
 
UCHAR
 
ExtR©e
[],

1020 
IN
 
UCHAR
 
ExtR©eLí
)

1022 
NDIS_802_11_NETWORK_TYPE
 
NëW‹kTy≥
;

1023 
UCHAR
 
Ty≥
 = 0;

1026 
Ty≥
 = 
	`PìrTxTy≥InU£S™ôy
(
Ch™√l
, 
SupR©e
, 
SupR©eLí
, 
ExtR©e
, 
ExtR©eLí
);

1027 
Ty≥
)

1029 
CCK_RATE
:

1030 
NëW‹kTy≥
 = 
Ndis802_11DS
;

1032 
OFDM_RATE
:

1033 i‡(
Ch™√l
 > 14)

1034 
NëW‹kTy≥
 = 
Ndis802_11OFDM5
;

1036 
NëW‹kTy≥
 = 
Ndis802_11OFDM24
;

1038 
CCKOFDM_RATE
:

1039 
NëW‹kTy≥
 = 
Ndis802_11OFDM24
;

1042 
NëW‹kTy≥
 = 
Ndis802_11DS
;

1046  
NëW‹kTy≥
;

1047 
	}
}

1066 
UCHAR
 
	$PìrTxTy≥InU£S™ôy
(

1067 
IN
 
UCHAR
 
Ch™√l
,

1068 
IN
 
UCHAR
 
SupR©e
[],

1069 
IN
 
UCHAR
 
SupR©eLí
,

1070 
IN
 
UCHAR
 
ExtR©e
[],

1071 
IN
 
UCHAR
 
ExtR©eLí
)

1073 
UCHAR
 
øã
, 
i
;

1074 
UCHAR
 
Ty≥
 = 0;

1076 i‡(
Ch™√l
 <= 14)

1081 
i
 = 0; i < 
SupR©eLí
; i++)

1083 
øã
 = 
SupR©e
[
i
] & 0x7f;

1084 i‡((
øã
 == 2) || (rate == 4) || (rate == 11) || (rate == 22))

1086 
Ty≥
 |= 0x01;

1094 
Ty≥
 |= 0x02;

1103 i‡((
Ty≥
 & 0x02) == 0)

1105 
i
 = 0; i < 
ExtR©eLí
; i++)

1107 
øã
 = 
ExtR©e
[
i
] & 0x7f;

1108 i‡((
øã
 == 2) || (rate == 4) || (rate == 11) || (rate == 22))

1117 
Ty≥
 |= 0x02;

1125 
Ty≥
 |= 0x02;

1128  
Ty≥
;

1129 
	}
}

1149 
NDIS_STATUS
 
	$RTMPWPAWïKeyS™ôy
(

1150 
IN
 
PRTMP_ADAPTER
 
pAd
,

1151 
IN
 
PVOID
 
pBuf
)

1153 
PNDIS_802_11_KEY
 
pKey
;

1154 
ULONG
 
KeyIdx
;

1155 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

1156 
BOOLEAN
 
bTxKey
;

1157 
BOOLEAN
 
bPaúwi£
;

1161 
pKey
 = (
PNDIS_802_11_KEY
Ë
pBuf
;

1162 
KeyIdx
 = 
pKey
->
KeyIndex
 & 0x0fffffff;

1164 
bTxKey
 = (
pKey
->
KeyIndex
 & 0x80000000Ë? 
TRUE
 : 
FALSE
;

1166 
bPaúwi£
 = (
pKey
->
KeyIndex
 & 0x40000000Ë? 
TRUE
 : 
FALSE
;

1169 i‡(
bPaúwi£
)

1173 i‡(
KeyIdx
 > 4)

1174  (
NDIS_STATUS_FAILURE
);

1177 i‡(
bTxKey
 =
FALSE
)

1178 (
NDIS_STATUS_FAILURE
);

1181 i‡(
	`MAC_ADDR_EQUAL
(
pKey
->
BSSID
, 
BROADCAST_ADDR
))

1182 (
NDIS_STATUS_FAILURE
);

1185 i‡((
pKey
->
KeyLígth
 != 5) && (pKey->KeyLength != 13))

1186 (
NDIS_STATUS_FAILURE
);

1193 i‡((! 
	`MAC_ADDR_EQUAL
(
pKey
->
BSSID
, 
BROADCAST_ADDR
)) &&

1194 (! 
	`MAC_ADDR_EQUAL
(
pKey
->
BSSID
, 
pAd
->
P‹tCfg
.
Bssid
)))

1195 (
NDIS_STATUS_FAILURE
);

1198 i‡(
KeyIdx
 > 4)

1199 (
NDIS_STATUS_FAILURE
);

1203 i‡(
pKey
->
KeyIndex
 & 0x80000000)

1206 
pAd
->
P‹tCfg
.
DeÁu…KeyId
 = (
UCHAR
Ë
KeyIdx
;

1211  (
Sètus
);

1212 
	}
}

1214 
NDIS_STATUS
 
	$RTMPRemoveKeyS™ôy
(

1215 
IN
 
PRTMP_ADAPTER
 
pAd
,

1216 
IN
 
PVOID
 
pBuf
)

1218 
PNDIS_802_11_REMOVE_KEY
 
pKey
;

1219 
ULONG
 
KeyIdx
;

1220 
NDIS_STATUS
 
Sètus
 = 
NDIS_STATUS_FAILURE
;

1221 
BOOLEAN
 
bTxKey
;

1222 
BOOLEAN
 
bPaúwi£
;

1223 
BOOLEAN
 
bKeyRSC
;

1225 
BOOLEAN
 
bAuthítiˇt‹
;

1226 
INT
 
i
;

1228 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"---> RTMPWPARemoveKeyProc\n");

1230 
pKey
 = (
PNDIS_802_11_REMOVE_KEY
Ë
pBuf
;

1232 i‡(
pAd
->
P‹tCfg
.
AuthMode
 >
Ndis802_11AuthModeWPA
)

1234 
pKey
 = (
PNDIS_802_11_REMOVE_KEY
Ë
pBuf
;

1235 
KeyIdx
 = 
pKey
->
KeyIndex
 & 0xff;

1237 
bTxKey
 = (
pKey
->
KeyIndex
 & 0x80000000Ë? 
TRUE
 : 
FALSE
;

1239 
bPaúwi£
 = (
pKey
->
KeyIndex
 & 0x40000000Ë? 
TRUE
 : 
FALSE
;

1241 
bKeyRSC
 = (
pKey
->
KeyIndex
 & 0x20000000Ë? 
TRUE
 : 
FALSE
;

1243 
bAuthítiˇt‹
 = (
pKey
->
KeyIndex
 & 0x10000000Ë? 
TRUE
 : 
FALSE
;

1246 i‡(
bTxKey
 =
TRUE
)

1247 (
NDIS_STATUS_FAILURE
);

1250 i‡(
bPaúwi£
)

1254 
i
 = 0; i < 
SHARE_KEY_NUM
; i++)

1256 i‡(
	`MAC_ADDR_EQUAL
(
pAd
->
Sh¨edKey
[
i
].
BssId
, 
pKey
->
BSSID
))

1258 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"RTMPWPARemoveKeyProc(KeyIdx=%d)\n", 
i
);

1259 
pAd
->
Sh¨edKey
[
i
].
KeyLí
 = 0;

1260 
pAd
->
Sh¨edKey
[
i
].
CùhîAlg
 = 
CIPHER_NONE
;

1261 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

1271 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"RTMPWPARemoveKeyProc(KeyIdx=%d)\n", 
KeyIdx
);

1272 
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 = 0;

1273 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = 
CIPHER_NONE
;

1274 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

1279 
KeyIdx
 = 
pKey
->
KeyIndex
;

1281 i‡(
KeyIdx
 & 0x80000000)

1284 
Sètus
 = 
NDIS_STATUS_FAILURE
;

1288 
KeyIdx
 = KeyIdx & 0x0fffffff;

1289 i‡(
KeyIdx
 > 4)

1290 
Sètus
 = 
NDIS_STATUS_FAILURE
;

1293 
pAd
->
Sh¨edKey
[
KeyIdx
].
KeyLí
 = 0;

1294 
pAd
->
Sh¨edKey
[
KeyIdx
].
CùhîAlg
 = 
CIPHER_NONE
;

1295 
Sètus
 = 
NDIS_STATUS_SUCCESS
;

1300  (
Sètus
);

1301 
	}
}

1312 
BOOLEAN
 
	$BackDo‹ProbeR•S™ôy
(

1313 
IN
 
PRTMP_ADAPTER
 
pAd
,

1314 
IN
 
VOID
 *
Msg
,

1315 
IN
 
ULONG
 
MsgLí
,

1316 
OUT
 
CHAR
 *
pCfgD©aBuf
)

1319 
CHAR
 *
På
, 
CfgD©a
[255] = {0};

1320 
PEID_STRUCT
 
eid_±r
;

1321 
USHORT
 
cfgD©aLí
 = 0;

1325 
På
 = (
CHAR
 *)
Msg
;

1329 
På
 +
TIMESTAMP_LEN
;

1332 
På
 += 2;

1335 
På
 += 2;

1337 
eid_±r
 = (
PEID_STRUCT
Ë
På
;

1342 ((
UCHAR
*)
eid_±r
 +Éid_±r->
Lí
 + 1Ë< ((UCHAR*)
Msg
 + 
MsgLí
))

1345 
	`mem£t
(
CfgD©a
, 0, 255);

1346 
eid_±r
->
Eid
)

1348 
IE_VENDOR_SPECIFIC
:

1349 i‡(
	`NdisEquÆMem‹y
(
eid_±r
->
O˘ë
, 
RALINK_OUI
, 3))

1351 i‡((
eid_±r
->
O˘ë
[3] & 0x80) == 0x80)

1353 i‡–(
cfgD©aLí
 + 
eid_±r
->
Lí
 - 4Ë<
MAX_CFG_BUFFER_LEN
)

1356 
	`NdisMoveMem‹y
(
CfgD©a
, (
eid_±r
->
O˘ë
 + 4), (eid_±r->
Lí
 - 4));

1357 
	`¥ötk
("%s\n", 
CfgD©a
);

1358  
TRUE
;

1362 
	`¥ötk
("BackDoorProbeRspSanity: cfgDataLen > MAX_CFG_BUFFER_LEN\n");

1363  
FALSE
;

1366 i‡((
eid_±r
->
O˘ë
[3] & 0x40) == 0x40)

1369 
cfgD©aLí
 +(
eid_±r
->
Lí
 - 4);

1370 
	`NdisMoveMem‹y
(
CfgD©a
, (
eid_±r
->
O˘ë
 + 4), (eid_±r->
Lí
 - 4));

1371 i‡(
cfgD©aLí
 > 
MAX_CFG_BUFFER_LEN
)

1373 
	`¥ötk
("BackDoorProbeRspSanity: cfgDataLen > MAX_CFG_BUFFER_LEN\n");

1374  
FALSE
;

1377 
	`¥ötk
("%s", 
CfgD©a
);

1384 
eid_±r
 = (
PEID_STRUCT
)((
UCHAR
*Îid_±∏+ 2 +Éid_±r->
Lí
);

1388  
FALSE
;

1389 
	}
}

	@sync.c

38 
	~"π_c⁄fig.h
"

41 
	#BG_BAND_REGION_0_START
 0

42 
	#BG_BAND_REGION_0_SIZE
 11

	)

43 
	#BG_BAND_REGION_1_START
 0

44 
	#BG_BAND_REGION_1_SIZE
 13

	)

45 
	#BG_BAND_REGION_2_START
 9

46 
	#BG_BAND_REGION_2_SIZE
 2

	)

47 
	#BG_BAND_REGION_3_START
 9

48 
	#BG_BAND_REGION_3_SIZE
 4

	)

49 
	#BG_BAND_REGION_4_START
 13

50 
	#BG_BAND_REGION_4_SIZE
 1

	)

51 
	#BG_BAND_REGION_5_START
 0

52 
	#BG_BAND_REGION_5_SIZE
 14

	)

53 
	#BG_BAND_REGION_6_START
 2

54 
	#BG_BAND_REGION_6_SIZE
 7

	)

55 
	#BG_BAND_REGION_7_START
 4

56 
	#BG_BAND_REGION_7_SIZE
 9

	)

59 
UCHAR
 
	gA_BAND_REGION_0_CHANNEL_LIST
[]={36, 40, 44, 48, 52, 56, 60, 64, 149, 153, 157, 161, 165};

60 
UCHAR
 
	gA_BAND_REGION_1_CHANNEL_LIST
[]={36, 40, 44, 48, 52, 56, 60, 64, 100, 104, 108, 112, 116, 120, 124, 128, 132, 136, 140};

61 
UCHAR
 
	gA_BAND_REGION_2_CHANNEL_LIST
[]={36, 40, 44, 48, 52, 56, 60, 64};

62 
UCHAR
 
	gA_BAND_REGION_3_CHANNEL_LIST
[]={52, 56, 60, 64, 149, 153, 157, 161};

63 
UCHAR
 
	gA_BAND_REGION_4_CHANNEL_LIST
[]={149, 153, 157, 161, 165};

64 
UCHAR
 
	gA_BAND_REGION_5_CHANNEL_LIST
[]={149, 153, 157, 161};

65 
UCHAR
 
	gA_BAND_REGION_6_CHANNEL_LIST
[]={36, 40, 44, 48};

66 
UCHAR
 
	gA_BAND_REGION_7_CHANNEL_LIST
[]={36, 40, 44, 48, 52, 56, 60, 64, 100, 104, 108, 112, 116, 120, 124, 128, 132, 136, 140, 149, 153, 157, 161, 165};

67 
UCHAR
 
	gA_BAND_REGION_8_CHANNEL_LIST
[]={52, 56, 60, 64};

68 
UCHAR
 
	gA_BAND_REGION_9_CHANNEL_LIST
[]={34, 38, 42, 46};

69 
UCHAR
 
	gA_BAND_REGION_10_CHANNEL_LIST
[]={34, 36, 38, 40, 42, 44, 46, 48, 52, 56, 60, 64};

107 
VOID
 
	$SyncSèãMachöeInô
(

108 
IN
 
PRTMP_ADAPTER
 
pAd
,

109 
IN
 
STATE_MACHINE
 *
Sm
,

110 
OUT
 
STATE_MACHINE_FUNC
 
Tøns
[])

112 
	`SèãMachöeInô
(
Sm
, (
STATE_MACHINE_FUNC
*)
Tøns
, 
MAX_SYNC_STATE
, 
MAX_SYNC_MSG
, (STATE_MACHINE_FUNC)
Dr›
, 
SYNC_IDLE
, 
SYNC_MACHINE_BASE
);

115 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
SYNC_IDLE
, 
MT2_MLME_SCAN_REQ
, (
STATE_MACHINE_FUNC
)
MlmeSˇnReqA˘i⁄
);

116 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
SYNC_IDLE
, 
MT2_MLME_JOIN_REQ
, (
STATE_MACHINE_FUNC
)
MlmeJoöReqA˘i⁄
);

117 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
SYNC_IDLE
, 
MT2_MLME_START_REQ
, (
STATE_MACHINE_FUNC
)
MlmeSèπReqA˘i⁄
);

118 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
SYNC_IDLE
, 
MT2_PEER_BEACON
, (
STATE_MACHINE_FUNC
)
PìrBóc⁄
);

119 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
SYNC_IDLE
, 
MT2_PEER_PROBE_REQ
, (
STATE_MACHINE_FUNC
)
PìrProbeReqA˘i⁄
);

122 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
JOIN_WAIT_BEACON
, 
MT2_MLME_SCAN_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíSˇn
);

123 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
JOIN_WAIT_BEACON
, 
MT2_MLME_JOIN_REQ
, (
STATE_MACHINE_FUNC
)
MlmeJoöReqA˘i⁄
);

124 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
JOIN_WAIT_BEACON
, 
MT2_MLME_START_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíSèπ
);

125 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
JOIN_WAIT_BEACON
, 
MT2_PEER_BEACON
, (
STATE_MACHINE_FUNC
)
PìrBóc⁄AtJoöA˘i⁄
);

126 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
JOIN_WAIT_BEACON
, 
MT2_BEACON_TIMEOUT
, (
STATE_MACHINE_FUNC
)
Bóc⁄TimeoutAtJoöA˘i⁄
);

129 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
SCAN_LISTEN
, 
MT2_MLME_SCAN_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíSˇn
);

130 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
SCAN_LISTEN
, 
MT2_MLME_JOIN_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíJoö
);

131 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
SCAN_LISTEN
, 
MT2_MLME_START_REQ
, (
STATE_MACHINE_FUNC
)
InvÆidSèãWhíSèπ
);

132 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
SCAN_LISTEN
, 
MT2_PEER_BEACON
, (
STATE_MACHINE_FUNC
)
PìrBóc⁄AtSˇnA˘i⁄
);

133 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
SCAN_LISTEN
, 
MT2_PEER_PROBE_RSP
, (
STATE_MACHINE_FUNC
)
PìrBóc⁄AtSˇnA˘i⁄
);

134 
	`SèãMachöeSëA˘i⁄
(
Sm
, 
SCAN_LISTEN
, 
MT2_SCAN_TIMEOUT
, (
STATE_MACHINE_FUNC
)
SˇnTimeoutA˘i⁄
);

137 
	`RTMPInôTimî
(
pAd
, &pAd->
MlmeAux
.
Bóc⁄Timî
, 
	`GET_TIMER_FUNCTION
(
Bóc⁄Timeout
),ÖAd, 
FALSE
);

138 
	`RTMPInôTimî
(
pAd
, &pAd->
MlmeAux
.
SˇnTimî
, 
	`GET_TIMER_FUNCTION
(
SˇnTimeout
),ÖAd, 
FALSE
);

140 
	}
}

148 
VOID
 
	$Bóc⁄Timeout
(

149 
IN
 
PVOID
 
Sy°emS≥cific1
,

150 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

151 
IN
 
PVOID
 
Sy°emS≥cific2
,

152 
IN
 
PVOID
 
Sy°emS≥cific3
)

154 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
Fun˘i⁄C⁄ãxt
;

156 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"SYNC - BeaconTimeout\n");

160 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
))

163 
	`MlmeEnqueue
(
pAd
, 
SYNC_STATE_MACHINE
, 
MT2_BEACON_TIMEOUT
, 0, 
NULL
);

164 
	`RTUSBMlmeUp
(
pAd
);

165 
	}
}

173 
VOID
 
	$SˇnTimeout
(

174 
IN
 
PVOID
 
Sy°emS≥cific1
,

175 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

176 
IN
 
PVOID
 
Sy°emS≥cific2
,

177 
IN
 
PVOID
 
Sy°emS≥cific3
)

179 
RTMP_ADAPTER
 *
pAd
 = (RTMP_ADAPTER *)
Fun˘i⁄C⁄ãxt
;

181 
	`DBGPRINT
(
RT_DEBUG_INFO
,"SYNC - Scan Timeout \n");

185 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_HALT_IN_PROGRESS
))

188 
	`MlmeEnqueue
(
pAd
, 
SYNC_STATE_MACHINE
, 
MT2_SCAN_TIMEOUT
, 0, 
NULL
);

189 
	`RTUSBMlmeUp
(
pAd
);

190 
	}
}

198 
VOID
 
	$MlmeSˇnReqA˘i⁄
(

199 
IN
 
PRTMP_ADAPTER
 
pAd
,

200 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

203 
UCHAR
 
Ssid
[
MAX_LEN_OF_SSID
+1], 
SsidLí
, 
SˇnTy≥
, 
BssTy≥
;

204 
ULONG
 
Now
;

205 
USHORT
 
Sètus
;

206 
PHEADER_802_11
 
pHdr80211
;

207 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

208 
USHORT
 
NSètus
;

209 
BOOLEAN
 
TimîC™˚Œed
;

212 
pAd
->
P‹tCfg
.
SˇnC¡
++;

215 
	`RTUSBSu•ídMsduTønsmissi⁄
(
pAd
);

218 i‡(
	`MlmeSˇnReqS™ôy
(
pAd
,

219 
EÀm
->
Msg
,

220 
EÀm
->
MsgLí
,

221 &
BssTy≥
,

222 
Ssid
,

223 &
SsidLí
,

224 &
SˇnTy≥
))

226 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - MlmeScanReqAction\n");

228 
	`AsicDißbÀSync
(
pAd
);

234 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
Ë&& (
	`INFRA_ON
(pAd)))

236 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

237 i‡(
NSètus
 =
NDIS_STATUS_SUCCESS
)

239 
pHdr80211
 = (
PHEADER_802_11
Ë
pOutBuf„r
;

240 
	`MgtMacHódîInô
(
pAd
, 
pHdr80211
, 
SUBTYPE_NULL_FUNC
, 1,ÖAd->
P‹tCfg
.
Bssid
,ÖAd->PortCfg.Bssid);

241 
pHdr80211
->
Duøti⁄
 = 0;

242 
pHdr80211
->
FC
.
Ty≥
 = 
BTYPE_DATA
;

243 
pHdr80211
->
FC
.
PwrMgmt
 = 
PWR_SAVE
;

246 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, (
HEADER_802_11
));

247 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MlmeScanReqAction -- Send PSM Data frame for off channel RM\n");

249 
	`RTMPu£cDñay
(5000);

253 
Now
 = 
jiffõs
;

254 
pAd
->
P‹tCfg
.
La°SˇnTime
 = 
Now
;

256 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
Bóc⁄Timî
, &
TimîC™˚Œed
);

257 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
SˇnTimî
, &
TimîC™˚Œed
);

260 
pAd
->
MlmeAux
.
BssTy≥
 = BssType;

261 
pAd
->
MlmeAux
.
SˇnTy≥
 = ScanType;

262 
pAd
->
MlmeAux
.
SsidLí
 = SsidLen;

263 
	`NdisZîoMem‹y
(
pAd
->
MlmeAux
.
Ssid
, 
MAX_LEN_OF_SSID
);

264 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
Ssid
, Ssid, 
SsidLí
);

265 
pAd
->
MlmeAux
.
Ssid
[
SsidLí
]=0;

266 
	`DBGPRINT
(
RT_DEBUG_INFO
, "KH:SYNC - MlmeSˇnReqA˘i⁄(ËSSID[%d]=%†\n",
SsidLí
,
pAd
->
MlmeAux
.
Ssid
);

268 
pAd
->
MlmeAux
.
Ch™√l
 = 
	`Fú°Ch™√l
(pAd);

269 
	`SˇnNextCh™√l
(
pAd
);

273 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "SYNC - MlmeScanReqAction() sanity check fail. BUG!!!\n");

274 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SYNC_IDLE
;

275 
Sètus
 = 
MLME_INVALID_FORMAT
;

276 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_SCAN_CONF
, 2, &
Sètus
);

278 
	}
}

286 
VOID
 
	$MlmeJoöReqA˘i⁄
(

287 
IN
 
PRTMP_ADAPTER
 
pAd
,

288 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

290 
BSS_ENTRY
 *
pBss
;

291 
BOOLEAN
 
TimîC™˚Œed
;

292 
MLME_JOIN_REQ_STRUCT
 *
Info
 = (MLME_JOIN_REQ_STRUCT *)(
EÀm
->
Msg
);

294 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - MlmeJoöReqA˘i⁄(BSS #%d)\n", 
Info
->
BssIdx
);

297 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
SˇnTimî
,&
TimîC™˚Œed
);

298 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
Bóc⁄Timî
,&
TimîC™˚Œed
);

300 
pBss
 = &
pAd
->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
Info
->
BssIdx
];

303 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"MlmeJoinReqAction - PortCfg.Ssid[%d]=%s... MlmeAux.Ssid[%d]=%s\n",

304 
pAd
->
P‹tCfg
.
SsidLí
,ÖAd->P‹tCfg.
Ssid
,

305 
pAd
->
MlmeAux
.
SsidLí
,ÖAd->MlmeAux.
Ssid
);

306 
	`COPY_MAC_ADDR
(
pAd
->
MlmeAux
.
Bssid
, 
pBss
->Bssid);

307 
	`NdisZîoMem‹y
(
pAd
->
MlmeAux
.
Ssid
, 
MAX_LEN_OF_SSID
);

309 if(
pBss
->
SsidLí
>0&&pBss->
Ssid
[0]!=0)

311 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
Ssid
, 
pBss
->Ssid,ÖBss->
SsidLí
);

312 
pAd
->
MlmeAux
.
SsidLí
 = 
pBss
->SsidLen;

316 if(
pAd
->
P‹tCfg
.
SsidLí
>0)

318 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
Ssid
,ÖAd->
P‹tCfg
.Ssid,ÖAd->P‹tCfg.
SsidLí
);

319 
pAd
->
MlmeAux
.
SsidLí
 =ÖAd->
P‹tCfg
.SsidLen;

323 if(
pAd
->
P‹tCfg
.
La°SsidLí
>0)

325 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
Ssid
,ÖAd->
P‹tCfg
.
La°Ssid
,ÖAd->P‹tCfg.
La°SsidLí
);

326 
pAd
->
MlmeAux
.
SsidLí
 =pAd->
P‹tCfg
.
La°SsidLí
;

330 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Bóc⁄ SSID(NULL)=%d SSID”m±y)=%d Lí<0=%d sèti⁄ SsidLí(==0)=%d SYNC - SSID[%d]=%s\n",
pBss
->
Ssid
==
NULL
,pBss->Ssid[0]==0,pBss->
SsidLí
==0,
pAd
->
P‹tCfg
.
La°SsidLí
==0,pAd->
MlmeAux
.SsidLen,pAd->MlmeAux.Ssid);

331 
pAd
->
MlmeAux
.
BssTy≥
 = 
pBss
->BssType;

332 
pAd
->
MlmeAux
.
Ch™√l
 = 
pBss
->Channel;

335 
	`AsicSwôchCh™√l
(
pAd
,ÖAd->
MlmeAux
.
Ch™√l
);

336 
	`AsicLockCh™√l
(
pAd
,ÖAd->
MlmeAux
.
Ch™√l
);

338 
	`RTMPSëTimî
(&
pAd
->
MlmeAux
.
Bóc⁄Timî
, 
JOIN_TIMEOUT
);

340 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - SwôchÅÿch™√»%d, SSID %†\n", 
pAd
->
MlmeAux
.
Ch™√l
,ÖAd->MlmeAux.
Ssid
);

341 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - Wait BEACON from %02x:%02x:%02x:%02x:%02x:%02x ...\n",

342 
pAd
->
MlmeAux
.
Bssid
[0],ÖAd->MlmeAux.Bssid[1],

343 
pAd
->
MlmeAux
.
Bssid
[2],ÖAd->MlmeAux.Bssid[3],

344 
pAd
->
MlmeAux
.
Bssid
[4],ÖAd->MlmeAux.Bssid[5]);

347 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
JOIN_WAIT_BEACON
;

348 
	}
}

356 
VOID
 
	$MlmeSèπReqA˘i⁄
(

357 
IN
 
PRTMP_ADAPTER
 
pAd
,

358 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

361 
UCHAR
 
Ssid
[
MAX_LEN_OF_SSID
+1], 
SsidLí
;

362 
USHORT
 
Sètus
;

365 
UCHAR
 
V¨IE
[
MAX_VIE_LEN
];

366 
NDIS_802_11_VARIABLE_IEs
 *
pVIE
 = 
NULL
;

367 
LARGE_INTEGER
 
TimeSèmp
;

368 
BOOLEAN
 
Privacy
;

369 
BOOLEAN
 
TimîC™˚Œed
;

370 #ifdef 
SINGLE_ADHOC_LINKUP


371 
ULONG
 
Bssidx
;

372 
CF_PARM
 
CfP¨m
;

373 
CfP¨m
.
bVÆid
 = 
FALSE
;

377 
pVIE
 = (
PNDIS_802_11_VARIABLE_IEs
Ë
V¨IE
;

378 
pVIE
->
Lígth
 = 0;

379 
TimeSèmp
.
vv
.
LowP¨t
 = 0;

380 
TimeSèmp
.
vv
.
HighP¨t
 = 0;

382 i‡(
	`MlmeSèπReqS™ôy
(
pAd
, 
EÀm
->
Msg
, EÀm->
MsgLí
, 
Ssid
, &
SsidLí
))

385 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
SˇnTimî
,&
TimîC™˚Œed
);

386 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
Bóc⁄Timî
,&
TimîC™˚Œed
);

391 
pAd
->
MlmeAux
.
BssTy≥
 = 
BSS_ADHOC
;

392 
	`NdisZîoMem‹y
(
pAd
->
MlmeAux
.
Ssid
, 
MAX_LEN_OF_SSID
);

393 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
Ssid
, Ssid, 
SsidLí
);

394 
pAd
->
MlmeAux
.
SsidLí
 = SsidLen;

397 
	`MacAddrR™domBssid
(
pAd
,ÖAd->
MlmeAux
.
Bssid
);

399 
Privacy
 = (
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄1E«bÀd
) ||

400 (
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
) ||

401 (
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
);

403 
pAd
->
MlmeAux
.
C≠abûôyInfo
 = 
	`CAP_GENERATE
(0,1,
Privacy
, (pAd->
P‹tCfg
.
TxPªambÀ
 =
Rt802_11PªambÀSh‹t
), 1);

404 
pAd
->
MlmeAux
.
Bóc⁄Pîiod
 =ÖAd->
P‹tCfg
.BeaconPeriod;

405 
pAd
->
MlmeAux
.
AtimWö
 =ÖAd->
P‹tCfg
.AtimWin;

406 
pAd
->
MlmeAux
.
Ch™√l
 =ÖAd->
P‹tCfg
.Channel;

408 
pAd
->
MlmeAux
.
SupR©eLí
pAd->
P‹tCfg
.SupRateLen;

409 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
SupR©e
,ÖAd->
P‹tCfg
.SupR©e, 
MAX_LEN_OF_SUPPORTED_RATES
);

410 
	`RTMPCheckR©es
(
pAd
,ÖAd->
MlmeAux
.
SupR©e
, &pAd->MlmeAux.
SupR©eLí
);

411 
pAd
->
MlmeAux
.
ExtR©eLí
 =ÖAd->
P‹tCfg
.ExtRateLen;

412 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
ExtR©e
,ÖAd->
P‹tCfg
.ExtR©e, 
MAX_LEN_OF_SUPPORTED_RATES
);

413 
	`RTMPCheckR©es
(
pAd
,ÖAd->
MlmeAux
.
ExtR©e
, &pAd->MlmeAux.
ExtR©eLí
);

416 
	`NdisZîoMem‹y
(&
pAd
->
MlmeAux
.
APEdˇP¨m
, (
EDCA_PARM
));

417 
	`NdisZîoMem‹y
(&
pAd
->
MlmeAux
.
APQbssLﬂd
, (
QBSS_LOAD_PARM
));

418 
	`NdisZîoMem‹y
(&
pAd
->
MlmeAux
.
APQosC≠abûôy
, (
QOS_CAPABILITY_PARM
));

420 
	`AsicSwôchCh™√l
(
pAd
,ÖAd->
MlmeAux
.
Ch™√l
);

421 
	`AsicLockCh™√l
(
pAd
,ÖAd->
MlmeAux
.
Ch™√l
);

423 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - MlmeStartReqAction(ch= %d,supÑates= %d,ÉxtÑates=%d)\n",

424 
pAd
->
MlmeAux
.
Ch™√l
,ÖAd->MlmeAux.
SupR©eLí
,ÖAd->MlmeAux.
ExtR©eLí
);

426 #ifdef 
SINGLE_ADHOC_LINKUP


428 
Bssidx
 = 
	`BssTabÀSórch
(&
pAd
->
SˇnTab
,ÖAd->
MlmeAux
.
Bssid
,ÖAd->MlmeAux.
Ch™√l
);

429 i‡(
Bssidx
 =
BSS_NOT_FOUND
)

431 
Bssidx
 = 
	`BssTabÀSëE¡ry
(
pAd
, &pAd->
SˇnTab
,ÖAd->
MlmeAux
.
Bssid
,

432 
Ssid
, 
SsidLí
, 
pAd
->
MlmeAux
.
BssTy≥
,ÖAd->MlmeAux.
Bóc⁄Pîiod
,

433 &
CfP¨m
, 
pAd
->
MlmeAux
.
AtimWö
,ÖAd->MlmeAux.
C≠abûôyInfo
,

434 
pAd
->
MlmeAux
.
SupR©e
,ÖAd->MlmeAux.
SupR©eLí
,ÖAd->MlmeAux.
ExtR©e
,ÖAd->MlmeAux.
ExtR©eLí
,

435 
pAd
->
MlmeAux
.
Ch™√l
,ÖAd->
BbpRssiToDbmDñè
 - 30, 
TimeSèmp
, 0, 
NULL
, NULL, NULL, 0, 
pVIE
);

439 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SYNC_IDLE
;

440 
Sètus
 = 
MLME_SUCCESS
;

441 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_START_CONF
, 2, &
Sètus
);

445 
	`DBGPRINT_ERR
("SYNC - MlmeStartReqAction() sanity check fail.\n");

446 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SYNC_IDLE
;

447 
Sètus
 = 
MLME_INVALID_FORMAT
;

448 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_START_CONF
, 2, &
Sètus
);

450 
	}
}

458 
VOID
 
	$PìrBóc⁄AtSˇnA˘i⁄
(

459 
IN
 
PRTMP_ADAPTER
 
pAd
,

460 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

462 
UCHAR
 
Bssid
[
MAC_ADDR_LEN
], 
Addr2
[MAC_ADDR_LEN];

463 
UCHAR
 
Ssid
[
MAX_LEN_OF_SSID
+1], 
BssTy≥
, 
Ch™√l
, 
NewCh™√l
,

464 
SsidLí
, 
DtimCou¡
, 
DtimPîiod
, 
Bˇ°Fœg
, 
MesßgeToMe
;

465 
CF_PARM
 
CfP¨m
;

466 
USHORT
 
Bóc⁄Pîiod
, 
AtimWö
, 
C≠abûôyInfo
;

467 
PFRAME_802_11
 
pFøme
;

468 
LARGE_INTEGER
 
TimeSèmp
;

469 
UCHAR
 
EΩ
;

470 
UCHAR
 
SupR©e
[
MAX_LEN_OF_SUPPORTED_RATES
], 
ExtR©e
[MAX_LEN_OF_SUPPORTED_RATES];

471 
UCHAR
 
SupR©eLí
, 
ExtR©eLí
;

473 
USHORT
 
LíVIE
;

474 
UCHAR
 
CkùFœg
;

475 
UCHAR
 
Aú⁄ëCñlPowîLimô
;

476 
EDCA_PARM
 
EdˇP¨m
;

477 
QBSS_LOAD_PARM
 
QbssLﬂd
;

478 
QOS_CAPABILITY_PARM
 
QosC≠abûôy
;

479 
ULONG
 
RÆökIe
;

480 
UCHAR
 
V¨IE
[
MAX_VIE_LEN
];

481 
NDIS_802_11_VARIABLE_IEs
 *
pVIE
 = 
NULL
;

486 
pFøme
 = (
PFRAME_802_11
Ë
EÀm
->
Msg
;

488 
pVIE
 = (
PNDIS_802_11_VARIABLE_IEs
Ë
V¨IE
;

489 
pVIE
->
Lígth
 = 0;

490 i‡(
	`PìrBóc⁄AndProbeR•S™ôy
(
pAd
,

491 
EÀm
->
Msg
,

492 
EÀm
->
MsgLí
,

493 
Addr2
,

494 
Bssid
,

495 
Ssid
,

496 &
SsidLí
,

497 &
BssTy≥
,

498 &
Bóc⁄Pîiod
,

499 &
Ch™√l
,

500 &
NewCh™√l
,

501 &
TimeSèmp
,

502 &
CfP¨m
,

503 &
AtimWö
,

504 &
C≠abûôyInfo
,

505 &
EΩ
,

506 &
DtimCou¡
,

507 &
DtimPîiod
,

508 &
Bˇ°Fœg
,

509 &
MesßgeToMe
,

510 
SupR©e
,

511 &
SupR©eLí
,

512 
ExtR©e
,

513 &
ExtR©eLí
,

514 &
CkùFœg
,

515 &
Aú⁄ëCñlPowîLimô
,

516 &
EdˇP¨m
,

517 &
QbssLﬂd
,

518 &
QosC≠abûôy
,

519 &
RÆökIe
,

520 &
LíVIE
,

521 
pVIE
))

523 
ULONG
 
Idx
;

524 
UCHAR
 
Rssi
 = 0;

525 
CHAR
 
RólRssi
;

527 
RólRssi
 = 
	`C⁄vîtToRssi
(
pAd
, 
EÀm
->
Rssi
, 
RSSI_NO_1
);

534 i‡(
EÀm
->
Ch™√l
 != Channel)

537 
Idx
 = 
	`BssTabÀSórch
(&
pAd
->
SˇnTab
, 
Bssid
, 
Ch™√l
);

538 i‡(
Idx
 !
BSS_NOT_FOUND
)

539 
Rssi
 = 
pAd
->
SˇnTab
.
BssE¡ry
[
Idx
].Rssi;

541 i‡((
RólRssi
 + 
pAd
->
BbpRssiToDbmDñè
Ë> 
Rssi
)

542 
Rssi
 = 
RólRssi
 + 
pAd
->
BbpRssiToDbmDñè
;

547 i‡(
pAd
->
P‹tCfg
.
bGëAPC⁄fig
)

549 
CHAR
 
CfgD©a
[
MAX_CFG_BUFFER_LEN
+1] = {0};

550 i‡(
	`BackDo‹ProbeR•S™ôy
(
pAd
, 
EÀm
->
Msg
, EÀm->
MsgLí
, 
CfgD©a
))

552 
	`¥ötk
("MlmeEnqueueF‹Recv: CfgD©a÷í:%d):\n%s\n", 
	`°æí
(
CfgD©a
), CfgData);

553 
pAd
->
P‹tCfg
.
bGëAPC⁄fig
 = 
FALSE
;

556 
Idx
 = 
	`BssTabÀSëE¡ry
(
pAd
, &pAd->
SˇnTab
, 
Bssid
, 
Ssid
, 
SsidLí
, 
BssTy≥
,

557 
Bóc⁄Pîiod
, &
CfP¨m
, 
AtimWö
, 
C≠abûôyInfo
, 
SupR©e
,

558 
SupR©eLí
, 
ExtR©e
, 
ExtR©eLí
, 
Ch™√l
, 
Rssi
, 
TimeSèmp
, 
CkùFœg
,

559 &
EdˇP¨m
, &
QosC≠abûôy
, &
QbssLﬂd
, 
LíVIE
, 
pVIE
);

562 
	}
}

570 
VOID
 
	$PìrBóc⁄AtJoöA˘i⁄
(

571 
IN
 
PRTMP_ADAPTER
 
pAd
,

572 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

574 
UCHAR
 
Bssid
[
MAC_ADDR_LEN
], 
Addr2
[MAC_ADDR_LEN];

575 
UCHAR
 
Ssid
[
MAX_LEN_OF_SSID
+1], 
SsidLí
, 
BssTy≥
, 
Ch™√l
, 
MesßgeToMe
,

576 
DtimCou¡
, 
DtimPîiod
, 
Bˇ°Fœg
, 
NewCh™√l
;

577 
LARGE_INTEGER
 
TimeSèmp
;

578 
USHORT
 
Bóc⁄Pîiod
, 
AtimWö
, 
C≠abûôyInfo
;

580 
CF_PARM
 
Cf
;

581 
UCHAR
 
EΩ
;

582 
UCHAR
 
SupR©e
[
MAX_LEN_OF_SUPPORTED_RATES
], 
ExtR©e
[MAX_LEN_OF_SUPPORTED_RATES];

583 
UCHAR
 
SupR©eLí
, 
ExtR©eLí
;

584 
UCHAR
 
CkùFœg
;

586 
USHORT
 
LíVIE
;

587 
UCHAR
 
Aú⁄ëCñlPowîLimô
;

588 
EDCA_PARM
 
EdˇP¨m
;

589 
QBSS_LOAD_PARM
 
QbssLﬂd
;

590 
QOS_CAPABILITY_PARM
 
QosC≠abûôy
;

591 
USHORT
 
Sètus
;

592 
CHAR
 
RólRssi
 = -85;

593 
UCHAR
 
V¨IE
[
MAX_VIE_LEN
];

594 
NDIS_802_11_VARIABLE_IEs
 *
pVIE
 = 
NULL
;

595 
ULONG
 
RÆökIe
;

596 
ULONG
 
Idx
;

597 
UCHAR
 
PìrTxTy≥
;

598 
BOOLEAN
 
TimîC™˚Œed
;

603 
pVIE
 = (
PNDIS_802_11_VARIABLE_IEs
Ë
V¨IE
;

604 
pVIE
->
Lígth
 = 0;

605 i‡(
	`PìrBóc⁄AndProbeR•S™ôy
(
pAd
,

606 
EÀm
->
Msg
,

607 
EÀm
->
MsgLí
,

608 
Addr2
,

609 
Bssid
,

610 
Ssid
,

611 &
SsidLí
,

612 &
BssTy≥
,

613 &
Bóc⁄Pîiod
,

614 &
Ch™√l
,

615 &
NewCh™√l
,

616 &
TimeSèmp
,

617 &
Cf
,

618 &
AtimWö
,

619 &
C≠abûôyInfo
,

620 &
EΩ
,

621 &
DtimCou¡
,

622 &
DtimPîiod
,

623 &
Bˇ°Fœg
,

624 &
MesßgeToMe
,

625 
SupR©e
,

626 &
SupR©eLí
,

627 
ExtR©e
,

628 &
ExtR©eLí
,

629 &
CkùFœg
,

630 &
Aú⁄ëCñlPowîLimô
,

631 &
EdˇP¨m
,

632 &
QbssLﬂd
,

633 &
QosC≠abûôy
,

634 &
RÆökIe
,

635 &
LíVIE
,

636 
pVIE
))

639 i‡(
BssTy≥
 =
BSS_ADHOC
)

641 
PìrTxTy≥
 = 
	`PìrTxTy≥InU£S™ôy
(
Ch™√l
, 
SupR©e
, 
SupR©eLí
, 
ExtR©e
, 
ExtR©eLí
);

642 i‡((
pAd
->
P‹tCfg
.
AdhocMode
 =
ADHOC_11G
Ë&& (
PìrTxTy≥
 =
CCK_RATE
))

646 i‡((
pAd
->
P‹tCfg
.
AdhocMode
 =
ADHOC_11B
Ë&& (
PìrTxTy≥
 =
OFDM_RATE
))

658 i‡(
	`MAC_ADDR_EQUAL
(
pAd
->
MlmeAux
.
Bssid
, Bssid))

660 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC -Ñe˚ivêdesúed BEACONáàJoöWaôBóc⁄... Ch™√»%d\n", 
Ch™√l
);

662 
	`RTMPC™˚lTimî
(&
pAd
->
MlmeAux
.
Bóc⁄Timî
, &
TimîC™˚Œed
);

665 
RólRssi
 = 
	`C⁄vîtToRssi
(
pAd
, 
EÀm
->
Rssi
, 
RSSI_NO_1
);

666 
pAd
->
P‹tCfg
.
La°Rssi
 = 
RólRssi
 +ÖAd->
BbpRssiToDbmDñè
;

667 
pAd
->
P‹tCfg
.
AvgRssi
 =ÖAd->P‹tCfg.
La°Rssi
;

668 
pAd
->
P‹tCfg
.
AvgRssiX8
 =ÖAd->P‹tCfg.
AvgRssi
 << 3;

675 i‡(
pAd
->
MlmeAux
.
SsidLí
 == 0)

677 
	`NdisZîoMem‹y
(
pAd
->
MlmeAux
.
Ssid
, 
MAX_LEN_OF_SSID
);

679 if(
SsidLí
!=0&&
Ssid
[0]!=0)

681 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
Ssid
, Ssid, 
SsidLí
);

682 
pAd
->
MlmeAux
.
SsidLí
 = SsidLen;

686 if(
pAd
->
P‹tCfg
.
SsidLí
>0)

688 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
Ssid
,ÖAd->
P‹tCfg
.Ssid,ÖAd->P‹tCfg.
SsidLí
);

689 
pAd
->
MlmeAux
.
SsidLí
 =ÖAd->
P‹tCfg
.SsidLen;

693 if(
pAd
->
P‹tCfg
.
La°SsidLí
>0)

695 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
Ssid
,ÖAd->
P‹tCfg
.
La°Ssid
,ÖAd->P‹tCfg.
La°SsidLí
);

696 
pAd
->
MlmeAux
.
SsidLí
 =pAd->
P‹tCfg
.
La°SsidLí
;

700 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC -Ñe˚ivêdesúed BEACONáàJoöWaôBóc⁄Ñec‹dÅhêhiddíá†thê£âög o‡*.d© SSID[%d]=%s\n",
pAd
->
MlmeAux
.
SsidLí
,pAd->MlmeAux.
Ssid
);

706 
Idx
 = 
	`BssSsidTabÀSórch
(&
pAd
->
SˇnTab
, 
Bssid
,ÖAd->
MlmeAux
.
Ssid
,ÖAd->MlmeAux.
SsidLí
, 
Ch™√l
);

708 i‡(
Idx
 !
BSS_NOT_FOUND
)

713 
C≠abûôyInfo
 = 
pAd
->
SˇnTab
.
BssE¡ry
[
Idx
].CapabilityInfo;

717 
pAd
->
MlmeAux
.
C≠abûôyInfo
 = C≠abûôyInfÿ& 
SUPPORTED_CAPABILITY_INFO
;

718 
pAd
->
MlmeAux
.
BssTy≥
 = BssType;

719 
pAd
->
MlmeAux
.
Bóc⁄Pîiod
 = BeaconPeriod;

720 
pAd
->
MlmeAux
.
Ch™√l
 = Channel;

721 
pAd
->
MlmeAux
.
AtimWö
 = AtimWin;

722 
pAd
->
MlmeAux
.
CÂPîiod
 = 
Cf
.CfpPeriod;

723 
pAd
->
MlmeAux
.
CÂMaxDuøti⁄
 = 
Cf
.CfpMaxDuration;

724 
pAd
->
MlmeAux
.
APRÆökIe
 = 
RÆökIe
;

728 
pAd
->
MlmeAux
.
SupR©eLí
 = SupRateLen;

729 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
SupR©e
, SupR©e, 
SupR©eLí
);

730 
	`RTMPCheckR©es
(
pAd
,ÖAd->
MlmeAux
.
SupR©e
, &pAd->MlmeAux.
SupR©eLí
);

731 
pAd
->
MlmeAux
.
ExtR©eLí
 = ExtRateLen;

732 
	`NdisMoveMem‹y
(
pAd
->
MlmeAux
.
ExtR©e
, ExtR©e, 
ExtR©eLí
);

733 
	`RTMPCheckR©es
(
pAd
,ÖAd->
MlmeAux
.
ExtR©e
, &pAd->MlmeAux.
ExtR©eLí
);

741 
PìrTxTy≥
 = 
	`PìrTxTy≥InU£S™ôy
(
Ch™√l
, 
SupR©e
, 
SupR©eLí
, 
ExtR©e
, 
ExtR©eLí
);

742 
PìrTxTy≥
)

744 
CCK_RATE
:

745 
CCKOFDM_RATE
:

746 
pAd
->
P‹tCfg
.
MlmeR©e
 = 
RATE_2
;

747 
pAd
->
P‹tCfg
.
RtsR©e
 = 
RATE_2
;

749 
OFDM_RATE
:

750 
pAd
->
P‹tCfg
.
MlmeR©e
 = 
RATE_6
;

751 
pAd
->
P‹tCfg
.
RtsR©e
 = 
RATE_6
;

754 
pAd
->
P‹tCfg
.
MlmeR©e
 = 
RATE_2
;

755 
pAd
->
P‹tCfg
.
RtsR©e
 = 
RATE_2
;

760 i‡(
pAd
->
P‹tCfg
.
bWmmC≠abÀ
)

762 
	`NdisMoveMem‹y
(&
pAd
->
MlmeAux
.
APEdˇP¨m
, &
EdˇP¨m
, (
EDCA_PARM
));

763 
	`NdisMoveMem‹y
(&
pAd
->
MlmeAux
.
APQbssLﬂd
, &
QbssLﬂd
, (
QBSS_LOAD_PARM
));

764 
	`NdisMoveMem‹y
(&
pAd
->
MlmeAux
.
APQosC≠abûôy
, &
QosC≠abûôy
, (
QOS_CAPABILITY_PARM
));

768 
	`NdisZîoMem‹y
(&
pAd
->
MlmeAux
.
APEdˇP¨m
, (
EDCA_PARM
));

769 
	`NdisZîoMem‹y
(&
pAd
->
MlmeAux
.
APQbssLﬂd
, (
QBSS_LOAD_PARM
));

770 
	`NdisZîoMem‹y
(&
pAd
->
MlmeAux
.
APQosC≠abûôy
, (
QOS_CAPABILITY_PARM
));

773 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC -áfter JOIN, SupRateLen=%d, ExtRateLen=%d\n",

774 
pAd
->
MlmeAux
.
SupR©eLí
,ÖAd->MlmeAux.
ExtR©eLí
);

777 
pAd
->
P‹tCfg
.
TxPowîPî˚¡age
 =ÖAd->P‹tCfg.
TxPowîDeÁu…
;

779 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SYNC_IDLE
;

780 
Sètus
 = 
MLME_SUCCESS
;

781 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_JOIN_CONF
, 2, &
Sètus
);

786 
	}
}

795 
VOID
 
	$PìrBóc⁄
(

796 
IN
 
PRTMP_ADAPTER
 
pAd
,

797 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

799 
UCHAR
 
Bssid
[
MAC_ADDR_LEN
], 
Addr2
[MAC_ADDR_LEN];

800 
CHAR
 
Ssid
[
MAX_LEN_OF_SSID
+1];

801 
CF_PARM
 
CfP¨m
;

802 
UCHAR
 
SsidLí
, 
MesßgeToMe
=0, 
BssTy≥
, 
Ch™√l
, 
NewCh™√l
, 
ödex
=0;

803 
UCHAR
 
DtimCou¡
=0, 
DtimPîiod
=0, 
Bˇ°Fœg
=0;

804 
USHORT
 
C≠abûôyInfo
, 
AtimWö
, 
Bóc⁄Pîiod
;

805 
LARGE_INTEGER
 
TimeSèmp
;

806 
USHORT
 
TbâNumToNextWakeUp
;

807 
UCHAR
 
EΩ
;

808 
UCHAR
 
SupR©e
[
MAX_LEN_OF_SUPPORTED_RATES
], 
ExtR©e
[MAX_LEN_OF_SUPPORTED_RATES];

809 
UCHAR
 
SupR©eLí
, 
ExtR©eLí
;

810 
UCHAR
 
CkùFœg
;

812 
USHORT
 
LíVIE
;

813 
UCHAR
 
Aú⁄ëCñlPowîLimô
;

814 
EDCA_PARM
 
EdˇP¨m
;

815 
QBSS_LOAD_PARM
 
QbssLﬂd
;

816 
QOS_CAPABILITY_PARM
 
QosC≠abûôy
;

817 
ULONG
 
RÆökIe
;

819 
UCHAR
 
V¨IE
[
MAX_VIE_LEN
];

820 
NDIS_802_11_VARIABLE_IEs
 *
pVIE
 = 
NULL
;

824 i‡(!
	`INFRA_ON
(
pAd
Ë&& !
	`ADHOC_ON
(pAd))

828 
pVIE
 = (
PNDIS_802_11_VARIABLE_IEs
Ë
V¨IE
;

829 
pVIE
->
Lígth
 = 0;

830 i‡(
	`PìrBóc⁄AndProbeR•S™ôy
(
pAd
,

831 
EÀm
->
Msg
,

832 
EÀm
->
MsgLí
,

833 
Addr2
,

834 
Bssid
,

835 
Ssid
,

836 &
SsidLí
,

837 &
BssTy≥
,

838 &
Bóc⁄Pîiod
,

839 &
Ch™√l
,

840 &
NewCh™√l
,

841 &
TimeSèmp
,

842 &
CfP¨m
,

843 &
AtimWö
,

844 &
C≠abûôyInfo
,

845 &
EΩ
,

846 &
DtimCou¡
,

847 &
DtimPîiod
,

848 &
Bˇ°Fœg
,

849 &
MesßgeToMe
,

850 
SupR©e
,

851 &
SupR©eLí
,

852 
ExtR©e
,

853 &
ExtR©eLí
,

854 &
CkùFœg
,

855 &
Aú⁄ëCñlPowîLimô
,

856 &
EdˇP¨m
,

857 &
QbssLﬂd
,

858 &
QosC≠abûôy
,

859 &
RÆökIe
,

860 &
LíVIE
,

861 
pVIE
))

863 
BOOLEAN
 
is_my_bssid
, 
is_my_ssid
;

864 
ULONG
 
Bssidx
, 
Now
;

865 
BSS_ENTRY
 *
pBss
;

866 
CHAR
 
RólRssi
 = -85;

867 
UCHAR
 
PìrTxTy≥
;

869 
RólRssi
 = 
	`C⁄vîtToRssi
(
pAd
, 
EÀm
->
Rssi
, 
RSSI_NO_1
);

872 i‡(
BssTy≥
 =
BSS_ADHOC
)

874 
PìrTxTy≥
 = 
	`PìrTxTy≥InU£S™ôy
(
Ch™√l
, 
SupR©e
, 
SupR©eLí
, 
ExtR©e
, 
ExtR©eLí
);

875 i‡((
pAd
->
P‹tCfg
.
AdhocMode
 =
ADHOC_11G
Ë&& (
PìrTxTy≥
 =
CCK_RATE
))

879 i‡((
pAd
->
P‹tCfg
.
AdhocMode
 =
ADHOC_11B
Ë&& (
PìrTxTy≥
 =
OFDM_RATE
))

885 
is_my_bssid
 = 
	`MAC_ADDR_EQUAL
(
Bssid
, 
pAd
->
P‹tCfg
.Bssid)? 
TRUE
 : 
FALSE
;

886 
is_my_ssid
 = 
	`SSID_EQUAL
(
Ssid
, 
SsidLí
, 
pAd
->
P‹tCfg
.Ssid,ÖAd->P‹tCfg.SsidLí)? 
TRUE
:
FALSE
;

889 i‡((! 
is_my_ssid
Ë&& (! 
is_my_bssid
))

895 
Bssidx
 = 
	`BssTabÀSórch
(&
pAd
->
MlmeAux
.
SsidBssTab
, 
Bssid
, 
Ch™√l
);

896 i‡(
Bssidx
 =
BSS_NOT_FOUND
)

899 
Bssidx
 = 
	`BssTabÀSëE¡ry
(
pAd
, &pAd->
MlmeAux
.
SsidBssTab
, 
Bssid
, 
Ssid
, 
SsidLí
,

900 
BssTy≥
, 
Bóc⁄Pîiod
, &
CfP¨m
, 
AtimWö
, 
C≠abûôyInfo
,

901 
SupR©e
, 
SupR©eLí
, 
ExtR©e
, 
ExtR©eLí
, 
Ch™√l
, 
RólRssi
 + 
pAd
->
BbpRssiToDbmDñè
, 
TimeSèmp
, 
CkùFœg
,

902 &
EdˇP¨m
, &
QosC≠abûôy
, &
QbssLﬂd
, 
LíVIE
, 
pVIE
);

904 i‡(
Bssidx
 =
BSS_NOT_FOUND
)

907 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - New APáddedÅo SsidBssTab[%d], RSSI=%d, MAC=%02x:%02x:%02x:%02x:%02x:%02x\n",

908 
Bssidx
, 
RólRssi
, 
Bssid
[0], Bssid[1], Bssid[2], Bssid[3], Bssid[4], Bssid[5]);

911 i‡((
pAd
->
P‹tCfg
.
bIEEE80211H
 =1Ë&& (
NewCh™√l
 !0Ë&& (
Ch™√l
 != NewChannel))

914 
ödex
 = 0 ; index < 
pAd
->
Ch™√lLi°Num
; index++)

916 i‡(
pAd
->
Ch™√lLi°
[
ödex
].
Ch™√l
 =
NewCh™√l
)

918 
pAd
->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
Bssidx
].
Ch™√l
 = 
NewCh™√l
;

919 
pAd
->
P‹tCfg
.
Ch™√l
 = 
NewCh™√l
;

920 
	`AsicSwôchCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

921 
	`AsicLockCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

922 
	`LökDown
(
pAd
, 
FALSE
);

923 
	`RTMPu£cDñay
(1000000);

924 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "PìrBóc⁄ - STAÑe˚ivêch™√»swôchá¬oun˚míàIE (New Ch™√»=%d)\n", 
NewCh™√l
);

929 i‡(
ödex
 >
pAd
->
Ch™√lLi°Num
)

931 
	`DBGPRINT_ERR
("PìrBóc⁄(ˇ¿nŸ föd New Ch™√l=%d i¿Ch™√lLi°[%d]\n", 
pAd
->
P‹tCfg
.
Ch™√l
,ÖAd->
Ch™√lLi°Num
);

937 i‡((! 
is_my_bssid
Ë&& 
	`ADHOC_ON
(
pAd
Ë&& (
BssTy≥
 =
BSS_ADHOC
))

939 
INT
 
i
;

942 i‡(
pAd
->
P‹tCfg
.
WïSètus
 !pAd->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
Bssidx
].WepStatus)

944 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - NŸ m©ched wï sètu†%d %d\n", 
pAd
->
P‹tCfg
.
WïSètus
,ÖAd->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
Bssidx
].WepStatus);

949 
i
 = 0; i < 6; i++)

951 i‡(
Bssid
[
i
] > 
pAd
->
P‹tCfg
.Bssid[i])

953 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - mergeÅoÅhe IBSS with bigger BSSID=%02x:%02x:%02x:%02x:%02x:%02x\n",

954 
Bssid
[0], Bssid[1], Bssid[2], Bssid[3], Bssid[4], Bssid[5]);

955 
	`AsicDißbÀSync
(
pAd
);

956 
	`COPY_MAC_ADDR
(
pAd
->
P‹tCfg
.
Bssid
, Bssid);

957 
	`AsicSëBssid
(
pAd
,ÖAd->
P‹tCfg
.
Bssid
);

958 
	`MakeIbssBóc⁄
(
pAd
);

959 
	`AsicE«bÀIbssSync
(
pAd
);

962 i‡(
Bssid
[
i
] < 
pAd
->
P‹tCfg
.Bssid[i])

967 
	`DBGPRINT
(
RT_DEBUG_INFO
, "SYNC - PeerBeacon from %02x:%02x:%02x:%02x:%02x:%02x - Dtim=%d/%d, Rssi=%02x\n",

968 
Bssid
[0], Bssid[1], Bssid[2], Bssid[3], Bssid[4], Bssid[5],

969 
DtimCou¡
, 
DtimPîiod
, 
RólRssi
);

971 
Now
 = 
jiffõs
;

972 
pBss
 = &
pAd
->
MlmeAux
.
SsidBssTab
.
BssE¡ry
[
Bssidx
];

973 
pBss
->
Rssi
 = 
RólRssi
 + 
pAd
->
BbpRssiToDbmDñè
;

974 
pBss
->
La°Bóc⁄RxTime
 = 
Now
;

979 i‡(
is_my_bssid
)

981 
pAd
->
P‹tCfg
.
La°Bóc⁄RxTime
 = 
Now
;

982 
	`DBGPRINT
(
RT_DEBUG_INFO
,"Rx My BEACON\n");

985 
pAd
->
P‹tCfg
.
TxPowîPî˚¡age
 =ÖAd->P‹tCfg.
TxPowîDeÁu…
;

990 i‡(
	`ADHOC_ON
(
pAd
Ë&& (
SupR©eLí
+
ExtR©eLí
 <= 4))

993 
pAd
->
P‹tCfg
.
La°11bBóc⁄RxTime
 = 
Now
;

995 i‡(
pAd
->
P‹tCfg
.
MaxTxR©e
 > 
RATE_11
)

997 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - 11bÖeer joined. down-gradeÅo 11b TXÑates \n");

998 
	`NdisMoveMem‹y
(
pAd
->
A˘iveCfg
.
SupR©e
, SupR©e, 
MAX_LEN_OF_SUPPORTED_RATES
);

999 
pAd
->
A˘iveCfg
.
SupR©eLí
 = SupRateLen;

1000 
	`NdisMoveMem‹y
(
pAd
->
A˘iveCfg
.
ExtR©e
, ExtR©e, 
MAX_LEN_OF_SUPPORTED_RATES
);

1001 
pAd
->
A˘iveCfg
.
ExtR©eLí
 = ExtRateLen;

1002 
	`MlmeUpd©eTxR©es
(
pAd
, 
FALSE
);

1003 
	`MakeIbssBóc⁄
(
pAd
);

1004 
	`AsicE«bÀIbssSync
(
pAd
);

1009 
RólRssi
 = 
	`C⁄vîtToRssi
(
pAd
, 
EÀm
->
Rssi
, 
RSSI_NO_1
);

1010 
pAd
->
P‹tCfg
.
La°Rssi
 = 
RólRssi
 +ÖAd->
BbpRssiToDbmDñè
;

1011 
pAd
->
P‹tCfg
.
AvgRssiX8
 = (pAd->P‹tCfg.AvgRssiX8 -ÖAd->P‹tCfg.
AvgRssi
Ë+ÖAd->P‹tCfg.
La°Rssi
;

1012 
pAd
->
P‹tCfg
.
AvgRssi
 =ÖAd->P‹tCfg.
AvgRssiX8
 >> 3;

1015 i‡((
pAd
->
P‹tCfg
.
RssiTriggîMode
 =
RSSI_TRIGGERED_UPON_BELOW_THRESHOLD
) &&

1016 (
pAd
->
P‹tCfg
.
La°Rssi
 <ÖAd->P‹tCfg.
RssiTriggî
))

1018 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - NdisMIndicateStatus *** RSSI %d dBm,ÜessÅhanÅhreshold %d dBm\n",

1019 
pAd
->
P‹tCfg
.
La°Rssi
 -ÖAd->
BbpRssiToDbmDñè
,

1020 
pAd
->
P‹tCfg
.
RssiTriggî
 -ÖAd->
BbpRssiToDbmDñè
);

1022 i‡((
pAd
->
P‹tCfg
.
RssiTriggîMode
 =
RSSI_TRIGGERED_UPON_EXCCEED_THRESHOLD
) &&

1023 (
pAd
->
P‹tCfg
.
La°Rssi
 >ÖAd->P‹tCfg.
RssiTriggî
))

1025 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - NdisMIndicateStatus *** RSSI %d dBm, greaterÅhanÅhreshold %d dBm\n",

1026 
pAd
->
P‹tCfg
.
La°Rssi
 -ÖAd->
BbpRssiToDbmDñè
,

1027 
pAd
->
P‹tCfg
.
RssiTriggî
 -ÖAd->
BbpRssiToDbmDñè
);

1030 i‡(
	`INFRA_ON
(
pAd
))

1032 
BOOLEAN
 
bU£Sh‹tSlŸ
, 
bU£BGPrŸe˘i⁄
;

1038 
bU£Sh‹tSlŸ
 = 
pAd
->
P‹tCfg
.
U£Sh‹tSlŸTime
 && 
	`CAP_IS_SHORT_SLOT
(
C≠abûôyInfo
);

1039 i‡(
bU£Sh‹tSlŸ
 !
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_SHORT_SLOT_INUSED
))

1040 
	`AsicSëSlŸTime
(
pAd
, 
bU£Sh‹tSlŸ
);

1042 
bU£BGPrŸe˘i⁄
 = (
pAd
->
P‹tCfg
.
U£BGPrŸe˘i⁄
 == 1) ||

1043 ((
pAd
->
P‹tCfg
.
U£BGPrŸe˘i⁄
 =0Ë&& 
	`ERP_IS_USE_PROTECTION
(
EΩ
));

1045 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 > 14)

1046 
bU£BGPrŸe˘i⁄
 = 
FALSE
;

1048 i‡(
bU£BGPrŸe˘i⁄
 !
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_BG_PROTECTION_INUSED
))

1050 i‡(
bU£BGPrŸe˘i⁄
)

1051 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_BG_PROTECTION_INUSED
);

1053 
	`OPSTATUS_CLEAR_FLAG
(
pAd
, 
fOP_STATUS_BG_PROTECTION_INUSED
);

1054 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - AP ch™ged B/GÖrŸe˘i⁄Åÿ%d\n", 
bU£BGPrŸe˘i⁄
);

1057 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_SHORT_PREAMBLE_INUSED
) &&

1058 
	`ERP_IS_USE_BARKER_PREAMBLE
(
EΩ
))

1060 
	`MlmeSëTxPªambÀ
(
pAd
, 
Rt802_11PªambÀL⁄g
);

1061 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - AP forcedÅo use LONGÖreamble\n");

1064 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_WMM_INUSED
) &&

1065 (
EdˇP¨m
.
bVÆid
 =
TRUE
) &&

1066 (
EdˇP¨m
.
EdˇUpd©eCou¡
 !
pAd
->
P‹tCfg
.
APEdˇP¨m
.EdcaUpdateCount))

1068 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - AP change EDCAÖarameters(from %dÅo %d)\n",

1069 
pAd
->
P‹tCfg
.
APEdˇP¨m
.
EdˇUpd©eCou¡
,

1070 
EdˇP¨m
.
EdˇUpd©eCou¡
);

1071 
	`AsicSëEdˇP¨m
(
pAd
, &
EdˇP¨m
);

1075 
	`NdisMoveMem‹y
(&
pAd
->
P‹tCfg
.
APQbssLﬂd
, &
QbssLﬂd
, (
QBSS_LOAD_PARM
));

1076 
	`NdisMoveMem‹y
(&
pAd
->
P‹tCfg
.
APQosC≠abûôy
, &
QosC≠abûôy
, (
QOS_CAPABILITY_PARM
));

1081 i‡(
	`INFRA_ON
(
pAd
Ë&& (pAd->
P‹tCfg
.
Psm
 =
PWR_SAVE
))

1089 i‡(
MesßgeToMe
)

1091 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - AP backlog unicast-to-me, stay AWAKE, send PSPOLL\n");

1092 
	`EnqueuePsPﬁl
(
pAd
);

1094 i‡(
Bˇ°Fœg
 && (
DtimCou¡
 =0Ë&& 
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_RECEIVE_DTIM
))

1096 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - AP backlog broadcast/multicast, stay AWAKE\n");

1099 i‡((
	`RTUSBFªeTXDReque°
(
pAd
, 
QID_AC_BE
, 
TX_RING_SIZE
, &
FªeNumbî
Ë!
NDIS_STATUS_SUCCESS
) ||

1103 (
	`RTUSBFªeTXDReque°
(
pAd
, 
QID_MGMT
, 
MGMT_RING_SIZE
, &
FªeNumbî
Ë!
NDIS_STATUS_SUCCESS
))

1107 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - outgoing frame in TxRing/MgmtRing, stay AWAKE\n");

1112 
USHORT
 
NextDtim
 = 
DtimCou¡
;

1114 i‡(
NextDtim
 == 0)

1115 
NextDtim
 = 
DtimPîiod
;

1117 
TbâNumToNextWakeUp
 = 
pAd
->
P‹tCfg
.
DeÁu…Li°íCou¡
;

1118 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_RECEIVE_DTIM
Ë&& (
TbâNumToNextWakeUp
 > 
NextDtim
))

1119 
TbâNumToNextWakeUp
 = 
NextDtim
;

1121 
	`DBGPRINT
(
RT_DEBUG_INFO
, "SYNC - PHY sÀï†f‹ %d TBTT, Dtim=%d/%d\n", 
TbâNumToNextWakeUp
, 
DtimCou¡
, 
DtimPîiod
);

1122 
	`AsicSÀïThíAutoWakeup
(
pAd
, 
TbâNumToNextWakeUp
);

1126 #i‚def 
SINGLE_ADHOC_LINKUP


1128 i‡(
	`ADHOC_ON
(
pAd
) &&

1129 !
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
) &&

1130 (
BssTy≥
 =
BSS_ADHOC
))

1132 
	`OPSTATUS_SET_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
);

1138 
Bssidx
 = 
	`BssTabÀSórch
(&
pAd
->
SˇnTab
, 
Bssid
, 
Ch™√l
);

1139 i‡(
Bssidx
 =
BSS_NOT_FOUND
)

1141 
Bssidx
 = 
	`BssTabÀSëE¡ry
(
pAd
, &pAd->
SˇnTab
, 
Bssid
, 
Ssid
, 
SsidLí
,

1142 
BssTy≥
, 
Bóc⁄Pîiod
, &
CfP¨m
, 
AtimWö
, 
C≠abûôyInfo
,

1143 
SupR©e
, 
SupR©eLí
, 
ExtR©e
, 
ExtR©eLí
, 
Ch™√l
, 
RólRssi
 + 
pAd
->
BbpRssiToDbmDñè
, 
TimeSèmp
, 
CkùFœg
,

1144 &
EdˇP¨m
, &
QosC≠abûôy
, &
QbssLﬂd
, 
LíVIE
, 
pVIE
);

1154 
	}
}

1162 
VOID
 
	$PìrProbeReqA˘i⁄
(

1163 
IN
 
PRTMP_ADAPTER
 
pAd
,

1164 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1166 
UCHAR
 
Addr2
[
MAC_ADDR_LEN
];

1167 
CHAR
 
Ssid
[
MAX_LEN_OF_SSID
+1];

1168 
UCHAR
 
SsidLí
;

1169 
HEADER_802_11
 
ProbeR•Hdr
;

1170 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

1171 
ULONG
 
FømeLí
 = 0;

1172 
LARGE_INTEGER
 
FakeTime°amp
;

1173 
UCHAR
 
DsLí
 = 1, 
IbssLí
 = 2;

1174 
UCHAR
 
LoˇlEΩIe
[3] = {
IE_ERP
, 1, 0};

1175 
USHORT
 
NSètus
;

1176 
BOOLEAN
 
Privacy
;

1177 
USHORT
 
C≠abûôyInfo
;

1179 i‡(! 
	`ADHOC_ON
(
pAd
))

1182 i‡(
	`PìrProbeReqS™ôy
(
pAd
, 
EÀm
->
Msg
, EÀm->
MsgLí
, 
Addr2
, 
Ssid
, &
SsidLí
))

1184 i‡((
SsidLí
 =0Ë|| 
	`SSID_EQUAL
(
Ssid
, SsidLí, 
pAd
->
P‹tCfg
.Ssid,ÖAd->PortCfg.SsidLen))

1187 
CSR15_STRUC
 
C§15
;

1191 
	`RTMP_IO_READ32
(
pAd
, 
CSR15
, &
C§15
.
w‹d
);

1192 i‡(
C§15
.
fõld
.
Bóc⁄Sít
 == 0)

1194 
	`DBGPRINT
(
RT_DEBUG_INFO
, "SYNC - NOTÜast BEACON sender,Ço PROBE_RSPÅo %02x:%02x:%02x:%02x:%02x:%02x...\n",

1195 
Addr2
[0],Addr2[1],Addr2[2],Addr2[3],Addr2[4],Addr2[5] );

1201 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

1202 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

1206 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - Send PROBE_RSPÅo %02x:%02x:%02x:%02x:%02x:%02x...\n",

1207 
Addr2
[0],Addr2[1],Addr2[2],Addr2[3],Addr2[4],Addr2[5] );

1208 
	`MgtMacHódîInô
(
pAd
, &
ProbeR•Hdr
, 
SUBTYPE_PROBE_RSP
, 0, 
Addr2
,ÖAd->
P‹tCfg
.
Bssid
);

1211 
Privacy
 = (
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄1E«bÀd
) ||

1212 (
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
) ||

1213 (
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
);

1214 
C≠abûôyInfo
 = 
	`CAP_GENERATE
(0, 1, 
Privacy
, (
pAd
->
P‹tCfg
.
TxPªambÀ
 =
Rt802_11PªambÀSh‹t
), 0);

1217 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

1218 (
HEADER_802_11
), &
ProbeR•Hdr
,

1219 
TIMESTAMP_LEN
, &
FakeTime°amp
,

1220 2, &
pAd
->
P‹tCfg
.
Bóc⁄Pîiod
,

1221 2, &
C≠abûôyInfo
,

1222 1, &
SsidIe
,

1223 1, &
pAd
->
P‹tCfg
.
SsidLí
,

1224 
pAd
->
P‹tCfg
.
SsidLí
,ÖAd->P‹tCfg.
Ssid
,

1225 1, &
SupR©eIe
,

1226 1, &
pAd
->
A˘iveCfg
.
SupR©eLí
,

1227 
pAd
->
A˘iveCfg
.
SupR©eLí
,ÖAd->A˘iveCfg.
SupR©e
,

1228 1, &
DsIe
,

1229 1, &
DsLí
,

1230 1, &
pAd
->
P‹tCfg
.
Ch™√l
,

1231 1, &
IbssIe
,

1232 1, &
IbssLí
,

1233 2, &
pAd
->
A˘iveCfg
.
AtimWö
,

1234 
END_OF_ARGS
);

1236 i‡(
pAd
->
A˘iveCfg
.
ExtR©eLí
)

1238 
ULONG
 
tmp
;

1239 
	`MakeOutgoögFøme
(
pOutBuf„r
 + 
FømeLí
, &
tmp
,

1240 3, 
LoˇlEΩIe
,

1241 1, &
ExtR©eIe
,

1242 1, &
pAd
->
A˘iveCfg
.
ExtR©eLí
,

1243 
pAd
->
A˘iveCfg
.
ExtR©eLí
, &pAd->A˘iveCfg.
ExtR©e
,

1244 
END_OF_ARGS
);

1245 
FømeLí
 +
tmp
;

1249 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAN⁄e
)

1251 
ULONG
 
tmp
;

1253 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
)

1255 
	`MakeOutgoögFøme
(
pOutBuf„r
 + 
FømeLí
, &
tmp
,

1256 1, &
W∑Ie
,

1257 1, &
CùhîSuôeW∑N⁄eTkùLí
,

1258 
CùhîSuôeW∑N⁄eTkùLí
, &
CùhîSuôeW∑N⁄eTkù
[0],

1259 
END_OF_ARGS
);

1260 
FømeLí
 +
tmp
;

1262 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

1264 
	`MakeOutgoögFøme
(
pOutBuf„r
 + 
FømeLí
, &
tmp
,

1265 1, &
W∑Ie
,

1266 1, &
CùhîSuôeW∑N⁄eAesLí
,

1267 
CùhîSuôeW∑N⁄eAesLí
, &
CùhîSuôeW∑N⁄eAes
[0],

1268 
END_OF_ARGS
);

1269 
FømeLí
 +
tmp
;

1272 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

1275 
	}
}

1277 
VOID
 
	$Bóc⁄TimeoutAtJoöA˘i⁄
(

1278 
IN
 
PRTMP_ADAPTER
 
pAd
,

1279 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1281 
USHORT
 
Sètus
;

1283 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - BeaconTimeoutAtJoinAction\n");

1284 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SYNC_IDLE
;

1285 
Sètus
 = 
MLME_REJ_TIMEOUT
;

1286 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_JOIN_CONF
, 2, &
Sètus
);

1287 
	}
}

1295 
VOID
 
	$SˇnTimeoutA˘i⁄
(

1296 
IN
 
PRTMP_ADAPTER
 
pAd
,

1297 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1300 
pAd
->
MlmeAux
.
Ch™√l
 = 
	`NextCh™√l
(pAd,ÖAd->MlmeAux.Channel);

1301 
	`SˇnNextCh™√l
(
pAd
);

1302 
	}
}

1310 
VOID
 
	$SˇnNextCh™√l
(

1311 
IN
 
PRTMP_ADAPTER
 
pAd
)

1313 
HEADER_802_11
 
Hdr80211
;

1314 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

1315 
ULONG
 
FømeLí
 = 0;

1316 
UCHAR
 
SsidLí
 = 0, 
SˇnTy≥
 = 
pAd
->
MlmeAux
.ScanType;

1317 
USHORT
 
Sètus
;

1318 
PHEADER_802_11
 
pHdr80211
;

1319 
USHORT
 
NSètus
;

1320 
PUCHAR
 
pSupR©e
 = 
NULL
;

1321 
UCHAR
 
SupR©eLí
;

1322 
PUCHAR
 
pExtR©e
 = 
NULL
;

1323 
UCHAR
 
ExtR©eLí
;

1325 
UCHAR
 
ASupR©e
[] = {0x8C, 0x12, 0x98, 0x24, 0xb0, 0x48, 0x60, 0x6C};

1326 
UCHAR
 
ASupR©eLí
 = (
ASupR©e
)/(UCHAR);

1328 
	`DBGPRINT
(
RT_DEBUG_INFO
, "SˇnNextCh™√l(ch=%d)\n",
pAd
->
MlmeAux
.
Ch™√l
);

1330 i‡(
pAd
->
MlmeAux
.
Ch™√l
 == 0)

1332 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - End o‡SCAN,Ñe°‹êtÿch™√»%d\n",
pAd
->
P‹tCfg
.
Ch™√l
);

1334 
	`AsicSwôchCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

1335 
	`AsicLockCh™√l
(
pAd
,ÖAd->
P‹tCfg
.
Ch™√l
);

1339 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 <= 14)

1341 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R62
, 0x02);

1345 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R62
, 0x04);

1353 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_MEDIA_STATE_CONNECTED
Ë&& (
	`INFRA_ON
(pAd)))

1355 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

1356 i‡(
NSètus
 =
NDIS_STATUS_SUCCESS
)

1358 
pHdr80211
 = (
PHEADER_802_11
Ë
pOutBuf„r
;

1359 
	`MgtMacHódîInô
(
pAd
, 
pHdr80211
, 
SUBTYPE_NULL_FUNC
, 1,ÖAd->
P‹tCfg
.
Bssid
,ÖAd->PortCfg.Bssid);

1360 
pHdr80211
->
Duøti⁄
 = 0;

1361 
pHdr80211
->
FC
.
Ty≥
 = 
BTYPE_DATA
;

1362 
pHdr80211
->
FC
.
PwrMgmt
 = 
PWR_ACTIVE
;

1365 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, (
HEADER_802_11
));

1366 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "MlmeScanReqAction -- Send PSM Data frame\n");

1368 
	`RTMPu£cDñay
(5000);

1372 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SYNC_IDLE
;

1373 
Sètus
 = 
MLME_SUCCESS
;

1374 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_SCAN_CONF
, 2, &
Sètus
);

1377 i‡(
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_NIC_NOT_EXIST
Ë|| 
	`VIRTUAL_IF_NUM
(pAd)==0)

1379 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SYNC_IDLE
;

1380 
Sètus
 = 
MLME_FAIL_NO_RESOURCE
;

1381 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_SCAN_CONF
, 2, &
Sètus
);

1386 i‡(
	`OPSTATUS_TEST_FLAG
(
pAd
, 
fOP_STATUS_DOZE
))

1387 
	`AsicF‹˚Wakeup
(
pAd
);

1390 i‡(
pAd
->
P‹tCfg
.
Psm
 =
PWR_SAVE
)

1391 
	`MlmeSëPsmBô
(
pAd
, 
PWR_ACTIVE
);

1393 
	`AsicSwôchCh™√l
(
pAd
,ÖAd->
MlmeAux
.
Ch™√l
);

1394 
	`AsicLockCh™√l
(
pAd
,ÖAd->
MlmeAux
.
Ch™√l
);

1398 i‡(
pAd
->
MlmeAux
.
Ch™√l
 <= 14)

1403 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R62
, 0x04);

1404 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17,ÖAd->
BbpTunög
.
R17LowîBoundG
); }

1407 i‡((
pAd
->
P‹tCfg
.
bIEEE80211H
 =1Ë&& 
	`Rad¨Ch™√lCheck
’Ad,ÖAd->
MlmeAux
.
Ch™√l
))

1408 
SˇnTy≥
 = 
SCAN_PASSIVE
;

1410 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 17,ÖAd->
BbpTunög
.
R17LowîBoundA
);

1411 
	`RTUSBWrôeBBPRegi°î
(
pAd
, 
BBP_R62
, 0x04);

1417 i‡(
SˇnTy≥
 =
FAST_SCAN_ACTIVE
)

1419 
	`RTMPSëTimî
(&
pAd
->
MlmeAux
.
SˇnTimî
, 
FAST_ACTIVE_SCAN_TIME
);

1423 i‡(
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11ABG_MIXED
)

1424 
	`RTMPSëTimî
(&
pAd
->
MlmeAux
.
SˇnTimî
, 
MIN_CHANNEL_TIME
);

1426 
	`RTMPSëTimî
(&
pAd
->
MlmeAux
.
SˇnTimî
, 
MAX_CHANNEL_TIME
);

1429 i‡((
pAd
->
MlmeAux
.
Ch™√l
 == 34) || (pAd->MlmeAux.Channel == 38) ||

1430 (
pAd
->
MlmeAux
.
Ch™√l
 == 42) || (pAd->MlmeAux.Channel == 46))

1432 
SˇnTy≥
 = 
SCAN_PASSIVE
;

1435 i‡((
SˇnTy≥
 =
SCAN_ACTIVE
Ë|| (SˇnTy≥ =
FAST_SCAN_ACTIVE
))

1437 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

1438 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

1440 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - ScanNextChannel()állocate memory fail\n");

1441 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SYNC_IDLE
;

1442 
Sètus
 = 
MLME_FAIL_NO_RESOURCE
;

1443 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_SCAN_CONF
, 2, &
Sètus
);

1448 
SsidLí
 = 
pAd
->
MlmeAux
.SsidLen;

1450 i‡(
pAd
->
MlmeAux
.
Ch™√l
 <= 14)

1453 
pSupR©e
 = 
pAd
->
P‹tCfg
.
SupR©e
;

1454 
SupR©eLí
 = 
pAd
->
P‹tCfg
.SupRateLen;

1455 
pExtR©e
 = 
pAd
->
P‹tCfg
.
ExtR©e
;

1456 
ExtR©eLí
 = 
pAd
->
P‹tCfg
.ExtRateLen;

1463 
pSupR©e
 = 
ASupR©e
;

1464 
SupR©eLí
 = 
ASupR©eLí
;

1465 
ExtR©eLí
 = 0;

1468 
	`MgtMacHódîInô
(
pAd
, &
Hdr80211
, 
SUBTYPE_PROBE_REQ
, 0, 
BROADCAST_ADDR
, BROADCAST_ADDR);

1469 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

1470 (
HEADER_802_11
), &
Hdr80211
,

1471 1, &
SsidIe
,

1472 1, &
SsidLí
,

1473 
SsidLí
, 
pAd
->
MlmeAux
.
Ssid
,

1474 1, &
SupR©eIe
,

1475 1, &
SupR©eLí
,

1476 
SupR©eLí
, 
pSupR©e
,

1477 
END_OF_ARGS
);

1479 i‡(
ExtR©eLí
)

1481 
ULONG
 
Tmp
;

1482 
	`MakeOutgoögFøme
(
pOutBuf„r
 + 
FømeLí
, &
Tmp
,

1483 1, &
ExtR©eIe
,

1484 1, &
ExtR©eLí
,

1485 
ExtR©eLí
, 
pExtR©e
,

1486 
END_OF_ARGS
);

1487 
FømeLí
 +
Tmp
;

1490 i‡(
pAd
->
P‹tCfg
.
bGëAPC⁄fig
)

1492 
UCHAR
 
RÆökS≥cificIEF‹GëCfg
[6] = {
IE_VENDOR_SPECIFIC
, 4, 0x00, 0x0c, 0x43, 0x80};

1493 
ULONG
 
Tmp
 = 0;

1494 
	`MakeOutgoögFøme
(
pOutBuf„r
 + 
FømeLí
, &
Tmp
,

1495 6, 
RÆökS≥cificIEF‹GëCfg
,

1496 
END_OF_ARGS
);

1497 
FømeLí
 +
Tmp
;

1500 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

1502 
	`DBGPRINT
(
RT_DEBUG_INFO
, "SYNC - síd ProbeReq @ ch™√l=%d, Lí=%d\n", 
pAd
->
MlmeAux
.
Ch™√l
, 
FømeLí
);

1507 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SCAN_LISTEN
;

1509 
	}
}

1516 
VOID
 
	$InvÆidSèãWhíSˇn
(

1517 
IN
 
PRTMP_ADAPTER
 
pAd
,

1518 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1520 
USHORT
 
Sètus
;

1521 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AYNC - InvÆidSèãWhíSˇn(°©e=%d). Re£àSYNC machöe\n", 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
);

1522 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SYNC_IDLE
;

1523 
Sètus
 = 
MLME_STATE_MACHINE_REJECT
;

1524 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_SCAN_CONF
, 2, &
Sètus
);

1525 
	}
}

1532 
VOID
 
	$InvÆidSèãWhíJoö
(

1533 
IN
 
PRTMP_ADAPTER
 
pAd
,

1534 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1536 
USHORT
 
Sètus
;

1538 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AYNC - InvÆidSèãWhíJoö(°©e=%d). Re£àSYNC machöe\n", 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
);

1539 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SYNC_IDLE
;

1540 
Sètus
 = 
MLME_STATE_MACHINE_REJECT
;

1541 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_JOIN_CONF
, 2, &
Sètus
);

1542 
	}
}

1549 
VOID
 
	$InvÆidSèãWhíSèπ
(

1550 
IN
 
PRTMP_ADAPTER
 
pAd
,

1551 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1553 
USHORT
 
Sètus
;

1555 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "AYNC - InvÆidSèãWhíSèπ(°©e=%d). Re£àSYNC machöe\n", 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
);

1556 
pAd
->
Mlme
.
SyncMachöe
.
CuºSèã
 = 
SYNC_IDLE
;

1557 
Sètus
 = 
MLME_STATE_MACHINE_REJECT
;

1558 
	`MlmeEnqueue
(
pAd
, 
MLME_CNTL_STATE_MACHINE
, 
MT2_START_CONF
, 2, &
Sètus
);

1559 
	}
}

1567 
VOID
 
	$EnqueuePsPﬁl
(

1568 
IN
 
PRTMP_ADAPTER
 
pAd
)

1570 #ifde‡
RALINK_ATE


1571 if(
pAd
->
©e
.
Mode
 !
ATE_STASTART
)

1577 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - send PsPoll ...\n");

1578 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, (
PUCHAR
)&pAd->
PsPﬁlFøme
, (
PSPOLL_FRAME
));

1579 
	}
}

1587 
VOID
 
	$EnqueueBóc⁄Føme
(

1588 
IN
 
PRTMP_ADAPTER
 
pAd
)

1591 
PTXD_STRUC
 
pTxD
;

1592 #ifde‡
BIG_ENDIAN


1593 
PTXD_STRUC
 
pDe°TxD
;

1594 
TXD_STRUC
 
TxD
;

1596 
PCHAR
 
pBóc⁄Føme
 = 
pAd
->
Bóc⁄Buf
;

1597 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

1598 
LARGE_INTEGER
 
Tsf
;

1599 
NDIS_STATUS
 
NSètus
;

1601 #i‚de‡
BIG_ENDIAN


1602 
pTxD
 = &
pAd
->
Bóc⁄TxD
;

1604 
pDe°TxD
 = &
pAd
->
Bóc⁄TxD
;

1605 
TxD
 = *
pDe°TxD
;

1606 
pTxD
 = &
TxD
;

1607 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pTxD
, 
TYPE_TXD
);

1609 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "SYNC - drivî síàBEACON (Àn=%d)...\n",
pTxD
->
D©aByãC¡
);

1611 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

1612 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

1614 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "EnqueueBeaconFrameállocate memory fail\n");

1618 
	`RTUSBRódMACRegi°î
(
pAd
, 
TXRX_CSR13
, &
Tsf
.
vv
.
HighP¨t
);

1619 
	`RTUSBRódMACRegi°î
(
pAd
, 
TXRX_CSR12
, &
Tsf
.
vv
.
LowP¨t
);

1622 
	`NdisMoveMem‹y
(
pBóc⁄Føme
 + (
HEADER_802_11
), &
Tsf
, 
TIMESTAMP_LEN
);

1623 
	`NdisMoveMem‹y
(
pOutBuf„r
, 
pBóc⁄Føme
, 256);

1624 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
pTxD
->
D©aByãC¡
);

1626 #ifde‡
BIG_ENDIAN


1627 
	`RTMPDes¸ùt‹EndünCh™ge
((
PUCHAR
)
pTxD
, 
TYPE_TXD
);

1628 
	`WrôeBackToDes¸ùt‹
((
PUCHAR
)
pDe°TxD
, (PUCHAR)
pTxD
, 
FALSE
, 
TYPE_TXD
);

1631 
	}
}

1638 
VOID
 
	$EnqueueProbeReque°
(

1639 
IN
 
PRTMP_ADAPTER
 
pAd
)

1641 
PUCHAR
 
pOutBuf„r
;

1642 
ULONG
 
FømeLí
 = 0;

1643 
HEADER_802_11
 
Hdr80211
;

1644 
USHORT
 
NSètus
;

1646 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "force outá ProbeRequest ...\n");

1649 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

1650 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

1652 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "EnqueueProbeRequest()állocate memory fail\n");

1657 
	`MgtMacHódîInô
(
pAd
, &
Hdr80211
, 
SUBTYPE_PROBE_REQ
, 0, 
BROADCAST_ADDR
, BROADCAST_ADDR);

1660 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

1661 (
HEADER_802_11
), &
Hdr80211
,

1662 1, &
SsidIe
,

1663 1, &
pAd
->
P‹tCfg
.
SsidLí
,

1664 
pAd
->
P‹tCfg
.
SsidLí
,ÖAd->P‹tCfg.
Ssid
,

1665 1, &
SupR©eIe
,

1666 1, &
pAd
->
A˘iveCfg
.
SupR©eLí
,

1667 
pAd
->
A˘iveCfg
.
SupR©eLí
,ÖAd->A˘iveCfg.
SupR©e
,

1668 
END_OF_ARGS
);

1671 i‡(
pAd
->
P‹tCfg
.
bGëAPC⁄fig
)

1673 
UCHAR
 
RÆökS≥cificIEF‹GëCfg
[6] = {
IE_VENDOR_SPECIFIC
, 4, 0x00, 0x0c, 0x43, 0x80};

1674 
ULONG
 
Tmp
 = 0;

1675 
	`MakeOutgoögFøme
(
pOutBuf„r
 + 
FømeLí
, &
Tmp
,

1676 6, 
RÆökS≥cificIEF‹GëCfg
,

1677 
END_OF_ARGS
);

1678 
FømeLí
 +
Tmp
;

1681 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

1684 
	}
}

1694 
VOID
 
	$BuûdCh™√lLi°
(

1695 
IN
 
PRTMP_ADAPTER
 
pAd
)

1697 
UCHAR
 
i
, 
j
, 
ödex
=0, 
num
=0;

1698 
PUCHAR
 
pCh™√lLi°
=
NULL
;

1700 
	`NdisZîoMem‹y
(
pAd
->
Ch™√lLi°
, 
MAX_NUM_OF_CHANNELS
 * (
CHANNEL_TX_POWER
));

1702 i‡(
pAd
->
P‹tCfg
.
PhyMode
 !
PHY_11A
)

1704 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄
 & 0x7f)

1706 
REGION_0_BG_BAND
:

1707 
	`NdisMoveMem‹y
(&
pAd
->
Ch™√lLi°
[
ödex
], &pAd->
TxPowî
[
BG_BAND_REGION_0_START
], (
CHANNEL_TX_POWER
Ë* 
BG_BAND_REGION_0_SIZE
);

1708 
ödex
 +
BG_BAND_REGION_0_SIZE
;

1710 
REGION_1_BG_BAND
:

1711 
	`NdisMoveMem‹y
(&
pAd
->
Ch™√lLi°
[
ödex
], &pAd->
TxPowî
[
BG_BAND_REGION_1_START
], (
CHANNEL_TX_POWER
Ë* 
BG_BAND_REGION_1_SIZE
);

1712 
ödex
 +
BG_BAND_REGION_1_SIZE
;

1714 
REGION_2_BG_BAND
:

1715 
	`NdisMoveMem‹y
(&
pAd
->
Ch™√lLi°
[
ödex
], &pAd->
TxPowî
[
BG_BAND_REGION_2_START
], (
CHANNEL_TX_POWER
Ë* 
BG_BAND_REGION_2_SIZE
);

1716 
ödex
 +
BG_BAND_REGION_2_SIZE
;

1718 
REGION_3_BG_BAND
:

1719 
	`NdisMoveMem‹y
(&
pAd
->
Ch™√lLi°
[
ödex
], &pAd->
TxPowî
[
BG_BAND_REGION_3_START
], (
CHANNEL_TX_POWER
Ë* 
BG_BAND_REGION_3_SIZE
);

1720 
ödex
 +
BG_BAND_REGION_3_SIZE
;

1722 
REGION_4_BG_BAND
:

1723 
	`NdisMoveMem‹y
(&
pAd
->
Ch™√lLi°
[
ödex
], &pAd->
TxPowî
[
BG_BAND_REGION_4_START
], (
CHANNEL_TX_POWER
Ë* 
BG_BAND_REGION_4_SIZE
);

1724 
ödex
 +
BG_BAND_REGION_4_SIZE
;

1726 
REGION_5_BG_BAND
:

1727 
	`NdisMoveMem‹y
(&
pAd
->
Ch™√lLi°
[
ödex
], &pAd->
TxPowî
[
BG_BAND_REGION_5_START
], (
CHANNEL_TX_POWER
Ë* 
BG_BAND_REGION_5_SIZE
);

1728 
ödex
 +
BG_BAND_REGION_5_SIZE
;

1730 
REGION_6_BG_BAND
:

1731 
	`NdisMoveMem‹y
(&
pAd
->
Ch™√lLi°
[
ödex
], &pAd->
TxPowî
[
BG_BAND_REGION_6_START
], (
CHANNEL_TX_POWER
Ë* 
BG_BAND_REGION_6_SIZE
);

1732 
ödex
 +
BG_BAND_REGION_6_SIZE
;

1734 
REGION_7_BG_BAND
:

1735 
	`NdisMoveMem‹y
(&
pAd
->
Ch™√lLi°
[
ödex
], &pAd->
TxPowî
[
BG_BAND_REGION_7_START
], (
CHANNEL_TX_POWER
Ë* 
BG_BAND_REGION_7_SIZE
);

1736 
ödex
 +
BG_BAND_REGION_7_SIZE
;

1743 i‡(
pAd
->
P‹tCfg
.
PhyMode
 =
PHY_11A
 || (pAd->P‹tCfg.PhyModê=
PHY_11ABG_MIXED
))

1745 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄F‹AB™d
 & 0x7f)

1747 
REGION_0_A_BAND
:

1748 
num
 = (
A_BAND_REGION_0_CHANNEL_LIST
)/(
UCHAR
);

1749 
pCh™√lLi°
 = 
A_BAND_REGION_0_CHANNEL_LIST
;

1751 
REGION_1_A_BAND
:

1752 
num
 = (
A_BAND_REGION_1_CHANNEL_LIST
)/(
UCHAR
);

1753 
pCh™√lLi°
 = 
A_BAND_REGION_1_CHANNEL_LIST
;

1755 
REGION_2_A_BAND
:

1756 
num
 = (
A_BAND_REGION_2_CHANNEL_LIST
)/(
UCHAR
);

1757 
pCh™√lLi°
 = 
A_BAND_REGION_2_CHANNEL_LIST
;

1759 
REGION_3_A_BAND
:

1760 
num
 = (
A_BAND_REGION_3_CHANNEL_LIST
)/(
UCHAR
);

1761 
pCh™√lLi°
 = 
A_BAND_REGION_3_CHANNEL_LIST
;

1763 
REGION_4_A_BAND
:

1764 
num
 = (
A_BAND_REGION_4_CHANNEL_LIST
)/(
UCHAR
);

1765 
pCh™√lLi°
 = 
A_BAND_REGION_4_CHANNEL_LIST
;

1767 
REGION_5_A_BAND
:

1768 
num
 = (
A_BAND_REGION_5_CHANNEL_LIST
)/(
UCHAR
);

1769 
pCh™√lLi°
 = 
A_BAND_REGION_5_CHANNEL_LIST
;

1771 
REGION_6_A_BAND
:

1772 
num
 = (
A_BAND_REGION_6_CHANNEL_LIST
)/(
UCHAR
);

1773 
pCh™√lLi°
 = 
A_BAND_REGION_6_CHANNEL_LIST
;

1775 
REGION_7_A_BAND
:

1776 
num
 = (
A_BAND_REGION_7_CHANNEL_LIST
)/(
UCHAR
);

1777 
pCh™√lLi°
 = 
A_BAND_REGION_7_CHANNEL_LIST
;

1779 
REGION_8_A_BAND
:

1780 
num
 = (
A_BAND_REGION_8_CHANNEL_LIST
)/(
UCHAR
);

1781 
pCh™√lLi°
 = 
A_BAND_REGION_8_CHANNEL_LIST
;

1783 
REGION_9_A_BAND
:

1784 
num
 = (
A_BAND_REGION_9_CHANNEL_LIST
)/(
UCHAR
);

1785 
pCh™√lLi°
 = 
A_BAND_REGION_9_CHANNEL_LIST
;

1787 
REGION_10_A_BAND
:

1788 
num
 = (
A_BAND_REGION_10_CHANNEL_LIST
)/(
UCHAR
);

1789 
pCh™√lLi°
 = 
A_BAND_REGION_10_CHANNEL_LIST
;

1792 
	`DBGPRINT
(
RT_DEBUG_WARN
,"cou¡ryªgi⁄=%dÇŸ suµ‹t", 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄F‹AB™d
);

1796 i‡(
num
 != 0)

1798 
i
=0; i<
num
; i++)

1800 
j
=0; j<
MAX_NUM_OF_CHANNELS
; j++)

1802 i‡(
pCh™√lLi°
[
i
] =
pAd
->
TxPowî
[
j
].
Ch™√l
)

1804 
	`NdisMoveMem‹y
(&
pAd
->
Ch™√lLi°
[
ödex
+
i
], &pAd->
TxPowî
[
j
], (
CHANNEL_TX_POWER
));

1808 
ödex
 +
num
;

1812 
pAd
->
Ch™√lLi°Num
 = 
ödex
;

1815 i‡(
pAd
->
P‹tCfg
.
BssTy≥
 =
BSS_ADHOC
)

1817 i‡(
	`Ch™√lS™ôy
(
pAd
,ÖAd->
P‹tCfg
.
AdhocCh™√l
Ë=
TRUE
)

1818 
pAd
->
P‹tCfg
.
Ch™√l
 =ÖAd->P‹tCfg.
AdhocCh™√l
;

1822 
	`DBGPRINT
(
RT_DEBUG_TRACE
,"country code=%d/%d, RFIC=%d, PHY mode=%d, support %d channels\n",

1823 
pAd
->
P‹tCfg
.
Cou¡ryRegi⁄
,ÖAd->P‹tCfg.
Cou¡ryRegi⁄F‹AB™d
,ÖAd->
RfIcTy≥
,ÖAd->P‹tCfg.
PhyMode
,ÖAd->
Ch™√lLi°Num
);

1824 
i
=0;i<
ödex
;i++)

1826 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"ch™√»#%d\n", 
pAd
->
Ch™√lLi°
[
i
].
Ch™√l
);

1828 
	}
}

1841 
UCHAR
 
	$NextCh™√l
(

1842 
IN
 
PRTMP_ADAPTER
 
pAd
,

1843 
IN
 
UCHAR
 
ch™√l
)

1845 
i
;

1846 
UCHAR
 
√xt_ch™√l
 = 0;

1848 
i
 = 0; i < (
pAd
->
Ch™√lLi°Num
 - 1); i++)

1849 i‡(
ch™√l
 =
pAd
->
Ch™√lLi°
[
i
].
Ch™√l
)

1851 
√xt_ch™√l
 = 
pAd
->
Ch™√lLi°
[
i
+1].
Ch™√l
;

1854  
√xt_ch™√l
;

1855 
	}
}

1867 
UCHAR
 
	$Fú°Ch™√l
(

1868 
IN
 
PRTMP_ADAPTER
 
pAd
)

1870  
pAd
->
Ch™√lLi°
[0].
Ch™√l
;

1871 
	}
}

1873 
CHAR
 
	$C⁄vîtToRssi
(

1874 
IN
 
PRTMP_ADAPTER
 
pAd
,

1875 
IN
 
UCHAR
 
Rssi
,

1876 
IN
 
UCHAR
 
RssiNumbî
)

1878 #ifde‡
BIG_ENDIAN


1879 
	u_LNA_AGC


1883 
UCHAR
 
Rsvd
:1;

1884 
UCHAR
 
L«
:2;

1885 
UCHAR
 
Agc
:5;

1886 } 
fõld
;

1887 
UCHAR
 
Byã
;

1888 } 
	tLNA_AGC
;

1890 
	u_LNA_AGC


1894 
UCHAR
 
Agc
:5;

1895 
UCHAR
 
L«
:2;

1896 
UCHAR
 
Rsvd
:1;

1897 } 
fõld
;

1898 
UCHAR
 
Byã
;

1899 } 
	tLNA_AGC
;

1902 
LNA_AGC
 
L«Agc
;

1903 
CHAR
 
RssiOff£t
 = 0;

1908 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 <= 14)

1910 i‡(
RssiNumbî
 =
RSSI_NO_1
)

1911 
RssiOff£t
 = 
pAd
->
BGRssiOff£t1
;

1912 i‡(
RssiNumbî
 =
RSSI_NO_2
)

1913 
RssiOff£t
 = 
pAd
->
BGRssiOff£t2
;

1917 i‡(
RssiNumbî
 =
RSSI_NO_1
)

1918 
RssiOff£t
 = 
pAd
->
ARssiOff£t1
;

1919 i‡(
RssiNumbî
 =
RSSI_NO_2
)

1920 
RssiOff£t
 = 
pAd
->
ARssiOff£t2
;

1923 
L«Agc
.
Byã
 = 
Rssi
;

1924 i‡(
pAd
->
NicC⁄fig2
.
fõld
.
Exã∫ÆLNA
 == 0)

1926 i‡(
L«Agc
.
fõld
.
L«
 == 0x03)

1928 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 <= 14)

1929  (
L«Agc
.
fõld
.
Agc
 * 2 - 90 + 
RssiOff£t
);

1931  (
L«Agc
.
fõld
.
Agc
 * 2 - 96 + 
RssiOff£t
);

1933 i‡(
L«Agc
.
fõld
.
L«
 == 0x02)

1935 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 <= 14)

1936  (
L«Agc
.
fõld
.
Agc
 * 2 - 74 + 
RssiOff£t
);

1938  (
L«Agc
.
fõld
.
Agc
 * 2 - 82 + 
RssiOff£t
);

1940 i‡(
L«Agc
.
fõld
.
L«
 == 0x01)

1942  (
L«Agc
.
fõld
.
Agc
 * 2 - 64 + 
RssiOff£t
);

1952 i‡(
L«Agc
.
fõld
.
L«
 == 0x03)

1954 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 <= 14)

1955  (
L«Agc
.
fõld
.
Agc
 * 2 - (90 + 14Ë+ 
RssiOff£t
);

1957  (
L«Agc
.
fõld
.
Agc
 * 2 - (100 + 14Ë+ 
RssiOff£t
);

1959 i‡(
L«Agc
.
fõld
.
L«
 == 0x02)

1961 i‡(
pAd
->
P‹tCfg
.
Ch™√l
 <= 14)

1962  (
L«Agc
.
fõld
.
Agc
 * 2 - (74 + 14Ë+ 
RssiOff£t
);

1964  (
L«Agc
.
fõld
.
Agc
 * 2 - (86 + 14Ë+ 
RssiOff£t
);

1966 i‡(
L«Agc
.
fõld
.
L«
 == 0x01)

1968  (
L«Agc
.
fõld
.
Agc
 * 2 - (64 + 14Ë+ 
RssiOff£t
);

1975 
	}
}

1977 
BUILD_TIMER_FUNCTION
(
MlmePîiodicExec
);

1978 
BUILD_TIMER_FUNCTION
(
AsicRxA¡EvÆTimeout
);

1979 
BUILD_TIMER_FUNCTION
(
LökDownExec
);

1980 
BUILD_TIMER_FUNCTION
(
Bóc⁄Timeout
);

1981 
BUILD_TIMER_FUNCTION
(
SˇnTimeout
);

1982 
BUILD_TIMER_FUNCTION
(
AssocTimeout
);

1983 
BUILD_TIMER_FUNCTION
(
RóssocTimeout
);

1984 
BUILD_TIMER_FUNCTION
(
DißssocTimeout
);

1985 
BUILD_TIMER_FUNCTION
(
AuthTimeout
);

1986 
BUILD_TIMER_FUNCTION
(
SèQuickRe•⁄eF‹R©eUpExec
);

	@wpa.c

39 
	~"π_c⁄fig.h
"

41 
UCHAR
 
	gCùhîW∑PskTkù
[] = {

51 
UCHAR
 
	gCùhîW∑PskTkùLí
 = ((
CùhîW∑PskTkù
) / (UCHAR));

53 
UCHAR
 
	gCùhîW∑PskAes
[] = {

63 
UCHAR
 
	gCùhîW∑PskAesLí
 = ((
CùhîW∑PskAes
) / (UCHAR));

65 
UCHAR
 
CùhîW∑2Tem∂©e
[];

66 
UCHAR
 
CùhîW∑2Tem∂©eLí
;

68 
	#WPARSNIE
 0xdd

	)

69 
	#WPA2RSNIE
 0x30

	)

71 
UCHAR
 
	g¥f_öput
[1024];

73 
	#ROUND_UP
(
__x
, 
__y
) \

74 ((()((
__x
)+((
__y
)-1))) & (()~((__y)-1)))\

75 

	)

96 
BOOLEAN
 
	$W∑MsgTy≥Sub°
(

97 
IN
 
UCHAR
 
EAPTy≥
,

98 
OUT
 
ULONG
 *
MsgTy≥
)

100 
EAPTy≥
)

102 
EAPPackë
:

103 *
MsgTy≥
 = 
MT2_EAPPackë
;

105 
EAPOLSèπ
:

106 *
MsgTy≥
 = 
MT2_EAPOLSèπ
;

108 
EAPOLLogoff
:

109 *
MsgTy≥
 = 
MT2_EAPOLLogoff
;

111 
EAPOLKey
:

112 *
MsgTy≥
 = 
MT2_EAPOLKey
;

114 
EAPOLASFAÀπ
:

115 *
MsgTy≥
 = 
MT2_EAPOLASFAÀπ
;

118 
	`DBGPRINT
(
RT_DEBUG_INFO
, "WpaMsgTypeSubst :Ñeturn FALSE; \n");

119  
FALSE
;

121  
TRUE
;

122 
	}
}

132 
VOID
 
	$W∑PskSèãMachöeInô
(

133 
IN
 
PRTMP_ADAPTER
 
pAd
,

134 
IN
 
STATE_MACHINE
 *
S
,

135 
OUT
 
STATE_MACHINE_FUNC
 
Tøns
[])

137 
	`SèãMachöeInô
(
S
, (
STATE_MACHINE_FUNC
*)
Tøns
, 
MAX_WPA_PSK_STATE
, 
MAX_WPA_PSK_MSG
, (STATE_MACHINE_FUNC)
Dr›
, 
WPA_PSK_IDLE
, 
WPA_MACHINE_BASE
);

138 
	`SèãMachöeSëA˘i⁄
(
S
, 
WPA_PSK_IDLE
, 
MT2_EAPOLKey
, (
STATE_MACHINE_FUNC
)
W∑EAPOLKeyA˘i⁄
);

139 
	}
}

155 
VOID
 
	$W∑EAPOLKeyA˘i⁄
(

156 
IN
 
PRTMP_ADAPTER
 
pAd
,

157 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

159 
INT
 
MsgTy≥
 = 
EAPOL_MSG_INVALID
;

160 
PKEY_DESCRIPTER
 
pKeyDesc
;

161 
PHEADER_802_11
 
pHódî
;

162 
UCHAR
 
ZîoRïœy
[
LEN_KEY_DESC_REPLAY
];

164 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "-----> WpaEAPOLKeyAction\n");

166 
pHódî
 = (
PHEADER_802_11
Ë
EÀm
->
Msg
;

169 
pKeyDesc
 = (
PKEY_DESCRIPTER
Ë&
EÀm
->
Msg
[(
LENGTH_802_11
 + 
LENGTH_802_1_H
 + 
LENGTH_EAPOL_H
)];

171 #ifde‡
BIG_ENDIAN


175 
USHORT
 
tmpKeyöfo
;

177 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
pKeyDesc
->
KeyInfo
, (
USHORT
));

178 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

179 
	`NdisMoveMem‹y
(&
pKeyDesc
->
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

185 
	`DBGPRINT
(
RT_DEBUG_INFO
, "KeyInfÿKey Des¸ùti⁄ Vîsi⁄ %d\n", 
pKeyDesc
->
KeyInfo
.
KeyDescVî
);

186 
	`DBGPRINT
(
RT_DEBUG_INFO
, "KeyInfÿKey Ty≥ %d\n", 
pKeyDesc
->
KeyInfo
.
KeyTy≥
);

187 
	`DBGPRINT
(
RT_DEBUG_INFO
, "KeyInfÿKey Index %d\n", 
pKeyDesc
->
KeyInfo
.
KeyIndex
);

188 
	`DBGPRINT
(
RT_DEBUG_INFO
, "KeyInfÿIn°Æ»%d\n", 
pKeyDesc
->
KeyInfo
.
In°Æl
);

189 
	`DBGPRINT
(
RT_DEBUG_INFO
, "KeyInfÿKey Ack %d\n", 
pKeyDesc
->
KeyInfo
.
KeyAck
);

190 
	`DBGPRINT
(
RT_DEBUG_INFO
, "KeyInfÿKey MIC %d\n", 
pKeyDesc
->
KeyInfo
.
KeyMic
);

191 
	`DBGPRINT
(
RT_DEBUG_INFO
, "KeyInfÿSecuª %d\n", 
pKeyDesc
->
KeyInfo
.
Secuª
);

192 
	`DBGPRINT
(
RT_DEBUG_INFO
, "KeyInfÿEº‹ %d\n", 
pKeyDesc
->
KeyInfo
.
Eº‹
);

193 
	`DBGPRINT
(
RT_DEBUG_INFO
, "KeyInfÿReque° %d\n", 
pKeyDesc
->
KeyInfo
.
Reque°
);

194 
	`DBGPRINT
(
RT_DEBUG_INFO
, "KeyInfÿEKD_DL %d\n", 
pKeyDesc
->
KeyInfo
.
EKD_DL
);

198 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAPSK
)

200 i‡(
pKeyDesc
->
Ty≥
 !
WPA1_KEY_DESC
)

202 
	`DBGPRINT
(
RT_DEBUG_ERROR
, " Key descripter doesÇot match with WPA1Ñule \n");

206 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2PSK
)

208 i‡(
pKeyDesc
->
Ty≥
 !
WPA2_KEY_DESC
)

210 
	`DBGPRINT
(
RT_DEBUG_ERROR
, " Key descripter doesÇot match with WPA2Ñule \n");

217 
	`NdisZîoMem‹y
(
ZîoRïœy
, 
LEN_KEY_DESC_REPLAY
);

218 i‡((
	`RTMPCom∑ªMem‹y
(
pKeyDesc
->
RïœyCou¡î
, 
pAd
->
P‹tCfg
.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
) != 1) &&

219 (
	`RTMPCom∑ªMem‹y
(
pKeyDesc
->
RïœyCou¡î
, 
ZîoRïœy
, 
LEN_KEY_DESC_REPLAY
) != 0))

221 
	`DBGPRINT
(
RT_DEBUG_ERROR
, " ReplayCounterÇot match \n");

231 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPA2PSK
)

233 i‡((
pKeyDesc
->
KeyInfo
.
KeyTy≥
 == 1) &&

234 (
pKeyDesc
->
KeyInfo
.
EKD_DL
 == 0) &&

235 (
pKeyDesc
->
KeyInfo
.
KeyAck
 == 1) &&

236 (
pKeyDesc
->
KeyInfo
.
KeyMic
 == 0) &&

237 (
pKeyDesc
->
KeyInfo
.
Secuª
 == 0) &&

238 (
pKeyDesc
->
KeyInfo
.
Eº‹
 == 0) &&

239 (
pKeyDesc
->
KeyInfo
.
Reque°
 == 0))

241 
MsgTy≥
 = 
EAPOL_PAIR_MSG_1
;

242 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Receive EAPOL Key Pairwise Message 1\n");

244 i‡((
pKeyDesc
->
KeyInfo
.
KeyTy≥
 == 1) &&

245 (
pKeyDesc
->
KeyInfo
.
EKD_DL
 == 1) &&

246 (
pKeyDesc
->
KeyInfo
.
KeyAck
 == 1) &&

247 (
pKeyDesc
->
KeyInfo
.
KeyMic
 == 1) &&

248 (
pKeyDesc
->
KeyInfo
.
Secuª
 == 1) &&

249 (
pKeyDesc
->
KeyInfo
.
Eº‹
 == 0) &&

250 (
pKeyDesc
->
KeyInfo
.
Reque°
 == 0))

252 
MsgTy≥
 = 
EAPOL_PAIR_MSG_3
;

253 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Receive EAPOL Key Pairwise Message 3\n");

255 i‡((
pKeyDesc
->
KeyInfo
.
KeyTy≥
 == 0) &&

256 (
pKeyDesc
->
KeyInfo
.
EKD_DL
 == 1) &&

257 (
pKeyDesc
->
KeyInfo
.
KeyAck
 == 1) &&

258 (
pKeyDesc
->
KeyInfo
.
KeyMic
 == 1) &&

259 (
pKeyDesc
->
KeyInfo
.
Secuª
 == 1) &&

260 (
pKeyDesc
->
KeyInfo
.
Eº‹
 == 0) &&

261 (
pKeyDesc
->
KeyInfo
.
Reque°
 == 0))

263 
MsgTy≥
 = 
EAPOL_GROUP_MSG_1
;

264 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Receive EAPOL Key Group Message 1\n");

267 #ifde‡
BIG_ENDIAN


270 
USHORT
 
tmpKeyöfo
;

272 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
pKeyDesc
->
KeyInfo
, (
USHORT
));

273 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

274 
	`NdisMoveMem‹y
(&
pKeyDesc
->
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

280 
pAd
->
P‹tCfg
.
W∑Sèã
)

282 
SS_START
:

283 i‡(
MsgTy≥
 =
EAPOL_PAIR_MSG_1
)

285 
	`W∑2PaúMsg1A˘i⁄
(
pAd
, 
EÀm
);

286 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_WAIT_MSG_3
;

290 
SS_WAIT_MSG_3
:

291 i‡(
MsgTy≥
 =
EAPOL_PAIR_MSG_1
)

293 
	`W∑2PaúMsg1A˘i⁄
(
pAd
, 
EÀm
);

294 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_WAIT_MSG_3
;

296 i‡(
MsgTy≥
 =
EAPOL_PAIR_MSG_3
)

298 
	`W∑2PaúMsg3A˘i⁄
(
pAd
, 
EÀm
);

299 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_WAIT_GROUP
;

303 
SS_WAIT_GROUP
:

304 
SS_FINISH
:

305 i‡(
MsgTy≥
 =
EAPOL_PAIR_MSG_1
)

307 
	`W∑2PaúMsg1A˘i⁄
(
pAd
, 
EÀm
);

308 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_WAIT_MSG_3
;

310 
pAd
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_NOT_SECURED
;

312 i‡(
MsgTy≥
 =
EAPOL_PAIR_MSG_3
)

314 
	`W∑2PaúMsg3A˘i⁄
(
pAd
, 
EÀm
);

315 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_WAIT_GROUP
;

317 
pAd
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_NOT_SECURED
;

319 i‡(
MsgTy≥
 =
EAPOL_GROUP_MSG_1
)

321 
	`W∑GroupMsg1A˘i⁄
(
pAd
, 
EÀm
);

322 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_FINISH
;

337 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAPSK
)

339 i‡((
pKeyDesc
->
KeyInfo
.
KeyTy≥
 == 1) &&

340 (
pKeyDesc
->
KeyInfo
.
KeyIndex
 == 0) &&

341 (
pKeyDesc
->
KeyInfo
.
KeyAck
 == 1) &&

342 (
pKeyDesc
->
KeyInfo
.
KeyMic
 == 0) &&

343 (
pKeyDesc
->
KeyInfo
.
Secuª
 == 0) &&

344 (
pKeyDesc
->
KeyInfo
.
Eº‹
 == 0) &&

345 (
pKeyDesc
->
KeyInfo
.
Reque°
 == 0))

347 
MsgTy≥
 = 
EAPOL_PAIR_MSG_1
;

348 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Receive EAPOL Key Pairwise Message 1\n");

350 i‡((
pKeyDesc
->
KeyInfo
.
KeyTy≥
 == 1) &&

351 (
pKeyDesc
->
KeyInfo
.
KeyIndex
 == 0) &&

352 (
pKeyDesc
->
KeyInfo
.
KeyAck
 == 1) &&

353 (
pKeyDesc
->
KeyInfo
.
KeyMic
 == 1) &&

354 (
pKeyDesc
->
KeyInfo
.
Secuª
 == 0) &&

355 (
pKeyDesc
->
KeyInfo
.
Eº‹
 == 0) &&

356 (
pKeyDesc
->
KeyInfo
.
Reque°
 == 0))

358 
MsgTy≥
 = 
EAPOL_PAIR_MSG_3
;

359 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Receive EAPOL Key Pairwise Message 3\n");

361 i‡((
pKeyDesc
->
KeyInfo
.
KeyTy≥
 == 0) &&

362 (
pKeyDesc
->
KeyInfo
.
KeyIndex
 != 0) &&

363 (
pKeyDesc
->
KeyInfo
.
KeyAck
 == 1) &&

364 (
pKeyDesc
->
KeyInfo
.
KeyMic
 == 1) &&

365 (
pKeyDesc
->
KeyInfo
.
Secuª
 == 1) &&

366 (
pKeyDesc
->
KeyInfo
.
Eº‹
 == 0) &&

367 (
pKeyDesc
->
KeyInfo
.
Reque°
 == 0))

369 
MsgTy≥
 = 
EAPOL_GROUP_MSG_1
;

370 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Receive EAPOL Key Group Message 1\n");

373 #ifde‡
BIG_ENDIAN


376 
USHORT
 
tmpKeyöfo
;

378 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
pKeyDesc
->
KeyInfo
, (
USHORT
));

379 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

380 
	`NdisMoveMem‹y
(&
pKeyDesc
->
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

386 
pAd
->
P‹tCfg
.
W∑Sèã
)

388 
SS_START
:

389 i‡(
MsgTy≥
 =
EAPOL_PAIR_MSG_1
)

391 
	`W∑PaúMsg1A˘i⁄
(
pAd
, 
EÀm
);

392 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_WAIT_MSG_3
;

396 
SS_WAIT_MSG_3
:

397 i‡(
MsgTy≥
 =
EAPOL_PAIR_MSG_1
)

399 
	`W∑PaúMsg1A˘i⁄
(
pAd
, 
EÀm
);

400 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_WAIT_MSG_3
;

402 i‡(
MsgTy≥
 =
EAPOL_PAIR_MSG_3
)

404 
	`W∑PaúMsg3A˘i⁄
(
pAd
, 
EÀm
);

405 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_WAIT_GROUP
;

409 
SS_WAIT_GROUP
:

410 
SS_FINISH
:

411 i‡(
MsgTy≥
 =
EAPOL_PAIR_MSG_1
)

413 
	`W∑PaúMsg1A˘i⁄
(
pAd
, 
EÀm
);

414 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_WAIT_MSG_3
;

416 
pAd
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_NOT_SECURED
;

418 i‡(
MsgTy≥
 =
EAPOL_PAIR_MSG_3
)

420 
	`W∑PaúMsg3A˘i⁄
(
pAd
, 
EÀm
);

421 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_WAIT_GROUP
;

423 
pAd
->
P‹tCfg
.
P‹tSecuªd
 = 
WPA_802_1X_PORT_NOT_SECURED
;

425 i‡(
MsgTy≥
 =
EAPOL_GROUP_MSG_1
)

427 
	`W∑GroupMsg1A˘i⁄
(
pAd
, 
EÀm
);

428 
pAd
->
P‹tCfg
.
W∑Sèã
 = 
SS_FINISH
;

437 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "<----- WpaEAPOLKeyAction\n");

438 
	}
}

458 
VOID
 
	$W∑PaúMsg1A˘i⁄
(

459 
IN
 
PRTMP_ADAPTER
 
pAd
,

460 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

462 
PHEADER_802_11
 
pHódî
;

463 
UCHAR
 
PTK
[80];

464 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

465 
HEADER_802_11
 
Hódî_802_11
;

466 
UCHAR
 
AckR©e
 = 
RATE_2
;

467 
USHORT
 
AckDuøti⁄
 = 0;

468 
ULONG
 
FømeLí
 = 0;

469 
UCHAR
 
EAPHEAD
[8] = {0xaa, 0xaa, 0x03, 0x00, 0x00, 0x00,0x88,0x8e};

470 
PEAPOL_PACKET
 
pMsg1
;

471 
EAPOL_PACKET
 
Packë
;

472 
UCHAR
 
Mic
[16];

473 
USHORT
 
NSètus
;

475 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "WpaPairMsg1Action ----->\n");

477 
pHódî
 = (
PHEADER_802_11
Ë
EÀm
->
Msg
;

480 
pMsg1
 = (
PEAPOL_PACKET
Ë&
EÀm
->
Msg
[
LENGTH_802_11
 + 
LENGTH_802_1_H
];

485 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
RïœyCou¡î
, 
pMsg1
->
KeyDesc
.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
);

488 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
AN⁄˚
, 
pMsg1
->
KeyDesc
.
KeyN⁄˚
, 
LEN_KEY_DESC_NONCE
);

492 
	`GíR™dom
(
pAd
,ÖAd->
P‹tCfg
.
SN⁄˚
);

495 
	`W∑Cou¡PTK
(
pAd
->
P‹tCfg
.
PskKey
.
Key
,

496 
pAd
->
P‹tCfg
.
AN⁄˚
,

497 
pAd
->
P‹tCfg
.
Bssid
,

498 
pAd
->
P‹tCfg
.
SN⁄˚
,

499 
pAd
->
CuºítAddªss
,

500 
PTK
,

501 
LEN_PTK
);

504 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
PTK
, PTK, 
LEN_PTK
);

509 
pAd
->
Sequí˚
 = (’Ad->Sequí˚Ë+ 1Ë& (
MAX_SEQ_NUMBER
);

510 
	`W∑MacHódîInô
(
pAd
, &
Hódî_802_11
, 0,ÖAd->
P‹tCfg
.
Bssid
);

513 
AckR©e
 = 
pAd
->
P‹tCfg
.
Ex≥˘edACKR©e
[pAd->P‹tCfg.
TxR©e
];

514 
AckDuøti⁄
 = 
	`RTMPCÆcDuøti⁄
(
pAd
, 
AckR©e
, 14);

515 
Hódî_802_11
.
Duøti⁄
 = 
pAd
->
P‹tCfg
.
Dsifs
 + 
AckDuøti⁄
;

518 
	`NdisZîoMem‹y
(&
Packë
, (Packet));

519 
Packë
.
Vîsi⁄
 = 
EAPOL_VER
;

520 
Packë
.
Ty≥
 = 
EAPOLKey
;

524 
Packë
.
KeyDesc
.
Ty≥
 = 
RSN_KEY_DESC
;

526 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

528 
Packë
.
KeyDesc
.
KeyInfo
.
KeyDescVî
 = 2;

532 
Packë
.
KeyDesc
.
KeyInfo
.
KeyDescVî
 = 1;

534 
Packë
.
KeyDesc
.
KeyD©aLí
[1] = 
pAd
->
P‹tCfg
.
RSN_IELí
;

535 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
KeyD©a
, 
pAd
->
P‹tCfg
.
RSN_IE
,ÖAd->P‹tCfg.
RSN_IELí
);

538 
Packë
.
Lí
[1] = (
KEY_DESCRIPTER
Ë- 
MAX_LEN_OF_RSNIE
 + Packë.
KeyDesc
.
KeyD©aLí
[1];

541 
Packë
.
KeyDesc
.
KeyLígth
[0] = 
pMsg1
->KeyDesc.KeyLength[0];

542 
Packë
.
KeyDesc
.
KeyLígth
[1] = 
pMsg1
->KeyDesc.KeyLength[1];

545 
Packë
.
KeyDesc
.
KeyInfo
.
KeyTy≥
 = 1;

548 
Packë
.
KeyDesc
.
KeyInfo
.
KeyMic
 = 1;

551 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
KeyN⁄˚
, 
pAd
->
P‹tCfg
.
SN⁄˚
, 
LEN_KEY_DESC_NONCE
);

554 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
RïœyCou¡î
, 
pAd
->
P‹tCfg
.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
);

556 #ifde‡
BIG_ENDIAN


559 
USHORT
 
tmpKeyöfo
;

561 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
Packë
.
KeyDesc
.
KeyInfo
, (
USHORT
));

562 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

563 
	`NdisMoveMem‹y
(&
Packë
.
KeyDesc
.
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

569 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

570 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

575 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

576 
Packë
.
Lí
[1] + 4, &Packet,

577 
END_OF_ARGS
);

580 
	`NdisZîoMem‹y
(
Mic
, (Mic));

581 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

584 
UCHAR
 
dige°
[80];

586 
	`HMAC_SHA1
(
pOutBuf„r
, 
FømeLí
, 
PTK
, 
LEN_EAP_MICK
, 
dige°
);

587 
	`NdisMoveMem‹y
(
Mic
, 
dige°
, 
LEN_KEY_DESC_MIC
);

591 
INT
 
i
;

592 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, " PMK = ");

593 
i
 = 0; i < 16; i++)

594 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "%2x-", 
pAd
->
P‹tCfg
.
PskKey
.
Key
[
i
]);

596 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "\n PTK = ");

597 
i
 = 0; i < 64; i++)

598 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "%2x-", 
pAd
->
P‹tCfg
.
PTK
[
i
]);

599 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "\¿FømeLí = %d\n", 
FømeLí
);

601 
	`hmac_md5
(
PTK
, 
LEN_EAP_MICK
, 
pOutBuf„r
, 
FømeLí
, 
Mic
);

603 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
KeyMic
, 
Mic
, 
LEN_KEY_DESC_MIC
);

605 
FømeLí
 = 0;

606 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

607 (
HEADER_802_11
),&
Hódî_802_11
,

608 (
EAPHEAD
), EAPHEAD,

609 
Packë
.
Lí
[1] + 4, &Packet,

610 
END_OF_ARGS
);

613 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

616 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "WpaPairMsg1Action <-----\n");

617 
	}
}

619 
VOID
 
	$W∑2PaúMsg1A˘i⁄
(

620 
IN
 
PRTMP_ADAPTER
 
pAd
,

621 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

623 
PHEADER_802_11
 
pHódî
;

624 
UCHAR
 
PTK
[80];

625 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

626 
HEADER_802_11
 
Hódî_802_11
;

627 
UCHAR
 
AckR©e
 = 
RATE_2
;

628 
USHORT
 
AckDuøti⁄
 = 0;

629 
ULONG
 
FømeLí
 = 0;

630 
UCHAR
 
EAPHEAD
[8] = {0xaa, 0xaa, 0x03, 0x00, 0x00, 0x00,0x88,0x8e};

631 
PEAPOL_PACKET
 
pMsg1
;

632 
EAPOL_PACKET
 
Packë
;

633 
UCHAR
 
Mic
[16];

634 
USHORT
 
NSètus
;

636 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Wpa2PairMsg1Action ----->\n");

638 
pHódî
 = (
PHEADER_802_11
Ë
EÀm
->
Msg
;

641 
pMsg1
 = (
PEAPOL_PACKET
Ë&
EÀm
->
Msg
[
LENGTH_802_11
 + 
LENGTH_802_1_H
];

646 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
RïœyCou¡î
, 
pMsg1
->
KeyDesc
.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
);

649 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
AN⁄˚
, 
pMsg1
->
KeyDesc
.
KeyN⁄˚
, 
LEN_KEY_DESC_NONCE
);

653 
	`GíR™dom
(
pAd
,ÖAd->
P‹tCfg
.
SN⁄˚
);

655 i‡(
pMsg1
->
KeyDesc
.
KeyD©aLí
[1] > 0 )

661 
	`W∑Cou¡PTK
(
pAd
->
P‹tCfg
.
PskKey
.
Key
,

662 
pAd
->
P‹tCfg
.
AN⁄˚
,

663 
pAd
->
P‹tCfg
.
Bssid
,

664 
pAd
->
P‹tCfg
.
SN⁄˚
,

665 
pAd
->
CuºítAddªss
,

666 
PTK
,

667 
LEN_PTK
);

670 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
PTK
, PTK, 
LEN_PTK
);

675 
pAd
->
Sequí˚
 = (’Ad->Sequí˚Ë+ 1Ë& (
MAX_SEQ_NUMBER
);

676 
	`W∑MacHódîInô
(
pAd
, &
Hódî_802_11
, 0,ÖAd->
P‹tCfg
.
Bssid
);

679 
AckR©e
 = 
pAd
->
P‹tCfg
.
Ex≥˘edACKR©e
[pAd->P‹tCfg.
TxR©e
];

680 
AckDuøti⁄
 = 
	`RTMPCÆcDuøti⁄
(
pAd
, 
AckR©e
, 14);

681 
Hódî_802_11
.
Duøti⁄
 = 
pAd
->
P‹tCfg
.
Dsifs
 + 
AckDuøti⁄
;

684 
	`NdisZîoMem‹y
(&
Packë
, (Packet));

685 
Packë
.
Vîsi⁄
 = 
EAPOL_VER
;

686 
Packë
.
Ty≥
 = 
EAPOLKey
;

690 
Packë
.
KeyDesc
.
Ty≥
 = 
WPA2_KEY_DESC
;

692 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
KeyD©a
, 
pAd
->
P‹tCfg
.
RSN_IE
,ÖAd->P‹tCfg.
RSN_IELí
);

693 
Packë
.
KeyDesc
.
KeyD©aLí
[1] = 
pAd
->
P‹tCfg
.
RSN_IELí
;

696 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

698 
Packë
.
KeyDesc
.
KeyInfo
.
KeyDescVî
 = 2;

702 
Packë
.
KeyDesc
.
KeyInfo
.
KeyDescVî
 = 1;

705 
Packë
.
Lí
[1] = (
KEY_DESCRIPTER
Ë- 
MAX_LEN_OF_RSNIE
 + Packë.
KeyDesc
.
KeyD©aLí
[1];

708 
Packë
.
KeyDesc
.
KeyInfo
.
KeyTy≥
 = 1;

711 
Packë
.
KeyDesc
.
KeyInfo
.
KeyMic
 = 1;

714 
Packë
.
KeyDesc
.
KeyLígth
[0] = 0;

715 
Packë
.
KeyDesc
.
KeyLígth
[1] = 
pMsg1
->KeyDesc.KeyLength[1];

718 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
KeyN⁄˚
, 
pAd
->
P‹tCfg
.
SN⁄˚
, 
LEN_KEY_DESC_NONCE
);

721 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
RïœyCou¡î
, 
pAd
->
P‹tCfg
.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
);

723 #ifde‡
BIG_ENDIAN


726 
USHORT
 
tmpKeyöfo
;

728 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
Packë
.
KeyDesc
.
KeyInfo
, (
USHORT
));

729 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

730 
	`NdisMoveMem‹y
(&
Packë
.
KeyDesc
.
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

736 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

737 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

743 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

744 
Packë
.
Lí
[1] + 4, &Packet,

745 
END_OF_ARGS
);

749 
	`NdisZîoMem‹y
(
Mic
, (Mic));

750 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

753 
UCHAR
 
dige°
[80];

755 
	`HMAC_SHA1
(
pOutBuf„r
, 
FømeLí
, 
PTK
, 
LEN_EAP_MICK
, 
dige°
);

756 
	`NdisMoveMem‹y
(
Mic
, 
dige°
, 
LEN_KEY_DESC_MIC
);

760 
	`hmac_md5
(
PTK
, 
LEN_EAP_MICK
, 
pOutBuf„r
, 
FømeLí
, 
Mic
);

762 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
KeyMic
, 
Mic
, 
LEN_KEY_DESC_MIC
);

765 
FømeLí
 = 0;

767 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

768 (
HEADER_802_11
), &
Hódî_802_11
,

769 (
EAPHEAD
), EAPHEAD,

770 
Packë
.
Lí
[1] + 4, &Packet,

771 
END_OF_ARGS
);

775 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

778 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Wpa2PairMsg1Action <-----\n");

780 
	}
}

799 
VOID
 
	$W∑PaúMsg3A˘i⁄
(

800 
IN
 
PRTMP_ADAPTER
 
pAd
,

801 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

803 
PHEADER_802_11
 
pHódî
;

804 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

805 
HEADER_802_11
 
Hódî_802_11
;

806 
UCHAR
 
AckR©e
 = 
RATE_2
;

807 
USHORT
 
AckDuøti⁄
 = 0;

808 
ULONG
 
FømeLí
 = 0;

809 
UCHAR
 
EAPHEAD
[8] = {0xaa, 0xaa, 0x03, 0x00, 0x00, 0x00,0x88,0x8e};

810 
EAPOL_PACKET
 
Packë
;

811 
PEAPOL_PACKET
 
pMsg3
;

812 
UCHAR
 
Mic
[16], 
OldMic
[16];

813 
PNDIS_802_11_KEY
 
pPìrKey
;

814 
USHORT
 
NSètus
;

816 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "WpaPairMsg3Action ----->\n");

818 
pHódî
 = (
PHEADER_802_11
Ë
EÀm
->
Msg
;

821 
pMsg3
 = (
PEAPOL_PACKET
Ë&
EÀm
->
Msg
[
LENGTH_802_11
 + 
LENGTH_802_1_H
];

823 #ifde‡
BIG_ENDIAN


826 
USHORT
 
tmpKeyöfo
;

828 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
pMsg3
->
KeyDesc
.
KeyInfo
, (
USHORT
));

829 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

830 
	`NdisMoveMem‹y
(&
pMsg3
->
KeyDesc
.
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

835 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
 && (
pMsg3
->
KeyDesc
.
KeyInfo
.
KeyDescVî
 != 2))

839 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
 && (
pMsg3
->
KeyDesc
.
KeyInfo
.
KeyDescVî
 != 1))

844 #ifde‡
BIG_ENDIAN


847 
USHORT
 
tmpKeyöfo
;

849 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
pMsg3
->
KeyDesc
.
KeyInfo
, (
USHORT
));

850 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

851 
	`NdisMoveMem‹y
(&
pMsg3
->
KeyDesc
.
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

857 
	`NdisMoveMem‹y
(
OldMic
, 
pMsg3
->
KeyDesc
.
KeyMic
, 
LEN_KEY_DESC_MIC
);

858 
	`NdisZîoMem‹y
(
pMsg3
->
KeyDesc
.
KeyMic
, 
LEN_KEY_DESC_MIC
);

859 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

862 
UCHAR
 
dige°
[80];

864 
	`HMAC_SHA1
((
PUCHAR
Ë
pMsg3
,ÖMsg3->
Lí
[1] + 4, 
pAd
->
P‹tCfg
.
PTK
, 
LEN_EAP_MICK
, 
dige°
);

865 
	`NdisMoveMem‹y
(
Mic
, 
dige°
, 
LEN_KEY_DESC_MIC
);

869 
	`hmac_md5
(
pAd
->
P‹tCfg
.
PTK
, 
LEN_EAP_MICK
, (
PUCHAR
Ë
pMsg3
,ÖMsg3->
Lí
[1] + 4, 
Mic
);

872 i‡(!
	`NdisEquÆMem‹y
(
OldMic
, 
Mic
, 
LEN_KEY_DESC_MIC
))

874 
	`DBGPRINT
(
RT_DEBUG_ERROR
, " MIC Different in msg 3 of 4-way handshake!!!!!!!!!! \n");

878 
	`DBGPRINT
(
RT_DEBUG_TRACE
, " MIC VALID in msg 3 of 4-way handshake!!!!!!!!!! \n");

881 i‡(
	`RTMPCom∑ªMem‹y
(
pMsg3
->
KeyDesc
.
RïœyCou¡î
, 
pAd
->
P‹tCfg
.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
) != 1)

885 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
RïœyCou¡î
, 
pMsg3
->
KeyDesc
.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
);

888 i‡(!
	`NdisEquÆMem‹y
(
pAd
->
P‹tCfg
.
AN⁄˚
, 
pMsg3
->
KeyDesc
.
KeyN⁄˚
, 
LEN_KEY_DESC_NONCE
))

895 
pAd
->
Sequí˚
 = (’Ad->Sequí˚Ë+ 1Ë& (
MAX_SEQ_NUMBER
);

896 
	`W∑MacHódîInô
(
pAd
, &
Hódî_802_11
, 0,ÖAd->
P‹tCfg
.
Bssid
);

899 
AckR©e
 = 
pAd
->
P‹tCfg
.
Ex≥˘edACKR©e
[pAd->P‹tCfg.
TxR©e
];

900 
AckDuøti⁄
 = 
	`RTMPCÆcDuøti⁄
(
pAd
, 
AckR©e
, 14);

901 
Hódî_802_11
.
Duøti⁄
 = 
pAd
->
P‹tCfg
.
Dsifs
 + 
AckDuøti⁄
;

904 
	`NdisZîoMem‹y
(&
Packë
, (Packet));

905 
Packë
.
Vîsi⁄
 = 
EAPOL_VER
;

906 
Packë
.
Ty≥
 = 
EAPOLKey
;

907 
Packë
.
Lí
[1] = (
KEY_DESCRIPTER
Ë- 
MAX_LEN_OF_RSNIE
;

912 
Packë
.
KeyDesc
.
Ty≥
 = 
RSN_KEY_DESC
;

914 #ifde‡
BIG_ENDIAN


917 
USHORT
 
tmpKeyöfo
;

919 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
pMsg3
->
KeyDesc
.
KeyInfo
, (
USHORT
));

920 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

921 
	`NdisMoveMem‹y
(&
pMsg3
->
KeyDesc
.
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

926 
Packë
.
KeyDesc
.
KeyInfo
.
KeyDescVî
 = 
pMsg3
->KeyDesc.KeyInfo.KeyDescVer;

929 
Packë
.
KeyDesc
.
KeyLígth
[0] = 
pMsg3
->KeyDesc.KeyLength[0];

930 
Packë
.
KeyDesc
.
KeyLígth
[1] = 
pMsg3
->KeyDesc.KeyLength[1];

933 
Packë
.
KeyDesc
.
KeyInfo
.
KeyTy≥
 = 1;

936 
Packë
.
KeyDesc
.
KeyInfo
.
KeyMic
 = 1;

940 
Packë
.
KeyDesc
.
KeyInfo
.
Secuª

pMsg3
->KeyDesc.KeyInfo.Secure;

944 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
RïœyCou¡î
, 
pMsg3
->KeyDesc.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
);

946 #ifde‡
BIG_ENDIAN


949 
USHORT
 
tmpKeyöfo
;

951 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
Packë
.
KeyDesc
.
KeyInfo
, (
USHORT
));

952 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

953 
	`NdisMoveMem‹y
(&
Packë
.
KeyDesc
.
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

958 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

959 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

964 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

965 
Packë
.
Lí
[1] + 4, &Packet,

966 
END_OF_ARGS
);

969 
	`NdisZîoMem‹y
(
Mic
, (Mic));

970 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

973 
UCHAR
 
dige°
[80];

975 
	`HMAC_SHA1
(
pOutBuf„r
, 
FømeLí
, 
pAd
->
P‹tCfg
.
PTK
, 
LEN_EAP_MICK
, 
dige°
);

976 
	`NdisMoveMem‹y
(
Mic
, 
dige°
, 
LEN_KEY_DESC_MIC
);

980 
	`hmac_md5
(
pAd
->
P‹tCfg
.
PTK
, 
LEN_EAP_MICK
, 
pOutBuf„r
, 
FømeLí
, 
Mic
);

982 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
KeyMic
, 
Mic
, 
LEN_KEY_DESC_MIC
);

984 
FømeLí
 = 0;

987 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

988 (
HEADER_802_11
),&
Hódî_802_11
,

989 (
EAPHEAD
), EAPHEAD,

990 
Packë
.
Lí
[1] + 4, &Packet,

991 
END_OF_ARGS
);

995 
pPìrKey
 = 
	`kmÆloc
(
MAX_LEN_OF_MLME_BUFFER
, 
MEM_ALLOC_FLAG
);

996 i‡(
pPìrKey
 =
NULL
)

999 
	`NdisZîoMem‹y
(
pPìrKey
, (
NDIS_802_11_KEY
Ë+ 
LEN_EAP_KEY
);

1000 
pPìrKey
->
Lígth
 = (
NDIS_802_11_KEY
Ë+ 
LEN_EAP_KEY
;

1001 
pPìrKey
->
KeyIndex
 = 0xe0000000;

1002 
pPìrKey
->
KeyLígth
 = 
pMsg3
->
KeyDesc
.KeyLength[0] * 256 +ÖMsg3->KeyDesc.KeyLength[1];

1004 
	`COPY_MAC_ADDR
(
pPìrKey
->
BSSID
, 
pAd
->
P‹tCfg
.
Bssid
);

1005 
	`NdisMoveMem‹y
(&
pPìrKey
->
KeyRSC
, 
pMsg3
->
KeyDesc
.
KeyRsc
, 
LEN_KEY_DESC_RSC
);

1006 
	`NdisMoveMem‹y
(
pPìrKey
->
KeyM©îül
, &
pAd
->
P‹tCfg
.
PTK
[32], 
LEN_EAP_KEY
);

1008 
	`RTMPWPAAddKeyProc
(
pAd
, 
pPìrKey
);

1009 
	`k‰ì
(
pPìrKey
);

1013 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

1016 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "WpaPairMsg3Action <-----\n");

1017 
	}
}

1019 
VOID
 
	$W∑2PaúMsg3A˘i⁄
(

1020 
IN
 
PRTMP_ADAPTER
 
pAd
,

1021 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1023 
PHEADER_802_11
 
pHódî
;

1024 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

1025 
HEADER_802_11
 
Hódî_802_11
;

1026 
UCHAR
 
AckR©e
 = 
RATE_2
;

1027 
USHORT
 
AckDuøti⁄
 = 0;

1028 
ULONG
 
FømeLí
 = 0;

1029 
UCHAR
 
EAPHEAD
[8] = {0xaa, 0xaa, 0x03, 0x00, 0x00, 0x00,0x88,0x8e};

1030 
EAPOL_PACKET
 
Packë
;

1031 
PEAPOL_PACKET
 
pMsg3
;

1032 
UCHAR
 
Mic
[16], 
OldMic
[16];

1033 
PNDIS_802_11_KEY
 
pPìrKey
;

1034 
UCHAR
 *
KEYDATA
, 
Key
[32];

1035 
USHORT
 
NSètus
;

1036 
UCHAR
 *
mpoﬁ
, *
DescKeyD©a
;

1038 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "Wpa2PairMsg3Action ----->\n");

1040 
mpoﬁ
 = 
	`kmÆloc
(1056, 
MEM_ALLOC_FLAG
);

1041 i‡(
mpoﬁ
 =
NULL
)

1045 
KEYDATA
 = (
UCHAR
 *Ë
	`ROUND_UP
(
mpoﬁ
, 4);

1047 
DescKeyD©a
 = (
UCHAR
 *Ë
	`ROUND_UP
(
KEYDATA
+512, 4);

1049 
pHódî
 = (
PHEADER_802_11
Ë
EÀm
->
Msg
;

1052 
pMsg3
 = (
PEAPOL_PACKET
Ë&
EÀm
->
Msg
[
LENGTH_802_11
 + 
LENGTH_802_1_H
];

1055 
	`NdisZîoMem‹y
(
DescKeyD©a
, 512);

1056 
	`NdisMoveMem‹y
–
DescKeyD©a
,

1057 &
EÀm
->
Msg
[
LENGTH_802_11
 + 
LENGTH_802_1_H
 + (
EAPOL_PACKET
Ë- 
MAX_LEN_OF_RSNIE
],

1058 
pMsg3
->
KeyDesc
.
KeyD©aLí
[1]);

1060 #ifde‡
BIG_ENDIAN


1063 
USHORT
 
tmpKeyöfo
;

1065 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
pMsg3
->
KeyDesc
.
KeyInfo
, (
USHORT
));

1066 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

1067 
	`NdisMoveMem‹y
(&
pMsg3
->
KeyDesc
.
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

1072 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
 && (
pMsg3
->
KeyDesc
.
KeyInfo
.
KeyDescVî
 != 2))

1074 
	`k‰ì
(
mpoﬁ
);

1077 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
 && (
pMsg3
->
KeyDesc
.
KeyInfo
.
KeyDescVî
 != 1))

1079 
	`k‰ì
(
mpoﬁ
);

1083 #ifde‡
BIG_ENDIAN


1086 
USHORT
 
tmpKeyöfo
;

1088 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
pMsg3
->
KeyDesc
.
KeyInfo
, (
USHORT
));

1089 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

1090 
	`NdisMoveMem‹y
(&
pMsg3
->
KeyDesc
.
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

1096 
	`NdisMoveMem‹y
(
OldMic
, 
pMsg3
->
KeyDesc
.
KeyMic
, 
LEN_KEY_DESC_MIC
);

1097 
	`NdisZîoMem‹y
(
pMsg3
->
KeyDesc
.
KeyMic
, 
LEN_KEY_DESC_MIC
);

1098 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

1101 
UCHAR
 
dige°
[80];

1103 
	`HMAC_SHA1
((
PUCHAR
Ë
pMsg3
,ÖMsg3->
Lí
[1] + 4, 
pAd
->
P‹tCfg
.
PTK
, 
LEN_EAP_MICK
, 
dige°
);

1104 
	`NdisMoveMem‹y
(
Mic
, 
dige°
, 
LEN_KEY_DESC_MIC
);

1108 
	`hmac_md5
(
pAd
->
P‹tCfg
.
PTK
, 
LEN_EAP_MICK
, (
PUCHAR
Ë
pMsg3
,ÖMsg3->
Lí
[1] + 4, 
Mic
);

1111 i‡(!
	`NdisEquÆMem‹y
(
OldMic
, 
Mic
, 
LEN_KEY_DESC_MIC
))

1113 
	`DBGPRINT
(
RT_DEBUG_ERROR
, " MIC Different in msg 3 of 4-way handshake!!!!!!!!!! \n");

1114 
	`k‰ì
(
mpoﬁ
);

1118 
	`DBGPRINT
(
RT_DEBUG_TRACE
, " MIC VALID in msg 3 of 4-way handshake!!!!!!!!!! \n");

1121 i‡(
	`RTMPCom∑ªMem‹y
(
pMsg3
->
KeyDesc
.
RïœyCou¡î
, 
pAd
->
P‹tCfg
.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
) != 1)

1123 
	`k‰ì
(
mpoﬁ
);

1128 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
RïœyCou¡î
, 
pMsg3
->
KeyDesc
.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
);

1131 i‡(!
	`NdisEquÆMem‹y
(
pAd
->
P‹tCfg
.
AN⁄˚
, 
pMsg3
->
KeyDesc
.
KeyN⁄˚
, 
LEN_KEY_DESC_NONCE
))

1133 
	`k‰ì
(
mpoﬁ
);

1139 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "EKD = %d\n", 
pMsg3
->
KeyDesc
.
KeyInfo
.
EKD_DL
);

1140 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

1144 
	`AES_GTK_KEY_UNWRAP
(&
pAd
->
P‹tCfg
.
PTK
[16], 
KEYDATA
, 
pMsg3
->
KeyDesc
.
KeyD©aLí
[1], 
DescKeyD©a
);

1146 
	`P¨£KeyD©a
(
pAd
, 
KEYDATA
, 
pMsg3
->
KeyDesc
.
KeyD©aLí
[1], 0, 
FALSE
);

1150 
INT
 
i
;

1153 
	`NdisMoveMem‹y
(
Key
, 
pMsg3
->
KeyDesc
.
KeyIv
, 16);

1154 
	`NdisMoveMem‹y
(&
Key
[16], &
pAd
->
P‹tCfg
.
PTK
[16], 16);

1155 
	`ARCFOUR_INIT
(&
pAd
->
Priv©eInfo
.
WEPCONTEXT
, 
Key
, 32);

1157 
i
 = 0; i < 256; i++)

1158 
	`ARCFOUR_BYTE
(&
pAd
->
Priv©eInfo
.
WEPCONTEXT
);

1160 
	`ARCFOUR_DECRYPT
(&
pAd
->
Priv©eInfo
.
WEPCONTEXT
, 
KEYDATA
, 
DescKeyD©a
, 
pMsg3
->
KeyDesc
.
KeyD©aLí
[1]);

1162 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "KEYDATA = \n");

1163 
i
 = 0; i < 100; i++)

1165 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "%2x ", 
KEYDATA
[
i
]);

1166 i‡(
i
%16 == 15)

1167 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "\n ");

1169 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "\n \n");

1171 
	`P¨£KeyD©a
(
pAd
, 
KEYDATA
, 
pMsg3
->
KeyDesc
.
KeyD©aLí
[1], 0, 
FALSE
);

1180 
pAd
->
Sequí˚
 = (’Ad->Sequí˚Ë+ 1Ë& (
MAX_SEQ_NUMBER
);

1181 
	`W∑MacHódîInô
(
pAd
, &
Hódî_802_11
, 0,ÖAd->
P‹tCfg
.
Bssid
);

1184 
AckR©e
 = 
pAd
->
P‹tCfg
.
Ex≥˘edACKR©e
[pAd->P‹tCfg.
TxR©e
];

1185 
AckDuøti⁄
 = 
	`RTMPCÆcDuøti⁄
(
pAd
, 
AckR©e
, 14);

1186 
Hódî_802_11
.
Duøti⁄
 = 
pAd
->
P‹tCfg
.
Dsifs
 + 
AckDuøti⁄
;

1189 
	`NdisZîoMem‹y
(&
Packë
, (Packet));

1190 
Packë
.
Vîsi⁄
 = 
EAPOL_VER
;

1191 
Packë
.
Ty≥
 = 
EAPOLKey
;

1192 
Packë
.
Lí
[1] = (
KEY_DESCRIPTER
Ë- 
MAX_LEN_OF_RSNIE
;

1197 
Packë
.
KeyDesc
.
Ty≥
 = 
RSN_KEY_DESC
;

1199 #ifde‡
BIG_ENDIAN


1202 
USHORT
 
tmpKeyöfo
;

1204 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
pMsg3
->
KeyDesc
.
KeyInfo
, (
USHORT
));

1205 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

1206 
	`NdisMoveMem‹y
(&
pMsg3
->
KeyDesc
.
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

1211 
Packë
.
KeyDesc
.
KeyInfo
.
KeyDescVî
 = 
pMsg3
->KeyDesc.KeyInfo.KeyDescVer;

1214 
Packë
.
KeyDesc
.
KeyLígth
[0] = 
pMsg3
->KeyDesc.KeyLength[0];

1215 
Packë
.
KeyDesc
.
KeyLígth
[1] = 
pMsg3
->KeyDesc.KeyLength[1];

1218 
Packë
.
KeyDesc
.
KeyInfo
.
KeyTy≥
 = 1;

1221 
Packë
.
KeyDesc
.
KeyInfo
.
KeyMic
 = 1;

1222 
Packë
.
KeyDesc
.
KeyInfo
.
Secuª
 = 1;

1225 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
RïœyCou¡î
, 
pMsg3
->KeyDesc.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
);

1227 #ifde‡
BIG_ENDIAN


1230 
USHORT
 
tmpKeyöfo
;

1232 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
Packë
.
KeyDesc
.
KeyInfo
, (
USHORT
));

1233 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

1234 
	`NdisMoveMem‹y
(&
Packë
.
KeyDesc
.
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

1239 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

1240 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

1242 
	`k‰ì
(
mpoﬁ
);

1248 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

1249 
Packë
.
Lí
[1] + 4, &Packet,

1250 
END_OF_ARGS
);

1253 
	`NdisZîoMem‹y
(
Mic
, (Mic));

1254 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

1257 
UCHAR
 
dige°
[80];

1259 
	`HMAC_SHA1
(
pOutBuf„r
, 
FømeLí
, 
pAd
->
P‹tCfg
.
PTK
, 
LEN_EAP_MICK
, 
dige°
);

1260 
	`NdisMoveMem‹y
(
Mic
, 
dige°
, 
LEN_KEY_DESC_MIC
);

1264 
	`hmac_md5
(
pAd
->
P‹tCfg
.
PTK
, 
LEN_EAP_MICK
, 
pOutBuf„r
, 
FømeLí
, 
Mic
);

1266 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
KeyMic
, 
Mic
, 
LEN_KEY_DESC_MIC
);

1268 
FømeLí
 = 0;

1271 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

1272 (
HEADER_802_11
), &
Hódî_802_11
,

1273 (
EAPHEAD
), EAPHEAD,

1274 
Packë
.
Lí
[1] + 4, &Packet,

1275 
END_OF_ARGS
);

1279 
pPìrKey
 = 
	`kmÆloc
(
MAX_LEN_OF_MLME_BUFFER
, 
MEM_ALLOC_FLAG
);

1280 i‡(
pPìrKey
 =
NULL
)

1282 
	`k‰ì
(
mpoﬁ
);

1286 
	`NdisZîoMem‹y
(
pPìrKey
, (
NDIS_802_11_KEY
Ë+ 
LEN_EAP_KEY
);

1287 
pPìrKey
->
Lígth
 = (
NDIS_802_11_KEY
Ë+ 
LEN_EAP_KEY
;

1288 
pPìrKey
->
KeyIndex
 = 0xe0000000;

1289 
pPìrKey
->
KeyLígth
 = 
pMsg3
->
KeyDesc
.KeyLength[0] * 256 +ÖMsg3->KeyDesc.KeyLength[1];

1291 
	`COPY_MAC_ADDR
(
pPìrKey
->
BSSID
, 
pAd
->
P‹tCfg
.
Bssid
);

1292 
	`NdisMoveMem‹y
(&
pPìrKey
->
KeyRSC
, 
pMsg3
->
KeyDesc
.
KeyRsc
, 
LEN_KEY_DESC_RSC
);

1293 
	`NdisMoveMem‹y
(
pPìrKey
->
KeyM©îül
, &
pAd
->
P‹tCfg
.
PTK
[32], 32);

1295 
	`RTMPWPAAddKeyProc
(
pAd
, 
pPìrKey
);

1296 
	`k‰ì
(
pPìrKey
);

1300 
	`Möù‹tMMReque°
(
pAd
, 
QID_AC_BE
, 
pOutBuf„r
, 
FømeLí
);

1302 
	`k‰ì
(
mpoﬁ
);

1304 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "Wpa2PairMsg3Action <-----\n");

1306 
	}
}

1325 
VOID
 
	$W∑GroupMsg1A˘i⁄
(

1326 
IN
 
PRTMP_ADAPTER
 
pAd
,

1327 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

1329 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

1330 
ULONG
 
FømeLí
 = 0;

1331 
UCHAR
 
EAPHEAD
[8] = {0xaa, 0xaa, 0x03, 0x00, 0x00, 0x00,0x88,0x8e};

1332 
EAPOL_PACKET
 
Packë
;

1333 
PEAPOL_PACKET
 
pGroup
;

1334 
UCHAR
 
Mic
[16], 
OldMic
[16];

1335 
UCHAR
 
Key
[32];

1336 
PNDIS_802_11_KEY
 
pGroupKey
 = 
NULL
;

1337 
UCHAR
 *
mpoﬁ
, *
MSG
, *
KEYDATA
;

1338 
UCHAR
 
Hódî802_3
[14];

1339 
USHORT
 
NSètus
;

1340 
UCHAR
 *
DescKeyD©a
;

1342 
mpoﬁ
 = 
	`kmÆloc
(3104, 
MEM_ALLOC_FLAG
);

1343 i‡(
mpoﬁ
 =
NULL
)

1347 
MSG
 = (
UCHAR
 *Ë
	`ROUND_UP
(
mpoﬁ
, 4);

1349 
KEYDATA
 = (
UCHAR
 *Ë
	`ROUND_UP
(
MSG
+2048, 4);

1351 
DescKeyD©a
 = (
UCHAR
 *Ë
	`ROUND_UP
(
KEYDATA
+512, 4);

1353 if(
	`NdisEquÆMem‹y
(&
EÀm
->
Msg
[
LENGTH_802_11
 + 8], 
EAPHEAD
, 
LENGTH_802_1_H
))

1355 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "W∑GroupMsg1A˘i⁄ ----->MsgLí=%d\n",
EÀm
->
MsgLí
);

1356 
	`NdisMoveMem‹y
(
MSG
, 
EÀm
->
Msg
, 
LENGTH_802_11
);

1357 
	`NdisMoveMem‹y
(&
MSG
[
LENGTH_802_11
], &
EÀm
->
Msg
[LENGTH_802_11+8], (EÀm->
MsgLí
 ));

1361 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "WpaGroupMsg1Action ----->\n");

1362 
	`NdisMoveMem‹y
(
MSG
, 
EÀm
->
Msg
, EÀm->
MsgLí
);

1366 
pGroup
 = (
PEAPOL_PACKET
Ë&
MSG
[
LENGTH_802_11
 + 
LENGTH_802_1_H
];

1369 
	`NdisZîoMem‹y
(
DescKeyD©a
, 512);

1370 
	`NdisMoveMem‹y
–
DescKeyD©a
,

1371 &
MSG
[
LENGTH_802_11
 + 
LENGTH_802_1_H
 + (
EAPOL_PACKET
Ë- 
MAX_LEN_OF_RSNIE
],

1372 
pGroup
->
KeyDesc
.
KeyD©aLí
[1]);

1374 #ifde‡
BIG_ENDIAN


1377 
USHORT
 
tmpKeyöfo
;

1379 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
pGroup
->
KeyDesc
.
KeyInfo
, (
USHORT
));

1380 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

1381 
	`NdisMoveMem‹y
(&
pGroup
->
KeyDesc
.
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

1386 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
 && (
pGroup
->
KeyDesc
.
KeyInfo
.
KeyDescVî
 != 2))

1388 
	`k‰ì
(
mpoﬁ
);

1391 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄2E«bÀd
 && (
pGroup
->
KeyDesc
.
KeyInfo
.
KeyDescVî
 != 1))

1393 
	`k‰ì
(
mpoﬁ
);

1399 i‡(
	`RTMPCom∑ªMem‹y
(
pGroup
->
KeyDesc
.
RïœyCou¡î
, 
pAd
->
P‹tCfg
.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
) != 1)

1401 
	`k‰ì
(
mpoﬁ
);

1405 #ifde‡
BIG_ENDIAN


1408 
USHORT
 
tmpKeyöfo
;

1410 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
pGroup
->
KeyDesc
.
KeyInfo
, (
USHORT
));

1411 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

1412 
	`NdisMoveMem‹y
(&
pGroup
->
KeyDesc
.
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

1417 
	`NdisMoveMem‹y
(
pAd
->
P‹tCfg
.
RïœyCou¡î
, 
pGroup
->
KeyDesc
.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
);

1421 
	`NdisMoveMem‹y
(
OldMic
, 
pGroup
->
KeyDesc
.
KeyMic
, 
LEN_KEY_DESC_MIC
);

1422 
	`NdisZîoMem‹y
(
pGroup
->
KeyDesc
.
KeyMic
, 
LEN_KEY_DESC_MIC
);

1424 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

1427 
UCHAR
 
dige°
[80];

1429 
	`HMAC_SHA1
((
PUCHAR
Ë
pGroup
,ÖGroup->
Lí
[1] + 4, 
pAd
->
P‹tCfg
.
PTK
, 
LEN_EAP_MICK
, 
dige°
);

1430 
	`NdisMoveMem‹y
(
Mic
, 
dige°
, 
LEN_KEY_DESC_MIC
);

1434 
	`hmac_md5
(
pAd
->
P‹tCfg
.
PTK
, 
LEN_EAP_MICK
, (
PUCHAR
Ë
pGroup
,ÖGroup->
Lí
[1] + 4, 
Mic
);

1437 i‡(!
	`NdisEquÆMem‹y
(
OldMic
, 
Mic
, 
LEN_KEY_DESC_MIC
))

1439 
	`DBGPRINT
(
RT_DEBUG_ERROR
, " MIC Different in group msg 1 of 2-way handshake!!!!!!!!!! \n");

1440 
	`k‰ì
(
mpoﬁ
);

1444 
	`DBGPRINT
(
RT_DEBUG_TRACE
, " MIC VALID in group msg 1 of 2-way handshake!!!!!!!!!! \n");

1446 #ifde‡
BIG_ENDIAN


1449 
USHORT
 
tmpKeyöfo
;

1451 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
pGroup
->
KeyDesc
.
KeyInfo
, (
USHORT
));

1452 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

1453 
	`NdisMoveMem‹y
(&
pGroup
->
KeyDesc
.
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

1458 
	`DBGPRINT
(
RT_DEBUG_TRACE
, " In°Æ»%d!!!!EKD_DL = %d!!!!!KeyIndex = %d! \n", 
pGroup
->
KeyDesc
.
KeyInfo
.
In°Æl
,ÖGroup->KeyDesc.KeyInfo.
EKD_DL
,

1459 
pGroup
->
KeyDesc
.
KeyInfo
.
KeyIndex
);

1462 
pGroupKey
 = 
	`kmÆloc
(
MAX_LEN_OF_MLME_BUFFER
, 
MEM_ALLOC_FLAG
);

1463 i‡(
pGroupKey
 =
NULL
)

1465 
	`k‰ì
(
mpoﬁ
);

1469 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

1472 
	`NdisZîoMem‹y
(
KEYDATA
, 128);

1475 
	`AES_GTK_KEY_UNWRAP
(&
pAd
->
P‹tCfg
.
PTK
[16], 
KEYDATA
, 
pGroup
->
KeyDesc
.
KeyD©aLí
[1], 
DescKeyD©a
);

1478 
	`P¨£KeyD©a
(
pAd
, 
KEYDATA
, 
pGroup
->
KeyDesc
.
KeyD©aLí
[1],ÖGroup->KeyDesc.
KeyInfo
.
KeyIndex
, 
TRUE
);

1483 
INT
 
i
;

1487 
	`NdisMoveMem‹y
(
Key
, 
pGroup
->
KeyDesc
.
KeyIv
, 16);

1488 
	`NdisMoveMem‹y
(&
Key
[16], &
pAd
->
P‹tCfg
.
PTK
[16], 16);

1489 
	`ARCFOUR_INIT
(&
pAd
->
Priv©eInfo
.
WEPCONTEXT
, 
Key
, 32);

1491 
i
 = 0; i < 256; i++)

1492 
	`ARCFOUR_BYTE
(&
pAd
->
Priv©eInfo
.
WEPCONTEXT
);

1494 
	`ARCFOUR_DECRYPT
(&
pAd
->
Priv©eInfo
.
WEPCONTEXT
, 
KEYDATA
, 
DescKeyD©a
, 
pGroup
->
KeyDesc
.
KeyD©aLí
[1]);

1496 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "TKIP GTK = \n");

1497 
i
 = 0; i < 32; i++)

1499 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "%2x ", 
KEYDATA
[
i
]);

1500 i‡(
i
%16 == 15)

1501 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "\n ");

1503 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "\n \n");

1506 
	`P¨£KeyD©a
(
pAd
, 
KEYDATA
, 
pGroup
->
KeyDesc
.
KeyD©aLí
[1],ÖGroup->KeyDesc.
KeyInfo
.
KeyIndex
, 
TRUE
);

1510 
pAd
->
Sequí˚
 = (’Ad->Sequí˚Ë+ 1Ë& (
MAX_SEQ_NUMBER
);

1511 
	`WPAMake8023Hdr
(
pAd
,ÖAd->
P‹tCfg
.
Bssid
, 
Hódî802_3
);

1514 
	`NdisZîoMem‹y
(&
Packë
, (Packet));

1515 
Packë
.
Vîsi⁄
 = 
EAPOL_VER
;

1516 
Packë
.
Ty≥
 = 
EAPOLKey
;

1517 
Packë
.
Lí
[1] = (
KEY_DESCRIPTER
Ë- 
MAX_LEN_OF_RSNIE
;

1522 
Packë
.
KeyDesc
.
Ty≥
 = 
RSN_KEY_DESC
;

1525 
Packë
.
KeyDesc
.
KeyInfo
.
KeyDescVî
 = 
pGroup
->KeyDesc.KeyInfo.KeyDescVer;

1528 
Packë
.
KeyDesc
.
KeyInfo
.
KeyIndex
 = 
pGroup
->KeyDesc.KeyInfo.KeyIndex;

1529 
Packë
.
KeyDesc
.
KeyLígth
[0] = 
pGroup
->KeyDesc.KeyLength[0];

1530 
Packë
.
KeyDesc
.
KeyLígth
[1] = 
pGroup
->KeyDesc.KeyLength[1];

1533 
Packë
.
KeyDesc
.
KeyInfo
.
KeyTy≥
 = 0;

1536 
Packë
.
KeyDesc
.
KeyInfo
.
KeyMic
 = 1;

1539 i‡(
pAd
->
P‹tCfg
.
AuthMode
 =
Ndis802_11AuthModeWPAPSK
)

1540 
Packë
.
KeyDesc
.
KeyInfo
.
Secuª
 = 1;

1543 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
RïœyCou¡î
, 
pGroup
->KeyDesc.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
);

1545 #ifde‡
BIG_ENDIAN


1548 
USHORT
 
tmpKeyöfo
;

1550 
	`NdisMoveMem‹y
(&
tmpKeyöfo
, &
Packë
.
KeyDesc
.
KeyInfo
, (
USHORT
));

1551 
tmpKeyöfo
 = 
	`SWAP16
(tmpKeyinfo);

1552 
	`NdisMoveMem‹y
(&
Packë
.
KeyDesc
.
KeyInfo
, &
tmpKeyöfo
, (
USHORT
));

1557 
NSètus
 = 
	`MlmeAŒoˇãMem‹y
(
pAd
, (
PVOID
 *)&
pOutBuf„r
);

1558 i‡(
NSètus
 !
NDIS_STATUS_SUCCESS
)

1560 
	`k‰ì
(
pGroupKey
);

1561 
	`k‰ì
(
mpoﬁ
);

1567 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

1568 
Packë
.
Lí
[1] + 4, &Packet,

1569 
END_OF_ARGS
);

1572 
	`NdisZîoMem‹y
(
Mic
, (Mic));

1573 i‡(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

1576 
UCHAR
 
dige°
[80];

1578 
	`HMAC_SHA1
(
pOutBuf„r
, 
FømeLí
, 
pAd
->
P‹tCfg
.
PTK
, 
LEN_EAP_MICK
, 
dige°
);

1579 
	`NdisMoveMem‹y
(
Mic
, 
dige°
, 
LEN_KEY_DESC_MIC
);

1583 
INT
 
i
;

1585 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "PTK = ");

1586 
i
 = 0; i < 64; i++)

1587 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "%2x-", 
pAd
->
P‹tCfg
.
PTK
[
i
]);

1588 
	`DBGPRINT_RAW
(
RT_DEBUG_INFO
, "\¿FømeLí = %d\n", 
FømeLí
);

1590 
	`hmac_md5
(
pAd
->
P‹tCfg
.
PTK
, 
LEN_EAP_MICK
, 
pOutBuf„r
, 
FømeLí
, 
Mic
);

1592 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
KeyMic
, 
Mic
, 
LEN_KEY_DESC_MIC
);

1595 
FømeLí
 = 0;

1596 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

1597 
LENGTH_802_3
, &
Hódî802_3
,

1599 
Packë
.
Lí
[1] + 4, &Packet,

1600 
END_OF_ARGS
);

1603 
	`RTMPToWúñessSè
(
pAd
, 
pOutBuf„r
, 
FømeLí
);

1606 
	`MlmeFªeMem‹y
(
pAd
, 
pOutBuf„r
);

1608 
	`k‰ì
(
pGroupKey
);

1609 
	`k‰ì
(
mpoﬁ
);

1611 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "WpaGroupMsg1Action <-----\n");

1612 
	}
}

1629 
VOID
 
	$W∑MacHódîInô
(

1630 
IN
 
PRTMP_ADAPTER
 
pAd
,

1631 
IN
 
OUT
 
PHEADER_802_11
 
pHdr80211
,

1632 
IN
 
UCHAR
 
wï
,

1633 
IN
 
PUCHAR
 
pAddr1
)

1635 
	`NdisZîoMem‹y
(
pHdr80211
, (
HEADER_802_11
));

1636 
pHdr80211
->
FC
.
Ty≥
 = 
BTYPE_DATA
;

1637 
pHdr80211
->
FC
.
ToDs
 = 1;

1638 i‡(
wï
 == 1)

1639 
pHdr80211
->
FC
.
Wï
 = 1;

1642 
	`COPY_MAC_ADDR
(
pHdr80211
->
Addr1
, 
pAddr1
);

1643 
	`COPY_MAC_ADDR
(
pHdr80211
->
Addr2
, 
pAd
->
CuºítAddªss
);

1644 
	`COPY_MAC_ADDR
(
pHdr80211
->
Addr3
, 
pAd
->
P‹tCfg
.
Bssid
);

1645 
pHdr80211
->
Sequí˚
 = 
pAd
->Sequence;

1646 
	}
}

1662 
VOID
 
	$HMAC_SHA1
(

1663 
IN
 
UCHAR
 *
ãxt
,

1664 
IN
 
UINT
 
ãxt_Àn
,

1665 
IN
 
UCHAR
 *
key
,

1666 
IN
 
UINT
 
key_Àn
,

1667 
IN
 
UCHAR
 *
dige°
)

1669 
SHA_CTX
 
c⁄ãxt
;

1670 
UCHAR
 
k_ùad
[65];

1671 
UCHAR
 
k_›ad
[65];

1672 
INT
 
i
;

1675 i‡(
key_Àn
 > 64)

1677 
SHA_CTX
 
t˘x
;

1678 
	`SHAInô
(&
t˘x
);

1679 
	`SHAUpd©e
(&
t˘x
, 
key
, 
key_Àn
);

1680 
	`SHAFöÆ
(&
t˘x
, 
key
);

1681 
key_Àn
 = 20;

1683 
	`NdisZîoMem‹y
(
k_ùad
, (k_ipad));

1684 
	`NdisZîoMem‹y
(
k_›ad
, (k_opad));

1685 
	`NdisMoveMem‹y
(
k_ùad
, 
key
, 
key_Àn
);

1686 
	`NdisMoveMem‹y
(
k_›ad
, 
key
, 
key_Àn
);

1689 
i
 = 0; i < 64; i++)

1691 
k_ùad
[
i
] ^= 0x36;

1692 
k_›ad
[
i
] ^= 0x5c;

1696 
	`SHAInô
(&
c⁄ãxt
);

1697 
	`SHAUpd©e
(&
c⁄ãxt
, 
k_ùad
, 64);

1698 
	`SHAUpd©e
(&
c⁄ãxt
, 
ãxt
, 
ãxt_Àn
);

1699 
	`SHAFöÆ
(&
c⁄ãxt
, 
dige°
);

1702 
	`SHAInô
(&
c⁄ãxt
);

1703 
	`SHAUpd©e
(&
c⁄ãxt
, 
k_›ad
, 64);

1704 
	`SHAUpd©e
(&
c⁄ãxt
, 
dige°
, 20);

1705 
	`SHAFöÆ
(&
c⁄ãxt
, 
dige°
);

1706 
	}
}

1724 
VOID
 
	$P¨£KeyD©a
(

1725 
IN
 
PRTMP_ADAPTER
 
pAd
,

1726 
IN
 
PUCHAR
 
pKeyD©a
,

1727 
IN
 
UCHAR
 
KeyD©aLí
,

1728 
IN
 
UCHAR
 
KeyIdx
,

1729 
IN
 
BOOLEAN
 
IsGroupMsg
)

1731 
PKDE_ENCAP
 
pKDE
 = 
NULL
;

1732 
PNDIS_802_11_KEY
 
pGroupKey
 = 
NULL
;

1733 
PUCHAR
 
pMyKeyD©a
=
NULL
;

1734 
UCHAR
 *
KeyD©aBuf
, *
mpoﬁ
;

1735 
UCHAR
 
KeyD©aLígth
 = 
KeyD©aLí
;

1736 
UCHAR
 
GTKLEN
;

1737 
INT
 
i
;

1738 
ULONG
 
Idx
;

1739 
PUCHAR
 
pVIE
=
NULL
;

1740 
UCHAR
 
Lí
;

1741 
PEID_STRUCT
 
pEid
;

1742 
BOOLEAN
 
bKDE_Key
 = 
FALSE
;

1744 
mpoﬁ
 = 
	`kmÆloc
(256, 
MEM_ALLOC_FLAG
);

1745 i‡(
mpoﬁ
 =
NULL
)

1749 
KeyD©aBuf
 = (
UCHAR
 *Ë
	`ROUND_UP
(
mpoﬁ
, 4);

1751 
	`NdisZîoMem‹y
(
KeyD©aBuf
, 256);

1753 if((
Idx
 = 
	`BssTabÀSórch
(&
pAd
->
SˇnTab
,ÖAd->
P‹tCfg
.
Bssid
,ÖAd->P‹tCfg.
Ch™√l
)Ë=
BSS_NOT_FOUND
)

1755 
	`DBGPRINT
(
RT_DEBUG_ERROR
, "%s, C™'àföd BSS\n", 
__FUNCTION__
);

1759 
pVIE
 = 
pAd
->
SˇnTab
.
BssE¡ry
[
Idx
].
V¨IEs
;

1760 
Lí
 = (
UCHAR
)
pAd
->
SˇnTab
.
BssE¡ry
[
Idx
].
V¨IELí
;

1761 
Lí
 > 0)

1763 
pEid
 = (
PEID_STRUCT
Ë
pVIE
;

1764 i‡(
pEid
->
Eid
 !
IE_RSN
)

1766 
pVIE
 +(
pEid
->
Lí
 + 2);

1767 
Lí
 -(
pEid
->Len + 2);

1771 i‡(!
	`NdisEquÆMem‹y
(
pKeyD©a
, 
pEid
->
O˘ë
,ÖEid->
Lí
))

1780 
Lí
 -(
pEid
->Len + 2);

1789 
	`NdisMoveMem‹y
(
KeyD©aBuf
, 
pKeyD©a
, 
KeyD©aLí
);

1790 
pMyKeyD©a
 =(
PUCHAR
Ë
KeyD©aBuf
;

1791 i‡(!
IsGroupMsg
)

1794 i‡((*
pMyKeyD©a
 =
WPARSNIE
Ë&& (*’MyKeyD©a+1Ë!0Ë&& (
KeyD©aLígth
 >= (2 + *(pMyKeyData+1))))

1796 i‡((*(
pMyKeyD©a
+2) == 0x00) && (*(pMyKeyData+3) == 0x0f) && (*(pMyKeyData+4) == 0xac))

1799 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"WPA WPA_IEÜígth %d c⁄èöed i¿thi†mesßgê\n", (2 + *(
pMyKeyD©a
+1)));

1800 
KeyD©aLígth
 -(2 + *(
pMyKeyD©a
+1));

1801 
pMyKeyD©a
 += *(pMyKeyData+1) + 2;

1803 i‡((*
pMyKeyD©a
 =
WPA2RSNIE
Ë&& (*’MyKeyD©a+1Ë!0Ë&& (
KeyD©aLígth
 >= (2 + *(pMyKeyData+1))))

1805 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"WPA2 RSN_IEÜígth %d c⁄èöed i¿thi†mesßgê\n", (2 + *(
pMyKeyD©a
+1)));

1806 
KeyD©aLígth
 -(2 + *(
pMyKeyD©a
+1));

1807 
pMyKeyD©a
 += (*(pMyKeyData+1) + 2);

1810 } 
KeyD©aLígth
 > 0);

1812 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"KeyD©aLígth %d \n", 
KeyD©aLígth
);

1815 
pKDE
 = (
PKDE_ENCAP
Ë
pMyKeyD©a
;

1816 if((
KeyD©aLígth
 >8Ë&& (
pKDE
->
Ty≥
 =
WPARSNIE
Ë&& (pKDE->
OUI
[0] =0x00Ë&& (pKDE->OUI[1]=0x0fË&& (pKDE->OUI[2]=0x0acË&& (pKDE->
D©aTy≥
== 0x01))

1818 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"pKDE = \n");

1819 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"pKDE->Ty≥ %x:", 
pKDE
->
Ty≥
);

1820 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"pKDE->Lí 0x%x:", 
pKDE
->
Lí
);

1821 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"pKDE->OUI %x %x %x :", 
pKDE
->
OUI
[0],pKDE->OUI[1],pKDE->OUI[2] );

1822 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"\n");

1824 
bKDE_Key
 = 
TRUE
;

1827 i‡((
bKDE_Key
 =
TRUE
Ë&& (
pKDE
->
GTKEnˇp
.
Kid
 == 0))

1829 
	`DBGPRINT_RAW
(
RT_DEBUG_ERROR
,"GTK Key index zero ,Érror\n");

1835 
pGroupKey
 = 
	`kmÆloc
(
MAX_LEN_OF_MLME_BUFFER
, 
MEM_ALLOC_FLAG
);

1836 i‡(
pGroupKey
 =
NULL
)

1839 
	`NdisZîoMem‹y
(
pGroupKey
, (
NDIS_802_11_KEY
Ë+ 
LEN_EAP_KEY
);

1840 
pGroupKey
->
Lígth
 = (
NDIS_802_11_KEY
Ë+ 
LEN_EAP_KEY
;

1841 
	`COPY_MAC_ADDR
(
pGroupKey
->
BSSID
, 
pAd
->
P‹tCfg
.
Bssid
);

1843 i‡(
bKDE_Key
)

1845 
GTKLEN
 = 
pKDE
->
Lí
 -6;

1847 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"GTK Key[%d]Üí=%d ", 
pKDE
->
GTKEnˇp
.
Kid
, 
GTKLEN
);

1848 
i
 = 0; i < 
GTKLEN
; i++)

1850 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"%02x:", 
pKDE
->
GTKEnˇp
.
GTK
[
i
]);

1852 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
,"\n");

1854 
pGroupKey
->
KeyIndex
 = 0x20000000 | 
pKDE
->
GTKEnˇp
.
Kid
;

1855 
pGroupKey
->
KeyLígth
 = 
GTKLEN
;

1857 
	`NdisMoveMem‹y
(
pGroupKey
->
KeyM©îül
, 
pKDE
->
GTKEnˇp
.
GTK
, 32);

1860 
	`RTMPWPAAddKeyProc
(
pAd
, 
pGroupKey
);

1862 i‡(
KeyIdx
 != 0)

1864 
pGroupKey
->
KeyIndex
 = 0x20000000 | 
KeyIdx
;

1865 
pGroupKey
->
KeyLígth
 = 32;

1867 
	`NdisMoveMem‹y
(
pGroupKey
->
KeyM©îül
, 
pMyKeyD©a
, 
LEN_EAP_KEY
);

1870 
	`RTMPWPAAddKeyProc
(
pAd
, 
pGroupKey
);

1873 
	`k‰ì
(
pGroupKey
);

1874 
	`k‰ì
(
mpoﬁ
);

1876 
	}
}

1878 
VOID
 
	$WPAMake8023Hdr
(

1879 
IN
 
PRTMP_ADAPTER
 
pAd
,

1880 
IN
 
PCHAR
 
pDAddr
,

1881 
IN
 
OUT
 
PCHAR
 
pHdr
)

1884 
	`NdisMoveMem‹y
(
pHdr
, 
pDAddr
, 
MAC_ADDR_LEN
);

1885 
	`NdisMoveMem‹y
(&
pHdr
[
MAC_ADDR_LEN
], 
pAd
->
CuºítAddªss
, MAC_ADDR_LEN);

1886 
pHdr
[2*
MAC_ADDR_LEN
] = 0x88;

1887 
pHdr
[2*
MAC_ADDR_LEN
+1] = 0x8e;

1889 
	}
}

1906 
VOID
 
	$PRF
(

1907 
IN
 
UCHAR
 *
key
,

1908 
IN
 
INT
 
key_Àn
,

1909 
IN
 
UCHAR
 *
¥efix
,

1910 
IN
 
INT
 
¥efix_Àn
,

1911 
IN
 
UCHAR
 *
d©a
,

1912 
IN
 
INT
 
d©a_Àn
,

1913 
OUT
 
UCHAR
 *
ouçut
,

1914 
IN
 
INT
 
Àn
)

1916 
INT
 
i
;

1917 
UCHAR
 *
öput
;

1918 
INT
 
cuºítödex
 = 0;

1919 
INT
 
tŸÆ_Àn
;

1920 
BOOLEAN
 
b‰ì
 = 
TRUE
;

1922 
öput
 = 
	`kmÆloc
(1024, 
MEM_ALLOC_FLAG
);

1923 i‡(
öput
 =
NULL
)

1925 
öput
 = 
¥f_öput
;

1926 
b‰ì
 = 
FALSE
;

1929 
	`NdisMoveMem‹y
(
öput
, 
¥efix
, 
¥efix_Àn
);

1930 
öput
[
¥efix_Àn
] = 0;

1931 
	`NdisMoveMem‹y
(&
öput
[
¥efix_Àn
 + 1], 
d©a
, 
d©a_Àn
);

1932 
tŸÆ_Àn
 = 
¥efix_Àn
 + 1 + 
d©a_Àn
;

1933 
öput
[
tŸÆ_Àn
] = 0;

1934 
tŸÆ_Àn
++;

1935 
i
 = 0; i < (
Àn
 + 19) / 20; i++)

1937 
	`HMAC_SHA1
(
öput
, 
tŸÆ_Àn
, 
key
, 
key_Àn
, &
ouçut
[
cuºítödex
]);

1938 
cuºítödex
 += 20;

1939 
öput
[
tŸÆ_Àn
 - 1]++;

1942 i‡(
b‰ì
==
TRUE
)

1943 
	`k‰ì
(
öput
);

1944 
	}
}

1961 
VOID
 
	$W∑Cou¡PTK
(

1962 
IN
 
UCHAR
 *
PMK
,

1963 
IN
 
UCHAR
 *
AN⁄˚
,

1964 
IN
 
UCHAR
 *
AA
,

1965 
IN
 
UCHAR
 *
SN⁄˚
,

1966 
IN
 
UCHAR
 *
SA
,

1967 
OUT
 
UCHAR
 *
ouçut
,

1968 
IN
 
UINT
 
Àn
)

1970 
UCHAR
 
c⁄ˇã«ti⁄
[76];

1971 
UINT
 
CuºPos
 = 0;

1972 
UCHAR
 
ãmp
[32];

1973 
UCHAR
 
Pªfix
[] = {'P', 'a', 'i', 'r', 'w', 'i', 's', 'e', ' ', 'k', 'e', 'y', ' ',

1976 
	`NdisZîoMem‹y
(
ãmp
, (temp));

1979 i‡(
	`RTMPCom∑ªMem‹y
(
SA
, 
AA
, 6) == 1)

1980 
	`NdisMoveMem‹y
(
c⁄ˇã«ti⁄
, 
AA
, 6);

1982 
	`NdisMoveMem‹y
(
c⁄ˇã«ti⁄
, 
SA
, 6);

1983 
CuºPos
 += 6;

1986 i‡(
	`RTMPCom∑ªMem‹y
(
SA
, 
AA
, 6) == 1)

1987 
	`NdisMoveMem‹y
(&
c⁄ˇã«ti⁄
[
CuºPos
], 
SA
, 6);

1989 
	`NdisMoveMem‹y
(&
c⁄ˇã«ti⁄
[
CuºPos
], 
AA
, 6);

1990 
CuºPos
 += 6;

1993 i‡(
	`RTMPCom∑ªMem‹y
(
AN⁄˚
, 
SN⁄˚
, 32) == 1)

1994 
	`NdisMoveMem‹y
(&
c⁄ˇã«ti⁄
[
CuºPos
], 
SN⁄˚
, 32);

1996 
	`NdisMoveMem‹y
(&
c⁄ˇã«ti⁄
[
CuºPos
], 
AN⁄˚
, 32);

1997 
CuºPos
 += 32;

2000 i‡(
	`RTMPCom∑ªMem‹y
(
AN⁄˚
, 
SN⁄˚
, 32) == 1)

2001 
	`NdisMoveMem‹y
(&
c⁄ˇã«ti⁄
[
CuºPos
], 
AN⁄˚
, 32);

2003 
	`NdisMoveMem‹y
(&
c⁄ˇã«ti⁄
[
CuºPos
], 
SN⁄˚
, 32);

2004 
CuºPos
 += 32;

2006 
	`PRF
(
PMK
, 
LEN_MASTER_KEY
, 
Pªfix
, 22, 
c⁄ˇã«ti⁄
, 76, 
ouçut
, 
Àn
);

2008 
	}
}

2025 
VOID
 
	$GíR™dom
(

2026 
IN
 
PRTMP_ADAPTER
 
pAd
,

2027 
OUT
 
UCHAR
 *
øndom
)

2029 
INT
 
i
, 
cuº
;

2030 
UCHAR
 *
loˇl
, *
KeyCou¡î
;

2031 
UCHAR
 *
ªsu…
;

2032 
CuºítTime
;

2033 
UCHAR
 
¥efix
[] = {'I', 'n', 'i', 't', ' ', 'C', 'o', 'u', 'n', 't', 'e', 'r'};

2034 
UCHAR
 *
mpoﬁ
;

2036 
mpoﬁ
 = 
	`kmÆloc
(256, 
MEM_ALLOC_FLAG
);

2037 i‡(
mpoﬁ
 =
NULL
)

2041 
loˇl
 = (
UCHAR
 *Ë
	`ROUND_UP
(
mpoﬁ
, 4);

2043 
KeyCou¡î
 = (
UCHAR
 *Ë
	`ROUND_UP
(
loˇl
 + 80, 4);

2045 
ªsu…
 = (
UCHAR
 *Ë
	`ROUND_UP
(
KeyCou¡î
 + 32, 4);

2047 
	`NdisZîoMem‹y
(
ªsu…
, 80);

2048 
	`NdisZîoMem‹y
(
loˇl
, 80);

2049 
	`NdisZîoMem‹y
(
KeyCou¡î
, 32);

2050 
	`COPY_MAC_ADDR
(
loˇl
, 
pAd
->
CuºítAddªss
);

2052 
i
 = 0; i < 32; i++)

2054 
cuº
 = 
MAC_ADDR_LEN
;

2055 
CuºítTime
 = 
jiffõs
;

2056 
	`COPY_MAC_ADDR
(
loˇl
, 
pAd
->
CuºítAddªss
);

2057 
cuº
 +
MAC_ADDR_LEN
;

2058 
	`NdisMoveMem‹y
(&
loˇl
[
cuº
], &
CuºítTime
, (CurrentTime));

2059 
cuº
 +(
CuºítTime
);

2060 
	`NdisMoveMem‹y
(&
loˇl
[
cuº
], 
ªsu…
, 32);

2061 
cuº
 += 32;

2062 
	`NdisMoveMem‹y
(&
loˇl
[
cuº
], &
i
, 2);

2063 
cuº
 += 2;

2064 
	`PRF
(
KeyCou¡î
, 32, 
¥efix
,12, 
loˇl
, 
cuº
, 
ªsu…
, 32);

2066 
	`NdisMoveMem‹y
(
øndom
, 
ªsu…
, 32);

2067 
	`k‰ì
(
mpoﬁ
);

2068 
	}
}

2084 
VOID
 
	$AES_GTK_KEY_UNWRAP
(

2085 
IN
 
UCHAR
 *
key
,

2086 
OUT
 
UCHAR
 *
∂aöãxt
,

2087 
IN
 
UCHAR
 
c_Àn
,

2088 
IN
 
UCHAR
 *
cùhîãxt
)

2090 
UCHAR
 *
A
, *
BIN
, *
BOUT
;

2091 
UCHAR
 
x‹
;

2092 
INT
 
i
, 
j
;

2093 
´s_c⁄ãxt
 
´s˘x
;

2094 
UCHAR
 *
R
;

2095 
INT
 
num_blocks
 = 
c_Àn
/8;

2096 
UCHAR
 *
mpoﬁ
;

2098 
mpoﬁ
 = 
	`kmÆloc
(1024, 
MEM_ALLOC_FLAG
);

2099 i‡(
mpoﬁ
 =
NULL
)

2103 
A
 = (
UCHAR
 *Ë
	`ROUND_UP
(
mpoﬁ
, 4);

2105 
BIN
 = (
UCHAR
 *Ë
	`ROUND_UP
(
A
 + 8, 4);

2107 
BOUT
 = (
UCHAR
 *Ë
	`ROUND_UP
(
BIN
 + 16, 4);

2109 
R
 = (
UCHAR
 *Ë
	`ROUND_UP
(
BOUT
 + 16, 4);

2112 
	`NdisMoveMem‹y
(
A
, 
cùhîãxt
, 8);

2114 
i
 = 0; i < (
c_Àn
-8); i++)

2116 
R
[ 
i
] = 
cùhîãxt
[i + 8];

2119 
	`´s_£t_key
(&
´s˘x
, 
key
, 128);

2121 
j
 = 5; j >= 0; j--)

2123 
i
 = (
num_blocks
-1); i > 0; i--)

2125 
x‹
 = (
num_blocks
 -1 )* 
j
 + 
i
;

2126 
	`NdisMoveMem‹y
(
BIN
, 
A
, 8);

2127 
BIN
[7] = 
A
[7] ^ 
x‹
;

2128 
	`NdisMoveMem‹y
(&
BIN
[8], &
R
[(
i
-1)*8], 8);

2129 
	`´s_de¸y±
(&
´s˘x
, 
BIN
, 
BOUT
);

2130 
	`NdisMoveMem‹y
(
A
, &
BOUT
[0], 8);

2131 
	`NdisMoveMem‹y
(&
R
[(
i
-1)*8], &
BOUT
[8], 8);

2136 
i
 = 0; i < 
c_Àn
; i++)

2138 
∂aöãxt
[
i
] = 
R
[i];

2141 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "plaintext = \n");

2142 
i
 = 0; i < (
num_blocks
 *8); i++)

2144 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "%2x ", 
∂aöãxt
[
i
]);

2145 i‡(
i
%16 == 15)

2146 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "\n ");

2148 
	`DBGPRINT_RAW
(
RT_DEBUG_TRACE
, "\n \n");

2150 
	`k‰ì
(
mpoﬁ
);

2151 
	}
}

2166 
VOID
 
	$RTMPToWúñessSè
(

2167 
IN
 
PRTMP_ADAPTER
 
pAd
,

2168 
IN
 
PUCHAR
 
pFøme
,

2169 
IN
 
UINT
 
FømeLí
)

2171 
sk_buff
 *
skb
;

2172 
NDIS_STATUS
 
Sètus
;

2177 #ifde‡
RTMP_EMBEDDED


2178 i‡((
skb
 = 
	`__dev_Æloc_skb
(
FømeLí
 + 2, 
GFP_DMA
|
GFP_ATOMIC
)Ë!
NULL
)

2180 i‡((
skb
 = 
	`dev_Æloc_skb
(
FømeLí
 + 2)Ë!
NULL
)

2183 
skb
->
Àn
 = 
FømeLí
;

2184 
skb
->
d©a_Àn
 = 
FømeLí
;

2185 
	`mem˝y
((
skb
->
d©a
), 
pFøme
, 
FømeLí
);

2194 
Sètus
 = 
	`RTMPSídPackë
(
pAd
, 
skb
);

2195 i‡(
Sètus
 =
NDIS_STATUS_SUCCESS
)

2202 i‡((!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_BSS_SCAN_IN_PROGRESS
)) &&

2203 (!
	`RTMP_TEST_FLAG
(
pAd
, 
fRTMP_ADAPTER_RESET_IN_PROGRESS
)))

2205 
	`RTMPDeQueuePackë
(
pAd
, 
QID_AC_BE
);

2210 
	`RTUSBFªeSkbBuf„r
(
skb
);

2213 
	`RTUSBKickBulkOut
(
pAd
);

2215 } 
FALSE
);

2217 
	}
}

2222 
INT
 
	$RTMPCheckWPA‰ameF‹E≠Code
(

2223 
IN
 
PRTMP_ADAPTER
 
pAd
,

2224 
IN
 
PUCHAR
 
pFøme
,

2225 
IN
 
ULONG
 
FømeLí
,

2226 
IN
 
ULONG
 
OffSë
)

2229 
PUCHAR
 
pD©a
;

2230 
INT
 
ªsu…
 = 0;

2232 if–
FømeLí
 < 
OffSë
 + 
LENGTH_EAPOL_H
 + 
LENGTH_EAP_H
 )

2233  
ªsu…
;

2235 
pD©a
 = 
pFøme
 + 
OffSë
;

2237 if(*(
pD©a
+1Ë=
EAPPackë
)

2239 
ªsu…
 = *(
pD©a
+4);

2242  
ªsu…
;

2243 
	}
}

2248 
	$öc_byã_¨øy
(
UCHAR
 *
cou¡î
, 
Àn
)

2250 
pos
 = 
Àn
 - 1;

2251 
pos
 >= 0) {

2252 
cou¡î
[
pos
]++;

2253 i‡(
cou¡î
[
pos
] != 0)

2255 
pos
--;

2257 
	}
}

2259 
VOID
 
	$W∑MicFaûuªRï‹tFøme
(

2260 
IN
 
PRTMP_ADAPTER
 
pAd
,

2261 
IN
 
MLME_QUEUE_ELEM
 *
EÀm
)

2263 
PUCHAR
 
pOutBuf„r
 = 
NULL
;

2264 
UCHAR
 
Hódî802_3
[14];

2265 
ULONG
 
FømeLí
 = 0;

2266 
EAPOL_PACKET
 
Packë
;

2267 
UCHAR
 
Mic
[16];

2268 
BOOLEAN
 
bUniˇ°
;

2270 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "WpaMicFailureReportFrame ----->\n");

2272 
bUniˇ°
 = (
EÀm
->
Msg
[0] =1 ? 
TRUE
:
FALSE
);

2273 
pAd
->
Sequí˚
 = (’Ad->Sequí˚Ë+ 1Ë& (
MAX_SEQ_NUMBER
);

2276 
	`MAKE_802_3_HEADER
(
Hódî802_3
, 
pAd
->
MlmeAux
.
Bssid
,ÖAd->
CuºítAddªss
, 
EAPOL
);

2278 
	`NdisZîoMem‹y
(&
Packë
, (Packet));

2279 
Packë
.
Vîsi⁄
 = 
EAPOL_VER
;

2280 
Packë
.
Ty≥
 = 
EAPOLKey
;

2282 
Packë
.
KeyDesc
.
Ty≥
 = 
WPA1_KEY_DESC
;

2285 
Packë
.
KeyDesc
.
KeyInfo
.
Reque°
 = 1;

2287 if(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

2289 
Packë
.
KeyDesc
.
KeyInfo
.
KeyDescVî
 = 2;

2293 
Packë
.
KeyDesc
.
KeyInfo
.
KeyDescVî
 = 1;

2296 
Packë
.
KeyDesc
.
KeyInfo
.
KeyTy≥
 = (
bUniˇ°
 ? 1 : 0);

2299 
Packë
.
KeyDesc
.
KeyInfo
.
KeyMic
 = 1;

2302 
Packë
.
KeyDesc
.
KeyInfo
.
Eº‹
 = 1;

2305 
Packë
.
Lí
[1] = (
KEY_DESCRIPTER
Ë- 
MAX_LEN_OF_RSNIE
;

2308 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
RïœyCou¡î
, 
pAd
->
P‹tCfg
.RïœyCou¡î, 
LEN_KEY_DESC_REPLAY
);

2309 
	`öc_byã_¨øy
(
pAd
->
P‹tCfg
.
RïœyCou¡î
, 8);

2311 #ifde‡
BIG_ENDIAN


2313 *((
USHORT
 *)&
Packë
.
KeyDesc
.
KeyInfo
Ë
	`SWAP16
(*((USHORT *)&Packet.KeyDesc.KeyInfo));

2318 
pOutBuf„r
 = 
	`kmÆloc
(
MAX_LEN_OF_MLME_BUFFER
, 
MEM_ALLOC_FLAG
);

2320 if(
pOutBuf„r
 =
NULL
)

2327 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

2328 
Packë
.
Lí
[1] + 4, &Packet,

2329 
END_OF_ARGS
);

2332 
	`NdisZîoMem‹y
(
Mic
, (Mic));

2333 if(
pAd
->
P‹tCfg
.
WïSètus
 =
Ndis802_11En¸y±i⁄3E«bÀd
)

2335 
UCHAR
 
dige°
[20] = {0};

2336 
	`HMAC_SHA1
(
pOutBuf„r
, 
FømeLí
, 
pAd
->
P‹tCfg
.
PTK
, 
LEN_EAP_MICK
, 
dige°
);

2337 
	`NdisMoveMem‹y
(
Mic
, 
dige°
, 
LEN_KEY_DESC_MIC
);

2341 
	`hmac_md5
(
pAd
->
P‹tCfg
.
PTK
, 
LEN_EAP_MICK
, 
pOutBuf„r
, 
FømeLí
, 
Mic
);

2343 
	`NdisMoveMem‹y
(
Packë
.
KeyDesc
.
KeyMic
, 
Mic
, 
LEN_KEY_DESC_MIC
);

2345 
	`MakeOutgoögFøme
(
pOutBuf„r
, &
FømeLí
,

2346 
LENGTH_802_3
, &
Hódî802_3
,

2347 
Packë
.
Lí
[1] + 4, &Packet,

2348 
END_OF_ARGS
);

2352 
	`RTMPToWúñessSè
(
pAd
, 
pOutBuf„r
, 
FømeLí
);

2355 
	`k‰ì
(
pOutBuf„r
);

2357 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "WpaMicFailureReportFrame <-----\n");

2358 
	}
}

2360 
VOID
 
	$W∑DißssocApAndBlockAssoc
(

2361 
IN
 
PVOID
 
Sy°emS≥cific1
,

2362 
IN
 
PVOID
 
Fun˘i⁄C⁄ãxt
,

2363 
IN
 
PVOID
 
Sy°emS≥cific2
,

2364 
IN
 
PVOID
 
Sy°emS≥cific3
)

2366 
RTMP_ADAPTER
 *
pAd
 = (
PRTMP_ADAPTER
)
Fun˘i⁄C⁄ãxt
;

2367 
MLME_DISASSOC_REQ_STRUCT
 
DißssocReq
;

2370 
	`DBGPRINT
(
RT_DEBUG_TRACE
, "RTMPReportMicError - disassociate with current APáfter sending second continuous EAPOL frame\n");

2371 
	`DißssocP¨mFûl
(
pAd
, &
DißssocReq
,ÖAd->
P‹tCfg
.
Bssid
, 
REASON_MIC_FAILURE
);

2372 
	`MlmeEnqueue
(
pAd
, 
ASSOC_STATE_MACHINE
, 
MT2_MLME_DISASSOC_REQ
, (
MLME_DISASSOC_REQ_STRUCT
), &
DißssocReq
);

2374 
pAd
->
Mlme
.
C¡lMachöe
.
CuºSèã
 = 
CNTL_WAIT_OID_DISASSOC
;

2375 
pAd
->
P‹tCfg
.
bBlockAssoc
 = 
TRUE
;

2376 
	`MlmeH™dÀr
(
pAd
);

2377 
	}
}

	@wpa.h

38 #i‚de‡
__WPA_H__


39 
	#__WPA_H__


	)

42 
	#LEN_KEY_DESC_NONCE
 32

	)

43 
	#LEN_KEY_DESC_IV
 16

	)

44 
	#LEN_KEY_DESC_RSC
 8

	)

45 
	#LEN_KEY_DESC_ID
 8

	)

46 
	#LEN_KEY_DESC_REPLAY
 8

	)

47 
	#LEN_KEY_DESC_MIC
 16

	)

50 
	#EAPOL_VER
 1

	)

51 
	#DESC_TYPE_TKIP
 1

	)

52 
	#DESC_TYPE_AES
 2

	)

53 
	#RSN_KEY_DESC
 0x„

	)

54 
	#WPA1_KEY_DESC
 0xFE

	)

55 
	#WPA2_KEY_DESC
 0x2

	)

57 
	#LEN_MASTER_KEY
 32

	)

60 
	#LEN_EAP_EK
 16

	)

61 
	#LEN_EAP_MICK
 16

	)

62 
	#LEN_EAP_KEY
 ((
LEN_EAP_EK
)+(
LEN_EAP_MICK
))

	)

64 
	#LEN_TKIP_EK
 16

	)

65 
	#LEN_TKIP_RXMICK
 8

	)

66 
	#LEN_TKIP_TXMICK
 8

	)

67 
	#LEN_AES_EK
 16

	)

68 
	#LEN_AES_KEY
 
LEN_AES_EK


	)

69 
	#LEN_TKIP_KEY
 ((
LEN_TKIP_EK
)+(
LEN_TKIP_RXMICK
)+(
LEN_TKIP_TXMICK
))

	)

70 
	#TKIP_AP_TXMICK_OFFSET
 ((
LEN_EAP_KEY
)+(
LEN_TKIP_EK
))

	)

71 
	#TKIP_AP_RXMICK_OFFSET
 (
TKIP_AP_TXMICK_OFFSET
+
LEN_TKIP_TXMICK
)

	)

72 
	#TKIP_GTK_LENGTH
 ((
LEN_TKIP_EK
)+(
LEN_TKIP_RXMICK
)+(
LEN_TKIP_TXMICK
))

	)

73 
	#LEN_PTK
 ((
LEN_EAP_KEY
)+(
LEN_TKIP_KEY
))

	)

77 
	#EAPPackë
 0

	)

78 
	#EAPOLSèπ
 1

	)

79 
	#EAPOLLogoff
 2

	)

80 
	#EAPOLKey
 3

	)

81 
	#EAPOLASFAÀπ
 4

	)

82 
	#EAPTty≥Max
 5

	)

84 
	#EAPOL_MSG_INVALID
 0

	)

85 
	#EAPOL_PAIR_MSG_1
 1

	)

86 
	#EAPOL_PAIR_MSG_3
 2

	)

87 
	#EAPOL_GROUP_MSG_1
 3

	)

93 
	sóp_hdr
 {

94 
u8
 
	mcode
;

95 
u8
 
	midítifõr
;

96 
u16
 
	mÀngth
;

98 } 
__©åibuã__
 ((
∑cked
));

100 íum { 
	mEAP_CODE_REQUEST
 = 1, 
	mEAP_CODE_RESPONSE
 = 2, 
	mEAP_CODE_SUCCESS
 = 3,

101 
	mEAP_CODE_FAILURE
 = 4 };

103 
	#LENGTH_EAP_H
 4

	)

109 
	mEAP_TYPE_NONE
 = 0,

110 
	mEAP_TYPE_IDENTITY
 = 1 ,

111 
	mEAP_TYPE_NOTIFICATION
 = 2 ,

112 
	mEAP_TYPE_NAK
 = 3 ,

113 
	mEAP_TYPE_MD5
 = 4,

114 
	mEAP_TYPE_OTP
 = 5 ,

115 
	mEAP_TYPE_GTC
 = 6,

116 
	mEAP_TYPE_TLS
 = 13 ,

117 
	mEAP_TYPE_LEAP
 = 17 ,

118 
	mEAP_TYPE_SIM
 = 18 ,

119 
	mEAP_TYPE_TTLS
 = 21 ,

120 
	mEAP_TYPE_AKA
 = 23 ,

121 
	mEAP_TYPE_PEAP
 = 25 ,

122 
	mEAP_TYPE_MSCHAPV2
 = 26 ,

123 
	mEAP_TYPE_TLV
 = 33 ,

124 
	mEAP_TYPE_FAST
 = 43 ,

125 
	mEAP_TYPE_PAX
 = 46,

126 
	mEAP_TYPE_EXPANDED_NAK
 = 254 ,

127 
	mEAP_TYPE_PSK
 = 255

129 } 
	tE≠Ty≥
;

133 
PACKED
 
	t_KEY_INFO


135 #ifde‡
BIG_ENDIAN


136 
UCHAR
 
	gKeyAck
:1;

137 
UCHAR
 
	gIn°Æl
:1;

138 
UCHAR
 
	gKeyIndex
:2;

139 
UCHAR
 
	gKeyTy≥
:1;

140 
UCHAR
 
	gKeyDescVî
:3;

141 
UCHAR
 
	gRsvd
:3;

142 
UCHAR
 
	gEKD_DL
:1;

143 
UCHAR
 
	gReque°
:1;

144 
UCHAR
 
	gEº‹
:1;

145 
UCHAR
 
	gSecuª
:1;

146 
UCHAR
 
	gKeyMic
:1;

148 
UCHAR
 
	gKeyMic
:1;

149 
UCHAR
 
	gSecuª
:1;

150 
UCHAR
 
	gEº‹
:1;

151 
UCHAR
 
	gReque°
:1;

152 
UCHAR
 
	gEKD_DL
:1;

153 
UCHAR
 
	gRsvd
:3;

154 
UCHAR
 
	gKeyDescVî
:3;

155 
UCHAR
 
	gKeyTy≥
:1;

156 
UCHAR
 
	gKeyIndex
:2;

157 
UCHAR
 
	gIn°Æl
:1;

158 
UCHAR
 
	gKeyAck
:1;

160 } 
	tKEY_INFO
, *
	tPKEY_INFO
;

163 
PACKED
 
	t_KEY_DESCRIPTER


165 
UCHAR
 
	gTy≥
;

166 
KEY_INFO
 
	gKeyInfo
;

167 
UCHAR
 
	gKeyLígth
[2];

168 
UCHAR
 
	gRïœyCou¡î
[
LEN_KEY_DESC_REPLAY
];

169 
UCHAR
 
	gKeyN⁄˚
[
LEN_KEY_DESC_NONCE
];

170 
UCHAR
 
	gKeyIv
[
LEN_KEY_DESC_IV
];

171 
UCHAR
 
	gKeyRsc
[
LEN_KEY_DESC_RSC
];

172 
UCHAR
 
	gKeyId
[
LEN_KEY_DESC_ID
];

173 
UCHAR
 
	gKeyMic
[
LEN_KEY_DESC_MIC
];

174 
UCHAR
 
	gKeyD©aLí
[2];

175 
UCHAR
 
	gKeyD©a
[
MAX_LEN_OF_RSNIE
];

176 } 
	tKEY_DESCRIPTER
, *
	tPKEY_DESCRIPTER
;

178 
PACKED
 
	t_EAPOL_PACKET


180 
UCHAR
 
	gVîsi⁄
;

181 
UCHAR
 
	gTy≥
;

182 
UCHAR
 
	gLí
[2];

183 
KEY_DESCRIPTER
 
	gKeyDesc
;

184 } 
	tEAPOL_PACKET
, *
	tPEAPOL_PACKET
;

187 
PACKED
 
	t_GTK_ENCAP


189 #ifde‡
BIG_ENDIAN


190 
UCHAR
 
	grsv
:5;

191 
UCHAR
 
	gtx
:1;

192 
UCHAR
 
	gKid
:2;

193 
UCHAR
 
	grsv1
;

195 
UCHAR
 
	gKid
:2;

196 
UCHAR
 
	gtx
:1;

197 
UCHAR
 
	grsv
:5;

198 
UCHAR
 
	grsv1
;

200 
UCHAR
 
	gGTK
[32];

201 } 
	tGTK_ENCAP
, *
	tPGTK_ENCAP
;

203 
PACKED
 
	t_KDE_ENCAP


205 
UCHAR
 
	gTy≥
;

206 
UCHAR
 
	gLí
;

207 
UCHAR
 
	gOUI
[3];

208 
UCHAR
 
	gD©aTy≥
;

209 
GTK_ENCAP
 
	gGTKEnˇp
;

210 } 
	tKDE_ENCAP
, *
	tPKDE_ENCAP
;

214 
	e_W∑Sèã


216 
	mSS_NOTUSE
,

217 
	mSS_START
,

218 
	mSS_WAIT_MSG_3
,

219 
	mSS_WAIT_GROUP
,

220 
	mSS_FINISH
,

221 
	mSS_KEYUPDATE
,

222 } 
	tWPA_STATE
;

	@/usr/include/linux/errno.h

1 #i‚de‡
_LINUX_ERRNO_H


2 
	#_LINUX_ERRNO_H


	)

4 
	~<asm/î∫o.h
>

	@/usr/include/linux/ethtool.h

13 #i‚de‡
_LINUX_ETHTOOL_H


14 
	#_LINUX_ETHTOOL_H


	)

16 
	~<löux/ty≥s.h
>

19 
	sëhtoﬁ_cmd
 {

20 
__u32
 
	mcmd
;

21 
__u32
 
	msuµ‹ãd
;

22 
__u32
 
	madvîtisög
;

23 
__u16
 
	m•ìd
;

24 
__u8
 
	mdu∂ex
;

25 
__u8
 
	mp‹t
;

26 
__u8
 
	mphy_addªss
;

27 
__u8
 
	må™s˚ivî
;

28 
__u8
 
	maut⁄eg
;

29 
__u8
 
	mmdio_suµ‹t
;

30 
__u32
 
	mmaxtxpkt
;

31 
__u32
 
	mmaxrxpkt
;

32 
__u16
 
	m•ìd_hi
;

33 
__u8
 
	mëh_ç_mdix
;

34 
__u8
 
	mª£rved2
;

35 
__u32
 
	mÕ_advîtisög
;

36 
__u32
 
	mª£rved
[2];

39 
__ölöe__
 
	$ëhtoﬁ_cmd_•ìd_£t
(
ëhtoﬁ_cmd
 *
ï
,

40 
__u32
 
•ìd
)

43 
ï
->
•ìd
 = (
__u16
)speed;

44 
ï
->
•ìd_hi
 = (
__u16
)(
•ìd
 >> 16);

45 
	}
}

47 
__ölöe__
 
__u32
 
	$ëhtoﬁ_cmd_•ìd
(
ëhtoﬁ_cmd
 *
ï
)

49  (
ï
->
•ìd_hi
 << 16Ë|Ép->
•ìd
;

50 
	}
}

52 
	#ETHTOOL_BUSINFO_LEN
 32

	)

54 
	sëhtoﬁ_drvöfo
 {

55 
__u32
 
	mcmd
;

56 
	mdrivî
[32];

57 
	mvîsi⁄
[32];

58 
	mfw_vîsi⁄
[32];

59 
	mbus_öfo
[
ETHTOOL_BUSINFO_LEN
];

61 
	mª£rved1
[32];

62 
	mª£rved2
[12];

63 
__u32
 
	mn_¥iv_Êags
;

64 
__u32
 
	mn_°©s
;

65 
__u32
 
	mã°öfo_Àn
;

66 
__u32
 
	mìdump_Àn
;

67 
__u32
 
	mªgdump_Àn
;

70 
	#SOPASS_MAX
 6

	)

72 
	sëhtoﬁ_wﬁöfo
 {

73 
__u32
 
	mcmd
;

74 
__u32
 
	msuµ‹ãd
;

75 
__u32
 
	mwﬁ›ts
;

76 
__u8
 
	ms›ass
[
SOPASS_MAX
];

80 
	sëhtoﬁ_vÆue
 {

81 
__u32
 
	mcmd
;

82 
__u32
 
	md©a
;

86 
	sëhtoﬁ_ªgs
 {

87 
__u32
 
	mcmd
;

88 
__u32
 
	mvîsi⁄
;

89 
__u32
 
	mÀn
;

90 
__u8
 
	md©a
[0];

94 
	sëhtoﬁ_ì¥om
 {

95 
__u32
 
	mcmd
;

96 
__u32
 
	mmagic
;

97 
__u32
 
	moff£t
;

98 
__u32
 
	mÀn
;

99 
__u8
 
	md©a
[0];

103 
	sëhtoﬁ_cﬂÀs˚
 {

104 
__u32
 
	mcmd
;

110 
__u32
 
	mrx_cﬂÀs˚_u£cs
;

118 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames
;

125 
__u32
 
	mrx_cﬂÀs˚_u£cs_úq
;

126 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames_úq
;

132 
__u32
 
	mtx_cﬂÀs˚_u£cs
;

140 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames
;

147 
__u32
 
	mtx_cﬂÀs˚_u£cs_úq
;

148 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames_úq
;

155 
__u32
 
	m°©s_block_cﬂÀs˚_u£cs
;

164 
__u32
 
	mu£_ad≠tive_rx_cﬂÀs˚
;

165 
__u32
 
	mu£_ad≠tive_tx_cﬂÀs˚
;

171 
__u32
 
	mpkt_øã_low
;

172 
__u32
 
	mrx_cﬂÀs˚_u£cs_low
;

173 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames_low
;

174 
__u32
 
	mtx_cﬂÀs˚_u£cs_low
;

175 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames_low
;

186 
__u32
 
	mpkt_øã_high
;

187 
__u32
 
	mrx_cﬂÀs˚_u£cs_high
;

188 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames_high
;

189 
__u32
 
	mtx_cﬂÀs˚_u£cs_high
;

190 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames_high
;

195 
__u32
 
	møã_ßm∂e_öãrvÆ
;

199 
	sëhtoﬁ_rög∑øm
 {

200 
__u32
 
	mcmd
;

206 
__u32
 
	mrx_max_≥ndög
;

207 
__u32
 
	mrx_möi_max_≥ndög
;

208 
__u32
 
	mrx_jumbo_max_≥ndög
;

209 
__u32
 
	mtx_max_≥ndög
;

214 
__u32
 
	mrx_≥ndög
;

215 
__u32
 
	mrx_möi_≥ndög
;

216 
__u32
 
	mrx_jumbo_≥ndög
;

217 
__u32
 
	mtx_≥ndög
;

221 
	sëhtoﬁ_∑u£∑øm
 {

222 
__u32
 
	mcmd
;

234 
__u32
 
	maut⁄eg
;

235 
__u32
 
	mrx_∑u£
;

236 
__u32
 
	mtx_∑u£
;

239 
	#ETH_GSTRING_LEN
 32

	)

240 
	eëhtoﬁ_°rög£t
 {

241 
	mETH_SS_TEST
 = 0,

242 
	mETH_SS_STATS
,

243 
	mETH_SS_PRIV_FLAGS
,

247 
	sëhtoﬁ_g°rögs
 {

248 
__u32
 
	mcmd
;

249 
__u32
 
	m°rög_£t
;

250 
__u32
 
	mÀn
;

251 
__u8
 
	md©a
[0];

254 
	eëhtoﬁ_ã°_Êags
 {

255 
	mETH_TEST_FL_OFFLINE
 = (1 << 0),

256 
	mETH_TEST_FL_FAILED
 = (1 << 1),

260 
	sëhtoﬁ_ã°
 {

261 
__u32
 
	mcmd
;

262 
__u32
 
	mÊags
;

263 
__u32
 
	mª£rved
;

264 
__u32
 
	mÀn
;

265 
__u64
 
	md©a
[0];

269 
	sëhtoﬁ_°©s
 {

270 
__u32
 
	mcmd
;

271 
__u32
 
	mn_°©s
;

272 
__u64
 
	md©a
[0];

275 
	sëhtoﬁ_≥rm_addr
 {

276 
__u32
 
	mcmd
;

277 
__u32
 
	msize
;

278 
__u8
 
	md©a
[0];

290 
	eëhtoﬁ_Êags
 {

291 
	mETH_FLAG_LRO
 = (1 << 15),

299 
	sëhtoﬁ_t˝ù4_•ec
 {

300 
__be32
 
	mù4§c
;

301 
__be32
 
	mù4d°
;

302 
__be16
 
	mp§c
;

303 
__be16
 
	mpd°
;

304 
__u8
 
	mtos
;

307 
	sëhtoﬁ_ah_e•ù4_•ec
 {

308 
__be32
 
	mù4§c
;

309 
__be32
 
	mù4d°
;

310 
__be32
 
	m•i
;

311 
__u8
 
	mtos
;

314 
	sëhtoﬁ_øwù4_•ec
 {

315 
__be32
 
	mù4§c
;

316 
__be32
 
	mù4d°
;

317 
__u8
 
	mhd©a
[64];

320 
	sëhtoﬁ_ëhî_•ec
 {

321 
__be16
 
	mëhî_ty≥
;

322 
__u8
 
	m‰ame_size
;

323 
__u8
 
	me‰ame
[16];

326 
	#ETH_RX_NFC_IP4
 1

	)

327 
	#ETH_RX_NFC_IP6
 2

	)

329 
	sëhtoﬁ_u§ù4_•ec
 {

330 
__be32
 
	mù4§c
;

331 
__be32
 
	mù4d°
;

332 
__be32
 
	ml4_4_byãs
;

333 
__u8
 
	mtos
;

334 
__u8
 
	mù_vî
;

335 
__u8
 
	m¥Ÿo
;

338 
	sëhtoﬁ_rx_Êow_•ec
 {

339 
__u32
 
	mÊow_ty≥
;

341 
ëhtoﬁ_t˝ù4_•ec
 
	mt˝_ù4_•ec
;

342 
ëhtoﬁ_t˝ù4_•ec
 
	mudp_ù4_•ec
;

343 
ëhtoﬁ_t˝ù4_•ec
 
	ms˘p_ù4_•ec
;

344 
ëhtoﬁ_ah_e•ù4_•ec
 
	mah_ù4_•ec
;

345 
ëhtoﬁ_ah_e•ù4_•ec
 
	me•_ù4_•ec
;

346 
ëhtoﬁ_øwù4_•ec
 
	møw_ù4_•ec
;

347 
ëhtoﬁ_ëhî_•ec
 
	mëhî_•ec
;

348 
ëhtoﬁ_u§ù4_•ec
 
	mu§_ù4_•ec
;

349 
__u8
 
	mhd©a
[64];

350 } 
	mh_u
, 
	mm_u
;

351 
__u64
 
	mrög_cookõ
;

352 
__u32
 
	mloˇti⁄
;

355 
	sëhtoﬁ_rxnfc
 {

356 
__u32
 
	mcmd
;

357 
__u32
 
	mÊow_ty≥
;

359 
__u64
 
	md©a
;

362 
ëhtoﬁ_rx_Êow_•ec
 
	mfs
;

363 
__u32
 
	mruÀ_˙t
;

364 
__u32
 
	mruÀ_locs
[0];

367 
	#ETHTOOL_FLASH_MAX_FILENAME
 128

	)

368 
	eëhtoﬁ_Êash_›_ty≥
 {

369 
	mETHTOOL_FLASH_ALL_REGIONS
 = 0,

373 
	sëhtoﬁ_Êash
 {

374 
__u32
 
	mcmd
;

375 
__u32
 
	mªgi⁄
;

376 
	md©a
[
ETHTOOL_FLASH_MAX_FILENAME
];

381 
	#ETHTOOL_GSET
 0x00000001

	)

382 
	#ETHTOOL_SSET
 0x00000002

	)

383 
	#ETHTOOL_GDRVINFO
 0x00000003

	)

384 
	#ETHTOOL_GREGS
 0x00000004

	)

385 
	#ETHTOOL_GWOL
 0x00000005

	)

386 
	#ETHTOOL_SWOL
 0x00000006

	)

387 
	#ETHTOOL_GMSGLVL
 0x00000007

	)

388 
	#ETHTOOL_SMSGLVL
 0x00000008

	)

389 
	#ETHTOOL_NWAY_RST
 0x00000009

	)

390 
	#ETHTOOL_GLINK
 0x0000000®

	)

391 
	#ETHTOOL_GEEPROM
 0x0000000b

	)

392 
	#ETHTOOL_SEEPROM
 0x0000000¯

	)

393 
	#ETHTOOL_GCOALESCE
 0x0000000ê

	)

394 
	#ETHTOOL_SCOALESCE
 0x0000000‡

	)

395 
	#ETHTOOL_GRINGPARAM
 0x00000010

	)

396 
	#ETHTOOL_SRINGPARAM
 0x00000011

	)

397 
	#ETHTOOL_GPAUSEPARAM
 0x00000012

	)

398 
	#ETHTOOL_SPAUSEPARAM
 0x00000013

	)

399 
	#ETHTOOL_GRXCSUM
 0x00000014

	)

400 
	#ETHTOOL_SRXCSUM
 0x00000015

	)

401 
	#ETHTOOL_GTXCSUM
 0x00000016

	)

402 
	#ETHTOOL_STXCSUM
 0x00000017

	)

403 
	#ETHTOOL_GSG
 0x00000018

	)

405 
	#ETHTOOL_SSG
 0x00000019

	)

407 
	#ETHTOOL_TEST
 0x0000001®

	)

408 
	#ETHTOOL_GSTRINGS
 0x0000001b

	)

409 
	#ETHTOOL_PHYS_ID
 0x0000001¯

	)

410 
	#ETHTOOL_GSTATS
 0x0000001d

	)

411 
	#ETHTOOL_GTSO
 0x0000001ê

	)

412 
	#ETHTOOL_STSO
 0x0000001‡

	)

413 
	#ETHTOOL_GPERMADDR
 0x00000020

	)

414 
	#ETHTOOL_GUFO
 0x00000021

	)

415 
	#ETHTOOL_SUFO
 0x00000022

	)

416 
	#ETHTOOL_GGSO
 0x00000023

	)

417 
	#ETHTOOL_SGSO
 0x00000024

	)

418 
	#ETHTOOL_GFLAGS
 0x00000025

	)

419 
	#ETHTOOL_SFLAGS
 0x00000026

	)

420 
	#ETHTOOL_GPFLAGS
 0x00000027

	)

421 
	#ETHTOOL_SPFLAGS
 0x00000028

	)

423 
	#ETHTOOL_GRXFH
 0x00000029

	)

424 
	#ETHTOOL_SRXFH
 0x0000002®

	)

425 
	#ETHTOOL_GGRO
 0x0000002b

	)

426 
	#ETHTOOL_SGRO
 0x0000002¯

	)

427 
	#ETHTOOL_GRXRINGS
 0x0000002d

	)

428 
	#ETHTOOL_GRXCLSRLCNT
 0x0000002ê

	)

429 
	#ETHTOOL_GRXCLSRULE
 0x0000002‡

	)

430 
	#ETHTOOL_GRXCLSRLALL
 0x00000030

	)

431 
	#ETHTOOL_SRXCLSRLDEL
 0x00000031

	)

432 
	#ETHTOOL_SRXCLSRLINS
 0x00000032

	)

433 
	#ETHTOOL_FLASHDEV
 0x00000033

	)

434 
	#ETHTOOL_RESET
 0x00000034

	)

437 
	#SPARC_ETH_GSET
 
ETHTOOL_GSET


	)

438 
	#SPARC_ETH_SSET
 
ETHTOOL_SSET


	)

441 
	#SUPPORTED_10ba£T_HÆf
 (1 << 0)

	)

442 
	#SUPPORTED_10ba£T_FuŒ
 (1 << 1)

	)

443 
	#SUPPORTED_100ba£T_HÆf
 (1 << 2)

	)

444 
	#SUPPORTED_100ba£T_FuŒ
 (1 << 3)

	)

445 
	#SUPPORTED_1000ba£T_HÆf
 (1 << 4)

	)

446 
	#SUPPORTED_1000ba£T_FuŒ
 (1 << 5)

	)

447 
	#SUPPORTED_Aut⁄eg
 (1 << 6)

	)

448 
	#SUPPORTED_TP
 (1 << 7)

	)

449 
	#SUPPORTED_AUI
 (1 << 8)

	)

450 
	#SUPPORTED_MII
 (1 << 9)

	)

451 
	#SUPPORTED_FIBRE
 (1 << 10)

	)

452 
	#SUPPORTED_BNC
 (1 << 11)

	)

453 
	#SUPPORTED_10000ba£T_FuŒ
 (1 << 12)

	)

454 
	#SUPPORTED_Pau£
 (1 << 13)

	)

455 
	#SUPPORTED_Asym_Pau£
 (1 << 14)

	)

456 
	#SUPPORTED_2500ba£X_FuŒ
 (1 << 15)

	)

457 
	#SUPPORTED_Back∂™e
 (1 << 16)

	)

458 
	#SUPPORTED_1000ba£KX_FuŒ
 (1 << 17)

	)

459 
	#SUPPORTED_10000ba£KX4_FuŒ
 (1 << 18)

	)

460 
	#SUPPORTED_10000ba£KR_FuŒ
 (1 << 19)

	)

461 
	#SUPPORTED_10000ba£R_FEC
 (1 << 20)

	)

464 
	#ADVERTISED_10ba£T_HÆf
 (1 << 0)

	)

465 
	#ADVERTISED_10ba£T_FuŒ
 (1 << 1)

	)

466 
	#ADVERTISED_100ba£T_HÆf
 (1 << 2)

	)

467 
	#ADVERTISED_100ba£T_FuŒ
 (1 << 3)

	)

468 
	#ADVERTISED_1000ba£T_HÆf
 (1 << 4)

	)

469 
	#ADVERTISED_1000ba£T_FuŒ
 (1 << 5)

	)

470 
	#ADVERTISED_Aut⁄eg
 (1 << 6)

	)

471 
	#ADVERTISED_TP
 (1 << 7)

	)

472 
	#ADVERTISED_AUI
 (1 << 8)

	)

473 
	#ADVERTISED_MII
 (1 << 9)

	)

474 
	#ADVERTISED_FIBRE
 (1 << 10)

	)

475 
	#ADVERTISED_BNC
 (1 << 11)

	)

476 
	#ADVERTISED_10000ba£T_FuŒ
 (1 << 12)

	)

477 
	#ADVERTISED_Pau£
 (1 << 13)

	)

478 
	#ADVERTISED_Asym_Pau£
 (1 << 14)

	)

479 
	#ADVERTISED_2500ba£X_FuŒ
 (1 << 15)

	)

480 
	#ADVERTISED_Back∂™e
 (1 << 16)

	)

481 
	#ADVERTISED_1000ba£KX_FuŒ
 (1 << 17)

	)

482 
	#ADVERTISED_10000ba£KX4_FuŒ
 (1 << 18)

	)

483 
	#ADVERTISED_10000ba£KR_FuŒ
 (1 << 19)

	)

484 
	#ADVERTISED_10000ba£R_FEC
 (1 << 20)

	)

493 
	#SPEED_10
 10

	)

494 
	#SPEED_100
 100

	)

495 
	#SPEED_1000
 1000

	)

496 
	#SPEED_2500
 2500

	)

497 
	#SPEED_10000
 10000

	)

500 
	#DUPLEX_HALF
 0x00

	)

501 
	#DUPLEX_FULL
 0x01

	)

504 
	#PORT_TP
 0x00

	)

505 
	#PORT_AUI
 0x01

	)

506 
	#PORT_MII
 0x02

	)

507 
	#PORT_FIBRE
 0x03

	)

508 
	#PORT_BNC
 0x04

	)

509 
	#PORT_OTHER
 0xff

	)

512 
	#XCVR_INTERNAL
 0x00

	)

513 
	#XCVR_EXTERNAL
 0x01

	)

514 
	#XCVR_DUMMY1
 0x02

	)

515 
	#XCVR_DUMMY2
 0x03

	)

516 
	#XCVR_DUMMY3
 0x04

	)

521 
	#AUTONEG_DISABLE
 0x00

	)

522 
	#AUTONEG_ENABLE
 0x01

	)

525 
	#ETH_TP_MDI_INVALID
 0x00

	)

526 
	#ETH_TP_MDI
 0x01

	)

527 
	#ETH_TP_MDI_X
 0x02

	)

530 
	#WAKE_PHY
 (1 << 0)

	)

531 
	#WAKE_UCAST
 (1 << 1)

	)

532 
	#WAKE_MCAST
 (1 << 2)

	)

533 
	#WAKE_BCAST
 (1 << 3)

	)

534 
	#WAKE_ARP
 (1 << 4)

	)

535 
	#WAKE_MAGIC
 (1 << 5)

	)

536 
	#WAKE_MAGICSECURE
 (1 << 6Ë

	)

539 
	#TCP_V4_FLOW
 0x01

	)

540 
	#UDP_V4_FLOW
 0x02

	)

541 
	#SCTP_V4_FLOW
 0x03

	)

542 
	#AH_ESP_V4_FLOW
 0x04

	)

543 
	#TCP_V6_FLOW
 0x05

	)

544 
	#UDP_V6_FLOW
 0x06

	)

545 
	#SCTP_V6_FLOW
 0x07

	)

546 
	#AH_ESP_V6_FLOW
 0x08

	)

547 
	#AH_V4_FLOW
 0x09

	)

548 
	#ESP_V4_FLOW
 0x0a

	)

549 
	#AH_V6_FLOW
 0x0b

	)

550 
	#ESP_V6_FLOW
 0x0c

	)

551 
	#IP_USER_FLOW
 0x0d

	)

554 
	#RXH_L2DA
 (1 << 1)

	)

555 
	#RXH_VLAN
 (1 << 2)

	)

556 
	#RXH_L3_PROTO
 (1 << 3)

	)

557 
	#RXH_IP_SRC
 (1 << 4)

	)

558 
	#RXH_IP_DST
 (1 << 5)

	)

559 
	#RXH_L4_B_0_1
 (1 << 6Ë

	)

560 
	#RXH_L4_B_2_3
 (1 << 7Ë

	)

561 
	#RXH_DISCARD
 (1 << 31)

	)

563 
	#RX_CLS_FLOW_DISC
 0xffffffffffffffffULL

	)

572 
	eëhtoﬁ_ª£t_Êags
 {

578 
	mETH_RESET_MGMT
 = 1 << 0,

579 
	mETH_RESET_IRQ
 = 1 << 1,

580 
	mETH_RESET_DMA
 = 1 << 2,

581 
	mETH_RESET_FILTER
 = 1 << 3,

582 
	mETH_RESET_OFFLOAD
 = 1 << 4,

583 
	mETH_RESET_MAC
 = 1 << 5,

584 
	mETH_RESET_PHY
 = 1 << 6,

585 
	mETH_RESET_RAM
 = 1 << 7,

588 
	mETH_RESET_DEDICATED
 = 0x0000ffff,

590 
	mETH_RESET_ALL
 = 0xffffffff,

593 
	#ETH_RESET_SHARED_SHIFT
 16

	)

	@/usr/include/linux/if_arp.h

23 #i‚de‡
_LINUX_IF_ARP_H


24 
	#_LINUX_IF_ARP_H


	)

26 
	~<löux/√tdevi˚.h
>

29 
	#ARPHRD_NETROM
 0

	)

30 
	#ARPHRD_ETHER
 1

	)

31 
	#ARPHRD_EETHER
 2

	)

32 
	#ARPHRD_AX25
 3

	)

33 
	#ARPHRD_PRONET
 4

	)

34 
	#ARPHRD_CHAOS
 5

	)

35 
	#ARPHRD_IEEE802
 6

	)

36 
	#ARPHRD_ARCNET
 7

	)

37 
	#ARPHRD_APPLETLK
 8

	)

38 
	#ARPHRD_DLCI
 15

	)

39 
	#ARPHRD_ATM
 19

	)

40 
	#ARPHRD_METRICOM
 23

	)

41 
	#ARPHRD_IEEE1394
 24

	)

42 
	#ARPHRD_EUI64
 27

	)

43 
	#ARPHRD_INFINIBAND
 32

	)

46 
	#ARPHRD_SLIP
 256

	)

47 
	#ARPHRD_CSLIP
 257

	)

48 
	#ARPHRD_SLIP6
 258

	)

49 
	#ARPHRD_CSLIP6
 259

	)

50 
	#ARPHRD_RSRVD
 260

	)

51 
	#ARPHRD_ADAPT
 264

	)

52 
	#ARPHRD_ROSE
 270

	)

53 
	#ARPHRD_X25
 271

	)

54 
	#ARPHRD_HWX25
 272

	)

55 
	#ARPHRD_CAN
 280

	)

56 
	#ARPHRD_PPP
 512

	)

57 
	#ARPHRD_CISCO
 513

	)

58 
	#ARPHRD_HDLC
 
ARPHRD_CISCO


	)

59 
	#ARPHRD_LAPB
 516

	)

60 
	#ARPHRD_DDCMP
 517

	)

61 
	#ARPHRD_RAWHDLC
 518

	)

63 
	#ARPHRD_TUNNEL
 768

	)

64 
	#ARPHRD_TUNNEL6
 769

	)

65 
	#ARPHRD_FRAD
 770

	)

66 
	#ARPHRD_SKIP
 771

	)

67 
	#ARPHRD_LOOPBACK
 772

	)

68 
	#ARPHRD_LOCALTLK
 773

	)

69 
	#ARPHRD_FDDI
 774

	)

70 
	#ARPHRD_BIF
 775

	)

71 
	#ARPHRD_SIT
 776

	)

72 
	#ARPHRD_IPDDP
 777

	)

73 
	#ARPHRD_IPGRE
 778

	)

74 
	#ARPHRD_PIMREG
 779

	)

75 
	#ARPHRD_HIPPI
 780

	)

76 
	#ARPHRD_ASH
 781

	)

77 
	#ARPHRD_ECONET
 782

	)

78 
	#ARPHRD_IRDA
 783

	)

80 
	#ARPHRD_FCPP
 784

	)

81 
	#ARPHRD_FCAL
 785

	)

82 
	#ARPHRD_FCPL
 786

	)

83 
	#ARPHRD_FCFABRIC
 787

	)

85 
	#ARPHRD_IEEE802_TR
 800

	)

86 
	#ARPHRD_IEEE80211
 801

	)

87 
	#ARPHRD_IEEE80211_PRISM
 802

	)

88 
	#ARPHRD_IEEE80211_RADIOTAP
 803

	)

89 
	#ARPHRD_IEEE802154
 804

	)

91 
	#ARPHRD_PHONET
 820

	)

92 
	#ARPHRD_PHONET_PIPE
 821

	)

94 
	#ARPHRD_VOID
 0xFFFF

	)

95 
	#ARPHRD_NONE
 0xFFFE

	)

98 
	#ARPOP_REQUEST
 1

	)

99 
	#ARPOP_REPLY
 2

	)

100 
	#ARPOP_RREQUEST
 3

	)

101 
	#ARPOP_RREPLY
 4

	)

102 
	#ARPOP_InREQUEST
 8

	)

103 
	#ARPOP_InREPLY
 9

	)

104 
	#ARPOP_NAK
 10

	)

108 
	s¨¥eq
 {

109 
sockaddr
 
	m¨p_∑
;

110 
sockaddr
 
	m¨p_ha
;

111 
	m¨p_Êags
;

112 
sockaddr
 
	m¨p_√tmask
;

113 
	m¨p_dev
[16];

116 
	s¨¥eq_ﬁd
 {

117 
sockaddr
 
	m¨p_∑
;

118 
sockaddr
 
	m¨p_ha
;

119 
	m¨p_Êags
;

120 
sockaddr
 
	m¨p_√tmask
;

124 
	#ATF_COM
 0x02

	)

125 
	#ATF_PERM
 0x04

	)

126 
	#ATF_PUBL
 0x08

	)

127 
	#ATF_USETRAILERS
 0x10

	)

128 
	#ATF_NETMASK
 0x20

	)

130 
	#ATF_DONTPUB
 0x40

	)

136 
	s¨phdr


138 
__be16
 
	m¨_hrd
;

139 
__be16
 
	m¨_¥o
;

140 
	m¨_h 
;

141 
	m¨_∂n
;

142 
__be16
 
	m¨_›
;

148 
	m¨_sha
[
ETH_ALEN
];

149 
	m¨_sù
[4];

150 
	m¨_tha
[
ETH_ALEN
];

151 
	m¨_tù
[4];

	@/usr/include/linux/kernel.h

1 #i‚de‡
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

10 
	#SI_LOAD_SHIFT
 16

	)

11 
	ssysöfo
 {

12 
	mu±ime
;

13 
	mlﬂds
[3];

14 
	mtŸÆøm
;

15 
	m‰ìøm
;

16 
	msh¨edøm
;

17 
	mbuf„ºam
;

18 
	mtŸÆsw≠
;

19 
	m‰ìsw≠
;

20 
	m¥ocs
;

21 
	m∑d
;

22 
	mtŸÆhigh
;

23 
	m‰ìhigh
;

24 
	mmem_unô
;

25 
	m_f
[20-2*()-()];

29 
	#BUILD_BUG_ON
(
c⁄dôi⁄
Ë(()
	`BUILD_BUG_ON_ZERO
(c⁄dôi⁄))

	)

32 
	#MAYBE_BUILD_BUG_ON
(
c⁄d
Ë(()([1 - 2 * !!(c⁄d)]))

	)

38 
	#BUILD_BUG_ON_ZERO
(
e
Ë((°ru˘ { :-!!”); }))

	)

39 
	#BUILD_BUG_ON_NULL
(
e
Ë((*)(°ru˘ { :-!!”); }))

	)

42 
	#__FUNCTION__
 (
__func__
)

	)

45 #ifde‡
CONFIG_NUMA


46 
	#NUMA_BUILD
 1

	)

48 
	#NUMA_BUILD
 0

	)

52 #ifde‡
CONFIG_FTRACE_MCOUNT_RECORD


53 
	#REBUILD_DUE_TO_FTRACE_MCOUNT_RECORD


	)

	@/usr/include/linux/mii.h

8 #i‚de‡
__LINUX_MII_H__


9 
	#__LINUX_MII_H__


	)

11 
	~<löux/ty≥s.h
>

15 
	#MII_BMCR
 0x00

	)

16 
	#MII_BMSR
 0x01

	)

17 
	#MII_PHYSID1
 0x02

	)

18 
	#MII_PHYSID2
 0x03

	)

19 
	#MII_ADVERTISE
 0x04

	)

20 
	#MII_LPA
 0x05

	)

21 
	#MII_EXPANSION
 0x06

	)

22 
	#MII_CTRL1000
 0x09

	)

23 
	#MII_STAT1000
 0x0®

	)

24 
	#MII_ESTATUS
 0x0‡

	)

25 
	#MII_DCOUNTER
 0x12

	)

26 
	#MII_FCSCOUNTER
 0x13

	)

27 
	#MII_NWAYTEST
 0x14

	)

28 
	#MII_RERRCOUNTER
 0x15

	)

29 
	#MII_SREVISION
 0x16

	)

30 
	#MII_RESV1
 0x17

	)

31 
	#MII_LBRERROR
 0x18

	)

32 
	#MII_PHYADDR
 0x19

	)

33 
	#MII_RESV2
 0x1®

	)

34 
	#MII_TPISTATUS
 0x1b

	)

35 
	#MII_NCONFIG
 0x1¯

	)

38 
	#BMCR_RESV
 0x003‡

	)

39 
	#BMCR_SPEED1000
 0x0040

	)

40 
	#BMCR_CTST
 0x0080

	)

41 
	#BMCR_FULLDPLX
 0x0100

	)

42 
	#BMCR_ANRESTART
 0x0200

	)

43 
	#BMCR_ISOLATE
 0x0400

	)

44 
	#BMCR_PDOWN
 0x0800

	)

45 
	#BMCR_ANENABLE
 0x1000

	)

46 
	#BMCR_SPEED100
 0x2000

	)

47 
	#BMCR_LOOPBACK
 0x4000

	)

48 
	#BMCR_RESET
 0x8000

	)

51 
	#BMSR_ERCAP
 0x0001

	)

52 
	#BMSR_JCD
 0x0002

	)

53 
	#BMSR_LSTATUS
 0x0004

	)

54 
	#BMSR_ANEGCAPABLE
 0x0008

	)

55 
	#BMSR_RFAULT
 0x0010

	)

56 
	#BMSR_ANEGCOMPLETE
 0x0020

	)

57 
	#BMSR_RESV
 0x00c0

	)

58 
	#BMSR_ESTATEN
 0x0100

	)

59 
	#BMSR_100HALF2
 0x0200

	)

60 
	#BMSR_100FULL2
 0x0400

	)

61 
	#BMSR_10HALF
 0x0800

	)

62 
	#BMSR_10FULL
 0x1000

	)

63 
	#BMSR_100HALF
 0x2000

	)

64 
	#BMSR_100FULL
 0x4000

	)

65 
	#BMSR_100BASE4
 0x8000

	)

68 
	#ADVERTISE_SLCT
 0x001‡

	)

69 
	#ADVERTISE_CSMA
 0x0001

	)

70 
	#ADVERTISE_10HALF
 0x0020

	)

71 
	#ADVERTISE_1000XFULL
 0x0020

	)

72 
	#ADVERTISE_10FULL
 0x0040

	)

73 
	#ADVERTISE_1000XHALF
 0x0040

	)

74 
	#ADVERTISE_100HALF
 0x0080

	)

75 
	#ADVERTISE_1000XPAUSE
 0x0080

	)

76 
	#ADVERTISE_100FULL
 0x0100

	)

77 
	#ADVERTISE_1000XPSE_ASYM
 0x0100

	)

78 
	#ADVERTISE_100BASE4
 0x0200

	)

79 
	#ADVERTISE_PAUSE_CAP
 0x0400

	)

80 
	#ADVERTISE_PAUSE_ASYM
 0x0800

	)

81 
	#ADVERTISE_RESV
 0x1000

	)

82 
	#ADVERTISE_RFAULT
 0x2000

	)

83 
	#ADVERTISE_LPACK
 0x4000

	)

84 
	#ADVERTISE_NPAGE
 0x8000

	)

86 
	#ADVERTISE_FULL
 (
ADVERTISE_100FULL
 | 
ADVERTISE_10FULL
 | \

87 
ADVERTISE_CSMA
)

	)

88 
	#ADVERTISE_ALL
 (
ADVERTISE_10HALF
 | 
ADVERTISE_10FULL
 | \

89 
ADVERTISE_100HALF
 | 
ADVERTISE_100FULL
)

	)

92 
	#LPA_SLCT
 0x001‡

	)

93 
	#LPA_10HALF
 0x0020

	)

94 
	#LPA_1000XFULL
 0x0020

	)

95 
	#LPA_10FULL
 0x0040

	)

96 
	#LPA_1000XHALF
 0x0040

	)

97 
	#LPA_100HALF
 0x0080

	)

98 
	#LPA_1000XPAUSE
 0x0080

	)

99 
	#LPA_100FULL
 0x0100

	)

100 
	#LPA_1000XPAUSE_ASYM
 0x0100

	)

101 
	#LPA_100BASE4
 0x0200

	)

102 
	#LPA_PAUSE_CAP
 0x0400

	)

103 
	#LPA_PAUSE_ASYM
 0x0800

	)

104 
	#LPA_RESV
 0x1000

	)

105 
	#LPA_RFAULT
 0x2000

	)

106 
	#LPA_LPACK
 0x4000

	)

107 
	#LPA_NPAGE
 0x8000

	)

109 
	#LPA_DUPLEX
 (
LPA_10FULL
 | 
LPA_100FULL
)

	)

110 
	#LPA_100
 (
LPA_100FULL
 | 
LPA_100HALF
 | 
LPA_100BASE4
)

	)

113 
	#EXPANSION_NWAY
 0x0001

	)

114 
	#EXPANSION_LCWP
 0x0002

	)

115 
	#EXPANSION_ENABLENPAGE
 0x0004

	)

116 
	#EXPANSION_NPCAPABLE
 0x0008

	)

117 
	#EXPANSION_MFAULTS
 0x0010

	)

118 
	#EXPANSION_RESV
 0xf„0

	)

120 
	#ESTATUS_1000_TFULL
 0x2000

	)

121 
	#ESTATUS_1000_THALF
 0x1000

	)

124 
	#NWAYTEST_RESV1
 0x00f‡

	)

125 
	#NWAYTEST_LOOPBACK
 0x0100

	)

126 
	#NWAYTEST_RESV2
 0x„00

	)

129 
	#ADVERTISE_1000FULL
 0x0200

	)

130 
	#ADVERTISE_1000HALF
 0x0100

	)

133 
	#LPA_1000LOCALRXOK
 0x2000

	)

134 
	#LPA_1000REMRXOK
 0x1000

	)

135 
	#LPA_1000FULL
 0x0800

	)

136 
	#LPA_1000HALF
 0x0400

	)

139 
	#FLOW_CTRL_TX
 0x01

	)

140 
	#FLOW_CTRL_RX
 0x02

	)

143 
	smii_io˘l_d©a
 {

144 
__u16
 
	mphy_id
;

145 
__u16
 
	mªg_num
;

146 
__u16
 
	mvÆ_ö
;

147 
__u16
 
	mvÆ_out
;

	@/usr/include/linux/netdevice.h

25 #i‚de‡
_LINUX_NETDEVICE_H


26 
	#_LINUX_NETDEVICE_H


	)

28 
	~<löux/if.h
>

29 
	~<löux/if_ëhî.h
>

30 
	~<löux/if_∑ckë.h
>

33 
	#MAX_ADDR_LEN
 32

	)

41 
	s√t_devi˚_°©s


43 
	mrx_∑ckës
;

44 
	mtx_∑ckës
;

45 
	mrx_byãs
;

46 
	mtx_byãs
;

47 
	mrx_îr‹s
;

48 
	mtx_îr‹s
;

49 
	mrx_dr›≥d
;

50 
	mtx_dr›≥d
;

51 
	mmu…iˇ°
;

52 
	mcﬁlisi⁄s
;

55 
	mrx_Àngth_îr‹s
;

56 
	mrx_ovî_îr‹s
;

57 
	mrx_¸c_îr‹s
;

58 
	mrx_‰ame_îr‹s
;

59 
	mrx_fifo_îr‹s
;

60 
	mrx_mis£d_îr‹s
;

63 
	mtx_ab‹ãd_îr‹s
;

64 
	mtx_ˇºõr_îr‹s
;

65 
	mtx_fifo_îr‹s
;

66 
	mtx_hóπbót_îr‹s
;

67 
	mtx_wödow_îr‹s
;

70 
	mrx_com¥es£d
;

71 
	mtx_com¥es£d
;

77 
	mIF_PORT_UNKNOWN
 = 0,

78 
	mIF_PORT_10BASE2
,

79 
	mIF_PORT_10BASET
,

80 
	mIF_PORT_AUI
,

81 
	mIF_PORT_100BASET
,

82 
	mIF_PORT_100BASETX
,

83 
	mIF_PORT_100BASEFX


	@/usr/include/linux/pci.h

17 #i‚de‡
LINUX_PCI_H


18 
	#LINUX_PCI_H


	)

20 
	~<löux/pci_ªgs.h
>

30 
	#PCI_DEVFN
(
¶Ÿ
, 
func
Ë((((¶ŸË& 0x1fË<< 3Ë| ((funcË& 0x07))

	)

31 
	#PCI_SLOT
(
dev‚
Ë(((dev‚Ë>> 3Ë& 0x1f)

	)

32 
	#PCI_FUNC
(
dev‚
Ë((dev‚Ë& 0x07)

	)

35 
	#PCIIOC_BASE
 ('P' << 24 | 'C' << 16 | 'I' << 8)

	)

36 
	#PCIIOC_CONTROLLER
 (
PCIIOC_BASE
 | 0x00Ë

	)

37 
	#PCIIOC_MMAP_IS_IO
 (
PCIIOC_BASE
 | 0x01Ë

	)

38 
	#PCIIOC_MMAP_IS_MEM
 (
PCIIOC_BASE
 | 0x02Ë

	)

39 
	#PCIIOC_WRITE_COMBINE
 (
PCIIOC_BASE
 | 0x03Ë

	)

	@/usr/include/linux/sched.h

1 #i‚de‡
_LINUX_SCHED_H


2 
	#_LINUX_SCHED_H


	)

7 
	#CSIGNAL
 0x000000f‡

	)

8 
	#CLONE_VM
 0x00000100

	)

9 
	#CLONE_FS
 0x00000200

	)

10 
	#CLONE_FILES
 0x00000400

	)

11 
	#CLONE_SIGHAND
 0x00000800

	)

12 
	#CLONE_PTRACE
 0x00002000

	)

13 
	#CLONE_VFORK
 0x00004000

	)

14 
	#CLONE_PARENT
 0x00008000

	)

15 
	#CLONE_THREAD
 0x00010000

	)

16 
	#CLONE_NEWNS
 0x00020000

	)

17 
	#CLONE_SYSVSEM
 0x00040000

	)

18 
	#CLONE_SETTLS
 0x00080000

	)

19 
	#CLONE_PARENT_SETTID
 0x00100000

	)

20 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

21 
	#CLONE_DETACHED
 0x00400000

	)

22 
	#CLONE_UNTRACED
 0x00800000

	)

23 
	#CLONE_CHILD_SETTID
 0x01000000

	)

24 
	#CLONE_STOPPED
 0x02000000

	)

25 
	#CLONE_NEWUTS
 0x04000000

	)

26 
	#CLONE_NEWIPC
 0x08000000

	)

27 
	#CLONE_NEWUSER
 0x10000000

	)

28 
	#CLONE_NEWPID
 0x20000000

	)

29 
	#CLONE_NEWNET
 0x40000000

	)

30 
	#CLONE_IO
 0x80000000

	)

35 
	#SCHED_NORMAL
 0

	)

36 
	#SCHED_FIFO
 1

	)

37 
	#SCHED_RR
 2

	)

38 
	#SCHED_BATCH
 3

	)

40 
	#SCHED_IDLE
 5

	)

42 
	#SCHED_RESET_ON_FORK
 0x40000000

	)

	@/usr/include/linux/string.h

1 #i‚de‡
_LINUX_STRING_H_


2 
	#_LINUX_STRING_H_


	)

6 
	~<°rög.h
>

	@/usr/include/linux/unistd.h

1 #i‚de‡
_LINUX_UNISTD_H_


2 
	#_LINUX_UNISTD_H_


	)

7 
	~<asm/uni°d.h
>

	@/usr/include/linux/version.h

1 
	#LINUX_VERSION_CODE
 132640

	)

2 
	#KERNEL_VERSION
(
a
,
b
,
c
Ë((◊Ë<< 16Ë+ ((bË<< 8Ë+ (c))

	)

	@/usr/include/linux/wireless.h

10 #i‚de‡
_LINUX_WIRELESS_H


11 
	#_LINUX_WIRELESS_H


	)

72 
	~<löux/ty≥s.h
>

73 
	~<löux/sockë.h
>

74 
	~<löux/if.h
>

83 
	#WIRELESS_EXT
 22

	)

230 
	#SIOCSIWCOMMIT
 0x8B00

	)

231 
	#SIOCGIWNAME
 0x8B01

	)

237 
	#SIOCSIWNWID
 0x8B02

	)

238 
	#SIOCGIWNWID
 0x8B03

	)

239 
	#SIOCSIWFREQ
 0x8B04

	)

240 
	#SIOCGIWFREQ
 0x8B05

	)

241 
	#SIOCSIWMODE
 0x8B06

	)

242 
	#SIOCGIWMODE
 0x8B07

	)

243 
	#SIOCSIWSENS
 0x8B08

	)

244 
	#SIOCGIWSENS
 0x8B09

	)

247 
	#SIOCSIWRANGE
 0x8B0A

	)

248 
	#SIOCGIWRANGE
 0x8B0B

	)

249 
	#SIOCSIWPRIV
 0x8B0C

	)

250 
	#SIOCGIWPRIV
 0x8B0D

	)

251 
	#SIOCSIWSTATS
 0x8B0E

	)

252 
	#SIOCGIWSTATS
 0x8B0F

	)

257 
	#SIOCSIWSPY
 0x8B10

	)

258 
	#SIOCGIWSPY
 0x8B11

	)

259 
	#SIOCSIWTHRSPY
 0x8B12

	)

260 
	#SIOCGIWTHRSPY
 0x8B13

	)

263 
	#SIOCSIWAP
 0x8B14

	)

264 
	#SIOCGIWAP
 0x8B15

	)

265 
	#SIOCGIWAPLIST
 0x8B17

	)

266 
	#SIOCSIWSCAN
 0x8B18

	)

267 
	#SIOCGIWSCAN
 0x8B19

	)

270 
	#SIOCSIWESSID
 0x8B1A

	)

271 
	#SIOCGIWESSID
 0x8B1B

	)

272 
	#SIOCSIWNICKN
 0x8B1C

	)

273 
	#SIOCGIWNICKN
 0x8B1D

	)

279 
	#SIOCSIWRATE
 0x8B20

	)

280 
	#SIOCGIWRATE
 0x8B21

	)

281 
	#SIOCSIWRTS
 0x8B22

	)

282 
	#SIOCGIWRTS
 0x8B23

	)

283 
	#SIOCSIWFRAG
 0x8B24

	)

284 
	#SIOCGIWFRAG
 0x8B25

	)

285 
	#SIOCSIWTXPOW
 0x8B26

	)

286 
	#SIOCGIWTXPOW
 0x8B27

	)

287 
	#SIOCSIWRETRY
 0x8B28

	)

288 
	#SIOCGIWRETRY
 0x8B29

	)

291 
	#SIOCSIWENCODE
 0x8B2A

	)

292 
	#SIOCGIWENCODE
 0x8B2B

	)

294 
	#SIOCSIWPOWER
 0x8B2C

	)

295 
	#SIOCGIWPOWER
 0x8B2D

	)

304 
	#SIOCSIWGENIE
 0x8B30

	)

305 
	#SIOCGIWGENIE
 0x8B31

	)

308 
	#SIOCSIWMLME
 0x8B16

	)

311 
	#SIOCSIWAUTH
 0x8B32

	)

312 
	#SIOCGIWAUTH
 0x8B33

	)

315 
	#SIOCSIWENCODEEXT
 0x8B34

	)

316 
	#SIOCGIWENCODEEXT
 0x8B35

	)

319 
	#SIOCSIWPMKSA
 0x8B36

	)

330 
	#SIOCIWFIRSTPRIV
 0x8BE0

	)

331 
	#SIOCIWLASTPRIV
 0x8BFF

	)

346 
	#SIOCIWFIRST
 0x8B00

	)

347 
	#SIOCIWLAST
 
SIOCIWLASTPRIV


	)

348 
	#IW_IOCTL_IDX
(
cmd
Ë((cmdË- 
SIOCIWFIRST
)

	)

351 
	#IW_IS_SET
(
cmd
Ë(!((cmdË& 0x1))

	)

352 
	#IW_IS_GET
(
cmd
Ë((cmdË& 0x1)

	)

358 
	#IWEVTXDROP
 0x8C00

	)

359 
	#IWEVQUAL
 0x8C01

	)

360 
	#IWEVCUSTOM
 0x8C02

	)

361 
	#IWEVREGISTERED
 0x8C03

	)

362 
	#IWEVEXPIRED
 0x8C04

	)

363 
	#IWEVGENIE
 0x8C05

	)

369 
	#IWEVMICHAELMICFAILURE
 0x8C06

	)

372 
	#IWEVASSOCREQIE
 0x8C07

	)

381 
	#IWEVASSOCRESPIE
 0x8C08

	)

388 
	#IWEVPMKIDCAND
 0x8C09

	)

392 
	#IWEVFIRST
 0x8C00

	)

393 
	#IW_EVENT_IDX
(
cmd
Ë((cmdË- 
IWEVFIRST
)

	)

402 
	#IW_PRIV_TYPE_MASK
 0x7000

	)

403 
	#IW_PRIV_TYPE_NONE
 0x0000

	)

404 
	#IW_PRIV_TYPE_BYTE
 0x1000

	)

405 
	#IW_PRIV_TYPE_CHAR
 0x2000

	)

406 
	#IW_PRIV_TYPE_INT
 0x4000

	)

407 
	#IW_PRIV_TYPE_FLOAT
 0x5000

	)

408 
	#IW_PRIV_TYPE_ADDR
 0x6000

	)

410 
	#IW_PRIV_SIZE_FIXED
 0x0800

	)

412 
	#IW_PRIV_SIZE_MASK
 0x07FF

	)

422 
	#IW_MAX_FREQUENCIES
 32

	)

428 
	#IW_MAX_BITRATES
 32

	)

431 
	#IW_MAX_TXPOWER
 8

	)

436 
	#IW_MAX_SPY
 8

	)

440 
	#IW_MAX_AP
 64

	)

443 
	#IW_ESSID_MAX_SIZE
 32

	)

446 
	#IW_MODE_AUTO
 0

	)

447 
	#IW_MODE_ADHOC
 1

	)

448 
	#IW_MODE_INFRA
 2

	)

449 
	#IW_MODE_MASTER
 3

	)

450 
	#IW_MODE_REPEAT
 4

	)

451 
	#IW_MODE_SECOND
 5

	)

452 
	#IW_MODE_MONITOR
 6

	)

453 
	#IW_MODE_MESH
 7

	)

456 
	#IW_QUAL_QUAL_UPDATED
 0x01

	)

457 
	#IW_QUAL_LEVEL_UPDATED
 0x02

	)

458 
	#IW_QUAL_NOISE_UPDATED
 0x04

	)

459 
	#IW_QUAL_ALL_UPDATED
 0x07

	)

460 
	#IW_QUAL_DBM
 0x08

	)

461 
	#IW_QUAL_QUAL_INVALID
 0x10

	)

462 
	#IW_QUAL_LEVEL_INVALID
 0x20

	)

463 
	#IW_QUAL_NOISE_INVALID
 0x40

	)

464 
	#IW_QUAL_RCPI
 0x80

	)

465 
	#IW_QUAL_ALL_INVALID
 0x70

	)

468 
	#IW_FREQ_AUTO
 0x00

	)

469 
	#IW_FREQ_FIXED
 0x01

	)

473 
	#IW_MAX_ENCODING_SIZES
 8

	)

476 
	#IW_ENCODING_TOKEN_MAX
 64

	)

479 
	#IW_ENCODE_INDEX
 0x00FF

	)

480 
	#IW_ENCODE_FLAGS
 0xFF00

	)

481 
	#IW_ENCODE_MODE
 0xF000

	)

482 
	#IW_ENCODE_DISABLED
 0x8000

	)

483 
	#IW_ENCODE_ENABLED
 0x0000

	)

484 
	#IW_ENCODE_RESTRICTED
 0x4000

	)

485 
	#IW_ENCODE_OPEN
 0x2000

	)

486 
	#IW_ENCODE_NOKEY
 0x0800

	)

487 
	#IW_ENCODE_TEMP
 0x0400

	)

490 
	#IW_POWER_ON
 0x0000

	)

491 
	#IW_POWER_TYPE
 0xF000

	)

492 
	#IW_POWER_PERIOD
 0x1000

	)

493 
	#IW_POWER_TIMEOUT
 0x2000

	)

494 
	#IW_POWER_MODE
 0x0F00

	)

495 
	#IW_POWER_UNICAST_R
 0x0100

	)

496 
	#IW_POWER_MULTICAST_R
 0x0200

	)

497 
	#IW_POWER_ALL_R
 0x0300

	)

498 
	#IW_POWER_FORCE_S
 0x0400

	)

499 
	#IW_POWER_REPEATER
 0x0800

	)

500 
	#IW_POWER_MODIFIER
 0x000F

	)

501 
	#IW_POWER_MIN
 0x0001

	)

502 
	#IW_POWER_MAX
 0x0002

	)

503 
	#IW_POWER_RELATIVE
 0x0004

	)

506 
	#IW_TXPOW_TYPE
 0x00FF

	)

507 
	#IW_TXPOW_DBM
 0x0000

	)

508 
	#IW_TXPOW_MWATT
 0x0001

	)

509 
	#IW_TXPOW_RELATIVE
 0x0002

	)

510 
	#IW_TXPOW_RANGE
 0x1000

	)

513 
	#IW_RETRY_ON
 0x0000

	)

514 
	#IW_RETRY_TYPE
 0xF000

	)

515 
	#IW_RETRY_LIMIT
 0x1000

	)

516 
	#IW_RETRY_LIFETIME
 0x2000

	)

517 
	#IW_RETRY_MODIFIER
 0x00FF

	)

518 
	#IW_RETRY_MIN
 0x0001

	)

519 
	#IW_RETRY_MAX
 0x0002

	)

520 
	#IW_RETRY_RELATIVE
 0x0004

	)

521 
	#IW_RETRY_SHORT
 0x0010

	)

522 
	#IW_RETRY_LONG
 0x0020

	)

525 
	#IW_SCAN_DEFAULT
 0x0000

	)

526 
	#IW_SCAN_ALL_ESSID
 0x0001

	)

527 
	#IW_SCAN_THIS_ESSID
 0x0002

	)

528 
	#IW_SCAN_ALL_FREQ
 0x0004

	)

529 
	#IW_SCAN_THIS_FREQ
 0x0008

	)

530 
	#IW_SCAN_ALL_MODE
 0x0010

	)

531 
	#IW_SCAN_THIS_MODE
 0x0020

	)

532 
	#IW_SCAN_ALL_RATE
 0x0040

	)

533 
	#IW_SCAN_THIS_RATE
 0x0080

	)

535 
	#IW_SCAN_TYPE_ACTIVE
 0

	)

536 
	#IW_SCAN_TYPE_PASSIVE
 1

	)

538 
	#IW_SCAN_MAX_DATA
 4096

	)

541 
	#IW_SCAN_CAPA_NONE
 0x00

	)

542 
	#IW_SCAN_CAPA_ESSID
 0x01

	)

543 
	#IW_SCAN_CAPA_BSSID
 0x02

	)

544 
	#IW_SCAN_CAPA_CHANNEL
 0x04

	)

545 
	#IW_SCAN_CAPA_MODE
 0x08

	)

546 
	#IW_SCAN_CAPA_RATE
 0x10

	)

547 
	#IW_SCAN_CAPA_TYPE
 0x20

	)

548 
	#IW_SCAN_CAPA_TIME
 0x40

	)

551 
	#IW_CUSTOM_MAX
 256

	)

554 
	#IW_GENERIC_IE_MAX
 1024

	)

557 
	#IW_MLME_DEAUTH
 0

	)

558 
	#IW_MLME_DISASSOC
 1

	)

559 
	#IW_MLME_AUTH
 2

	)

560 
	#IW_MLME_ASSOC
 3

	)

563 
	#IW_AUTH_INDEX
 0x0FFF

	)

564 
	#IW_AUTH_FLAGS
 0xF000

	)

569 
	#IW_AUTH_WPA_VERSION
 0

	)

570 
	#IW_AUTH_CIPHER_PAIRWISE
 1

	)

571 
	#IW_AUTH_CIPHER_GROUP
 2

	)

572 
	#IW_AUTH_KEY_MGMT
 3

	)

573 
	#IW_AUTH_TKIP_COUNTERMEASURES
 4

	)

574 
	#IW_AUTH_DROP_UNENCRYPTED
 5

	)

575 
	#IW_AUTH_80211_AUTH_ALG
 6

	)

576 
	#IW_AUTH_WPA_ENABLED
 7

	)

577 
	#IW_AUTH_RX_UNENCRYPTED_EAPOL
 8

	)

578 
	#IW_AUTH_ROAMING_CONTROL
 9

	)

579 
	#IW_AUTH_PRIVACY_INVOKED
 10

	)

580 
	#IW_AUTH_CIPHER_GROUP_MGMT
 11

	)

581 
	#IW_AUTH_MFP
 12

	)

584 
	#IW_AUTH_WPA_VERSION_DISABLED
 0x00000001

	)

585 
	#IW_AUTH_WPA_VERSION_WPA
 0x00000002

	)

586 
	#IW_AUTH_WPA_VERSION_WPA2
 0x00000004

	)

590 
	#IW_AUTH_CIPHER_NONE
 0x00000001

	)

591 
	#IW_AUTH_CIPHER_WEP40
 0x00000002

	)

592 
	#IW_AUTH_CIPHER_TKIP
 0x00000004

	)

593 
	#IW_AUTH_CIPHER_CCMP
 0x00000008

	)

594 
	#IW_AUTH_CIPHER_WEP104
 0x00000010

	)

595 
	#IW_AUTH_CIPHER_AES_CMAC
 0x00000020

	)

598 
	#IW_AUTH_KEY_MGMT_802_1X
 1

	)

599 
	#IW_AUTH_KEY_MGMT_PSK
 2

	)

602 
	#IW_AUTH_ALG_OPEN_SYSTEM
 0x00000001

	)

603 
	#IW_AUTH_ALG_SHARED_KEY
 0x00000002

	)

604 
	#IW_AUTH_ALG_LEAP
 0x00000004

	)

607 
	#IW_AUTH_ROAMING_ENABLE
 0

	)

608 
	#IW_AUTH_ROAMING_DISABLE
 1

	)

612 
	#IW_AUTH_MFP_DISABLED
 0

	)

613 
	#IW_AUTH_MFP_OPTIONAL
 1

	)

614 
	#IW_AUTH_MFP_REQUIRED
 2

	)

617 
	#IW_ENCODE_SEQ_MAX_SIZE
 8

	)

619 
	#IW_ENCODE_ALG_NONE
 0

	)

620 
	#IW_ENCODE_ALG_WEP
 1

	)

621 
	#IW_ENCODE_ALG_TKIP
 2

	)

622 
	#IW_ENCODE_ALG_CCMP
 3

	)

623 
	#IW_ENCODE_ALG_PMK
 4

	)

624 
	#IW_ENCODE_ALG_AES_CMAC
 5

	)

626 
	#IW_ENCODE_EXT_TX_SEQ_VALID
 0x00000001

	)

627 
	#IW_ENCODE_EXT_RX_SEQ_VALID
 0x00000002

	)

628 
	#IW_ENCODE_EXT_GROUP_KEY
 0x00000004

	)

629 
	#IW_ENCODE_EXT_SET_TX_KEY
 0x00000008

	)

632 
	#IW_MICFAILURE_KEY_ID
 0x00000003

	)

633 
	#IW_MICFAILURE_GROUP
 0x00000004

	)

634 
	#IW_MICFAILURE_PAIRWISE
 0x00000008

	)

635 
	#IW_MICFAILURE_STAKEY
 0x00000010

	)

636 
	#IW_MICFAILURE_COUNT
 0x00000060

	)

640 
	#IW_ENC_CAPA_WPA
 0x00000001

	)

641 
	#IW_ENC_CAPA_WPA2
 0x00000002

	)

642 
	#IW_ENC_CAPA_CIPHER_TKIP
 0x00000004

	)

643 
	#IW_ENC_CAPA_CIPHER_CCMP
 0x00000008

	)

644 
	#IW_ENC_CAPA_4WAY_HANDSHAKE
 0x00000010

	)

649 
	#IW_EVENT_CAPA_BASE
(
cmd
Ë((cmd >
SIOCIWFIRSTPRIV
) ? \

650 (
cmd
 - 
SIOCIWFIRSTPRIV
 + 0x60) : \

651 (
cmd
 - 
SIOCSIWCOMMIT
))

	)

652 
	#IW_EVENT_CAPA_INDEX
(
cmd
Ë(
	`IW_EVENT_CAPA_BASE
(cmdË>> 5)

	)

653 
	#IW_EVENT_CAPA_MASK
(
cmd
Ë(1 << (
	`IW_EVENT_CAPA_BASE
(cmdË& 0x1F))

	)

656 
	#IW_EVENT_CAPA_K_0
 (
	`IW_EVENT_CAPA_MASK
(0x8B04) | \

657 
	`IW_EVENT_CAPA_MASK
(0x8B06) | \

658 
	`IW_EVENT_CAPA_MASK
(0x8B1A))

	)

659 
	#IW_EVENT_CAPA_K_1
 (
	`IW_EVENT_CAPA_MASK
(0x8B2A))

	)

661 
	#IW_EVENT_CAPA_SET
(
evít_ˇ∑
, 
cmd
Ë”vít_ˇ∑[
	`IW_EVENT_CAPA_INDEX
(cmd)] |
	`IW_EVENT_CAPA_MASK
(cmd))

	)

662 
	#IW_EVENT_CAPA_SET_KERNEL
(
evít_ˇ∑
Ë{evít_ˇ∑[0] |
IW_EVENT_CAPA_K_0
;Évít_ˇ∑[1] |
IW_EVENT_CAPA_K_1
; }

	)

671 
	siw_∑øm


673 
__s32
 
	mvÆue
;

674 
__u8
 
	mfixed
;

675 
__u8
 
	mdißbÀd
;

676 
__u16
 
	mÊags
;

683 
	siw_poöt


685 *
	mpoöãr
;

686 
__u16
 
	mÀngth
;

687 
__u16
 
	mÊags
;

699 
	siw_‰eq


701 
__s32
 
	mm
;

702 
__s16
 
	me
;

703 
__u8
 
	mi
;

704 
__u8
 
	mÊags
;

710 
	siw_quÆôy


712 
__u8
 
	mquÆ
;

714 
__u8
 
	mÀvñ
;

715 
__u8
 
	mnoi£
;

716 
__u8
 
	mupd©ed
;

726 
	siw_disˇrded


728 
__u32
 
	mnwid
;

729 
__u32
 
	mcode
;

730 
__u32
 
	m‰agmít
;

731 
__u32
 
	mªåõs
;

732 
__u32
 
	mmisc
;

739 
	siw_mis£d


741 
__u32
 
	mbóc⁄
;

747 
	siw_thr•y


749 
sockaddr
 
	maddr
;

750 
iw_quÆôy
 
	mquÆ
;

751 
iw_quÆôy
 
	mlow
;

752 
iw_quÆôy
 
	mhigh
;

766 
	siw_sˇn_ªq


768 
__u8
 
	msˇn_ty≥
;

769 
__u8
 
	messid_Àn
;

770 
__u8
 
	mnum_ch™√ls
;

772 
__u8
 
	mÊags
;

775 
sockaddr
 
	mbssid
;

784 
__u8
 
	messid
[
IW_ESSID_MAX_SIZE
];

796 
__u32
 
	mmö_ch™√l_time
;

797 
__u32
 
	mmax_ch™√l_time
;

799 
iw_‰eq
 
	mch™√l_li°
[
IW_MAX_FREQUENCIES
];

828 
	siw_ícode_ext


830 
__u32
 
	mext_Êags
;

831 
__u8
 
	mtx_£q
[
IW_ENCODE_SEQ_MAX_SIZE
];

832 
__u8
 
	mrx_£q
[
IW_ENCODE_SEQ_MAX_SIZE
];

833 
sockaddr
 
	maddr
;

836 
__u16
 
	mÆg
;

837 
__u16
 
	mkey_Àn
;

838 
__u8
 
	mkey
[0];

842 
	siw_mlme


844 
__u16
 
	mcmd
;

845 
__u16
 
	mªas⁄_code
;

846 
sockaddr
 
	maddr
;

850 
	#IW_PMKSA_ADD
 1

	)

851 
	#IW_PMKSA_REMOVE
 2

	)

852 
	#IW_PMKSA_FLUSH
 3

	)

854 
	#IW_PMKID_LEN
 16

	)

856 
	siw_pmkß


858 
__u32
 
	mcmd
;

859 
sockaddr
 
	mbssid
;

860 
__u8
 
	mpmkid
[
IW_PMKID_LEN
];

864 
	siw_mich´lmicÁûuª


866 
__u32
 
	mÊags
;

867 
sockaddr
 
	m§c_addr
;

868 
__u8
 
	mtsc
[
IW_ENCODE_SEQ_MAX_SIZE
];

872 
	#IW_PMKID_CAND_PREAUTH
 0x00000001

	)

873 
	siw_pmkid_ˇnd


875 
__u32
 
	mÊags
;

876 
__u32
 
	mödex
;

878 
sockaddr
 
	mbssid
;

885 
	siw_°©i°ics


887 
__u16
 
	m°©us
;

890 
iw_quÆôy
 
	mquÆ
;

892 
iw_disˇrded
 
	mdisˇrd
;

893 
iw_mis£d
 
	mmiss
;

907 
	uiwªq_d©a


910 
	m«me
[
IFNAMSIZ
];

914 
iw_poöt
 
	messid
;

915 
iw_∑øm
 
	mnwid
;

916 
iw_‰eq
 
	m‰eq
;

920 
iw_∑øm
 
	m£ns
;

921 
iw_∑øm
 
	mbôøã
;

922 
iw_∑øm
 
	mtxpowî
;

923 
iw_∑øm
 
	mπs
;

924 
iw_∑øm
 
	m‰ag
;

925 
__u32
 
	mmode
;

926 
iw_∑øm
 
	mªåy
;

928 
iw_poöt
 
	mícodög
;

929 
iw_∑øm
 
	mpowî
;

930 
iw_quÆôy
 
	mquÆ
;

932 
sockaddr
 
	m≠_addr
;

933 
sockaddr
 
	maddr
;

935 
iw_∑øm
 
	m∑øm
;

936 
iw_poöt
 
	md©a
;

945 
	siwªq


949 
	mi‰n_«me
[
IFNAMSIZ
];

950 } 
	mi‰_i‰n
;

953 
iwªq_d©a
 
	mu
;

966 
	siw_ønge


969 
__u32
 
	mthroughput
;

978 
__u32
 
	mmö_nwid
;

979 
__u32
 
	mmax_nwid
;

982 
__u16
 
	mﬁd_num_ch™√ls
;

983 
__u8
 
	mﬁd_num_‰equícy
;

986 
__u8
 
	msˇn_ˇ∑
;

989 
__u32
 
	mevít_ˇ∑
[6];

992 
__s32
 
	m£nsôivôy
;

999 
iw_quÆôy
 
	mmax_quÆ
;

1009 
iw_quÆôy
 
	mavg_quÆ
;

1012 
__u8
 
	mnum_bôøãs
;

1013 
__s32
 
	mbôøã
[
IW_MAX_BITRATES
];

1016 
__s32
 
	mmö_πs
;

1017 
__s32
 
	mmax_πs
;

1020 
__s32
 
	mmö_‰ag
;

1021 
__s32
 
	mmax_‰ag
;

1024 
__s32
 
	mmö_pmp
;

1025 
__s32
 
	mmax_pmp
;

1026 
__s32
 
	mmö_pmt
;

1027 
__s32
 
	mmax_pmt
;

1028 
__u16
 
	mpmp_Êags
;

1029 
__u16
 
	mpmt_Êags
;

1030 
__u16
 
	mpm_ˇ∑
;

1033 
__u16
 
	mícodög_size
[
IW_MAX_ENCODING_SIZES
];

1034 
__u8
 
	mnum_ícodög_sizes
;

1035 
__u8
 
	mmax_ícodög_tokís
;

1037 
__u8
 
	mícodög_logö_ödex
;

1040 
__u16
 
	mtxpowî_ˇ∑
;

1041 
__u8
 
	mnum_txpowî
;

1042 
__s32
 
	mtxpowî
[
IW_MAX_TXPOWER
];

1045 
__u8
 
	mwe_vîsi⁄_compûed
;

1046 
__u8
 
	mwe_vîsi⁄_sour˚
;

1049 
__u16
 
	mªåy_ˇ∑
;

1050 
__u16
 
	mªåy_Êags
;

1051 
__u16
 
	mr_time_Êags
;

1052 
__s32
 
	mmö_ªåy
;

1053 
__s32
 
	mmax_ªåy
;

1054 
__s32
 
	mmö_r_time
;

1055 
__s32
 
	mmax_r_time
;

1058 
__u16
 
	mnum_ch™√ls
;

1059 
__u8
 
	mnum_‰equícy
;

1060 
iw_‰eq
 
	m‰eq
[
IW_MAX_FREQUENCIES
];

1064 
__u32
 
	míc_ˇ∑
;

1071 
	siw_¥iv_¨gs


1073 
__u32
 
	mcmd
;

1074 
__u16
 
	m£t_¨gs
;

1075 
__u16
 
	mgë_¨gs
;

1076 
	m«me
[
IFNAMSIZ
];

1089 
	siw_evít


1091 
__u16
 
	mÀn
;

1092 
__u16
 
	mcmd
;

1093 
iwªq_d©a
 
	mu
;

1097 
	#IW_EV_LCP_LEN
 ((
iw_evít
Ë- (
iwªq_d©a
))

	)

1099 
	#IW_EV_CHAR_LEN
 (
IW_EV_LCP_LEN
 + 
IFNAMSIZ
)

	)

1100 
	#IW_EV_UINT_LEN
 (
IW_EV_LCP_LEN
 + (
__u32
))

	)

1101 
	#IW_EV_FREQ_LEN
 (
IW_EV_LCP_LEN
 + (
iw_‰eq
))

	)

1102 
	#IW_EV_PARAM_LEN
 (
IW_EV_LCP_LEN
 + (
iw_∑øm
))

	)

1103 
	#IW_EV_ADDR_LEN
 (
IW_EV_LCP_LEN
 + (
sockaddr
))

	)

1104 
	#IW_EV_QUAL_LEN
 (
IW_EV_LCP_LEN
 + (
iw_quÆôy
))

	)

1109 
	#IW_EV_POINT_OFF
 (((*Ë&(((
iw_poöt
 *Ë
NULL
)->
Àngth
)) - \

1110 (*Ë
NULL
)

	)

1111 
	#IW_EV_POINT_LEN
 (
IW_EV_LCP_LEN
 + (
iw_poöt
) - \

1112 
IW_EV_POINT_OFF
)

	)

1116 
	#IW_EV_LCP_PK_LEN
 (4)

	)

1118 
	#IW_EV_CHAR_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + 
IFNAMSIZ
)

	)

1119 
	#IW_EV_UINT_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
__u32
))

	)

1120 
	#IW_EV_FREQ_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_‰eq
))

	)

1121 
	#IW_EV_PARAM_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_∑øm
))

	)

1122 
	#IW_EV_ADDR_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
sockaddr
))

	)

1123 
	#IW_EV_QUAL_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_quÆôy
))

	)

1124 
	#IW_EV_POINT_PK_LEN
 (
IW_EV_LCP_LEN
 + 4)

	)

	@/usr/include/stdio.h

24 #i‚de‡
_STDIO_H


26 #i‡!
deföed
 
__√ed_FILE
 && !deföed 
__√ed___FILE


27 
	#_STDIO_H
 1

	)

28 
	~<„©uªs.h
>

30 
	g__BEGIN_DECLS


32 
	#__√ed_size_t


	)

33 
	#__√ed_NULL


	)

34 
	~<°ddef.h
>

36 
	~<bôs/ty≥s.h
>

37 
	#__√ed_FILE


	)

38 
	#__√ed___FILE


	)

42 #i‡!
deföed
 
__FILE_deföed
 && deföed 
__√ed_FILE


45 
	g_IO_FILE
;

47 
__BEGIN_NAMESPACE_STD


49 
_IO_FILE
 
	tFILE
;

50 
	g__END_NAMESPACE_STD


51 #i‡
deföed
 
__USE_LARGEFILE64
 || deföed 
__USE_SVID
 || deföed 
__USE_POSIX
 \

52 || 
deföed
 
	g__USE_BSD
 || deföed 
	g__USE_ISOC99
 || deföed 
	g__USE_XOPEN
 \

53 || 
deföed
 
__USE_POSIX2


54 
	$__USING_NAMESPACE_STD
(
FILE
)

57 
	#__FILE_deföed
 1

	)

59 #unde‡
__√ed_FILE


62 #i‡!
deföed
 
____FILE_deföed
 && deföed 
__√ed___FILE


65 
_IO_FILE
 
	t__FILE
;

67 
	#____FILE_deföed
 1

	)

69 #unde‡
__√ed___FILE


72 #ifdef 
_STDIO_H


73 
	#_STDIO_USES_IOSTREAM


	)

75 
	~<libio.h
>

77 #ifde‡
__USE_XOPEN


78 #ifde‡
__GNUC__


79 #i‚de‡
_VA_LIST_DEFINED


80 
_G_va_li°
 
	tva_li°
;

81 
	#_VA_LIST_DEFINED


	)

84 
	~<°d¨g.h
>

89 
__BEGIN_NAMESPACE_STD


90 #i‚de‡
__USE_FILE_OFFSET64


91 
_G_Âos_t
 
	tÂos_t
;

93 
_G_Âos64_t
 
	tÂos_t
;

95 
__END_NAMESPACE_STD


96 #ifde‡
__USE_LARGEFILE64


97 
_G_Âos64_t
 
	tÂos64_t
;

101 
	#_IOFBF
 0

	)

102 
	#_IOLBF
 1

	)

103 
	#_IONBF
 2

	)

107 #i‚de‡
BUFSIZ


108 
	#BUFSIZ
 
_IO_BUFSIZ


	)

114 #i‚de‡
EOF


115 
	#EOF
 (-1)

	)

121 
	#SEEK_SET
 0

	)

122 
	#SEEK_CUR
 1

	)

123 
	#SEEK_END
 2

	)

126 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


128 
	#P_tmpdú
 "/tmp"

	)

141 
	~<bôs/°dio_lim.h
>

145 
_IO_FILE
 *
°dö
;

146 
_IO_FILE
 *
°dout
;

147 
_IO_FILE
 *
°dîr
;

149 
	#°dö
 
°dö


	)

150 
	#°dout
 
°dout


	)

151 
	#°dîr
 
°dîr


	)

153 
__BEGIN_NAMESPACE_STD


155 
	$ªmove
 (
__c⁄°
 *
__fûíame
Ë
__THROW
;

157 
	$ª«me
 (
__c⁄°
 *
__ﬁd
, __c⁄° *
__√w
Ë
__THROW
;

158 
__END_NAMESPACE_STD


160 #ifde‡
__USE_ATFILE


162 
	$ª«mót
 (
__ﬁdfd
, 
__c⁄°
 *
__ﬁd
, 
__√wfd
,

163 
__c⁄°
 *
__√w
Ë
__THROW
;

166 
__BEGIN_NAMESPACE_STD


171 #i‚de‡
__USE_FILE_OFFSET64


172 
FILE
 *
	$tmpfûe
 (Ë
__wur
;

174 #ifde‡
__REDIRECT


175 
FILE
 *
	`__REDIRECT
 (
tmpfûe
, (), 
tmpfûe64
Ë
__wur
;

177 
	#tmpfûe
 
tmpfûe64


	)

181 #ifde‡
__USE_LARGEFILE64


182 
FILE
 *
	$tmpfûe64
 (Ë
__wur
;

186 *
	$tm≤am
 (*
__s
Ë
__THROW
 
__wur
;

187 
__END_NAMESPACE_STD


189 #ifde‡
__USE_MISC


192 *
	$tm≤am_r
 (*
__s
Ë
__THROW
 
__wur
;

196 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


204 *
	$ãm≤am
 (
__c⁄°
 *
__dú
, __c⁄° *
__pfx
)

205 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

209 
__BEGIN_NAMESPACE_STD


214 
	`f˛o£
 (
FILE
 *
__°ªam
);

219 
	`fÊush
 (
FILE
 *
__°ªam
);

220 
__END_NAMESPACE_STD


222 #ifde‡
__USE_MISC


229 
	`fÊush_u∆ocked
 (
FILE
 *
__°ªam
);

232 #ifde‡
__USE_GNU


239 
	`f˛o£Æl
 ();

243 
__BEGIN_NAMESPACE_STD


244 #i‚de‡
__USE_FILE_OFFSET64


249 
FILE
 *
	$f›í
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

250 
__c⁄°
 *
__ª°ri˘
 
__modes
Ë
__wur
;

255 
FILE
 *
	$‰e›í
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

256 
__c⁄°
 *
__ª°ri˘
 
__modes
,

257 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

259 #ifde‡
__REDIRECT


260 
FILE
 *
	`__REDIRECT
 (
f›í
, (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

261 
__c⁄°
 *
__ª°ri˘
 
__modes
), 
f›í64
)

262 
__wur
;

263 
FILE
 *
	`__REDIRECT
 (
‰e›í
, (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

264 
__c⁄°
 *
__ª°ri˘
 
__modes
,

265 
FILE
 *
__ª°ri˘
 
__°ªam
), 
‰e›í64
)

266 
__wur
;

268 
	#f›í
 
f›í64


	)

269 
	#‰e›í
 
‰e›í64


	)

272 
__END_NAMESPACE_STD


273 #ifde‡
__USE_LARGEFILE64


274 
FILE
 *
	$f›í64
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

275 
__c⁄°
 *
__ª°ri˘
 
__modes
Ë
__wur
;

276 
FILE
 *
	$‰e›í64
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

277 
__c⁄°
 *
__ª°ri˘
 
__modes
,

278 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

281 #ifdef 
__USE_POSIX


283 
FILE
 *
	$fd›í
 (
__fd
, 
__c⁄°
 *
__modes
Ë
__THROW
 
__wur
;

286 #ifdef 
__USE_GNU


289 
FILE
 *
	$f›ícookõ
 (*
__ª°ri˘
 
__magic_cookõ
,

290 
__c⁄°
 *
__ª°ri˘
 
__modes
,

291 
_IO_cookõ_io_fun˘i⁄s_t
 
__io_funcs
Ë
__THROW
 
__wur
;

294 #ifde‡
__USE_XOPEN2K8


296 
FILE
 *
	$fmem›í
 (*
__s
, 
size_t
 
__Àn
, 
__c⁄°
 *
__modes
)

297 
__THROW
 
__wur
;

302 
FILE
 *
	$›í_mem°ªam
 (**
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
 
__wur
;

306 
__BEGIN_NAMESPACE_STD


309 
	$£tbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
Ë
__THROW
;

313 
	$£tvbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

314 
__modes
, 
size_t
 
__n
Ë
__THROW
;

315 
__END_NAMESPACE_STD


317 #ifdef 
__USE_BSD


320 
	$£tbuf„r
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

321 
size_t
 
__size
Ë
__THROW
;

324 
	$£éöebuf
 (
FILE
 *
__°ªam
Ë
__THROW
;

328 
__BEGIN_NAMESPACE_STD


333 
	`Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

334 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...);

339 
	`¥ötf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...);

341 
	$•rötf
 (*
__ª°ri˘
 
__s
,

342 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

348 
	`vÂrötf
 (
FILE
 *
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__f‹m©
,

349 
_G_va_li°
 
__¨g
);

354 
	`v¥ötf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
);

356 
	$v•rötf
 (*
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__f‹m©
,

357 
_G_va_li°
 
__¨g
Ë
__THROW
;

358 
__END_NAMESPACE_STD


360 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


361 
__BEGIN_NAMESPACE_C99


363 
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

364 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...)

365 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

367 
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

368 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

369 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

370 
__END_NAMESPACE_C99


373 #ifde‡
__USE_GNU


376 
	$va•rötf
 (**
__ª°ri˘
 
__±r
, 
__c⁄°
 *__ª°ri˘ 
__f
,

377 
_G_va_li°
 
__¨g
)

378 
__THROW
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 0))Ë
__wur
;

379 
	$__a•rötf
 (**
__ª°ri˘
 
__±r
,

380 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

381 
__THROW
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

382 
	$a•rötf
 (**
__ª°ri˘
 
__±r
,

383 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

384 
__THROW
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

387 #ifde‡
__USE_XOPEN2K8


394 
	$vd¥ötf
 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__fmt
,

395 
_G_va_li°
 
__¨g
)

396 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

397 
	$d¥ötf
 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

398 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

402 
__BEGIN_NAMESPACE_STD


407 
	$fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

408 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

413 
	$sˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

415 
	$ssˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

416 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

418 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

419 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

420 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

421 #ifde‡
__REDIRECT


425 
	`__REDIRECT
 (
fsˇnf
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

426 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...),

427 
__isoc99_fsˇnf
Ë
__wur
;

428 
	`__REDIRECT
 (
sˇnf
, (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...),

429 
__isoc99_sˇnf
Ë
__wur
;

430 
	`__REDIRECT
 (
ssˇnf
, (
__c⁄°
 *
__ª°ri˘
 
__s
,

431 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...),

432 
__isoc99_ssˇnf
Ë
__THROW
;

434 
	$__isoc99_fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

435 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

436 
	$__isoc99_sˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

437 
	$__isoc99_ssˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

438 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

439 
	#fsˇnf
 
__isoc99_fsˇnf


	)

440 
	#sˇnf
 
__isoc99_sˇnf


	)

441 
	#ssˇnf
 
__isoc99_ssˇnf


	)

445 
__END_NAMESPACE_STD


447 #ifdef 
__USE_ISOC99


448 
__BEGIN_NAMESPACE_C99


453 
	$vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__f‹m©
,

454 
_G_va_li°
 
__¨g
)

455 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

461 
	$vsˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

462 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

465 
	$vssˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

466 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

467 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

469 #i‡!
deföed
 
__USE_GNU
 \

470 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

471 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

472 #ifde‡
__REDIRECT


476 
	`__REDIRECT
 (
vfsˇnf
,

477 (
FILE
 *
__ª°ri˘
 
__s
,

478 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
),

479 
__isoc99_vfsˇnf
)

480 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

481 
	`__REDIRECT
 (
vsˇnf
, (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

482 
_G_va_li°
 
__¨g
), 
__isoc99_vsˇnf
)

483 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

484 
	`__REDIRECT
 (
vssˇnf
,

485 (
__c⁄°
 *
__ª°ri˘
 
__s
,

486 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
),

487 
__isoc99_vssˇnf
)

488 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

490 
	$__isoc99_vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
,

491 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

492 
_G_va_li°
 
__¨g
Ë
__wur
;

493 
	$__isoc99_vsˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

494 
_G_va_li°
 
__¨g
Ë
__wur
;

495 
	$__isoc99_vssˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

496 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

497 
_G_va_li°
 
__¨g
Ë
__THROW
;

498 
	#vfsˇnf
 
__isoc99_vfsˇnf


	)

499 
	#vsˇnf
 
__isoc99_vsˇnf


	)

500 
	#vssˇnf
 
__isoc99_vssˇnf


	)

504 
__END_NAMESPACE_C99


508 
__BEGIN_NAMESPACE_STD


513 
	`fgëc
 (
FILE
 *
__°ªam
);

514 
	`gëc
 (
FILE
 *
__°ªam
);

520 
	`gëch¨
 ();

521 
__END_NAMESPACE_STD


525 
	#gëc
(
_Â
Ë
	`_IO_gëc
 (_Â)

	)

527 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


532 
	`gëc_u∆ocked
 (
FILE
 *
__°ªam
);

533 
	`gëch¨_u∆ocked
 ();

536 #ifde‡
__USE_MISC


543 
	`fgëc_u∆ocked
 (
FILE
 *
__°ªam
);

547 
__BEGIN_NAMESPACE_STD


555 
	`Âutc
 (
__c
, 
FILE
 *
__°ªam
);

556 
	`putc
 (
__c
, 
FILE
 *
__°ªam
);

562 
	`putch¨
 (
__c
);

563 
__END_NAMESPACE_STD


567 
	#putc
(
_ch
, 
_Â
Ë
	`_IO_putc
 (_ch, _Â)

	)

569 #ifde‡
__USE_MISC


576 
	`Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

579 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


584 
	`putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

585 
	`putch¨_u∆ocked
 (
__c
);

589 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 \

590 || (
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

592 
	`gëw
 (
FILE
 *
__°ªam
);

595 
	`putw
 (
__w
, 
FILE
 *
__°ªam
);

599 
__BEGIN_NAMESPACE_STD


604 *
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

605 
__wur
;

612 *
	$gës
 (*
__s
Ë
__wur
;

613 
__END_NAMESPACE_STD


615 #ifde‡
__USE_GNU


622 *
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
,

623 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

627 #ifdef 
__USE_XOPEN2K8


638 
_IO_ssize_t
 
	$__gëdñim
 (**
__ª°ri˘
 
__löïå
,

639 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

640 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

641 
_IO_ssize_t
 
	$gëdñim
 (**
__ª°ri˘
 
__löïå
,

642 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

643 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

651 
_IO_ssize_t
 
	$gëlöe
 (**
__ª°ri˘
 
__löïå
,

652 
size_t
 *
__ª°ri˘
 
__n
,

653 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

657 
__BEGIN_NAMESPACE_STD


662 
	`Âuts
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
FILE
 *__ª°ri˘ 
__°ªam
);

668 
	`puts
 (
__c⁄°
 *
__s
);

675 
	`ungëc
 (
__c
, 
FILE
 *
__°ªam
);

682 
size_t
 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

683 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

688 
size_t
 
	`fwrôe
 (
__c⁄°
 *
__ª°ri˘
 
__±r
, size_à
__size
,

689 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__s
);

690 
__END_NAMESPACE_STD


692 #ifde‡
__USE_GNU


699 
	`Âuts_u∆ocked
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

700 
FILE
 *
__ª°ri˘
 
__°ªam
);

703 #ifde‡
__USE_MISC


710 
size_t
 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

711 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

712 
size_t
 
	`fwrôe_u∆ocked
 (
__c⁄°
 *
__ª°ri˘
 
__±r
, size_à
__size
,

713 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

717 
__BEGIN_NAMESPACE_STD


722 
	`f£ek
 (
FILE
 *
__°ªam
, 
__off
, 
__whí˚
);

727 
	$·ñl
 (
FILE
 *
__°ªam
Ë
__wur
;

732 
	`ªwöd
 (
FILE
 *
__°ªam
);

733 
__END_NAMESPACE_STD


740 #i‡
deföed
 
__USE_LARGEFILE
 || deföed 
__USE_XOPEN2K


741 #i‚de‡
__USE_FILE_OFFSET64


746 
	`f£eko
 (
FILE
 *
__°ªam
, 
__off_t
 
__off
, 
__whí˚
);

751 
__off_t
 
	$·ñlo
 (
FILE
 *
__°ªam
Ë
__wur
;

753 #ifde‡
__REDIRECT


754 
	`__REDIRECT
 (
f£eko
,

755 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
),

756 
f£eko64
);

757 
__off64_t
 
	`__REDIRECT
 (
·ñlo
, (
FILE
 *
__°ªam
), 
·ñlo64
);

759 
	#f£eko
 
f£eko64


	)

760 
	#·ñlo
 
·ñlo64


	)

765 
__BEGIN_NAMESPACE_STD


766 #i‚de‡
__USE_FILE_OFFSET64


771 
	`fgëpos
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos_t
 *__ª°ri˘ 
__pos
);

776 
	`f£ços
 (
FILE
 *
__°ªam
, 
__c⁄°
 
Âos_t
 *
__pos
);

778 #ifde‡
__REDIRECT


779 
	`__REDIRECT
 (
fgëpos
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

780 
Âos_t
 *
__ª°ri˘
 
__pos
), 
fgëpos64
);

781 
	`__REDIRECT
 (
f£ços
,

782 (
FILE
 *
__°ªam
, 
__c⁄°
 
Âos_t
 *
__pos
), 
f£ços64
);

784 
	#fgëpos
 
fgëpos64


	)

785 
	#f£ços
 
f£ços64


	)

788 
__END_NAMESPACE_STD


790 #ifde‡
__USE_LARGEFILE64


791 
	`f£eko64
 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
);

792 
__off64_t
 
	$·ñlo64
 (
FILE
 *
__°ªam
Ë
__wur
;

793 
	`fgëpos64
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos64_t
 *__ª°ri˘ 
__pos
);

794 
	`f£ços64
 (
FILE
 *
__°ªam
, 
__c⁄°
 
Âos64_t
 *
__pos
);

797 
__BEGIN_NAMESPACE_STD


799 
	$˛óªº
 (
FILE
 *
__°ªam
Ë
__THROW
;

801 
	$„of
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

803 
	$„º‹
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

804 
__END_NAMESPACE_STD


806 #ifde‡
__USE_MISC


808 
	$˛óªº_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

809 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

810 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

814 
__BEGIN_NAMESPACE_STD


819 
	`≥º‹
 (
__c⁄°
 *
__s
);

820 
__END_NAMESPACE_STD


826 
	~<bôs/sys_îæi°.h
>

829 #ifdef 
__USE_POSIX


831 
	$fûío
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

834 #ifde‡
__USE_MISC


836 
	$fûío_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

840 #i‡(
deföed
 
__USE_POSIX2
 || deföed 
__USE_SVID
 || deföed 
__USE_BSD
 || \

841 
deföed
 
__USE_MISC
)

846 
FILE
 *
	$p›í
 (
__c⁄°
 *
__comm™d
, __c⁄° *
__modes
Ë
__wur
;

852 
	`p˛o£
 (
FILE
 *
__°ªam
);

856 #ifdef 
__USE_POSIX


858 *
	$˘îmid
 (*
__s
Ë
__THROW
;

862 #ifde‡
__USE_XOPEN


864 *
	`cu£rid
 (*
__s
);

868 #ifdef 
__USE_GNU


869 
ob°ack
;

872 
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

873 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...)

874 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

875 
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

876 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

877 
_G_va_li°
 
__¨gs
)

878 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

882 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


886 
	$Êockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

890 
	$·rylockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

893 
	$fu∆ockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

896 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


900 
	#__√ed_gë›t


	)

901 
	~<gë›t.h
>

906 #ifde‡
__USE_EXTERN_INLINES


907 
	~<bôs/°dio.h
>

909 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


910 
	~<bôs/°dio2.h
>

912 #ifde‡
__LDBL_COMPAT


913 
	~<bôs/°dio-ldbl.h
>

916 
__END_DECLS


	@/usr/include/stdlib.h

23 #i‚def 
_STDLIB_H


25 
	~<„©uªs.h
>

28 
	#__√ed_size_t


	)

29 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


30 
	#__√ed_wch¨_t


	)

31 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

35 
	g__BEGIN_DECLS


37 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


38 
	#_STDLIB_H
 1

	)

40 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
_SYS_WAIT_H


42 
	~<bôs/waôÊags.h
>

43 
	~<bôs/waô°©us.h
>

45 #ifde‡
__USE_BSD


50 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


51 
	#__WAIT_INT
(
°©us
) \

52 (
	`__exãnsi⁄__
 (((uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; }) \

53 { .
__ö
 = (
°©us
Ë}).
__i
))

	)

55 
	#__WAIT_INT
(
°©us
Ë(*(*Ë&(°©us))

	)

63 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


64 
	#__WAIT_STATUS
 *

	)

65 
	#__WAIT_STATUS_DEFN
 *

	)

70 
waô
 *
	m__u±r
;

71 *
	m__ùå
;

72 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

73 
	#__WAIT_STATUS_DEFN
 *

	)

78 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

79 
	#__WAIT_STATUS
 *

	)

80 
	#__WAIT_STATUS_DEFN
 *

	)

85 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (°©us))

	)

86 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (
	`__WAIT_INT
 (°©us))

	)

87 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (
	`__WAIT_INT
 (°©us))

	)

88 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (
	`__WAIT_INT
 (°©us))

	)

89 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (°©us))

	)

90 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (°©us))

	)

91 #ifde‡
__WIFCONTINUED


92 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (°©us))

	)

96 
__BEGIN_NAMESPACE_STD


100 
	mquŸ
;

101 
	mªm
;

102 } 
	tdiv_t
;

105 #i‚de‡
__ldiv_t_deföed


108 
	mquŸ
;

109 
	mªm
;

110 } 
	tldiv_t
;

111 
	#__ldiv_t_deföed
 1

	)

113 
	g__END_NAMESPACE_STD


115 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


116 
__BEGIN_NAMESPACE_C99


118 
__exãnsi⁄__
 struct

120 
	mquŸ
;

121 
	mªm
;

122 } 
	tŒdiv_t
;

123 
	#__Œdiv_t_deföed
 1

	)

124 
	g__END_NAMESPACE_C99


129 
	#RAND_MAX
 2147483647

	)

134 
	#EXIT_FAILURE
 1

	)

135 
	#EXIT_SUCCESS
 0

	)

139 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

140 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

143 
__BEGIN_NAMESPACE_STD


145 
	$©of
 (
__c⁄°
 *
__≈å
)

146 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

148 
	$©oi
 (
__c⁄°
 *
__≈å
)

149 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

151 
	$©ﬁ
 (
__c⁄°
 *
__≈å
)

152 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

153 
__END_NAMESPACE_STD


155 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

156 
__BEGIN_NAMESPACE_C99


158 
__exãnsi⁄__
 
	$©ﬁl
 (
__c⁄°
 *
__≈å
)

159 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

160 
__END_NAMESPACE_C99


163 
__BEGIN_NAMESPACE_STD


165 
	$°πod
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

166 **
__ª°ri˘
 
__íd±r
)

167 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

168 
__END_NAMESPACE_STD


170 #ifdef 
__USE_ISOC99


171 
__BEGIN_NAMESPACE_C99


173 
	$°πof
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

174 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

176 
	$°πﬁd
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

177 **
__ª°ri˘
 
__íd±r
)

178 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

179 
__END_NAMESPACE_C99


182 
__BEGIN_NAMESPACE_STD


184 
	$°πﬁ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

185 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

186 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

188 
	$°πoul
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

189 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

190 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

191 
__END_NAMESPACE_STD


193 #i‡
deföed
 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_BSD


195 
__exãnsi⁄__


196 
	$°πoq
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

197 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

198 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

200 
__exãnsi⁄__


201 
	$°πouq
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

202 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

203 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

206 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

207 
__BEGIN_NAMESPACE_C99


209 
__exãnsi⁄__


210 
	$°πﬁl
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

211 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

212 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

214 
__exãnsi⁄__


215 
	$°πouŒ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

216 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

217 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

218 
__END_NAMESPACE_C99


222 #ifde‡
__USE_GNU


236 
	~<xloˇÀ.h
>

240 
	$°πﬁ_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

241 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

242 
__loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4)Ë
__wur
;

244 
	$°πoul_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

245 **
__ª°ri˘
 
__íd±r
,

246 
__ba£
, 
__loˇÀ_t
 
__loc
)

247 
__THROW
 
	`__n⁄nuŒ
 ((1, 4)Ë
__wur
;

249 
__exãnsi⁄__


250 
	$°πﬁl_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

251 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

252 
__loˇÀ_t
 
__loc
)

253 
__THROW
 
	`__n⁄nuŒ
 ((1, 4)Ë
__wur
;

255 
__exãnsi⁄__


256 
	$°πouŒ_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

257 **
__ª°ri˘
 
__íd±r
,

258 
__ba£
, 
__loˇÀ_t
 
__loc
)

259 
__THROW
 
	`__n⁄nuŒ
 ((1, 4)Ë
__wur
;

261 
	$°πod_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

262 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

263 
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

265 
	$°πof_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

266 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

267 
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

269 
	$°πﬁd_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

270 **
__ª°ri˘
 
__íd±r
,

271 
__loˇÀ_t
 
__loc
)

272 
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

276 #ifde‡
__USE_EXTERN_INLINES


277 
__BEGIN_NAMESPACE_STD


278 
__exã∫_ölöe
 

279 
	`__NTH
 (
	$©of
 (
__c⁄°
 *
__≈å
))

281  
	`°πod
 (
__≈å
, (**Ë
NULL
);

282 
	}
}

283 
__exã∫_ölöe
 

284 
__NTH
 (
	$©oi
 (
__c⁄°
 *
__≈å
))

286  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

287 
	}
}

288 
__exã∫_ölöe
 

289 
__NTH
 (
	$©ﬁ
 (
__c⁄°
 *
__≈å
))

291  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

292 
	}
}

293 
	g__END_NAMESPACE_STD


295 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


296 
__BEGIN_NAMESPACE_C99


297 
__exãnsi⁄__
 
__exã∫_ölöe
 

298 
__NTH
 (
	$©ﬁl
 (
__c⁄°
 *
__≈å
))

300  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

301 
	}
}

302 
	g__END_NAMESPACE_C99


307 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


311 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

314 
	$a64l
 (
__c⁄°
 *
__s
)

315 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

319 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_BSD


320 
	~<sys/ty≥s.h
>

327 
	$øndom
 (Ë
__THROW
;

330 
	$§™dom
 (
__£ed
Ë
__THROW
;

336 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

337 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

341 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

344 #ifde‡
__USE_MISC


349 
	søndom_d©a


351 
öt32_t
 *
Âå
;

352 
öt32_t
 *
Ωå
;

353 
öt32_t
 *
°©e
;

354 
ønd_ty≥
;

355 
ønd_deg
;

356 
ønd_£p
;

357 
öt32_t
 *
íd_±r
;

360 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

361 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

363 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

364 
__THROW
 
	`__n⁄nuŒ
 ((2));

366 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

367 
size_t
 
__°©ñí
,

368 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

369 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

371 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

372 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

373 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

378 
__BEGIN_NAMESPACE_STD


380 
	$ønd
 (Ë
__THROW
;

382 
	$§™d
 (
__£ed
Ë
__THROW
;

383 
__END_NAMESPACE_STD


385 #ifde‡
__USE_POSIX


387 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

391 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


395 
	$dønd48
 (Ë
__THROW
;

396 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

399 
	$Ã™d48
 (Ë
__THROW
;

400 
	$ƒ™d48
 (
__xsubi
[3])

401 
__THROW
 
	`__n⁄nuŒ
 ((1));

404 
	$mønd48
 (Ë
__THROW
;

405 
	$jønd48
 (
__xsubi
[3])

406 
__THROW
 
	`__n⁄nuŒ
 ((1));

409 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

410 *
	$£ed48
 (
__£ed16v
[3])

411 
__THROW
 
	`__n⁄nuŒ
 ((1));

412 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

414 #ifde‡
__USE_MISC


418 
	sdønd48_d©a


420 
__x
[3];

421 
__ﬁd_x
[3];

422 
__c
;

423 
__öô
;

424 
__a
;

428 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

429 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

430 
	$î™d48_r
 (
__xsubi
[3],

431 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

432 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

435 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

436 *
__ª°ri˘
 
__ªsu…
)

437 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

438 
	$ƒ™d48_r
 (
__xsubi
[3],

439 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

440 *
__ª°ri˘
 
__ªsu…
)

441 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

444 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

445 *
__ª°ri˘
 
__ªsu…
)

446 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

447 
	$jønd48_r
 (
__xsubi
[3],

448 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

449 *
__ª°ri˘
 
__ªsu…
)

450 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

453 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

454 
__THROW
 
	`__n⁄nuŒ
 ((2));

456 
	$£ed48_r
 (
__£ed16v
[3],

457 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

459 
	$lc⁄g48_r
 (
__∑øm
[7],

460 
dønd48_d©a
 *
__buf„r
)

461 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

467 #i‚de‡
__mÆloc_™d_ˇŒoc_deföed


468 
	#__mÆloc_™d_ˇŒoc_deföed


	)

469 
__BEGIN_NAMESPACE_STD


471 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

473 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

474 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

475 
__END_NAMESPACE_STD


478 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


479 
__BEGIN_NAMESPACE_STD


485 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

486 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

488 
	$‰ì
 (*
__±r
Ë
__THROW
;

489 
__END_NAMESPACE_STD


491 #ifdef 
__USE_MISC


493 
	$c‰ì
 (*
__±r
Ë
__THROW
;

496 #i‡
deföed
 
__USE_GNU
 || deföed 
__USE_BSD
 || deföed 
__USE_MISC


497 
	~<Æloˇ.h
>

500 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


502 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

505 #ifde‡
__USE_XOPEN2K


507 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

508 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

511 
__BEGIN_NAMESPACE_STD


513 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

517 
	`©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

519 #ifde‡
__USE_GNU


523 #ifde‡
__˝lu•lus


524 "C++" 
	`©_quick_exô
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

527 
	`©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	`⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

536 
__THROW
 
	`__n⁄nuŒ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

545 #ifde‡
__USE_GNU


551 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

553 
__END_NAMESPACE_STD


555 #ifde‡
__USE_ISOC99


556 
__BEGIN_NAMESPACE_C99


559 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

560 
__END_NAMESPACE_C99


564 
__BEGIN_NAMESPACE_STD


566 *
	$gëív
 (
__c⁄°
 *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

567 
__END_NAMESPACE_STD


571 *
	$__£cuª_gëív
 (
__c⁄°
 *
__«me
)

572 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

574 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


578 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

581 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


584 
	$£ãnv
 (
__c⁄°
 *
__«me
, __c⁄° *
__vÆue
, 
__ª∂a˚
)

585 
__THROW
 
	`__n⁄nuŒ
 ((2));

588 
	$un£ãnv
 (
__c⁄°
 *
__«me
Ë
__THROW
;

591 #ifdef 
__USE_MISC


595 
	$˛óªnv
 (Ë
__THROW
;

599 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


604 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

614 #i‚de‡
__USE_FILE_OFFSET64


615 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

617 #ifde‡
__REDIRECT


618 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

619 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

621 
	#mk°emp
 
mk°emp64


	)

624 #ifde‡
__USE_LARGEFILE64


625 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

629 #ifde‡
__USE_MISC


636 #i‚de‡
__USE_FILE_OFFSET64


637 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

639 #ifde‡
__REDIRECT


640 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

641 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

643 
	#mk°emps
 
mk°emps64


	)

646 #ifde‡
__USE_LARGEFILE64


647 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

648 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

652 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K8


658 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

661 #ifde‡
__USE_GNU


668 #i‚de‡
__USE_FILE_OFFSET64


669 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

671 #ifde‡
__REDIRECT


672 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

673 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

675 
	#mko°emp
 
mko°emp64


	)

678 #ifde‡
__USE_LARGEFILE64


679 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

688 #i‚de‡
__USE_FILE_OFFSET64


689 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

690 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

692 #ifde‡
__REDIRECT


693 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

694 
__Êags
), 
mko°emps64
)

695 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

697 
	#mko°emps
 
mko°emps64


	)

700 #ifde‡
__USE_LARGEFILE64


701 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

702 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

707 
__BEGIN_NAMESPACE_STD


712 
	$sy°em
 (
__c⁄°
 *
__comm™d
Ë
__wur
;

713 
__END_NAMESPACE_STD


716 #ifdef 
__USE_GNU


719 *
	$ˇn⁄iˇlize_fûe_«me
 (
__c⁄°
 *
__«me
)

720 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

723 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


729 *
	$ªÆ∑th
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

730 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

735 #i‚de‡
__COMPAR_FN_T


736 
	#__COMPAR_FN_T


	)

737 (*
	t__com∑r_‚_t
Ë(
	t__c⁄°
 *, __const *);

739 #ifdef 
__USE_GNU


740 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

743 #ifde‡
__USE_GNU


744 (*
	t__com∑r_d_‚_t
Ë(
	t__c⁄°
 *, __const *, *);

747 
__BEGIN_NAMESPACE_STD


750 *
	$b£¨ch
 (
__c⁄°
 *
__key
, __c⁄° *
__ba£
,

751 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

752 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

756 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

757 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

758 #ifde‡
__USE_GNU


759 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

760 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

761 
	`__n⁄nuŒ
 ((1, 4));

766 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

767 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

768 
__END_NAMESPACE_STD


770 #ifde‡
__USE_ISOC99


771 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

772 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

776 
__BEGIN_NAMESPACE_STD


780 
div_t
 
	$div
 (
__numî
, 
__díom
)

781 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

782 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

783 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

784 
__END_NAMESPACE_STD


786 #ifde‡
__USE_ISOC99


787 
__BEGIN_NAMESPACE_C99


788 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

789 
__díom
)

790 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

791 
__END_NAMESPACE_C99


795 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


802 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

803 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

808 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

809 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

814 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

815 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

818 #ifde‡
__USE_MISC


820 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

821 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

822 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

823 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

824 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

825 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

826 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

827 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

832 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

833 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

834 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

835 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

836 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

837 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

839 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

840 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

841 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

842 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

843 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

844 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

845 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

846 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

851 
__BEGIN_NAMESPACE_STD


854 
	$mbÀn
 (
__c⁄°
 *
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

857 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

858 
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

861 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
 
__wur
;

865 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

866 
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

868 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

869 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

870 
__THROW
;

871 
__END_NAMESPACE_STD


874 #ifde‡
__USE_SVID


879 
	$Ωm©ch
 (
__c⁄°
 *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

883 #ifde‡
__USE_XOPEN_EXTENDED


890 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

891 *
__c⁄°
 *
__ª°ri˘
 
__tokís
,

892 **
__ª°ri˘
 
__vÆuï
)

893 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

897 #ifde‡
__USE_XOPEN


899 
	$£tkey
 (
__c⁄°
 *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

905 #ifde‡
__USE_XOPEN2K


907 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

910 #ifde‡
__USE_XOPEN


915 
	$gø¡±
 (
__fd
Ë
__THROW
;

919 
	$u∆ock±
 (
__fd
Ë
__THROW
;

924 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

927 #ifde‡
__USE_GNU


931 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

932 
__THROW
 
	`__n⁄nuŒ
 ((2));

935 
	`gë±
 ();

938 #ifde‡
__USE_BSD


942 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

943 
__THROW
 
	`__n⁄nuŒ
 ((1));

948 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


949 
	~<bôs/°dlib.h
>

951 #ifde‡
__LDBL_COMPAT


952 
	~<bôs/°dlib-ldbl.h
>

956 #unde‡
__√ed_mÆloc_™d_ˇŒoc


958 
__END_DECLS


	@/usr/include/string.h

23 #i‚def 
_STRING_H


24 
	#_STRING_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

36 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

37 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

41 
__BEGIN_NAMESPACE_STD


43 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
,

44 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

45 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

48 *
	$memmove
 (*
__de°
, 
__c⁄°
 *
__§c
, 
size_t
 
__n
)

49 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

50 
__END_NAMESPACE_STD


55 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN


56 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
,

57 
__c
, 
size_t
 
__n
)

58 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

62 
__BEGIN_NAMESPACE_STD


64 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

67 
	$memcmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

68 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

71 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


74 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

75 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

76 
__c⁄°
 *
	`memchr
 (__c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

77 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

79 #ifde‡
__OPTIMIZE__


80 
__exã∫_Æways_ölöe
 *

81 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


83  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

86 
__exã∫_Æways_ölöe
 
__c⁄°
 *

87 
	`memchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


89  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

92 
	}
}

94 *
	$memchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
)

95 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

97 
__END_NAMESPACE_STD


99 #ifde‡
__USE_GNU


102 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


103 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

104 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

105 "C++" 
__c⁄°
 *
	$øwmemchr
 (
__c⁄°
 *
__s
, 
__c
)

106 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

108 *
	$øwmemchr
 (
__c⁄°
 *
__s
, 
__c
)

109 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

113 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


114 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

116 "C++" 
__c⁄°
 *
	$memrchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
)

117 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

119 *
	$memrchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
)

120 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

125 
__BEGIN_NAMESPACE_STD


127 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

128 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

130 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

131 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

132 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

135 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

136 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

138 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
,

139 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

142 
	$°rcmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

143 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

145 
	$°∫cmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

146 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

149 
	$°rcﬁl
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

150 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

152 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

153 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

154 
__THROW
 
	`__n⁄nuŒ
 ((2));

155 
__END_NAMESPACE_STD


157 #ifde‡
__USE_XOPEN2K8


161 
	~<xloˇÀ.h
>

164 
	$°rcﬁl_l
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
__loˇÀ_t
 
__l
)

165 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

167 
size_t
 
	$°rx‰m_l
 (*
__de°
, 
__c⁄°
 *
__§c
, 
size_t
 
__n
,

168 
__loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

171 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


173 *
	$°rdup
 (
__c⁄°
 *
__s
)

174 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

180 #i‡
deföed
 
__USE_XOPEN2K8


181 *
	$°∫dup
 (
__c⁄°
 *
__°rög
, 
size_t
 
__n
)

182 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

185 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


187 
	#°rdu∑
(
s
) \

188 (
__exãnsi⁄__
 \

190 
__c⁄°
 *
__ﬁd
 = (
s
); \

191 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

192 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

193 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

194 
	}
}))

	)

197 
	#°∫du∑
(
s
, 
n
) \

198 (
__exãnsi⁄__
 \

200 
__c⁄°
 *
__ﬁd
 = (
s
); \

201 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

202 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

203 
__√w
[
__Àn
] = '\0'; \

204 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

205 }))

	)

208 
	g__BEGIN_NAMESPACE_STD


210 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


213 *
°rchr
 (*
__s
, 
__c
)

214 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

215 
__c⁄°
 *
°rchr
 (__c⁄° *
__s
, 
__c
)

216 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

218 #ifde‡
__OPTIMIZE__


219 
__exã∫_Æways_ölöe
 *

220 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


222  
__buûtö_°rchr
 (
__s
, 
__c
);

225 
__exã∫_Æways_ölöe
 
__c⁄°
 *

226 
°rchr
 (
__c⁄°
 *
__s
, 
__c
Ë
	g__THROW


228  
__buûtö_°rchr
 (
__s
, 
__c
);

233 *
	$°rchr
 (
__c⁄°
 *
__s
, 
__c
)

234 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

237 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


240 *
	`°ºchr
 (*
__s
, 
__c
)

241 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

242 
__c⁄°
 *
	`°ºchr
 (__c⁄° *
__s
, 
__c
)

243 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

245 #ifde‡
__OPTIMIZE__


246 
__exã∫_Æways_ölöe
 *

247 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


249  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

252 
__exã∫_Æways_ölöe
 
__c⁄°
 *

253 
	`°ºchr
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW


255  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

258 
	}
}

260 *
	$°ºchr
 (
__c⁄°
 *
__s
, 
__c
)

261 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

263 
__END_NAMESPACE_STD


265 #ifde‡
__USE_GNU


268 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


269 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

270 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

271 "C++" 
__c⁄°
 *
	$°rch∫ul
 (
__c⁄°
 *
__s
, 
__c
)

272 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

274 *
	$°rch∫ul
 (
__c⁄°
 *
__s
, 
__c
)

275 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

279 
__BEGIN_NAMESPACE_STD


282 
size_t
 
	$°rc•n
 (
__c⁄°
 *
__s
, __c⁄° *
__ªje˘
)

283 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

286 
size_t
 
	$°r•n
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
)

287 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

289 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


292 *
	`°Ωbrk
 (*
__s
, 
__c⁄°
 *
__ac˚±
)

293 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

294 
__c⁄°
 *
	`°Ωbrk
 (__c⁄° *
__s
, __c⁄° *
__ac˚±
)

295 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

297 #ifde‡
__OPTIMIZE__


298 
__exã∫_Æways_ölöe
 *

299 
	`°Ωbrk
 (*
__s
, 
__c⁄°
 *
__ac˚±
Ë
__THROW


301  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

304 
__exã∫_Æways_ölöe
 
__c⁄°
 *

305 
	`°Ωbrk
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
Ë
__THROW


307  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

310 
	}
}

312 *
	$°Ωbrk
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
)

313 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

316 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


319 *
	`°r°r
 (*
__hay°ack
, 
__c⁄°
 *
__√edÀ
)

320 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

321 
__c⁄°
 *
	`°r°r
 (__c⁄° *
__hay°ack
,

322 
__c⁄°
 *
__√edÀ
)

323 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

325 #ifde‡
__OPTIMIZE__


326 
__exã∫_Æways_ölöe
 *

327 
	`°r°r
 (*
__hay°ack
, 
__c⁄°
 *
__√edÀ
Ë
__THROW


329  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

332 
__exã∫_Æways_ölöe
 
__c⁄°
 *

333 
	`°r°r
 (
__c⁄°
 *
__hay°ack
, __c⁄° *
__√edÀ
Ë
__THROW


335  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

338 
	}
}

340 *
	$°r°r
 (
__c⁄°
 *
__hay°ack
, __c⁄° *
__√edÀ
)

341 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

346 *
	$°πok
 (*
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__dñim
)

347 
__THROW
 
	`__n⁄nuŒ
 ((2));

348 
__END_NAMESPACE_STD


352 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

353 
__c⁄°
 *
__ª°ri˘
 
__dñim
,

354 **
__ª°ri˘
 
__ßve_±r
)

355 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

356 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


357 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__dñim
,

358 **
__ª°ri˘
 
__ßve_±r
)

359 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

362 #ifde‡
__USE_GNU


364 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


365 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, 
__c⁄°
 *
__√edÀ
)

366 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

367 "C++" 
__c⁄°
 *
	$°rˇ£°r
 (
__c⁄°
 *
__hay°ack
,

368 
__c⁄°
 *
__√edÀ
)

369 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

371 *
	$°rˇ£°r
 (
__c⁄°
 *
__hay°ack
, __c⁄° *
__√edÀ
)

372 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

376 #ifde‡
__USE_GNU


380 *
	$memmem
 (
__c⁄°
 *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

381 
__c⁄°
 *
__√edÀ
, 
size_t
 
__√edÀÀn
)

382 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

386 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

387 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

388 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

389 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

390 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

391 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

395 
__BEGIN_NAMESPACE_STD


397 
size_t
 
	$°æí
 (
__c⁄°
 *
__s
)

398 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

399 
__END_NAMESPACE_STD


401 #ifdef 
__USE_XOPEN2K8


404 
size_t
 
	$°∫Àn
 (
__c⁄°
 *
__°rög
, 
size_t
 
__maxÀn
)

405 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

409 
__BEGIN_NAMESPACE_STD


411 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

412 
__END_NAMESPACE_STD


413 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_MISC


421 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


424 #ifde‡
__REDIRECT_NTH


425 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

426 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

427 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

429 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

430 
__THROW
 
	`__n⁄nuŒ
 ((2));

431 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

436 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

437 
__THROW
 
	`__n⁄nuŒ
 ((2));

441 #ifde‡
__USE_XOPEN2K8


443 *
	$°ªº‹_l
 (
__î∫um
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

449 
	$__bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

451 #ifde‡
__USE_BSD


453 
	$bc›y
 (
__c⁄°
 *
__§c
, *
__de°
, 
size_t
 
__n
)

454 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

457 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

460 
	$bcmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

461 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

464 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


467 *
	`ödex
 (*
__s
, 
__c
)

468 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

469 
__c⁄°
 *
	`ödex
 (__c⁄° *
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

472 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


473 
__exã∫_Æways_ölöe
 *

474 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


476  
	`__buûtö_ödex
 (
__s
, 
__c
);

479 
__exã∫_Æways_ölöe
 
__c⁄°
 *

480 
	`ödex
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW


482  
	`__buûtö_ödex
 (
__s
, 
__c
);

485 
	}
}

487 *
	$ödex
 (
__c⁄°
 *
__s
, 
__c
)

488 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

492 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


495 *
	`rödex
 (*
__s
, 
__c
)

496 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

497 
__c⁄°
 *
	`rödex
 (__c⁄° *
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

500 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


501 
__exã∫_Æways_ölöe
 *

502 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


504  
	`__buûtö_rödex
 (
__s
, 
__c
);

507 
__exã∫_Æways_ölöe
 
__c⁄°
 *

508 
	`rödex
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW


510  
	`__buûtö_rödex
 (
__s
, 
__c
);

513 
	}
}

515 *
	$rödex
 (
__c⁄°
 *
__s
, 
__c
)

516 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

521 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

525 #ifdef 
__USE_GNU


526 
	$ff¶
 (
__l
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

527 #ifde‡
__GNUC__


528 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

529 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

534 
	$°rˇ£cmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

535 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

538 
	$°∫ˇ£cmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

539 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

542 #ifdef 
__USE_GNU


545 
	$°rˇ£cmp_l
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
,

546 
__loˇÀ_t
 
__loc
)

547 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

549 
	$°∫ˇ£cmp_l
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
,

550 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

551 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

554 #ifdef 
__USE_BSD


557 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

558 
__c⁄°
 *
__ª°ri˘
 
__dñim
)

559 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

562 #ifdef 
__USE_XOPEN2K8


564 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

567 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

568 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

569 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

570 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

574 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

575 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

576 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

577 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

578 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

579 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

582 #ifdef 
__USE_GNU


584 
	$°rvîscmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

585 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

588 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

591 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

593 #i‚de‡
ba£«me


598 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


599 "C++" *
	$ba£«me
 (*
__fûíame
)

600 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

601 "C++" 
__c⁄°
 *
	$ba£«me
 (
__c⁄°
 *
__fûíame
)

602 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

604 *
	$ba£«me
 (
__c⁄°
 *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

610 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

611 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__OPTIMIZE_SIZE__
 \

612 && !
deföed
 
__NO_INLINE__
 && !deföed 
__˝lu•lus


632 
	~<bôs/°rög.h
>

635 
	~<bôs/°rög2.h
>

638 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


640 
	~<bôs/°rög3.h
>

644 
__END_DECLS


	@/usr/include/sys/ioctl.h

19 #i‚def 
_SYS_IOCTL_H


20 
	#_SYS_IOCTL_H
 1

	)

22 
	~<„©uªs.h
>

24 
	g__BEGIN_DECLS


27 
	~<bôs/io˘ls.h
>

30 
	~<bôs/io˘l-ty≥s.h
>

37 
	~<sys/âydeÁu…s.h
>

42 
	$io˘l
 (
__fd
, 
__ªque°
, ...Ë
__THROW
;

44 
__END_DECLS


	@/usr/include/sys/socket.h

21 #i‚def 
_SYS_SOCKET_H


22 
	#_SYS_SOCKET_H
 1

	)

24 
	~<„©uªs.h
>

26 
	g__BEGIN_DECLS


28 
	~<sys/uio.h
>

29 
	#__√ed_size_t


	)

30 
	~<°ddef.h
>

31 #ifde‡
__USE_GNU


33 
	~<bôs/sig£t.h
>

40 
	~<bôs/sockë.h
>

42 #ifde‡
__USE_BSD


45 
	sosockaddr


47 
	mß_Ámûy
;

48 
	mß_d©a
[14];

56 
	mSHUT_RD
 = 0,

57 
	#SHUT_RD
 
SHUT_RD


	)

58 
	mSHUT_WR
,

59 
	#SHUT_WR
 
SHUT_WR


	)

60 
	mSHUT_RDWR


61 
	#SHUT_RDWR
 
SHUT_RDWR


	)

70 #i‡
deföed
 
__˝lu•lus
 || !
__GNUC_PREREQ
 (2, 7Ë|| !deföed 
__USE_GNU


71 
	#__SOCKADDR_ARG
 
sockaddr
 *
__ª°ri˘


	)

72 
	#__CONST_SOCKADDR_ARG
 
__c⁄°
 
sockaddr
 *

	)

76 
	#__SOCKADDR_ALLTYPES
 \

77 
	`__SOCKADDR_ONETYPE
 (
sockaddr
) \

78 
	`__SOCKADDR_ONETYPE
 (
sockaddr_©
) \

79 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ax25
) \

80 
	`__SOCKADDR_ONETYPE
 (
sockaddr_dl
) \

81 
	`__SOCKADDR_ONETYPE
 (
sockaddr_e⁄
) \

82 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ö
) \

83 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ö6
) \

84 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ö¨p
) \

85 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ùx
) \

86 
	`__SOCKADDR_ONETYPE
 (
sockaddr_iso
) \

87 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ns
) \

88 
	`__SOCKADDR_ONETYPE
 (
sockaddr_un
) \

89 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x25
)

	)

91 
	#__SOCKADDR_ONETYPE
(
ty≥
Ëty≥ *
__ª°ri˘
 
__
##ty≥##__;

	)

92 uni⁄ { 
	m__SOCKADDR_ALLTYPES


93 } 
	t__SOCKADDR_ARG
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

94 #unde‡
__SOCKADDR_ONETYPE


95 
	#__SOCKADDR_ONETYPE
(
ty≥
Ë
__c⁄°
 ty≥ *
__ª°ri˘
 
__
##ty≥##__;

	)

96 uni⁄ { 
	m__SOCKADDR_ALLTYPES


97 } 
	t__CONST_SOCKADDR_ARG
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

98 #unde‡
__SOCKADDR_ONETYPE


105 
	$sockë
 (
__domaö
, 
__ty≥
, 
__¥Ÿocﬁ
Ë
__THROW
;

111 
	$sockë∑ú
 (
__domaö
, 
__ty≥
, 
__¥Ÿocﬁ
,

112 
__fds
[2]Ë
__THROW
;

115 
	$böd
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockÀn_t
 
__Àn
)

116 
__THROW
;

119 
	$gësock«me
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

120 
sockÀn_t
 *
__ª°ri˘
 
__Àn
Ë
__THROW
;

129 
	`c⁄√˘
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockÀn_t
 
__Àn
);

133 
	$gë≥î«me
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

134 
sockÀn_t
 *
__ª°ri˘
 
__Àn
Ë
__THROW
;

141 
ssize_t
 
	`£nd
 (
__fd
, 
__c⁄°
 *
__buf
, 
size_t
 
__n
, 
__Êags
);

148 
ssize_t
 
	`ªcv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__Êags
);

155 
ssize_t
 
	`£ndto
 (
__fd
, 
__c⁄°
 *
__buf
, 
size_t
 
__n
,

156 
__Êags
, 
__CONST_SOCKADDR_ARG
 
__addr
,

157 
sockÀn_t
 
__addr_Àn
);

166 
ssize_t
 
	`ªcv‰om
 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
,

167 
__Êags
, 
__SOCKADDR_ARG
 
__addr
,

168 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
);

176 
ssize_t
 
	`£ndmsg
 (
__fd
, 
__c⁄°
 
msghdr
 *
__mesßge
,

177 
__Êags
);

184 
ssize_t
 
	`ªcvmsg
 (
__fd
, 
msghdr
 *
__mesßge
, 
__Êags
);

190 
	$gësock›t
 (
__fd
, 
__Àvñ
, 
__›äame
,

191 *
__ª°ri˘
 
__›tvÆ
,

192 
sockÀn_t
 *
__ª°ri˘
 
__›éí
Ë
__THROW
;

197 
	$£tsock›t
 (
__fd
, 
__Àvñ
, 
__›äame
,

198 
__c⁄°
 *
__›tvÆ
, 
sockÀn_t
 
__›éí
Ë
__THROW
;

204 
	$li°í
 (
__fd
, 
__n
Ë
__THROW
;

214 
	`ac˚±
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

215 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
);

217 #ifde‡
__USE_GNU


222 
	`ac˚±4
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

223 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
, 
__Êags
);

232 
	$shutdown
 (
__fd
, 
__how
Ë
__THROW
;

235 #ifde‡
__USE_XOPEN2K


237 
	$sock©m¨k
 (
__fd
Ë
__THROW
;

241 #ifde‡
__USE_MISC


245 
	$isfdty≥
 (
__fd
, 
__fdty≥
Ë
__THROW
;

250 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


251 
	~<bôs/sockë2.h
>

254 
__END_DECLS


	@/usr/include/unistd.h

23 #i‚def 
_UNISTD_H


24 
	#_UNISTD_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


33 #ifde‡
__USE_XOPEN2K8


35 
	#_POSIX_VERSION
 200809L

	)

36 #ñi‡
deföed
 
__USE_XOPEN2K


38 
	#_POSIX_VERSION
 200112L

	)

39 #ñi‡
deföed
 
__USE_POSIX199506


41 
	#_POSIX_VERSION
 199506L

	)

42 #ñi‡
deföed
 
__USE_POSIX199309


44 
	#_POSIX_VERSION
 199309L

	)

47 
	#_POSIX_VERSION
 199009L

	)

53 #ifde‡
__USE_XOPEN2K8


54 
	#__POSIX2_THIS_VERSION
 200809L

	)

56 #ñi‡
deföed
 
__USE_XOPEN2K


58 
	#__POSIX2_THIS_VERSION
 200112L

	)

59 #ñi‡
deföed
 
__USE_POSIX199506


61 
	#__POSIX2_THIS_VERSION
 199506L

	)

64 
	#__POSIX2_THIS_VERSION
 199209L

	)

68 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

72 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

76 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

80 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

84 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

87 #ifde‡
__USE_XOPEN2K8


88 
	#_XOPEN_VERSION
 700

	)

89 #ñi‡
deföed
 
__USE_XOPEN2K


90 
	#_XOPEN_VERSION
 600

	)

91 #ñi‡
deföed
 
__USE_UNIX98


92 
	#_XOPEN_VERSION
 500

	)

94 
	#_XOPEN_VERSION
 4

	)

98 
	#_XOPEN_XCU_VERSION
 4

	)

101 
	#_XOPEN_XPG2
 1

	)

102 
	#_XOPEN_XPG3
 1

	)

103 
	#_XOPEN_XPG4
 1

	)

106 
	#_XOPEN_UNIX
 1

	)

109 
	#_XOPEN_CRYPT
 1

	)

113 
	#_XOPEN_ENH_I18N
 1

	)

116 
	#_XOPEN_LEGACY
 1

	)

203 
	~<bôs/posix_›t.h
>

206 #ifde‡
__USE_UNIX98


207 
	~<bôs/ívú⁄míts.h
>

211 
	#STDIN_FILENO
 0

	)

212 
	#STDOUT_FILENO
 1

	)

213 
	#STDERR_FILENO
 2

	)

218 
	~<bôs/ty≥s.h
>

220 #i‚def 
__ssize_t_deföed


221 
__ssize_t
 
	tssize_t
;

222 
	#__ssize_t_deföed


	)

225 
	#__√ed_size_t


	)

226 
	#__√ed_NULL


	)

227 
	~<°ddef.h
>

229 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


232 #i‚de‡
__gid_t_deföed


233 
__gid_t
 
	tgid_t
;

234 
	#__gid_t_deföed


	)

237 #i‚de‡
__uid_t_deföed


238 
__uid_t
 
	tuid_t
;

239 
	#__uid_t_deföed


	)

242 #i‚de‡
__off_t_deföed


243 #i‚de‡
__USE_FILE_OFFSET64


244 
__off_t
 
	toff_t
;

246 
__off64_t
 
	toff_t
;

248 
	#__off_t_deföed


	)

250 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


251 
__off64_t
 
	toff64_t
;

252 
	#__off64_t_deföed


	)

255 #i‚de‡
__u£c⁄ds_t_deföed


256 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

257 
	#__u£c⁄ds_t_deföed


	)

260 #i‚de‡
__pid_t_deföed


261 
__pid_t
 
	tpid_t
;

262 
	#__pid_t_deföed


	)

266 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


267 #i‚de‡
__öçå_t_deföed


268 
__öçå_t
 
	töçå_t
;

269 
	#__öçå_t_deföed


	)

273 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


274 #i‚de‡
__sockÀn_t_deföed


275 
__sockÀn_t
 
	tsockÀn_t
;

276 
	#__sockÀn_t_deföed


	)

282 
	#R_OK
 4

	)

283 
	#W_OK
 2

	)

284 
	#X_OK
 1

	)

285 
	#F_OK
 0

	)

288 
	$ac˚ss
 (
__c⁄°
 *
__«me
, 
__ty≥
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

290 #ifde‡
__USE_GNU


293 
	$euidac˚ss
 (
__c⁄°
 *
__«me
, 
__ty≥
)

294 
__THROW
 
	`__n⁄nuŒ
 ((1));

297 
	$óc˚ss
 (
__c⁄°
 *
__«me
, 
__ty≥
)

298 
__THROW
 
	`__n⁄nuŒ
 ((1));

301 #ifde‡
__USE_ATFILE


305 
	$Ác˚sßt
 (
__fd
, 
__c⁄°
 *
__fûe
, 
__ty≥
, 
__Êag
)

306 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

311 #i‚def 
_STDIO_H


312 
	#SEEK_SET
 0

	)

313 
	#SEEK_CUR
 1

	)

314 
	#SEEK_END
 2

	)

317 #i‡
deföed
 
__USE_BSD
 && !deföed 
L_SET


319 
	#L_SET
 
SEEK_SET


	)

320 
	#L_INCR
 
SEEK_CUR


	)

321 
	#L_XTND
 
SEEK_END


	)

330 #i‚de‡
__USE_FILE_OFFSET64


331 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__whí˚
Ë
__THROW
;

333 #ifde‡
__REDIRECT_NTH


334 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

335 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
),

336 
l£ek64
);

338 
	#l£ek
 
l£ek64


	)

341 #ifde‡
__USE_LARGEFILE64


342 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
)

343 
__THROW
;

350 
	`˛o£
 (
__fd
);

357 
ssize_t
 
	$ªad
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
Ë
__wur
;

363 
ssize_t
 
	$wrôe
 (
__fd
, 
__c⁄°
 *
__buf
, 
size_t
 
__n
Ë
__wur
;

365 #ifde‡
__USE_UNIX98


366 #i‚de‡
__USE_FILE_OFFSET64


373 
ssize_t
 
	$¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

374 
__off_t
 
__off£t
Ë
__wur
;

381 
ssize_t
 
	$pwrôe
 (
__fd
, 
__c⁄°
 *
__buf
, 
size_t
 
__n
,

382 
__off_t
 
__off£t
Ë
__wur
;

384 #ifde‡
__REDIRECT


385 
ssize_t
 
	`__REDIRECT
 (
¥ód
, (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

386 
__off64_t
 
__off£t
),

387 
¥ód64
Ë
__wur
;

388 
ssize_t
 
	`__REDIRECT
 (
pwrôe
, (
__fd
, 
__c⁄°
 *
__buf
,

389 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
),

390 
pwrôe64
Ë
__wur
;

392 
	#¥ód
 
¥ód64


	)

393 
	#pwrôe
 
pwrôe64


	)

397 #ifde‡
__USE_LARGEFILE64


401 
ssize_t
 
	$¥ód64
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

402 
__off64_t
 
__off£t
Ë
__wur
;

405 
ssize_t
 
	$pwrôe64
 (
__fd
, 
__c⁄°
 *
__buf
, 
size_t
 
__n
,

406 
__off64_t
 
__off£t
Ë
__wur
;

414 
	$pùe
 (
__pùedes
[2]Ë
__THROW
 
__wur
;

416 #ifde‡
__USE_GNU


419 
	$pùe2
 (
__pùedes
[2], 
__Êags
Ë
__THROW
 
__wur
;

429 
	$Æ¨m
 (
__£c⁄ds
Ë
__THROW
;

441 
	`¶ìp
 (
__£c⁄ds
);

443 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


448 
__u£c⁄ds_t
 
	$uÆ¨m
 (
__u£c⁄ds_t
 
__vÆue
, __u£c⁄ds_à
__öãrvÆ
)

449 
__THROW
;

456 
	`u¶ìp
 (
__u£c⁄ds_t
 
__u£c⁄ds
);

465 
	`∑u£
 ();

469 
	$chown
 (
__c⁄°
 *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

470 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

472 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


474 
	$fchown
 (
__fd
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
Ë
__THROW
 
__wur
;

479 
	$lchown
 (
__c⁄°
 *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

480 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

484 #ifde‡
__USE_ATFILE


487 
	$fchow«t
 (
__fd
, 
__c⁄°
 *
__fûe
, 
__uid_t
 
__ow√r
,

488 
__gid_t
 
__group
, 
__Êag
)

489 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

493 
	$chdú
 (
__c⁄°
 *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

495 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


497 
	$fchdú
 (
__fd
Ë
__THROW
 
__wur
;

507 *
	$gëcwd
 (*
__buf
, 
size_t
 
__size
Ë
__THROW
 
__wur
;

509 #ifdef 
__USE_GNU


513 *
	$gë_cuºít_dú_«me
 (Ë
__THROW
;

516 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


520 *
	$gëwd
 (*
__buf
)

521 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
 
__wur
;

526 
	$dup
 (
__fd
Ë
__THROW
 
__wur
;

529 
	$dup2
 (
__fd
, 
__fd2
Ë
__THROW
;

531 #ifde‡
__USE_GNU


534 
	$dup3
 (
__fd
, 
__fd2
, 
__Êags
Ë
__THROW
;

538 **
__ívú⁄
;

539 #ifde‡
__USE_GNU


540 **
ívú⁄
;

546 
	$execve
 (
__c⁄°
 *
__∑th
, *__c⁄° 
__¨gv
[],

547 *
__c⁄°
 
__ívp
[]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

549 #ifde‡
__USE_XOPEN2K8


552 
	$„xecve
 (
__fd
, *
__c⁄°
 
__¨gv
[], *__c⁄° 
__ívp
[])

553 
__THROW
;

558 
	$execv
 (
__c⁄°
 *
__∑th
, *__c⁄° 
__¨gv
[])

559 
__THROW
 
	`__n⁄nuŒ
 ((1));

563 
	$exe˛e
 (
__c⁄°
 *
__∑th
, __c⁄° *
__¨g
, ...)

564 
__THROW
 
	`__n⁄nuŒ
 ((1));

568 
	$exe˛
 (
__c⁄°
 *
__∑th
, __c⁄° *
__¨g
, ...)

569 
__THROW
 
	`__n⁄nuŒ
 ((1));

573 
	$execvp
 (
__c⁄°
 *
__fûe
, *__c⁄° 
__¨gv
[])

574 
__THROW
 
	`__n⁄nuŒ
 ((1));

579 
	$exe˛p
 (
__c⁄°
 *
__fûe
, __c⁄° *
__¨g
, ...)

580 
__THROW
 
	`__n⁄nuŒ
 ((1));

582 #ifde‡
__USE_GNU


585 
	$execv≥
 (
__c⁄°
 *
__fûe
, *__c⁄° 
__¨gv
[],

586 *
__c⁄°
 
__ívp
[])

587 
__THROW
 
	`__n⁄nuŒ
 ((1));

591 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


593 
	$ni˚
 (
__öc
Ë
__THROW
 
__wur
;

598 
	$_exô
 (
__°©us
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

604 
	~<bôs/c⁄‚ame.h
>

607 
	$∑thc⁄f
 (
__c⁄°
 *
__∑th
, 
__«me
)

608 
__THROW
 
	`__n⁄nuŒ
 ((1));

611 
	$Â©hc⁄f
 (
__fd
, 
__«me
Ë
__THROW
;

614 
	$sysc⁄f
 (
__«me
Ë
__THROW
;

616 #ifdef 
__USE_POSIX2


618 
size_t
 
	$c⁄f°r
 (
__«me
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

623 
__pid_t
 
	$gëpid
 (Ë
__THROW
;

626 
__pid_t
 
	$gëµid
 (Ë
__THROW
;

630 #i‚de‡
__FAVOR_BSD


631 
__pid_t
 
	$gëpgΩ
 (Ë
__THROW
;

633 #ifde‡
__REDIRECT_NTH


634 
__pid_t
 
	`__REDIRECT_NTH
 (
gëpgΩ
, (__pid_à
__pid
), 
__gëpgid
);

636 
	#gëpgΩ
 
__gëpgid


	)

641 
__pid_t
 
	$__gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

642 #ifde‡
__USE_XOPEN_EXTENDED


643 
__pid_t
 
	$gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

650 
	$£çgid
 (
__pid_t
 
__pid
, __pid_à
__pgid
Ë
__THROW
;

652 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


663 #i‚de‡
__FAVOR_BSD


667 
	$£çgΩ
 (Ë
__THROW
;

672 #ifde‡
__REDIRECT_NTH


673 
	`__REDIRECT_NTH
 (
£çgΩ
, (
__pid_t
 
__pid
, __pid_à
__pgΩ
), 
£çgid
);

675 
	#£çgΩ
 
£çgid


	)

684 
__pid_t
 
	$£tsid
 (Ë
__THROW
;

686 #ifde‡
__USE_XOPEN_EXTENDED


688 
__pid_t
 
	$gësid
 (
__pid_t
 
__pid
Ë
__THROW
;

692 
__uid_t
 
	$gëuid
 (Ë
__THROW
;

695 
__uid_t
 
	$gëeuid
 (Ë
__THROW
;

698 
__gid_t
 
	$gëgid
 (Ë
__THROW
;

701 
__gid_t
 
	$gëegid
 (Ë
__THROW
;

706 
	$gëgroups
 (
__size
, 
__gid_t
 
__li°
[]Ë
__THROW
 
__wur
;

708 #ifdef 
__USE_GNU


710 
	$group_membî
 (
__gid_t
 
__gid
Ë
__THROW
;

717 
	$£tuid
 (
__uid_t
 
__uid
Ë
__THROW
;

719 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


722 
	$£åeuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
Ë
__THROW
;

725 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


727 
	$£ãuid
 (
__uid_t
 
__uid
Ë
__THROW
;

734 
	$£tgid
 (
__gid_t
 
__gid
Ë
__THROW
;

736 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


739 
	$£åegid
 (
__gid_t
 
__rgid
, __gid_à
__egid
Ë
__THROW
;

742 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


744 
	$£ãgid
 (
__gid_t
 
__gid
Ë
__THROW
;

747 #ifde‡
__USE_GNU


750 
	$gëªsuid
 (
__uid_t
 *
__ruid
, __uid_à*
__euid
, __uid_à*
__suid
)

751 
__THROW
;

755 
	$gëªsgid
 (
__gid_t
 *
__rgid
, __gid_à*
__egid
, __gid_à*
__sgid
)

756 
__THROW
;

760 
	$£åesuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
, __uid_à
__suid
)

761 
__THROW
;

765 
	$£åesgid
 (
__gid_t
 
__rgid
, __gid_à
__egid
, __gid_à
__sgid
)

766 
__THROW
;

773 
__pid_t
 
	$f‹k
 (Ë
__THROW
;

775 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


780 
__pid_t
 
	$vf‹k
 (Ë
__THROW
;

786 *
	$ây«me
 (
__fd
Ë
__THROW
;

790 
	$ây«me_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

791 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

795 
	$ißây
 (
__fd
Ë
__THROW
;

797 #i‡
deföed
 
__USE_BSD
 \

798 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_UNIX98
)

801 
	$ây¶Ÿ
 (Ë
__THROW
;

806 
	$lök
 (
__c⁄°
 *
__‰om
, __c⁄° *
__to
)

807 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

809 #ifde‡
__USE_ATFILE


812 
	$lök©
 (
__‰omfd
, 
__c⁄°
 *
__‰om
, 
__tofd
,

813 
__c⁄°
 *
__to
, 
__Êags
)

814 
__THROW
 
	`__n⁄nuŒ
 ((2, 4)Ë
__wur
;

817 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


819 
	$symlök
 (
__c⁄°
 *
__‰om
, __c⁄° *
__to
)

820 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

825 
ssize_t
 
	$ªadlök
 (
__c⁄°
 *
__ª°ri˘
 
__∑th
,

826 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

827 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

830 #ifde‡
__USE_ATFILE


832 
	$symlök©
 (
__c⁄°
 *
__‰om
, 
__tofd
,

833 
__c⁄°
 *
__to
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

836 
ssize_t
 
	$ªadlök©
 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__∑th
,

837 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

838 
__THROW
 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
;

842 
	$u∆ök
 (
__c⁄°
 *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

844 #ifde‡
__USE_ATFILE


846 
	$u∆ök©
 (
__fd
, 
__c⁄°
 *
__«me
, 
__Êag
)

847 
__THROW
 
	`__n⁄nuŒ
 ((2));

851 
	$rmdú
 (
__c⁄°
 *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

855 
__pid_t
 
	$tcgëpgΩ
 (
__fd
Ë
__THROW
;

858 
	$tc£çgΩ
 (
__fd
, 
__pid_t
 
__pgΩ_id
Ë
__THROW
;

865 *
	`gëlogö
 ();

866 #i‡
deföed
 
__USE_REENTRANT
 || deföed 
__USE_POSIX199506


873 
	$gëlogö_r
 (*
__«me
, 
size_t
 
__«me_Àn
Ë
	`__n⁄nuŒ
 ((1));

876 #ifdef 
__USE_BSD


878 
	$£éogö
 (
__c⁄°
 *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

882 #ifdef 
__USE_POSIX2


886 
	#__√ed_gë›t


	)

887 
	~<gë›t.h
>

891 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_UNIX98


895 
	$gëho°«me
 (*
__«me
, 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

899 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_UNIX98
)

902 
	$£tho°«me
 (
__c⁄°
 *
__«me
, 
size_t
 
__Àn
)

903 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

907 
	$£tho°id
 (
__id
Ë
__THROW
 
__wur
;

913 
	$gëdomaö«me
 (*
__«me
, 
size_t
 
__Àn
)

914 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

915 
	$£tdomaö«me
 (
__c⁄°
 *
__«me
, 
size_t
 
__Àn
)

916 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

922 
	$vh™gup
 (Ë
__THROW
;

925 
	$ªvoke
 (
__c⁄°
 *
__fûe
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

933 
	$¥ofû
 (*
__ßm∂e_buf„r
, 
size_t
 
__size
,

934 
size_t
 
__off£t
, 
__sˇÀ
)

935 
__THROW
 
	`__n⁄nuŒ
 ((1));

941 
	$ac˘
 (
__c⁄°
 *
__«me
Ë
__THROW
;

945 *
	$gëu£rshñl
 (Ë
__THROW
;

946 
	$ídu£rshñl
 (Ë
__THROW
;

947 
	$£tu£rshñl
 (Ë
__THROW
;

953 
	$d´m⁄
 (
__nochdú
, 
__no˛o£
Ë
__THROW
 
__wur
;

957 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

960 
	$chroŸ
 (
__c⁄°
 *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

964 *
	$gë∑ss
 (
__c⁄°
 *
__¥om±
Ë
	`__n⁄nuŒ
 ((1));

968 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


973 
	`fsync
 (
__fd
);

977 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


980 
	`gëho°id
 ();

983 
	$sync
 (Ë
__THROW
;

988 
	$gë∑gesize
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

993 
	$gëdèbÀsize
 (Ë
__THROW
;

997 #i‚de‡
__USE_FILE_OFFSET64


998 
	$åunˇã
 (
__c⁄°
 *
__fûe
, 
__off_t
 
__Àngth
)

999 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1001 #ifde‡
__REDIRECT_NTH


1002 
	`__REDIRECT_NTH
 (
åunˇã
,

1003 (
__c⁄°
 *
__fûe
, 
__off64_t
 
__Àngth
),

1004 
åunˇã64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1006 
	#åunˇã
 
åunˇã64


	)

1009 #ifde‡
__USE_LARGEFILE64


1010 
	$åunˇã64
 (
__c⁄°
 *
__fûe
, 
__off64_t
 
__Àngth
)

1011 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1016 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


1019 #i‚de‡
__USE_FILE_OFFSET64


1020 
	$·runˇã
 (
__fd
, 
__off_t
 
__Àngth
Ë
__THROW
 
__wur
;

1022 #ifde‡
__REDIRECT_NTH


1023 
	`__REDIRECT_NTH
 (
·runˇã
, (
__fd
, 
__off64_t
 
__Àngth
),

1024 
·runˇã64
Ë
__wur
;

1026 
	#·runˇã
 
·runˇã64


	)

1029 #ifde‡
__USE_LARGEFILE64


1030 
	$·runˇã64
 (
__fd
, 
__off64_t
 
__Àngth
Ë
__THROW
 
__wur
;

1036 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


1040 
	$brk
 (*
__addr
Ë
__THROW
 
__wur
;

1046 *
	$sbrk
 (
öçå_t
 
__dñè
Ë
__THROW
;

1050 #ifde‡
__USE_MISC


1061 
	$sysˇŒ
 (
__sy¢o
, ...Ë
__THROW
;

1066 #i‡(
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
Ë&& !deföed 
F_LOCK


1078 
	#F_ULOCK
 0

	)

1079 
	#F_LOCK
 1

	)

1080 
	#F_TLOCK
 2

	)

1081 
	#F_TEST
 3

	)

1083 #i‚de‡
__USE_FILE_OFFSET64


1084 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Àn
Ë
__wur
;

1086 #ifde‡
__REDIRECT


1087 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
),

1088 
lockf64
Ë
__wur
;

1090 
	#lockf
 
lockf64


	)

1093 #ifde‡
__USE_LARGEFILE64


1094 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
Ë
__wur
;

1099 #ifde‡
__USE_GNU


1104 
	#TEMP_FAILURE_RETRY
(
ex¥essi⁄
) \

1105 (
__exãnsi⁄__
 \

1106 ({ 
__ªsu…
; \

1107 dÿ
__ªsu…
 = (Ë(
ex¥essi⁄
); \

1108 
__ªsu…
 =-1L && 
î∫o
 =
EINTR
); \

1109 
__ªsu…
; 
	}
}))

	)

1112 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_UNIX98


1115 
fd©async
 (
__fûdes
);

1121 #ifdef 
__USE_XOPEN


1123 *
	$¸y±
 (
__c⁄°
 *
__key
, __c⁄° *
__ß…
)

1124 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1128 
	$í¸y±
 (*
__block
, 
__edÊag
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

1135 
	$swab
 (
__c⁄°
 *
__ª°ri˘
 
__‰om
, *__ª°ri˘ 
__to
,

1136 
ssize_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1142 #ifde‡
__USE_XOPEN


1144 *
	$˘îmid
 (*
__s
Ë
__THROW
;

1149 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


1150 
	~<bôs/uni°d.h
>

1153 
__END_DECLS


	@/usr/include/alloca.h

19 #i‚def 
_ALLOCA_H


20 
	#_ALLOCA_H
 1

	)

22 
	~<„©uªs.h
>

24 
	#__√ed_size_t


	)

25 
	~<°ddef.h
>

27 
	g__BEGIN_DECLS


30 #unde‡
Æloˇ


33 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

35 #ifdef 
__GNUC__


36 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

39 
__END_DECLS


	@/usr/include/asm/errno.h

1 
	~<asm-gíîic/î∫o.h
>

	@/usr/include/asm/unistd.h

1 #ifde‡
__i386__


2 
	~"uni°d_32.h
"

4 
	~"uni°d_64.h
"

	@/usr/include/bits/confname.h

21 #i‚de‡
_UNISTD_H


28 
	m_PC_LINK_MAX
,

29 
	#_PC_LINK_MAX
 
_PC_LINK_MAX


	)

30 
	m_PC_MAX_CANON
,

31 
	#_PC_MAX_CANON
 
_PC_MAX_CANON


	)

32 
	m_PC_MAX_INPUT
,

33 
	#_PC_MAX_INPUT
 
_PC_MAX_INPUT


	)

34 
	m_PC_NAME_MAX
,

35 
	#_PC_NAME_MAX
 
_PC_NAME_MAX


	)

36 
	m_PC_PATH_MAX
,

37 
	#_PC_PATH_MAX
 
_PC_PATH_MAX


	)

38 
	m_PC_PIPE_BUF
,

39 
	#_PC_PIPE_BUF
 
_PC_PIPE_BUF


	)

40 
	m_PC_CHOWN_RESTRICTED
,

41 
	#_PC_CHOWN_RESTRICTED
 
_PC_CHOWN_RESTRICTED


	)

42 
	m_PC_NO_TRUNC
,

43 
	#_PC_NO_TRUNC
 
_PC_NO_TRUNC


	)

44 
	m_PC_VDISABLE
,

45 
	#_PC_VDISABLE
 
_PC_VDISABLE


	)

46 
	m_PC_SYNC_IO
,

47 
	#_PC_SYNC_IO
 
_PC_SYNC_IO


	)

48 
	m_PC_ASYNC_IO
,

49 
	#_PC_ASYNC_IO
 
_PC_ASYNC_IO


	)

50 
	m_PC_PRIO_IO
,

51 
	#_PC_PRIO_IO
 
_PC_PRIO_IO


	)

52 
	m_PC_SOCK_MAXBUF
,

53 
	#_PC_SOCK_MAXBUF
 
_PC_SOCK_MAXBUF


	)

54 
	m_PC_FILESIZEBITS
,

55 
	#_PC_FILESIZEBITS
 
_PC_FILESIZEBITS


	)

56 
	m_PC_REC_INCR_XFER_SIZE
,

57 
	#_PC_REC_INCR_XFER_SIZE
 
_PC_REC_INCR_XFER_SIZE


	)

58 
	m_PC_REC_MAX_XFER_SIZE
,

59 
	#_PC_REC_MAX_XFER_SIZE
 
_PC_REC_MAX_XFER_SIZE


	)

60 
	m_PC_REC_MIN_XFER_SIZE
,

61 
	#_PC_REC_MIN_XFER_SIZE
 
_PC_REC_MIN_XFER_SIZE


	)

62 
	m_PC_REC_XFER_ALIGN
,

63 
	#_PC_REC_XFER_ALIGN
 
_PC_REC_XFER_ALIGN


	)

64 
	m_PC_ALLOC_SIZE_MIN
,

65 
	#_PC_ALLOC_SIZE_MIN
 
_PC_ALLOC_SIZE_MIN


	)

66 
	m_PC_SYMLINK_MAX
,

67 
	#_PC_SYMLINK_MAX
 
_PC_SYMLINK_MAX


	)

68 
	m_PC_2_SYMLINKS


69 
	#_PC_2_SYMLINKS
 
_PC_2_SYMLINKS


	)

75 
	m_SC_ARG_MAX
,

76 
	#_SC_ARG_MAX
 
_SC_ARG_MAX


	)

77 
	m_SC_CHILD_MAX
,

78 
	#_SC_CHILD_MAX
 
_SC_CHILD_MAX


	)

79 
	m_SC_CLK_TCK
,

80 
	#_SC_CLK_TCK
 
_SC_CLK_TCK


	)

81 
	m_SC_NGROUPS_MAX
,

82 
	#_SC_NGROUPS_MAX
 
_SC_NGROUPS_MAX


	)

83 
	m_SC_OPEN_MAX
,

84 
	#_SC_OPEN_MAX
 
_SC_OPEN_MAX


	)

85 
	m_SC_STREAM_MAX
,

86 
	#_SC_STREAM_MAX
 
_SC_STREAM_MAX


	)

87 
	m_SC_TZNAME_MAX
,

88 
	#_SC_TZNAME_MAX
 
_SC_TZNAME_MAX


	)

89 
	m_SC_JOB_CONTROL
,

90 
	#_SC_JOB_CONTROL
 
_SC_JOB_CONTROL


	)

91 
	m_SC_SAVED_IDS
,

92 
	#_SC_SAVED_IDS
 
_SC_SAVED_IDS


	)

93 
	m_SC_REALTIME_SIGNALS
,

94 
	#_SC_REALTIME_SIGNALS
 
_SC_REALTIME_SIGNALS


	)

95 
	m_SC_PRIORITY_SCHEDULING
,

96 
	#_SC_PRIORITY_SCHEDULING
 
_SC_PRIORITY_SCHEDULING


	)

97 
	m_SC_TIMERS
,

98 
	#_SC_TIMERS
 
_SC_TIMERS


	)

99 
	m_SC_ASYNCHRONOUS_IO
,

100 
	#_SC_ASYNCHRONOUS_IO
 
_SC_ASYNCHRONOUS_IO


	)

101 
	m_SC_PRIORITIZED_IO
,

102 
	#_SC_PRIORITIZED_IO
 
_SC_PRIORITIZED_IO


	)

103 
	m_SC_SYNCHRONIZED_IO
,

104 
	#_SC_SYNCHRONIZED_IO
 
_SC_SYNCHRONIZED_IO


	)

105 
	m_SC_FSYNC
,

106 
	#_SC_FSYNC
 
_SC_FSYNC


	)

107 
	m_SC_MAPPED_FILES
,

108 
	#_SC_MAPPED_FILES
 
_SC_MAPPED_FILES


	)

109 
	m_SC_MEMLOCK
,

110 
	#_SC_MEMLOCK
 
_SC_MEMLOCK


	)

111 
	m_SC_MEMLOCK_RANGE
,

112 
	#_SC_MEMLOCK_RANGE
 
_SC_MEMLOCK_RANGE


	)

113 
	m_SC_MEMORY_PROTECTION
,

114 
	#_SC_MEMORY_PROTECTION
 
_SC_MEMORY_PROTECTION


	)

115 
	m_SC_MESSAGE_PASSING
,

116 
	#_SC_MESSAGE_PASSING
 
_SC_MESSAGE_PASSING


	)

117 
	m_SC_SEMAPHORES
,

118 
	#_SC_SEMAPHORES
 
_SC_SEMAPHORES


	)

119 
	m_SC_SHARED_MEMORY_OBJECTS
,

120 
	#_SC_SHARED_MEMORY_OBJECTS
 
_SC_SHARED_MEMORY_OBJECTS


	)

121 
	m_SC_AIO_LISTIO_MAX
,

122 
	#_SC_AIO_LISTIO_MAX
 
_SC_AIO_LISTIO_MAX


	)

123 
	m_SC_AIO_MAX
,

124 
	#_SC_AIO_MAX
 
_SC_AIO_MAX


	)

125 
	m_SC_AIO_PRIO_DELTA_MAX
,

126 
	#_SC_AIO_PRIO_DELTA_MAX
 
_SC_AIO_PRIO_DELTA_MAX


	)

127 
	m_SC_DELAYTIMER_MAX
,

128 
	#_SC_DELAYTIMER_MAX
 
_SC_DELAYTIMER_MAX


	)

129 
	m_SC_MQ_OPEN_MAX
,

130 
	#_SC_MQ_OPEN_MAX
 
_SC_MQ_OPEN_MAX


	)

131 
	m_SC_MQ_PRIO_MAX
,

132 
	#_SC_MQ_PRIO_MAX
 
_SC_MQ_PRIO_MAX


	)

133 
	m_SC_VERSION
,

134 
	#_SC_VERSION
 
_SC_VERSION


	)

135 
	m_SC_PAGESIZE
,

136 
	#_SC_PAGESIZE
 
_SC_PAGESIZE


	)

137 
	#_SC_PAGE_SIZE
 
_SC_PAGESIZE


	)

138 
	m_SC_RTSIG_MAX
,

139 
	#_SC_RTSIG_MAX
 
_SC_RTSIG_MAX


	)

140 
	m_SC_SEM_NSEMS_MAX
,

141 
	#_SC_SEM_NSEMS_MAX
 
_SC_SEM_NSEMS_MAX


	)

142 
	m_SC_SEM_VALUE_MAX
,

143 
	#_SC_SEM_VALUE_MAX
 
_SC_SEM_VALUE_MAX


	)

144 
	m_SC_SIGQUEUE_MAX
,

145 
	#_SC_SIGQUEUE_MAX
 
_SC_SIGQUEUE_MAX


	)

146 
	m_SC_TIMER_MAX
,

147 
	#_SC_TIMER_MAX
 
_SC_TIMER_MAX


	)

151 
	m_SC_BC_BASE_MAX
,

152 
	#_SC_BC_BASE_MAX
 
_SC_BC_BASE_MAX


	)

153 
	m_SC_BC_DIM_MAX
,

154 
	#_SC_BC_DIM_MAX
 
_SC_BC_DIM_MAX


	)

155 
	m_SC_BC_SCALE_MAX
,

156 
	#_SC_BC_SCALE_MAX
 
_SC_BC_SCALE_MAX


	)

157 
	m_SC_BC_STRING_MAX
,

158 
	#_SC_BC_STRING_MAX
 
_SC_BC_STRING_MAX


	)

159 
	m_SC_COLL_WEIGHTS_MAX
,

160 
	#_SC_COLL_WEIGHTS_MAX
 
_SC_COLL_WEIGHTS_MAX


	)

161 
	m_SC_EQUIV_CLASS_MAX
,

162 
	#_SC_EQUIV_CLASS_MAX
 
_SC_EQUIV_CLASS_MAX


	)

163 
	m_SC_EXPR_NEST_MAX
,

164 
	#_SC_EXPR_NEST_MAX
 
_SC_EXPR_NEST_MAX


	)

165 
	m_SC_LINE_MAX
,

166 
	#_SC_LINE_MAX
 
_SC_LINE_MAX


	)

167 
	m_SC_RE_DUP_MAX
,

168 
	#_SC_RE_DUP_MAX
 
_SC_RE_DUP_MAX


	)

169 
	m_SC_CHARCLASS_NAME_MAX
,

170 
	#_SC_CHARCLASS_NAME_MAX
 
_SC_CHARCLASS_NAME_MAX


	)

172 
	m_SC_2_VERSION
,

173 
	#_SC_2_VERSION
 
_SC_2_VERSION


	)

174 
	m_SC_2_C_BIND
,

175 
	#_SC_2_C_BIND
 
_SC_2_C_BIND


	)

176 
	m_SC_2_C_DEV
,

177 
	#_SC_2_C_DEV
 
_SC_2_C_DEV


	)

178 
	m_SC_2_FORT_DEV
,

179 
	#_SC_2_FORT_DEV
 
_SC_2_FORT_DEV


	)

180 
	m_SC_2_FORT_RUN
,

181 
	#_SC_2_FORT_RUN
 
_SC_2_FORT_RUN


	)

182 
	m_SC_2_SW_DEV
,

183 
	#_SC_2_SW_DEV
 
_SC_2_SW_DEV


	)

184 
	m_SC_2_LOCALEDEF
,

185 
	#_SC_2_LOCALEDEF
 
_SC_2_LOCALEDEF


	)

187 
	m_SC_PII
,

188 
	#_SC_PII
 
_SC_PII


	)

189 
	m_SC_PII_XTI
,

190 
	#_SC_PII_XTI
 
_SC_PII_XTI


	)

191 
	m_SC_PII_SOCKET
,

192 
	#_SC_PII_SOCKET
 
_SC_PII_SOCKET


	)

193 
	m_SC_PII_INTERNET
,

194 
	#_SC_PII_INTERNET
 
_SC_PII_INTERNET


	)

195 
	m_SC_PII_OSI
,

196 
	#_SC_PII_OSI
 
_SC_PII_OSI


	)

197 
	m_SC_POLL
,

198 
	#_SC_POLL
 
_SC_POLL


	)

199 
	m_SC_SELECT
,

200 
	#_SC_SELECT
 
_SC_SELECT


	)

201 
	m_SC_UIO_MAXIOV
,

202 
	#_SC_UIO_MAXIOV
 
_SC_UIO_MAXIOV


	)

203 
	m_SC_IOV_MAX
 = 
_SC_UIO_MAXIOV
,

204 
	#_SC_IOV_MAX
 
_SC_IOV_MAX


	)

205 
	m_SC_PII_INTERNET_STREAM
,

206 
	#_SC_PII_INTERNET_STREAM
 
_SC_PII_INTERNET_STREAM


	)

207 
	m_SC_PII_INTERNET_DGRAM
,

208 
	#_SC_PII_INTERNET_DGRAM
 
_SC_PII_INTERNET_DGRAM


	)

209 
	m_SC_PII_OSI_COTS
,

210 
	#_SC_PII_OSI_COTS
 
_SC_PII_OSI_COTS


	)

211 
	m_SC_PII_OSI_CLTS
,

212 
	#_SC_PII_OSI_CLTS
 
_SC_PII_OSI_CLTS


	)

213 
	m_SC_PII_OSI_M
,

214 
	#_SC_PII_OSI_M
 
_SC_PII_OSI_M


	)

215 
	m_SC_T_IOV_MAX
,

216 
	#_SC_T_IOV_MAX
 
_SC_T_IOV_MAX


	)

219 
	m_SC_THREADS
,

220 
	#_SC_THREADS
 
_SC_THREADS


	)

221 
	m_SC_THREAD_SAFE_FUNCTIONS
,

222 
	#_SC_THREAD_SAFE_FUNCTIONS
 
_SC_THREAD_SAFE_FUNCTIONS


	)

223 
	m_SC_GETGR_R_SIZE_MAX
,

224 
	#_SC_GETGR_R_SIZE_MAX
 
_SC_GETGR_R_SIZE_MAX


	)

225 
	m_SC_GETPW_R_SIZE_MAX
,

226 
	#_SC_GETPW_R_SIZE_MAX
 
_SC_GETPW_R_SIZE_MAX


	)

227 
	m_SC_LOGIN_NAME_MAX
,

228 
	#_SC_LOGIN_NAME_MAX
 
_SC_LOGIN_NAME_MAX


	)

229 
	m_SC_TTY_NAME_MAX
,

230 
	#_SC_TTY_NAME_MAX
 
_SC_TTY_NAME_MAX


	)

231 
	m_SC_THREAD_DESTRUCTOR_ITERATIONS
,

232 
	#_SC_THREAD_DESTRUCTOR_ITERATIONS
 
_SC_THREAD_DESTRUCTOR_ITERATIONS


	)

233 
	m_SC_THREAD_KEYS_MAX
,

234 
	#_SC_THREAD_KEYS_MAX
 
_SC_THREAD_KEYS_MAX


	)

235 
	m_SC_THREAD_STACK_MIN
,

236 
	#_SC_THREAD_STACK_MIN
 
_SC_THREAD_STACK_MIN


	)

237 
	m_SC_THREAD_THREADS_MAX
,

238 
	#_SC_THREAD_THREADS_MAX
 
_SC_THREAD_THREADS_MAX


	)

239 
	m_SC_THREAD_ATTR_STACKADDR
,

240 
	#_SC_THREAD_ATTR_STACKADDR
 
_SC_THREAD_ATTR_STACKADDR


	)

241 
	m_SC_THREAD_ATTR_STACKSIZE
,

242 
	#_SC_THREAD_ATTR_STACKSIZE
 
_SC_THREAD_ATTR_STACKSIZE


	)

243 
	m_SC_THREAD_PRIORITY_SCHEDULING
,

244 
	#_SC_THREAD_PRIORITY_SCHEDULING
 
_SC_THREAD_PRIORITY_SCHEDULING


	)

245 
	m_SC_THREAD_PRIO_INHERIT
,

246 
	#_SC_THREAD_PRIO_INHERIT
 
_SC_THREAD_PRIO_INHERIT


	)

247 
	m_SC_THREAD_PRIO_PROTECT
,

248 
	#_SC_THREAD_PRIO_PROTECT
 
_SC_THREAD_PRIO_PROTECT


	)

249 
	m_SC_THREAD_PROCESS_SHARED
,

250 
	#_SC_THREAD_PROCESS_SHARED
 
_SC_THREAD_PROCESS_SHARED


	)

252 
	m_SC_NPROCESSORS_CONF
,

253 
	#_SC_NPROCESSORS_CONF
 
_SC_NPROCESSORS_CONF


	)

254 
	m_SC_NPROCESSORS_ONLN
,

255 
	#_SC_NPROCESSORS_ONLN
 
_SC_NPROCESSORS_ONLN


	)

256 
	m_SC_PHYS_PAGES
,

257 
	#_SC_PHYS_PAGES
 
_SC_PHYS_PAGES


	)

258 
	m_SC_AVPHYS_PAGES
,

259 
	#_SC_AVPHYS_PAGES
 
_SC_AVPHYS_PAGES


	)

260 
	m_SC_ATEXIT_MAX
,

261 
	#_SC_ATEXIT_MAX
 
_SC_ATEXIT_MAX


	)

262 
	m_SC_PASS_MAX
,

263 
	#_SC_PASS_MAX
 
_SC_PASS_MAX


	)

265 
	m_SC_XOPEN_VERSION
,

266 
	#_SC_XOPEN_VERSION
 
_SC_XOPEN_VERSION


	)

267 
	m_SC_XOPEN_XCU_VERSION
,

268 
	#_SC_XOPEN_XCU_VERSION
 
_SC_XOPEN_XCU_VERSION


	)

269 
	m_SC_XOPEN_UNIX
,

270 
	#_SC_XOPEN_UNIX
 
_SC_XOPEN_UNIX


	)

271 
	m_SC_XOPEN_CRYPT
,

272 
	#_SC_XOPEN_CRYPT
 
_SC_XOPEN_CRYPT


	)

273 
	m_SC_XOPEN_ENH_I18N
,

274 
	#_SC_XOPEN_ENH_I18N
 
_SC_XOPEN_ENH_I18N


	)

275 
	m_SC_XOPEN_SHM
,

276 
	#_SC_XOPEN_SHM
 
_SC_XOPEN_SHM


	)

278 
	m_SC_2_CHAR_TERM
,

279 
	#_SC_2_CHAR_TERM
 
_SC_2_CHAR_TERM


	)

280 
	m_SC_2_C_VERSION
,

281 
	#_SC_2_C_VERSION
 
_SC_2_C_VERSION


	)

282 
	m_SC_2_UPE
,

283 
	#_SC_2_UPE
 
_SC_2_UPE


	)

285 
	m_SC_XOPEN_XPG2
,

286 
	#_SC_XOPEN_XPG2
 
_SC_XOPEN_XPG2


	)

287 
	m_SC_XOPEN_XPG3
,

288 
	#_SC_XOPEN_XPG3
 
_SC_XOPEN_XPG3


	)

289 
	m_SC_XOPEN_XPG4
,

290 
	#_SC_XOPEN_XPG4
 
_SC_XOPEN_XPG4


	)

292 
	m_SC_CHAR_BIT
,

293 
	#_SC_CHAR_BIT
 
_SC_CHAR_BIT


	)

294 
	m_SC_CHAR_MAX
,

295 
	#_SC_CHAR_MAX
 
_SC_CHAR_MAX


	)

296 
	m_SC_CHAR_MIN
,

297 
	#_SC_CHAR_MIN
 
_SC_CHAR_MIN


	)

298 
	m_SC_INT_MAX
,

299 
	#_SC_INT_MAX
 
_SC_INT_MAX


	)

300 
	m_SC_INT_MIN
,

301 
	#_SC_INT_MIN
 
_SC_INT_MIN


	)

302 
	m_SC_LONG_BIT
,

303 
	#_SC_LONG_BIT
 
_SC_LONG_BIT


	)

304 
	m_SC_WORD_BIT
,

305 
	#_SC_WORD_BIT
 
_SC_WORD_BIT


	)

306 
	m_SC_MB_LEN_MAX
,

307 
	#_SC_MB_LEN_MAX
 
_SC_MB_LEN_MAX


	)

308 
	m_SC_NZERO
,

309 
	#_SC_NZERO
 
_SC_NZERO


	)

310 
	m_SC_SSIZE_MAX
,

311 
	#_SC_SSIZE_MAX
 
_SC_SSIZE_MAX


	)

312 
	m_SC_SCHAR_MAX
,

313 
	#_SC_SCHAR_MAX
 
_SC_SCHAR_MAX


	)

314 
	m_SC_SCHAR_MIN
,

315 
	#_SC_SCHAR_MIN
 
_SC_SCHAR_MIN


	)

316 
	m_SC_SHRT_MAX
,

317 
	#_SC_SHRT_MAX
 
_SC_SHRT_MAX


	)

318 
	m_SC_SHRT_MIN
,

319 
	#_SC_SHRT_MIN
 
_SC_SHRT_MIN


	)

320 
	m_SC_UCHAR_MAX
,

321 
	#_SC_UCHAR_MAX
 
_SC_UCHAR_MAX


	)

322 
	m_SC_UINT_MAX
,

323 
	#_SC_UINT_MAX
 
_SC_UINT_MAX


	)

324 
	m_SC_ULONG_MAX
,

325 
	#_SC_ULONG_MAX
 
_SC_ULONG_MAX


	)

326 
	m_SC_USHRT_MAX
,

327 
	#_SC_USHRT_MAX
 
_SC_USHRT_MAX


	)

329 
	m_SC_NL_ARGMAX
,

330 
	#_SC_NL_ARGMAX
 
_SC_NL_ARGMAX


	)

331 
	m_SC_NL_LANGMAX
,

332 
	#_SC_NL_LANGMAX
 
_SC_NL_LANGMAX


	)

333 
	m_SC_NL_MSGMAX
,

334 
	#_SC_NL_MSGMAX
 
_SC_NL_MSGMAX


	)

335 
	m_SC_NL_NMAX
,

336 
	#_SC_NL_NMAX
 
_SC_NL_NMAX


	)

337 
	m_SC_NL_SETMAX
,

338 
	#_SC_NL_SETMAX
 
_SC_NL_SETMAX


	)

339 
	m_SC_NL_TEXTMAX
,

340 
	#_SC_NL_TEXTMAX
 
_SC_NL_TEXTMAX


	)

342 
	m_SC_XBS5_ILP32_OFF32
,

343 
	#_SC_XBS5_ILP32_OFF32
 
_SC_XBS5_ILP32_OFF32


	)

344 
	m_SC_XBS5_ILP32_OFFBIG
,

345 
	#_SC_XBS5_ILP32_OFFBIG
 
_SC_XBS5_ILP32_OFFBIG


	)

346 
	m_SC_XBS5_LP64_OFF64
,

347 
	#_SC_XBS5_LP64_OFF64
 
_SC_XBS5_LP64_OFF64


	)

348 
	m_SC_XBS5_LPBIG_OFFBIG
,

349 
	#_SC_XBS5_LPBIG_OFFBIG
 
_SC_XBS5_LPBIG_OFFBIG


	)

351 
	m_SC_XOPEN_LEGACY
,

352 
	#_SC_XOPEN_LEGACY
 
_SC_XOPEN_LEGACY


	)

353 
	m_SC_XOPEN_REALTIME
,

354 
	#_SC_XOPEN_REALTIME
 
_SC_XOPEN_REALTIME


	)

355 
	m_SC_XOPEN_REALTIME_THREADS
,

356 
	#_SC_XOPEN_REALTIME_THREADS
 
_SC_XOPEN_REALTIME_THREADS


	)

358 
	m_SC_ADVISORY_INFO
,

359 
	#_SC_ADVISORY_INFO
 
_SC_ADVISORY_INFO


	)

360 
	m_SC_BARRIERS
,

361 
	#_SC_BARRIERS
 
_SC_BARRIERS


	)

362 
	m_SC_BASE
,

363 
	#_SC_BASE
 
_SC_BASE


	)

364 
	m_SC_C_LANG_SUPPORT
,

365 
	#_SC_C_LANG_SUPPORT
 
_SC_C_LANG_SUPPORT


	)

366 
	m_SC_C_LANG_SUPPORT_R
,

367 
	#_SC_C_LANG_SUPPORT_R
 
_SC_C_LANG_SUPPORT_R


	)

368 
	m_SC_CLOCK_SELECTION
,

369 
	#_SC_CLOCK_SELECTION
 
_SC_CLOCK_SELECTION


	)

370 
	m_SC_CPUTIME
,

371 
	#_SC_CPUTIME
 
_SC_CPUTIME


	)

372 
	m_SC_THREAD_CPUTIME
,

373 
	#_SC_THREAD_CPUTIME
 
_SC_THREAD_CPUTIME


	)

374 
	m_SC_DEVICE_IO
,

375 
	#_SC_DEVICE_IO
 
_SC_DEVICE_IO


	)

376 
	m_SC_DEVICE_SPECIFIC
,

377 
	#_SC_DEVICE_SPECIFIC
 
_SC_DEVICE_SPECIFIC


	)

378 
	m_SC_DEVICE_SPECIFIC_R
,

379 
	#_SC_DEVICE_SPECIFIC_R
 
_SC_DEVICE_SPECIFIC_R


	)

380 
	m_SC_FD_MGMT
,

381 
	#_SC_FD_MGMT
 
_SC_FD_MGMT


	)

382 
	m_SC_FIFO
,

383 
	#_SC_FIFO
 
_SC_FIFO


	)

384 
	m_SC_PIPE
,

385 
	#_SC_PIPE
 
_SC_PIPE


	)

386 
	m_SC_FILE_ATTRIBUTES
,

387 
	#_SC_FILE_ATTRIBUTES
 
_SC_FILE_ATTRIBUTES


	)

388 
	m_SC_FILE_LOCKING
,

389 
	#_SC_FILE_LOCKING
 
_SC_FILE_LOCKING


	)

390 
	m_SC_FILE_SYSTEM
,

391 
	#_SC_FILE_SYSTEM
 
_SC_FILE_SYSTEM


	)

392 
	m_SC_MONOTONIC_CLOCK
,

393 
	#_SC_MONOTONIC_CLOCK
 
_SC_MONOTONIC_CLOCK


	)

394 
	m_SC_MULTI_PROCESS
,

395 
	#_SC_MULTI_PROCESS
 
_SC_MULTI_PROCESS


	)

396 
	m_SC_SINGLE_PROCESS
,

397 
	#_SC_SINGLE_PROCESS
 
_SC_SINGLE_PROCESS


	)

398 
	m_SC_NETWORKING
,

399 
	#_SC_NETWORKING
 
_SC_NETWORKING


	)

400 
	m_SC_READER_WRITER_LOCKS
,

401 
	#_SC_READER_WRITER_LOCKS
 
_SC_READER_WRITER_LOCKS


	)

402 
	m_SC_SPIN_LOCKS
,

403 
	#_SC_SPIN_LOCKS
 
_SC_SPIN_LOCKS


	)

404 
	m_SC_REGEXP
,

405 
	#_SC_REGEXP
 
_SC_REGEXP


	)

406 
	m_SC_REGEX_VERSION
,

407 
	#_SC_REGEX_VERSION
 
_SC_REGEX_VERSION


	)

408 
	m_SC_SHELL
,

409 
	#_SC_SHELL
 
_SC_SHELL


	)

410 
	m_SC_SIGNALS
,

411 
	#_SC_SIGNALS
 
_SC_SIGNALS


	)

412 
	m_SC_SPAWN
,

413 
	#_SC_SPAWN
 
_SC_SPAWN


	)

414 
	m_SC_SPORADIC_SERVER
,

415 
	#_SC_SPORADIC_SERVER
 
_SC_SPORADIC_SERVER


	)

416 
	m_SC_THREAD_SPORADIC_SERVER
,

417 
	#_SC_THREAD_SPORADIC_SERVER
 
_SC_THREAD_SPORADIC_SERVER


	)

418 
	m_SC_SYSTEM_DATABASE
,

419 
	#_SC_SYSTEM_DATABASE
 
_SC_SYSTEM_DATABASE


	)

420 
	m_SC_SYSTEM_DATABASE_R
,

421 
	#_SC_SYSTEM_DATABASE_R
 
_SC_SYSTEM_DATABASE_R


	)

422 
	m_SC_TIMEOUTS
,

423 
	#_SC_TIMEOUTS
 
_SC_TIMEOUTS


	)

424 
	m_SC_TYPED_MEMORY_OBJECTS
,

425 
	#_SC_TYPED_MEMORY_OBJECTS
 
_SC_TYPED_MEMORY_OBJECTS


	)

426 
	m_SC_USER_GROUPS
,

427 
	#_SC_USER_GROUPS
 
_SC_USER_GROUPS


	)

428 
	m_SC_USER_GROUPS_R
,

429 
	#_SC_USER_GROUPS_R
 
_SC_USER_GROUPS_R


	)

430 
	m_SC_2_PBS
,

431 
	#_SC_2_PBS
 
_SC_2_PBS


	)

432 
	m_SC_2_PBS_ACCOUNTING
,

433 
	#_SC_2_PBS_ACCOUNTING
 
_SC_2_PBS_ACCOUNTING


	)

434 
	m_SC_2_PBS_LOCATE
,

435 
	#_SC_2_PBS_LOCATE
 
_SC_2_PBS_LOCATE


	)

436 
	m_SC_2_PBS_MESSAGE
,

437 
	#_SC_2_PBS_MESSAGE
 
_SC_2_PBS_MESSAGE


	)

438 
	m_SC_2_PBS_TRACK
,

439 
	#_SC_2_PBS_TRACK
 
_SC_2_PBS_TRACK


	)

440 
	m_SC_SYMLOOP_MAX
,

441 
	#_SC_SYMLOOP_MAX
 
_SC_SYMLOOP_MAX


	)

442 
	m_SC_STREAMS
,

443 
	#_SC_STREAMS
 
_SC_STREAMS


	)

444 
	m_SC_2_PBS_CHECKPOINT
,

445 
	#_SC_2_PBS_CHECKPOINT
 
_SC_2_PBS_CHECKPOINT


	)

447 
	m_SC_V6_ILP32_OFF32
,

448 
	#_SC_V6_ILP32_OFF32
 
_SC_V6_ILP32_OFF32


	)

449 
	m_SC_V6_ILP32_OFFBIG
,

450 
	#_SC_V6_ILP32_OFFBIG
 
_SC_V6_ILP32_OFFBIG


	)

451 
	m_SC_V6_LP64_OFF64
,

452 
	#_SC_V6_LP64_OFF64
 
_SC_V6_LP64_OFF64


	)

453 
	m_SC_V6_LPBIG_OFFBIG
,

454 
	#_SC_V6_LPBIG_OFFBIG
 
_SC_V6_LPBIG_OFFBIG


	)

456 
	m_SC_HOST_NAME_MAX
,

457 
	#_SC_HOST_NAME_MAX
 
_SC_HOST_NAME_MAX


	)

458 
	m_SC_TRACE
,

459 
	#_SC_TRACE
 
_SC_TRACE


	)

460 
	m_SC_TRACE_EVENT_FILTER
,

461 
	#_SC_TRACE_EVENT_FILTER
 
_SC_TRACE_EVENT_FILTER


	)

462 
	m_SC_TRACE_INHERIT
,

463 
	#_SC_TRACE_INHERIT
 
_SC_TRACE_INHERIT


	)

464 
	m_SC_TRACE_LOG
,

465 
	#_SC_TRACE_LOG
 
_SC_TRACE_LOG


	)

467 
	m_SC_LEVEL1_ICACHE_SIZE
,

468 
	#_SC_LEVEL1_ICACHE_SIZE
 
_SC_LEVEL1_ICACHE_SIZE


	)

469 
	m_SC_LEVEL1_ICACHE_ASSOC
,

470 
	#_SC_LEVEL1_ICACHE_ASSOC
 
_SC_LEVEL1_ICACHE_ASSOC


	)

471 
	m_SC_LEVEL1_ICACHE_LINESIZE
,

472 
	#_SC_LEVEL1_ICACHE_LINESIZE
 
_SC_LEVEL1_ICACHE_LINESIZE


	)

473 
	m_SC_LEVEL1_DCACHE_SIZE
,

474 
	#_SC_LEVEL1_DCACHE_SIZE
 
_SC_LEVEL1_DCACHE_SIZE


	)

475 
	m_SC_LEVEL1_DCACHE_ASSOC
,

476 
	#_SC_LEVEL1_DCACHE_ASSOC
 
_SC_LEVEL1_DCACHE_ASSOC


	)

477 
	m_SC_LEVEL1_DCACHE_LINESIZE
,

478 
	#_SC_LEVEL1_DCACHE_LINESIZE
 
_SC_LEVEL1_DCACHE_LINESIZE


	)

479 
	m_SC_LEVEL2_CACHE_SIZE
,

480 
	#_SC_LEVEL2_CACHE_SIZE
 
_SC_LEVEL2_CACHE_SIZE


	)

481 
	m_SC_LEVEL2_CACHE_ASSOC
,

482 
	#_SC_LEVEL2_CACHE_ASSOC
 
_SC_LEVEL2_CACHE_ASSOC


	)

483 
	m_SC_LEVEL2_CACHE_LINESIZE
,

484 
	#_SC_LEVEL2_CACHE_LINESIZE
 
_SC_LEVEL2_CACHE_LINESIZE


	)

485 
	m_SC_LEVEL3_CACHE_SIZE
,

486 
	#_SC_LEVEL3_CACHE_SIZE
 
_SC_LEVEL3_CACHE_SIZE


	)

487 
	m_SC_LEVEL3_CACHE_ASSOC
,

488 
	#_SC_LEVEL3_CACHE_ASSOC
 
_SC_LEVEL3_CACHE_ASSOC


	)

489 
	m_SC_LEVEL3_CACHE_LINESIZE
,

490 
	#_SC_LEVEL3_CACHE_LINESIZE
 
_SC_LEVEL3_CACHE_LINESIZE


	)

491 
	m_SC_LEVEL4_CACHE_SIZE
,

492 
	#_SC_LEVEL4_CACHE_SIZE
 
_SC_LEVEL4_CACHE_SIZE


	)

493 
	m_SC_LEVEL4_CACHE_ASSOC
,

494 
	#_SC_LEVEL4_CACHE_ASSOC
 
_SC_LEVEL4_CACHE_ASSOC


	)

495 
	m_SC_LEVEL4_CACHE_LINESIZE
,

496 
	#_SC_LEVEL4_CACHE_LINESIZE
 
_SC_LEVEL4_CACHE_LINESIZE


	)

499 
	m_SC_IPV6
 = 
_SC_LEVEL1_ICACHE_SIZE
 + 50,

500 
	#_SC_IPV6
 
_SC_IPV6


	)

501 
	m_SC_RAW_SOCKETS
,

502 
	#_SC_RAW_SOCKETS
 
_SC_RAW_SOCKETS


	)

504 
	m_SC_V7_ILP32_OFF32
,

505 
	#_SC_V7_ILP32_OFF32
 
_SC_V7_ILP32_OFF32


	)

506 
	m_SC_V7_ILP32_OFFBIG
,

507 
	#_SC_V7_ILP32_OFFBIG
 
_SC_V7_ILP32_OFFBIG


	)

508 
	m_SC_V7_LP64_OFF64
,

509 
	#_SC_V7_LP64_OFF64
 
_SC_V7_LP64_OFF64


	)

510 
	m_SC_V7_LPBIG_OFFBIG
,

511 
	#_SC_V7_LPBIG_OFFBIG
 
_SC_V7_LPBIG_OFFBIG


	)

513 
	m_SC_SS_REPL_MAX
,

514 
	#_SC_SS_REPL_MAX
 
_SC_SS_REPL_MAX


	)

516 
	m_SC_TRACE_EVENT_NAME_MAX
,

517 
	#_SC_TRACE_EVENT_NAME_MAX
 
_SC_TRACE_EVENT_NAME_MAX


	)

518 
	m_SC_TRACE_NAME_MAX
,

519 
	#_SC_TRACE_NAME_MAX
 
_SC_TRACE_NAME_MAX


	)

520 
	m_SC_TRACE_SYS_MAX
,

521 
	#_SC_TRACE_SYS_MAX
 
_SC_TRACE_SYS_MAX


	)

522 
	m_SC_TRACE_USER_EVENT_MAX
,

523 
	#_SC_TRACE_USER_EVENT_MAX
 
_SC_TRACE_USER_EVENT_MAX


	)

525 
	m_SC_XOPEN_STREAMS
,

526 
	#_SC_XOPEN_STREAMS
 
_SC_XOPEN_STREAMS


	)

528 
	m_SC_THREAD_ROBUST_PRIO_INHERIT
,

529 
	#_SC_THREAD_ROBUST_PRIO_INHERIT
 
_SC_THREAD_ROBUST_PRIO_INHERIT


	)

530 
	m_SC_THREAD_ROBUST_PRIO_PROTECT


531 
	#_SC_THREAD_ROBUST_PRIO_PROTECT
 
_SC_THREAD_ROBUST_PRIO_PROTECT


	)

537 
	m_CS_PATH
,

538 
	#_CS_PATH
 
_CS_PATH


	)

540 
	m_CS_V6_WIDTH_RESTRICTED_ENVS
,

541 
	#_CS_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

542 
	#_CS_POSIX_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

544 
	m_CS_GNU_LIBC_VERSION
,

545 
	#_CS_GNU_LIBC_VERSION
 
_CS_GNU_LIBC_VERSION


	)

546 
	m_CS_GNU_LIBPTHREAD_VERSION
,

547 
	#_CS_GNU_LIBPTHREAD_VERSION
 
_CS_GNU_LIBPTHREAD_VERSION


	)

549 
	m_CS_V5_WIDTH_RESTRICTED_ENVS
,

550 
	#_CS_V5_WIDTH_RESTRICTED_ENVS
 
_CS_V5_WIDTH_RESTRICTED_ENVS


	)

551 
	#_CS_POSIX_V5_WIDTH_RESTRICTED_ENVS
 
_CS_V5_WIDTH_RESTRICTED_ENVS


	)

553 
	m_CS_V7_WIDTH_RESTRICTED_ENVS
,

554 
	#_CS_V7_WIDTH_RESTRICTED_ENVS
 
_CS_V7_WIDTH_RESTRICTED_ENVS


	)

555 
	#_CS_POSIX_V7_WIDTH_RESTRICTED_ENVS
 
_CS_V7_WIDTH_RESTRICTED_ENVS


	)

557 
	m_CS_LFS_CFLAGS
 = 1000,

558 
	#_CS_LFS_CFLAGS
 
_CS_LFS_CFLAGS


	)

559 
	m_CS_LFS_LDFLAGS
,

560 
	#_CS_LFS_LDFLAGS
 
_CS_LFS_LDFLAGS


	)

561 
	m_CS_LFS_LIBS
,

562 
	#_CS_LFS_LIBS
 
_CS_LFS_LIBS


	)

563 
	m_CS_LFS_LINTFLAGS
,

564 
	#_CS_LFS_LINTFLAGS
 
_CS_LFS_LINTFLAGS


	)

565 
	m_CS_LFS64_CFLAGS
,

566 
	#_CS_LFS64_CFLAGS
 
_CS_LFS64_CFLAGS


	)

567 
	m_CS_LFS64_LDFLAGS
,

568 
	#_CS_LFS64_LDFLAGS
 
_CS_LFS64_LDFLAGS


	)

569 
	m_CS_LFS64_LIBS
,

570 
	#_CS_LFS64_LIBS
 
_CS_LFS64_LIBS


	)

571 
	m_CS_LFS64_LINTFLAGS
,

572 
	#_CS_LFS64_LINTFLAGS
 
_CS_LFS64_LINTFLAGS


	)

574 
	m_CS_XBS5_ILP32_OFF32_CFLAGS
 = 1100,

575 
	#_CS_XBS5_ILP32_OFF32_CFLAGS
 
_CS_XBS5_ILP32_OFF32_CFLAGS


	)

576 
	m_CS_XBS5_ILP32_OFF32_LDFLAGS
,

577 
	#_CS_XBS5_ILP32_OFF32_LDFLAGS
 
_CS_XBS5_ILP32_OFF32_LDFLAGS


	)

578 
	m_CS_XBS5_ILP32_OFF32_LIBS
,

579 
	#_CS_XBS5_ILP32_OFF32_LIBS
 
_CS_XBS5_ILP32_OFF32_LIBS


	)

580 
	m_CS_XBS5_ILP32_OFF32_LINTFLAGS
,

581 
	#_CS_XBS5_ILP32_OFF32_LINTFLAGS
 
_CS_XBS5_ILP32_OFF32_LINTFLAGS


	)

582 
	m_CS_XBS5_ILP32_OFFBIG_CFLAGS
,

583 
	#_CS_XBS5_ILP32_OFFBIG_CFLAGS
 
_CS_XBS5_ILP32_OFFBIG_CFLAGS


	)

584 
	m_CS_XBS5_ILP32_OFFBIG_LDFLAGS
,

585 
	#_CS_XBS5_ILP32_OFFBIG_LDFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LDFLAGS


	)

586 
	m_CS_XBS5_ILP32_OFFBIG_LIBS
,

587 
	#_CS_XBS5_ILP32_OFFBIG_LIBS
 
_CS_XBS5_ILP32_OFFBIG_LIBS


	)

588 
	m_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
,

589 
	#_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LINTFLAGS


	)

590 
	m_CS_XBS5_LP64_OFF64_CFLAGS
,

591 
	#_CS_XBS5_LP64_OFF64_CFLAGS
 
_CS_XBS5_LP64_OFF64_CFLAGS


	)

592 
	m_CS_XBS5_LP64_OFF64_LDFLAGS
,

593 
	#_CS_XBS5_LP64_OFF64_LDFLAGS
 
_CS_XBS5_LP64_OFF64_LDFLAGS


	)

594 
	m_CS_XBS5_LP64_OFF64_LIBS
,

595 
	#_CS_XBS5_LP64_OFF64_LIBS
 
_CS_XBS5_LP64_OFF64_LIBS


	)

596 
	m_CS_XBS5_LP64_OFF64_LINTFLAGS
,

597 
	#_CS_XBS5_LP64_OFF64_LINTFLAGS
 
_CS_XBS5_LP64_OFF64_LINTFLAGS


	)

598 
	m_CS_XBS5_LPBIG_OFFBIG_CFLAGS
,

599 
	#_CS_XBS5_LPBIG_OFFBIG_CFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_CFLAGS


	)

600 
	m_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
,

601 
	#_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LDFLAGS


	)

602 
	m_CS_XBS5_LPBIG_OFFBIG_LIBS
,

603 
	#_CS_XBS5_LPBIG_OFFBIG_LIBS
 
_CS_XBS5_LPBIG_OFFBIG_LIBS


	)

604 
	m_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
,

605 
	#_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS


	)

607 
	m_CS_POSIX_V6_ILP32_OFF32_CFLAGS
,

608 
	#_CS_POSIX_V6_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_CFLAGS


	)

609 
	m_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
,

610 
	#_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LDFLAGS


	)

611 
	m_CS_POSIX_V6_ILP32_OFF32_LIBS
,

612 
	#_CS_POSIX_V6_ILP32_OFF32_LIBS
 
_CS_POSIX_V6_ILP32_OFF32_LIBS


	)

613 
	m_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
,

614 
	#_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS


	)

615 
	m_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
,

616 
	#_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS


	)

617 
	m_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
,

618 
	#_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS


	)

619 
	m_CS_POSIX_V6_ILP32_OFFBIG_LIBS
,

620 
	#_CS_POSIX_V6_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V6_ILP32_OFFBIG_LIBS


	)

621 
	m_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
,

622 
	#_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS


	)

623 
	m_CS_POSIX_V6_LP64_OFF64_CFLAGS
,

624 
	#_CS_POSIX_V6_LP64_OFF64_CFLAGS
 
_CS_POSIX_V6_LP64_OFF64_CFLAGS


	)

625 
	m_CS_POSIX_V6_LP64_OFF64_LDFLAGS
,

626 
	#_CS_POSIX_V6_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LDFLAGS


	)

627 
	m_CS_POSIX_V6_LP64_OFF64_LIBS
,

628 
	#_CS_POSIX_V6_LP64_OFF64_LIBS
 
_CS_POSIX_V6_LP64_OFF64_LIBS


	)

629 
	m_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
,

630 
	#_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LINTFLAGS


	)

631 
	m_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
,

632 
	#_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS


	)

633 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
,

634 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS


	)

635 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
,

636 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LIBS


	)

637 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
,

638 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS


	)

640 
	m_CS_POSIX_V7_ILP32_OFF32_CFLAGS
,

641 
	#_CS_POSIX_V7_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_CFLAGS


	)

642 
	m_CS_POSIX_V7_ILP32_OFF32_LDFLAGS
,

643 
	#_CS_POSIX_V7_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_LDFLAGS


	)

644 
	m_CS_POSIX_V7_ILP32_OFF32_LIBS
,

645 
	#_CS_POSIX_V7_ILP32_OFF32_LIBS
 
_CS_POSIX_V7_ILP32_OFF32_LIBS


	)

646 
	m_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS
,

647 
	#_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS


	)

648 
	m_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS
,

649 
	#_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS


	)

650 
	m_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS
,

651 
	#_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS


	)

652 
	m_CS_POSIX_V7_ILP32_OFFBIG_LIBS
,

653 
	#_CS_POSIX_V7_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V7_ILP32_OFFBIG_LIBS


	)

654 
	m_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS
,

655 
	#_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS


	)

656 
	m_CS_POSIX_V7_LP64_OFF64_CFLAGS
,

657 
	#_CS_POSIX_V7_LP64_OFF64_CFLAGS
 
_CS_POSIX_V7_LP64_OFF64_CFLAGS


	)

658 
	m_CS_POSIX_V7_LP64_OFF64_LDFLAGS
,

659 
	#_CS_POSIX_V7_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V7_LP64_OFF64_LDFLAGS


	)

660 
	m_CS_POSIX_V7_LP64_OFF64_LIBS
,

661 
	#_CS_POSIX_V7_LP64_OFF64_LIBS
 
_CS_POSIX_V7_LP64_OFF64_LIBS


	)

662 
	m_CS_POSIX_V7_LP64_OFF64_LINTFLAGS
,

663 
	#_CS_POSIX_V7_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V7_LP64_OFF64_LINTFLAGS


	)

664 
	m_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS
,

665 
	#_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS


	)

666 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS
,

667 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS


	)

668 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LIBS
,

669 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LIBS


	)

670 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS


671 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS


	)

	@/usr/include/bits/environments.h

19 #i‚de‡
_UNISTD_H


23 
	~<bôs/w‹dsize.h
>

43 #i‡
__WORDSIZE
 == 64

57 
	#_POSIX_V7_LPBIG_OFFBIG
 -1

	)

58 
	#_POSIX_V6_LPBIG_OFFBIG
 -1

	)

59 
	#_XBS5_LPBIG_OFFBIG
 -1

	)

62 
	#_POSIX_V7_LP64_OFF64
 1

	)

63 
	#_POSIX_V6_LP64_OFF64
 1

	)

64 
	#_XBS5_LP64_OFF64
 1

	)

70 
	#_POSIX_V7_ILP32_OFF32
 1

	)

71 
	#_POSIX_V7_ILP32_OFFBIG
 1

	)

72 
	#_POSIX_V6_ILP32_OFF32
 1

	)

73 
	#_POSIX_V6_ILP32_OFFBIG
 1

	)

74 
	#_XBS5_ILP32_OFF32
 1

	)

75 
	#_XBS5_ILP32_OFFBIG
 1

	)

92 
	#__ILP32_OFF32_CFLAGS
 "-m32"

	)

93 
	#__ILP32_OFFBIG_CFLAGS
 "-m32 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"

	)

94 
	#__ILP32_OFF32_LDFLAGS
 "-m32"

	)

95 
	#__ILP32_OFFBIG_LDFLAGS
 "-m32"

	)

96 
	#__LP64_OFF64_CFLAGS
 "-m64"

	)

97 
	#__LP64_OFF64_LDFLAGS
 "-m64"

	)

	@/usr/include/bits/ioctl-types.h

20 #i‚de‡
_SYS_IOCTL_H


25 
	~<asm/io˘ls.h
>

28 
	swösize


30 
	mws_row
;

31 
	mws_cﬁ
;

32 
	mws_xpixñ
;

33 
	mws_ypixñ
;

36 
	#NCC
 8

	)

37 
	sãrmio


39 
	mc_iÊag
;

40 
	mc_oÊag
;

41 
	mc_cÊag
;

42 
	mc_lÊag
;

43 
	mc_löe
;

44 
	mc_cc
[
NCC
];

48 
	#TIOCM_LE
 0x001

	)

49 
	#TIOCM_DTR
 0x002

	)

50 
	#TIOCM_RTS
 0x004

	)

51 
	#TIOCM_ST
 0x008

	)

52 
	#TIOCM_SR
 0x010

	)

53 
	#TIOCM_CTS
 0x020

	)

54 
	#TIOCM_CAR
 0x040

	)

55 
	#TIOCM_RNG
 0x080

	)

56 
	#TIOCM_DSR
 0x100

	)

57 
	#TIOCM_CD
 
TIOCM_CAR


	)

58 
	#TIOCM_RI
 
TIOCM_RNG


	)

63 
	#N_TTY
 0

	)

64 
	#N_SLIP
 1

	)

65 
	#N_MOUSE
 2

	)

66 
	#N_PPP
 3

	)

67 
	#N_STRIP
 4

	)

68 
	#N_AX25
 5

	)

69 
	#N_X25
 6

	)

70 
	#N_6PACK
 7

	)

71 
	#N_MASC
 8

	)

72 
	#N_R3964
 9

	)

73 
	#N_PROFIBUS_FDL
 10

	)

74 
	#N_IRDA
 11

	)

75 
	#N_SMSBLOCK
 12

	)

76 
	#N_HDLC
 13

	)

77 
	#N_SYNC_PPP
 14

	)

78 
	#N_HCI
 15

	)

	@/usr/include/bits/ioctls.h

19 #i‚de‡
_SYS_IOCTL_H


24 
	~<asm/io˘ls.h
>

27 
	#SIOCADDRT
 0x890B

	)

28 
	#SIOCDELRT
 0x890C

	)

29 
	#SIOCRTMSG
 0x890D

	)

32 
	#SIOCGIFNAME
 0x8910

	)

33 
	#SIOCSIFLINK
 0x8911

	)

34 
	#SIOCGIFCONF
 0x8912

	)

35 
	#SIOCGIFFLAGS
 0x8913

	)

36 
	#SIOCSIFFLAGS
 0x8914

	)

37 
	#SIOCGIFADDR
 0x8915

	)

38 
	#SIOCSIFADDR
 0x8916

	)

39 
	#SIOCGIFDSTADDR
 0x8917

	)

40 
	#SIOCSIFDSTADDR
 0x8918

	)

41 
	#SIOCGIFBRDADDR
 0x8919

	)

42 
	#SIOCSIFBRDADDR
 0x891®

	)

43 
	#SIOCGIFNETMASK
 0x891b

	)

44 
	#SIOCSIFNETMASK
 0x891¯

	)

45 
	#SIOCGIFMETRIC
 0x891d

	)

46 
	#SIOCSIFMETRIC
 0x891ê

	)

47 
	#SIOCGIFMEM
 0x891‡

	)

48 
	#SIOCSIFMEM
 0x8920

	)

49 
	#SIOCGIFMTU
 0x8921

	)

50 
	#SIOCSIFMTU
 0x8922

	)

51 
	#SIOCSIFNAME
 0x8923

	)

52 
	#SIOCSIFHWADDR
 0x8924

	)

53 
	#SIOCGIFENCAP
 0x8925

	)

54 
	#SIOCSIFENCAP
 0x8926

	)

55 
	#SIOCGIFHWADDR
 0x8927

	)

56 
	#SIOCGIFSLAVE
 0x8929

	)

57 
	#SIOCSIFSLAVE
 0x8930

	)

58 
	#SIOCADDMULTI
 0x8931

	)

59 
	#SIOCDELMULTI
 0x8932

	)

60 
	#SIOCGIFINDEX
 0x8933

	)

61 
	#SIOGIFINDEX
 
SIOCGIFINDEX


	)

62 
	#SIOCSIFPFLAGS
 0x8934

	)

63 
	#SIOCGIFPFLAGS
 0x8935

	)

64 
	#SIOCDIFADDR
 0x8936

	)

65 
	#SIOCSIFHWBROADCAST
 0x8937

	)

66 
	#SIOCGIFCOUNT
 0x8938

	)

68 
	#SIOCGIFBR
 0x8940

	)

69 
	#SIOCSIFBR
 0x8941

	)

71 
	#SIOCGIFTXQLEN
 0x8942

	)

72 
	#SIOCSIFTXQLEN
 0x8943

	)

77 
	#SIOCDARP
 0x8953

	)

78 
	#SIOCGARP
 0x8954

	)

79 
	#SIOCSARP
 0x8955

	)

82 
	#SIOCDRARP
 0x8960

	)

83 
	#SIOCGRARP
 0x8961

	)

84 
	#SIOCSRARP
 0x8962

	)

88 
	#SIOCGIFMAP
 0x8970

	)

89 
	#SIOCSIFMAP
 0x8971

	)

93 
	#SIOCADDDLCI
 0x8980

	)

94 
	#SIOCDELDLCI
 0x8981

	)

103 
	#SIOCDEVPRIVATE
 0x89F0

	)

109 
	#SIOCPROTOPRIVATE
 0x89E0

	)

	@/usr/include/bits/posix_opt.h

20 #i‚def 
_BITS_POSIX_OPT_H


21 
	#_BITS_POSIX_OPT_H
 1

	)

24 
	#_POSIX_JOB_CONTROL
 1

	)

27 
	#_POSIX_SAVED_IDS
 1

	)

30 
	#_POSIX_PRIORITY_SCHEDULING
 200809L

	)

33 
	#_POSIX_SYNCHRONIZED_IO
 200809L

	)

36 
	#_POSIX_FSYNC
 200809L

	)

39 
	#_POSIX_MAPPED_FILES
 200809L

	)

42 
	#_POSIX_MEMLOCK
 200809L

	)

45 
	#_POSIX_MEMLOCK_RANGE
 200809L

	)

48 
	#_POSIX_MEMORY_PROTECTION
 200809L

	)

51 
	#_POSIX_CHOWN_RESTRICTED
 0

	)

55 
	#_POSIX_VDISABLE
 '\0'

	)

58 
	#_POSIX_NO_TRUNC
 1

	)

61 
	#_XOPEN_REALTIME
 1

	)

64 
	#_XOPEN_REALTIME_THREADS
 1

	)

67 
	#_XOPEN_SHM
 1

	)

70 
	#_POSIX_THREADS
 200809L

	)

73 
	#_POSIX_REENTRANT_FUNCTIONS
 1

	)

74 
	#_POSIX_THREAD_SAFE_FUNCTIONS
 200809L

	)

77 
	#_POSIX_THREAD_PRIORITY_SCHEDULING
 200809L

	)

80 
	#_POSIX_THREAD_ATTR_STACKSIZE
 200809L

	)

83 
	#_POSIX_THREAD_ATTR_STACKADDR
 200809L

	)

86 
	#_POSIX_THREAD_PRIO_INHERIT
 200809L

	)

90 
	#_POSIX_THREAD_PRIO_PROTECT
 200809L

	)

92 #ifde‡
__USE_XOPEN2K8


94 
	#_POSIX_THREAD_ROBUST_PRIO_INHERIT
 200809L

	)

97 
	#_POSIX_THREAD_ROBUST_PRIO_PROTECT
 -1

	)

101 
	#_POSIX_SEMAPHORES
 200809L

	)

104 
	#_POSIX_REALTIME_SIGNALS
 200809L

	)

107 
	#_POSIX_ASYNCHRONOUS_IO
 200809L

	)

108 
	#_POSIX_ASYNC_IO
 1

	)

110 
	#_LFS_ASYNCHRONOUS_IO
 1

	)

112 
	#_POSIX_PRIORITIZED_IO
 200809L

	)

115 
	#_LFS64_ASYNCHRONOUS_IO
 1

	)

118 
	#_LFS_LARGEFILE
 1

	)

119 
	#_LFS64_LARGEFILE
 1

	)

120 
	#_LFS64_STDIO
 1

	)

123 
	#_POSIX_SHARED_MEMORY_OBJECTS
 200809L

	)

126 
	#_POSIX_CPUTIME
 0

	)

129 
	#_POSIX_THREAD_CPUTIME
 0

	)

132 
	#_POSIX_REGEXP
 1

	)

135 
	#_POSIX_READER_WRITER_LOCKS
 200809L

	)

138 
	#_POSIX_SHELL
 1

	)

141 
	#_POSIX_TIMEOUTS
 200809L

	)

144 
	#_POSIX_SPIN_LOCKS
 200809L

	)

147 
	#_POSIX_SPAWN
 200809L

	)

150 
	#_POSIX_TIMERS
 200809L

	)

153 
	#_POSIX_BARRIERS
 200809L

	)

156 
	#_POSIX_MESSAGE_PASSING
 200809L

	)

159 
	#_POSIX_THREAD_PROCESS_SHARED
 200809L

	)

162 
	#_POSIX_MONOTONIC_CLOCK
 0

	)

165 
	#_POSIX_CLOCK_SELECTION
 200809L

	)

168 
	#_POSIX_ADVISORY_INFO
 200809L

	)

171 
	#_POSIX_IPV6
 200809L

	)

174 
	#_POSIX_RAW_SOCKETS
 200809L

	)

177 
	#_POSIX2_CHAR_TERM
 200809L

	)

180 
	#_POSIX_SPORADIC_SERVER
 -1

	)

181 
	#_POSIX_THREAD_SPORADIC_SERVER
 -1

	)

184 
	#_POSIX_TRACE
 -1

	)

185 
	#_POSIX_TRACE_EVENT_FILTER
 -1

	)

186 
	#_POSIX_TRACE_INHERIT
 -1

	)

187 
	#_POSIX_TRACE_LOG
 -1

	)

190 
	#_POSIX_TYPED_MEMORY_OBJECTS
 -1

	)

	@/usr/include/bits/sigset.h

21 #i‚def 
_SIGSET_H_ty≥s


22 
	#_SIGSET_H_ty≥s
 1

	)

24 
	t__sig_©omic_t
;

28 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

31 
	m__vÆ
[
_SIGSET_NWORDS
];

32 } 
	t__sig£t_t
;

43 #i‡!
deföed
 
_SIGSET_H_‚s
 && deföed 
_SIGNAL_H


44 
	#_SIGSET_H_‚s
 1

	)

46 #i‚de‡
_EXTERN_INLINE


47 
	#_EXTERN_INLINE
 
__exã∫_ölöe


	)

51 
	#__sigmask
(
sig
) \

52 (((Ë1Ë<< (((
sig
Ë- 1Ë% (8 *  ())))

	)

55 
	#__sigw‹d
(
sig
Ë(((sigË- 1Ë/ (8 *  ()))

	)

57 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

58 
	#__sigem±y£t
(
£t
) \

59 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

60 
sig£t_t
 *
__£t
 = (
£t
); \

61 --
__˙t
 >0Ë
__£t
->
__vÆ
[__cnt] = 0; \

62 0; }))

	)

63 
	#__sigfûl£t
(
£t
) \

64 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

65 
sig£t_t
 *
__£t
 = (
£t
); \

66 --
__˙t
 >0Ë
__£t
->
__vÆ
[__cnt] = ~0UL; \

67 0; }))

	)

69 #ifde‡
__USE_GNU


73 
	#__sigi£m±y£t
(
£t
) \

74 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

75 c⁄° 
sig£t_t
 *
__£t
 = (
£t
); \

76 
__ªt
 = 
__£t
->
__vÆ
[--
__˙t
]; \

77 !
__ªt
 && --
__˙t
 >= 0) \

78 
__ªt
 = 
__£t
->
__vÆ
[
__˙t
]; \

79 
__ªt
 =0; }))

	)

80 
	#__sig™d£t
(
de°
, 
À·
, 
right
) \

81 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

82 
sig£t_t
 *
__de°
 = (
de°
); \

83 c⁄° 
sig£t_t
 *
__À·
 = (
À·
); \

84 c⁄° 
sig£t_t
 *
__right
 = (
right
); \

85 --
__˙t
 >= 0) \

86 
__de°
->
__vÆ
[
__˙t
] = (
__À·
->__val[__cnt] \

87 & 
__right
->
__vÆ
[
__˙t
]); \

88 0; }))

	)

89 
	#__sig‹£t
(
de°
, 
À·
, 
right
) \

90 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

91 
sig£t_t
 *
__de°
 = (
de°
); \

92 c⁄° 
sig£t_t
 *
__À·
 = (
À·
); \

93 c⁄° 
sig£t_t
 *
__right
 = (
right
); \

94 --
__˙t
 >= 0) \

95 
__de°
->
__vÆ
[
__˙t
] = (
__À·
->__val[__cnt] \

96 | 
__right
->
__vÆ
[
__˙t
]); \

97 0; }))

	)

104 
__sigismembî
 (
__c⁄°
 
__sig£t_t
 *, );

105 
__sigadd£t
 (
__sig£t_t
 *, );

106 
__sigdñ£t
 (
__sig£t_t
 *, );

108 #ifde‡
__USE_EXTERN_INLINES


109 
	#__SIGSETFN
(
NAME
, 
BODY
, 
CONST
) \

110 
_EXTERN_INLINE
 \

111 
	`NAME
 (
CONST
 
__sig£t_t
 *
__£t
, 
__sig
) \

113 
__mask
 = 
	`__sigmask
 (
__sig
); \

114 
__w‹d
 = 
	`__sigw‹d
 (
__sig
); \

115  
BODY
; \

116 }

	)

118 
__SIGSETFN
 (
__sigismembî
, (
__£t
->
__vÆ
[
__w‹d
] & 
__mask
Ë? 1 : 0, 
__c⁄°
)

119 
__SIGSETFN
 (
__sigadd£t
, ((
__£t
->
__vÆ
[
__w‹d
] |
__mask
), 0), )

120 
__SIGSETFN
 (
__sigdñ£t
, ((
__£t
->
__vÆ
[
__w‹d
] &~
__mask
), 0), )

122 #unde‡
__SIGSETFN


	@/usr/include/bits/socket.h

21 #i‚de‡
__BITS_SOCKET_H


22 
	#__BITS_SOCKET_H


	)

24 #i‚de‡
_SYS_SOCKET_H


28 
	#__√ed_size_t


	)

29 
	~<°ddef.h
>

31 
	~<sys/ty≥s.h
>

34 #i‚de‡
__sockÀn_t_deföed


35 
__sockÀn_t
 
	tsockÀn_t
;

36 
	#__sockÀn_t_deföed


	)

40 
	e__sockë_ty≥


42 
	mSOCK_STREAM
 = 1,

44 
	#SOCK_STREAM
 
SOCK_STREAM


	)

45 
	mSOCK_DGRAM
 = 2,

47 
	#SOCK_DGRAM
 
SOCK_DGRAM


	)

48 
	mSOCK_RAW
 = 3,

49 
	#SOCK_RAW
 
SOCK_RAW


	)

50 
	mSOCK_RDM
 = 4,

51 
	#SOCK_RDM
 
SOCK_RDM


	)

52 
	mSOCK_SEQPACKET
 = 5,

54 
	#SOCK_SEQPACKET
 
SOCK_SEQPACKET


	)

55 
	mSOCK_DCCP
 = 6,

56 
	#SOCK_DCCP
 
SOCK_DCCP


	)

57 
	mSOCK_PACKET
 = 10,

60 
	#SOCK_PACKET
 
SOCK_PACKET


	)

65 
	mSOCK_CLOEXEC
 = 02000000,

67 
	#SOCK_CLOEXEC
 
SOCK_CLOEXEC


	)

68 
	mSOCK_NONBLOCK
 = 04000

70 
	#SOCK_NONBLOCK
 
SOCK_NONBLOCK


	)

74 
	#PF_UNSPEC
 0

	)

75 
	#PF_LOCAL
 1

	)

76 
	#PF_UNIX
 
PF_LOCAL


	)

77 
	#PF_FILE
 
PF_LOCAL


	)

78 
	#PF_INET
 2

	)

79 
	#PF_AX25
 3

	)

80 
	#PF_IPX
 4

	)

81 
	#PF_APPLETALK
 5

	)

82 
	#PF_NETROM
 6

	)

83 
	#PF_BRIDGE
 7

	)

84 
	#PF_ATMPVC
 8

	)

85 
	#PF_X25
 9

	)

86 
	#PF_INET6
 10

	)

87 
	#PF_ROSE
 11

	)

88 
	#PF_DEC√t
 12

	)

89 
	#PF_NETBEUI
 13

	)

90 
	#PF_SECURITY
 14

	)

91 
	#PF_KEY
 15

	)

92 
	#PF_NETLINK
 16

	)

93 
	#PF_ROUTE
 
PF_NETLINK


	)

94 
	#PF_PACKET
 17

	)

95 
	#PF_ASH
 18

	)

96 
	#PF_ECONET
 19

	)

97 
	#PF_ATMSVC
 20

	)

98 
	#PF_RDS
 21

	)

99 
	#PF_SNA
 22

	)

100 
	#PF_IRDA
 23

	)

101 
	#PF_PPPOX
 24

	)

102 
	#PF_WANPIPE
 25

	)

103 
	#PF_LLC
 26

	)

104 
	#PF_CAN
 29

	)

105 
	#PF_TIPC
 30

	)

106 
	#PF_BLUETOOTH
 31

	)

107 
	#PF_IUCV
 32

	)

108 
	#PF_RXRPC
 33

	)

109 
	#PF_ISDN
 34

	)

110 
	#PF_PHONET
 35

	)

111 
	#PF_IEEE802154
 36

	)

112 
	#PF_MAX
 37

	)

115 
	#AF_UNSPEC
 
PF_UNSPEC


	)

116 
	#AF_LOCAL
 
PF_LOCAL


	)

117 
	#AF_UNIX
 
PF_UNIX


	)

118 
	#AF_FILE
 
PF_FILE


	)

119 
	#AF_INET
 
PF_INET


	)

120 
	#AF_AX25
 
PF_AX25


	)

121 
	#AF_IPX
 
PF_IPX


	)

122 
	#AF_APPLETALK
 
PF_APPLETALK


	)

123 
	#AF_NETROM
 
PF_NETROM


	)

124 
	#AF_BRIDGE
 
PF_BRIDGE


	)

125 
	#AF_ATMPVC
 
PF_ATMPVC


	)

126 
	#AF_X25
 
PF_X25


	)

127 
	#AF_INET6
 
PF_INET6


	)

128 
	#AF_ROSE
 
PF_ROSE


	)

129 
	#AF_DEC√t
 
PF_DEC√t


	)

130 
	#AF_NETBEUI
 
PF_NETBEUI


	)

131 
	#AF_SECURITY
 
PF_SECURITY


	)

132 
	#AF_KEY
 
PF_KEY


	)

133 
	#AF_NETLINK
 
PF_NETLINK


	)

134 
	#AF_ROUTE
 
PF_ROUTE


	)

135 
	#AF_PACKET
 
PF_PACKET


	)

136 
	#AF_ASH
 
PF_ASH


	)

137 
	#AF_ECONET
 
PF_ECONET


	)

138 
	#AF_ATMSVC
 
PF_ATMSVC


	)

139 
	#AF_RDS
 
PF_RDS


	)

140 
	#AF_SNA
 
PF_SNA


	)

141 
	#AF_IRDA
 
PF_IRDA


	)

142 
	#AF_PPPOX
 
PF_PPPOX


	)

143 
	#AF_WANPIPE
 
PF_WANPIPE


	)

144 
	#AF_LLC
 
PF_LLC


	)

145 
	#AF_CAN
 
PF_CAN


	)

146 
	#AF_TIPC
 
PF_TIPC


	)

147 
	#AF_BLUETOOTH
 
PF_BLUETOOTH


	)

148 
	#AF_IUCV
 
PF_IUCV


	)

149 
	#AF_RXRPC
 
PF_RXRPC


	)

150 
	#AF_ISDN
 
PF_ISDN


	)

151 
	#AF_PHONET
 
PF_PHONET


	)

152 
	#AF_IEEE802154
 
PF_IEEE802154


	)

153 
	#AF_MAX
 
PF_MAX


	)

159 
	#SOL_RAW
 255

	)

160 
	#SOL_DECNET
 261

	)

161 
	#SOL_X25
 262

	)

162 
	#SOL_PACKET
 263

	)

163 
	#SOL_ATM
 264

	)

164 
	#SOL_AAL
 265

	)

165 
	#SOL_IRDA
 266

	)

168 
	#SOMAXCONN
 128

	)

171 
	~<bôs/sockaddr.h
>

174 
	ssockaddr


176 
__SOCKADDR_COMMON
 (
ß_
);

177 
	mß_d©a
[14];

183 
	#__ss_Æig¡y≥
 

	)

184 
	#_SS_SIZE
 128

	)

185 
	#_SS_PADSIZE
 (
_SS_SIZE
 - (2 *  (
__ss_Æig¡y≥
)))

	)

187 
	ssockaddr_°‹age


189 
__SOCKADDR_COMMON
 (
ss_
);

190 
__ss_Æig¡y≥
 
	m__ss_Æign
;

191 
	m__ss_∑ddög
[
_SS_PADSIZE
];

198 
	mMSG_OOB
 = 0x01,

199 
	#MSG_OOB
 
MSG_OOB


	)

200 
	mMSG_PEEK
 = 0x02,

201 
	#MSG_PEEK
 
MSG_PEEK


	)

202 
	mMSG_DONTROUTE
 = 0x04,

203 
	#MSG_DONTROUTE
 
MSG_DONTROUTE


	)

204 #ifde‡
__USE_GNU


206 
	mMSG_TRYHARD
 = 
MSG_DONTROUTE
,

207 
	#MSG_TRYHARD
 
MSG_DONTROUTE


	)

209 
	mMSG_CTRUNC
 = 0x08,

210 
	#MSG_CTRUNC
 
MSG_CTRUNC


	)

211 
	mMSG_PROXY
 = 0x10,

212 
	#MSG_PROXY
 
MSG_PROXY


	)

213 
	mMSG_TRUNC
 = 0x20,

214 
	#MSG_TRUNC
 
MSG_TRUNC


	)

215 
	mMSG_DONTWAIT
 = 0x40,

216 
	#MSG_DONTWAIT
 
MSG_DONTWAIT


	)

217 
	mMSG_EOR
 = 0x80,

218 
	#MSG_EOR
 
MSG_EOR


	)

219 
	mMSG_WAITALL
 = 0x100,

220 
	#MSG_WAITALL
 
MSG_WAITALL


	)

221 
	mMSG_FIN
 = 0x200,

222 
	#MSG_FIN
 
MSG_FIN


	)

223 
	mMSG_SYN
 = 0x400,

224 
	#MSG_SYN
 
MSG_SYN


	)

225 
	mMSG_CONFIRM
 = 0x800,

226 
	#MSG_CONFIRM
 
MSG_CONFIRM


	)

227 
	mMSG_RST
 = 0x1000,

228 
	#MSG_RST
 
MSG_RST


	)

229 
	mMSG_ERRQUEUE
 = 0x2000,

230 
	#MSG_ERRQUEUE
 
MSG_ERRQUEUE


	)

231 
	mMSG_NOSIGNAL
 = 0x4000,

232 
	#MSG_NOSIGNAL
 
MSG_NOSIGNAL


	)

233 
	mMSG_MORE
 = 0x8000,

234 
	#MSG_MORE
 
MSG_MORE


	)

236 
	mMSG_CMSG_CLOEXEC
 = 0x40000000

239 
	#MSG_CMSG_CLOEXEC
 
MSG_CMSG_CLOEXEC


	)

245 
	smsghdr


247 *
	mmsg_«me
;

248 
sockÀn_t
 
	mmsg_«mñí
;

250 
iovec
 *
	mmsg_iov
;

251 
size_t
 
	mmsg_iovÀn
;

253 *
	mmsg_c⁄åﬁ
;

254 
size_t
 
	mmsg_c⁄åﬁÀn
;

259 
	mmsg_Êags
;

263 
	scmsghdr


265 
size_t
 
	mcmsg_Àn
;

270 
	mcmsg_Àvñ
;

271 
	mcmsg_ty≥
;

272 #i‡(!
deföed
 
__STRICT_ANSI__
 && 
__GNUC__
 >2Ë|| 
__STDC_VERSION__
 >= 199901L

273 
__exãnsi⁄__
 
__cmsg_d©a
 
	m__Êex¨r
;

278 #i‡(!
deföed
 
__STRICT_ANSI__
 && 
__GNUC__
 >2Ë|| 
__STDC_VERSION__
 >= 199901L

279 
	#CMSG_DATA
(
cmsg
Ë((cmsg)->
__cmsg_d©a
)

	)

281 
	#CMSG_DATA
(
cmsg
Ë((*Ë((
cmsghdr
 *Ë(cmsgË+ 1))

	)

283 
	#CMSG_NXTHDR
(
mhdr
, 
cmsg
Ë
	`__cmsg_nxthdr
 (mhdr, cmsg)

	)

284 
	#CMSG_FIRSTHDR
(
mhdr
) \

285 ((
size_t
Ë(
mhdr
)->
msg_c⁄åﬁÀn
 > (
cmsghdr
) \

286 ? (
cmsghdr
 *Ë(
mhdr
)->
msg_c⁄åﬁ
 : (cmsghd∏*Ë0)

	)

287 
	#CMSG_ALIGN
(
Àn
Ë((÷íË+  (
size_t
) - 1) \

288 & (
size_t
Ë~( (size_tË- 1))

	)

289 
	#CMSG_SPACE
(
Àn
Ë(
	`CMSG_ALIGN
 (len) \

290 + 
	`CMSG_ALIGN
 ( (
cmsghdr
)))

	)

291 
	#CMSG_LEN
(
Àn
Ë(
	`CMSG_ALIGN
 ( (
cmsghdr
)Ë+ (Àn))

	)

293 
cmsghdr
 *
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
,

294 
cmsghdr
 *
__cmsg
Ë
__THROW
;

295 #ifde‡
__USE_EXTERN_INLINES


296 #i‚de‡
_EXTERN_INLINE


297 
	#_EXTERN_INLINE
 
__exã∫_ölöe


	)

299 
_EXTERN_INLINE
 
cmsghdr
 *

300 
	`__NTH
 (
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
, 
cmsghdr
 *
__cmsg
))

302 i‡((
size_t
Ë
__cmsg
->
cmsg_Àn
 <  (
cmsghdr
))

306 
__cmsg
 = (
cmsghdr
 *) ((*) __cmsg

307 + 
	`CMSG_ALIGN
 (
__cmsg
->
cmsg_Àn
));

308 i‡((*Ë(
__cmsg
 + 1Ë> ((*Ë
__mhdr
->
msg_c⁄åﬁ


309 + 
__mhdr
->
msg_c⁄åﬁÀn
)

310 || ((*Ë
__cmsg
 + 
	`CMSG_ALIGN
 (__cmsg->
cmsg_Àn
)

311 > ((*Ë
__mhdr
->
msg_c⁄åﬁ
 + __mhdr->
msg_c⁄åﬁÀn
)))

314  
__cmsg
;

315 
	}
}

322 
	mSCM_RIGHTS
 = 0x01

323 
	#SCM_RIGHTS
 
SCM_RIGHTS


	)

324 #ifde‡
__USE_GNU


325 , 
	mSCM_CREDENTIALS
 = 0x02

326 
	#SCM_CREDENTIALS
 
SCM_CREDENTIALS


	)

330 #ifde‡
__USE_GNU


332 
	su¸ed


334 
pid_t
 
	mpid
;

335 
uid_t
 
	muid
;

336 
gid_t
 
	mgid
;

341 #i‡!
deföed
 
__USE_MISC
 && !deföed 
__USE_GNU


342 #i‚de‡
FIOGETOWN


343 
	#__SYS_SOCKET_H_undef_FIOGETOWN


	)

345 #i‚de‡
FIOSETOWN


346 
	#__SYS_SOCKET_H_undef_FIOSETOWN


	)

348 #i‚de‡
SIOCATMARK


349 
	#__SYS_SOCKET_H_undef_SIOCATMARK


	)

351 #i‚de‡
SIOCGPGRP


352 
	#__SYS_SOCKET_H_undef_SIOCGPGRP


	)

354 #i‚de‡
SIOCGSTAMP


355 
	#__SYS_SOCKET_H_undef_SIOCGSTAMP


	)

357 #i‚de‡
SIOCGSTAMPNS


358 
	#__SYS_SOCKET_H_undef_SIOCGSTAMPNS


	)

360 #i‚de‡
SIOCSPGRP


361 
	#__SYS_SOCKET_H_undef_SIOCSPGRP


	)

366 
	~<asm/sockë.h
>

368 #i‡!
deföed
 
__USE_MISC
 && !deföed 
__USE_GNU


369 #ifde‡
__SYS_SOCKET_H_undef_FIOGETOWN


370 #unde‡
__SYS_SOCKET_H_undef_FIOGETOWN


371 #unde‡
FIOGETOWN


373 #ifde‡
__SYS_SOCKET_H_undef_FIOSETOWN


374 #unde‡
__SYS_SOCKET_H_undef_FIOSETOWN


375 #unde‡
FIOSETOWN


377 #ifde‡
__SYS_SOCKET_H_undef_SIOCATMARK


378 #unde‡
__SYS_SOCKET_H_undef_SIOCATMARK


379 #unde‡
SIOCATMARK


381 #ifde‡
__SYS_SOCKET_H_undef_SIOCGPGRP


382 #unde‡
__SYS_SOCKET_H_undef_SIOCGPGRP


383 #unde‡
SIOCGPGRP


385 #ifde‡
__SYS_SOCKET_H_undef_SIOCGSTAMP


386 #unde‡
__SYS_SOCKET_H_undef_SIOCGSTAMP


387 #unde‡
SIOCGSTAMP


389 #ifde‡
__SYS_SOCKET_H_undef_SIOCGSTAMPNS


390 #unde‡
__SYS_SOCKET_H_undef_SIOCGSTAMPNS


391 #unde‡
SIOCGSTAMPNS


393 #ifde‡
__SYS_SOCKET_H_undef_SIOCSPGRP


394 #unde‡
__SYS_SOCKET_H_undef_SIOCSPGRP


395 #unde‡
SIOCSPGRP


400 
	slögî


402 
	ml_⁄off
;

403 
	ml_lögî
;

	@/usr/include/bits/socket2.h

20 #i‚de‡
_SYS_SOCKET_H


24 
ssize_t
 
__ªcv_chk
 (
__fd
, *
__buf
, 
size_t
 
__n
, size_à
__buÊí
,

25 
__Êags
);

26 
ssize_t
 
__REDIRECT
 (
__ªcv_Æüs
, (
__fd
, *
__buf
, 
size_t
 
__n
,

27 
__Êags
), 
ªcv
);

28 
ssize_t
 
__REDIRECT
 (
__ªcv_chk_w¨n
,

29 (
__fd
, *
__buf
, 
size_t
 
__n
, size_à
__buÊí
,

30 
__Êags
), 
__ªcv_chk
)

31 
__w¨«âr
 ("recv called with biggerÜengthÅhan size of destination "

34 
__exã∫_Æways_ölöe
 
ssize_t


35 
	$ªcv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__Êags
)

37 i‡(
	`__bos0
 (
__buf
Ë!(
size_t
) -1)

39 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

40  
	`__ªcv_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__Êags
);

42 i‡(
__n
 > 
	`__bos0
 (
__buf
))

43  
	`__ªcv_chk_w¨n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__Êags
);

45  
	`__ªcv_Æüs
 (
__fd
, 
__buf
, 
__n
, 
__Êags
);

46 
	}
}

48 
ssize_t
 
__ªcv‰om_chk
 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
,

49 
size_t
 
__buÊí
, 
__Êags
,

50 
__SOCKADDR_ARG
 
__addr
,

51 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
);

52 
ssize_t
 
__REDIRECT
 (
__ªcv‰om_Æüs
,

53 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
,

54 
__Êags
, 
__SOCKADDR_ARG
 
__addr
,

55 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
), 
ªcv‰om
);

56 
ssize_t
 
__REDIRECT
 (
__ªcv‰om_chk_w¨n
,

57 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
,

58 
size_t
 
__buÊí
, 
__Êags
,

59 
__SOCKADDR_ARG
 
__addr
,

60 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
), 
__ªcv‰om_chk
)

61 
__w¨«âr
 ("recvfrom called with biggerÜengthÅhan size of "

64 
__exã∫_Æways_ölöe
 
ssize_t


65 
	$ªcv‰om
 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
, 
__Êags
,

66 
__SOCKADDR_ARG
 
__addr
, 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
)

68 i‡(
	`__bos0
 (
__buf
Ë!(
size_t
) -1)

70 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

71  
	`__ªcv‰om_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__Êags
,

72 
__addr
, 
__addr_Àn
);

73 i‡(
__n
 > 
	`__bos0
 (
__buf
))

74  
	`__ªcv‰om_chk_w¨n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__Êags
,

75 
__addr
, 
__addr_Àn
);

77  
	`__ªcv‰om_Æüs
 (
__fd
, 
__buf
, 
__n
, 
__Êags
, 
__addr
, 
__addr_Àn
);

78 
	}
}

	@/usr/include/bits/stdio-ldbl.h

20 #i‚de‡
_STDIO_H


24 
__BEGIN_NAMESPACE_STD


25 
	$__LDBL_REDIR_DECL
 (
Ârötf
)

26 
	$__LDBL_REDIR_DECL
 (
¥ötf
)

27 
	$__LDBL_REDIR_DECL
 (
•rötf
)

28 
	$__LDBL_REDIR_DECL
 (
vÂrötf
)

29 
	$__LDBL_REDIR_DECL
 (
v¥ötf
)

30 
	$__LDBL_REDIR_DECL
 (
v•rötf
)

31 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

32 && !
deföed
 
__REDIRECT
 \

33 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

34 
	$__LDBL_REDIR1_DECL
 (
fsˇnf
, 
__∆dbl___isoc99_fsˇnf
)

35 
	$__LDBL_REDIR1_DECL
 (
sˇnf
, 
__∆dbl___isoc99_sˇnf
)

36 
	$__LDBL_REDIR1_DECL
 (
ssˇnf
, 
__∆dbl___isoc99_ssˇnf
)

38 
	$__LDBL_REDIR_DECL
 (
fsˇnf
)

39 
	$__LDBL_REDIR_DECL
 (
sˇnf
)

40 
	$__LDBL_REDIR_DECL
 (
ssˇnf
)

42 
__END_NAMESPACE_STD


44 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


45 
__BEGIN_NAMESPACE_C99


46 
	$__LDBL_REDIR_DECL
 (
¢¥ötf
)

47 
	$__LDBL_REDIR_DECL
 (
v¢¥ötf
)

48 
__END_NAMESPACE_C99


51 #ifdef 
__USE_ISOC99


52 
__BEGIN_NAMESPACE_C99


53 #i‡!
deföed
 
__USE_GNU
 && !deföed 
__REDIRECT
 \

54 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

55 
	$__LDBL_REDIR1_DECL
 (
vfsˇnf
, 
__∆dbl___isoc99_vfsˇnf
)

56 
	$__LDBL_REDIR1_DECL
 (
vsˇnf
, 
__∆dbl___isoc99_vsˇnf
)

57 
	$__LDBL_REDIR1_DECL
 (
vssˇnf
, 
__∆dbl___isoc99_vssˇnf
)

59 
	$__LDBL_REDIR_DECL
 (
vfsˇnf
)

60 
	$__LDBL_REDIR_DECL
 (
vssˇnf
)

61 
	$__LDBL_REDIR_DECL
 (
vsˇnf
)

63 
__END_NAMESPACE_C99


66 #ifde‡
__USE_GNU


67 
	$__LDBL_REDIR_DECL
 (
vd¥ötf
)

68 
	$__LDBL_REDIR_DECL
 (
d¥ötf
)

69 
	$__LDBL_REDIR_DECL
 (
va•rötf
)

70 
	$__LDBL_REDIR_DECL
 (
__a•rötf
)

71 
	$__LDBL_REDIR_DECL
 (
a•rötf
)

72 
	$__LDBL_REDIR_DECL
 (
ob°ack_¥ötf
)

73 
	$__LDBL_REDIR_DECL
 (
ob°ack_v¥ötf
)

76 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


77 
	$__LDBL_REDIR_DECL
 (
__•rötf_chk
)

78 
	$__LDBL_REDIR_DECL
 (
__v•rötf_chk
)

79 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


80 
	$__LDBL_REDIR_DECL
 (
__¢¥ötf_chk
)

81 
	$__LDBL_REDIR_DECL
 (
__v¢¥ötf_chk
)

83 #i‡
__USE_FORTIFY_LEVEL
 > 1

84 
	$__LDBL_REDIR_DECL
 (
__Ârötf_chk
)

85 
	$__LDBL_REDIR_DECL
 (
__¥ötf_chk
)

86 
	$__LDBL_REDIR_DECL
 (
__vÂrötf_chk
)

87 
	$__LDBL_REDIR_DECL
 (
__v¥ötf_chk
)

88 #ifde‡
__USE_GNU


89 
	$__LDBL_REDIR_DECL
 (
__a•rötf_chk
)

90 
	$__LDBL_REDIR_DECL
 (
__va•rötf_chk
)

91 
	$__LDBL_REDIR_DECL
 (
__d¥ötf_chk
)

92 
	$__LDBL_REDIR_DECL
 (
__vd¥ötf_chk
)

93 
	$__LDBL_REDIR_DECL
 (
__ob°ack_¥ötf_chk
)

94 
	$__LDBL_REDIR_DECL
 (
__ob°ack_v¥ötf_chk
)

	@/usr/include/bits/stdio.h

20 #i‚de‡
_STDIO_H


24 #i‚de‡
__exã∫_ölöe


25 
	#__STDIO_INLINE
 
ölöe


	)

27 
	#__STDIO_INLINE
 
__exã∫_ölöe


	)

31 #ifde‡
__USE_EXTERN_INLINES


34 #i‡!(
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe
)

36 
__STDIO_INLINE
 

37 
	$v¥ötf
 (
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__¨g
)

39  
	`vÂrötf
 (
°dout
, 
__fmt
, 
__¨g
);

40 
	}
}

44 
__STDIO_INLINE
 

45 
	$gëch¨
 ()

47  
	`_IO_gëc
 (
°dö
);

48 
	}
}

51 #ifde‡
__USE_MISC


53 
__STDIO_INLINE
 

54 
	$fgëc_u∆ocked
 (
FILE
 *
__Â
)

56  
	`_IO_gëc_u∆ocked
 (
__Â
);

57 
	}
}

61 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


63 
__STDIO_INLINE
 

64 
	$gëc_u∆ocked
 (
FILE
 *
__Â
)

66  
	`_IO_gëc_u∆ocked
 (
__Â
);

67 
	}
}

70 
__STDIO_INLINE
 

71 
	$gëch¨_u∆ocked
 ()

73  
	`_IO_gëc_u∆ocked
 (
°dö
);

74 
	}
}

79 
__STDIO_INLINE
 

80 
	$putch¨
 (
__c
)

82  
	`_IO_putc
 (
__c
, 
°dout
);

83 
	}
}

86 #ifde‡
__USE_MISC


88 
__STDIO_INLINE
 

89 
	$Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
)

91  
	`_IO_putc_u∆ocked
 (
__c
, 
__°ªam
);

92 
	}
}

96 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


98 
__STDIO_INLINE
 

99 
	$putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
)

101  
	`_IO_putc_u∆ocked
 (
__c
, 
__°ªam
);

102 
	}
}

105 
__STDIO_INLINE
 

106 
	$putch¨_u∆ocked
 (
__c
)

108  
	`_IO_putc_u∆ocked
 (
__c
, 
°dout
);

109 
	}
}

113 #ifdef 
__USE_GNU


115 
__STDIO_INLINE
 
_IO_ssize_t


116 
	$gëlöe
 (**
__löïå
, 
size_t
 *
__n
, 
FILE
 *
__°ªam
)

118  
	`__gëdñim
 (
__löïå
, 
__n
, '\n', 
__°ªam
);

119 
	}
}

123 #ifde‡
__USE_MISC


125 
__STDIO_INLINE
 

126 
__NTH
 (
	$„of_u∆ocked
 (
FILE
 *
__°ªam
))

128  
	`_IO_„of_u∆ocked
 (
__°ªam
);

129 
	}
}

132 
__STDIO_INLINE
 

133 
__NTH
 (
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
))

135  
	`_IO_„º‹_u∆ocked
 (
__°ªam
);

136 
	}
}

142 #i‡
deföed
 
__USE_MISC
 && deföed 
__GNUC__
 && deföed 
__OPTIMIZE__
 \

143 && !
deföed
 
	g__˝lu•lus


145 
	#‰ód_u∆ocked
(
±r
, 
size
, 
n
, 
°ªam
) \

146 (
	`__exãnsi⁄__
 ((
	`__buûtö_c⁄°™t_p
 (
size
Ë&& __buûtö_c⁄°™t_∞(
n
) \

147 && (
size_t
Ë(
size
Ë* (size_tË(
n
) <= 8 \

148 && (
size_t
Ë(
size
) != 0) \

149 ? ({ *
__±r
 = (*Ë(
±r
); \

150 
FILE
 *
__°ªam
 = (
°ªam
); \

151 
size_t
 
__˙t
; \

152 
__˙t
 = (
size_t
Ë(
size
Ë* (size_tË(
n
); \

153 
__˙t
 > 0; --__cnt) \

155 
__c
 = 
	`_IO_gëc_u∆ocked
 (
__°ªam
); \

156 i‡(
__c
 =
EOF
) \

158 *
__±r
++ = 
__c
; \

160 ((
size_t
Ë(
size
Ë* (size_tË(
n
Ë- 
__˙t
) \

161 / (
size_t
Ë(
size
); }) \

162 : (((
	`__buûtö_c⁄°™t_p
 (
size
Ë&& (
size_t
) (size) == 0) \

163 || (
	`__buûtö_c⁄°™t_p
 (
n
Ë&& (
size_t
) (n) == 0)) \

165 ? ((Ë(
±r
), (Ë(
°ªam
), (Ë(
size
), \

166 (Ë(
n
), (
size_t
) 0) \

167 : 
	`‰ód_u∆ocked
 (
±r
, 
size
, 
n
, 
°ªam
))))

	)

169 
	#fwrôe_u∆ocked
(
±r
, 
size
, 
n
, 
°ªam
) \

170 (
	`__exãnsi⁄__
 ((
	`__buûtö_c⁄°™t_p
 (
size
Ë&& __buûtö_c⁄°™t_∞(
n
) \

171 && (
size_t
Ë(
size
Ë* (size_tË(
n
) <= 8 \

172 && (
size_t
Ë(
size
) != 0) \

173 ? ({ c⁄° *
__±r
 = (c⁄° *Ë(
±r
); \

174 
FILE
 *
__°ªam
 = (
°ªam
); \

175 
size_t
 
__˙t
; \

176 
__˙t
 = (
size_t
Ë(
size
Ë* (size_tË(
n
); \

177 
__˙t
 > 0; --__cnt) \

178 i‡(
	`_IO_putc_u∆ocked
 (*
__±r
++, 
__°ªam
Ë=
EOF
) \

180 ((
size_t
Ë(
size
Ë* (size_tË(
n
Ë- 
__˙t
) \

181 / (
size_t
Ë(
size
); }) \

182 : (((
	`__buûtö_c⁄°™t_p
 (
size
Ë&& (
size_t
) (size) == 0) \

183 || (
	`__buûtö_c⁄°™t_p
 (
n
Ë&& (
size_t
) (n) == 0)) \

185 ? ((Ë(
±r
), (Ë(
°ªam
), (Ë(
size
), \

186 (Ë(
n
), (
size_t
) 0) \

187 : 
	`fwrôe_u∆ocked
 (
±r
, 
size
, 
n
, 
°ªam
))))

	)

191 #unde‡
__STDIO_INLINE


	@/usr/include/bits/stdio2.h

20 #i‚de‡
_STDIO_H


24 
	$__•rötf_chk
 (*
__ª°ri˘
 
__s
, 
__Êag
, 
size_t
 
__¶í
,

25 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

26 
	$__v•rötf_chk
 (*
__ª°ri˘
 
__s
, 
__Êag
, 
size_t
 
__¶í
,

27 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

28 
_G_va_li°
 
__≠
Ë
__THROW
;

30 #ifde‡
__va_¨g_∑ck


31 
__exã∫_Æways_ölöe
 

32 
	`__NTH
 (
	$•rötf
 (*
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__fmt
, ...))

34  
	`__buûtö___•rötf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

35 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¨g_∑ck
 ());

36 
	}
}

37 #ñi‡!
deföed
 
__˝lu•lus


38 
	#•rötf
(
°r
, ...) \

39 
	`__buûtö___•rötf_chk
 (
°r
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

40 
__VA_ARGS__
)

	)

43 
__exã∫_Æways_ölöe
 

44 
__NTH
 (
	$v•rötf
 (*
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__fmt
,

45 
_G_va_li°
 
__≠
))

47  
	`__buûtö___v•rötf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

48 
	`__bos
 (
__s
), 
__fmt
, 
__≠
);

49 
	}
}

51 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


53 
	$__¢¥ötf_chk
 (*
__ª°ri˘
 
__s
, 
size_t
 
__n
, 
__Êag
,

54 
size_t
 
__¶í
, 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

55 ...Ë
__THROW
;

56 
	$__v¢¥ötf_chk
 (*
__ª°ri˘
 
__s
, 
size_t
 
__n
, 
__Êag
,

57 
size_t
 
__¶í
, 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

58 
_G_va_li°
 
__≠
Ë
__THROW
;

60 #ifde‡
__va_¨g_∑ck


61 
__exã∫_Æways_ölöe
 

62 
	`__NTH
 (
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__n
,

63 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...))

65  
	`__buûtö___¢¥ötf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

66 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¨g_∑ck
 ());

67 
	}
}

68 #ñi‡!
deföed
 
__˝lu•lus


69 
	#¢¥ötf
(
°r
, 
Àn
, ...) \

70 
	`__buûtö___¢¥ötf_chk
 (
°r
, 
Àn
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

71 
__VA_ARGS__
)

	)

74 
__exã∫_Æways_ölöe
 

75 
__NTH
 (
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__n
,

76 
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
))

78  
	`__buûtö___v¢¥ötf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

79 
	`__bos
 (
__s
), 
__fmt
, 
__≠
);

80 
	}
}

84 #i‡
__USE_FORTIFY_LEVEL
 > 1

86 
__Ârötf_chk
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
__Êag
,

87 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...);

88 
__¥ötf_chk
 (
__Êag
, 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...);

89 
__vÂrötf_chk
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
__Êag
,

90 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__≠
);

91 
__v¥ötf_chk
 (
__Êag
, 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

92 
_G_va_li°
 
__≠
);

94 #ifde‡
__va_¨g_∑ck


95 
__exã∫_Æways_ölöe
 

96 
	$Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
__c⁄°
 *__ª°ri˘ 
__fmt
, ...)

98  
	`__Ârötf_chk
 (
__°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

99 
	`__va_¨g_∑ck
 ());

100 
	}
}

102 
__exã∫_Æways_ölöe
 

103 
	$¥ötf
 (
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

105  
	`__¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¨g_∑ck
 ());

106 
	}
}

107 #ñi‡!
deföed
 
__˝lu•lus


108 
	#¥ötf
(...) \

109 
	`__¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

110 
	#Ârötf
(
°ªam
, ...) \

111 
	`__Ârötf_chk
 (
°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

114 
__exã∫_Æways_ölöe
 

115 
	$v¥ötf
 (
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
)

117 #ifde‡
__USE_EXTERN_INLINES


118  
	`__vÂrötf_chk
 (
°dout
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

120  
	`__v¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

122 
	}
}

124 
__exã∫_Æways_ölöe
 

125 
	$vÂrötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

126 
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
)

128  
	`__vÂrötf_chk
 (
__°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

129 
	}
}

131 #ifde‡
__USE_GNU


133 
	$__a•rötf_chk
 (**
__ª°ri˘
 
__±r
, 
__Êag
,

134 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

135 
__THROW
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 3, 4))Ë
__wur
;

136 
	$__va•rötf_chk
 (**
__ª°ri˘
 
__±r
, 
__Êag
,

137 
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__¨g
)

138 
__THROW
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 3, 0))Ë
__wur
;

139 
	$__d¥ötf_chk
 (
__fd
, 
__Êag
, 
__c⁄°
 *
__ª°ri˘
 
__fmt
,

140 ...Ë
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

141 
	$__vd¥ötf_chk
 (
__fd
, 
__Êag
,

142 
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__¨g
)

143 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

144 
	$__ob°ack_¥ötf_chk
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

145 
__Êag
, 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

147 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

148 
	$__ob°ack_v¥ötf_chk
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

149 
__Êag
,

150 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

151 
_G_va_li°
 
__¨gs
)

152 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

154 #ifde‡
__va_¨g_∑ck


155 
__exã∫_Æways_ölöe
 

156 
	`__NTH
 (
	$a•rötf
 (**
__ª°ri˘
 
__±r
, 
__c⁄°
 *__ª°ri˘ 
__fmt
, ...))

158  
	`__a•rötf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

159 
	`__va_¨g_∑ck
 ());

160 
	}
}

162 
__exã∫_Æways_ölöe
 

163 
__NTH
 (
	$__a•rötf
 (**
__ª°ri˘
 
__±r
, 
__c⁄°
 *__ª°ri˘ 
__fmt
,

166  
	`__a•rötf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

167 
	`__va_¨g_∑ck
 ());

168 
	}
}

170 
__exã∫_Æways_ölöe
 

171 
	$d¥ötf
 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

173  
	`__d¥ötf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

174 
	`__va_¨g_∑ck
 ());

175 
	}
}

177 
__exã∫_Æways_ölöe
 

178 
__NTH
 (
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

179 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...))

181  
	`__ob°ack_¥ötf_chk
 (
__ob°ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

182 
	`__va_¨g_∑ck
 ());

183 
	}
}

184 #ñi‡!
deföed
 
__˝lu•lus


185 
	#a•rötf
(
±r
, ...) \

186 
	`__a•rötf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

187 
	#__a•rötf
(
±r
, ...) \

188 
	`__a•rötf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

189 
	#d¥ötf
(
fd
, ...) \

190 
	`__d¥ötf_chk
 (
fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

191 
	#ob°ack_¥ötf
(
ob°ack
, ...) \

192 
	`__ob°ack_¥ötf_chk
 (
ob°ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

195 
__exã∫_Æways_ölöe
 

196 
__NTH
 (
	$va•rötf
 (**
__ª°ri˘
 
__±r
, 
__c⁄°
 *__ª°ri˘ 
__fmt
,

197 
_G_va_li°
 
__≠
))

199  
	`__va•rötf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

200 
	}
}

202 
__exã∫_Æways_ölöe
 

203 
	$vd¥ötf
 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
)

205  
	`__vd¥ötf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

206 
	}
}

208 
__exã∫_Æways_ölöe
 

209 
__NTH
 (
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

210 
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
))

212  
	`__ob°ack_v¥ötf_chk
 (
__ob°ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

213 
__≠
);

214 
	}
}

220 *
	$__gës_chk
 (*
__°r
, 
size_t
Ë
__wur
;

221 *
	`__REDIRECT
 (
__gës_w¨n
, (*
__°r
), 
gës
)

222 
__wur
 
	`__w¨«âr
 ("please use fgets or getline instead, gets can't "

225 
__exã∫_Æways_ölöe
 
__wur
 *

226 
	$gës
 (*
__°r
)

228 i‡(
	`__bos
 (
__°r
Ë!(
size_t
) -1)

229  
	`__gës_chk
 (
__°r
, 
	`__bos
 (__str));

230  
	`__gës_w¨n
 (
__°r
);

231 
	}
}

233 *
	$__fgës_chk
 (*
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

234 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

235 *
	`__REDIRECT
 (
__fgës_Æüs
,

236 (*
__ª°ri˘
 
__s
, 
__n
,

237 
FILE
 *
__ª°ri˘
 
__°ªam
), 
fgës
Ë
__wur
;

238 *
	`__REDIRECT
 (
__fgës_chk_w¨n
,

239 (*
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

240 
FILE
 *
__ª°ri˘
 
__°ªam
), 
__fgës_chk
)

241 
__wur
 
	`__w¨«âr
 ("fgets called with bigger sizeÅhanÜength "

244 
__exã∫_Æways_ölöe
 
__wur
 *

245 
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

247 i‡(
	`__bos
 (
__s
Ë!(
size_t
) -1)

249 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
) || __n <= 0)

250  
	`__fgës_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__°ªam
);

252 i‡((
size_t
Ë
__n
 > 
	`__bos
 (
__s
))

253  
	`__fgës_chk_w¨n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__°ªam
);

255  
	`__fgës_Æüs
 (
__s
, 
__n
, 
__°ªam
);

256 
	}
}

258 
size_t
 
	$__‰ód_chk
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__±æí
,

259 
size_t
 
__size
, size_à
__n
,

260 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

261 
size_t
 
	`__REDIRECT
 (
__‰ód_Æüs
,

262 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

263 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
),

264 
‰ód
Ë
__wur
;

265 
size_t
 
	`__REDIRECT
 (
__‰ód_chk_w¨n
,

266 (*
__ª°ri˘
 
__±r
, 
size_t
 
__±æí
,

267 
size_t
 
__size
, size_à
__n
,

268 
FILE
 *
__ª°ri˘
 
__°ªam
),

269 
__‰ód_chk
)

270 
__wur
 
	`__w¨«âr
 ("fread called with bigger size *ÇmembÅhanÜength "

273 
__exã∫_Æways_ölöe
 
__wur
 
size_t


274 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
, size_à
__n
,

275 
FILE
 *
__ª°ri˘
 
__°ªam
)

277 i‡(
	`__bos0
 (
__±r
Ë!(
size_t
) -1)

279 i‡(!
	`__buûtö_c⁄°™t_p
 (
__size
)

280 || !
	`__buûtö_c⁄°™t_p
 (
__n
)

281 || (
__size
 | 
__n
Ë>(((
size_t
) 1) << (8 *  (size_t) / 2)))

282  
	`__‰ód_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__°ªam
);

284 i‡(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

285  
	`__‰ód_chk_w¨n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__°ªam
);

287  
	`__‰ód_Æüs
 (
__±r
, 
__size
, 
__n
, 
__°ªam
);

288 
	}
}

290 #ifde‡
__USE_GNU


291 *
	$__fgës_u∆ocked_chk
 (*
__ª°ri˘
 
__s
, 
size_t
 
__size
,

292 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

293 *
	`__REDIRECT
 (
__fgës_u∆ocked_Æüs
,

294 (*
__ª°ri˘
 
__s
, 
__n
,

295 
FILE
 *
__ª°ri˘
 
__°ªam
), 
fgës_u∆ocked
Ë
__wur
;

296 *
	`__REDIRECT
 (
__fgës_u∆ocked_chk_w¨n
,

297 (*
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

298 
FILE
 *
__ª°ri˘
 
__°ªam
), 
__fgës_u∆ocked_chk
)

299 
__wur
 
	`__w¨«âr
 ("fgets_unlocked called with bigger sizeÅhanÜength "

302 
__exã∫_Æways_ölöe
 
__wur
 *

303 
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

305 i‡(
	`__bos
 (
__s
Ë!(
size_t
) -1)

307 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
) || __n <= 0)

308  
	`__fgës_u∆ocked_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__°ªam
);

310 i‡((
size_t
Ë
__n
 > 
	`__bos
 (
__s
))

311  
	`__fgës_u∆ocked_chk_w¨n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__°ªam
);

313  
	`__fgës_u∆ocked_Æüs
 (
__s
, 
__n
, 
__°ªam
);

314 
	}
}

317 #ifde‡
__USE_MISC


318 #unde‡
‰ód_u∆ocked


319 
size_t
 
	$__‰ód_u∆ocked_chk
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__±æí
,

320 
size_t
 
__size
, size_à
__n
,

321 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

322 
size_t
 
	`__REDIRECT
 (
__‰ód_u∆ocked_Æüs
,

323 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

324 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
),

325 
‰ód_u∆ocked
Ë
__wur
;

326 
size_t
 
	`__REDIRECT
 (
__‰ód_u∆ocked_chk_w¨n
,

327 (*
__ª°ri˘
 
__±r
, 
size_t
 
__±æí
,

328 
size_t
 
__size
, size_à
__n
,

329 
FILE
 *
__ª°ri˘
 
__°ªam
),

330 
__‰ód_u∆ocked_chk
)

331 
__wur
 
	`__w¨«âr
 ("fread_unlocked called with bigger size *ÇmembÅhan "

334 
__exã∫_Æways_ölöe
 
__wur
 
size_t


335 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
, size_à
__n
,

336 
FILE
 *
__ª°ri˘
 
__°ªam
)

338 i‡(
	`__bos0
 (
__±r
Ë!(
size_t
) -1)

340 i‡(!
	`__buûtö_c⁄°™t_p
 (
__size
)

341 || !
	`__buûtö_c⁄°™t_p
 (
__n
)

342 || (
__size
 | 
__n
Ë>(((
size_t
) 1) << (8 *  (size_t) / 2)))

343  
	`__‰ód_u∆ocked_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

344 
__°ªam
);

346 i‡(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

347  
	`__‰ód_u∆ocked_chk_w¨n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

348 
__°ªam
);

351 #ifde‡
__USE_EXTERN_INLINES


352 i‡(
	`__buûtö_c⁄°™t_p
 (
__size
)

353 && 
	`__buûtö_c⁄°™t_p
 (
__n
)

354 && (
__size
 | 
__n
Ë< (((
size_t
) 1) << (8 *  (size_t) / 2))

355 && 
__size
 * 
__n
 <= 8)

357 
size_t
 
__˙t
 = 
__size
 * 
__n
;

358 *
__˝å
 = (*Ë
__±r
;

359 i‡(
__˙t
 == 0)

362 ; 
__˙t
 > 0; --__cnt)

364 
__c
 = 
	`_IO_gëc_u∆ocked
 (
__°ªam
);

365 i‡(
__c
 =
EOF
)

367 *
__˝å
++ = 
__c
;

369  (
__˝å
 - (*Ë
__±r
Ë/ 
__size
;

372  
	`__‰ód_u∆ocked_Æüs
 (
__±r
, 
__size
, 
__n
, 
__°ªam
);

373 
	}
}

	@/usr/include/bits/stdio_lim.h

19 #i‡!
deföed
 
_STDIO_H
 && !deföed 
__√ed_FOPEN_MAX
 && !deföed 
__√ed_IOV_MAX


23 #ifde‡
_STDIO_H


24 
	#L_tm≤am
 20

	)

25 
	#TMP_MAX
 238328

	)

26 
	#FILENAME_MAX
 4096

	)

28 #ifde‡
__USE_POSIX


29 
	#L_˘îmid
 9

	)

30 #i‡!
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_GNU


31 
	#L_cu£rid
 9

	)

36 #i‡
deföed
 
__√ed_FOPEN_MAX
 || deföed 
_STDIO_H


37 #unde‡
FOPEN_MAX


38 
	#FOPEN_MAX
 16

	)

41 #i‡
deföed
 
__√ed_IOV_MAX
 && !deföed 
IOV_MAX


42 
	#IOV_MAX
 1024

	)

	@/usr/include/bits/stdlib-ldbl.h

20 #i‚de‡
_STDLIB_H


24 #ifdef 
__USE_ISOC99


25 
__BEGIN_NAMESPACE_C99


26 
	$__LDBL_REDIR1_DECL
 (
°πﬁd
, 
°πod
)

27 
__END_NAMESPACE_C99


30 #ifde‡
__USE_GNU


31 
	$__LDBL_REDIR1_DECL
 (
°πﬁd_l
, 
°πod_l
)

34 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


35 #ifde‡
__USE_MISC


36 
	$__LDBL_REDIR1_DECL
 (
qecvt
, 
ecvt
)

37 
	$__LDBL_REDIR1_DECL
 (
qfcvt
, 
fcvt
)

38 
	$__LDBL_REDIR1_DECL
 (
qgcvt
, 
gcvt
)

39 
	$__LDBL_REDIR1_DECL
 (
qecvt_r
, 
ecvt_r
)

40 
	$__LDBL_REDIR1_DECL
 (
qfcvt_r
, 
fcvt_r
)

	@/usr/include/bits/stdlib.h

20 #i‚de‡
_STDLIB_H


24 *
	$__ªÆ∑th_chk
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

25 *
__ª°ri˘
 
__ªsﬁved
,

26 
size_t
 
__ªsﬁvedÀn
Ë
__THROW
 
__wur
;

27 *
	`__REDIRECT_NTH
 (
__ªÆ∑th_Æüs
,

28 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

29 *
__ª°ri˘
 
__ªsﬁved
), 
ªÆ∑th
Ë
__wur
;

30 *
	`__REDIRECT_NTH
 (
__ªÆ∑th_chk_w¨n
,

31 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

32 *
__ª°ri˘
 
__ªsﬁved
,

33 
size_t
 
__ªsﬁvedÀn
), 
__ªÆ∑th_chk
Ë
__wur


34 
	`__w¨«âr
 ("secondárgument ofÑealpath must beÉither NULL orát "

37 
__exã∫_Æways_ölöe
 
__wur
 *

38 
	`__NTH
 (
	$ªÆ∑th
 (
__c⁄°
 *
__ª°ri˘
 
__«me
, *__ª°ri˘ 
__ªsﬁved
))

40 i‡(
	`__bos
 (
__ªsﬁved
Ë!(
size_t
) -1)

42 #i‡
deföed
 
_LIBC_LIMITS_H_
 && deföed 
PATH_MAX


43 i‡(
	`__bos
 (
__ªsﬁved
Ë< 
PATH_MAX
)

44  
	`__ªÆ∑th_chk_w¨n
 (
__«me
, 
__ªsﬁved
, 
	`__bos
 (__resolved));

46  
	`__ªÆ∑th_chk
 (
__«me
, 
__ªsﬁved
, 
	`__bos
 (__resolved));

49  
	`__ªÆ∑th_Æüs
 (
__«me
, 
__ªsﬁved
);

50 
	}
}

53 
	$__±¢ame_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
,

54 
size_t
 
__ƒól
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

55 
	`__REDIRECT_NTH
 (
__±¢ame_r_Æüs
, (
__fd
, *
__buf
,

56 
size_t
 
__buÊí
), 
±¢ame_r
)

57 
	`__n⁄nuŒ
 ((2));

58 
	`__REDIRECT_NTH
 (
__±¢ame_r_chk_w¨n
,

59 (
__fd
, *
__buf
, 
size_t
 
__buÊí
,

60 
size_t
 
__ƒól
), 
__±¢ame_r_chk
)

61 
	`__n⁄nuŒ
 ((2)Ë
	`__w¨«âr
 ("ptsname_r called with buflen biggerÅhan "

64 
__exã∫_Æways_ölöe
 

65 
	`__NTH
 (
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
))

67 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

69 i‡(!
	`__buûtö_c⁄°™t_p
 (
__buÊí
))

70  
	`__±¢ame_r_chk
 (
__fd
, 
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

71 i‡(
__buÊí
 > 
	`__bos
 (
__buf
))

72  
	`__±¢ame_r_chk_w¨n
 (
__fd
, 
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

74  
	`__±¢ame_r_Æüs
 (
__fd
, 
__buf
, 
__buÊí
);

75 
	}
}

78 
	$__w˘omb_chk
 (*
__s
, 
wch¨_t
 
__wch¨
, 
size_t
 
__buÊí
)

79 
__THROW
 
__wur
;

80 
	`__REDIRECT_NTH
 (
__w˘omb_Æüs
, (*
__s
, 
wch¨_t
 
__wch¨
),

81 
w˘omb
Ë
__wur
;

83 
__exã∫_Æways_ölöe
 
__wur
 

84 
	`__NTH
 (
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
))

89 
	#__STDLIB_MB_LEN_MAX
 16

	)

90 #i‡
deföed
 
MB_LEN_MAX
 && MB_LEN_MAX !
__STDLIB_MB_LEN_MAX


93 i‡(
	`__bos
 (
__s
Ë!(
size_t
Ë-1 && 
__STDLIB_MB_LEN_MAX
 > __bos (__s))

94  
	`__w˘omb_chk
 (
__s
, 
__wch¨
, 
	`__bos
 (__s));

95  
	`__w˘omb_Æüs
 (
__s
, 
__wch¨
);

96 
	}
}

99 
size_t
 
	$__mb°owcs_chk
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

100 
__c⁄°
 *
__ª°ri˘
 
__§c
,

101 
size_t
 
__Àn
, size_à
__d°Àn
Ë
__THROW
;

102 
size_t
 
	`__REDIRECT_NTH
 (
__mb°owcs_Æüs
,

103 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

104 
__c⁄°
 *
__ª°ri˘
 
__§c
,

105 
size_t
 
__Àn
), 
mb°owcs
);

106 
size_t
 
	`__REDIRECT_NTH
 (
__mb°owcs_chk_w¨n
,

107 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

108 
__c⁄°
 *
__ª°ri˘
 
__§c
,

109 
size_t
 
__Àn
, size_à
__d°Àn
), 
__mb°owcs_chk
)

110 
	`__w¨«âr
 ("mbstowcs called with dst buffer smallerÅhanÜen "

113 
__exã∫_Æways_ölöe
 
size_t


114 
	`__NTH
 (
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
, 
__c⁄°
 *__ª°ri˘ 
__§c
,

115 
size_t
 
__Àn
))

117 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

119 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

120  
	`__mb°owcs_chk
 (
__d°
, 
__§c
, 
__Àn
,

121 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

123 i‡(
__Àn
 > 
	`__bos
 (
__d°
Ë/  (
wch¨_t
))

124  
	`__mb°owcs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
,

125 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

127  
	`__mb°owcs_Æüs
 (
__d°
, 
__§c
, 
__Àn
);

128 
	}
}

131 
size_t
 
	$__wc°ombs_chk
 (*
__ª°ri˘
 
__d°
,

132 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
,

133 
size_t
 
__Àn
, size_à
__d°Àn
Ë
__THROW
;

134 
size_t
 
	`__REDIRECT_NTH
 (
__wc°ombs_Æüs
,

135 (*
__ª°ri˘
 
__d°
,

136 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
,

137 
size_t
 
__Àn
), 
wc°ombs
);

138 
size_t
 
	`__REDIRECT_NTH
 (
__wc°ombs_chk_w¨n
,

139 (*
__ª°ri˘
 
__d°
,

140 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
,

141 
size_t
 
__Àn
, size_à
__d°Àn
), 
__wc°ombs_chk
)

142 
	`__w¨«âr
 ("wcstombs called with dst buffer smallerÅhanÜen");

144 
__exã∫_Æways_ölöe
 
size_t


145 
	`__NTH
 (
	$wc°ombs
 (*
__ª°ri˘
 
__d°
, 
__c⁄°
 
wch¨_t
 *__ª°ri˘ 
__§c
,

146 
size_t
 
__Àn
))

148 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

150 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

151  
	`__wc°ombs_chk
 (
__d°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dst));

152 i‡(
__Àn
 > 
	`__bos
 (
__d°
))

153  
	`__wc°ombs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dst));

155  
	`__wc°ombs_Æüs
 (
__d°
, 
__§c
, 
__Àn
);

156 
	}
}

	@/usr/include/bits/string.h

20 #i‚de‡
_STRING_H


26 
	#_STRING_ARCH_u«lig√d
 1

	)

	@/usr/include/bits/string2.h

21 #i‚de‡
_STRING_H


25 #i‡!
deföed
 
__NO_STRING_INLINES
 && !deföed 
__BOUNDED_POINTERS__


42 #i‚de‡
__STRING_INLINE


43 #ifde‡
__˝lu•lus


44 
	#__STRING_INLINE
 
ölöe


	)

46 
	#__STRING_INLINE
 
__exã∫_ölöe


	)

50 #i‡
_STRING_ARCH_u«lig√d


52 
	~<ídün.h
>

53 
	~<bôs/ty≥s.h
>

55 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


56 
	#__STRING2_SMALL_GET16
(
§c
, 
idx
) \

57 (((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 1] << 8 \

58 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
])

	)

59 
	#__STRING2_SMALL_GET32
(
§c
, 
idx
) \

60 (((((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 3] << 8 \

61 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

62 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

63 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
])

	)

65 
	#__STRING2_SMALL_GET16
(
§c
, 
idx
) \

66 (((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
] << 8 \

67 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 1])

	)

68 
	#__STRING2_SMALL_GET32
(
§c
, 
idx
) \

69 (((((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
] << 8 \

70 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

71 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

72 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 3])

	)

77 
	#__STRING2_COPY_TYPE
(
N
) \

78 °ru˘ { 
__¨r
[
N
]; } \

79 
	t__©åibuã__
 ((
	t__∑cked__
)Ë
	t__STRING2_COPY_ARR
##
	tN


	)

80 
	t__STRING2_COPY_TYPE
 (2);

81 
__STRING2_COPY_TYPE
 (3);

82 
__STRING2_COPY_TYPE
 (4);

83 
__STRING2_COPY_TYPE
 (5);

84 
__STRING2_COPY_TYPE
 (6);

85 
__STRING2_COPY_TYPE
 (7);

86 
__STRING2_COPY_TYPE
 (8);

87 #unde‡
__STRING2_COPY_TYPE


93 
	#__°rög2_1b±r_p
(
__x
) \

94 ((
size_t
)(c⁄° *)((
__x
Ë+ 1Ë- (size_t)(c⁄° *)(__xË=1)

	)

97 #i‡!
deföed
 
_HAVE_STRING_ARCH_mem£t


98 #i‡!
__GNUC_PREREQ
 (3, 0)

99 #i‡
_STRING_ARCH_u«lig√d


100 
	#mem£t
(
s
, 
c
, 
n
) \

101 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) && (n) <= 16 \

102 ? ((
n
) == 1 \

103 ? 
	`__mem£t_1
 (
s
, 
c
) \

104 : 
	`__mem£t_gc
 (
s
, 
c
, 
n
)) \

105 : (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

106 ? ({ *
__s
 = (
s
); 
	`__bzîo
 (__s, 
n
); __s; }) \

107 : 
	`mem£t
 (
s
, 
c
, 
n
))))

	)

109 
	#__mem£t_1
(
s
, 
c
Ë({ *
__s
 = (s); \

110 *((
__uöt8_t
 *Ë
__s
Ë(__uöt8_tË
c
; __s; })

	)

112 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

113 ({ *
__s
 = (
s
); \

115 
__ui
; \

116 
__usi
; \

117 
__uc
; \

118 } *
__u
 = 
__s
; \

119 
__uöt8_t
 
__c
 = (__uöt8_tË(
c
); \

122 (Ë(
n
)) \

125 
__u
->
__ui
 = 
__c
 * 0x01010101; \

126 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

128 
__u
->
__ui
 = 
__c
 * 0x01010101; \

129 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

131 
__u
->
__ui
 = 
__c
 * 0x01010101; \

132 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

134 
__u
->
__usi
 = (Ë
__c
 * 0x0101; \

135 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

136 
__u
->
__uc
 = (Ë
__c
; \

140 
__u
->
__ui
 = 
__c
 * 0x01010101; \

141 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

143 
__u
->
__ui
 = 
__c
 * 0x01010101; \

144 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

146 
__u
->
__ui
 = 
__c
 * 0x01010101; \

147 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

149 
__u
->
__usi
 = (Ë
__c
 * 0x0101; \

153 
__u
->
__ui
 = 
__c
 * 0x01010101; \

154 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

156 
__u
->
__ui
 = 
__c
 * 0x01010101; \

157 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

159 
__u
->
__ui
 = 
__c
 * 0x01010101; \

160 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

162 
__u
->
__uc
 = (Ë
__c
; \

166 
__u
->
__ui
 = 
__c
 * 0x01010101; \

167 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

169 
__u
->
__ui
 = 
__c
 * 0x01010101; \

170 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

172 
__u
->
__ui
 = 
__c
 * 0x01010101; \

173 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

175 
__u
->
__ui
 = 
__c
 * 0x01010101; \

180 
__s
; })

	)

182 
	#mem£t
(
s
, 
c
, 
n
) \

183 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

184 ? ({ *
__s
 = (
s
); 
	`__bzîo
 (__s, 
n
); __s; }) \

185 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

194 #i‡
__GNUC_PREREQ
 (2, 91)

195 
	#__bzîo
(
s
, 
n
Ë
	`__buûtö_mem£t
 (s, '\0',Ç)

	)

203 #ifde‡
__USE_GNU


204 #i‡!
deföed
 
_HAVE_STRING_ARCH_memp˝y
 || deföed 
_FORCE_INLINES


205 #i‚de‡
_HAVE_STRING_ARCH_memp˝y


206 #i‡
__GNUC_PREREQ
 (3, 4)

207 
	#__memp˝y
(
de°
, 
§c
, 
n
Ë
	`__buûtö_memp˝y
 (de°, src,Ç)

	)

208 #ñi‡
__GNUC_PREREQ
 (3, 0)

209 
	#__memp˝y
(
de°
, 
§c
, 
n
) \

210 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

211 && 
	`__°rög2_1b±r_p
 (
§c
Ë&& 
n
 <= 8 \

212 ? 
	`__buûtö_mem˝y
 (
de°
, 
§c
, 
n
) + (n) \

213 : 
	`__memp˝y
 (
de°
, 
§c
, 
n
)))

	)

215 
	#__memp˝y
(
de°
, 
§c
, 
n
) \

216 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

217 && 
	`__°rög2_1b±r_p
 (
§c
Ë&& 
n
 <= 8 \

218 ? 
	`__memp˝y_smÆl
 (
de°
, 
	`__memp˝y_¨gs
 (
§c
), 
n
) \

219 : 
	`__memp˝y
 (
de°
, 
§c
, 
n
)))

	)

223 
	#memp˝y
(
de°
, 
§c
, 
n
Ë
	`__memp˝y
 (de°, src,Ç)

	)

226 #i‡!
__GNUC_PREREQ
 (3, 0Ë|| 
deföed
 
_FORCE_INLINES


227 #i‡
_STRING_ARCH_u«lig√d


228 #i‚de‡
_FORCE_INLINES


229 
	#__memp˝y_¨gs
(
§c
) \

230 ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[2], \

231 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[6], \

232 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

233 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

234 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

235 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

237 
__STRING_INLINE
 *
__memp˝y_smÆl
 (*, , , , ,

238 
__uöt16_t
, __uöt16_t, 
__uöt32_t
,

239 
__uöt32_t
, 
size_t
);

240 
__STRING_INLINE
 *

241 
	$__memp˝y_smÆl
 (*
__de°1
,

242 
__§c0_1
, 
__§c2_1
, 
__§c4_1
, 
__§c6_1
,

243 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

244 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

245 
size_t
 
__§˛í
)

248 
__uöt32_t
 
__ui
;

249 
__uöt16_t
 
__usi
;

250 
__uc
;

251 
__c
;

252 } *
__u
 = 
__de°1
;

253 (Ë
__§˛í
)

256 
__u
->
__c
 = 
__§c0_1
;

257 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

260 
__u
->
__usi
 = 
__§c0_2
;

261 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

264 
__u
->
__usi
 = 
__§c0_2
;

265 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

266 
__u
->
__c
 = 
__§c2_1
;

267 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

270 
__u
->
__ui
 = 
__§c0_4
;

271 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

274 
__u
->
__ui
 = 
__§c0_4
;

275 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

276 
__u
->
__c
 = 
__§c4_1
;

277 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

280 
__u
->
__ui
 = 
__§c0_4
;

281 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

282 
__u
->
__usi
 = 
__§c4_2
;

283 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

286 
__u
->
__ui
 = 
__§c0_4
;

287 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

288 
__u
->
__usi
 = 
__§c4_2
;

289 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

290 
__u
->
__c
 = 
__§c6_1
;

291 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

294 
__u
->
__ui
 = 
__§c0_4
;

295 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

296 
__u
->
__ui
 = 
__§c4_4
;

297 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

300  (*Ë
__u
;

301 
	}
}

303 #i‚de‡
_FORCE_INLINES


304 
	#__memp˝y_¨gs
(
§c
) \

305 ((
__c⁄°
 *Ë(
§c
))[0], \

306 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

307 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1] } }), \

308 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

309 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

310 ((
__c⁄°
 *Ë(
§c
))[2] } }), \

311 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

312 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

313 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3] } }), \

314 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

315 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

316 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

317 ((
__c⁄°
 *Ë(
§c
))[4] } }), \

318 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

319 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

320 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

321 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[5] } }), \

322 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

323 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

324 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

325 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[5], \

326 ((
__c⁄°
 *Ë(
§c
))[6] } }), \

327 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

328 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

329 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

330 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[5], \

331 ((
__c⁄°
 *Ë(
§c
))[6], ((__c⁄° *Ë(§c))[7] } })

	)

333 
__STRING_INLINE
 *
__memp˝y_smÆl
 (*, , 
__STRING2_COPY_ARR2
,

334 
__STRING2_COPY_ARR3
,

335 
__STRING2_COPY_ARR4
,

336 
__STRING2_COPY_ARR5
,

337 
__STRING2_COPY_ARR6
,

338 
__STRING2_COPY_ARR7
,

339 
__STRING2_COPY_ARR8
, 
size_t
);

340 
__STRING_INLINE
 *

341 
	$__memp˝y_smÆl
 (*
__de°
, 
__§c1
,

342 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

343 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

344 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

345 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

348 
__c
;

349 
__STRING2_COPY_ARR2
 
__sˇ2
;

350 
__STRING2_COPY_ARR3
 
__sˇ3
;

351 
__STRING2_COPY_ARR4
 
__sˇ4
;

352 
__STRING2_COPY_ARR5
 
__sˇ5
;

353 
__STRING2_COPY_ARR6
 
__sˇ6
;

354 
__STRING2_COPY_ARR7
 
__sˇ7
;

355 
__STRING2_COPY_ARR8
 
__sˇ8
;

356 } *
__u
 = 
__de°
;

357 (Ë
__§˛í
)

360 
__u
->
__c
 = 
__§c1
;

363 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

366 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

369 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

372 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

375 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

378 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

381 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

384  
	`__exãnsi⁄__
 ((*Ë
__u
 + 
__§˛í
);

385 
	}
}

393 #i‚de‡
_HAVE_STRING_ARCH_°rchr


394 *
__øwmemchr
 (c⁄° *
__s
, 
__c
);

395 #i‡
__GNUC_PREREQ
 (3, 2)

396 
	#°rchr
(
s
, 
c
) \

397 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
Ë&& !__buûtö_c⁄°™t_∞(
s
) \

398 && (
c
) == '\0' \

399 ? (*Ë
	`__øwmemchr
 (
s
, 
c
) \

400 : 
	`__buûtö_°rchr
 (
s
, 
c
)))

	)

402 
	#°rchr
(
s
, 
c
) \

403 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

404 ? (*Ë
	`__øwmemchr
 (
s
, 
c
) \

405 : 
	`°rchr
 (
s
, 
c
)))

	)

411 #i‡(!
deföed
 
_HAVE_STRING_ARCH_°r˝y
 && !
__GNUC_PREREQ
 (3, 0)) \

412 || 
deföed
 
	g_FORCE_INLINES


413 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r˝y
 && !
__GNUC_PREREQ
 (3, 0)

414 
	#°r˝y
(
de°
, 
§c
) \

415 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

416 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

417 ? 
	`__°r˝y_smÆl
 (
de°
, 
	`__°r˝y_¨gs
 (
§c
), \

418 
	`°æí
 (
§c
) + 1) \

419 : (*Ë
	`mem˝y
 (
de°
, 
§c
, 
	`°æí
 (src) + 1)) \

420 : 
	`°r˝y
 (
de°
, 
§c
)))

	)

423 #i‡
_STRING_ARCH_u«lig√d


424 #i‚de‡
_FORCE_INLINES


425 
	#__°r˝y_¨gs
(
§c
) \

426 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

427 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

428 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

429 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

431 
__STRING_INLINE
 *
__°r˝y_smÆl
 (*, 
__uöt16_t
, __uint16_t,

432 
__uöt32_t
, __uöt32_t, 
size_t
);

433 
__STRING_INLINE
 *

434 
	$__°r˝y_smÆl
 (*
__de°
,

435 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

436 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

437 
size_t
 
__§˛í
)

440 
__uöt32_t
 
__ui
;

441 
__uöt16_t
 
__usi
;

442 
__uc
;

443 } *
__u
 = (*Ë
__de°
;

444 (Ë
__§˛í
)

447 
__u
->
__uc
 = '\0';

450 
__u
->
__usi
 = 
__§c0_2
;

453 
__u
->
__usi
 = 
__§c0_2
;

454 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

455 
__u
->
__uc
 = '\0';

458 
__u
->
__ui
 = 
__§c0_4
;

461 
__u
->
__ui
 = 
__§c0_4
;

462 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

463 
__u
->
__uc
 = '\0';

466 
__u
->
__ui
 = 
__§c0_4
;

467 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

468 
__u
->
__usi
 = 
__§c4_2
;

471 
__u
->
__ui
 = 
__§c0_4
;

472 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

473 
__u
->
__usi
 = 
__§c4_2
;

474 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

475 
__u
->
__uc
 = '\0';

478 
__u
->
__ui
 = 
__§c0_4
;

479 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

480 
__u
->
__ui
 = 
__§c4_4
;

483  
__de°
;

484 
	}
}

486 #i‚de‡
_FORCE_INLINES


487 
	#__°r˝y_¨gs
(
§c
) \

488 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

489 { { ((
__c⁄°
 *Ë(
§c
))[0], '\0' } }), \

490 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

491 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

493 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

494 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

495 ((
__c⁄°
 *Ë(
§c
))[2], '\0' } }), \

496 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

497 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

498 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

500 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

501 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

502 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

503 ((
__c⁄°
 *Ë(
§c
))[4], '\0' } }), \

504 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

505 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

506 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

507 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[5], \

509 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

510 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

511 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

512 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[5], \

513 ((
__c⁄°
 *Ë(
§c
))[6], '\0' } })

	)

515 
__STRING_INLINE
 *
__°r˝y_smÆl
 (*, 
__STRING2_COPY_ARR2
,

516 
__STRING2_COPY_ARR3
,

517 
__STRING2_COPY_ARR4
,

518 
__STRING2_COPY_ARR5
,

519 
__STRING2_COPY_ARR6
,

520 
__STRING2_COPY_ARR7
,

521 
__STRING2_COPY_ARR8
, 
size_t
);

522 
__STRING_INLINE
 *

523 
	$__°r˝y_smÆl
 (*
__de°
,

524 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

525 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

526 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

527 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

530 
__c
;

531 
__STRING2_COPY_ARR2
 
__sˇ2
;

532 
__STRING2_COPY_ARR3
 
__sˇ3
;

533 
__STRING2_COPY_ARR4
 
__sˇ4
;

534 
__STRING2_COPY_ARR5
 
__sˇ5
;

535 
__STRING2_COPY_ARR6
 
__sˇ6
;

536 
__STRING2_COPY_ARR7
 
__sˇ7
;

537 
__STRING2_COPY_ARR8
 
__sˇ8
;

538 } *
__u
 = (*Ë
__de°
;

539 (Ë
__§˛í
)

542 
__u
->
__c
 = '\0';

545 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

548 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

551 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

554 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

557 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

560 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

563 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

566  
__de°
;

567 
	}
}

573 #ifde‡
__USE_GNU


574 #i‡!
deföed
 
_HAVE_STRING_ARCH_°p˝y
 || deföed 
_FORCE_INLINES


575 #i‚de‡
_HAVE_STRING_ARCH_°p˝y


576 #i‡
__GNUC_PREREQ
 (3, 4)

577 
	#__°p˝y
(
de°
, 
§c
Ë
	`__buûtö_°p˝y
 (de°, src)

	)

578 #ñi‡
__GNUC_PREREQ
 (3, 0)

579 
	#__°p˝y
(
de°
, 
§c
) \

580 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

581 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

582 ? 
	`__buûtö_°r˝y
 (
de°
, 
§c
Ë+ 
	`°æí
 (src) \

583 : ((*Ë(
__memp˝y
Ë(
de°
, 
§c
, 
	`°æí
 (src) + 1) \

585 : 
	`__°p˝y
 (
de°
, 
§c
)))

	)

587 
	#__°p˝y
(
de°
, 
§c
) \

588 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

589 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

590 ? 
	`__°p˝y_smÆl
 (
de°
, 
	`__°p˝y_¨gs
 (
§c
), \

591 
	`°æí
 (
§c
) + 1) \

592 : ((*Ë(
__memp˝y
Ë(
de°
, 
§c
, 
	`°æí
 (src) + 1) \

594 : 
	`__°p˝y
 (
de°
, 
§c
)))

	)

598 
	#°p˝y
(
de°
, 
§c
Ë
	`__°p˝y
 (de°, src)

	)

601 #i‡!
__GNUC_PREREQ
 (3, 0Ë|| 
deföed
 
_FORCE_INLINES


602 #i‡
_STRING_ARCH_u«lig√d


603 #i‚de‡
_FORCE_INLINES


604 
	#__°p˝y_¨gs
(
§c
) \

605 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

606 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

607 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

608 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

610 
__STRING_INLINE
 *
__°p˝y_smÆl
 (*, 
__uöt16_t
, __uint16_t,

611 
__uöt32_t
, __uöt32_t, 
size_t
);

612 
__STRING_INLINE
 *

613 
	$__°p˝y_smÆl
 (*
__de°
,

614 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

615 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

616 
size_t
 
__§˛í
)

619 
__ui
;

620 
__usi
;

621 
__uc
;

622 
__c
;

623 } *
__u
 = (*Ë
__de°
;

624 (Ë
__§˛í
)

627 
__u
->
__uc
 = '\0';

630 
__u
->
__usi
 = 
__§c0_2
;

631 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

634 
__u
->
__usi
 = 
__§c0_2
;

635 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

636 
__u
->
__uc
 = '\0';

639 
__u
->
__ui
 = 
__§c0_4
;

640 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3);

643 
__u
->
__ui
 = 
__§c0_4
;

644 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

645 
__u
->
__uc
 = '\0';

648 
__u
->
__ui
 = 
__§c0_4
;

649 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

650 
__u
->
__usi
 = 
__§c4_2
;

651 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

654 
__u
->
__ui
 = 
__§c0_4
;

655 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

656 
__u
->
__usi
 = 
__§c4_2
;

657 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

658 
__u
->
__uc
 = '\0';

661 
__u
->
__ui
 = 
__§c0_4
;

662 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

663 
__u
->
__ui
 = 
__§c4_4
;

664 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3);

667  &
__u
->
__c
;

668 
	}
}

670 #i‚de‡
_FORCE_INLINES


671 
	#__°p˝y_¨gs
(
§c
) \

672 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

673 { { ((
__c⁄°
 *Ë(
§c
))[0], '\0' } }), \

674 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

675 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

677 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

678 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

679 ((
__c⁄°
 *Ë(
§c
))[2], '\0' } }), \

680 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

681 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

682 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

684 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

685 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

686 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

687 ((
__c⁄°
 *Ë(
§c
))[4], '\0' } }), \

688 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

689 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

690 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

691 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[5], \

693 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

694 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

695 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

696 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[5], \

697 ((
__c⁄°
 *Ë(
§c
))[6], '\0' } })

	)

699 
__STRING_INLINE
 *
__°p˝y_smÆl
 (*, 
__STRING2_COPY_ARR2
,

700 
__STRING2_COPY_ARR3
,

701 
__STRING2_COPY_ARR4
,

702 
__STRING2_COPY_ARR5
,

703 
__STRING2_COPY_ARR6
,

704 
__STRING2_COPY_ARR7
,

705 
__STRING2_COPY_ARR8
, 
size_t
);

706 
__STRING_INLINE
 *

707 
	$__°p˝y_smÆl
 (*
__de°
,

708 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

709 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

710 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

711 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

714 
__c
;

715 
__STRING2_COPY_ARR2
 
__sˇ2
;

716 
__STRING2_COPY_ARR3
 
__sˇ3
;

717 
__STRING2_COPY_ARR4
 
__sˇ4
;

718 
__STRING2_COPY_ARR5
 
__sˇ5
;

719 
__STRING2_COPY_ARR6
 
__sˇ6
;

720 
__STRING2_COPY_ARR7
 
__sˇ7
;

721 
__STRING2_COPY_ARR8
 
__sˇ8
;

722 } *
__u
 = (*Ë
__de°
;

723 (Ë
__§˛í
)

726 
__u
->
__c
 = '\0';

729 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

732 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

735 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

738 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

741 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

744 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

747 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

750  
__de°
 + 
__§˛í
 - 1;

751 
	}
}

759 #i‚de‡
_HAVE_STRING_ARCH_°∫˝y


760 #i‡
__GNUC_PREREQ
 (3, 2)

761 
	#°∫˝y
(
de°
, 
§c
, 
n
Ë
	`__buûtö_°∫˝y
 (de°, src,Ç)

	)

763 
	#°∫˝y
(
de°
, 
§c
, 
n
) \

764 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

765 ? (
	`°æí
 (
§c
Ë+ 1 >((
size_t
Ë(
n
)) \

766 ? (*Ë
	`mem˝y
 (
de°
, 
§c
, 
n
) \

767 : 
	`°∫˝y
 (
de°
, 
§c
, 
n
)) \

768 : 
	`°∫˝y
 (
de°
, 
§c
, 
n
)))

	)

774 #i‚de‡
_HAVE_STRING_ARCH_°∫ˇt


775 #ifde‡
_USE_STRING_ARCH_°rchr


776 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

777 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

778 
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

779 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

780 ? 
	`°rˇt
 (
__de°
, 
§c
) \

781 : (*((*Ë
	`__memp˝y
 (
	`°rchr
 (
__de°
, '\0'), \

782 
§c
, 
n
)Ë'\0', 
__de°
)) \

783 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
); }))

	)

784 #ñi‡
__GNUC_PREREQ
 (3, 2)

785 
	#°∫ˇt
(
de°
, 
§c
, 
n
Ë
	`__buûtö_°∫ˇt
 (de°, src,Ç)

	)

787 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

788 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

789 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

790 ? 
	`°rˇt
 (
de°
, 
§c
) \

791 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
)) \

792 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
)))

	)

798 #i‚de‡
_HAVE_STRING_ARCH_°rcmp


799 #i‡
__GNUC_PREREQ
 (3, 2)

800 
	#°rcmp
(
s1
, 
s2
) \

801 
__exãnsi⁄__
 \

802 ({ 
size_t
 
__s1_Àn
, 
__s2_Àn
; \

803 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

804 && (
__s1_Àn
 = 
	`°æí
 (
s1
), 
__s2_Àn
 = såÀ¿(
s2
), \

805 (!
	`__°rög2_1b±r_p
 (
s1
Ë|| 
__s1_Àn
 >= 4) \

806 && (!
	`__°rög2_1b±r_p
 (
s2
Ë|| 
__s2_Àn
 >= 4)) \

807 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

808 : (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

809 && (
__s1_Àn
 = 
	`°æí
 (
s1
), __s1_len < 4) \

810 ? (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

811 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

812 : 
	`__°rcmp_cg
 (
s1
, 
s2
, 
__s1_Àn
)) \

813 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

814 && (
__s2_Àn
 = 
	`°æí
 (
s2
), __s2_len < 4) \

815 ? (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

816 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

817 : 
	`__°rcmp_gc
 (
s1
, 
s2
, 
__s2_Àn
)) \

818 : 
	`__buûtö_°rcmp
 (
s1
, 
s2
)))); })

	)

820 
	#°rcmp
(
s1
, 
s2
) \

821 
__exãnsi⁄__
 \

822 ({ 
size_t
 
__s1_Àn
, 
__s2_Àn
; \

823 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

824 && (
__s1_Àn
 = 
	`°æí
 (
s1
), 
__s2_Àn
 = såÀ¿(
s2
), \

825 (!
	`__°rög2_1b±r_p
 (
s1
Ë|| 
__s1_Àn
 >= 4) \

826 && (!
	`__°rög2_1b±r_p
 (
s2
Ë|| 
__s2_Àn
 >= 4)) \

827 ? 
	`memcmp
 ((
__c⁄°
 *Ë(
s1
), (__c⁄° *Ë(
s2
), \

828 (
__s1_Àn
 < 
__s2_Àn
 ? __s1_len : __s2_len) + 1) \

829 : (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

830 && (
__s1_Àn
 = 
	`°æí
 (
s1
), __s1_len < 4) \

831 ? (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

832 ? 
	`__°rcmp_cc
 (
s1
, 
s2
, 
__s1_Àn
) \

833 : 
	`__°rcmp_cg
 (
s1
, 
s2
, 
__s1_Àn
)) \

834 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

835 && (
__s2_Àn
 = 
	`°æí
 (
s2
), __s2_len < 4) \

836 ? (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

837 ? 
	`__°rcmp_cc
 (
s1
, 
s2
, 
__s2_Àn
) \

838 : 
	`__°rcmp_gc
 (
s1
, 
s2
, 
__s2_Àn
)) \

839 : 
	`°rcmp
 (
s1
, 
s2
)))); })

	)

842 
	#__°rcmp_cc
(
s1
, 
s2
, 
l
) \

843 (
	`__exãnsi⁄__
 ({ 
__ªsu…
 = \

844 (((
__c⁄°
 *Ë(__c⁄° *Ë(
s1
))[0] \

845 - ((
__c⁄°
 *Ë(__c⁄° *)(
s2
))[0]);\

846 i‡(
l
 > 0 && 
__ªsu…
 == 0) \

848 
__ªsu…
 = (((
__c⁄°
 *) \

849 (
__c⁄°
 *Ë(
s1
))[1] \

850 - ((
__c⁄°
 *) \

851 (
__c⁄°
 *Ë(
s2
))[1]); \

852 i‡(
l
 > 1 && 
__ªsu…
 == 0) \

854 
__ªsu…
 = \

855 (((
__c⁄°
 *) \

856 (
__c⁄°
 *Ë(
s1
))[2] \

857 - ((
__c⁄°
 *) \

858 (
__c⁄°
 *Ë(
s2
))[2]); \

859 i‡(
l
 > 2 && 
__ªsu…
 == 0) \

860 
__ªsu…
 = \

861 (((
__c⁄°
 *) \

862 (
__c⁄°
 *Ë(
s1
))[3] \

863 - ((
__c⁄°
 *) \

864 (
__c⁄°
 *Ë(
s2
))[3]); \

867 
__ªsu…
; }))

	)

869 
	#__°rcmp_cg
(
s1
, 
s2
, 
l1
) \

870 (
	`__exãnsi⁄__
 ({ 
__c⁄°
 *
__s2
 = \

871 (
__c⁄°
 *Ë(__c⁄° *Ë(
s2
); \

872 
__ªsu…
 = \

873 (((
__c⁄°
 *Ë(__c⁄° *Ë(
s1
))[0] \

874 - 
__s2
[0]); \

875 i‡(
l1
 > 0 && 
__ªsu…
 == 0) \

877 
__ªsu…
 = (((
__c⁄°
 *) \

878 (
__c⁄°
 *Ë(
s1
))[1] - 
__s2
[1]); \

879 i‡(
l1
 > 1 && 
__ªsu…
 == 0) \

881 
__ªsu…
 = (((
__c⁄°
 *) \

882 (
__c⁄°
 *Ë(
s1
))[2] - 
__s2
[2]);\

883 i‡(
l1
 > 2 && 
__ªsu…
 == 0) \

884 
__ªsu…
 = (((
__c⁄°
 *) \

885 (
__c⁄°
 *Ë(
s1
))[3] \

886 - 
__s2
[3]); \

889 
__ªsu…
; }))

	)

891 
	#__°rcmp_gc
(
s1
, 
s2
, 
l2
) \

892 (
	`__exãnsi⁄__
 ({ 
__c⁄°
 *
__s1
 = \

893 (
__c⁄°
 *Ë(__c⁄° *Ë(
s1
); \

894 
__ªsu…
 = \

895 
__s1
[0] - ((
__c⁄°
 *) \

896 (
__c⁄°
 *Ë(
s2
))[0]; \

897 i‡(
l2
 > 0 && 
__ªsu…
 == 0) \

899 
__ªsu…
 = (
__s1
[1] \

900 - ((
__c⁄°
 *) \

901 (
__c⁄°
 *Ë(
s2
))[1]); \

902 i‡(
l2
 > 1 && 
__ªsu…
 == 0) \

904 
__ªsu…
 = \

905 (
__s1
[2] - ((
__c⁄°
 *) \

906 (
__c⁄°
 *Ë(
s2
))[2]); \

907 i‡(
l2
 > 2 && 
__ªsu…
 == 0) \

908 
__ªsu…
 = \

909 (
__s1
[3] \

910 - ((
__c⁄°
 *) \

911 (
__c⁄°
 *Ë(
s2
))[3]); \

914 
__ªsu…
; }))

	)

919 #i‚de‡
_HAVE_STRING_ARCH_°∫cmp


920 
	#°∫cmp
(
s1
, 
s2
, 
n
) \

921 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) \

922 && ((
	`__buûtö_c⁄°™t_p
 (
s1
) \

923 && 
	`°æí
 (
s1
Ë< ((
size_t
Ë(
n
))) \

924 || (
	`__buûtö_c⁄°™t_p
 (
s2
) \

925 && 
	`°æí
 (
s2
Ë< ((
size_t
Ë(
n
)))) \

926 ? 
	`°rcmp
 (
s1
, 
s2
Ë: 
	`°∫cmp
 (s1, s2, 
n
)))

	)

932 #i‡!
deföed
 
_HAVE_STRING_ARCH_°rc•n
 || deföed 
_FORCE_INLINES


933 #i‚de‡
_HAVE_STRING_ARCH_°rc•n


934 #i‡
__GNUC_PREREQ
 (3, 2)

935 
	#°rc•n
(
s
, 
ªje˘
) \

936 
__exãnsi⁄__
 \

937 ({ 
__r0
, 
__r1
, 
__r2
; \

938 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

939 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

940 ? 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
) \

941 : ((
__r0
 = ((
__c⁄°
 *Ë(
ªje˘
))[0], __r0 == '\0') \

942 ? 
	`°æí
 (
s
) \

943 : ((
__r1
 = ((
__c⁄°
 *Ë(
ªje˘
))[1], __r1 == '\0') \

944 ? 
	`__°rc•n_c1
 (
s
, 
__r0
) \

945 : ((
__r2
 = ((
__c⁄°
 *Ë(
ªje˘
))[2], __r2 == '\0') \

946 ? 
	`__°rc•n_c2
 (
s
, 
__r0
, 
__r1
) \

947 : (((
__c⁄°
 *Ë(
ªje˘
))[3] == '\0' \

948 ? 
	`__°rc•n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

949 : 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
)))))) \

950 : 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
)); })

	)

952 
	#°rc•n
(
s
, 
ªje˘
) \

953 
__exãnsi⁄__
 \

954 ({ 
__r0
, 
__r1
, 
__r2
; \

955 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

956 ? ((
__r0
 = ((
__c⁄°
 *Ë(
ªje˘
))[0], __r0 == '\0') \

957 ? 
	`°æí
 (
s
) \

958 : ((
__r1
 = ((
__c⁄°
 *Ë(
ªje˘
))[1], __r1 == '\0') \

959 ? 
	`__°rc•n_c1
 (
s
, 
__r0
) \

960 : ((
__r2
 = ((
__c⁄°
 *Ë(
ªje˘
))[2], __r2 == '\0') \

961 ? 
	`__°rc•n_c2
 (
s
, 
__r0
, 
__r1
) \

962 : (((
__c⁄°
 *Ë(
ªje˘
))[3] == '\0' \

963 ? 
	`__°rc•n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

964 : 
	`°rc•n
 (
s
, 
ªje˘
))))) \

965 : 
	`°rc•n
 (
s
, 
ªje˘
)); })

	)

969 
__STRING_INLINE
 
size_t
 
__°rc•n_c1
 (
__c⁄°
 *
__s
, 
__ªje˘
);

970 
__STRING_INLINE
 
size_t


971 
	$__°rc•n_c1
 (
__c⁄°
 *
__s
, 
__ªje˘
)

973 
size_t
 
__ªsu…
 = 0;

974 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘
)

975 ++
__ªsu…
;

976  
__ªsu…
;

977 
	}
}

979 
__STRING_INLINE
 
size_t
 
__°rc•n_c2
 (
__c⁄°
 *
__s
, 
__ªje˘1
,

980 
__ªje˘2
);

981 
__STRING_INLINE
 
size_t


982 
	$__°rc•n_c2
 (
__c⁄°
 *
__s
, 
__ªje˘1
, 
__ªje˘2
)

984 
size_t
 
__ªsu…
 = 0;

985 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘1


986 && 
__s
[
__ªsu…
] !
__ªje˘2
)

987 ++
__ªsu…
;

988  
__ªsu…
;

989 
	}
}

991 
__STRING_INLINE
 
size_t
 
__°rc•n_c3
 (
__c⁄°
 *
__s
, 
__ªje˘1
,

992 
__ªje˘2
, 
__ªje˘3
);

993 
__STRING_INLINE
 
size_t


994 
	$__°rc•n_c3
 (
__c⁄°
 *
__s
, 
__ªje˘1
, 
__ªje˘2
,

995 
__ªje˘3
)

997 
size_t
 
__ªsu…
 = 0;

998 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘1


999 && 
__s
[
__ªsu…
] !
__ªje˘2
 && __s[__ªsu…] !
__ªje˘3
)

1000 ++
__ªsu…
;

1001  
__ªsu…
;

1002 
	}
}

1008 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r•n
 || deföed 
_FORCE_INLINES


1009 #i‚de‡
_HAVE_STRING_ARCH_°r•n


1010 #i‡
__GNUC_PREREQ
 (3, 2)

1011 
	#°r•n
(
s
, 
ac˚±
) \

1012 
__exãnsi⁄__
 \

1013 ({ 
__a0
, 
__a1
, 
__a2
; \

1014 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1015 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

1016 ? 
	`__buûtö_°r•n
 (
s
, 
ac˚±
) \

1017 : ((
__a0
 = ((
__c⁄°
 *Ë(
ac˚±
))[0], __a0 == '\0') \

1018 ? ((Ë(
s
), 0) \

1019 : ((
__a1
 = ((
__c⁄°
 *Ë(
ac˚±
))[1], __a1 == '\0') \

1020 ? 
	`__°r•n_c1
 (
s
, 
__a0
) \

1021 : ((
__a2
 = ((
__c⁄°
 *Ë(
ac˚±
))[2], __a2 == '\0') \

1022 ? 
	`__°r•n_c2
 (
s
, 
__a0
, 
__a1
) \

1023 : (((
__c⁄°
 *Ë(
ac˚±
))[3] == '\0' \

1024 ? 
	`__°r•n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1025 : 
	`__buûtö_°r•n
 (
s
, 
ac˚±
)))))) \

1026 : 
	`__buûtö_°r•n
 (
s
, 
ac˚±
)); })

	)

1028 
	#°r•n
(
s
, 
ac˚±
) \

1029 
__exãnsi⁄__
 \

1030 ({ 
__a0
, 
__a1
, 
__a2
; \

1031 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1032 ? ((
__a0
 = ((
__c⁄°
 *Ë(
ac˚±
))[0], __a0 == '\0') \

1033 ? ((Ë(
s
), 0) \

1034 : ((
__a1
 = ((
__c⁄°
 *Ë(
ac˚±
))[1], __a1 == '\0') \

1035 ? 
	`__°r•n_c1
 (
s
, 
__a0
) \

1036 : ((
__a2
 = ((
__c⁄°
 *Ë(
ac˚±
))[2], __a2 == '\0') \

1037 ? 
	`__°r•n_c2
 (
s
, 
__a0
, 
__a1
) \

1038 : (((
__c⁄°
 *Ë(
ac˚±
))[3] == '\0' \

1039 ? 
	`__°r•n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1040 : 
	`°r•n
 (
s
, 
ac˚±
))))) \

1041 : 
	`°r•n
 (
s
, 
ac˚±
)); })

	)

1045 
__STRING_INLINE
 
size_t
 
__°r•n_c1
 (
__c⁄°
 *
__s
, 
__ac˚±
);

1046 
__STRING_INLINE
 
size_t


1047 
	$__°r•n_c1
 (
__c⁄°
 *
__s
, 
__ac˚±
)

1049 
size_t
 
__ªsu…
 = 0;

1051 
__s
[
__ªsu…
] =
__ac˚±
)

1052 ++
__ªsu…
;

1053  
__ªsu…
;

1054 
	}
}

1056 
__STRING_INLINE
 
size_t
 
__°r•n_c2
 (
__c⁄°
 *
__s
, 
__ac˚±1
,

1057 
__ac˚±2
);

1058 
__STRING_INLINE
 
size_t


1059 
	$__°r•n_c2
 (
__c⁄°
 *
__s
, 
__ac˚±1
, 
__ac˚±2
)

1061 
size_t
 
__ªsu…
 = 0;

1063 
__s
[
__ªsu…
] =
__ac˚±1
 || __s[__ªsu…] =
__ac˚±2
)

1064 ++
__ªsu…
;

1065  
__ªsu…
;

1066 
	}
}

1068 
__STRING_INLINE
 
size_t
 
__°r•n_c3
 (
__c⁄°
 *
__s
, 
__ac˚±1
,

1069 
__ac˚±2
, 
__ac˚±3
);

1070 
__STRING_INLINE
 
size_t


1071 
	$__°r•n_c3
 (
__c⁄°
 *
__s
, 
__ac˚±1
, 
__ac˚±2
, 
__ac˚±3
)

1073 
size_t
 
__ªsu…
 = 0;

1075 
__s
[
__ªsu…
] =
__ac˚±1
 || __s[__ªsu…] =
__ac˚±2


1076 || 
__s
[
__ªsu…
] =
__ac˚±3
)

1077 ++
__ªsu…
;

1078  
__ªsu…
;

1079 
	}
}

1084 #i‡!
deföed
 
_HAVE_STRING_ARCH_°Ωbrk
 || deföed 
_FORCE_INLINES


1085 #i‚de‡
_HAVE_STRING_ARCH_°Ωbrk


1086 #i‡
__GNUC_PREREQ
 (3, 2)

1087 
	#°Ωbrk
(
s
, 
ac˚±
) \

1088 
__exãnsi⁄__
 \

1089 ({ 
__a0
, 
__a1
, 
__a2
; \

1090 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1091 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

1092 ? 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
) \

1093 : ((
__a0
 = ((
__c⁄°
 *Ë(
ac˚±
))[0], __a0 == '\0') \

1094 ? ((Ë(
s
), (*Ë
NULL
) \

1095 : ((
__a1
 = ((
__c⁄°
 *Ë(
ac˚±
))[1], __a1 == '\0') \

1096 ? 
	`__buûtö_°rchr
 (
s
, 
__a0
) \

1097 : ((
__a2
 = ((
__c⁄°
 *Ë(
ac˚±
))[2], __a2 == '\0') \

1098 ? 
	`__°Ωbrk_c2
 (
s
, 
__a0
, 
__a1
) \

1099 : (((
__c⁄°
 *Ë(
ac˚±
))[3] == '\0' \

1100 ? 
	`__°Ωbrk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1101 : 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
)))))) \

1102 : 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
)); })

	)

1104 
	#°Ωbrk
(
s
, 
ac˚±
) \

1105 
__exãnsi⁄__
 \

1106 ({ 
__a0
, 
__a1
, 
__a2
; \

1107 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1108 ? ((
__a0
 = ((
__c⁄°
 *Ë(
ac˚±
))[0], __a0 == '\0') \

1109 ? ((Ë(
s
), (*Ë
NULL
) \

1110 : ((
__a1
 = ((
__c⁄°
 *Ë(
ac˚±
))[1], __a1 == '\0') \

1111 ? 
	`°rchr
 (
s
, 
__a0
) \

1112 : ((
__a2
 = ((
__c⁄°
 *Ë(
ac˚±
))[2], __a2 == '\0') \

1113 ? 
	`__°Ωbrk_c2
 (
s
, 
__a0
, 
__a1
) \

1114 : (((
__c⁄°
 *Ë(
ac˚±
))[3] == '\0' \

1115 ? 
	`__°Ωbrk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1116 : 
	`°Ωbrk
 (
s
, 
ac˚±
))))) \

1117 : 
	`°Ωbrk
 (
s
, 
ac˚±
)); })

	)

1121 
__STRING_INLINE
 *
__°Ωbrk_c2
 (
__c⁄°
 *
__s
, 
__ac˚±1
,

1122 
__ac˚±2
);

1123 
__STRING_INLINE
 *

1124 
	$__°Ωbrk_c2
 (
__c⁄°
 *
__s
, 
__ac˚±1
, 
__ac˚±2
)

1127 *
__s
 !'\0' && *__†!
__ac˚±1
 && *__†!
__ac˚±2
)

1128 ++
__s
;

1129  *
__s
 ='\0' ? 
NULL
 : (*Ë(
size_t
) __s;

1130 
	}
}

1132 
__STRING_INLINE
 *
__°Ωbrk_c3
 (
__c⁄°
 *
__s
, 
__ac˚±1
,

1133 
__ac˚±2
, 
__ac˚±3
);

1134 
__STRING_INLINE
 *

1135 
	$__°Ωbrk_c3
 (
__c⁄°
 *
__s
, 
__ac˚±1
, 
__ac˚±2
,

1136 
__ac˚±3
)

1139 *
__s
 !'\0' && *__†!
__ac˚±1
 && *__†!
__ac˚±2


1140 && *
__s
 !
__ac˚±3
)

1141 ++
__s
;

1142  *
__s
 ='\0' ? 
NULL
 : (*Ë(
size_t
) __s;

1143 
	}
}

1149 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r°r
 && !
__GNUC_PREREQ
 (2, 97)

1150 
	#°r°r
(
hay°ack
, 
√edÀ
) \

1151 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
√edÀ
Ë&& 
	`__°rög2_1b±r_p
 (needle) \

1152 ? (((
__c⁄°
 *Ë(
√edÀ
))[0] == '\0' \

1153 ? (*Ë(
size_t
Ë(
hay°ack
) \

1154 : (((
__c⁄°
 *Ë(
√edÀ
))[1] == '\0' \

1155 ? 
	`°rchr
 (
hay°ack
, \

1156 ((
__c⁄°
 *Ë(
√edÀ
))[0]) \

1157 : 
	`°r°r
 (
hay°ack
, 
√edÀ
))) \

1158 : 
	`°r°r
 (
hay°ack
, 
√edÀ
)))

	)

1162 #i‡!
deföed
 
_HAVE_STRING_ARCH_°πok_r
 || deföed 
_FORCE_INLINES


1163 #i‚de‡
_HAVE_STRING_ARCH_°πok_r


1164 
	#__°πok_r
(
s
, 
£p
, 
√xç
) \

1165 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
£p
Ë&& 
	`__°rög2_1b±r_p
 (sep) \

1166 && ((
__c⁄°
 *Ë(
£p
))[0] != '\0' \

1167 && ((
__c⁄°
 *Ë(
£p
))[1] == '\0' \

1168 ? 
	`__°πok_r_1c
 (
s
, ((
__c⁄°
 *Ë(
£p
))[0], 
√xç
) \

1169 : 
	`__°πok_r
 (
s
, 
£p
, 
√xç
)))

	)

1172 
__STRING_INLINE
 *
__°πok_r_1c
 (*
__s
, 
__£p
, **
__√xç
);

1173 
__STRING_INLINE
 *

1174 
	$__°πok_r_1c
 (*
__s
, 
__£p
, **
__√xç
)

1176 *
__ªsu…
;

1177 i‡(
__s
 =
NULL
)

1178 
__s
 = *
__√xç
;

1179 *
__s
 =
__£p
)

1180 ++
__s
;

1181 
__ªsu…
 = 
NULL
;

1182 i‡(*
__s
 != '\0')

1184 
__ªsu…
 = 
__s
++;

1185 *
__s
 != '\0')

1186 i‡(*
__s
++ =
__£p
)

1188 
__s
[-1] = '\0';

1192 *
__√xç
 = 
__s
;

1193  
__ªsu…
;

1194 
	}
}

1195 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


1196 
	#°πok_r
(
s
, 
£p
, 
√xç
Ë
	`__°πok_r
 (s, sï,Çexç)

	)

1201 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r£p
 || deföed 
_FORCE_INLINES


1202 #i‚de‡
_HAVE_STRING_ARCH_°r£p


1204 *
__°r£p_g
 (**
__°rögp
, 
__c⁄°
 *
__dñim
);

1205 
	#__°r£p
(
s
, 
ªje˘
) \

1206 
__exãnsi⁄__
 \

1207 ({ 
__r0
, 
__r1
, 
__r2
; \

1208 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

1209 && (
__r0
 = ((
__c⁄°
 *Ë(
ªje˘
))[0], \

1210 ((
__c⁄°
 *Ë(
ªje˘
))[0] != '\0') \

1211 ? ((
__r1
 = ((
__c⁄°
 *Ë(
ªje˘
))[1], \

1212 ((
__c⁄°
 *Ë(
ªje˘
))[1] == '\0') \

1213 ? 
	`__°r£p_1c
 (
s
, 
__r0
) \

1214 : ((
__r2
 = ((
__c⁄°
 *Ë(
ªje˘
))[2], __r2 == '\0') \

1215 ? 
	`__°r£p_2c
 (
s
, 
__r0
, 
__r1
) \

1216 : (((
__c⁄°
 *Ë(
ªje˘
))[3] == '\0' \

1217 ? 
	`__°r£p_3c
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

1218 : 
	`__°r£p_g
 (
s
, 
ªje˘
)))) \

1219 : 
	`__°r£p_g
 (
s
, 
ªje˘
)); })

	)

1222 
__STRING_INLINE
 *
__°r£p_1c
 (**
__s
, 
__ªje˘
);

1223 
__STRING_INLINE
 *

1224 
	$__°r£p_1c
 (**
__s
, 
__ªje˘
)

1226 *
__ªtvÆ
 = *
__s
;

1227 i‡(
__ªtvÆ
 !
NULL
 && (*
__s
 = 
	`°rchr
 (__ªtvÆ, 
__ªje˘
)) != NULL)

1228 *(*
__s
)++ = '\0';

1229  
__ªtvÆ
;

1230 
	}
}

1232 
__STRING_INLINE
 *
__°r£p_2c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
);

1233 
__STRING_INLINE
 *

1234 
	$__°r£p_2c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
)

1236 *
__ªtvÆ
 = *
__s
;

1237 i‡(
__ªtvÆ
 !
NULL
)

1239 *
__˝
 = 
__ªtvÆ
;

1242 i‡(*
__˝
 == '\0')

1244 
__˝
 = 
NULL
;

1247 i‡(*
__˝
 =
__ªje˘1
 || *__˝ =
__ªje˘2
)

1249 *
__˝
++ = '\0';

1252 ++
__˝
;

1254 *
__s
 = 
__˝
;

1256  
__ªtvÆ
;

1257 
	}
}

1259 
__STRING_INLINE
 *
__°r£p_3c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
,

1260 
__ªje˘3
);

1261 
__STRING_INLINE
 *

1262 
	$__°r£p_3c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
, 
__ªje˘3
)

1264 *
__ªtvÆ
 = *
__s
;

1265 i‡(
__ªtvÆ
 !
NULL
)

1267 *
__˝
 = 
__ªtvÆ
;

1270 i‡(*
__˝
 == '\0')

1272 
__˝
 = 
NULL
;

1275 i‡(*
__˝
 =
__ªje˘1
 || *__˝ =
__ªje˘2
 || *__˝ =
__ªje˘3
)

1277 *
__˝
++ = '\0';

1280 ++
__˝
;

1282 *
__s
 = 
__˝
;

1284  
__ªtvÆ
;

1285 
	}
}

1286 #ifde‡
__USE_BSD


1287 
	#°r£p
(
s
, 
ªje˘
Ë
	`__°r£p
 (s,Ñeje˘)

	)

1294 #ifde‡
__USE_MISC


1296 #i‡!
deföed
 
_HAVE_STRING_ARCH_°rdup
 || !deföed 
_HAVE_STRING_ARCH_°∫dup


1297 
	#__√ed_mÆloc_™d_ˇŒoc


	)

1298 
	~<°dlib.h
>

1301 #i‚de‡
_HAVE_STRING_ARCH_°rdup


1303 *
	$__°rdup
 (
__c⁄°
 *
__°rög
Ë
__THROW
 
__©åibuã_mÆloc__
;

1304 
	#__°rdup
(
s
) \

1305 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s) \

1306 ? (((
__c⁄°
 *Ë(
s
))[0] == '\0' \

1307 ? (*Ë
	`ˇŒoc
 ((
size_t
) 1, (size_t) 1) \

1308 : ({ 
size_t
 
__Àn
 = 
	`°æí
 (
s
) + 1; \

1309 *
__ªtvÆ
 = (*Ë
	`mÆloc
 (
__Àn
); \

1310 i‡(
__ªtvÆ
 !
NULL
) \

1311 
__ªtvÆ
 = (*Ë
	`mem˝y
 (__ªtvÆ, 
s
, 
__Àn
); \

1312 
__ªtvÆ
; 
	}
})) \

1313 : 
	`__°rdup
 (
s
)))

	)

1315 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1316 
	#°rdup
(
s
Ë
	`__°rdup
 (s)

	)

1320 #i‚de‡
_HAVE_STRING_ARCH_°∫dup


1322 *
	$__°∫dup
 (
__c⁄°
 *
__°rög
, 
size_t
 
__n
)

1323 
__THROW
 
__©åibuã_mÆloc__
;

1324 
	#__°∫dup
(
s
, 
n
) \

1325 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s) \

1326 ? (((
__c⁄°
 *Ë(
s
))[0] == '\0' \

1327 ? (*Ë
	`ˇŒoc
 ((
size_t
) 1, (size_t) 1) \

1328 : ({ 
size_t
 
__Àn
 = 
	`°æí
 (
s
) + 1; \

1329 
size_t
 
__n
 = (
n
); \

1330 *
__ªtvÆ
; \

1331 i‡(
__n
 < 
__Àn
) \

1332 
__Àn
 = 
__n
 + 1; \

1333 
__ªtvÆ
 = (*Ë
	`mÆloc
 (
__Àn
); \

1334 i‡(
__ªtvÆ
 !
NULL
) \

1336 
__ªtvÆ
[
__Àn
 - 1] = '\0'; \

1337 
__ªtvÆ
 = (*Ë
	`mem˝y
 (__ªtvÆ, 
s
, \

1338 
__Àn
 - 1); \

1340 
__ªtvÆ
; 
	}
})) \

1341 : 
	`__°∫dup
 (
s
, 
n
)))

	)

1343 #ifde‡
__USE_GNU


1344 
	#°∫dup
(
s
, 
n
Ë
	`__°∫dup
 (s,Ç)

	)

1350 #i‚de‡
_FORCE_INLINES


1351 #unde‡
__STRING_INLINE


	@/usr/include/bits/string3.h

19 #i‚de‡
_STRING_H


23 
__w¨nde˛
 (
__w¨n_mem£t_zîo_Àn
,

26 #i‚de‡
__˝lu•lus


30 #unde‡
mem˝y


31 #unde‡
memmove


32 #unde‡
mem£t


33 #unde‡
°rˇt


34 #unde‡
°r˝y


35 #unde‡
°∫ˇt


36 #unde‡
°∫˝y


37 #ifde‡
__USE_GNU


38 #unde‡
memp˝y


39 #unde‡
°p˝y


41 #ifde‡
__USE_BSD


42 #unde‡
bc›y


43 #unde‡
bzîo


48 
__exã∫_Æways_ölöe
 *

49 
__NTH
 (
	$mem˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
,

50 
size_t
 
__Àn
))

52  
	`__buûtö___mem˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

53 
	}
}

55 
__exã∫_Æways_ölöe
 *

56 
__NTH
 (
	$memmove
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
,

57 
size_t
 
__Àn
))

59  
	`__buûtö___memmove_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

60 
	}
}

62 #ifde‡
__USE_GNU


63 
__exã∫_Æways_ölöe
 *

64 
__NTH
 (
	$memp˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
,

65 
size_t
 
__Àn
))

67  
	`__buûtö___memp˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

68 
	}
}

77 
__exã∫_Æways_ölöe
 *

78 
__NTH
 (
	$mem£t
 (*
__de°
, 
__ch
, 
size_t
 
__Àn
))

80 i‡(
	`__buûtö_c⁄°™t_p
 (
__Àn
) && __len == 0

81 && (!
	`__buûtö_c⁄°™t_p
 (
__ch
) || __ch != 0))

83 
	`__w¨n_mem£t_zîo_Àn
 ();

84  
__de°
;

86  
	`__buûtö___mem£t_chk
 (
__de°
, 
__ch
, 
__Àn
, 
	`__bos0
 (__dest));

87 
	}
}

89 #ifde‡
__USE_BSD


90 
__exã∫_Æways_ölöe
 

91 
__NTH
 (
	$bc›y
 (
__c⁄°
 *
__ª°ri˘
 
__§c
, *__ª°ri˘ 
__de°
,

92 
size_t
 
__Àn
))

94 (Ë
	`__buûtö___memmove_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

95 
	}
}

97 
__exã∫_Æways_ölöe
 

98 
__NTH
 (
	$bzîo
 (*
__de°
, 
size_t
 
__Àn
))

100 (Ë
	`__buûtö___mem£t_chk
 (
__de°
, '\0', 
__Àn
, 
	`__bos0
 (__dest));

101 
	}
}

104 
__exã∫_Æways_ölöe
 *

105 
__NTH
 (
	$°r˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
))

107  
	`__buûtö___°r˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

108 
	}
}

110 #ifde‡
__USE_GNU


111 
__exã∫_Æways_ölöe
 *

112 
__NTH
 (
	$°p˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
))

114  
	`__buûtö___°p˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

115 
	}
}

119 
__exã∫_Æways_ölöe
 *

120 
__NTH
 (
	$°∫˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
,

121 
size_t
 
__Àn
))

123  
	`__buûtö___°∫˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dest));

124 
	}
}

127 *
	$__°≤˝y_chk
 (*
__de°
, 
__c⁄°
 *
__§c
, 
size_t
 
__n
,

128 
size_t
 
__de°Àn
Ë
__THROW
;

129 *
	`__REDIRECT_NTH
 (
__°≤˝y_Æüs
, (*
__de°
,

130 
__c⁄°
 *
__§c
,

131 
size_t
 
__n
), 
°≤˝y
);

133 
__exã∫_Æways_ölöe
 *

134 
	`__NTH
 (
	$°≤˝y
 (*
__de°
, 
__c⁄°
 *
__§c
, 
size_t
 
__n
))

136 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1

137 && (!
	`__buûtö_c⁄°™t_p
 (
__n
Ë|| __¿<
	`__bos
 (
__de°
)))

138  
	`__°≤˝y_chk
 (
__de°
, 
__§c
, 
__n
, 
	`__bos
 (__dest));

139  
	`__°≤˝y_Æüs
 (
__de°
, 
__§c
, 
__n
);

140 
	}
}

143 
__exã∫_Æways_ölöe
 *

144 
__NTH
 (
	$°rˇt
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
))

146  
	`__buûtö___°rˇt_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

147 
	}
}

150 
__exã∫_Æways_ölöe
 *

151 
__NTH
 (
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
,

152 
size_t
 
__Àn
))

154  
	`__buûtö___°∫ˇt_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dest));

155 
	}
}

	@/usr/include/bits/sys_errlist.h

20 #i‚de‡
_STDIO_H


26 #ifde‡ 
__USE_BSD


27 
sys_√º
;

28 
__c⁄°
 *__c⁄° 
sys_îæi°
[];

30 #ifde‡ 
__USE_GNU


31 
_sys_√º
;

32 
__c⁄°
 *__c⁄° 
_sys_îæi°
[];

	@/usr/include/bits/types.h

24 #i‚def 
_BITS_TYPES_H


25 
	#_BITS_TYPES_H
 1

	)

27 
	~<„©uªs.h
>

28 
	~<bôs/w‹dsize.h
>

31 
	t__u_ch¨
;

32 
	t__u_sh‹t
;

33 
	t__u_öt
;

34 
	t__u_l⁄g
;

37 sig√d 
	t__öt8_t
;

38 
	t__uöt8_t
;

39 sig√d 
	t__öt16_t
;

40 
	t__uöt16_t
;

41 sig√d 
	t__öt32_t
;

42 
	t__uöt32_t
;

43 #i‡
__WORDSIZE
 == 64

44 sig√d 
	t__öt64_t
;

45 
	t__uöt64_t
;

46 #ñi‡
deföed
 
__GLIBC_HAVE_LONG_LONG


47 
__exãnsi⁄__
 sig√d 
	t__öt64_t
;

48 
__exãnsi⁄__
 
	t__uöt64_t
;

52 #i‡
__WORDSIZE
 == 64

53 
	t__quad_t
;

54 
	t__u_quad_t
;

55 #ñi‡
deföed
 
__GLIBC_HAVE_LONG_LONG


56 
__exãnsi⁄__
 
	t__quad_t
;

57 
__exãnsi⁄__
 
	t__u_quad_t
;

61 
	m__vÆ
[2];

62 } 
	t__quad_t
;

65 
__u_l⁄g
 
	m__vÆ
[2];

66 } 
	t__u_quad_t
;

99 
	#__S16_TYPE
 

	)

100 
	#__U16_TYPE
 

	)

101 
	#__S32_TYPE
 

	)

102 
	#__U32_TYPE
 

	)

103 
	#__SLONGWORD_TYPE
 

	)

104 
	#__ULONGWORD_TYPE
 

	)

105 #i‡
__WORDSIZE
 == 32

106 
	#__SQUAD_TYPE
 
__quad_t


	)

107 
	#__UQUAD_TYPE
 
__u_quad_t


	)

108 
	#__SWORD_TYPE
 

	)

109 
	#__UWORD_TYPE
 

	)

110 
	#__SLONG32_TYPE
 

	)

111 
	#__ULONG32_TYPE
 

	)

112 
	#__S64_TYPE
 
__quad_t


	)

113 
	#__U64_TYPE
 
__u_quad_t


	)

116 
	#__STD_TYPE
 
__exãnsi⁄__
 

	)

117 #ñi‡
__WORDSIZE
 == 64

118 
	t__SQUAD_TYPE
 

	)

119 
	t__UQUAD_TYPE
 

	)

120 
	t__SWORD_TYPE
 

	)

121 
	t__UWORD_TYPE
 

	)

122 
	t__SLONG32_TYPE
 

	)

123 
	t__ULONG32_TYPE
 

	)

124 
	t__S64_TYPE
 

	)

125 
	t__U64_TYPE
 

	)

127 
	t__STD_TYPE
 

	)

131 
	~<bôs/ty≥sizes.h
>

134 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

135 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

136 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

137 
__STD_TYPE
 
__INO_T_TYPE
 
	g__öo_t
;

138 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__öo64_t
;

139 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

140 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__∆ök_t
;

141 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

142 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

143 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

144 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

145 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__˛ock_t
;

146 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__æim_t
;

147 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__æim64_t
;

148 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

149 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

150 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£c⁄ds_t
;

151 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£c⁄ds_t
;

153 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

154 
__STD_TYPE
 
__SWBLK_T_TYPE
 
	g__swblk_t
;

155 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

158 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__˛ockid_t
;

161 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__timî_t
;

164 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

169 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blk˙t_t
;

170 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blk˙t64_t
;

173 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblk˙t_t
;

174 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblk˙t64_t
;

177 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfû˙t_t
;

178 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfû˙t64_t
;

180 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

184 
__off64_t
 
	t__loff_t
;

185 
__quad_t
 *
	t__qaddr_t
;

186 *
	t__ˇddr_t
;

189 
__STD_TYPE
 
__SWORD_TYPE
 
	g__öçå_t
;

192 
__STD_TYPE
 
__U32_TYPE
 
	g__sockÀn_t
;

195 #unde‡
__STD_TYPE


	@/usr/include/bits/unistd.h

20 #i‚de‡
_UNISTD_H


24 
ssize_t
 
	$__ªad_chk
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

25 
size_t
 
__buÊí
Ë
__wur
;

26 
ssize_t
 
	`__REDIRECT
 (
__ªad_Æüs
, (
__fd
, *
__buf
,

27 
size_t
 
__nbyãs
), 
ªad
Ë
__wur
;

28 
ssize_t
 
	`__REDIRECT
 (
__ªad_chk_w¨n
,

29 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

30 
size_t
 
__buÊí
), 
__ªad_chk
)

31 
__wur
 
	`__w¨«âr
 ("read called with biggerÜengthÅhan size of "

34 
__exã∫_Æways_ölöe
 
__wur
 
ssize_t


35 
	$ªad
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
)

37 i‡(
	`__bos0
 (
__buf
Ë!(
size_t
) -1)

39 i‡(!
	`__buûtö_c⁄°™t_p
 (
__nbyãs
))

40  
	`__ªad_chk
 (
__fd
, 
__buf
, 
__nbyãs
, 
	`__bos0
 (__buf));

42 i‡(
__nbyãs
 > 
	`__bos0
 (
__buf
))

43  
	`__ªad_chk_w¨n
 (
__fd
, 
__buf
, 
__nbyãs
, 
	`__bos0
 (__buf));

45  
	`__ªad_Æüs
 (
__fd
, 
__buf
, 
__nbyãs
);

46 
	}
}

48 #ifde‡
__USE_UNIX98


49 
ssize_t
 
	$__¥ód_chk
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

50 
__off_t
 
__off£t
, 
size_t
 
__bufsize
Ë
__wur
;

51 
ssize_t
 
	$__¥ód64_chk
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

52 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
Ë
__wur
;

53 
ssize_t
 
	`__REDIRECT
 (
__¥ód_Æüs
,

54 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

55 
__off_t
 
__off£t
), 
¥ód
Ë
__wur
;

56 
ssize_t
 
	`__REDIRECT
 (
__¥ód64_Æüs
,

57 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

58 
__off64_t
 
__off£t
), 
¥ód64
Ë
__wur
;

59 
ssize_t
 
	`__REDIRECT
 (
__¥ód_chk_w¨n
,

60 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

61 
__off_t
 
__off£t
, 
size_t
 
__bufsize
), 
__¥ód_chk
)

62 
__wur
 
	`__w¨«âr
 ("pread called with biggerÜengthÅhan size of "

64 
ssize_t
 
	`__REDIRECT
 (
__¥ód64_chk_w¨n
,

65 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

66 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
),

67 
__¥ód64_chk
)

68 
__wur
 
	`__w¨«âr
 ("pread64 called with biggerÜengthÅhan size of "

71 #i‚de‡
__USE_FILE_OFFSET64


72 
__exã∫_Æways_ölöe
 
__wur
 
ssize_t


73 
	$¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
, 
__off_t
 
__off£t
)

75 i‡(
	`__bos0
 (
__buf
Ë!(
size_t
) -1)

77 i‡(!
	`__buûtö_c⁄°™t_p
 (
__nbyãs
))

78  
	`__¥ód_chk
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
, 
	`__bos0
 (__buf));

80 i‡–
__nbyãs
 > 
	`__bos0
 (
__buf
))

81  
	`__¥ód_chk_w¨n
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
,

82 
	`__bos0
 (
__buf
));

84  
	`__¥ód_Æüs
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
);

85 
	}
}

87 
__exã∫_Æways_ölöe
 
__wur
 
ssize_t


88 
	$¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
)

90 i‡(
	`__bos0
 (
__buf
Ë!(
size_t
) -1)

92 i‡(!
	`__buûtö_c⁄°™t_p
 (
__nbyãs
))

93  
	`__¥ód64_chk
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
, 
	`__bos0
 (__buf));

95 i‡–
__nbyãs
 > 
	`__bos0
 (
__buf
))

96  
	`__¥ód64_chk_w¨n
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
,

97 
	`__bos0
 (
__buf
));

100  
	`__¥ód64_Æüs
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
);

101 
	}
}

104 #ifde‡
__USE_LARGEFILE64


105 
__exã∫_Æways_ölöe
 
__wur
 
ssize_t


106 
	$¥ód64
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
)

108 i‡(
	`__bos0
 (
__buf
Ë!(
size_t
) -1)

110 i‡(!
	`__buûtö_c⁄°™t_p
 (
__nbyãs
))

111  
	`__¥ód64_chk
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
, 
	`__bos0
 (__buf));

113 i‡–
__nbyãs
 > 
	`__bos0
 (
__buf
))

114  
	`__¥ód64_chk_w¨n
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
,

115 
	`__bos0
 (
__buf
));

118  
	`__¥ód64_Æüs
 (
__fd
, 
__buf
, 
__nbyãs
, 
__off£t
);

119 
	}
}

123 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


124 
ssize_t
 
	$__ªadlök_chk
 (
__c⁄°
 *
__ª°ri˘
 
__∑th
,

125 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
,

126 
size_t
 
__buÊí
)

127 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

128 
ssize_t
 
	`__REDIRECT_NTH
 (
__ªadlök_Æüs
,

129 (
__c⁄°
 *
__ª°ri˘
 
__∑th
,

130 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
), 
ªadlök
)

131 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

132 
ssize_t
 
	`__REDIRECT_NTH
 (
__ªadlök_chk_w¨n
,

133 (
__c⁄°
 *
__ª°ri˘
 
__∑th
,

134 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
,

135 
size_t
 
__buÊí
), 
__ªadlök_chk
)

136 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
 
	`__w¨«âr
 ("readlink called with biggerÜength "

139 
__exã∫_Æways_ölöe
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
 
ssize_t


140 
	`__NTH
 (
	$ªadlök
 (
__c⁄°
 *
__ª°ri˘
 
__∑th
, *__ª°ri˘ 
__buf
,

141 
size_t
 
__Àn
))

143 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

145 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

146  
	`__ªadlök_chk
 (
__∑th
, 
__buf
, 
__Àn
, 
	`__bos
 (__buf));

148 i‡–
__Àn
 > 
	`__bos
 (
__buf
))

149  
	`__ªadlök_chk_w¨n
 (
__∑th
, 
__buf
, 
__Àn
, 
	`__bos
 (__buf));

151  
	`__ªadlök_Æüs
 (
__∑th
, 
__buf
, 
__Àn
);

152 
	}
}

155 #ifde‡
__USE_ATFILE


156 
ssize_t
 
	$__ªadlök©_chk
 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__∑th
,

157 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
,

158 
size_t
 
__buÊí
)

159 
__THROW
 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
;

160 
ssize_t
 
	`__REDIRECT_NTH
 (
__ªadlök©_Æüs
,

161 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__∑th
,

162 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
),

163 
ªadlök©
)

164 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
;

165 
ssize_t
 
	`__REDIRECT_NTH
 (
__ªadlök©_chk_w¨n
,

166 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__∑th
,

167 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
,

168 
size_t
 
__buÊí
), 
__ªadlök©_chk
)

169 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
 
	`__w¨«âr
 ("readlinkat called with bigger "

173 
__exã∫_Æways_ölöe
 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
 
ssize_t


174 
	`__NTH
 (
	$ªadlök©
 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__∑th
,

175 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
))

177 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

179 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

180  
	`__ªadlök©_chk
 (
__fd
, 
__∑th
, 
__buf
, 
__Àn
, 
	`__bos
 (__buf));

182 i‡(
__Àn
 > 
	`__bos
 (
__buf
))

183  
	`__ªadlök©_chk_w¨n
 (
__fd
, 
__∑th
, 
__buf
, 
__Àn
,

184 
	`__bos
 (
__buf
));

186  
	`__ªadlök©_Æüs
 (
__fd
, 
__∑th
, 
__buf
, 
__Àn
);

187 
	}
}

190 *
	$__gëcwd_chk
 (*
__buf
, 
size_t
 
__size
, size_à
__buÊí
)

191 
__THROW
 
__wur
;

192 *
	`__REDIRECT_NTH
 (
__gëcwd_Æüs
,

193 (*
__buf
, 
size_t
 
__size
), 
gëcwd
Ë
__wur
;

194 *
	`__REDIRECT_NTH
 (
__gëcwd_chk_w¨n
,

195 (*
__buf
, 
size_t
 
__size
, size_à
__buÊí
),

196 
__gëcwd_chk
)

197 
__wur
 
	`__w¨«âr
 ("getcwd caller with biggerÜengthÅhan size of "

200 
__exã∫_Æways_ölöe
 
__wur
 *

201 
	`__NTH
 (
	$gëcwd
 (*
__buf
, 
size_t
 
__size
))

203 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

205 i‡(!
	`__buûtö_c⁄°™t_p
 (
__size
))

206  
	`__gëcwd_chk
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

208 i‡(
__size
 > 
	`__bos
 (
__buf
))

209  
	`__gëcwd_chk_w¨n
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

211  
	`__gëcwd_Æüs
 (
__buf
, 
__size
);

212 
	}
}

214 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


215 *
	$__gëwd_chk
 (*
__buf
, 
size_t
 
buÊí
)

216 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

217 *
	`__REDIRECT_NTH
 (
__gëwd_w¨n
, (*
__buf
), 
gëwd
)

218 
	`__n⁄nuŒ
 ((1)Ë
__wur
 
	`__w¨«âr
 ("please use getcwd instead,ás getwd "

221 
__exã∫_Æways_ölöe
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
 
__wur
 *

222 
	`__NTH
 (
	$gëwd
 (*
__buf
))

224 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

225  
	`__gëwd_chk
 (
__buf
, 
	`__bos
 (__buf));

226  
	`__gëwd_w¨n
 (
__buf
);

227 
	}
}

230 
size_t
 
	$__c⁄f°r_chk
 (
__«me
, *
__buf
, 
size_t
 
__Àn
,

231 
size_t
 
__buÊí
Ë
__THROW
;

232 
size_t
 
	`__REDIRECT_NTH
 (
__c⁄f°r_Æüs
, (
__«me
, *
__buf
,

233 
size_t
 
__Àn
), 
c⁄f°r
);

234 
size_t
 
	`__REDIRECT_NTH
 (
__c⁄f°r_chk_w¨n
,

235 (
__«me
, *
__buf
, 
size_t
 
__Àn
,

236 
size_t
 
__buÊí
), 
__c⁄f°r_chk
)

237 
	`__w¨«âr
 ("confstr called with biggerÜengthÅhan size of destination "

240 
__exã∫_Æways_ölöe
 
size_t


241 
	`__NTH
 (
	$c⁄f°r
 (
__«me
, *
__buf
, 
size_t
 
__Àn
))

243 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

245 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

246  
	`__c⁄f°r_chk
 (
__«me
, 
__buf
, 
__Àn
, 
	`__bos
 (__buf));

248 i‡(
	`__bos
 (
__buf
Ë< 
__Àn
)

249  
	`__c⁄f°r_chk_w¨n
 (
__«me
, 
__buf
, 
__Àn
, 
	`__bos
 (__buf));

251  
	`__c⁄f°r_Æüs
 (
__«me
, 
__buf
, 
__Àn
);

252 
	}
}

255 
	$__gëgroups_chk
 (
__size
, 
__gid_t
 
__li°
[], 
size_t
 
__li°Àn
)

256 
__THROW
 
__wur
;

257 
	`__REDIRECT_NTH
 (
__gëgroups_Æüs
, (
__size
, 
__gid_t
 
__li°
[]),

258 
gëgroups
Ë
__wur
;

259 
	`__REDIRECT_NTH
 (
__gëgroups_chk_w¨n
,

260 (
__size
, 
__gid_t
 
__li°
[], 
size_t
 
__li°Àn
),

261 
__gëgroups_chk
)

262 
__wur
 
	`__w¨«âr
 ("getgroups called with bigger group countÅhan what "

265 
__exã∫_Æways_ölöe
 

266 
	`__NTH
 (
	$gëgroups
 (
__size
, 
__gid_t
 
__li°
[]))

268 i‡(
	`__bos
 (
__li°
Ë!(
size_t
) -1)

270 i‡(!
	`__buûtö_c⁄°™t_p
 (
__size
) || __size < 0)

271  
	`__gëgroups_chk
 (
__size
, 
__li°
, 
	`__bos
 (__list));

273 i‡(
__size
 *  (
__gid_t
Ë> 
	`__bos
 (
__li°
))

274  
	`__gëgroups_chk_w¨n
 (
__size
, 
__li°
, 
	`__bos
 (__list));

276  
	`__gëgroups_Æüs
 (
__size
, 
__li°
);

277 
	}
}

280 
	$__ây«me_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
,

281 
size_t
 
__ƒól
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

282 
	`__REDIRECT_NTH
 (
__ây«me_r_Æüs
, (
__fd
, *
__buf
,

283 
size_t
 
__buÊí
), 
ây«me_r
)

284 
	`__n⁄nuŒ
 ((2));

285 
	`__REDIRECT_NTH
 (
__ây«me_r_chk_w¨n
,

286 (
__fd
, *
__buf
, 
size_t
 
__buÊí
,

287 
size_t
 
__ƒól
), 
__ây«me_r_chk
)

288 
	`__n⁄nuŒ
 ((2)Ë
	`__w¨«âr
 ("ttyname_r called with bigger buflenÅhan "

291 
__exã∫_Æways_ölöe
 

292 
	`__NTH
 (
	$ây«me_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
))

294 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

296 i‡(!
	`__buûtö_c⁄°™t_p
 (
__buÊí
))

297  
	`__ây«me_r_chk
 (
__fd
, 
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

299 i‡(
__buÊí
 > 
	`__bos
 (
__buf
))

300  
	`__ây«me_r_chk_w¨n
 (
__fd
, 
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

302  
	`__ây«me_r_Æüs
 (
__fd
, 
__buf
, 
__buÊí
);

303 
	}
}

306 #i‡
deföed
 
__USE_REENTRANT
 || deföed 
__USE_POSIX199506


307 
	$__gëlogö_r_chk
 (*
__buf
, 
size_t
 
__buÊí
, size_à
__ƒól
)

308 
	`__n⁄nuŒ
 ((1));

309 
	`__REDIRECT
 (
__gëlogö_r_Æüs
, (*
__buf
, 
size_t
 
__buÊí
),

310 
gëlogö_r
Ë
	`__n⁄nuŒ
 ((1));

311 
	`__REDIRECT
 (
__gëlogö_r_chk_w¨n
,

312 (*
__buf
, 
size_t
 
__buÊí
, size_à
__ƒól
),

313 
__gëlogö_r_chk
)

314 
	`__n⁄nuŒ
 ((1)Ë
	`__w¨«âr
 ("getlogin_r called with bigger buflenÅhan "

317 
__exã∫_Æways_ölöe
 

318 
	$gëlogö_r
 (*
__buf
, 
size_t
 
__buÊí
)

320 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

322 i‡(!
	`__buûtö_c⁄°™t_p
 (
__buÊí
))

323  
	`__gëlogö_r_chk
 (
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

325 i‡(
__buÊí
 > 
	`__bos
 (
__buf
))

326  
	`__gëlogö_r_chk_w¨n
 (
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

328  
	`__gëlogö_r_Æüs
 (
__buf
, 
__buÊí
);

329 
	}
}

333 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_UNIX98


334 
	$__gëho°«me_chk
 (*
__buf
, 
size_t
 
__buÊí
, size_à
__ƒól
)

335 
__THROW
 
	`__n⁄nuŒ
 ((1));

336 
	`__REDIRECT_NTH
 (
__gëho°«me_Æüs
, (*
__buf
, 
size_t
 
__buÊí
),

337 
gëho°«me
Ë
	`__n⁄nuŒ
 ((1));

338 
	`__REDIRECT_NTH
 (
__gëho°«me_chk_w¨n
,

339 (*
__buf
, 
size_t
 
__buÊí
, size_à
__ƒól
),

340 
__gëho°«me_chk
)

341 
	`__n⁄nuŒ
 ((1)Ë
	`__w¨«âr
 ("gethostname called with bigger buflenÅhan "

344 
__exã∫_Æways_ölöe
 

345 
	`__NTH
 (
	$gëho°«me
 (*
__buf
, 
size_t
 
__buÊí
))

347 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

349 i‡(!
	`__buûtö_c⁄°™t_p
 (
__buÊí
))

350  
	`__gëho°«me_chk
 (
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

352 i‡(
__buÊí
 > 
	`__bos
 (
__buf
))

353  
	`__gëho°«me_chk_w¨n
 (
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

355  
	`__gëho°«me_Æüs
 (
__buf
, 
__buÊí
);

356 
	}
}

360 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_UNIX98
)

361 
	$__gëdomaö«me_chk
 (*
__buf
, 
size_t
 
__buÊí
, size_à
__ƒól
)

362 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

363 
	`__REDIRECT_NTH
 (
__gëdomaö«me_Æüs
, (*
__buf
,

364 
size_t
 
__buÊí
),

365 
gëdomaö«me
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

366 
	`__REDIRECT_NTH
 (
__gëdomaö«me_chk_w¨n
,

367 (*
__buf
, 
size_t
 
__buÊí
, size_à
__ƒól
),

368 
__gëdomaö«me_chk
)

369 
	`__n⁄nuŒ
 ((1)Ë
__wur
 
	`__w¨«âr
 ("getdomainname called with bigger "

373 
__exã∫_Æways_ölöe
 

374 
	`__NTH
 (
	$gëdomaö«me
 (*
__buf
, 
size_t
 
__buÊí
))

376 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

378 i‡(!
	`__buûtö_c⁄°™t_p
 (
__buÊí
))

379  
	`__gëdomaö«me_chk
 (
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

381 i‡(
__buÊí
 > 
	`__bos
 (
__buf
))

382  
	`__gëdomaö«me_chk_w¨n
 (
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

384  
	`__gëdomaö«me_Æüs
 (
__buf
, 
__buÊí
);

385 
	}
}

	@/usr/include/bits/waitflags.h

20 #i‡!
deföed
 
_SYS_WAIT_H
 && !deföed 
_STDLIB_H


26 
	#WNOHANG
 1

	)

27 
	#WUNTRACED
 2

	)

30 
	#WSTOPPED
 2

	)

31 
	#WEXITED
 4

	)

32 
	#WCONTINUED
 8

	)

33 
	#WNOWAIT
 0x01000000

	)

35 
	#__WNOTHREAD
 0x20000000

	)

37 
	#__WALL
 0x40000000

	)

38 
	#__WCLONE
 0x80000000

	)

	@/usr/include/bits/waitstatus.h

20 #i‡!
deföed
 
_SYS_WAIT_H
 && !deföed 
_STDLIB_H


29 
	#__WEXITSTATUS
(
°©us
Ë(((°©usË& 0xff00Ë>> 8)

	)

32 
	#__WTERMSIG
(
°©us
Ë((°©usË& 0x7f)

	)

35 
	#__WSTOPSIG
(
°©us
Ë
	`__WEXITSTATUS
(°©us)

	)

38 
	#__WIFEXITED
(
°©us
Ë(
	`__WTERMSIG
(°©usË=0)

	)

41 
	#__WIFSIGNALED
(
°©us
) \

42 (((sig√d Ë(((
°©us
Ë& 0x7fË+ 1Ë>> 1Ë> 0)

	)

45 
	#__WIFSTOPPED
(
°©us
Ë(((°©usË& 0xffË=0x7f)

	)

49 #ifde‡
WCONTINUED


50 
	#__WIFCONTINUED
(
°©us
Ë((°©usË=
__W_CONTINUED
)

	)

54 
	#__WCOREDUMP
(
°©us
Ë((°©usË& 
__WCOREFLAG
)

	)

57 
	#__W_EXITCODE
(
ªt
, 
sig
Ë(‘ëË<< 8 | (sig))

	)

58 
	#__W_STOPCODE
(
sig
Ë((sigË<< 8 | 0x7f)

	)

59 
	#__W_CONTINUED
 0xffff

	)

60 
	#__WCOREFLAG
 0x80

	)

63 #ifdef 
__USE_BSD


65 
	~<ídün.h
>

67 
	uwaô


69 
	mw_°©us
;

72 #if 
__BYTE_ORDER
 =
__LITTLE_ENDIAN


73 
	m__w_ãrmsig
:7;

74 
	m__w_c‹edump
:1;

75 
	m__w_ªtcode
:8;

78 #if 
__BYTE_ORDER
 =
__BIG_ENDIAN


80 
	m__w_ªtcode
:8;

81 
	m__w_c‹edump
:1;

82 
	m__w_ãrmsig
:7;

84 } 
	m__waô_ãrmö©ed
;

87 #if 
__BYTE_ORDER
 =
__LITTLE_ENDIAN


88 
	m__w_°›vÆ
:8;

89 
	m__w_°›sig
:8;

92 #if 
__BYTE_ORDER
 =
__BIG_ENDIAN


94 
	m__w_°›sig
:8;

95 
	m__w_°›vÆ
:8;

97 } 
	m__waô_°›≥d
;

100 
	#w_ãrmsig
 
__waô_ãrmö©ed
.
__w_ãrmsig


	)

101 
	#w_c‹edump
 
__waô_ãrmö©ed
.
__w_c‹edump


	)

102 
	#w_ªtcode
 
__waô_ãrmö©ed
.
__w_ªtcode


	)

103 
	#w_°›sig
 
__waô_°›≥d
.
__w_°›sig


	)

104 
	#w_°›vÆ
 
__waô_°›≥d
.
__w_°›vÆ


	)

	@/usr/include/features.h

19 #i‚def 
_FEATURES_H


20 
	#_FEATURES_H
 1

	)

95 #unde‡
__USE_ISOC99


96 #unde‡
__USE_ISOC95


97 #unde‡
__USE_POSIX


98 #unde‡
__USE_POSIX2


99 #unde‡
__USE_POSIX199309


100 #unde‡
__USE_POSIX199506


101 #unde‡
__USE_XOPEN


102 #unde‡
__USE_XOPEN_EXTENDED


103 #unde‡
__USE_UNIX98


104 #unde‡
__USE_XOPEN2K


105 #unde‡
__USE_XOPEN2K8


106 #unde‡
__USE_LARGEFILE


107 #unde‡
__USE_LARGEFILE64


108 #unde‡
__USE_FILE_OFFSET64


109 #unde‡
__USE_BSD


110 #unde‡
__USE_SVID


111 #unde‡
__USE_MISC


112 #unde‡
__USE_ATFILE


113 #unde‡
__USE_GNU


114 #unde‡
__USE_REENTRANT


115 #unde‡
__USE_FORTIFY_LEVEL


116 #unde‡
__FAVOR_BSD


117 #unde‡
__KERNEL_STRICT_NAMES


121 #i‚de‡
_LOOSE_KERNEL_NAMES


122 
	#__KERNEL_STRICT_NAMES


	)

126 
	#__USE_ANSI
 1

	)

135 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


136 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

137 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

139 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

144 #i‡
deföed
 
_BSD_SOURCE
 && \

145 !(
deföed
 
	g_POSIX_SOURCE
 || deföed 
	g_POSIX_C_SOURCE
 || \

146 
deföed
 
	g_XOPEN_SOURCE
 || deföed 
	g_XOPEN_SOURCE_EXTENDED
 || \

147 
deföed
 
	g_GNU_SOURCE
 || deföed 
	g_SVID_SOURCE
)

148 
	#__FAVOR_BSD
 1

	)

152 #ifde‡
_GNU_SOURCE


153 #unde‡
_ISOC99_SOURCE


154 
	#_ISOC99_SOURCE
 1

	)

155 #unde‡
_POSIX_SOURCE


156 
	#_POSIX_SOURCE
 1

	)

157 #unde‡
_POSIX_C_SOURCE


158 
	#_POSIX_C_SOURCE
 200809L

	)

159 #unde‡
_XOPEN_SOURCE


160 
	#_XOPEN_SOURCE
 700

	)

161 #unde‡
_XOPEN_SOURCE_EXTENDED


162 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

163 #unde‡
_LARGEFILE64_SOURCE


164 
	#_LARGEFILE64_SOURCE
 1

	)

165 #unde‡
_BSD_SOURCE


166 
	#_BSD_SOURCE
 1

	)

167 #unde‡
_SVID_SOURCE


168 
	#_SVID_SOURCE
 1

	)

169 #unde‡
_ATFILE_SOURCE


170 
	#_ATFILE_SOURCE
 1

	)

175 #i‡(!
deföed
 
__STRICT_ANSI__
 && !deföed 
_ISOC99_SOURCE
 && \

176 !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 && \

177 !
deföed
 
	g_XOPEN_SOURCE
 && !deföed 
	g_XOPEN_SOURCE_EXTENDED
 && \

178 !
deföed
 
	g_BSD_SOURCE
 && !deföed 
	g_SVID_SOURCE
)

179 
	#_BSD_SOURCE
 1

	)

180 
	#_SVID_SOURCE
 1

	)

187 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC9X_SOURCE
 \

188 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

189 
	#__USE_ISOC99
 1

	)

193 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC9X_SOURCE
 \

194 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

195 
	#__USE_ISOC95
 1

	)

200 #i‡((!
deföed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

201 !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

202 
	#_POSIX_SOURCE
 1

	)

203 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

204 
	#_POSIX_C_SOURCE
 2

	)

205 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

206 
	#_POSIX_C_SOURCE
 199506L

	)

207 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

208 
	#_POSIX_C_SOURCE
 200112L

	)

210 
	#_POSIX_C_SOURCE
 200809L

	)

212 
	#__USE_POSIX_IMPLICITLY
 1

	)

215 #i‡
deföed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >1 || deföed 
_XOPEN_SOURCE


216 
	#__USE_POSIX
 1

	)

219 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


220 
	#__USE_POSIX2
 1

	)

223 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199309L

224 
	#__USE_POSIX199309
 1

	)

227 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199506L

228 
	#__USE_POSIX199506
 1

	)

231 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200112L

232 
	#__USE_XOPEN2K
 1

	)

233 #unde‡
__USE_ISOC99


234 
	#__USE_ISOC99
 1

	)

237 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200809L

238 
	#__USE_XOPEN2K8
 1

	)

239 #unde‡
_ATFILE_SOURCE


240 
	#_ATFILE_SOURCE
 1

	)

243 #ifdef 
_XOPEN_SOURCE


244 
	#__USE_XOPEN
 1

	)

245 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

246 
	#__USE_XOPEN_EXTENDED
 1

	)

247 
	#__USE_UNIX98
 1

	)

248 #unde‡
_LARGEFILE_SOURCE


249 
	#_LARGEFILE_SOURCE
 1

	)

250 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

251 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

252 
	#__USE_XOPEN2K8
 1

	)

254 
	#__USE_XOPEN2K
 1

	)

255 #unde‡
__USE_ISOC99


256 
	#__USE_ISOC99
 1

	)

259 #ifde‡
_XOPEN_SOURCE_EXTENDED


260 
	#__USE_XOPEN_EXTENDED
 1

	)

265 #ifde‡
_LARGEFILE_SOURCE


266 
	#__USE_LARGEFILE
 1

	)

269 #ifde‡
_LARGEFILE64_SOURCE


270 
	#__USE_LARGEFILE64
 1

	)

273 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

274 
	#__USE_FILE_OFFSET64
 1

	)

277 #i‡
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE


278 
	#__USE_MISC
 1

	)

281 #ifdef 
_BSD_SOURCE


282 
	#__USE_BSD
 1

	)

285 #ifdef 
_SVID_SOURCE


286 
	#__USE_SVID
 1

	)

289 #ifdef 
_ATFILE_SOURCE


290 
	#__USE_ATFILE
 1

	)

293 #ifdef 
_GNU_SOURCE


294 
	#__USE_GNU
 1

	)

297 #i‡
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE


298 
	#__USE_REENTRANT
 1

	)

301 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

302 && 
__GNUC_PREREQ
 (4, 1Ë&& 
deföed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

303 #i‡
_FORTIFY_SOURCE
 > 1

304 
	#__USE_FORTIFY_LEVEL
 2

	)

306 
	#__USE_FORTIFY_LEVEL
 1

	)

309 
	#__USE_FORTIFY_LEVEL
 0

	)

313 
	~<bôs/¥edefs.h
>

316 
	#__STDC_ISO_10646__
 200009L

	)

324 #unde‡
__GNU_LIBRARY__


325 
	#__GNU_LIBRARY__
 6

	)

329 
	#__GLIBC__
 2

	)

330 
	#__GLIBC_MINOR__
 11

	)

332 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

333 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

336 #i‡
deföed
 
__GNUC__
 \

337 || (
deföed
 
	g__PGI
 && deföed 
	g__i386__
 ) \

338 || (
deföed
 
	g__INTEL_COMPILER
 && (deföed 
	g__i386__
 || deföed 
	g__ü64__
)) \

339 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

340 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

344 #i‚de‡
__ASSEMBLER__


345 #i‚de‡
_SYS_CDEFS_H


346 
	~<sys/cdefs.h
>

351 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


352 
	#__USE_LARGEFILE
 1

	)

353 
	#__USE_LARGEFILE64
 1

	)

359 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

360 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

361 && 
deföed
 
	g__exã∫_ölöe


362 
	#__USE_EXTERN_INLINES
 1

	)

367 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

368 && (
deföed
 
	g_LIBC
 || !deföed 
	g__OPTIMIZE_SIZE__
Ë&& !deföed 
	g__NO_INLINE__
 \

369 && 
deföed
 
	g__exã∫_ölöe


370 
	#__USE_EXTERN_INLINES_IN_LIBC
 1

	)

378 
	~<gnu/°ubs.h
>

	@/usr/include/getopt.h

21 #i‚de‡
_GETOPT_H


23 #i‚de‡
__√ed_gë›t


24 
	#_GETOPT_H
 1

	)

34 #i‡!
deföed
 
__GNU_LIBRARY__


35 
	~<˘y≥.h
>

38 #i‚de‡
__THROW


39 #i‚de‡
__GNUC_PREREQ


40 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë(0)

	)

42 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

43 
	#__THROW
 
	`throw
 ()

	)

45 
	#__THROW


	)

49 #ifdef 
__˝lu•lus


59 *
›èrg
;

73 
›töd
;

78 
›ãº
;

82 
›t›t
;

84 #i‚de‡
__√ed_gë›t


106 
	s›ti⁄


108 c⁄° *
	g«me
;

111 
	ghas_¨g
;

112 *
	gÊag
;

113 
	gvÆ
;

118 
	#no_¨gumít
 0

	)

119 
	#ªquúed_¨gumít
 1

	)

120 
	#›ti⁄Æ_¨gumít
 2

	)

148 #ifde‡
__GNU_LIBRARY__


152 
gë›t
 (
___¨gc
, *c⁄° *
___¨gv
, c⁄° *
__sh‹t›ts
)

153 
__THROW
;

155 #i‡
deföed
 
__√ed_gë›t
 && deföed 
__USE_POSIX2
 \

156 && !
deföed
 
	g__USE_POSIX_IMPLICITLY
 && !deföed 
	g__USE_GNU


160 #ifde‡
__REDIRECT


161 
__REDIRECT
 (
gë›t
, (
___¨gc
, *c⁄° *
___¨gv
,

162 c⁄° *
__sh‹t›ts
),

163 
__posix_gë›t
Ë
__THROW
;

165 
__posix_gë›t
 (
___¨gc
, *c⁄° *
___¨gv
,

166 c⁄° *
__sh‹t›ts
Ë
__THROW
;

167 
	#gë›t
 
__posix_gë›t


	)

171 
gë›t
 ();

174 #i‚de‡
__√ed_gë›t


175 
gë›t_l⁄g
 (
___¨gc
, *c⁄° *
___¨gv
,

176 c⁄° *
__sh‹t›ts
,

177 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

178 
__THROW
;

179 
gë›t_l⁄g_⁄ly
 (
___¨gc
, *c⁄° *
___¨gv
,

180 c⁄° *
__sh‹t›ts
,

181 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

182 
__THROW
;

186 #ifdef 
__˝lu•lus


191 #unde‡
__√ed_gë›t


	@/usr/include/libio.h

29 #i‚de‡
_IO_STDIO_H


30 
	#_IO_STDIO_H


	)

32 
	~<_G_c⁄fig.h
>

34 
	#_IO_pos_t
 
_G_Âos_t


	)

35 
	#_IO_Âos_t
 
_G_Âos_t


	)

36 
	#_IO_Âos64_t
 
_G_Âos64_t


	)

37 
	#_IO_size_t
 
_G_size_t


	)

38 
	#_IO_ssize_t
 
_G_ssize_t


	)

39 
	#_IO_off_t
 
_G_off_t


	)

40 
	#_IO_off64_t
 
_G_off64_t


	)

41 
	#_IO_pid_t
 
_G_pid_t


	)

42 
	#_IO_uid_t
 
_G_uid_t


	)

43 
	#_IO_ic⁄v_t
 
_G_ic⁄v_t


	)

44 
	#_IO_HAVE_SYS_WAIT
 
_G_HAVE_SYS_WAIT


	)

45 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

46 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

47 
	#_IO_va_li°
 
_G_va_li°


	)

48 
	#_IO_wöt_t
 
_G_wöt_t


	)

50 #ifde‡
_G_NEED_STDARG_H


52 
	#__√ed___va_li°


	)

53 
	~<°d¨g.h
>

54 #ifde‡
__GNUC_VA_LIST


55 #unde‡
_IO_va_li°


56 
	#_IO_va_li°
 
__gnuc_va_li°


	)

60 #i‚de‡
__P


61 #i‡
_G_HAVE_SYS_CDEFS


62 
	~<sys/cdefs.h
>

64 #ifde‡
__STDC__


65 
	#__P
(
p
Ë
	)
p

66 
	#__PMT
(
p
Ë
	)
p

68 
	#__P
(
p
Ë()

	)

69 
	#__PMT
(
p
Ë()

	)

75 #i‚de‡
_PARAMS


76 
	#_PARAMS
(
¥Ÿos
Ë
	`__P
’rŸos)

	)

79 #i‚de‡
__STDC__


81 c⁄°

	)

84 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

85 #i‚de‡
_G_HAVE_PRINTF_FP


86 
	#_IO_USE_DTOA
 1

	)

89 #i‚de‡
EOF


90 
	#EOF
 (-1)

	)

92 #i‚de‡
NULL


93 #i‡
deföed
 
__GNUG__
 && \

94 (
	g__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 8))

95 
	#NULL
 (
__nuŒ
)

	)

97 #i‡!
deföed
(
__˝lu•lus
)

98 
	#NULL
 ((*)0)

	)

100 
	#NULL
 (0)

	)

105 
	#_IOS_INPUT
 1

	)

106 
	#_IOS_OUTPUT
 2

	)

107 
	#_IOS_ATEND
 4

	)

108 
	#_IOS_APPEND
 8

	)

109 
	#_IOS_TRUNC
 16

	)

110 
	#_IOS_NOCREATE
 32

	)

111 
	#_IOS_NOREPLACE
 64

	)

112 
	#_IOS_BIN
 128

	)

120 
	#_IO_MAGIC
 0xFBAD0000

	)

121 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

122 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

123 
	#_IO_USER_BUF
 1

	)

124 
	#_IO_UNBUFFERED
 2

	)

125 
	#_IO_NO_READS
 4

	)

126 
	#_IO_NO_WRITES
 8

	)

127 
	#_IO_EOF_SEEN
 0x10

	)

128 
	#_IO_ERR_SEEN
 0x20

	)

129 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

130 
	#_IO_LINKED
 0x80

	)

131 
	#_IO_IN_BACKUP
 0x100

	)

132 
	#_IO_LINE_BUF
 0x200

	)

133 
	#_IO_TIED_PUT_GET
 0x400

	)

134 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

135 
	#_IO_IS_APPENDING
 0x1000

	)

136 
	#_IO_IS_FILEBUF
 0x2000

	)

137 
	#_IO_BAD_SEEN
 0x4000

	)

138 
	#_IO_USER_LOCK
 0x8000

	)

140 
	#_IO_FLAGS2_MMAP
 1

	)

141 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

142 #ifde‡
_LIBC


143 
	#_IO_FLAGS2_FORTIFY
 4

	)

145 
	#_IO_FLAGS2_USER_WBUF
 8

	)

146 #ifde‡
_LIBC


147 
	#_IO_FLAGS2_SCANF_STD
 16

	)

151 
	#_IO_SKIPWS
 01

	)

152 
	#_IO_LEFT
 02

	)

153 
	#_IO_RIGHT
 04

	)

154 
	#_IO_INTERNAL
 010

	)

155 
	#_IO_DEC
 020

	)

156 
	#_IO_OCT
 040

	)

157 
	#_IO_HEX
 0100

	)

158 
	#_IO_SHOWBASE
 0200

	)

159 
	#_IO_SHOWPOINT
 0400

	)

160 
	#_IO_UPPERCASE
 01000

	)

161 
	#_IO_SHOWPOS
 02000

	)

162 
	#_IO_SCIENTIFIC
 04000

	)

163 
	#_IO_FIXED
 010000

	)

164 
	#_IO_UNITBUF
 020000

	)

165 
	#_IO_STDIO
 040000

	)

166 
	#_IO_DONT_CLOSE
 0100000

	)

167 
	#_IO_BOOLALPHA
 0200000

	)

170 
_IO_jump_t
; 
	g_IO_FILE
;

173 #ifde‡
_IO_MTSAFE_IO


174 #i‡
deföed
 
__GLIBC__
 && __GLIBC__ >= 2

175 
	~<bôs/°dio-lock.h
>

180 
	t_IO_lock_t
;

186 
	s_IO_m¨kî
 {

187 
_IO_m¨kî
 *
	m_√xt
;

188 
_IO_FILE
 *
	m_sbuf
;

192 
	m_pos
;

194 
£t_°ªampos
(
°ªampos
 
•
Ë{ 
	m_•os
 = sp; }

195 
£t_off£t
(
off£t
Ë{ 
	m_pos
 = off£t; 
	m_•os
 = (
°ªampos
)(-2); }

196 
	mpublic
:

197 
°ªamm¨kî
(
°ªambuf
 *
sb
);

198 ~
°ªamm¨kî
();

199 
ßvög
(Ë{  
	m_•os
 == -2; }

200 
dñè
(
°ªamm¨kî
&);

201 
dñè
();

206 
	e__codecvt_ªsu…


208 
	m__codecvt_ok
,

209 
	m__codecvt_∑πül
,

210 
	m__codecvt_îr‹
,

211 
	m__codecvt_noc⁄v


214 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


217 
	s_IO_codecvt


219 (*
	m__codecvt_de°r
Ë(
	m_IO_codecvt
 *);

220 
__codecvt_ªsu…
 (*
__codecvt_do_out
Ë(
	m_IO_codecvt
 *,

221 
	m__mb°©e_t
 *,

222 c⁄° 
	mwch¨_t
 *,

223 c⁄° 
	mwch¨_t
 *,

224 c⁄° 
	mwch¨_t
 **, *,

226 
__codecvt_ªsu…
 (*
__codecvt_do_unshi·
Ë(
	m_IO_codecvt
 *,

227 
	m__mb°©e_t
 *, *,

229 
__codecvt_ªsu…
 (*
__codecvt_do_ö
Ë(
	m_IO_codecvt
 *,

230 
	m__mb°©e_t
 *,

232 c⁄° **, 
	mwch¨_t
 *,

233 
	mwch¨_t
 *, wchar_t **);

234 (*
	m__codecvt_do_ícodög
Ë(
	m_IO_codecvt
 *);

235 (*
	m__codecvt_do_Æways_noc⁄v
Ë(
	m_IO_codecvt
 *);

236 (*
	m__codecvt_do_Àngth
Ë(
	m_IO_codecvt
 *, 
	m__mb°©e_t
 *,

237 c⁄° *, c⁄° *, 
	m_IO_size_t
);

238 (*
	m__codecvt_do_max_Àngth
Ë(
	m_IO_codecvt
 *);

240 
_IO_ic⁄v_t
 
	m__cd_ö
;

241 
_IO_ic⁄v_t
 
	m__cd_out
;

245 
	s_IO_wide_d©a


247 
wch¨_t
 *
	m_IO_ªad_±r
;

248 
wch¨_t
 *
	m_IO_ªad_íd
;

249 
wch¨_t
 *
	m_IO_ªad_ba£
;

250 
wch¨_t
 *
	m_IO_wrôe_ba£
;

251 
wch¨_t
 *
	m_IO_wrôe_±r
;

252 
wch¨_t
 *
	m_IO_wrôe_íd
;

253 
wch¨_t
 *
	m_IO_buf_ba£
;

254 
wch¨_t
 *
	m_IO_buf_íd
;

256 
wch¨_t
 *
	m_IO_ßve_ba£
;

257 
wch¨_t
 *
	m_IO_backup_ba£
;

259 
wch¨_t
 *
	m_IO_ßve_íd
;

261 
__mb°©e_t
 
	m_IO_°©e
;

262 
__mb°©e_t
 
	m_IO_œ°_°©e
;

263 
_IO_codecvt
 
	m_codecvt
;

265 
wch¨_t
 
	m_sh‹tbuf
[1];

267 c⁄° 
_IO_jump_t
 *
	m_wide_vèbÀ
;

271 
	s_IO_FILE
 {

272 
	m_Êags
;

273 
	#_IO_fûe_Êags
 
_Êags


	)

277 * 
	m_IO_ªad_±r
;

278 * 
	m_IO_ªad_íd
;

279 * 
	m_IO_ªad_ba£
;

280 * 
	m_IO_wrôe_ba£
;

281 * 
	m_IO_wrôe_±r
;

282 * 
	m_IO_wrôe_íd
;

283 * 
	m_IO_buf_ba£
;

284 * 
	m_IO_buf_íd
;

286 *
	m_IO_ßve_ba£
;

287 *
	m_IO_backup_ba£
;

288 *
	m_IO_ßve_íd
;

290 
_IO_m¨kî
 *
	m_m¨kîs
;

292 
_IO_FILE
 *
	m_chaö
;

294 
	m_fûío
;

296 
	m_blksize
;

298 
	m_Êags2
;

300 
_IO_off_t
 
	m_ﬁd_off£t
;

302 
	#__HAVE_COLUMN


	)

304 
	m_cur_cﬁumn
;

305 sig√d 
	m_vèbÀ_off£t
;

306 
	m_sh‹tbuf
[1];

310 
_IO_lock_t
 *
	m_lock
;

311 #ifde‡
_IO_USE_OLD_IO_FILE


314 
	s_IO_FILE_com∂ëe


316 
_IO_FILE
 
	m_fûe
;

318 #i‡
deföed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

319 
_IO_off64_t
 
	m_off£t
;

320 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


322 
_IO_codecvt
 *
	m_codecvt
;

323 
_IO_wide_d©a
 *
	m_wide_d©a
;

324 
_IO_FILE
 *
	m_‰ìªs_li°
;

325 *
	m_‰ìªs_buf
;

326 
size_t
 
	m_‰ìªs_size
;

328 *
	m__∑d1
;

329 *
	m__∑d2
;

330 *
	m__∑d3
;

331 *
	m__∑d4
;

332 
size_t
 
	m__∑d5
;

334 
	m_mode
;

336 
	m_unu£d2
[15 *  (Ë- 4 *  (*Ë-  (
size_t
)];

340 #i‚de‡
__˝lu•lus


341 
_IO_FILE
 
	t_IO_FILE
;

344 
	g_IO_FILE_∂us
;

346 
_IO_FILE_∂us
 
_IO_2_1_°dö_
;

347 
_IO_FILE_∂us
 
_IO_2_1_°dout_
;

348 
_IO_FILE_∂us
 
_IO_2_1_°dîr_
;

349 #i‚de‡
_LIBC


350 
	#_IO_°dö
 ((
_IO_FILE
*)(&
_IO_2_1_°dö_
))

	)

351 
	#_IO_°dout
 ((
_IO_FILE
*)(&
_IO_2_1_°dout_
))

	)

352 
	#_IO_°dîr
 ((
_IO_FILE
*)(&
_IO_2_1_°dîr_
))

	)

354 
_IO_FILE
 *
_IO_°dö
 
©åibuã_hiddí
;

355 
_IO_FILE
 *
_IO_°dout
 
©åibuã_hiddí
;

356 
_IO_FILE
 *
_IO_°dîr
 
©åibuã_hiddí
;

364 
__ssize_t
 
	t__io_ªad_‚
 (*
	t__cookõ
, *
	t__buf
, 
	tsize_t
 
	t__nbyãs
);

372 
__ssize_t
 
	t__io_wrôe_‚
 (*
	t__cookõ
, 
	t__c⁄°
 *
	t__buf
,

373 
	tsize_t
 
	t__n
);

381 
	t__io_£ek_‚
 (*
	t__cookõ
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

384 
	t__io_˛o£_‚
 (*
	t__cookõ
);

387 #ifde‡
_GNU_SOURCE


389 
__io_ªad_‚
 
	tcookõ_ªad_fun˘i⁄_t
;

390 
__io_wrôe_‚
 
	tcookõ_wrôe_fun˘i⁄_t
;

391 
__io_£ek_‚
 
	tcookõ_£ek_fun˘i⁄_t
;

392 
__io_˛o£_‚
 
	tcookõ_˛o£_fun˘i⁄_t
;

397 
__io_ªad_‚
 *
	mªad
;

398 
__io_wrôe_‚
 *
	mwrôe
;

399 
__io_£ek_‚
 *
	m£ek
;

400 
__io_˛o£_‚
 *
	m˛o£
;

401 } 
	t_IO_cookõ_io_fun˘i⁄s_t
;

402 
_IO_cookõ_io_fun˘i⁄s_t
 
	tcookõ_io_fun˘i⁄s_t
;

404 
	g_IO_cookõ_fûe
;

407 
_IO_cookõ_öô
 (
_IO_cookõ_fûe
 *
__cfûe
, 
__ªad_wrôe
,

408 *
__cookõ
, 
_IO_cookõ_io_fun˘i⁄s_t
 
__‚s
);

412 #ifde‡
__˝lu•lus


416 
__undîÊow
 (
_IO_FILE
 *);

417 
__uÊow
 (
_IO_FILE
 *);

418 
__ovîÊow
 (
_IO_FILE
 *, );

419 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


420 
_IO_wöt_t
 
__wundîÊow
 (
_IO_FILE
 *);

421 
_IO_wöt_t
 
__wuÊow
 (
_IO_FILE
 *);

422 
_IO_wöt_t
 
__wovîÊow
 (
_IO_FILE
 *, _IO_wint_t);

425 #i‡ 
__GNUC__
 >= 3

426 
	#_IO_BE
(
ex¥
, 
ªs
Ë
	`__buûtö_ex≥˘
 (”x¥),Ñes)

	)

428 
	#_IO_BE
(
ex¥
, 
ªs
Ë”x¥)

	)

431 
	#_IO_gëc_u∆ocked
(
_Â
) \

432 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

433 ? 
	`__uÊow
 (
_Â
Ë: *(*Ë(_Â)->
_IO_ªad_±r
++)

	)

434 
	#_IO_≥ekc_u∆ocked
(
_Â
) \

435 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

436 && 
	`__undîÊow
 (
_Â
Ë=
EOF
 ? EOF \

437 : *(*Ë(
_Â
)->
_IO_ªad_±r
)

	)

438 
	#_IO_putc_u∆ocked
(
_ch
, 
_Â
) \

439 (
	`_IO_BE
 ((
_Â
)->
_IO_wrôe_±r
 >(_Â)->
_IO_wrôe_íd
, 0) \

440 ? 
	`__ovîÊow
 (
_Â
, (Ë(
_ch
)) \

441 : (Ë(*(
_Â
)->
_IO_wrôe_±r
++ = (
_ch
)))

	)

443 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


444 
	#_IO_gëwc_u∆ocked
(
_Â
) \

445 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

446 || ((
_Â
)->
_wide_d©a
->
_IO_ªad_±r
 \

447 >(
_Â
)->
_wide_d©a
->
_IO_ªad_íd
), 0) \

448 ? 
	`__wuÊow
 (
_Â
Ë: (
_IO_wöt_t
Ë*(_Â)->
_wide_d©a
->
_IO_ªad_±r
++)

	)

449 
	#_IO_putwc_u∆ocked
(
_wch
, 
_Â
) \

450 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

451 || ((
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
 \

452 >(
_Â
)->
_wide_d©a
->
_IO_wrôe_íd
), 0) \

453 ? 
	`__wovîÊow
 (
_Â
, 
_wch
) \

454 : (
_IO_wöt_t
Ë(*(
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
++ = (
_wch
)))

	)

457 
	#_IO_„of_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_EOF_SEEN
Ë!0)

	)

458 
	#_IO_„º‹_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_ERR_SEEN
Ë!0)

	)

460 
_IO_gëc
 (
_IO_FILE
 *
__Â
);

461 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__Â
);

462 
_IO_„of
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

463 
_IO_„º‹
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

465 
_IO_≥ekc_locked
 (
_IO_FILE
 *
__Â
);

468 
	#_IO_PENDING_OUTPUT_COUNT
(
_Â
) \

469 ((
_Â
)->
_IO_wrôe_±r
 - (_Â)->
_IO_wrôe_ba£
)

	)

471 
_IO_Êockfûe
 (
_IO_FILE
 *Ë
__THROW
;

472 
_IO_fu∆ockfûe
 (
_IO_FILE
 *Ë
__THROW
;

473 
_IO_·rylockfûe
 (
_IO_FILE
 *Ë
__THROW
;

475 #ifde‡
_IO_MTSAFE_IO


476 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_locked
 (_Â)

	)

477 
	#_IO_Êockfûe
(
_Â
) \

478 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_Êockfûe
 (_Â)

	)

479 
	#_IO_fu∆ockfûe
(
_Â
) \

480 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_fu∆ockfûe
 (_Â)

	)

482 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_u∆ocked
 (_Â)

	)

483 
	#_IO_Êockfûe
(
_Â
Ë

	)

484 
	#_IO_fu∆ockfûe
(
_Â
Ë

	)

485 
	#_IO_·rylockfûe
(
_Â
Ë

	)

486 
	#_IO_˛ónup_ªgi⁄_°¨t
(
_f˘
, 
_Â
Ë

	)

487 
	#_IO_˛ónup_ªgi⁄_íd
(
_Doô
Ë

	)

490 
_IO_vfsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, const * __restrict,

491 
_IO_va_li°
, *
__ª°ri˘
);

492 
_IO_vÂrötf
 (
_IO_FILE
 *
__ª°ri˘
, const *__restrict,

493 
_IO_va_li°
);

494 
_IO_ssize_t
 
_IO_∑dn
 (
_IO_FILE
 *, , _IO_ssize_t);

495 
_IO_size_t
 
_IO_sgën
 (
_IO_FILE
 *, *, _IO_size_t);

497 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

498 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

500 
_IO_‰ì_backup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

502 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


503 
_IO_wöt_t
 
_IO_gëwc
 (
_IO_FILE
 *
__Â
);

504 
_IO_wöt_t
 
_IO_putwc
 (
wch¨_t
 
__wc
, 
_IO_FILE
 *
__Â
);

505 
_IO_fwide
 (
_IO_FILE
 *
__Â
, 
__mode
Ë
__THROW
;

506 #i‡
__GNUC__
 >= 2

509 #i‡
deföed
 
_LIBC
 && deföed 
SHARED


510 
	~<shlib-com∑t.h
>

511 #i‡
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

512 
	#_IO_fwide_maybe_öcom∑tibÀ
 \

513 (
	`__buûtö_ex≥˘
 (&
_IO_°dö_u£d
 =
NULL
, 0))

	)

514 c⁄° 
_IO_°dö_u£d
;

515 
wók_exã∫
 (
_IO_°dö_u£d
);

518 #i‚de‡
_IO_fwide_maybe_öcom∑tibÀ


519 
	#_IO_fwide_maybe_öcom∑tibÀ
 (0)

	)

523 
	#_IO_fwide
(
__Â
, 
__mode
) \

524 ({ 
__ªsu…
 = (
__mode
); \

525 i‡(
__ªsu…
 < 0 && ! 
_IO_fwide_maybe_öcom∑tibÀ
) \

527 i‡((
__Â
)->
_mode
 == 0) \

529 (
__Â
)->
_mode
 = -1; \

530 
__ªsu…
 = (
__Â
)->
_mode
; \

532 i‡(
	`__buûtö_c⁄°™t_p
 (
__mode
) && (__mode) == 0) \

533 
__ªsu…
 = 
_IO_fwide_maybe_öcom∑tibÀ
 ? -1 : (
__Â
)->
_mode
; \

535 
__ªsu…
 = 
	`_IO_fwide
 (
__Â
, __result); \

536 
__ªsu…
; })

	)

539 
_IO_vfwsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, c⁄° 
wch¨_t
 * __restrict,

540 
_IO_va_li°
, *
__ª°ri˘
);

541 
_IO_vfw¥ötf
 (
_IO_FILE
 *
__ª°ri˘
, c⁄° 
wch¨_t
 *__restrict,

542 
_IO_va_li°
);

543 
_IO_ssize_t
 
_IO_w∑dn
 (
_IO_FILE
 *, 
wöt_t
, _IO_ssize_t);

544 
_IO_‰ì_wbackup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

547 #ifde‡
__LDBL_COMPAT


548 
	~<bôs/libio-ldbl.h
>

551 #ifde‡
__˝lu•lus


	@/usr/include/linux/if.h

19 #i‚de‡
_LINUX_IF_H


20 
	#_LINUX_IF_H


	)

22 
	~<löux/ty≥s.h
>

23 
	~<löux/sockë.h
>

26 
	#IFNAMSIZ
 16

	)

27 
	#IFALIASZ
 256

	)

28 
	~<löux/hdlc/io˘l.h
>

31 
	#IFF_UP
 0x1

	)

32 
	#IFF_BROADCAST
 0x2

	)

33 
	#IFF_DEBUG
 0x4

	)

34 
	#IFF_LOOPBACK
 0x8

	)

35 
	#IFF_POINTOPOINT
 0x10

	)

36 
	#IFF_NOTRAILERS
 0x20

	)

37 
	#IFF_RUNNING
 0x40

	)

38 
	#IFF_NOARP
 0x80

	)

39 
	#IFF_PROMISC
 0x100

	)

40 
	#IFF_ALLMULTI
 0x200

	)

42 
	#IFF_MASTER
 0x400

	)

43 
	#IFF_SLAVE
 0x800

	)

45 
	#IFF_MULTICAST
 0x1000

	)

47 
	#IFF_PORTSEL
 0x2000

	)

48 
	#IFF_AUTOMEDIA
 0x4000

	)

49 
	#IFF_DYNAMIC
 0x8000

	)

51 
	#IFF_LOWER_UP
 0x10000

	)

52 
	#IFF_DORMANT
 0x20000

	)

54 
	#IFF_ECHO
 0x40000

	)

56 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

57 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

60 
	#IFF_802_1Q_VLAN
 0x1

	)

61 
	#IFF_EBRIDGE
 0x2

	)

62 
	#IFF_SLAVE_INACTIVE
 0x4

	)

63 
	#IFF_MASTER_8023AD
 0x8

	)

64 
	#IFF_MASTER_ALB
 0x10

	)

65 
	#IFF_BONDING
 0x20

	)

66 
	#IFF_SLAVE_NEEDARP
 0x40

	)

67 
	#IFF_ISATAP
 0x80

	)

68 
	#IFF_MASTER_ARPMON
 0x100

	)

69 
	#IFF_WAN_HDLC
 0x200

	)

70 
	#IFF_XMIT_DST_RELEASE
 0x400

	)

74 
	#IF_GET_IFACE
 0x0001

	)

75 
	#IF_GET_PROTO
 0x0002

	)

78 
	#IF_IFACE_V35
 0x1000

	)

79 
	#IF_IFACE_V24
 0x1001

	)

80 
	#IF_IFACE_X21
 0x1002

	)

81 
	#IF_IFACE_T1
 0x1003

	)

82 
	#IF_IFACE_E1
 0x1004

	)

83 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

84 
	#IF_IFACE_X21D
 0x1006

	)

87 
	#IF_PROTO_HDLC
 0x2000

	)

88 
	#IF_PROTO_PPP
 0x2001

	)

89 
	#IF_PROTO_CISCO
 0x2002

	)

90 
	#IF_PROTO_FR
 0x2003

	)

91 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

92 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

93 
	#IF_PROTO_X25
 0x2006

	)

94 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

95 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

96 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

97 
	#IF_PROTO_FR_PVC
 0x200A

	)

98 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

99 
	#IF_PROTO_RAW
 0x200C

	)

103 
	mIF_OPER_UNKNOWN
,

104 
	mIF_OPER_NOTPRESENT
,

105 
	mIF_OPER_DOWN
,

106 
	mIF_OPER_LOWERLAYERDOWN
,

107 
	mIF_OPER_TESTING
,

108 
	mIF_OPER_DORMANT
,

109 
	mIF_OPER_UP
,

114 
	mIF_LINK_MODE_DEFAULT
,

115 
	mIF_LINK_MODE_DORMANT
,

128 
	sifm≠


130 
	mmem_°¨t
;

131 
	mmem_íd
;

132 
	mba£_addr
;

133 
	múq
;

134 
	mdma
;

135 
	mp‹t
;

139 
	sif_£âögs


141 
	mty≥
;

142 
	msize
;

145 
øw_hdlc_¥Ÿo
 *
	møw_hdlc
;

146 
cisco_¥Ÿo
 *
	mcisco
;

147 
‰_¥Ÿo
 *
	m‰
;

148 
‰_¥Ÿo_pvc
 *
	m‰_pvc
;

149 
‰_¥Ÿo_pvc_öfo
 *
	m‰_pvc_öfo
;

152 
sync_£rül_£âögs
 *
	msync
;

153 
ã1_£âögs
 *
	mã1
;

154 } 
	mifs_ifsu
;

164 
	si‰eq


166 
	#IFHWADDRLEN
 6

	)

169 
	mi‰n_«me
[
IFNAMSIZ
];

170 } 
	mi‰_i‰n
;

173 
sockaddr
 
	mi‰u_addr
;

174 
sockaddr
 
	mi‰u_d°addr
;

175 
sockaddr
 
	mi‰u_brﬂdaddr
;

176 
sockaddr
 
	mi‰u_√tmask
;

177 
sockaddr
 
	mi‰u_hwaddr
;

178 
	mi‰u_Êags
;

179 
	mi‰u_ivÆue
;

180 
	mi‰u_mtu
;

181 
ifm≠
 
	mi‰u_m≠
;

182 
	mi‰u_¶ave
[
IFNAMSIZ
];

183 
	mi‰u_√w«me
[
IFNAMSIZ
];

184 * 
	mi‰u_d©a
;

185 
if_£âögs
 
	mi‰u_£âögs
;

186 } 
	mi‰_i‰u
;

189 
	#i‰_«me
 
i‰_i‰n
.
i‰n_«me


	)

190 
	#i‰_hwaddr
 
i‰_i‰u
.
i‰u_hwaddr


	)

191 
	#i‰_addr
 
i‰_i‰u
.
i‰u_addr


	)

192 
	#i‰_d°addr
 
i‰_i‰u
.
i‰u_d°addr


	)

193 
	#i‰_brﬂdaddr
 
i‰_i‰u
.
i‰u_brﬂdaddr


	)

194 
	#i‰_√tmask
 
i‰_i‰u
.
i‰u_√tmask


	)

195 
	#i‰_Êags
 
i‰_i‰u
.
i‰u_Êags


	)

196 
	#i‰_mëric
 
i‰_i‰u
.
i‰u_ivÆue


	)

197 
	#i‰_mtu
 
i‰_i‰u
.
i‰u_mtu


	)

198 
	#i‰_m≠
 
i‰_i‰u
.
i‰u_m≠


	)

199 
	#i‰_¶ave
 
i‰_i‰u
.
i‰u_¶ave


	)

200 
	#i‰_d©a
 
i‰_i‰u
.
i‰u_d©a


	)

201 
	#i‰_ifödex
 
i‰_i‰u
.
i‰u_ivÆue


	)

202 
	#i‰_b™dwidth
 
i‰_i‰u
.
i‰u_ivÆue


	)

203 
	#i‰_qÀn
 
i‰_i‰u
.
i‰u_ivÆue


	)

204 
	#i‰_√w«me
 
i‰_i‰u
.
i‰u_√w«me


	)

205 
	#i‰_£âögs
 
i‰_i‰u
.
i‰u_£âögs


	)

214 
	sifc⁄f


216 
	mifc_Àn
;

219 *
	mifcu_buf
;

220 
i‰eq
 *
	mifcu_ªq
;

221 } 
	mifc_ifcu
;

223 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

224 
	#ifc_ªq
 
ifc_ifcu
.
ifcu_ªq


	)

	@/usr/include/linux/if_ether.h

21 #i‚de‡
_LINUX_IF_ETHER_H


22 
	#_LINUX_IF_ETHER_H


	)

24 
	~<löux/ty≥s.h
>

31 
	#ETH_ALEN
 6

	)

32 
	#ETH_HLEN
 14

	)

33 
	#ETH_ZLEN
 60

	)

34 
	#ETH_DATA_LEN
 1500

	)

35 
	#ETH_FRAME_LEN
 1514

	)

36 
	#ETH_FCS_LEN
 4

	)

42 
	#ETH_P_LOOP
 0x0060

	)

43 
	#ETH_P_PUP
 0x0200

	)

44 
	#ETH_P_PUPAT
 0x0201

	)

45 
	#ETH_P_IP
 0x0800

	)

46 
	#ETH_P_X25
 0x0805

	)

47 
	#ETH_P_ARP
 0x0806

	)

48 
	#ETH_P_BPQ
 0x08FF

	)

49 
	#ETH_P_IEEEPUP
 0x0a00

	)

50 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

51 
	#ETH_P_DEC
 0x6000

	)

52 
	#ETH_P_DNA_DL
 0x6001

	)

53 
	#ETH_P_DNA_RC
 0x6002

	)

54 
	#ETH_P_DNA_RT
 0x6003

	)

55 
	#ETH_P_LAT
 0x6004

	)

56 
	#ETH_P_DIAG
 0x6005

	)

57 
	#ETH_P_CUST
 0x6006

	)

58 
	#ETH_P_SCA
 0x6007

	)

59 
	#ETH_P_TEB
 0x6558

	)

60 
	#ETH_P_RARP
 0x8035

	)

61 
	#ETH_P_ATALK
 0x809B

	)

62 
	#ETH_P_AARP
 0x80F3

	)

63 
	#ETH_P_8021Q
 0x8100

	)

64 
	#ETH_P_IPX
 0x8137

	)

65 
	#ETH_P_IPV6
 0x86DD

	)

66 
	#ETH_P_PAUSE
 0x8808

	)

67 
	#ETH_P_SLOW
 0x8809

	)

68 
	#ETH_P_WCCP
 0x883E

	)

70 
	#ETH_P_PPP_DISC
 0x8863

	)

71 
	#ETH_P_PPP_SES
 0x8864

	)

72 
	#ETH_P_MPLS_UC
 0x8847

	)

73 
	#ETH_P_MPLS_MC
 0x8848

	)

74 
	#ETH_P_ATMMPOA
 0x884¯

	)

75 
	#ETH_P_ATMFATE
 0x8884

	)

78 
	#ETH_P_PAE
 0x888E

	)

79 
	#ETH_P_AOE
 0x88A2

	)

80 
	#ETH_P_TIPC
 0x88CA

	)

81 
	#ETH_P_1588
 0x88F7

	)

82 
	#ETH_P_FCOE
 0x8906

	)

83 
	#ETH_P_FIP
 0x8914

	)

84 
	#ETH_P_EDSA
 0xDADA

	)

90 
	#ETH_P_802_3
 0x0001

	)

91 
	#ETH_P_AX25
 0x0002

	)

92 
	#ETH_P_ALL
 0x0003

	)

93 
	#ETH_P_802_2
 0x0004

	)

94 
	#ETH_P_SNAP
 0x0005

	)

95 
	#ETH_P_DDCMP
 0x0006

	)

96 
	#ETH_P_WAN_PPP
 0x0007

	)

97 
	#ETH_P_PPP_MP
 0x0008

	)

98 
	#ETH_P_LOCALTALK
 0x0009

	)

99 
	#ETH_P_CAN
 0x000C

	)

100 
	#ETH_P_PPPTALK
 0x0010

	)

101 
	#ETH_P_TR_802_2
 0x0011

	)

102 
	#ETH_P_MOBITEX
 0x0015

	)

103 
	#ETH_P_CONTROL
 0x0016

	)

104 
	#ETH_P_IRDA
 0x0017

	)

105 
	#ETH_P_ECONET
 0x0018

	)

106 
	#ETH_P_HDLC
 0x0019

	)

107 
	#ETH_P_ARCNET
 0x001A

	)

108 
	#ETH_P_DSA
 0x001B

	)

109 
	#ETH_P_TRAILER
 0x001C

	)

110 
	#ETH_P_PHONET
 0x00F5

	)

111 
	#ETH_P_IEEE802154
 0x00F6

	)

117 
	sëhhdr
 {

118 
	mh_de°
[
ETH_ALEN
];

119 
	mh_sour˚
[
ETH_ALEN
];

120 
__be16
 
	mh_¥Ÿo
;

121 } 
__©åibuã__
((
∑cked
));

	@/usr/include/linux/if_packet.h

1 #i‚de‡
__LINUX_IF_PACKET_H


2 
	#__LINUX_IF_PACKET_H


	)

4 
	~<löux/ty≥s.h
>

6 
	ssockaddr_pkt


8 
	m•kt_Ámûy
;

9 
	m•kt_devi˚
[14];

10 
__be16
 
	m•kt_¥Ÿocﬁ
;

13 
	ssockaddr_Œ


15 
	m¶l_Ámûy
;

16 
__be16
 
	m¶l_¥Ÿocﬁ
;

17 
	m¶l_ifödex
;

18 
	m¶l_h©y≥
;

19 
	m¶l_pkây≥
;

20 
	m¶l_hÆí
;

21 
	m¶l_addr
[8];

26 
	#PACKET_HOST
 0

	)

27 
	#PACKET_BROADCAST
 1

	)

28 
	#PACKET_MULTICAST
 2

	)

29 
	#PACKET_OTHERHOST
 3

	)

30 
	#PACKET_OUTGOING
 4

	)

32 
	#PACKET_LOOPBACK
 5

	)

33 
	#PACKET_FASTROUTE
 6

	)

37 
	#PACKET_ADD_MEMBERSHIP
 1

	)

38 
	#PACKET_DROP_MEMBERSHIP
 2

	)

39 
	#PACKET_RECV_OUTPUT
 3

	)

41 
	#PACKET_RX_RING
 5

	)

42 
	#PACKET_STATISTICS
 6

	)

43 
	#PACKET_COPY_THRESH
 7

	)

44 
	#PACKET_AUXDATA
 8

	)

45 
	#PACKET_ORIGDEV
 9

	)

46 
	#PACKET_VERSION
 10

	)

47 
	#PACKET_HDRLEN
 11

	)

48 
	#PACKET_RESERVE
 12

	)

49 
	#PACKET_TX_RING
 13

	)

50 
	#PACKET_LOSS
 14

	)

52 
	sçackë_°©s


54 
	mç_∑ckës
;

55 
	mç_dr›s
;

58 
	sçackë_auxd©a


60 
__u32
 
	mç_°©us
;

61 
__u32
 
	mç_Àn
;

62 
__u32
 
	mç_¢≠Àn
;

63 
__u16
 
	mç_mac
;

64 
__u16
 
	mç_√t
;

65 
__u16
 
	mç_vœn_tci
;

69 
	#TP_STATUS_KERNEL
 0x0

	)

70 
	#TP_STATUS_USER
 0x1

	)

71 
	#TP_STATUS_COPY
 0x2

	)

72 
	#TP_STATUS_LOSING
 0x4

	)

73 
	#TP_STATUS_CSUMNOTREADY
 0x8

	)

76 
	#TP_STATUS_AVAILABLE
 0x0

	)

77 
	#TP_STATUS_SEND_REQUEST
 0x1

	)

78 
	#TP_STATUS_SENDING
 0x2

	)

79 
	#TP_STATUS_WRONG_FORMAT
 0x4

	)

81 
	sçackë_hdr


83 
	mç_°©us
;

84 
	mç_Àn
;

85 
	mç_¢≠Àn
;

86 
	mç_mac
;

87 
	mç_√t
;

88 
	mç_£c
;

89 
	mç_u£c
;

92 
	#TPACKET_ALIGNMENT
 16

	)

93 
	#TPACKET_ALIGN
(
x
Ë(((x)+
TPACKET_ALIGNMENT
-1)&~(TPACKET_ALIGNMENT-1))

	)

94 
	#TPACKET_HDRLEN
 (
	`TPACKET_ALIGN
((
çackë_hdr
)Ë+ (
sockaddr_Œ
))

	)

96 
	sçackë2_hdr


98 
__u32
 
	mç_°©us
;

99 
__u32
 
	mç_Àn
;

100 
__u32
 
	mç_¢≠Àn
;

101 
__u16
 
	mç_mac
;

102 
__u16
 
	mç_√t
;

103 
__u32
 
	mç_£c
;

104 
__u32
 
	mç_n£c
;

105 
__u16
 
	mç_vœn_tci
;

108 
	#TPACKET2_HDRLEN
 (
	`TPACKET_ALIGN
((
çackë2_hdr
)Ë+ (
sockaddr_Œ
))

	)

110 
	eçackë_vîsi⁄s


112 
	mTPACKET_V1
,

113 
	mTPACKET_V2
,

129 
	sçackë_ªq


131 
	mç_block_size
;

132 
	mç_block_ƒ
;

133 
	mç_‰ame_size
;

134 
	mç_‰ame_ƒ
;

137 
	s∑ckë_mªq


139 
	mmr_ifödex
;

140 
	mmr_ty≥
;

141 
	mmr_Æí
;

142 
	mmr_addªss
[8];

145 
	#PACKET_MR_MULTICAST
 0

	)

146 
	#PACKET_MR_PROMISC
 1

	)

147 
	#PACKET_MR_ALLMULTI
 2

	)

148 
	#PACKET_MR_UNICAST
 3

	)

	@/usr/include/linux/pci_regs.h

22 #i‚de‡
LINUX_PCI_REGS_H


23 
	#LINUX_PCI_REGS_H


	)

29 
	#PCI_VENDOR_ID
 0x00

	)

30 
	#PCI_DEVICE_ID
 0x02

	)

31 
	#PCI_COMMAND
 0x04

	)

32 
	#PCI_COMMAND_IO
 0x1

	)

33 
	#PCI_COMMAND_MEMORY
 0x2

	)

34 
	#PCI_COMMAND_MASTER
 0x4

	)

35 
	#PCI_COMMAND_SPECIAL
 0x8

	)

36 
	#PCI_COMMAND_INVALIDATE
 0x10

	)

37 
	#PCI_COMMAND_VGA_PALETTE
 0x20

	)

38 
	#PCI_COMMAND_PARITY
 0x40

	)

39 
	#PCI_COMMAND_WAIT
 0x80

	)

40 
	#PCI_COMMAND_SERR
 0x100

	)

41 
	#PCI_COMMAND_FAST_BACK
 0x200

	)

42 
	#PCI_COMMAND_INTX_DISABLE
 0x400

	)

44 
	#PCI_STATUS
 0x06

	)

45 
	#PCI_STATUS_INTERRUPT
 0x08

	)

46 
	#PCI_STATUS_CAP_LIST
 0x10

	)

47 
	#PCI_STATUS_66MHZ
 0x20

	)

48 
	#PCI_STATUS_UDF
 0x40

	)

49 
	#PCI_STATUS_FAST_BACK
 0x80

	)

50 
	#PCI_STATUS_PARITY
 0x100

	)

51 
	#PCI_STATUS_DEVSEL_MASK
 0x600

	)

52 
	#PCI_STATUS_DEVSEL_FAST
 0x000

	)

53 
	#PCI_STATUS_DEVSEL_MEDIUM
 0x200

	)

54 
	#PCI_STATUS_DEVSEL_SLOW
 0x400

	)

55 
	#PCI_STATUS_SIG_TARGET_ABORT
 0x800

	)

56 
	#PCI_STATUS_REC_TARGET_ABORT
 0x1000

	)

57 
	#PCI_STATUS_REC_MASTER_ABORT
 0x2000

	)

58 
	#PCI_STATUS_SIG_SYSTEM_ERROR
 0x4000

	)

59 
	#PCI_STATUS_DETECTED_PARITY
 0x8000

	)

61 
	#PCI_CLASS_REVISION
 0x08

	)

62 
	#PCI_REVISION_ID
 0x08

	)

63 
	#PCI_CLASS_PROG
 0x09

	)

64 
	#PCI_CLASS_DEVICE
 0x0®

	)

66 
	#PCI_CACHE_LINE_SIZE
 0x0¯

	)

67 
	#PCI_LATENCY_TIMER
 0x0d

	)

68 
	#PCI_HEADER_TYPE
 0x0ê

	)

69 
	#PCI_HEADER_TYPE_NORMAL
 0

	)

70 
	#PCI_HEADER_TYPE_BRIDGE
 1

	)

71 
	#PCI_HEADER_TYPE_CARDBUS
 2

	)

73 
	#PCI_BIST
 0x0‡

	)

74 
	#PCI_BIST_CODE_MASK
 0x0‡

	)

75 
	#PCI_BIST_START
 0x40

	)

76 
	#PCI_BIST_CAPABLE
 0x80

	)

84 
	#PCI_BASE_ADDRESS_0
 0x10

	)

85 
	#PCI_BASE_ADDRESS_1
 0x14

	)

86 
	#PCI_BASE_ADDRESS_2
 0x18

	)

87 
	#PCI_BASE_ADDRESS_3
 0x1¯

	)

88 
	#PCI_BASE_ADDRESS_4
 0x20

	)

89 
	#PCI_BASE_ADDRESS_5
 0x24

	)

90 
	#PCI_BASE_ADDRESS_SPACE
 0x01

	)

91 
	#PCI_BASE_ADDRESS_SPACE_IO
 0x01

	)

92 
	#PCI_BASE_ADDRESS_SPACE_MEMORY
 0x00

	)

93 
	#PCI_BASE_ADDRESS_MEM_TYPE_MASK
 0x06

	)

94 
	#PCI_BASE_ADDRESS_MEM_TYPE_32
 0x00

	)

95 
	#PCI_BASE_ADDRESS_MEM_TYPE_1M
 0x02

	)

96 
	#PCI_BASE_ADDRESS_MEM_TYPE_64
 0x04

	)

97 
	#PCI_BASE_ADDRESS_MEM_PREFETCH
 0x08

	)

98 
	#PCI_BASE_ADDRESS_MEM_MASK
 (~0x0fUL)

	)

99 
	#PCI_BASE_ADDRESS_IO_MASK
 (~0x03UL)

	)

103 
	#PCI_CARDBUS_CIS
 0x28

	)

104 
	#PCI_SUBSYSTEM_VENDOR_ID
 0x2c

	)

105 
	#PCI_SUBSYSTEM_ID
 0x2e

	)

106 
	#PCI_ROM_ADDRESS
 0x30

	)

107 
	#PCI_ROM_ADDRESS_ENABLE
 0x01

	)

108 
	#PCI_ROM_ADDRESS_MASK
 (~0x7ffUL)

	)

110 
	#PCI_CAPABILITY_LIST
 0x34

	)

113 
	#PCI_INTERRUPT_LINE
 0x3¯

	)

114 
	#PCI_INTERRUPT_PIN
 0x3d

	)

115 
	#PCI_MIN_GNT
 0x3ê

	)

116 
	#PCI_MAX_LAT
 0x3‡

	)

119 
	#PCI_PRIMARY_BUS
 0x18

	)

120 
	#PCI_SECONDARY_BUS
 0x19

	)

121 
	#PCI_SUBORDINATE_BUS
 0x1®

	)

122 
	#PCI_SEC_LATENCY_TIMER
 0x1b

	)

123 
	#PCI_IO_BASE
 0x1¯

	)

124 
	#PCI_IO_LIMIT
 0x1d

	)

125 
	#PCI_IO_RANGE_TYPE_MASK
 0x0fUL

	)

126 
	#PCI_IO_RANGE_TYPE_16
 0x00

	)

127 
	#PCI_IO_RANGE_TYPE_32
 0x01

	)

128 
	#PCI_IO_RANGE_MASK
 (~0x0fUL)

	)

129 
	#PCI_SEC_STATUS
 0x1ê

	)

130 
	#PCI_MEMORY_BASE
 0x20

	)

131 
	#PCI_MEMORY_LIMIT
 0x22

	)

132 
	#PCI_MEMORY_RANGE_TYPE_MASK
 0x0fUL

	)

133 
	#PCI_MEMORY_RANGE_MASK
 (~0x0fUL)

	)

134 
	#PCI_PREF_MEMORY_BASE
 0x24

	)

135 
	#PCI_PREF_MEMORY_LIMIT
 0x26

	)

136 
	#PCI_PREF_RANGE_TYPE_MASK
 0x0fUL

	)

137 
	#PCI_PREF_RANGE_TYPE_32
 0x00

	)

138 
	#PCI_PREF_RANGE_TYPE_64
 0x01

	)

139 
	#PCI_PREF_RANGE_MASK
 (~0x0fUL)

	)

140 
	#PCI_PREF_BASE_UPPER32
 0x28

	)

141 
	#PCI_PREF_LIMIT_UPPER32
 0x2c

	)

142 
	#PCI_IO_BASE_UPPER16
 0x30

	)

143 
	#PCI_IO_LIMIT_UPPER16
 0x32

	)

146 
	#PCI_ROM_ADDRESS1
 0x38

	)

148 
	#PCI_BRIDGE_CONTROL
 0x3e

	)

149 
	#PCI_BRIDGE_CTL_PARITY
 0x01

	)

150 
	#PCI_BRIDGE_CTL_SERR
 0x02

	)

151 
	#PCI_BRIDGE_CTL_ISA
 0x04

	)

152 
	#PCI_BRIDGE_CTL_VGA
 0x08

	)

153 
	#PCI_BRIDGE_CTL_MASTER_ABORT
 0x20

	)

154 
	#PCI_BRIDGE_CTL_BUS_RESET
 0x40

	)

155 
	#PCI_BRIDGE_CTL_FAST_BACK
 0x80

	)

158 
	#PCI_CB_CAPABILITY_LIST
 0x14

	)

160 
	#PCI_CB_SEC_STATUS
 0x16

	)

161 
	#PCI_CB_PRIMARY_BUS
 0x18

	)

162 
	#PCI_CB_CARD_BUS
 0x19

	)

163 
	#PCI_CB_SUBORDINATE_BUS
 0x1®

	)

164 
	#PCI_CB_LATENCY_TIMER
 0x1b

	)

165 
	#PCI_CB_MEMORY_BASE_0
 0x1c

	)

166 
	#PCI_CB_MEMORY_LIMIT_0
 0x20

	)

167 
	#PCI_CB_MEMORY_BASE_1
 0x24

	)

168 
	#PCI_CB_MEMORY_LIMIT_1
 0x28

	)

169 
	#PCI_CB_IO_BASE_0
 0x2c

	)

170 
	#PCI_CB_IO_BASE_0_HI
 0x2e

	)

171 
	#PCI_CB_IO_LIMIT_0
 0x30

	)

172 
	#PCI_CB_IO_LIMIT_0_HI
 0x32

	)

173 
	#PCI_CB_IO_BASE_1
 0x34

	)

174 
	#PCI_CB_IO_BASE_1_HI
 0x36

	)

175 
	#PCI_CB_IO_LIMIT_1
 0x38

	)

176 
	#PCI_CB_IO_LIMIT_1_HI
 0x3a

	)

177 
	#PCI_CB_IO_RANGE_MASK
 (~0x03UL)

	)

179 
	#PCI_CB_BRIDGE_CONTROL
 0x3e

	)

180 
	#PCI_CB_BRIDGE_CTL_PARITY
 0x01

	)

181 
	#PCI_CB_BRIDGE_CTL_SERR
 0x02

	)

182 
	#PCI_CB_BRIDGE_CTL_ISA
 0x04

	)

183 
	#PCI_CB_BRIDGE_CTL_VGA
 0x08

	)

184 
	#PCI_CB_BRIDGE_CTL_MASTER_ABORT
 0x20

	)

185 
	#PCI_CB_BRIDGE_CTL_CB_RESET
 0x40

	)

186 
	#PCI_CB_BRIDGE_CTL_16BIT_INT
 0x80

	)

187 
	#PCI_CB_BRIDGE_CTL_PREFETCH_MEM0
 0x100

	)

188 
	#PCI_CB_BRIDGE_CTL_PREFETCH_MEM1
 0x200

	)

189 
	#PCI_CB_BRIDGE_CTL_POST_WRITES
 0x400

	)

190 
	#PCI_CB_SUBSYSTEM_VENDOR_ID
 0x40

	)

191 
	#PCI_CB_SUBSYSTEM_ID
 0x42

	)

192 
	#PCI_CB_LEGACY_MODE_BASE
 0x44

	)

197 
	#PCI_CAP_LIST_ID
 0

	)

198 
	#PCI_CAP_ID_PM
 0x01

	)

199 
	#PCI_CAP_ID_AGP
 0x02

	)

200 
	#PCI_CAP_ID_VPD
 0x03

	)

201 
	#PCI_CAP_ID_SLOTID
 0x04

	)

202 
	#PCI_CAP_ID_MSI
 0x05

	)

203 
	#PCI_CAP_ID_CHSWP
 0x06

	)

204 
	#PCI_CAP_ID_PCIX
 0x07

	)

205 
	#PCI_CAP_ID_HT
 0x08

	)

206 
	#PCI_CAP_ID_VNDR
 0x09

	)

207 
	#PCI_CAP_ID_DBG
 0x0A

	)

208 
	#PCI_CAP_ID_CCRC
 0x0B

	)

209 
	#PCI_CAP_ID_SHPC
 0x0C

	)

210 
	#PCI_CAP_ID_SSVID
 0x0D

	)

211 
	#PCI_CAP_ID_AGP3
 0x0E

	)

212 
	#PCI_CAP_ID_EXP
 0x10

	)

213 
	#PCI_CAP_ID_MSIX
 0x11

	)

214 
	#PCI_CAP_ID_AF
 0x13

	)

215 
	#PCI_CAP_LIST_NEXT
 1

	)

216 
	#PCI_CAP_FLAGS
 2

	)

217 
	#PCI_CAP_SIZEOF
 4

	)

221 
	#PCI_PM_PMC
 2

	)

222 
	#PCI_PM_CAP_VER_MASK
 0x0007

	)

223 
	#PCI_PM_CAP_PME_CLOCK
 0x0008

	)

224 
	#PCI_PM_CAP_RESERVED
 0x0010

	)

225 
	#PCI_PM_CAP_DSI
 0x0020

	)

226 
	#PCI_PM_CAP_AUX_POWER
 0x01C0

	)

227 
	#PCI_PM_CAP_D1
 0x0200

	)

228 
	#PCI_PM_CAP_D2
 0x0400

	)

229 
	#PCI_PM_CAP_PME
 0x0800

	)

230 
	#PCI_PM_CAP_PME_MASK
 0xF800

	)

231 
	#PCI_PM_CAP_PME_D0
 0x0800

	)

232 
	#PCI_PM_CAP_PME_D1
 0x1000

	)

233 
	#PCI_PM_CAP_PME_D2
 0x2000

	)

234 
	#PCI_PM_CAP_PME_D3
 0x4000

	)

235 
	#PCI_PM_CAP_PME_D3cﬁd
 0x8000

	)

236 
	#PCI_PM_CAP_PME_SHIFT
 11

	)

237 
	#PCI_PM_CTRL
 4

	)

238 
	#PCI_PM_CTRL_STATE_MASK
 0x0003

	)

239 
	#PCI_PM_CTRL_NO_SOFT_RESET
 0x0008

	)

240 
	#PCI_PM_CTRL_PME_ENABLE
 0x0100

	)

241 
	#PCI_PM_CTRL_DATA_SEL_MASK
 0x1e00

	)

242 
	#PCI_PM_CTRL_DATA_SCALE_MASK
 0x6000

	)

243 
	#PCI_PM_CTRL_PME_STATUS
 0x8000

	)

244 
	#PCI_PM_PPB_EXTENSIONS
 6

	)

245 
	#PCI_PM_PPB_B2_B3
 0x40

	)

246 
	#PCI_PM_BPCC_ENABLE
 0x80

	)

247 
	#PCI_PM_DATA_REGISTER
 7

	)

248 
	#PCI_PM_SIZEOF
 8

	)

252 
	#PCI_AGP_VERSION
 2

	)

253 
	#PCI_AGP_RFU
 3

	)

254 
	#PCI_AGP_STATUS
 4

	)

255 
	#PCI_AGP_STATUS_RQ_MASK
 0xff000000

	)

256 
	#PCI_AGP_STATUS_SBA
 0x0200

	)

257 
	#PCI_AGP_STATUS_64BIT
 0x0020

	)

258 
	#PCI_AGP_STATUS_FW
 0x0010

	)

259 
	#PCI_AGP_STATUS_RATE4
 0x0004

	)

260 
	#PCI_AGP_STATUS_RATE2
 0x0002

	)

261 
	#PCI_AGP_STATUS_RATE1
 0x0001

	)

262 
	#PCI_AGP_COMMAND
 8

	)

263 
	#PCI_AGP_COMMAND_RQ_MASK
 0xff000000

	)

264 
	#PCI_AGP_COMMAND_SBA
 0x0200

	)

265 
	#PCI_AGP_COMMAND_AGP
 0x0100

	)

266 
	#PCI_AGP_COMMAND_64BIT
 0x0020

	)

267 
	#PCI_AGP_COMMAND_FW
 0x0010

	)

268 
	#PCI_AGP_COMMAND_RATE4
 0x0004

	)

269 
	#PCI_AGP_COMMAND_RATE2
 0x0002

	)

270 
	#PCI_AGP_COMMAND_RATE1
 0x0001

	)

271 
	#PCI_AGP_SIZEOF
 12

	)

275 
	#PCI_VPD_ADDR
 2

	)

276 
	#PCI_VPD_ADDR_MASK
 0x7ff‡

	)

277 
	#PCI_VPD_ADDR_F
 0x8000

	)

278 
	#PCI_VPD_DATA
 4

	)

282 
	#PCI_SID_ESR
 2

	)

283 
	#PCI_SID_ESR_NSLOTS
 0x1‡

	)

284 
	#PCI_SID_ESR_FIC
 0x20

	)

285 
	#PCI_SID_CHASSIS_NR
 3

	)

289 
	#PCI_MSI_FLAGS
 2

	)

290 
	#PCI_MSI_FLAGS_64BIT
 0x80

	)

291 
	#PCI_MSI_FLAGS_QSIZE
 0x70

	)

292 
	#PCI_MSI_FLAGS_QMASK
 0x0ê

	)

293 
	#PCI_MSI_FLAGS_ENABLE
 0x01

	)

294 
	#PCI_MSI_FLAGS_MASKBIT
 0x100

	)

295 
	#PCI_MSI_RFU
 3

	)

296 
	#PCI_MSI_ADDRESS_LO
 4

	)

297 
	#PCI_MSI_ADDRESS_HI
 8

	)

298 
	#PCI_MSI_DATA_32
 8

	)

299 
	#PCI_MSI_MASK_32
 12

	)

300 
	#PCI_MSI_DATA_64
 12

	)

301 
	#PCI_MSI_MASK_64
 16

	)

304 
	#PCI_MSIX_FLAGS
 2

	)

305 
	#PCI_MSIX_FLAGS_QSIZE
 0x7FF

	)

306 
	#PCI_MSIX_FLAGS_ENABLE
 (1 << 15)

	)

307 
	#PCI_MSIX_FLAGS_MASKALL
 (1 << 14)

	)

308 
	#PCI_MSIX_FLAGS_BIRMASK
 (7 << 0)

	)

312 
	#PCI_CHSWP_CSR
 2

	)

313 
	#PCI_CHSWP_DHA
 0x01

	)

314 
	#PCI_CHSWP_EIM
 0x02

	)

315 
	#PCI_CHSWP_PIE
 0x04

	)

316 
	#PCI_CHSWP_LOO
 0x08

	)

317 
	#PCI_CHSWP_PI
 0x30

	)

318 
	#PCI_CHSWP_EXT
 0x40

	)

319 
	#PCI_CHSWP_INS
 0x80

	)

323 
	#PCI_AF_LENGTH
 2

	)

324 
	#PCI_AF_CAP
 3

	)

325 
	#PCI_AF_CAP_TP
 0x01

	)

326 
	#PCI_AF_CAP_FLR
 0x02

	)

327 
	#PCI_AF_CTRL
 4

	)

328 
	#PCI_AF_CTRL_FLR
 0x01

	)

329 
	#PCI_AF_STATUS
 5

	)

330 
	#PCI_AF_STATUS_TP
 0x01

	)

334 
	#PCI_X_CMD
 2

	)

335 
	#PCI_X_CMD_DPERR_E
 0x0001

	)

336 
	#PCI_X_CMD_ERO
 0x0002

	)

337 
	#PCI_X_CMD_READ_512
 0x0000

	)

338 
	#PCI_X_CMD_READ_1K
 0x0004

	)

339 
	#PCI_X_CMD_READ_2K
 0x0008

	)

340 
	#PCI_X_CMD_READ_4K
 0x000¯

	)

341 
	#PCI_X_CMD_MAX_READ
 0x000¯

	)

343 
	#PCI_X_CMD_SPLIT_1
 0x0000

	)

344 
	#PCI_X_CMD_SPLIT_2
 0x0010

	)

345 
	#PCI_X_CMD_SPLIT_3
 0x0020

	)

346 
	#PCI_X_CMD_SPLIT_4
 0x0030

	)

347 
	#PCI_X_CMD_SPLIT_8
 0x0040

	)

348 
	#PCI_X_CMD_SPLIT_12
 0x0050

	)

349 
	#PCI_X_CMD_SPLIT_16
 0x0060

	)

350 
	#PCI_X_CMD_SPLIT_32
 0x0070

	)

351 
	#PCI_X_CMD_MAX_SPLIT
 0x0070

	)

352 
	#PCI_X_CMD_VERSION
(
x
Ë(((xË>> 12Ë& 3Ë

	)

353 
	#PCI_X_STATUS
 4

	)

354 
	#PCI_X_STATUS_DEVFN
 0x000000f‡

	)

355 
	#PCI_X_STATUS_BUS
 0x0000ff00

	)

356 
	#PCI_X_STATUS_64BIT
 0x00010000

	)

357 
	#PCI_X_STATUS_133MHZ
 0x00020000

	)

358 
	#PCI_X_STATUS_SPL_DISC
 0x00040000

	)

359 
	#PCI_X_STATUS_UNX_SPL
 0x00080000

	)

360 
	#PCI_X_STATUS_COMPLEX
 0x00100000

	)

361 
	#PCI_X_STATUS_MAX_READ
 0x00600000

	)

362 
	#PCI_X_STATUS_MAX_SPLIT
 0x03800000

	)

363 
	#PCI_X_STATUS_MAX_CUM
 0x1c000000

	)

364 
	#PCI_X_STATUS_SPL_ERR
 0x20000000

	)

365 
	#PCI_X_STATUS_266MHZ
 0x40000000

	)

366 
	#PCI_X_STATUS_533MHZ
 0x80000000

	)

370 
	#PCI_EXP_FLAGS
 2

	)

371 
	#PCI_EXP_FLAGS_VERS
 0x000‡

	)

372 
	#PCI_EXP_FLAGS_TYPE
 0x00f0

	)

373 
	#PCI_EXP_TYPE_ENDPOINT
 0x0

	)

374 
	#PCI_EXP_TYPE_LEG_END
 0x1

	)

375 
	#PCI_EXP_TYPE_ROOT_PORT
 0x4

	)

376 
	#PCI_EXP_TYPE_UPSTREAM
 0x5

	)

377 
	#PCI_EXP_TYPE_DOWNSTREAM
 0x6

	)

378 
	#PCI_EXP_TYPE_PCI_BRIDGE
 0x7

	)

379 
	#PCI_EXP_TYPE_RC_END
 0x9

	)

380 
	#PCI_EXP_TYPE_RC_EC
 0x10

	)

381 
	#PCI_EXP_FLAGS_SLOT
 0x0100

	)

382 
	#PCI_EXP_FLAGS_IRQ
 0x3e00

	)

383 
	#PCI_EXP_DEVCAP
 4

	)

384 
	#PCI_EXP_DEVCAP_PAYLOAD
 0x07

	)

385 
	#PCI_EXP_DEVCAP_PHANTOM
 0x18

	)

386 
	#PCI_EXP_DEVCAP_EXT_TAG
 0x20

	)

387 
	#PCI_EXP_DEVCAP_L0S
 0x1c0

	)

388 
	#PCI_EXP_DEVCAP_L1
 0xe00

	)

389 
	#PCI_EXP_DEVCAP_ATN_BUT
 0x1000

	)

390 
	#PCI_EXP_DEVCAP_ATN_IND
 0x2000

	)

391 
	#PCI_EXP_DEVCAP_PWR_IND
 0x4000

	)

392 
	#PCI_EXP_DEVCAP_RBER
 0x8000

	)

393 
	#PCI_EXP_DEVCAP_PWR_VAL
 0x3fc0000

	)

394 
	#PCI_EXP_DEVCAP_PWR_SCL
 0xc000000

	)

395 
	#PCI_EXP_DEVCAP_FLR
 0x10000000

	)

396 
	#PCI_EXP_DEVCTL
 8

	)

397 
	#PCI_EXP_DEVCTL_CERE
 0x0001

	)

398 
	#PCI_EXP_DEVCTL_NFERE
 0x0002

	)

399 
	#PCI_EXP_DEVCTL_FERE
 0x0004

	)

400 
	#PCI_EXP_DEVCTL_URRE
 0x0008

	)

401 
	#PCI_EXP_DEVCTL_RELAX_EN
 0x0010

	)

402 
	#PCI_EXP_DEVCTL_PAYLOAD
 0x00e0

	)

403 
	#PCI_EXP_DEVCTL_EXT_TAG
 0x0100

	)

404 
	#PCI_EXP_DEVCTL_PHANTOM
 0x0200

	)

405 
	#PCI_EXP_DEVCTL_AUX_PME
 0x0400

	)

406 
	#PCI_EXP_DEVCTL_NOSNOOP_EN
 0x0800

	)

407 
	#PCI_EXP_DEVCTL_READRQ
 0x7000

	)

408 
	#PCI_EXP_DEVCTL_BCR_FLR
 0x8000

	)

409 
	#PCI_EXP_DEVSTA
 10

	)

410 
	#PCI_EXP_DEVSTA_CED
 0x01

	)

411 
	#PCI_EXP_DEVSTA_NFED
 0x02

	)

412 
	#PCI_EXP_DEVSTA_FED
 0x04

	)

413 
	#PCI_EXP_DEVSTA_URD
 0x08

	)

414 
	#PCI_EXP_DEVSTA_AUXPD
 0x10

	)

415 
	#PCI_EXP_DEVSTA_TRPND
 0x20

	)

416 
	#PCI_EXP_LNKCAP
 12

	)

417 
	#PCI_EXP_LNKCAP_SLS
 0x0000000‡

	)

418 
	#PCI_EXP_LNKCAP_MLW
 0x000003f0

	)

419 
	#PCI_EXP_LNKCAP_ASPMS
 0x00000c00

	)

420 
	#PCI_EXP_LNKCAP_L0SEL
 0x00007000

	)

421 
	#PCI_EXP_LNKCAP_L1EL
 0x00038000

	)

422 
	#PCI_EXP_LNKCAP_CLKPM
 0x00040000

	)

423 
	#PCI_EXP_LNKCAP_SDERC
 0x00080000

	)

424 
	#PCI_EXP_LNKCAP_DLLLARC
 0x00100000

	)

425 
	#PCI_EXP_LNKCAP_LBNC
 0x00200000

	)

426 
	#PCI_EXP_LNKCAP_PN
 0xff000000

	)

427 
	#PCI_EXP_LNKCTL
 16

	)

428 
	#PCI_EXP_LNKCTL_ASPMC
 0x0003

	)

429 
	#PCI_EXP_LNKCTL_RCB
 0x0008

	)

430 
	#PCI_EXP_LNKCTL_LD
 0x0010

	)

431 
	#PCI_EXP_LNKCTL_RL
 0x0020

	)

432 
	#PCI_EXP_LNKCTL_CCC
 0x0040

	)

433 
	#PCI_EXP_LNKCTL_ES
 0x0080

	)

434 
	#PCI_EXP_LNKCTL_CLKREQ_EN
 0x100

	)

435 
	#PCI_EXP_LNKCTL_HAWD
 0x0200

	)

436 
	#PCI_EXP_LNKCTL_LBMIE
 0x0400

	)

437 
	#PCI_EXP_LNKCTL_LABIE
 0x0800

	)

438 
	#PCI_EXP_LNKSTA
 18

	)

439 
	#PCI_EXP_LNKSTA_CLS
 0x000‡

	)

440 
	#PCI_EXP_LNKSTA_NLW
 0x03f0

	)

441 
	#PCI_EXP_LNKSTA_LT
 0x0800

	)

442 
	#PCI_EXP_LNKSTA_SLC
 0x1000

	)

443 
	#PCI_EXP_LNKSTA_DLLLA
 0x2000

	)

444 
	#PCI_EXP_LNKSTA_LBMS
 0x4000

	)

445 
	#PCI_EXP_LNKSTA_LABS
 0x8000

	)

446 
	#PCI_EXP_SLTCAP
 20

	)

447 
	#PCI_EXP_SLTCAP_ABP
 0x00000001

	)

448 
	#PCI_EXP_SLTCAP_PCP
 0x00000002

	)

449 
	#PCI_EXP_SLTCAP_MRLSP
 0x00000004

	)

450 
	#PCI_EXP_SLTCAP_AIP
 0x00000008

	)

451 
	#PCI_EXP_SLTCAP_PIP
 0x00000010

	)

452 
	#PCI_EXP_SLTCAP_HPS
 0x00000020

	)

453 
	#PCI_EXP_SLTCAP_HPC
 0x00000040

	)

454 
	#PCI_EXP_SLTCAP_SPLV
 0x00007f80

	)

455 
	#PCI_EXP_SLTCAP_SPLS
 0x00018000

	)

456 
	#PCI_EXP_SLTCAP_EIP
 0x00020000

	)

457 
	#PCI_EXP_SLTCAP_NCCS
 0x00040000

	)

458 
	#PCI_EXP_SLTCAP_PSN
 0xfff80000

	)

459 
	#PCI_EXP_SLTCTL
 24

	)

460 
	#PCI_EXP_SLTCTL_ABPE
 0x0001

	)

461 
	#PCI_EXP_SLTCTL_PFDE
 0x0002

	)

462 
	#PCI_EXP_SLTCTL_MRLSCE
 0x0004

	)

463 
	#PCI_EXP_SLTCTL_PDCE
 0x0008

	)

464 
	#PCI_EXP_SLTCTL_CCIE
 0x0010

	)

465 
	#PCI_EXP_SLTCTL_HPIE
 0x0020

	)

466 
	#PCI_EXP_SLTCTL_AIC
 0x00c0

	)

467 
	#PCI_EXP_SLTCTL_PIC
 0x0300

	)

468 
	#PCI_EXP_SLTCTL_PCC
 0x0400

	)

469 
	#PCI_EXP_SLTCTL_EIC
 0x0800

	)

470 
	#PCI_EXP_SLTCTL_DLLSCE
 0x1000

	)

471 
	#PCI_EXP_SLTSTA
 26

	)

472 
	#PCI_EXP_SLTSTA_ABP
 0x0001

	)

473 
	#PCI_EXP_SLTSTA_PFD
 0x0002

	)

474 
	#PCI_EXP_SLTSTA_MRLSC
 0x0004

	)

475 
	#PCI_EXP_SLTSTA_PDC
 0x0008

	)

476 
	#PCI_EXP_SLTSTA_CC
 0x0010

	)

477 
	#PCI_EXP_SLTSTA_MRLSS
 0x0020

	)

478 
	#PCI_EXP_SLTSTA_PDS
 0x0040

	)

479 
	#PCI_EXP_SLTSTA_EIS
 0x0080

	)

480 
	#PCI_EXP_SLTSTA_DLLSC
 0x0100

	)

481 
	#PCI_EXP_RTCTL
 28

	)

482 
	#PCI_EXP_RTCTL_SECEE
 0x01

	)

483 
	#PCI_EXP_RTCTL_SENFEE
 0x02

	)

484 
	#PCI_EXP_RTCTL_SEFEE
 0x04

	)

485 
	#PCI_EXP_RTCTL_PMEIE
 0x08

	)

486 
	#PCI_EXP_RTCTL_CRSSVE
 0x10

	)

487 
	#PCI_EXP_RTCAP
 30

	)

488 
	#PCI_EXP_RTSTA
 32

	)

489 
	#PCI_EXP_DEVCAP2
 36

	)

490 
	#PCI_EXP_DEVCAP2_ARI
 0x20

	)

491 
	#PCI_EXP_DEVCTL2
 40

	)

492 
	#PCI_EXP_DEVCTL2_ARI
 0x20

	)

493 
	#PCI_EXP_LNKCTL2
 48

	)

494 
	#PCI_EXP_SLTCTL2
 56

	)

497 
	#PCI_EXT_CAP_ID
(
hódî
Ë(hódî & 0x0000ffff)

	)

498 
	#PCI_EXT_CAP_VER
(
hódî
Ë((hódî >> 16Ë& 0xf)

	)

499 
	#PCI_EXT_CAP_NEXT
(
hódî
Ë((hódî >> 20Ë& 0xffc)

	)

501 
	#PCI_EXT_CAP_ID_ERR
 1

	)

502 
	#PCI_EXT_CAP_ID_VC
 2

	)

503 
	#PCI_EXT_CAP_ID_DSN
 3

	)

504 
	#PCI_EXT_CAP_ID_PWR
 4

	)

505 
	#PCI_EXT_CAP_ID_ARI
 14

	)

506 
	#PCI_EXT_CAP_ID_ATS
 15

	)

507 
	#PCI_EXT_CAP_ID_SRIOV
 16

	)

510 
	#PCI_ERR_UNCOR_STATUS
 4

	)

511 
	#PCI_ERR_UNC_TRAIN
 0x00000001

	)

512 
	#PCI_ERR_UNC_DLP
 0x00000010

	)

513 
	#PCI_ERR_UNC_POISON_TLP
 0x00001000

	)

514 
	#PCI_ERR_UNC_FCP
 0x00002000

	)

515 
	#PCI_ERR_UNC_COMP_TIME
 0x00004000

	)

516 
	#PCI_ERR_UNC_COMP_ABORT
 0x00008000

	)

517 
	#PCI_ERR_UNC_UNX_COMP
 0x00010000

	)

518 
	#PCI_ERR_UNC_RX_OVER
 0x00020000

	)

519 
	#PCI_ERR_UNC_MALF_TLP
 0x00040000

	)

520 
	#PCI_ERR_UNC_ECRC
 0x00080000

	)

521 
	#PCI_ERR_UNC_UNSUP
 0x00100000

	)

522 
	#PCI_ERR_UNCOR_MASK
 8

	)

524 
	#PCI_ERR_UNCOR_SEVER
 12

	)

526 
	#PCI_ERR_COR_STATUS
 16

	)

527 
	#PCI_ERR_COR_RCVR
 0x00000001

	)

528 
	#PCI_ERR_COR_BAD_TLP
 0x00000040

	)

529 
	#PCI_ERR_COR_BAD_DLLP
 0x00000080

	)

530 
	#PCI_ERR_COR_REP_ROLL
 0x00000100

	)

531 
	#PCI_ERR_COR_REP_TIMER
 0x00001000

	)

532 
	#PCI_ERR_COR_MASK
 20

	)

534 
	#PCI_ERR_CAP
 24

	)

535 
	#PCI_ERR_CAP_FEP
(
x
Ë((xË& 31Ë

	)

536 
	#PCI_ERR_CAP_ECRC_GENC
 0x00000020

	)

537 
	#PCI_ERR_CAP_ECRC_GENE
 0x00000040

	)

538 
	#PCI_ERR_CAP_ECRC_CHKC
 0x00000080

	)

539 
	#PCI_ERR_CAP_ECRC_CHKE
 0x00000100

	)

540 
	#PCI_ERR_HEADER_LOG
 28

	)

541 
	#PCI_ERR_ROOT_COMMAND
 44

	)

543 
	#PCI_ERR_ROOT_CMD_COR_EN
 0x00000001

	)

545 
	#PCI_ERR_ROOT_CMD_NONFATAL_EN
 0x00000002

	)

547 
	#PCI_ERR_ROOT_CMD_FATAL_EN
 0x00000004

	)

548 
	#PCI_ERR_ROOT_STATUS
 48

	)

549 
	#PCI_ERR_ROOT_COR_RCV
 0x00000001

	)

551 
	#PCI_ERR_ROOT_MULTI_COR_RCV
 0x00000002

	)

553 
	#PCI_ERR_ROOT_UNCOR_RCV
 0x00000004

	)

555 
	#PCI_ERR_ROOT_MULTI_UNCOR_RCV
 0x00000008

	)

556 
	#PCI_ERR_ROOT_FIRST_FATAL
 0x00000010

	)

557 
	#PCI_ERR_ROOT_NONFATAL_RCV
 0x00000020

	)

558 
	#PCI_ERR_ROOT_FATAL_RCV
 0x00000040

	)

559 
	#PCI_ERR_ROOT_COR_SRC
 52

	)

560 
	#PCI_ERR_ROOT_SRC
 54

	)

563 
	#PCI_VC_PORT_REG1
 4

	)

564 
	#PCI_VC_PORT_REG2
 8

	)

565 
	#PCI_VC_PORT_CTRL
 12

	)

566 
	#PCI_VC_PORT_STATUS
 14

	)

567 
	#PCI_VC_RES_CAP
 16

	)

568 
	#PCI_VC_RES_CTRL
 20

	)

569 
	#PCI_VC_RES_STATUS
 26

	)

572 
	#PCI_PWR_DSR
 4

	)

573 
	#PCI_PWR_DATA
 8

	)

574 
	#PCI_PWR_DATA_BASE
(
x
Ë((xË& 0xffË

	)

575 
	#PCI_PWR_DATA_SCALE
(
x
Ë(((xË>> 8Ë& 3Ë

	)

576 
	#PCI_PWR_DATA_PM_SUB
(
x
Ë(((xË>> 10Ë& 7Ë

	)

577 
	#PCI_PWR_DATA_PM_STATE
(
x
Ë(((xË>> 13Ë& 3Ë

	)

578 
	#PCI_PWR_DATA_TYPE
(
x
Ë(((xË>> 15Ë& 7Ë

	)

579 
	#PCI_PWR_DATA_RAIL
(
x
Ë(((xË>> 18Ë& 7Ë

	)

580 
	#PCI_PWR_CAP
 12

	)

581 
	#PCI_PWR_CAP_BUDGET
(
x
Ë((xË& 1Ë

	)

591 
	#HT_3BIT_CAP_MASK
 0xE0

	)

592 
	#HT_CAPTYPE_SLAVE
 0x00

	)

593 
	#HT_CAPTYPE_HOST
 0x20

	)

595 
	#HT_5BIT_CAP_MASK
 0xF8

	)

596 
	#HT_CAPTYPE_IRQ
 0x80

	)

597 
	#HT_CAPTYPE_REMAPPING_40
 0xA0

	)

598 
	#HT_CAPTYPE_REMAPPING_64
 0xA2

	)

599 
	#HT_CAPTYPE_UNITID_CLUMP
 0x90

	)

600 
	#HT_CAPTYPE_EXTCONF
 0x98

	)

601 
	#HT_CAPTYPE_MSI_MAPPING
 0xA8

	)

602 
	#HT_MSI_FLAGS
 0x02

	)

603 
	#HT_MSI_FLAGS_ENABLE
 0x1

	)

604 
	#HT_MSI_FLAGS_FIXED
 0x2

	)

605 
	#HT_MSI_FIXED_ADDR
 0x00000000FEE00000ULL

	)

606 
	#HT_MSI_ADDR_LO
 0x04

	)

607 
	#HT_MSI_ADDR_LO_MASK
 0xFFF00000

	)

608 
	#HT_MSI_ADDR_HI
 0x08

	)

609 
	#HT_CAPTYPE_DIRECT_ROUTE
 0xB0

	)

610 
	#HT_CAPTYPE_VCSET
 0xB8

	)

611 
	#HT_CAPTYPE_ERROR_RETRY
 0xC0

	)

612 
	#HT_CAPTYPE_GEN3
 0xD0

	)

613 
	#HT_CAPTYPE_PM
 0xE0

	)

616 
	#PCI_ARI_CAP
 0x04

	)

617 
	#PCI_ARI_CAP_MFVC
 0x0001

	)

618 
	#PCI_ARI_CAP_ACS
 0x0002

	)

619 
	#PCI_ARI_CAP_NFN
(
x
Ë(((xË>> 8Ë& 0xffË

	)

620 
	#PCI_ARI_CTRL
 0x06

	)

621 
	#PCI_ARI_CTRL_MFVC
 0x0001

	)

622 
	#PCI_ARI_CTRL_ACS
 0x0002

	)

623 
	#PCI_ARI_CTRL_FG
(
x
Ë(((xË>> 4Ë& 7Ë

	)

626 
	#PCI_ATS_CAP
 0x04

	)

627 
	#PCI_ATS_CAP_QDEP
(
x
Ë((xË& 0x1fË

	)

628 
	#PCI_ATS_MAX_QDEP
 32

	)

629 
	#PCI_ATS_CTRL
 0x06

	)

630 
	#PCI_ATS_CTRL_ENABLE
 0x8000

	)

631 
	#PCI_ATS_CTRL_STU
(
x
Ë((xË& 0x1fË

	)

632 
	#PCI_ATS_MIN_STU
 12

	)

635 
	#PCI_SRIOV_CAP
 0x04

	)

636 
	#PCI_SRIOV_CAP_VFM
 0x01

	)

637 
	#PCI_SRIOV_CAP_INTR
(
x
Ë((xË>> 21Ë

	)

638 
	#PCI_SRIOV_CTRL
 0x08

	)

639 
	#PCI_SRIOV_CTRL_VFE
 0x01

	)

640 
	#PCI_SRIOV_CTRL_VFM
 0x02

	)

641 
	#PCI_SRIOV_CTRL_INTR
 0x04

	)

642 
	#PCI_SRIOV_CTRL_MSE
 0x08

	)

643 
	#PCI_SRIOV_CTRL_ARI
 0x10

	)

644 
	#PCI_SRIOV_STATUS
 0x0®

	)

645 
	#PCI_SRIOV_STATUS_VFM
 0x01

	)

646 
	#PCI_SRIOV_INITIAL_VF
 0x0¯

	)

647 
	#PCI_SRIOV_TOTAL_VF
 0x0ê

	)

648 
	#PCI_SRIOV_NUM_VF
 0x10

	)

649 
	#PCI_SRIOV_FUNC_LINK
 0x12

	)

650 
	#PCI_SRIOV_VF_OFFSET
 0x14

	)

651 
	#PCI_SRIOV_VF_STRIDE
 0x16

	)

652 
	#PCI_SRIOV_VF_DID
 0x1®

	)

653 
	#PCI_SRIOV_SUP_PGSIZE
 0x1¯

	)

654 
	#PCI_SRIOV_SYS_PGSIZE
 0x20

	)

655 
	#PCI_SRIOV_BAR
 0x24

	)

656 
	#PCI_SRIOV_NUM_BARS
 6

	)

657 
	#PCI_SRIOV_VFM
 0x3¯

	)

658 
	#PCI_SRIOV_VFM_BIR
(
x
Ë((xË& 7Ë

	)

659 
	#PCI_SRIOV_VFM_OFFSET
(
x
Ë((xË& ~7Ë

	)

660 
	#PCI_SRIOV_VFM_UA
 0x0

	)

661 
	#PCI_SRIOV_VFM_MI
 0x1

	)

662 
	#PCI_SRIOV_VFM_MO
 0x2

	)

663 
	#PCI_SRIOV_VFM_AV
 0x3

	)

	@/usr/include/linux/socket.h

1 #i‚de‡
_LINUX_SOCKET_H


2 
	#_LINUX_SOCKET_H


	)

7 
	#_K_SS_MAXSIZE
 128

	)

8 
	#_K_SS_ALIGNSIZE
 (
	`__Æignof__
 (
sockaddr
 *))

	)

11 
	s__kî√l_sockaddr_°‹age
 {

12 
	mss_Ámûy
;

14 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

17 } 
__©åibuã__
 ((
Æig√d
(
_K_SS_ALIGNSIZE
)));

	@/usr/include/linux/types.h

1 #i‚de‡
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty≥s.h
>

6 #i‚de‡
__ASSEMBLY__


8 
	~<löux/posix_ty≥s.h
>

16 #ifde‡
__CHECKER__


17 
	#__bôwi£__
 
	`__©åibuã__
((
bôwi£
))

	)

19 
	#__bôwi£__


	)

21 #ifde‡
__CHECK_ENDIAN__


22 
	#__bôwi£
 
__bôwi£__


	)

24 
	#__bôwi£


	)

27 
__u16
 
	t__bôwi£
 
	t__À16
;

28 
__u16
 
	t__bôwi£
 
	t__be16
;

29 
__u32
 
	t__bôwi£
 
	t__À32
;

30 
__u32
 
	t__bôwi£
 
	t__be32
;

31 
__u64
 
	t__bôwi£
 
	t__À64
;

32 
__u64
 
	t__bôwi£
 
	t__be64
;

34 
__u16
 
	t__bôwi£
 
	t__sum16
;

35 
__u32
 
	t__bôwi£
 
	t__wsum
;

	@/usr/include/sys/ttydefaults.h

40 #i‚de‡
_SYS_TTYDEFAULTS_H_


41 
	#_SYS_TTYDEFAULTS_H_


	)

46 
	#TTYDEF_IFLAG
 (
BRKINT
 | 
ISTRIP
 | 
ICRNL
 | 
IMAXBEL
 | 
IXON
 | 
IXANY
)

	)

47 
	#TTYDEF_OFLAG
 (
OPOST
 | 
ONLCR
 | 
XTABS
)

	)

48 
	#TTYDEF_LFLAG
 (
ECHO
 | 
ICANON
 | 
ISIG
 | 
IEXTEN
 | 
ECHOE
|
ECHOKE
|
ECHOCTL
)

	)

49 
	#TTYDEF_CFLAG
 (
CREAD
 | 
CS7
 | 
PARENB
 | 
HUPCL
)

	)

50 
	#TTYDEF_SPEED
 (
B9600
)

	)

55 
	#CTRL
(
x
Ë(x&037)

	)

56 
	#CEOF
 
	`CTRL
('d')

	)

57 #ifde‡
_POSIX_VDISABLE


58 
	#CEOL
 
_POSIX_VDISABLE


	)

60 
	#CEOL
 '\0'

	)

62 
	#CERASE
 0177

	)

63 
	#CINTR
 
	`CTRL
('c')

	)

64 #ifde‡
_POSIX_VDISABLE


65 
	#CSTATUS
 
_POSIX_VDISABLE


	)

67 
	#CSTATUS
 '\0'

	)

69 
	#CKILL
 
	`CTRL
('u')

	)

70 
	#CMIN
 1

	)

71 
	#CQUIT
 034

	)

72 
	#CSUSP
 
	`CTRL
('z')

	)

73 
	#CTIME
 0

	)

74 
	#CDSUSP
 
	`CTRL
('y')

	)

75 
	#CSTART
 
	`CTRL
('q')

	)

76 
	#CSTOP
 
	`CTRL
('s')

	)

77 
	#CLNEXT
 
	`CTRL
('v')

	)

78 
	#CDISCARD
 
	`CTRL
('o')

	)

79 
	#CWERASE
 
	`CTRL
('w')

	)

80 
	#CREPRINT
 
	`CTRL
('r')

	)

81 
	#CEOT
 
CEOF


	)

83 
	#CBRK
 
CEOL


	)

84 
	#CRPRNT
 
CREPRINT


	)

85 
	#CFLUSH
 
CDISCARD


	)

93 #ifde‡
TTYDEFCHARS


94 
cc_t
 
	gâydefch¨s
[
NCCS
] = {

95 
CEOF
, 
CEOL
, CEOL, 
CERASE
, 
CWERASE
, 
CKILL
, 
CREPRINT
,

96 
_POSIX_VDISABLE
, 
CINTR
, 
CQUIT
, 
CSUSP
, 
CDSUSP
, 
CSTART
, 
CSTOP
, 
CLNEXT
,

97 
CDISCARD
, 
CMIN
, 
CTIME
, 
CSTATUS
, 
_POSIX_VDISABLE


99 #unde‡
TTYDEFCHARS


	@/usr/include/sys/types.h

24 #i‚def 
_SYS_TYPES_H


25 
	#_SYS_TYPES_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


31 
	~<bôs/ty≥s.h
>

33 #ifdef 
__USE_BSD


34 #i‚de‡
__u_ch¨_deföed


35 
__u_ch¨
 
	tu_ch¨
;

36 
__u_sh‹t
 
	tu_sh‹t
;

37 
__u_öt
 
	tu_öt
;

38 
__u_l⁄g
 
	tu_l⁄g
;

39 
__quad_t
 
	tquad_t
;

40 
__u_quad_t
 
	tu_quad_t
;

41 
__fsid_t
 
	tfsid_t
;

42 
	#__u_ch¨_deföed


	)

46 
__loff_t
 
	tloff_t
;

48 #i‚de‡
__öo_t_deföed


49 #i‚de‡
__USE_FILE_OFFSET64


50 
__öo_t
 
	töo_t
;

52 
__öo64_t
 
	töo_t
;

54 
	#__öo_t_deföed


	)

56 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__öo64_t_deföed


57 
__öo64_t
 
	töo64_t
;

58 
	#__öo64_t_deföed


	)

61 #i‚de‡
__dev_t_deföed


62 
__dev_t
 
	tdev_t
;

63 
	#__dev_t_deföed


	)

66 #i‚de‡
__gid_t_deföed


67 
__gid_t
 
	tgid_t
;

68 
	#__gid_t_deföed


	)

71 #i‚de‡
__mode_t_deföed


72 
__mode_t
 
	tmode_t
;

73 
	#__mode_t_deföed


	)

76 #i‚de‡
__∆ök_t_deföed


77 
__∆ök_t
 
	t∆ök_t
;

78 
	#__∆ök_t_deföed


	)

81 #i‚de‡
__uid_t_deföed


82 
__uid_t
 
	tuid_t
;

83 
	#__uid_t_deföed


	)

86 #i‚de‡
__off_t_deföed


87 #i‚de‡
__USE_FILE_OFFSET64


88 
__off_t
 
	toff_t
;

90 
__off64_t
 
	toff_t
;

92 
	#__off_t_deföed


	)

94 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


95 
__off64_t
 
	toff64_t
;

96 
	#__off64_t_deföed


	)

99 #i‚de‡
__pid_t_deföed


100 
__pid_t
 
	tpid_t
;

101 
	#__pid_t_deföed


	)

104 #i‡(
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN
Ë&& !deföed 
__id_t_deföed


105 
__id_t
 
	tid_t
;

106 
	#__id_t_deföed


	)

109 #i‚de‡
__ssize_t_deföed


110 
__ssize_t
 
	tssize_t
;

111 
	#__ssize_t_deföed


	)

114 #ifdef 
__USE_BSD


115 #i‚de‡
__daddr_t_deföed


116 
__daddr_t
 
	tdaddr_t
;

117 
__ˇddr_t
 
	tˇddr_t
;

118 
	#__daddr_t_deföed


	)

122 #i‡(
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN
Ë&& !deföed 
__key_t_deföed


123 
__key_t
 
	tkey_t
;

124 
	#__key_t_deföed


	)

127 #ifde‡
__USE_XOPEN


128 
	#__√ed_˛ock_t


	)

130 
	#__√ed_time_t


	)

131 
	#__√ed_timî_t


	)

132 
	#__√ed_˛ockid_t


	)

133 
	~<time.h
>

135 #ifde‡
__USE_XOPEN


136 #i‚de‡
__u£c⁄ds_t_deföed


137 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

138 
	#__u£c⁄ds_t_deföed


	)

140 #i‚de‡
__su£c⁄ds_t_deföed


141 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

142 
	#__su£c⁄ds_t_deföed


	)

146 
	#__√ed_size_t


	)

147 
	~<°ddef.h
>

149 #ifde‡
__USE_MISC


151 
	tul⁄g
;

152 
	tush‹t
;

153 
	tuöt
;

158 #i‡!
__GNUC_PREREQ
 (2, 7)

161 #i‚de‡
__öt8_t_deföed


162 
	#__öt8_t_deföed


	)

163 
	töt8_t
;

164 
	töt16_t
;

165 
	töt32_t
;

166 #i‡
__WORDSIZE
 == 64

167 
	töt64_t
;

168 #ñi‡
__GLIBC_HAVE_LONG_LONG


169 
__exãnsi⁄__
 
	töt64_t
;

174 
	tu_öt8_t
;

175 
	tu_öt16_t
;

176 
	tu_öt32_t
;

177 #i‡
__WORDSIZE
 == 64

178 
	tu_öt64_t
;

179 #ñi‡
__GLIBC_HAVE_LONG_LONG


180 
__exãnsi⁄__
 
	tu_öt64_t
;

183 
	tªgi°î_t
;

188 
	#__ötN_t
(
N
, 
MODE
) \

189 ##
	tN
##
	t_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	tMODE
)))

	)

190 
	t__u_ötN_t
(
	tN
, 
	tMODE
) \

191 
	tu_öt
##
	tN
##
	t_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	tMODE
)))

	)

193 #i‚de‡
	t__öt8_t_deföed


194 
	t__öt8_t_deföed


	)

195 
	t__ötN_t
 (8, 
	t__QI__
);

196 
__ötN_t
 (16, 
__HI__
);

197 
__ötN_t
 (32, 
__SI__
);

198 
__ötN_t
 (64, 
__DI__
);

201 
__u_ötN_t
 (8, 
__QI__
);

202 
__u_ötN_t
 (16, 
__HI__
);

203 
__u_ötN_t
 (32, 
__SI__
);

204 
__u_ötN_t
 (64, 
__DI__
);

206 
	tªgi°î_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__w‹d__
)));

212 
	#__BIT_TYPES_DEFINED__
 1

	)

215 #ifdef 
__USE_BSD


217 
	~<ídün.h
>

220 
	~<sys/£À˘.h
>

223 
	~<sys/sysma¸os.h
>

227 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__blksize_t_deföed


228 
__blksize_t
 
	tblksize_t
;

229 
	#__blksize_t_deföed


	)

233 #i‚de‡
__USE_FILE_OFFSET64


234 #i‚de‡
__blk˙t_t_deföed


235 
__blk˙t_t
 
	tblk˙t_t
;

236 
	#__blk˙t_t_deföed


	)

238 #i‚de‡
__fsblk˙t_t_deföed


239 
__fsblk˙t_t
 
	tfsblk˙t_t
;

240 
	#__fsblk˙t_t_deföed


	)

242 #i‚de‡
__fsfû˙t_t_deföed


243 
__fsfû˙t_t
 
	tfsfû˙t_t
;

244 
	#__fsfû˙t_t_deföed


	)

247 #i‚de‡
__blk˙t_t_deföed


248 
__blk˙t64_t
 
	tblk˙t_t
;

249 
	#__blk˙t_t_deföed


	)

251 #i‚de‡
__fsblk˙t_t_deföed


252 
__fsblk˙t64_t
 
	tfsblk˙t_t
;

253 
	#__fsblk˙t_t_deföed


	)

255 #i‚de‡
__fsfû˙t_t_deföed


256 
__fsfû˙t64_t
 
	tfsfû˙t_t
;

257 
	#__fsfû˙t_t_deföed


	)

261 #ifde‡
__USE_LARGEFILE64


262 
__blk˙t64_t
 
	tblk˙t64_t
;

263 
__fsblk˙t64_t
 
	tfsblk˙t64_t
;

264 
__fsfû˙t64_t
 
	tfsfû˙t64_t
;

269 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


270 
	~<bôs/±hªadty≥s.h
>

273 
	g__END_DECLS


	@/usr/include/sys/uio.h

19 #i‚de‡
_SYS_UIO_H


20 
	#_SYS_UIO_H
 1

	)

22 
	~<„©uªs.h
>

24 
	~<sys/ty≥s.h
>

26 
	g__BEGIN_DECLS


29 
	~<bôs/uio.h
>

40 
ssize_t
 
	$ªadv
 (
__fd
, 
__c⁄°
 
iovec
 *
__iovec
, 
__cou¡
)

41 
__wur
;

51 
ssize_t
 
	$wrôev
 (
__fd
, 
__c⁄°
 
iovec
 *
__iovec
, 
__cou¡
)

52 
__wur
;

55 #ifde‡
__USE_BSD


56 #i‚de‡
__USE_FILE_OFFSET64


66 
ssize_t
 
	$¥ódv
 (
__fd
, 
__c⁄°
 
iovec
 *
__iovec
, 
__cou¡
,

67 
__off_t
 
__off£t
Ë
__wur
;

78 
ssize_t
 
	$pwrôev
 (
__fd
, 
__c⁄°
 
iovec
 *
__iovec
, 
__cou¡
,

79 
__off_t
 
__off£t
Ë
__wur
;

81 #ifde‡
__REDIRECT


82 
ssize_t
 
	`__REDIRECT
 (
¥ódv
, (
__fd
, 
__c⁄°
 
iovec
 *
__iovec
,

83 
__cou¡
, 
__off64_t
 
__off£t
),

84 
¥ódv64
Ë
__wur
;

85 
ssize_t
 
	`__REDIRECT
 (
pwrôev
, (
__fd
, 
__c⁄°
 
iovec
 *
__iovec
,

86 
__cou¡
, 
__off64_t
 
__off£t
),

87 
pwrôev64
Ë
__wur
;

89 
	#¥ódv
 
¥ódv64


	)

90 
	#pwrôev
 
pwrôev64


	)

94 #ifde‡
__USE_LARGEFILE64


104 
ssize_t
 
	$¥ódv64
 (
__fd
, 
__c⁄°
 
iovec
 *
__iovec
, 
__cou¡
,

105 
__off64_t
 
__off£t
Ë
__wur
;

116 
ssize_t
 
	$pwrôev64
 (
__fd
, 
__c⁄°
 
iovec
 *
__iovec
, 
__cou¡
,

117 
__off64_t
 
__off£t
Ë
__wur
;

121 
__END_DECLS


	@/usr/include/xlocale.h

21 #i‚de‡
_XLOCALE_H


22 
	#_XLOCALE_H
 1

	)

28 
	s__loˇÀ_°ru˘


31 
loˇÀ_d©a
 *
	m__loˇÀs
[13];

34 c⁄° *
	m__˘y≥_b
;

35 c⁄° *
	m__˘y≥_tﬁowî
;

36 c⁄° *
	m__˘y≥_touµî
;

39 c⁄° *
	m__«mes
[13];

40 } *
	t__loˇÀ_t
;

43 
__loˇÀ_t
 
	tloˇÀ_t
;

	@/usr/include/_G_config.h

4 #i‚de‡
_G_c⁄fig_h


5 
	#_G_c⁄fig_h
 1

	)

9 
	~<bôs/ty≥s.h
>

10 
	#__√ed_size_t


	)

11 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


12 
	#__√ed_wch¨_t


	)

14 
	#__√ed_NULL


	)

15 
	~<°ddef.h
>

16 
	#__√ed_mb°©e_t


	)

17 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


18 
	#__√ed_wöt_t


	)

20 
	~<wch¨.h
>

21 
	#_G_size_t
 
size_t


	)

24 
__off_t
 
	m__pos
;

25 
__mb°©e_t
 
	m__°©e
;

26 } 
	t_G_Âos_t
;

29 
__off64_t
 
	m__pos
;

30 
__mb°©e_t
 
	m__°©e
;

31 } 
	t_G_Âos64_t
;

32 
	#_G_ssize_t
 
__ssize_t


	)

33 
	#_G_off_t
 
__off_t


	)

34 
	#_G_off64_t
 
__off64_t


	)

35 
	#_G_pid_t
 
__pid_t


	)

36 
	#_G_uid_t
 
__uid_t


	)

37 
	#_G_wch¨_t
 
wch¨_t


	)

38 
	#_G_wöt_t
 
wöt_t


	)

39 
	#_G_°©64
 
°©64


	)

40 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


41 
	~<gc⁄v.h
>

44 
__gc⁄v_öfo
 
	m__cd
;

47 
__gc⁄v_öfo
 
	m__cd
;

48 
__gc⁄v_°ï_d©a
 
	m__d©a
;

49 } 
	m__comböed
;

50 } 
	t_G_ic⁄v_t
;

53 
	t_G_öt16_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__HI__
)));

54 
	t_G_öt32_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__SI__
)));

55 
	t_G_uöt16_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__HI__
)));

56 
	t_G_uöt32_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__SI__
)));

58 
	#_G_HAVE_BOOL
 1

	)

62 
	#_G_HAVE_ATEXIT
 1

	)

63 
	#_G_HAVE_SYS_CDEFS
 1

	)

64 
	#_G_HAVE_SYS_WAIT
 1

	)

65 
	#_G_NEED_STDARG_H
 1

	)

66 
	#_G_va_li°
 
__gnuc_va_li°


	)

68 
	#_G_HAVE_PRINTF_FP
 1

	)

69 
	#_G_HAVE_MMAP
 1

	)

70 
	#_G_HAVE_MREMAP
 1

	)

71 
	#_G_HAVE_LONG_DOUBLE_IO
 1

	)

72 
	#_G_HAVE_IO_FILE_OPEN
 1

	)

73 
	#_G_HAVE_IO_GETLINE_INFO
 1

	)

75 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

77 
	#_G_OPEN64
 
__›í64


	)

78 
	#_G_LSEEK64
 
__l£ek64


	)

79 
	#_G_MMAP64
 
__mm≠64


	)

80 
	#_G_FSTAT64
(
fd
,
buf
Ë
	`__fx°©64
 (
_STAT_VER
, fd, buf)

	)

83 
	#_G_HAVE_ST_BLKSIZE
 
	`deföed
 (
_STATBUF_ST_BLKSIZE
)

	)

85 
	#_G_BUFSIZ
 8192

	)

88 
	#_G_NAMES_HAVE_UNDERSCORE
 0

	)

89 
	#_G_VTABLE_LABEL_HAS_LENGTH
 1

	)

90 
	#_G_USING_THUNKS
 1

	)

91 
	#_G_VTABLE_LABEL_PREFIX
 "__vt_"

	)

92 
	#_G_VTABLE_LABEL_PREFIX_ID
 
__vt_


	)

95 #i‡
deföed
 
__˝lu•lus
 || deföed 
__STDC__


96 
	#_G_ARGS
(
ARGLIST
Ë
	)
ARGLIST

98 
	#_G_ARGS
(
ARGLIST
Ë()

	)

	@/usr/include/asm-generic/errno.h

1 #i‚de‡
_ASM_GENERIC_ERRNO_H


2 
	#_ASM_GENERIC_ERRNO_H


	)

4 
	~<asm-gíîic/î∫o-ba£.h
>

6 
	#EDEADLK
 35

	)

7 
	#ENAMETOOLONG
 36

	)

8 
	#ENOLCK
 37

	)

9 
	#ENOSYS
 38

	)

10 
	#ENOTEMPTY
 39

	)

11 
	#ELOOP
 40

	)

12 
	#EWOULDBLOCK
 
EAGAIN


	)

13 
	#ENOMSG
 42

	)

14 
	#EIDRM
 43

	)

15 
	#ECHRNG
 44

	)

16 
	#EL2NSYNC
 45

	)

17 
	#EL3HLT
 46

	)

18 
	#EL3RST
 47

	)

19 
	#ELNRNG
 48

	)

20 
	#EUNATCH
 49

	)

21 
	#ENOCSI
 50

	)

22 
	#EL2HLT
 51

	)

23 
	#EBADE
 52

	)

24 
	#EBADR
 53

	)

25 
	#EXFULL
 54

	)

26 
	#ENOANO
 55

	)

27 
	#EBADRQC
 56

	)

28 
	#EBADSLT
 57

	)

30 
	#EDEADLOCK
 
EDEADLK


	)

32 
	#EBFONT
 59

	)

33 
	#ENOSTR
 60

	)

34 
	#ENODATA
 61

	)

35 
	#ETIME
 62

	)

36 
	#ENOSR
 63

	)

37 
	#ENONET
 64

	)

38 
	#ENOPKG
 65

	)

39 
	#EREMOTE
 66

	)

40 
	#ENOLINK
 67

	)

41 
	#EADV
 68

	)

42 
	#ESRMNT
 69

	)

43 
	#ECOMM
 70

	)

44 
	#EPROTO
 71

	)

45 
	#EMULTIHOP
 72

	)

46 
	#EDOTDOT
 73

	)

47 
	#EBADMSG
 74

	)

48 
	#EOVERFLOW
 75

	)

49 
	#ENOTUNIQ
 76

	)

50 
	#EBADFD
 77

	)

51 
	#EREMCHG
 78

	)

52 
	#ELIBACC
 79

	)

53 
	#ELIBBAD
 80

	)

54 
	#ELIBSCN
 81

	)

55 
	#ELIBMAX
 82

	)

56 
	#ELIBEXEC
 83

	)

57 
	#EILSEQ
 84

	)

58 
	#ERESTART
 85

	)

59 
	#ESTRPIPE
 86

	)

60 
	#EUSERS
 87

	)

61 
	#ENOTSOCK
 88

	)

62 
	#EDESTADDRREQ
 89

	)

63 
	#EMSGSIZE
 90

	)

64 
	#EPROTOTYPE
 91

	)

65 
	#ENOPROTOOPT
 92

	)

66 
	#EPROTONOSUPPORT
 93

	)

67 
	#ESOCKTNOSUPPORT
 94

	)

68 
	#EOPNOTSUPP
 95

	)

69 
	#EPFNOSUPPORT
 96

	)

70 
	#EAFNOSUPPORT
 97

	)

71 
	#EADDRINUSE
 98

	)

72 
	#EADDRNOTAVAIL
 99

	)

73 
	#ENETDOWN
 100

	)

74 
	#ENETUNREACH
 101

	)

75 
	#ENETRESET
 102

	)

76 
	#ECONNABORTED
 103

	)

77 
	#ECONNRESET
 104

	)

78 
	#ENOBUFS
 105

	)

79 
	#EISCONN
 106

	)

80 
	#ENOTCONN
 107

	)

81 
	#ESHUTDOWN
 108

	)

82 
	#ETOOMANYREFS
 109

	)

83 
	#ETIMEDOUT
 110

	)

84 
	#ECONNREFUSED
 111

	)

85 
	#EHOSTDOWN
 112

	)

86 
	#EHOSTUNREACH
 113

	)

87 
	#EALREADY
 114

	)

88 
	#EINPROGRESS
 115

	)

89 
	#ESTALE
 116

	)

90 
	#EUCLEAN
 117

	)

91 
	#ENOTNAM
 118

	)

92 
	#ENAVAIL
 119

	)

93 
	#EISNAM
 120

	)

94 
	#EREMOTEIO
 121

	)

95 
	#EDQUOT
 122

	)

97 
	#ENOMEDIUM
 123

	)

98 
	#EMEDIUMTYPE
 124

	)

99 
	#ECANCELED
 125

	)

100 
	#ENOKEY
 126

	)

101 
	#EKEYEXPIRED
 127

	)

102 
	#EKEYREVOKED
 128

	)

103 
	#EKEYREJECTED
 129

	)

106 
	#EOWNERDEAD
 130

	)

107 
	#ENOTRECOVERABLE
 131

	)

109 
	#ERFKILL
 132

	)

	@/usr/include/asm/ioctls.h

1 
	~<asm-gíîic/io˘ls.h
>

	@/usr/include/asm/socket.h

1 
	~<asm-gíîic/sockë.h
>

	@/usr/include/asm/types.h

1 #i‚de‡
_ASM_X86_TYPES_H


2 
	#_ASM_X86_TYPES_H


	)

4 
	#dma_addr_t
 
dma_addr_t


	)

6 
	~<asm-gíîic/ty≥s.h
>

	@/usr/include/bits/libio-ldbl.h

20 #i‚de‡
_IO_STDIO_H


24 
	$__LDBL_REDIR_DECL
 (
_IO_vfsˇnf
)

25 
	`__LDBL_REDIR_DECL
 (
_IO_vÂrötf
)

	@/usr/include/bits/predefs.h

19 #i‚de‡
_FEATURES_H


23 #i‚de‡
_PREDEFS_H


24 
	#_PREDEFS_H


	)

27 
	#__STDC_IEC_559__
 1

	)

28 
	#__STDC_IEC_559_COMPLEX__
 1

	)

	@/usr/include/bits/pthreadtypes.h

20 #i‚de‡
_BITS_PTHREADTYPES_H


21 
	#_BITS_PTHREADTYPES_H
 1

	)

23 
	~<bôs/w‹dsize.h
>

25 #i‡
__WORDSIZE
 == 64

26 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

27 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

28 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

29 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

30 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

31 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

32 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

33 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

34 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

36 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

37 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

38 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

39 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

40 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

41 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

42 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

43 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

44 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

50 
	t±hªad_t
;

55 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

56 
	m__Æign
;

57 } 
	t±hªad_©å_t
;

60 #i‡
__WORDSIZE
 == 64

61 
	s__±hªad_öã∫Æ_li°


63 
__±hªad_öã∫Æ_li°
 *
	m__¥ev
;

64 
__±hªad_öã∫Æ_li°
 *
	m__√xt
;

65 } 
	t__±hªad_li°_t
;

67 
	s__±hªad_öã∫Æ_¶i°


69 
__±hªad_öã∫Æ_¶i°
 *
	m__√xt
;

70 } 
	t__±hªad_¶i°_t
;

78 
	s__±hªad_muãx_s


80 
	m__lock
;

81 
	m__cou¡
;

82 
	m__ow√r
;

83 #i‡
__WORDSIZE
 == 64

84 
	m__nu£rs
;

88 
	m__köd
;

89 #i‡
__WORDSIZE
 == 64

90 
	m__•ös
;

91 
__±hªad_li°_t
 
	m__li°
;

92 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

94 
	m__nu£rs
;

95 
__exãnsi⁄__
 union

97 
	m__•ös
;

98 
__±hªad_¶i°_t
 
	m__li°
;

101 } 
	m__d©a
;

102 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

103 
	m__Æign
;

104 } 
	t±hªad_muãx_t
;

108 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

109 
	m__Æign
;

110 } 
	t±hªad_muãx©å_t
;

119 
	m__lock
;

120 
	m__fuãx
;

121 
__exãnsi⁄__
 
	m__tŸÆ_£q
;

122 
__exãnsi⁄__
 
	m__wakeup_£q
;

123 
__exãnsi⁄__
 
	m__wokí_£q
;

124 *
	m__muãx
;

125 
	m__nwaôîs
;

126 
	m__brﬂdˇ°_£q
;

127 } 
	m__d©a
;

128 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

129 
__exãnsi⁄__
 
	m__Æign
;

130 } 
	t±hªad_c⁄d_t
;

134 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

135 
	m__Æign
;

136 } 
	t±hªad_c⁄d©å_t
;

140 
	t±hªad_key_t
;

144 
	t±hªad_⁄˚_t
;

147 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


152 #i‡
__WORDSIZE
 == 64

155 
	m__lock
;

156 
	m__ƒ_ªadîs
;

157 
	m__ªadîs_wakeup
;

158 
	m__wrôî_wakeup
;

159 
	m__ƒ_ªadîs_queued
;

160 
	m__ƒ_wrôîs_queued
;

161 
	m__wrôî
;

162 
	m__sh¨ed
;

163 
	m__∑d1
;

164 
	m__∑d2
;

167 
	m__Êags
;

168 } 
	m__d©a
;

172 
	m__lock
;

173 
	m__ƒ_ªadîs
;

174 
	m__ªadîs_wakeup
;

175 
	m__wrôî_wakeup
;

176 
	m__ƒ_ªadîs_queued
;

177 
	m__ƒ_wrôîs_queued
;

180 
	m__Êags
;

181 
	m__sh¨ed
;

182 
	m__∑d1
;

183 
	m__∑d2
;

184 
	m__wrôî
;

185 } 
	m__d©a
;

187 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

188 
	m__Æign
;

189 } 
	t±hªad_rwlock_t
;

193 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

194 
	m__Æign
;

195 } 
	t±hªad_rwlock©å_t
;

199 #ifde‡
__USE_XOPEN2K


201 vﬁ©ûê
	t±hªad_•ölock_t
;

208 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

209 
	m__Æign
;

210 } 
	t±hªad_b¨rõr_t
;

214 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

215 
	m__Æign
;

216 } 
	t±hªad_b¨rõøâr_t
;

220 #i‡
__WORDSIZE
 == 32

222 
	#__˛ónup_f˘_©åibuã
 
	`__©åibuã__
 ((
	`__ªg∑rm__
 (1)))

	)

	@/usr/include/bits/sockaddr.h

24 #i‚de‡
_BITS_SOCKADDR_H


25 
	#_BITS_SOCKADDR_H
 1

	)

29 
	tß_Ámûy_t
;

35 
	#__SOCKADDR_COMMON
(
ß_¥efix
) \

36 
ß_Ámûy_t
 
ß_¥efix
##
Ámûy


	)

38 
	#__SOCKADDR_COMMON_SIZE
 ( ())

	)

	@/usr/include/bits/stdio-lock.h

20 #i‚de‡
_BITS_STDIO_LOCK_H


21 
	#_BITS_STDIO_LOCK_H
 1

	)

23 
	~<bôs/libc-lock.h
>

24 
	~<lowÀvñlock.h
>

28 
	#_IO_lock_öex≥nsive
 1

	)

30 °ru˘ { 
	mlock
; 
	m˙t
; *
	mow√r
; } 
	t_IO_lock_t
;

32 
	#_IO_lock_öôülizî
 { 
LLL_LOCK_INITIALIZER
, 0, 
NULL
 }

	)

34 
	#_IO_lock_öô
(
_«me
) \

35 ((
_«me
Ë(
_IO_lock_t
Ë
_IO_lock_öôülizî
 , 0)

	)

37 
	#_IO_lock_föi
(
_«me
) \

38 ((Ë0)

	)

40 
	#_IO_lock_lock
(
_«me
) \

42 *
__£lf
 = 
THREAD_SELF
; \

43 i‡((
_«me
).
ow√r
 !
__£lf
) \

45 
	`Œl_lock
 ((
_«me
).
lock
, 
LLL_PRIVATE
); \

46 (
_«me
).
ow√r
 = 
__£lf
; \

48 ++(
_«me
).
˙t
; \

49 } 0)

	)

51 
	#_IO_lock_åylock
(
_«me
) \

53 
__ªsu…
 = 0; \

54 *
__£lf
 = 
THREAD_SELF
; \

55 i‡((
_«me
).
ow√r
 !
__£lf
) \

57 i‡(
	`Œl_åylock
 ((
_«me
).
lock
) == 0) \

59 (
_«me
).
ow√r
 = 
__£lf
; \

60 (
_«me
).
˙t
 = 1; \

63 
__ªsu…
 = 
EBUSY
; \

66 ++(
_«me
).
˙t
; \

67 
__ªsu…
; \

68 })

	)

70 
	#_IO_lock_u∆ock
(
_«me
) \

72 i‡(--(
_«me
).
˙t
 == 0) \

74 (
_«me
).
ow√r
 = 
NULL
; \

75 
	`Œl_u∆ock
 ((
_«me
).
lock
, 
LLL_PRIVATE
); \

77 } 0)

	)

81 
	#_IO_˛ónup_ªgi⁄_°¨t
(
_f˘
, 
_Â
) \

82 
	`__libc_˛ónup_ªgi⁄_°¨t
 (((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0, 
_f˘
, _Â)

	)

83 
	#_IO_˛ónup_ªgi⁄_°¨t_nﬂrg
(
_f˘
) \

84 
	`__libc_˛ónup_ªgi⁄_°¨t
 (1, 
_f˘
, 
NULL
)

	)

85 
	#_IO_˛ónup_ªgi⁄_íd
(
_doô
) \

86 
	`__libc_˛ónup_ªgi⁄_íd
 (
_doô
)

	)

88 #i‡
deföed
 
_LIBC
 && !deföed 
NOT_IN_libc


90 #ifde‡
__EXCEPTIONS


91 
	#_IO_acquúe_lock
(
_Â
) \

93 
_IO_FILE
 *
_IO_acquúe_lock_fûe
 \

94 
	`__©åibuã__
((
	`˛ónup
 (
_IO_acquúe_lock_f˘
))) \

95 (
_Â
); \

96 
	`_IO_Êockfûe
 (
_IO_acquúe_lock_fûe
);

	)

97 
	#_IO_acquúe_lock_˛ór_Êags2
(
_Â
) \

99 
_IO_FILE
 *
_IO_acquúe_lock_fûe
 \

100 
	`__©åibuã__
((
	`˛ónup
 (
_IO_acquúe_lock_˛ór_Êags2_f˘
))) \

101 (
_Â
); \

102 
	`_IO_Êockfûe
 (
_IO_acquúe_lock_fûe
);

	)

104 
	#_IO_acquúe_lock
(
_Â
Ë
_IO_acquúe_lock_√eds_ex˚±i⁄s_íabÀd


	)

105 
	#_IO_acquúe_lock_˛ór_Êags2
(
_Â
Ë
	`_IO_acquúe_lock
 (_Â)

	)

107 
	#_IO_ªÀa£_lock
(
_Â
Ë; } 0)

	)

	@/usr/include/bits/typesizes.h

20 #i‚de‡
_BITS_TYPES_H


24 #i‚def 
_BITS_TYPESIZES_H


25 
	#_BITS_TYPESIZES_H
 1

	)

30 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

31 
	#__UID_T_TYPE
 
__U32_TYPE


	)

32 
	#__GID_T_TYPE
 
__U32_TYPE


	)

33 
	#__INO_T_TYPE
 
__ULONGWORD_TYPE


	)

34 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

35 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

36 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

37 
	#__OFF_T_TYPE
 
__SLONGWORD_TYPE


	)

38 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

39 
	#__PID_T_TYPE
 
__S32_TYPE


	)

40 
	#__RLIM_T_TYPE
 
__ULONGWORD_TYPE


	)

41 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

42 
	#__BLKCNT_T_TYPE
 
__SLONGWORD_TYPE


	)

43 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

44 
	#__FSBLKCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

45 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

46 
	#__FSFILCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

47 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

48 
	#__ID_T_TYPE
 
__U32_TYPE


	)

49 
	#__CLOCK_T_TYPE
 
__SLONGWORD_TYPE


	)

50 
	#__TIME_T_TYPE
 
__SLONGWORD_TYPE


	)

51 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

52 
	#__SUSECONDS_T_TYPE
 
__SLONGWORD_TYPE


	)

53 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

54 
	#__SWBLK_T_TYPE
 
__SLONGWORD_TYPE


	)

55 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

56 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

57 
	#__TIMER_T_TYPE
 *

	)

58 
	#__BLKSIZE_T_TYPE
 
__SLONGWORD_TYPE


	)

59 
	#__FSID_T_TYPE
 såu˘ { 
__vÆ
[2]; }

	)

60 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

63 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/bits/uio.h

19 #i‡!
deföed
 
_SYS_UIO_H
 && !deföed 
_FCNTL_H


23 #i‚de‡
_BITS_UIO_H


24 
	#_BITS_UIO_H
 1

	)

26 
	~<sys/ty≥s.h
>

40 
	#UIO_MAXIOV
 1024

	)

44 
	siovec


46 *
	miov_ba£
;

47 
size_t
 
	miov_Àn
;

	@/usr/include/bits/wordsize.h

3 #i‡
deföed
 
__x86_64__


4 
	#__WORDSIZE
 64

	)

5 
	#__WORDSIZE_COMPAT32
 1

	)

7 
	#__WORDSIZE
 32

	)

	@/usr/include/ctype.h

24 #i‚def 
_CTYPE_H


25 
	#_CTYPE_H
 1

	)

27 
	~<„©uªs.h
>

28 
	~<bôs/ty≥s.h
>

30 
	g__BEGIN_DECLS


32 #i‚de‡
_ISbô


41 
	~<ídün.h
>

42 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


43 
	#_ISbô
(
bô
Ë(1 << (bô))

	)

45 
	#_ISbô
(
bô
Ë((bôË< 8 ? ((1 << (bô)Ë<< 8Ë: ((1 << (bô)Ë>> 8))

	)

50 
	m_ISuµî
 = 
_ISbô
 (0),

51 
	m_ISlowî
 = 
_ISbô
 (1),

52 
	m_ISÆpha
 = 
_ISbô
 (2),

53 
	m_ISdigô
 = 
_ISbô
 (3),

54 
	m_ISxdigô
 = 
_ISbô
 (4),

55 
	m_IS•a˚
 = 
_ISbô
 (5),

56 
	m_IS¥öt
 = 
_ISbô
 (6),

57 
	m_ISgøph
 = 
_ISbô
 (7),

58 
	m_ISbœnk
 = 
_ISbô
 (8),

59 
	m_IS˙ål
 = 
_ISbô
 (9),

60 
	m_ISpun˘
 = 
_ISbô
 (10),

61 
	m_ISÆnum
 = 
_ISbô
 (11)

81 
__c⁄°
 **
	$__˘y≥_b_loc
 ()

82 
__THROW
 
	`__©åibuã__
 ((
__c⁄°
));

83 
__c⁄°
 
__öt32_t
 **
	$__˘y≥_tﬁowî_loc
 ()

84 
__THROW
 
	`__©åibuã__
 ((
__c⁄°
));

85 
__c⁄°
 
__öt32_t
 **
	$__˘y≥_touµî_loc
 ()

86 
__THROW
 
	`__©åibuã__
 ((
__c⁄°
));

88 
	#__is˘y≥
(
c
, 
ty≥
) \

89 ((*
	`__˘y≥_b_loc
 ())[(Ë(
c
)] & (Ë
ty≥
)

	)

91 
	#__ißscii
(
c
Ë(((cË& ~0x7fË=0Ë

	)

92 
	#__tﬂscii
(
c
Ë((cË& 0x7fË

	)

94 
	#__ex˘y≥
(
«me
Ë
	`«me
 (Ë
__THROW


	)

96 
__BEGIN_NAMESPACE_STD


102 
	`__ex˘y≥
 (
iß um
);

103 
	`__ex˘y≥
 (
ißÕha
);

104 
	`__ex˘y≥
 (
is˙ål
);

105 
	`__ex˘y≥
 (
isdigô
);

106 
	`__ex˘y≥
 (
i¶owî
);

107 
	`__ex˘y≥
 (
isgøph
);

108 
	`__ex˘y≥
 (
i•röt
);

109 
	`__ex˘y≥
 (
i•un˘
);

110 
	`__ex˘y≥
 (
is•a˚
);

111 
	`__ex˘y≥
 (
isuµî
);

112 
	`__ex˘y≥
 (
isxdigô
);

116 
	$tﬁowî
 (
__c
Ë
__THROW
;

119 
	$touµî
 (
__c
Ë
__THROW
;

121 
__END_NAMESPACE_STD


125 #ifdef 
__USE_ISOC99


126 
__BEGIN_NAMESPACE_C99


128 
	`__ex˘y≥
 (
isbœnk
);

130 
__END_NAMESPACE_C99


133 #ifde‡
__USE_GNU


135 
	$is˘y≥
 (
__c
, 
__mask
Ë
__THROW
;

138 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


142 
	$ißscii
 (
__c
Ë
__THROW
;

146 
	$tﬂscii
 (
__c
Ë
__THROW
;

150 
	`__ex˘y≥
 (
_touµî
);

151 
	`__ex˘y≥
 (
_tﬁowî
);

155 
	#__tobody
(
c
, 
f
, 
a
, 
¨gs
) \

156 (
__exãnsi⁄__
 \

157 ({ 
__ªs
; \

158 i‡( (
c
) > 1) \

160 i‡(
	`__buûtö_c⁄°™t_p
 (
c
)) \

162 
__c
 = (
c
); \

163 
__ªs
 = 
__c
 < -128 || __¯> 255 ? __¯: (
a
)[__c]; \

166 
__ªs
 = 
f
 
¨gs
; \

169 
__ªs
 = (
a
)[(Ë(
c
)]; \

170 
__ªs
; 
	}
}))

	)

172 #i‡!
deföed
 
__NO_CTYPE
 && !deföed 
__˝lu•lus


173 
	#iß um
(
c
Ë
	`__is˘y≥
((c), 
_ISÆnum
)

	)

174 
	#ißÕha
(
c
Ë
	`__is˘y≥
((c), 
_ISÆpha
)

	)

175 
	#is˙ål
(
c
Ë
	`__is˘y≥
((c), 
_IS˙ål
)

	)

176 
	#isdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISdigô
)

	)

177 
	#i¶owî
(
c
Ë
	`__is˘y≥
((c), 
_ISlowî
)

	)

178 
	#isgøph
(
c
Ë
	`__is˘y≥
((c), 
_ISgøph
)

	)

179 
	#i•röt
(
c
Ë
	`__is˘y≥
((c), 
_IS¥öt
)

	)

180 
	#i•un˘
(
c
Ë
	`__is˘y≥
((c), 
_ISpun˘
)

	)

181 
	#is•a˚
(
c
Ë
	`__is˘y≥
((c), 
_IS•a˚
)

	)

182 
	#isuµî
(
c
Ë
	`__is˘y≥
((c), 
_ISuµî
)

	)

183 
	#isxdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISxdigô
)

	)

185 #ifde‡
__USE_ISOC99


186 
	#isbœnk
(
c
Ë
	`__is˘y≥
((c), 
_ISbœnk
)

	)

189 #ifde‡
__USE_EXTERN_INLINES


190 
__exã∫_ölöe
 

191 
__NTH
 (
	$tﬁowî
 (
__c
))

193  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_tﬁowî_loc
 ())[__c] : __c;

194 
	}
}

196 
__exã∫_ölöe
 

197 
__NTH
 (
	$touµî
 (
__c
))

199  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_touµî_loc
 ())[__c] : __c;

200 
	}
}

203 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


204 
	#tﬁowî
(
c
Ë
	`__tobody
 (c, 
tﬁowî
, *
	`__˘y≥_tﬁowî_loc
 (), (c))

	)

205 
	#touµî
(
c
Ë
	`__tobody
 (c, 
touµî
, *
	`__˘y≥_touµî_loc
 (), (c))

	)

208 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


209 
	#ißscii
(
c
Ë
	`__ißscii
 (c)

	)

210 
	#tﬂscii
(
c
Ë
	`__tﬂscii
 (c)

	)

212 
	#_tﬁowî
(
c
Ë((Ë(*
	`__˘y≥_tﬁowî_loc
 ())[(Ë(c)])

	)

213 
	#_touµî
(
c
Ë((Ë(*
	`__˘y≥_touµî_loc
 ())[(Ë(c)])

	)

219 #ifde‡
__USE_XOPEN2K8


233 
	~<xloˇÀ.h
>

237 
	#__is˘y≥_l
(
c
, 
ty≥
, 
loˇÀ
) \

238 ((
loˇÀ
)->
__˘y≥_b
[(Ë(
c
)] & (Ë
ty≥
)

	)

240 
	#__ex˘y≥_l
(
«me
) \

241 
	`«me
 (, 
__loˇÀ_t
Ë
__THROW


	)

247 
__ex˘y≥_l
 (
iß um_l
);

248 
__ex˘y≥_l
 (
ißÕha_l
);

249 
__ex˘y≥_l
 (
is˙ål_l
);

250 
__ex˘y≥_l
 (
isdigô_l
);

251 
__ex˘y≥_l
 (
i¶owî_l
);

252 
__ex˘y≥_l
 (
isgøph_l
);

253 
__ex˘y≥_l
 (
i•röt_l
);

254 
__ex˘y≥_l
 (
i•un˘_l
);

255 
__ex˘y≥_l
 (
is•a˚_l
);

256 
__ex˘y≥_l
 (
isuµî_l
);

257 
__ex˘y≥_l
 (
isxdigô_l
);

259 
__ex˘y≥_l
 (
isbœnk_l
);

263 
	$__tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

264 
	$tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

267 
	$__touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

268 
	$touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

270 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


271 
	#__tﬁowî_l
(
c
, 
loˇÀ
) \

272 
	`__tobody
 (
c
, 
__tﬁowî_l
, (
loˇÀ
)->
__˘y≥_tﬁowî
, (c,ÜoˇÀ))

	)

273 
	#__touµî_l
(
c
, 
loˇÀ
) \

274 
	`__tobody
 (
c
, 
__touµî_l
, (
loˇÀ
)->
__˘y≥_touµî
, (c,ÜoˇÀ))

	)

275 
	#tﬁowî_l
(
c
, 
loˇÀ
Ë
	`__tﬁowî_l
 ((c), (loˇÀ))

	)

276 
	#touµî_l
(
c
, 
loˇÀ
Ë
	`__touµî_l
 ((c), (loˇÀ))

	)

280 #i‚de‡
__NO_CTYPE


281 
	#__iß um_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆnum
, (l))

	)

282 
	#__ißÕha_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆpha
, (l))

	)

283 
	#__is˙ål_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS˙ål
, (l))

	)

284 
	#__isdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISdigô
, (l))

	)

285 
	#__i¶owî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISlowî
, (l))

	)

286 
	#__isgøph_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISgøph
, (l))

	)

287 
	#__i•röt_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS¥öt
, (l))

	)

288 
	#__i•un˘_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISpun˘
, (l))

	)

289 
	#__is•a˚_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS•a˚
, (l))

	)

290 
	#__isuµî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISuµî
, (l))

	)

291 
	#__isxdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISxdigô
, (l))

	)

293 
	#__isbœnk_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISbœnk
, (l))

	)

295 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


296 
	#__ißscii_l
(
c
,
l
Ë(÷), 
	`__ißscii
 (c))

	)

297 
	#__tﬂscii_l
(
c
,
l
Ë(÷), 
	`__tﬂscii
 (c))

	)

300 
	#iß um_l
(
c
,
l
Ë
	`__iß um_l
 ((c), (l))

	)

301 
	#ißÕha_l
(
c
,
l
Ë
	`__ißÕha_l
 ((c), (l))

	)

302 
	#is˙ål_l
(
c
,
l
Ë
	`__is˙ål_l
 ((c), (l))

	)

303 
	#isdigô_l
(
c
,
l
Ë
	`__isdigô_l
 ((c), (l))

	)

304 
	#i¶owî_l
(
c
,
l
Ë
	`__i¶owî_l
 ((c), (l))

	)

305 
	#isgøph_l
(
c
,
l
Ë
	`__isgøph_l
 ((c), (l))

	)

306 
	#i•röt_l
(
c
,
l
Ë
	`__i•röt_l
 ((c), (l))

	)

307 
	#i•un˘_l
(
c
,
l
Ë
	`__i•un˘_l
 ((c), (l))

	)

308 
	#is•a˚_l
(
c
,
l
Ë
	`__is•a˚_l
 ((c), (l))

	)

309 
	#isuµî_l
(
c
,
l
Ë
	`__isuµî_l
 ((c), (l))

	)

310 
	#isxdigô_l
(
c
,
l
Ë
	`__isxdigô_l
 ((c), (l))

	)

312 
	#isbœnk_l
(
c
,
l
Ë
	`__isbœnk_l
 ((c), (l))

	)

314 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


315 
	#ißscii_l
(
c
,
l
Ë
	`__ißscii_l
 ((c), (l))

	)

316 
	#tﬂscii_l
(
c
,
l
Ë
	`__tﬂscii_l
 ((c), (l))

	)

323 
__END_DECLS


	@/usr/include/endian.h

19 #i‚def 
_ENDIAN_H


20 
	#_ENDIAN_H
 1

	)

22 
	~<„©uªs.h
>

32 
	#__LITTLE_ENDIAN
 1234

	)

33 
	#__BIG_ENDIAN
 4321

	)

34 
	#__PDP_ENDIAN
 3412

	)

37 
	~<bôs/ídün.h
>

41 #i‚de‡
__FLOAT_WORD_ORDER


42 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

45 #ifdef 
__USE_BSD


46 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

47 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

48 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

49 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

52 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


53 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

54 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


55 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

59 #ifde‡
__USE_BSD


61 
	~<bôs/byãsw≠.h
>

63 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


64 
	#htobe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

65 
	#htﬁe16
(
x
Ë(x)

	)

66 
	#be16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

67 
	#À16toh
(
x
Ë(x)

	)

69 
	#htobe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

70 
	#htﬁe32
(
x
Ë(x)

	)

71 
	#be32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

72 
	#À32toh
(
x
Ë(x)

	)

74 
	#htobe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

75 
	#htﬁe64
(
x
Ë(x)

	)

76 
	#be64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

77 
	#À64toh
(
x
Ë(x)

	)

79 
	#htobe16
(
x
Ë(x)

	)

80 
	#htﬁe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

81 
	#be16toh
(
x
Ë(x)

	)

82 
	#À16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

84 
	#htobe32
(
x
Ë(x)

	)

85 
	#htﬁe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

86 
	#be32toh
(
x
Ë(x)

	)

87 
	#À32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

89 
	#htobe64
(
x
Ë(x)

	)

90 
	#htﬁe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

91 
	#be64toh
(
x
Ë(x)

	)

92 
	#À64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/gnu/stubs.h

4 
	~<bôs/w‹dsize.h
>

6 #i‡
__WORDSIZE
 == 32

7 
	~<gnu/°ubs-32.h
>

8 #ñi‡
__WORDSIZE
 == 64

9 
	~<gnu/°ubs-64.h
>

	@/usr/include/linux/hdlc/ioctl.h

1 #i‚de‡
__HDLC_IOCTL_H__


2 
	#__HDLC_IOCTL_H__


	)

5 
	#GENERIC_HDLC_VERSION
 4

	)

7 
	#CLOCK_DEFAULT
 0

	)

8 
	#CLOCK_EXT
 1

	)

9 
	#CLOCK_INT
 2

	)

10 
	#CLOCK_TXINT
 3

	)

11 
	#CLOCK_TXFROMRX
 4

	)

14 
	#ENCODING_DEFAULT
 0

	)

15 
	#ENCODING_NRZ
 1

	)

16 
	#ENCODING_NRZI
 2

	)

17 
	#ENCODING_FM_MARK
 3

	)

18 
	#ENCODING_FM_SPACE
 4

	)

19 
	#ENCODING_MANCHESTER
 5

	)

22 
	#PARITY_DEFAULT
 0

	)

23 
	#PARITY_NONE
 1

	)

24 
	#PARITY_CRC16_PR0
 2

	)

25 
	#PARITY_CRC16_PR1
 3

	)

26 
	#PARITY_CRC16_PR0_CCITT
 4

	)

27 
	#PARITY_CRC16_PR1_CCITT
 5

	)

28 
	#PARITY_CRC32_PR0_CCITT
 6

	)

29 
	#PARITY_CRC32_PR1_CCITT
 7

	)

31 
	#LMI_DEFAULT
 0

	)

32 
	#LMI_NONE
 1

	)

33 
	#LMI_ANSI
 2

	)

34 
	#LMI_CCITT
 3

	)

35 
	#LMI_CISCO
 4

	)

38 
	m˛ock_øã
;

39 
	m˛ock_ty≥
;

40 
	mlo›back
;

41 } 
	tsync_£rül_£âögs
;

44 
	m˛ock_øã
;

45 
	m˛ock_ty≥
;

46 
	mlo›back
;

47 
	m¶Ÿ_m≠
;

48 } 
	tã1_£âögs
;

51 
	mícodög
;

52 
	m∑rôy
;

53 } 
	tøw_hdlc_¥Ÿo
;

56 
	mt391
;

57 
	mt392
;

58 
	mn391
;

59 
	mn392
;

60 
	mn393
;

61 
	mlmi
;

62 
	md˚
;

63 } 
	t‰_¥Ÿo
;

66 
	mdlci
;

67 } 
	t‰_¥Ÿo_pvc
;

70 
	mdlci
;

71 
	mma°î
[
IFNAMSIZ
];

72 }
	t‰_¥Ÿo_pvc_öfo
;

75 
	möãrvÆ
;

76 
	mtimeout
;

77 } 
	tcisco_¥Ÿo
;

	@/usr/include/linux/posix_types.h

1 #i‚de‡
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<löux/°ddef.h
>

21 #unde‡
__NFDBITS


22 
	#__NFDBITS
 (8 * ())

	)

24 #unde‡
__FD_SETSIZE


25 
	#__FD_SETSIZE
 1024

	)

27 #unde‡
__FDSET_LONGS


28 
	#__FDSET_LONGS
 (
__FD_SETSIZE
/
__NFDBITS
)

	)

30 #unde‡
__FDELT


31 
	#__FDELT
(
d
Ë((dË/ 
__NFDBITS
)

	)

33 #unde‡
__FDMASK


34 
	#__FDMASK
(
d
Ë(1UL << ((dË% 
__NFDBITS
))

	)

37 
	mfds_bôs
 [
__FDSET_LONGS
];

38 } 
	t__kî√l_fd_£t
;

41 (*
	t__kî√l_sigh™dÀr_t
)();

44 
	t__kî√l_key_t
;

45 
	t__kî√l_mqd_t
;

47 
	~<asm/posix_ty≥s.h
>

	@/usr/include/sys/cdefs.h

20 #i‚def 
_SYS_CDEFS_H


21 
	#_SYS_CDEFS_H
 1

	)

24 #i‚de‡
_FEATURES_H


25 
	~<„©uªs.h
>

31 #i‡
deföed
 
__GNUC__
 && !deföed 
__STDC__


36 #unde‡
__P


37 #unde‡
__PMT


39 #ifde‡
__GNUC__


46 #i‡!
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (3, 3)

47 
	#__THROW
 
	`__©åibuã__
 ((
__nŸhrow__
))

	)

48 
	#__NTH
(
f˘
Ë
	`__©åibuã__
 ((
__nŸhrow__
)Ë
	)
fct

50 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

51 
	#__THROW
 
	`throw
 ()

	)

52 
	#__NTH
(
f˘
Ëf˘ 
	`throw
 ()

	)

54 
	#__THROW


	)

55 
	#__NTH
(
f˘
Ë
	)
fct

61 
	#__ölöe


	)

63 
	#__THROW


	)

64 
	#__NTH
(
f˘
Ë
	)
fct

66 
	#__c⁄°
 c⁄°

	)

67 
	#__sig√d
 sig√d

	)

68 
	#__vﬁ©ûe
 vﬁ©ûe

	)

74 
	#__P
(
¨gs
Ë
	)
args

75 
	#__PMT
(
¨gs
Ë
	)
args

80 
	#__CONCAT
(
x
,
y
Ëx ## 
	)
y

81 
	#__STRING
(
x
Ë#x

	)

84 
	#__±r_t
 *

	)

85 
	#__l⁄g_doubÀ_t
 

	)

89 #ifdef 
__˝lu•lus


90 
	#__BEGIN_DECLS
 "C" {

	)

91 
	#__END_DECLS
 }

	)

93 
	#__BEGIN_DECLS


	)

94 
	#__END_DECLS


	)

103 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES


104 
	#__BEGIN_NAMESPACE_STD
 
«me•a˚
 
°d
 {

	)

105 
	#__END_NAMESPACE_STD
 }

	)

106 
	#__USING_NAMESPACE_STD
(
«me
Ë
usög
 
°d
::«me;

	)

107 
	#__BEGIN_NAMESPACE_C99
 
«me•a˚
 
__c99
 {

	)

108 
	#__END_NAMESPACE_C99
 }

	)

109 
	#__USING_NAMESPACE_C99
(
«me
Ë
usög
 
__c99
::«me;

	)

114 
	#__BEGIN_NAMESPACE_STD


	)

115 
	#__END_NAMESPACE_STD


	)

116 
	#__USING_NAMESPACE_STD
(
«me
)

	)

117 
	#__BEGIN_NAMESPACE_C99


	)

118 
	#__END_NAMESPACE_C99


	)

119 
	#__USING_NAMESPACE_C99
(
«me
)

	)

124 #i‚de‡
__BOUNDED_POINTERS__


125 
	#__bounded


	)

126 
	#__unbounded


	)

127 
	#__±rvÆue


	)

132 
	#__bos
(
±r
Ë
	`__buûtö_obje˘_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

133 
	#__bos0
(
±r
Ë
	`__buûtö_obje˘_size
 (±r, 0)

	)

135 #i‡
__GNUC_PREREQ
 (4,3)

136 
	#__w¨nde˛
(
«me
, 
msg
) \

137 
	`«me
 (Ë
	`__©åibuã__
((
	`__w¨nög__
 (
msg
)))

	)

138 
	#__w¨«âr
(
msg
Ë
	`__©åibuã__
((
	`__w¨nög__
 (msg)))

	)

139 
	#__îr‹de˛
(
«me
, 
msg
) \

140 
	`«me
 (Ë
	`__©åibuã__
((
	`__îr‹__
 (
msg
)))

	)

142 
	#__w¨nde˛
(
«me
, 
msg
Ë
	`«me
 ()

	)

143 
	#__w¨«âr
(
msg
)

	)

144 
	#__îr‹de˛
(
«me
, 
msg
Ë
	`«me
 ()

	)

148 #i‡
__GNUC_PREREQ
 (2,97)

150 
	#__Êex¨r
 []

	)

152 #ifde‡
__GNUC__


153 
	#__Êex¨r
 [0]

	)

155 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

156 
	#__Êex¨r
 []

	)

159 
	#__Êex¨r
 [1]

	)

175 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

177 
	#__REDIRECT
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

178 #ifde‡
__˝lu•lus


179 
	#__REDIRECT_NTH
(
«me
, 
¥Ÿo
, 
Æüs
) \

180 
«me
 
¥Ÿo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

182 
	#__REDIRECT_NTH
(
«me
, 
¥Ÿo
, 
Æüs
) \

183 
«me
 
¥Ÿo
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs)Ë
__THROW


	)

185 
	#__ASMNAME
(
˙ame
Ë
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, c«me)

	)

186 
	#__ASMNAME2
(
¥efix
, 
˙ame
Ë
	`__STRING
 (¥efixË
	)
cname

199 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

200 
	#__©åibuã__
(
xyz
Ë

	)

206 #i‡
__GNUC_PREREQ
 (2,96)

207 
	#__©åibuã_mÆloc__
 
	`__©åibuã__
 ((
__mÆloc__
))

	)

209 
	#__©åibuã_mÆloc__


	)

215 #i‡
__GNUC_PREREQ
 (2,96)

216 
	#__©åibuã_puª__
 
	`__©åibuã__
 ((
__puª__
))

	)

218 
	#__©åibuã_puª__


	)

224 #i‡
__GNUC_PREREQ
 (3,1)

225 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__u£d__
))

	)

226 
	#__©åibuã_noölöe__
 
	`__©åibuã__
 ((
__noölöe__
))

	)

228 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__unu£d__
))

	)

229 
	#__©åibuã_noölöe__


	)

233 #i‡
__GNUC_PREREQ
 (3,2)

234 
	#__©åibuã_dïªˇãd__
 
	`__©åibuã__
 ((
__dïªˇãd__
))

	)

236 
	#__©åibuã_dïªˇãd__


	)

245 #i‡
__GNUC_PREREQ
 (2,8)

246 
	#__©åibuã_f‹m©_¨g__
(
x
Ë
	`__©åibuã__
 ((
	`__f‹m©_¨g__
 (x)))

	)

248 
	#__©åibuã_f‹m©_¨g__
(
x
Ë

	)

255 #i‡
__GNUC_PREREQ
 (2,97)

256 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
) \

257 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__°rfm⁄__
, 
a
, 
b
)))

	)

259 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
Ë

	)

264 #i‡
__GNUC_PREREQ
 (3,3)

265 
	#__n⁄nuŒ
(
∑øms
Ë
	`__©åibuã__
 ((
__n⁄nuŒ__
Ö¨ams))

	)

267 
	#__n⁄nuŒ
(
∑øms
)

	)

272 #i‡
__GNUC_PREREQ
 (3,4)

273 
	#__©åibuã_w¨n_unu£d_ªsu…__
 \

274 
	`__©åibuã__
 ((
__w¨n_unu£d_ªsu…__
))

	)

275 #i‡
__USE_FORTIFY_LEVEL
 > 0

276 
	#__wur
 
__©åibuã_w¨n_unu£d_ªsu…__


	)

279 
	#__©åibuã_w¨n_unu£d_ªsu…__


	)

281 #i‚de‡
__wur


282 
	#__wur


	)

286 #i‡
__GNUC_PREREQ
 (3,2)

287 
	#__Æways_ölöe
 
__ölöe
 
	`__©åibuã__
 ((
__Æways_ölöe__
))

	)

289 
	#__Æways_ölöe
 
__ölöe


	)

294 #i‡!
deföed
 
__˝lu•lus
 || 
__GNUC_PREREQ
 (4,3)

295 #i‡
deföed
 
__GNUC_STDC_INLINE__
 || deföed 
__˝lu•lus


296 
	#__exã∫_ölöe
 
__ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
))

	)

297 #i‡
__GNUC_PREREQ
 (4,3)

298 
	#__exã∫_Æways_ölöe
 \

299 
__Æways_ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
, 
__¨tificül__
))

	)

301 
	#__exã∫_Æways_ölöe
 \

302 
__Æways_ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
))

	)

305 
	#__exã∫_ölöe
 
__ölöe


	)

306 #i‡
__GNUC_PREREQ
 (4,3)

307 
	#__exã∫_Æways_ölöe
 \

308 
__Æways_ölöe
 
	`__©åibuã__
 ((
__¨tificül__
))

	)

310 
	#__exã∫_Æways_ölöe
 
__Æways_ölöe


	)

317 #i‡
__GNUC_PREREQ
 (4,3)

318 
	#__va_¨g_∑ck
(Ë
	`__buûtö_va_¨g_∑ck
 ()

	)

319 
	#__va_¨g_∑ck_Àn
(Ë
	`__buûtö_va_¨g_∑ck_Àn
 ()

	)

326 #i‡!
__GNUC_PREREQ
 (2,8)

327 
	#__exãnsi⁄__


	)

331 #i‡!
__GNUC_PREREQ
 (2,92)

332 
	#__ª°ri˘


	)

338 #i‡
__GNUC_PREREQ
 (3,1Ë&& !
deföed
 
__GNUG__


339 
	#__ª°ri˘_¨r
 
__ª°ri˘


	)

341 #ifde‡
__GNUC__


342 
	#__ª°ri˘_¨r


	)

344 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

345 
	#__ª°ri˘_¨r
 
ª°ri˘


	)

348 
	#__ª°ri˘_¨r


	)

353 
	~<bôs/w‹dsize.h
>

355 #i‡
deföed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && deföed 
__NO_LONG_DOUBLE_MATH


356 
	#__LDBL_COMPAT
 1

	)

357 #ifde‡
__REDIRECT


358 
	#__LDBL_REDIR1
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT
 («me,ÖrŸo,álüs)

	)

359 
	#__LDBL_REDIR
(
«me
, 
¥Ÿo
) \

360 
	`__LDBL_REDIR1
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##«me)

	)

361 
	#__LDBL_REDIR1_NTH
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT_NTH
 («me,ÖrŸo,álüs)

	)

362 
	#__LDBL_REDIR_NTH
(
«me
, 
¥Ÿo
) \

363 
	`__LDBL_REDIR1_NTH
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##«me)

	)

364 
	#__LDBL_REDIR1_DECL
(
«me
, 
Æüs
) \

365 
	`__ty≥of
 (
«me
Ë«mê
	`__asm
 (
	`__ASMNAME
 (#Æüs));

	)

366 
	#__LDBL_REDIR_DECL
(
«me
) \

367 
	`__ty≥of
 (
«me
Ë«mê
	`__asm
 (
	`__ASMNAME
 ("__∆dbl_" #«me));

	)

368 
	#__REDIRECT_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

369 
	`__LDBL_REDIR1
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##
Æüs
)

	)

370 
	#__REDIRECT_NTH_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

371 
	`__LDBL_REDIR1_NTH
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##
Æüs
)

	)

374 #i‡!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT


375 
	#__LDBL_REDIR1
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê
	)
proto

376 
	#__LDBL_REDIR
(
«me
, 
¥Ÿo
Ë«mê
	)
proto

377 
	#__LDBL_REDIR1_NTH
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
__THROW


	)

378 
	#__LDBL_REDIR_NTH
(
«me
, 
¥Ÿo
Ë«mê¥Ÿÿ
__THROW


	)

379 
	#__LDBL_REDIR_DECL
(
«me
)

	)

380 #ifde‡
__REDIRECT


381 
	#__REDIRECT_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT
 («me,ÖrŸo,álüs)

	)

382 
	#__REDIRECT_NTH_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

383 
	`__REDIRECT_NTH
 (
«me
, 
¥Ÿo
, 
Æüs
)

	)

	@/usr/include/sys/select.h

22 #i‚de‡
_SYS_SELECT_H


23 
	#_SYS_SELECT_H
 1

	)

25 
	~<„©uªs.h
>

28 
	~<bôs/ty≥s.h
>

31 
	~<bôs/£À˘.h
>

34 
	~<bôs/sig£t.h
>

36 #i‚de‡
__sig£t_t_deföed


37 
	#__sig£t_t_deföed


	)

38 
__sig£t_t
 
	tsig£t_t
;

42 
	#__√ed_time_t


	)

43 
	#__√ed_time•ec


	)

44 
	~<time.h
>

45 
	#__√ed_timevÆ


	)

46 
	~<bôs/time.h
>

48 #i‚de‡
__su£c⁄ds_t_deföed


49 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

50 
	#__su£c⁄ds_t_deföed


	)

55 
	t__fd_mask
;

58 #unde‡
__NFDBITS


59 #unde‡
__FDELT


60 #unde‡
__FDMASK


62 
	#__NFDBITS
 (8 * (Ë (
__fd_mask
))

	)

63 
	#__FDELT
(
d
Ë((dË/ 
__NFDBITS
)

	)

64 
	#__FDMASK
(
d
Ë((
__fd_mask
Ë1 << ((dË% 
__NFDBITS
))

	)

71 #ifde‡
__USE_XOPEN


72 
__fd_mask
 
	mfds_bôs
[
__FD_SETSIZE
 / 
__NFDBITS
];

73 
	#__FDS_BITS
(
£t
Ë((£t)->
fds_bôs
)

	)

75 
__fd_mask
 
	m__fds_bôs
[
__FD_SETSIZE
 / 
__NFDBITS
];

76 
	#__FDS_BITS
(
£t
Ë((£t)->
__fds_bôs
)

	)

78 } 
	tfd_£t
;

81 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

83 #ifde‡
__USE_MISC


85 
__fd_mask
 
	tfd_mask
;

88 
	#NFDBITS
 
__NFDBITS


	)

93 
	#FD_SET
(
fd
, 
fd£ç
Ë
	`__FD_SET
 (fd, fd£ç)

	)

94 
	#FD_CLR
(
fd
, 
fd£ç
Ë
	`__FD_CLR
 (fd, fd£ç)

	)

95 
	#FD_ISSET
(
fd
, 
fd£ç
Ë
	`__FD_ISSET
 (fd, fd£ç)

	)

96 
	#FD_ZERO
(
fd£ç
Ë
	`__FD_ZERO
 (fd£ç)

	)

99 
__BEGIN_DECLS


109 
£À˘
 (
__nfds
, 
fd_£t
 *
__ª°ri˘
 
__ªadfds
,

110 
fd_£t
 *
__ª°ri˘
 
__wrôefds
,

111 
fd_£t
 *
__ª°ri˘
 
__ex˚±fds
,

112 
timevÆ
 *
__ª°ri˘
 
__timeout
);

114 #ifde‡
__USE_XOPEN2K


121 
p£À˘
 (
__nfds
, 
fd_£t
 *
__ª°ri˘
 
__ªadfds
,

122 
fd_£t
 *
__ª°ri˘
 
__wrôefds
,

123 
fd_£t
 *
__ª°ri˘
 
__ex˚±fds
,

124 c⁄° 
time•ec
 *
__ª°ri˘
 
__timeout
,

125 c⁄° 
__sig£t_t
 *
__ª°ri˘
 
__sigmask
);

128 
	g__END_DECLS


	@/usr/include/sys/sysmacros.h

21 #i‚de‡
_SYS_SYSMACROS_H


22 
	#_SYS_SYSMACROS_H
 1

	)

24 
	~<„©uªs.h
>

29 #ifde‡
__GLIBC_HAVE_LONG_LONG


30 
__exãnsi⁄__


31 
	$gnu_dev_maj‹
 (
__dev
)

32 
__THROW
;

33 
__exãnsi⁄__


34 
	$gnu_dev_mö‹
 (
__dev
)

35 
__THROW
;

36 
__exãnsi⁄__


37 
	$gnu_dev_makedev
 (
__maj‹
,

38 
__mö‹
)

39 
__THROW
;

41 #i‡
deföed
 
__GNUC__
 && __GNUC__ >2 && deföed 
__USE_EXTERN_INLINES


42 
__exãnsi⁄__
 
__exã∫_ölöe
 

43 
	`__NTH
 (
	$gnu_dev_maj‹
 (
__dev
))

45  ((
__dev
 >> 8) & 0xfff) | (() (__dev >> 32) & ~0xfff);

46 
	}
}

48 
__exãnsi⁄__
 
__exã∫_ölöe
 

49 
__NTH
 (
	$gnu_dev_mö‹
 (
__dev
))

51  (
__dev
 & 0xff) | (() (__dev >> 12) & ~0xff);

52 
	}
}

54 
__exãnsi⁄__
 
__exã∫_ölöe
 

55 
__NTH
 (
	$gnu_dev_makedev
 (
__maj‹
, 
__mö‹
))

57  ((
__mö‹
 & 0xffË| ((
__maj‹
 & 0xfff) << 8)

58 | (((Ë(
__mö‹
 & ~0xff)) << 12)

59 | (((Ë(
__maj‹
 & ~0xfff)) << 32));

60 
	}
}

65 
	#maj‹
(
dev
Ë
	`gnu_dev_maj‹
 (dev)

	)

66 
	#mö‹
(
dev
Ë
	`gnu_dev_mö‹
 (dev)

	)

67 
	#makedev
(
maj
, 
mö
Ë
	`gnu_dev_makedev
 (maj, mö)

	)

	@/usr/include/time.h

23 #i‚def 
_TIME_H


25 #i‡(! 
deföed
 
__√ed_time_t
 && !deföed 
__√ed_˛ock_t
 && \

26 ! 
deföed
 
	g__√ed_time•ec
)

27 
	#_TIME_H
 1

	)

28 
	~<„©uªs.h
>

30 
	g__BEGIN_DECLS


34 #ifdef 
_TIME_H


36 
	#__√ed_size_t


	)

37 
	#__√ed_NULL


	)

38 
	~<°ddef.h
>

42 
	~<bôs/time.h
>

45 #i‡!
deföed
 
__STRICT_ANSI__
 && !deföed 
__USE_XOPEN2K


46 #i‚de‡
CLK_TCK


47 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

53 #i‡!
deföed
 
__˛ock_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_˛ock_t
)

54 
	#__˛ock_t_deföed
 1

	)

56 
	~<bôs/ty≥s.h
>

58 
__BEGIN_NAMESPACE_STD


60 
__˛ock_t
 
	t˛ock_t
;

61 
	g__END_NAMESPACE_STD


62 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


63 
	$__USING_NAMESPACE_STD
(
˛ock_t
)

67 #unde‡
__√ed_˛ock_t


69 #i‡!
deföed
 
__time_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_time_t
)

70 
	#__time_t_deföed
 1

	)

72 
	~<bôs/ty≥s.h
>

74 
__BEGIN_NAMESPACE_STD


76 
__time_t
 
	ttime_t
;

77 
__END_NAMESPACE_STD


78 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC
 || deföed 
__USE_SVID


79 
	$__USING_NAMESPACE_STD
(
time_t
)

83 #unde‡
__√ed_time_t


85 #i‡!
deföed
 
__˛ockid_t_deföed
 && \

86 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_˛ockid_t
)

87 
	#__˛ockid_t_deföed
 1

	)

89 
	~<bôs/ty≥s.h
>

92 
__˛ockid_t
 
	t˛ockid_t
;

95 #unde‡
__˛ockid_time_t


97 #i‡!
deföed
 
__timî_t_deföed
 && \

98 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_timî_t
)

99 
	#__timî_t_deföed
 1

	)

101 
	~<bôs/ty≥s.h
>

104 
__timî_t
 
	ttimî_t
;

107 #unde‡
__√ed_timî_t


110 #i‡!
deföed
 
__time•ec_deföed
 && \

111 ((
deföed
 
_TIME_H
 && \

112 (
deföed
 
__USE_POSIX199309
 || deföed 
__USE_MISC
)) || \

113 
deföed
 
__√ed_time•ec
)

114 
	#__time•ec_deföed
 1

	)

116 
	~<bôs/ty≥s.h
>

120 
	stime•ec


122 
__time_t
 
tv_£c
;

123 
tv_n£c
;

127 #unde‡
__√ed_time•ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mö
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_m⁄
;

140 
tm_yór
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd°
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 
__c⁄°
 *
tm_z⁄e
;

149 
__tm_gmtoff
;

150 
__c⁄°
 *
__tm_z⁄e
;

153 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifde‡
__USE_POSIX199309


161 
	sôimî•ec


163 
time•ec
 
ô_öãrvÆ
;

164 
time•ec
 
ô_vÆue
;

168 
sigevít
;

172 #ifde‡
__USE_XOPEN2K


173 #i‚de‡
__pid_t_deföed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_deföed


	)

180 
__BEGIN_NAMESPACE_STD


183 
˛ock_t
 
	$˛ock
 (Ë
__THROW
;

186 
time_t
 
	$time
 (
time_t
 *
__timî
Ë
__THROW
;

189 
	$dif·ime
 (
time_t
 
__time1
,Åime_à
__time0
)

190 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

193 
time_t
 
	$mktime
 (
tm
 *
__ç
Ë
__THROW
;

199 
size_t
 
	$°r·ime
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

200 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

201 
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

202 
__END_NAMESPACE_STD


204 #ifde‡
__USE_XOPEN


207 *
	$°Ωtime
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

208 
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
)

209 
__THROW
;

212 #ifde‡
__USE_XOPEN2K8


215 
	~<xloˇÀ.h
>

217 
size_t
 
	$°r·ime_l
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

218 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

219 
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
,

220 
__loˇÀ_t
 
__loc
Ë
__THROW
;

223 #ifde‡
__USE_GNU


224 *
	$°Ωtime_l
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

225 
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
,

226 
__loˇÀ_t
 
__loc
Ë
__THROW
;

230 
__BEGIN_NAMESPACE_STD


233 
tm
 *
	$gmtime
 (
__c⁄°
 
time_t
 *
__timî
Ë
__THROW
;

237 
tm
 *
	$loˇ…ime
 (
__c⁄°
 
time_t
 *
__timî
Ë
__THROW
;

238 
__END_NAMESPACE_STD


240 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


243 
tm
 *
	$gmtime_r
 (
__c⁄°
 
time_t
 *
__ª°ri˘
 
__timî
,

244 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

248 
tm
 *
	$loˇ…ime_r
 (
__c⁄°
 
time_t
 *
__ª°ri˘
 
__timî
,

249 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

252 
__BEGIN_NAMESPACE_STD


255 *
	$as˘ime
 (
__c⁄°
 
tm
 *
__ç
Ë
__THROW
;

258 *
	$˘ime
 (
__c⁄°
 
time_t
 *
__timî
Ë
__THROW
;

259 
__END_NAMESPACE_STD


261 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


266 *
	$as˘ime_r
 (
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
,

267 *
__ª°ri˘
 
__buf
Ë
__THROW
;

270 *
	$˘ime_r
 (
__c⁄°
 
time_t
 *
__ª°ri˘
 
__timî
,

271 *
__ª°ri˘
 
__buf
Ë
__THROW
;

276 *
__tz«me
[2];

277 
__daylight
;

278 
__timez⁄e
;

281 #ifdef 
__USE_POSIX


283 *
tz«me
[2];

287 
	$tz£t
 (Ë
__THROW
;

290 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


291 
daylight
;

292 
timez⁄e
;

295 #ifde‡
__USE_SVID


298 
	$°ime
 (
__c⁄°
 
time_t
 *
__whí
Ë
__THROW
;

304 
	#__i¶óp
(
yór
) \

305 ((
yór
Ë% 4 =0 && ((yórË% 100 !0 || (yórË% 400 =0))

	)

308 #ifde‡
__USE_MISC


313 
time_t
 
	$timegm
 (
tm
 *
__ç
Ë
__THROW
;

316 
time_t
 
	$timñoˇl
 (
tm
 *
__ç
Ë
__THROW
;

319 
	$dysize
 (
__yór
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

323 #ifde‡
__USE_POSIX199309


328 
	`«no¶ìp
 (
__c⁄°
 
time•ec
 *
__ªque°ed_time
,

329 
time•ec
 *
__ªmaöög
);

333 
	$˛ock_gëªs
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ªs
Ë
__THROW
;

336 
	$˛ock_gëtime
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ç
Ë
__THROW
;

339 
	$˛ock_£âime
 (
˛ockid_t
 
__˛ock_id
, 
__c⁄°
 
time•ec
 *
__ç
)

340 
__THROW
;

342 #ifde‡
__USE_XOPEN2K


347 
	`˛ock_«no¶ìp
 (
˛ockid_t
 
__˛ock_id
, 
__Êags
,

348 
__c⁄°
 
time•ec
 *
__ªq
,

349 
time•ec
 *
__ªm
);

352 
	$˛ock_gë˝u˛ockid
 (
pid_t
 
__pid
, 
˛ockid_t
 *
__˛ock_id
Ë
__THROW
;

357 
	$timî_¸óã
 (
˛ockid_t
 
__˛ock_id
,

358 
sigevít
 *
__ª°ri˘
 
__evp
,

359 
timî_t
 *
__ª°ri˘
 
__timîid
Ë
__THROW
;

362 
	$timî_dñëe
 (
timî_t
 
__timîid
Ë
__THROW
;

365 
	$timî_£âime
 (
timî_t
 
__timîid
, 
__Êags
,

366 
__c⁄°
 
ôimî•ec
 *
__ª°ri˘
 
__vÆue
,

367 
ôimî•ec
 *
__ª°ri˘
 
__ovÆue
Ë
__THROW
;

370 
	$timî_gëtime
 (
timî_t
 
__timîid
, 
ôimî•ec
 *
__vÆue
)

371 
__THROW
;

374 
	$timî_gëovîrun
 (
timî_t
 
__timîid
Ë
__THROW
;

378 #ifde‡
__USE_XOPEN_EXTENDED


390 
gëd©e_îr
;

399 
tm
 *
	`gëd©e
 (
__c⁄°
 *
__°rög
);

402 #ifde‡
__USE_GNU


413 
	`gëd©e_r
 (
__c⁄°
 *
__ª°ri˘
 
__°rög
,

414 
tm
 *
__ª°ri˘
 
__ªsbuÂ
);

417 
__END_DECLS


	@/usr/include/asm-generic/errno-base.h

1 #i‚de‡
_ASM_GENERIC_ERRNO_BASE_H


2 
	#_ASM_GENERIC_ERRNO_BASE_H


	)

4 
	#EPERM
 1

	)

5 
	#ENOENT
 2

	)

6 
	#ESRCH
 3

	)

7 
	#EINTR
 4

	)

8 
	#EIO
 5

	)

9 
	#ENXIO
 6

	)

10 
	#E2BIG
 7

	)

11 
	#ENOEXEC
 8

	)

12 
	#EBADF
 9

	)

13 
	#ECHILD
 10

	)

14 
	#EAGAIN
 11

	)

15 
	#ENOMEM
 12

	)

16 
	#EACCES
 13

	)

17 
	#EFAULT
 14

	)

18 
	#ENOTBLK
 15

	)

19 
	#EBUSY
 16

	)

20 
	#EEXIST
 17

	)

21 
	#EXDEV
 18

	)

22 
	#ENODEV
 19

	)

23 
	#ENOTDIR
 20

	)

24 
	#EISDIR
 21

	)

25 
	#EINVAL
 22

	)

26 
	#ENFILE
 23

	)

27 
	#EMFILE
 24

	)

28 
	#ENOTTY
 25

	)

29 
	#ETXTBSY
 26

	)

30 
	#EFBIG
 27

	)

31 
	#ENOSPC
 28

	)

32 
	#ESPIPE
 29

	)

33 
	#EROFS
 30

	)

34 
	#EMLINK
 31

	)

35 
	#EPIPE
 32

	)

36 
	#EDOM
 33

	)

37 
	#ERANGE
 34

	)

	@/usr/include/asm-generic/ioctls.h

1 #i‚de‡
__ASM_GENERIC_IOCTLS_H


2 
	#__ASM_GENERIC_IOCTLS_H


	)

4 
	~<löux/io˘l.h
>

19 
	#TCGETS
 0x5401

	)

20 
	#TCSETS
 0x5402

	)

21 
	#TCSETSW
 0x5403

	)

22 
	#TCSETSF
 0x5404

	)

23 
	#TCGETA
 0x5405

	)

24 
	#TCSETA
 0x5406

	)

25 
	#TCSETAW
 0x5407

	)

26 
	#TCSETAF
 0x5408

	)

27 
	#TCSBRK
 0x5409

	)

28 
	#TCXONC
 0x540A

	)

29 
	#TCFLSH
 0x540B

	)

30 
	#TIOCEXCL
 0x540C

	)

31 
	#TIOCNXCL
 0x540D

	)

32 
	#TIOCSCTTY
 0x540E

	)

33 
	#TIOCGPGRP
 0x540F

	)

34 
	#TIOCSPGRP
 0x5410

	)

35 
	#TIOCOUTQ
 0x5411

	)

36 
	#TIOCSTI
 0x5412

	)

37 
	#TIOCGWINSZ
 0x5413

	)

38 
	#TIOCSWINSZ
 0x5414

	)

39 
	#TIOCMGET
 0x5415

	)

40 
	#TIOCMBIS
 0x5416

	)

41 
	#TIOCMBIC
 0x5417

	)

42 
	#TIOCMSET
 0x5418

	)

43 
	#TIOCGSOFTCAR
 0x5419

	)

44 
	#TIOCSSOFTCAR
 0x541A

	)

45 
	#FIONREAD
 0x541B

	)

46 
	#TIOCINQ
 
FIONREAD


	)

47 
	#TIOCLINUX
 0x541C

	)

48 
	#TIOCCONS
 0x541D

	)

49 
	#TIOCGSERIAL
 0x541E

	)

50 
	#TIOCSSERIAL
 0x541F

	)

51 
	#TIOCPKT
 0x5420

	)

52 
	#FIONBIO
 0x5421

	)

53 
	#TIOCNOTTY
 0x5422

	)

54 
	#TIOCSETD
 0x5423

	)

55 
	#TIOCGETD
 0x5424

	)

56 
	#TCSBRKP
 0x5425

	)

57 
	#TIOCSBRK
 0x5427

	)

58 
	#TIOCCBRK
 0x5428

	)

59 
	#TIOCGSID
 0x5429

	)

60 
	#TCGETS2
 
	`_IOR
('T', 0x2A, 
ãrmios2
)

	)

61 
	#TCSETS2
 
	`_IOW
('T', 0x2B, 
ãrmios2
)

	)

62 
	#TCSETSW2
 
	`_IOW
('T', 0x2C, 
ãrmios2
)

	)

63 
	#TCSETSF2
 
	`_IOW
('T', 0x2D, 
ãrmios2
)

	)

64 
	#TIOCGRS485
 0x542E

	)

65 
	#TIOCSRS485
 0x542F

	)

66 
	#TIOCGPTN
 
	`_IOR
('T', 0x30, Ë

	)

67 
	#TIOCSPTLCK
 
	`_IOW
('T', 0x31, Ë

	)

68 
	#TCGETX
 0x5432

	)

69 
	#TCSETX
 0x5433

	)

70 
	#TCSETXF
 0x5434

	)

71 
	#TCSETXW
 0x5435

	)

73 
	#FIONCLEX
 0x5450

	)

74 
	#FIOCLEX
 0x5451

	)

75 
	#FIOASYNC
 0x5452

	)

76 
	#TIOCSERCONFIG
 0x5453

	)

77 
	#TIOCSERGWILD
 0x5454

	)

78 
	#TIOCSERSWILD
 0x5455

	)

79 
	#TIOCGLCKTRMIOS
 0x5456

	)

80 
	#TIOCSLCKTRMIOS
 0x5457

	)

81 
	#TIOCSERGSTRUCT
 0x5458

	)

82 
	#TIOCSERGETLSR
 0x5459

	)

83 
	#TIOCSERGETMULTI
 0x545A

	)

84 
	#TIOCSERSETMULTI
 0x545B

	)

86 
	#TIOCMIWAIT
 0x545C

	)

87 
	#TIOCGICOUNT
 0x545D

	)

93 #i‚de‡
FIOQSIZE


94 
	#TIOCGHAYESESP
 0x545E

	)

95 
	#TIOCSHAYESESP
 0x545F

	)

96 
	#FIOQSIZE
 0x5460

	)

100 
	#TIOCPKT_DATA
 0

	)

101 
	#TIOCPKT_FLUSHREAD
 1

	)

102 
	#TIOCPKT_FLUSHWRITE
 2

	)

103 
	#TIOCPKT_STOP
 4

	)

104 
	#TIOCPKT_START
 8

	)

105 
	#TIOCPKT_NOSTOP
 16

	)

106 
	#TIOCPKT_DOSTOP
 32

	)

108 
	#TIOCSER_TEMT
 0x01

	)

	@/usr/include/asm-generic/socket.h

1 #i‚de‡
__ASM_GENERIC_SOCKET_H


2 
	#__ASM_GENERIC_SOCKET_H


	)

4 
	~<asm/sockios.h
>

7 
	#SOL_SOCKET
 1

	)

9 
	#SO_DEBUG
 1

	)

10 
	#SO_REUSEADDR
 2

	)

11 
	#SO_TYPE
 3

	)

12 
	#SO_ERROR
 4

	)

13 
	#SO_DONTROUTE
 5

	)

14 
	#SO_BROADCAST
 6

	)

15 
	#SO_SNDBUF
 7

	)

16 
	#SO_RCVBUF
 8

	)

17 
	#SO_SNDBUFFORCE
 32

	)

18 
	#SO_RCVBUFFORCE
 33

	)

19 
	#SO_KEEPALIVE
 9

	)

20 
	#SO_OOBINLINE
 10

	)

21 
	#SO_NO_CHECK
 11

	)

22 
	#SO_PRIORITY
 12

	)

23 
	#SO_LINGER
 13

	)

24 
	#SO_BSDCOMPAT
 14

	)

27 #i‚de‡
SO_PASSCRED


28 
	#SO_PASSCRED
 16

	)

29 
	#SO_PEERCRED
 17

	)

30 
	#SO_RCVLOWAT
 18

	)

31 
	#SO_SNDLOWAT
 19

	)

32 
	#SO_RCVTIMEO
 20

	)

33 
	#SO_SNDTIMEO
 21

	)

37 
	#SO_SECURITY_AUTHENTICATION
 22

	)

38 
	#SO_SECURITY_ENCRYPTION_TRANSPORT
 23

	)

39 
	#SO_SECURITY_ENCRYPTION_NETWORK
 24

	)

41 
	#SO_BINDTODEVICE
 25

	)

44 
	#SO_ATTACH_FILTER
 26

	)

45 
	#SO_DETACH_FILTER
 27

	)

47 
	#SO_PEERNAME
 28

	)

48 
	#SO_TIMESTAMP
 29

	)

49 
	#SCM_TIMESTAMP
 
SO_TIMESTAMP


	)

51 
	#SO_ACCEPTCONN
 30

	)

53 
	#SO_PEERSEC
 31

	)

54 
	#SO_PASSSEC
 34

	)

55 
	#SO_TIMESTAMPNS
 35

	)

56 
	#SCM_TIMESTAMPNS
 
SO_TIMESTAMPNS


	)

58 
	#SO_MARK
 36

	)

60 
	#SO_TIMESTAMPING
 37

	)

61 
	#SCM_TIMESTAMPING
 
SO_TIMESTAMPING


	)

63 
	#SO_PROTOCOL
 38

	)

64 
	#SO_DOMAIN
 39

	)

	@/usr/include/asm-generic/types.h

1 #i‚de‡
_ASM_GENERIC_TYPES_H


2 
	#_ASM_GENERIC_TYPES_H


	)

7 
	~<asm-gíîic/öt-Œ64.h
>

9 #i‚de‡
__ASSEMBLY__


11 
	tumode_t
;

	@/usr/include/asm/posix_types.h

1 #ifde‡
__i386__


2 
	~"posix_ty≥s_32.h
"

4 
	~"posix_ty≥s_64.h
"

	@/usr/include/bits/byteswap.h

21 #i‡!
deföed
 
_BYTESWAP_H
 && !deföed 
_NETINET_IN_H
 && !deföed 
_ENDIAN_H


25 #i‚de‡
_BITS_BYTESWAP_H


26 
	#_BITS_BYTESWAP_H
 1

	)

28 
	~<bôs/w‹dsize.h
>

31 
	#__bsw≠_c⁄°™t_16
(
x
) \

32 ((((
x
Ë>> 8Ë& 0xffË| (((xË& 0xffË<< 8))

	)

34 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

35 
	#__bsw≠_16
(
x
) \

36 (
__exãnsi⁄__
 \

37 ({ 
__v
, 
__x
 = (
x
); \

38 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

39 
__v
 = 
	`__bsw≠_c⁄°™t_16
 (
__x
); \

41 
	`__asm__
 ("rorw $8, %w0" \

42 : "Ù" (
__v
) \

43 : "0" (
__x
) \

45 
__v
; }))

	)

48 
	#__bsw≠_16
(
x
) \

49 (
__exãnsi⁄__
 \

50 ({ 
__x
 = (
x
); 
	`__bsw≠_c⁄°™t_16
 (__x); }))

	)

55 
	#__bsw≠_c⁄°™t_32
(
x
) \

56 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

57 (((
x
Ë& 0x0000ff00Ë<< 8Ë| (((xË& 0x000000ffË<< 24))

	)

59 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

60 #i‡
__WORDSIZE
 =64 || (
deföed
 
__i486__
 || deföed 
__≥¡ium__
 \

61 || 
deföed
 
	g__≥¡ium¥o__
 || deföed 
	g__≥¡ium4__
 \

62 || 
deföed
 
	g__k8__
 || deföed 
	g__©hl⁄__
 \

63 || 
deföed
 
	g__k6__
 || deföed 
	g__noc⁄a__
 \

64 || 
deföed
 
	g__c‹e2__
 || deföed 
	g__geode__
 \

65 || 
deföed
 
	g__amdÁm10__
)

68 
	#__bsw≠_32
(
x
) \

69 (
__exãnsi⁄__
 \

70 ({ 
__v
, 
__x
 = (
x
); \

71 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

72 
__v
 = 
	`__bsw≠_c⁄°™t_32
 (
__x
); \

74 
	`__asm__
 ("bsw≠ %0" : "Ù" (
__v
Ë: "0" (
__x
)); \

75 
__v
; }))

	)

77 
	#__bsw≠_32
(
x
) \

78 (
__exãnsi⁄__
 \

79 ({ 
__v
, 
__x
 = (
x
); \

80 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

81 
__v
 = 
	`__bsw≠_c⁄°™t_32
 (
__x
); \

83 
	`__asm__
 ("rorw $8, %w0;" \

86 : "Ù" (
__v
) \

87 : "0" (
__x
) \

89 
__v
; }))

	)

92 
	#__bsw≠_32
(
x
) \

93 (
__exãnsi⁄__
 \

94 ({ 
__x
 = (
x
); 
	`__bsw≠_c⁄°™t_32
 (__x); }))

	)

98 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

100 
	#__bsw≠_c⁄°™t_64
(
x
) \

101 ((((
x
) & 0xff00000000000000ull) >> 56) \

102 | (((
x
) & 0x00ff000000000000ull) >> 40) \

103 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

104 | (((
x
) & 0x000000ff00000000ull) >> 8) \

105 | (((
x
) & 0x00000000ff000000ull) << 8) \

106 | (((
x
) & 0x0000000000ff0000ull) << 24) \

107 | (((
x
) & 0x000000000000ff00ull) << 40) \

108 | (((
x
Ë& 0x00000000000000ffuŒË<< 56))

	)

110 #i‡
__WORDSIZE
 == 64

111 
	#__bsw≠_64
(
x
) \

112 (
__exãnsi⁄__
 \

113 ({ 
__v
, 
__x
 = (
x
); \

114 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

115 
__v
 = 
	`__bsw≠_c⁄°™t_64
 (
__x
); \

117 
	`__asm__
 ("bsw≠ %q0" : "Ù" (
__v
Ë: "0" (
__x
)); \

118 
__v
; }))

	)

120 
	#__bsw≠_64
(
x
) \

121 (
__exãnsi⁄__
 \

122 ({ uni⁄ { 
__exãnsi⁄__
 
__Œ
; \

123 
__l
[2]; } 
__w
, 
__r
; \

124 i‡(
	`__buûtö_c⁄°™t_p
 (
x
)) \

125 
__r
.
__Œ
 = 
	`__bsw≠_c⁄°™t_64
 (
x
); \

128 
__w
.
__Œ
 = (
x
); \

129 
__r
.
__l
[0] = 
	`__bsw≠_32
 (
__w
.__l[1]); \

130 
__r
.
__l
[1] = 
	`__bsw≠_32
 (
__w
.__l[0]); \

132 
__r
.
__Œ
; }))

	)

	@/usr/include/bits/endian.h

3 #i‚de‡
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/libc-lock.h

20 #i‚de‡
_BITS_LIBC_LOCK_H


21 
	#_BITS_LIBC_LOCK_H
 1

	)

23 
	~<±hªad.h
>

24 
	#__√ed_NULL


	)

25 
	~<°ddef.h
>

34 #ifde‡
_LIBC


35 
	~<lowÀvñlock.h
>

36 
	~<és.h
>

37 
	~<±hªad-fun˘i⁄s.h
>

38 
	~<î∫o.h
>

39 
	~<gnu/›ti⁄-groups.h
>

43 #i‡
deföed
 
_LIBC
 || deföed 
_IO_MTSAFE_IO


44 #i‡(
deföed
 
NOT_IN_libc
 && !deföed 
IS_IN_lib±hªad
Ë|| !deföed 
_LIBC


45 
±hªad_muãx_t
 
	t__libc_lock_t
;

46 °ru˘ { 
±hªad_muãx_t
 
	mmuãx
; } 
	t__libc_lock_ªcursive_t
;

48 
	t__libc_lock_t
;

49 °ru˘ { 
	mlock
; 
	m˙t
; *
	mow√r
; } 
	t__libc_lock_ªcursive_t
;

51 °ru˘ { 
±hªad_muãx_t
 
	mmuãx
; } 
	t__πld_lock_ªcursive_t
;

52 #ifde‡
__USE_UNIX98


53 
±hªad_rwlock_t
 
	t__libc_rwlock_t
;

55 
__libc_rwlock_›aque__
 
	t__libc_rwlock_t
;

58 
__libc_lock_›aque__
 
	t__libc_lock_t
;

59 
__libc_lock_ªcursive_›aque__
 
	t__libc_lock_ªcursive_t
;

60 
__libc_rwlock_›aque__
 
	t__libc_rwlock_t
;

64 
±hªad_key_t
 
	t__libc_key_t
;

73 
	#__libc_lock_deföe
(
CLASS
,
NAME
) \

74 
CLASS
 
__libc_lock_t
 
NAME
;

	)

75 
	#__libc_rwlock_deföe
(
CLASS
,
NAME
) \

76 
CLASS
 
__libc_rwlock_t
 
NAME
;

	)

77 
	#__libc_lock_deföe_ªcursive
(
CLASS
,
NAME
) \

78 
CLASS
 
__libc_lock_ªcursive_t
 
NAME
;

	)

79 
	#__πld_lock_deföe_ªcursive
(
CLASS
,
NAME
) \

80 
CLASS
 
__πld_lock_ªcursive_t
 
NAME
;

	)

91 #i‡
deföed
 
_LIBC
 && (!deföed 
NOT_IN_libc
 || deföed 
IS_IN_lib±hªad
)

92 #i‡
LLL_LOCK_INITIALIZER
 == 0

93 
	#__libc_lock_deföe_öôülized
(
CLASS
,
NAME
) \

94 
CLASS
 
__libc_lock_t
 
NAME
;

	)

96 
	#__libc_lock_deföe_öôülized
(
CLASS
,
NAME
) \

97 
CLASS
 
__libc_lock_t
 
NAME
 = 
LLL_LOCK_INITIALIZER
;

	)

100 #i‡
__LT_SPINLOCK_INIT
 == 0

101 
	#__libc_lock_deföe_öôülized
(
CLASS
,
NAME
) \

102 
CLASS
 
__libc_lock_t
 
NAME
;

	)

104 
	#__libc_lock_deföe_öôülized
(
CLASS
,
NAME
) \

105 
CLASS
 
__libc_lock_t
 
NAME
 = 
PTHREAD_MUTEX_INITIALIZER
;

	)

109 
	#__libc_rwlock_deföe_öôülized
(
CLASS
,
NAME
) \

110 
CLASS
 
__libc_rwlock_t
 
NAME
 = 
PTHREAD_RWLOCK_INITIALIZER
;

	)

114 #i‡
deföed
 
_LIBC
 && (!deföed 
NOT_IN_libc
 || deföed 
IS_IN_lib±hªad
)

115 #i‡
LLL_LOCK_INITIALIZER
 == 0

116 
	#__libc_lock_deföe_öôülized_ªcursive
(
CLASS
,
NAME
) \

117 
CLASS
 
__libc_lock_ªcursive_t
 
NAME
;

	)

119 
	#__libc_lock_deföe_öôülized_ªcursive
(
CLASS
,
NAME
) \

120 
CLASS
 
__libc_lock_ªcursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

122 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

123 { 
LLL_LOCK_INITIALIZER
, 0, 
NULL
 }

	)

125 
	#__libc_lock_deföe_öôülized_ªcursive
(
CLASS
,
NAME
) \

126 
CLASS
 
__libc_lock_ªcursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

127 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

128 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

131 
	#__πld_lock_deföe_öôülized_ªcursive
(
CLASS
,
NAME
) \

132 
CLASS
 
__πld_lock_ªcursive_t
 
NAME
 = 
_RTLD_LOCK_RECURSIVE_INITIALIZER
;

	)

133 
	#_RTLD_LOCK_RECURSIVE_INITIALIZER
 \

134 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

136 
	#__πld_lock_öôülize
(
NAME
) \

137 (Ë((
NAME
Ë(
__πld_lock_ªcursive_t
Ë
_RTLD_LOCK_RECURSIVE_INITIALIZER
)

	)

144 #ifde‡
__PIC__


145 
	#__libc_maybe_ˇŒ
(
FUNC
, 
ARGS
, 
ELSE
) \

146 (
	`__exãnsi⁄__
 ({ 
	`__ty≥of
 (
FUNC
Ë*
_‚
 = (FUNC); \

147 
_‚
 !
NULL
 ? (*_‚Ë
ARGS
 : 
ELSE
; }))

	)

149 
	#__libc_maybe_ˇŒ
(
FUNC
, 
ARGS
, 
ELSE
) \

150 (
FUNC
 !
NULL
 ? FUNC 
ARGS
 : 
ELSE
)

	)

154 #i‡
deföed
 
SHARED
 && !deföed 
NOT_IN_libc


155 
	#PTFAVAIL
(
NAME
Ë
__libc_±hªad_fun˘i⁄s_öô


	)

156 
	#__libc_±f_ˇŒ
(
FUNC
, 
ARGS
, 
ELSE
) \

157 (
__libc_±hªad_fun˘i⁄s_öô
 ? 
	`PTHFCT_CALL
 (
±r_
##
FUNC
, 
ARGS
Ë: 
ELSE
)

	)

158 
	#__libc_±f_ˇŒ_Æways
(
FUNC
, 
ARGS
) \

159 
	`PTHFCT_CALL
 (
±r_
##
FUNC
, 
ARGS
)

	)

161 
	#PTFAVAIL
(
NAME
Ë(NAME !
NULL
)

	)

162 
	#__libc_±f_ˇŒ
(
FUNC
, 
ARGS
, 
ELSE
) \

163 
	`__libc_maybe_ˇŒ
 (
FUNC
, 
ARGS
, 
ELSE
)

	)

164 
	#__libc_±f_ˇŒ_Æways
(
FUNC
, 
ARGS
) \

165 
FUNC
 
ARGS


	)

171 #i‡
deföed
 
_LIBC
 && (!deföed 
NOT_IN_libc
 || deföed 
IS_IN_lib±hªad
)

172 
	#__libc_lock_öô
(
NAME
Ë((NAMEË
LLL_LOCK_INITIALIZER
, 0)

	)

174 
	#__libc_lock_öô
(
NAME
) \

175 
	`__libc_maybe_ˇŒ
 (
__±hªad_muãx_öô
, (&(
NAME
), 
NULL
), 0)

	)

177 #i‡
deföed
 
SHARED
 && !deföed 
NOT_IN_libc


180 
	#__libc_rwlock_öô
(
NAME
) \

181 (
	`__buûtö_mem£t
 (&(
NAME
), '\0',  (NAME)), 0)

	)

183 
	#__libc_rwlock_öô
(
NAME
) \

184 
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_öô
, (&(
NAME
), 
NULL
), 0)

	)

188 #i‡
deföed
 
_LIBC
 && (!deföed 
NOT_IN_libc
 || deföed 
IS_IN_lib±hªad
)

189 
	#__libc_lock_öô_ªcursive
(
NAME
) \

190 ((
NAME
Ë(
__libc_lock_ªcursive_t
Ë
_LIBC_LOCK_RECURSIVE_INITIALIZER
, 0)

	)

192 
	#__libc_lock_öô_ªcursive
(
NAME
) \

194 i‡(
__±hªad_muãx_öô
 !
NULL
) \

196 
±hªad_muãx©å_t
 
__©å
; \

197 
	`__±hªad_muãx©å_öô
 (&
__©å
); \

198 
	`__±hªad_muãx©å_£ây≥
 (&
__©å
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

199 
	`__±hªad_muãx_öô
 (&(
NAME
).
muãx
, &
__©å
); \

200 
	`__±hªad_muãx©å_de°roy
 (&
__©å
); \

202 } 0)

	)

205 
	#__πld_lock_öô_ªcursive
(
NAME
) \

207 i‡(
__±hªad_muãx_öô
 !
NULL
) \

209 
±hªad_muãx©å_t
 
__©å
; \

210 
	`__±hªad_muãx©å_öô
 (&
__©å
); \

211 
	`__±hªad_muãx©å_£ây≥
 (&
__©å
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

212 
	`__±hªad_muãx_öô
 (&(
NAME
).
muãx
, &
__©å
); \

213 
	`__±hªad_muãx©å_de°roy
 (&
__©å
); \

215 } 0)

	)

220 #i‡
deföed
 
_LIBC
 && (!deföed 
NOT_IN_libc
 || deföed 
IS_IN_lib±hªad
)

221 
	#__libc_lock_föi
(
NAME
Ë((Ë0)

	)

223 
	#__libc_lock_föi
(
NAME
) \

224 
	`__libc_maybe_ˇŒ
 (
__±hªad_muãx_de°roy
, (&(
NAME
)), 0)

	)

226 #i‡
deföed
 
SHARED
 && !deföed 
NOT_IN_libc


227 
	#__libc_rwlock_föi
(
NAME
Ë((Ë0)

	)

229 
	#__libc_rwlock_föi
(
NAME
) \

230 
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_de°roy
, (&(
NAME
)), 0)

	)

234 #i‡
deföed
 
_LIBC
 && (!deföed 
NOT_IN_libc
 || deföed 
IS_IN_lib±hªad
)

235 
	#__libc_lock_föi_ªcursive
(
NAME
Ë((Ë0)

	)

237 
	#__libc_lock_föi_ªcursive
(
NAME
) \

238 
	`__libc_maybe_ˇŒ
 (
__±hªad_muãx_de°roy
, (&(
NAME
)), 0)

	)

242 #i‡
deföed
 
_LIBC
 && (!deföed 
NOT_IN_libc
 || deföed 
IS_IN_lib±hªad
)

243 #i‡
__OPTION_EGLIBC_BIG_MACROS
 != 1

247 
__libc_lock_lock_‚
 (
__libc_lock_t
 *);

248 
libc_hiddí_¥Ÿo
 (
__libc_lock_lock_‚
);

250 #i‡
__OPTION_EGLIBC_BIG_MACROS


251 
	#__libc_lock_lock
(
NAME
) \

252 ({ 
	`Œl_lock
 (
NAME
, 
LLL_PRIVATE
); 0; })

	)

254 
	#__libc_lock_lock
(
NAME
) \

255 
	`__libc_lock_lock_‚
 (&(
NAME
))

	)

258 
	#__libc_lock_lock
(
NAME
) \

259 
	`__libc_maybe_ˇŒ
 (
__±hªad_muãx_lock
, (&(
NAME
)), 0)

	)

261 
	#__libc_rwlock_rdlock
(
NAME
) \

262 
	`__libc_±f_ˇŒ
 (
__±hªad_rwlock_rdlock
, (&(
NAME
)), 0)

	)

263 
	#__libc_rwlock_wæock
(
NAME
) \

264 
	`__libc_±f_ˇŒ
 (
__±hªad_rwlock_wæock
, (&(
NAME
)), 0)

	)

267 #i‡
deföed
 
_LIBC
 && (!deföed 
NOT_IN_libc
 || deföed 
IS_IN_lib±hªad
)

268 #i‡
__OPTION_EGLIBC_BIG_MACROS
 != 1

272 
__libc_lock_lock_ªcursive_‚
 (
__libc_lock_ªcursive_t
 *);

273 
libc_hiddí_¥Ÿo
 (
__libc_lock_lock_ªcursive_‚
);

275 #i‡
__OPTION_EGLIBC_BIG_MACROS


276 
	#__libc_lock_lock_ªcursive
(
NAME
) \

278 *
£lf
 = 
THREAD_SELF
; \

279 i‡((
NAME
).
ow√r
 !
£lf
) \

281 
	`Œl_lock
 ((
NAME
).
lock
, 
LLL_PRIVATE
); \

282 (
NAME
).
ow√r
 = 
£lf
; \

284 ++(
NAME
).
˙t
; \

285 } 0)

	)

287 
	#__libc_lock_lock_ªcursive
(
NAME
) \

288 
	`__libc_lock_lock_ªcursive_‚
 (&(
NAME
))

	)

291 
	#__libc_lock_lock_ªcursive
(
NAME
) \

292 
	`__libc_maybe_ˇŒ
 (
__±hªad_muãx_lock
, (&(
NAME
).
muãx
), 0)

	)

296 #i‡
deföed
 
_LIBC
 && (!deföed 
NOT_IN_libc
 || deföed 
IS_IN_lib±hªad
)

297 #i‡
__OPTION_EGLIBC_BIG_MACROS
 != 1

301 
__libc_lock_åylock_‚
 (
__libc_lock_t
 *);

302 
libc_hiddí_¥Ÿo
 (
__libc_lock_åylock_‚
);

304 #i‡
__OPTION_EGLIBC_BIG_MACROS


305 
	#__libc_lock_åylock
(
NAME
) \

306 
	`Œl_åylock
 (
NAME
)

	)

308 
	#__libc_lock_åylock
(
NAME
) \

309 
	`__libc_lock_åylock_‚
 (&(
NAME
))

	)

312 
	#__libc_lock_åylock
(
NAME
) \

313 
	`__libc_maybe_ˇŒ
 (
__±hªad_muãx_åylock
, (&(
NAME
)), 0)

	)

315 
	#__libc_rwlock_åyrdlock
(
NAME
) \

316 
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_åyrdlock
, (&(
NAME
)), 0)

	)

317 
	#__libc_rwlock_åywæock
(
NAME
) \

318 
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_åywæock
, (&(
NAME
)), 0)

	)

321 #i‡
deföed
 
_LIBC
 && (!deföed 
NOT_IN_libc
 || deföed 
IS_IN_lib±hªad
)

322 #i‡
__OPTION_EGLIBC_BIG_MACROS
 != 1

326 
__libc_lock_åylock_ªcursive_‚
 (
__libc_lock_ªcursive_t
 *);

327 
libc_hiddí_¥Ÿo
 (
__libc_lock_åylock_ªcursive_‚
);

329 #i‡
__OPTION_EGLIBC_BIG_MACROS


330 
	#__libc_lock_åylock_ªcursive
(
NAME
) \

332 
ªsu…
 = 0; \

333 *
£lf
 = 
THREAD_SELF
; \

334 i‡((
NAME
).
ow√r
 !
£lf
) \

336 i‡(
	`Œl_åylock
 ((
NAME
).
lock
) == 0) \

338 (
NAME
).
ow√r
 = 
£lf
; \

339 (
NAME
).
˙t
 = 1; \

342 
ªsu…
 = 
EBUSY
; \

345 ++(
NAME
).
˙t
; \

346 
ªsu…
; \

347 })

	)

349 
	#__libc_lock_åylock_ªcursive
(
NAME
) \

350 
	`__libc_lock_åylock_ªcursive_‚
 (&(
NAME
))

	)

353 
	#__libc_lock_åylock_ªcursive
(
NAME
) \

354 
	`__libc_maybe_ˇŒ
 (
__±hªad_muãx_åylock
, (&(
NAME
)), 0)

	)

357 
	#__πld_lock_åylock_ªcursive
(
NAME
) \

358 
	`__libc_maybe_ˇŒ
 (
__±hªad_muãx_åylock
, (&(
NAME
).
muãx
), 0)

	)

361 #i‡
deföed
 
_LIBC
 && (!deföed 
NOT_IN_libc
 || deföed 
IS_IN_lib±hªad
)

362 #i‡
__OPTION_EGLIBC_BIG_MACROS
 != 1

366 
__libc_lock_u∆ock_‚
 (
__libc_lock_t
 *);

367 
libc_hiddí_¥Ÿo
 (
__libc_lock_u∆ock_‚
);

369 #i‡
__OPTION_EGLIBC_BIG_MACROS


370 
	#__libc_lock_u∆ock
(
NAME
) \

371 
	`Œl_u∆ock
 (
NAME
, 
LLL_PRIVATE
)

	)

373 
	#__libc_lock_u∆ock
(
NAME
) \

374 
	`__libc_lock_u∆ock_‚
 (&(
NAME
))

	)

377 
	#__libc_lock_u∆ock
(
NAME
) \

378 
	`__libc_maybe_ˇŒ
 (
__±hªad_muãx_u∆ock
, (&(
NAME
)), 0)

	)

380 
	#__libc_rwlock_u∆ock
(
NAME
) \

381 
	`__libc_±f_ˇŒ
 (
__±hªad_rwlock_u∆ock
, (&(
NAME
)), 0)

	)

384 #i‡
deföed
 
_LIBC
 && (!deföed 
NOT_IN_libc
 || deföed 
IS_IN_lib±hªad
)

385 #i‡
__OPTION_EGLIBC_BIG_MACROS
 != 1

389 
__libc_lock_u∆ock_ªcursive_‚
 (
__libc_lock_ªcursive_t
 *);

390 
libc_hiddí_¥Ÿo
 (
__libc_lock_u∆ock_ªcursive_‚
);

392 #i‡
__OPTION_EGLIBC_BIG_MACROS


394 
	#__libc_lock_u∆ock_ªcursive
(
NAME
) \

396 i‡(--(
NAME
).
˙t
 == 0) \

398 (
NAME
).
ow√r
 = 
NULL
; \

399 
	`Œl_u∆ock
 ((
NAME
).
lock
, 
LLL_PRIVATE
); \

401 } 0)

	)

403 
	#__libc_lock_u∆ock_ªcursive
(
NAME
) \

404 
	`__libc_lock_u∆ock_ªcursive_‚
 (&(
NAME
))

	)

407 
	#__libc_lock_u∆ock_ªcursive
(
NAME
) \

408 
	`__libc_maybe_ˇŒ
 (
__±hªad_muãx_u∆ock
, (&(
NAME
)), 0)

	)

411 #i‡
deföed
 
_LIBC
 && deföed 
SHARED


412 
	#__πld_lock_deÁu…_lock_ªcursive
(
lock
) \

413 ++((
±hªad_muãx_t
 *)(
lock
))->
__d©a
.
__cou¡
;

	)

415 
	#__πld_lock_deÁu…_u∆ock_ªcursive
(
lock
) \

416 --((
±hªad_muãx_t
 *)(
lock
))->
__d©a
.
__cou¡
;

	)

418 
	#__πld_lock_lock_ªcursive
(
NAME
) \

419 
	`GL
(
dl_πld_lock_ªcursive
Ë(&(
NAME
).
muãx
)

	)

421 
	#__πld_lock_u∆ock_ªcursive
(
NAME
) \

422 
	`GL
(
dl_πld_u∆ock_ªcursive
Ë(&(
NAME
).
muãx
)

	)

424 
	#__πld_lock_lock_ªcursive
(
NAME
) \

425 
	`__libc_maybe_ˇŒ
 (
__±hªad_muãx_lock
, (&(
NAME
).
muãx
), 0)

	)

427 
	#__πld_lock_u∆ock_ªcursive
(
NAME
) \

428 
	`__libc_maybe_ˇŒ
 (
__±hªad_muãx_u∆ock
, (&(
NAME
).
muãx
), 0)

	)

432 #i‡
PTHREAD_ONCE_INIT
 == 0

435 
	#__libc_⁄˚_deföe
(
CLASS
, 
NAME
) \

436 
CLASS
 
±hªad_⁄˚_t
 
NAME


	)

438 
	#__libc_⁄˚_deföe
(
CLASS
, 
NAME
) \

439 
CLASS
 
±hªad_⁄˚_t
 
NAME
 = 
PTHREAD_ONCE_INIT


	)

443 
	#__libc_⁄˚
(
ONCE_CONTROL
, 
INIT_FUNCTION
) \

445 i‡(
	`PTFAVAIL
 (
__±hªad_⁄˚
)) \

446 
	`__libc_±f_ˇŒ_Æways
 (
__±hªad_⁄˚
, (&(
ONCE_CONTROL
), \

447 
INIT_FUNCTION
)); \

448 i‡((
ONCE_CONTROL
Ë=
PTHREAD_ONCE_INIT
) { \

449 
	`INIT_FUNCTION
 (); \

450 (
ONCE_CONTROL
) |= 2; \

452 } 0)

	)

459 
_±hªad_˛ónup_push
 (
_±hªad_˛ónup_buf„r
 *
buf„r
,

460 (*
routöe
Ë(*), *
¨g
);

461 
	`_±hªad_˛ónup_p›
 (
_±hªad_˛ónup_buf„r
 *
buf„r
,

462 
execuã
);

463 
	`_±hªad_˛ónup_push_de„r
 (
_±hªad_˛ónup_buf„r
 *
buf„r
,

464 (*
routöe
Ë(*), *
¨g
);

465 
	`_±hªad_˛ónup_p›_ª°‹e
 (
_±hªad_˛ónup_buf„r
 *
buf„r
,

466 
execuã
);

469 
	#__libc_˛ónup_ªgi⁄_°¨t
(
DOIT
, 
FCT
, 
ARG
) \

470 { 
_±hªad_˛ónup_buf„r
 
_buf„r
; \

471 
_avaû
; \

472 i‡(
DOIT
) { \

473 
_avaû
 = 
	`PTFAVAIL
 (
_±hªad_˛ónup_push_de„r
); \

474 i‡(
_avaû
) { \

475 
	`__libc_±f_ˇŒ_Æways
 (
_±hªad_˛ónup_push_de„r
, (&
_buf„r
, 
FCT
, \

476 
ARG
)); \

478 
_buf„r
.
__routöe
 = (
FCT
); \

479 
_buf„r
.
__¨g
 = (
ARG
); \

482 
_avaû
 = 0; \

483 }

	)

486 
	#__libc_˛ónup_ªgi⁄_íd
(
DOIT
) \

487 i‡(
_avaû
) { \

488 
	`__libc_±f_ˇŒ_Æways
 (
_±hªad_˛ónup_p›_ª°‹e
, (&
_buf„r
, 
DOIT
));\

489 } i‡(
DOIT
) \

490 
_buf„r
.
	`__routöe
 (_buf„r.
__¨g
); \

491 
	}

	)
}

494 
	#__libc_˛ónup_íd
(
DOIT
) \

495 i‡(
_avaû
) { \

496 
	`__libc_±f_ˇŒ_Æways
 (
_±hªad_˛ónup_p›_ª°‹e
, (&
_buf„r
, 
DOIT
));\

497 } i‡(
DOIT
) \

498 
_buf„r
.
	`__routöe
 (_buf„r.
__¨g
)

	)

502 
__exã∫_ölöe
 

503 
	$__libc_˛ónup_routöe
 (
__±hªad_˛ónup_‰ame
 *
f
)

505 i‡(
f
->
__do_ô
)

506 
f
->
	`__ˇn˚l_routöe
 (f->
__ˇn˚l_¨g
);

507 
	}
}

509 
	#__libc_˛ónup_push
(
f˘
, 
¨g
) \

511 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

512 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__libc_˛ónup_routöe
))) \

513 { .
__ˇn˚l_routöe
 = (
f˘
), .
__ˇn˚l_¨g
 = (
¨g
), \

514 .
__do_ô
 = 1 };

	)

516 
	#__libc_˛ónup_p›
(
execuã
) \

517 
__˛‰ame
.
__do_ô
 = (
execuã
); \

518 } 0)

	)

522 
	#__libc_key_¸óã
(
KEY
, 
DESTRUCTOR
) \

523 
	`__libc_±f_ˇŒ
 (
__±hªad_key_¸óã
, (
KEY
, 
DESTRUCTOR
), 1)

	)

526 
	#__libc_gë•ecific
(
KEY
) \

527 
	`__libc_±f_ˇŒ
 (
__±hªad_gë•ecific
, (
KEY
), 
NULL
)

	)

530 
	#__libc_£t•ecific
(
KEY
, 
VALUE
) \

531 
	`__libc_±f_ˇŒ
 (
__±hªad_£t•ecific
, (
KEY
, 
VALUE
), 0)

	)

537 
	#__libc_©f‹k
(
PREPARE
, 
PARENT
, 
CHILD
) \

538 
	`__ªgi°î_©f‹k
 (
PREPARE
, 
PARENT
, 
CHILD
, 
NULL
)

	)

539 
__ªgi°î_©f‹k
 ((*
__¥ï¨e
) (),

540 (*
__∑ª¡
) (),

541 (*
__chûd
) (),

542 *
__dso_h™dÀ
);

547 
	`__±hªad_muãx_öô
 (
±hªad_muãx_t
 *
__muãx
,

548 
__c⁄°
 
±hªad_muãx©å_t
 *
__muãx_©å
);

550 
	`__±hªad_muãx_de°roy
 (
±hªad_muãx_t
 *
__muãx
);

552 
	`__±hªad_muãx_åylock
 (
±hªad_muãx_t
 *
__muãx
);

554 
	`__±hªad_muãx_lock
 (
±hªad_muãx_t
 *
__muãx
);

556 
	`__±hªad_muãx_u∆ock
 (
±hªad_muãx_t
 *
__muãx
);

558 
	`__±hªad_muãx©å_öô
 (
±hªad_muãx©å_t
 *
__©å
);

560 
	`__±hªad_muãx©å_de°roy
 (
±hªad_muãx©å_t
 *
__©å
);

562 
	`__±hªad_muãx©å_£ây≥
 (
±hªad_muãx©å_t
 *
__©å
,

563 
__köd
);

565 #ifde‡
__USE_UNIX98


566 
	`__±hªad_rwlock_öô
 (
±hªad_rwlock_t
 *
__rwlock
,

567 
__c⁄°
 
±hªad_rwlock©å_t
 *
__©å
);

569 
	`__±hªad_rwlock_de°roy
 (
±hªad_rwlock_t
 *
__rwlock
);

571 
	`__±hªad_rwlock_rdlock
 (
±hªad_rwlock_t
 *
__rwlock
);

573 
	`__±hªad_rwlock_åyrdlock
 (
±hªad_rwlock_t
 *
__rwlock
);

575 
	`__±hªad_rwlock_wæock
 (
±hªad_rwlock_t
 *
__rwlock
);

577 
	`__±hªad_rwlock_åywæock
 (
±hªad_rwlock_t
 *
__rwlock
);

579 
	`__±hªad_rwlock_u∆ock
 (
±hªad_rwlock_t
 *
__rwlock
);

582 
	`__±hªad_key_¸óã
 (
±hªad_key_t
 *
__key
,

583 (*
__de°r_fun˘i⁄
) (*));

585 
	`__±hªad_£t•ecific
 (
±hªad_key_t
 
__key
,

586 
__c⁄°
 *
__poöãr
);

588 *
	`__±hªad_gë•ecific
 (
±hªad_key_t
 
__key
);

590 
	`__±hªad_⁄˚
 (
±hªad_⁄˚_t
 *
__⁄˚_c⁄åﬁ
,

591 (*
__öô_routöe
) ());

593 
	`__±hªad_©f‹k
 ((*
__¥ï¨e
) (),

594 (*
__∑ª¡
) (),

595 (*
__chûd
) ());

601 #i‚de‡
__NO_WEAK_PTHREAD_ALIASES


602 #ifde‡
wók_exã∫


603 #i‡
_LIBC


604 
	~<bp-sym.h
>

606 
	#BP_SYM
(
sym
Ë
	)
sym

608 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx_öô
))

609 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx_de°roy
))

610 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx_lock
))

611 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx_åylock
))

612 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx_u∆ock
))

613 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx©å_öô
))

614 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx©å_de°roy
))

615 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx©å_£ây≥
))

616 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_rwlock_öô
))

617 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_rwlock_de°roy
))

618 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_rwlock_rdlock
))

619 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_rwlock_åyrdlock
))

620 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_rwlock_wæock
))

621 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_rwlock_åywæock
))

622 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_rwlock_u∆ock
))

623 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_key_¸óã
))

624 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_£t•ecific
))

625 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_gë•ecific
))

626 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_⁄˚
))

627 
	$wók_exã∫
 (
__±hªad_öôülize
)

628 
	$wók_exã∫
 (
__±hªad_©f‹k
)

629 
	`wók_exã∫
 (
	$BP_SYM
 (
_±hªad_˛ónup_push_de„r
))

630 
	`wók_exã∫
 (
	$BP_SYM
 (
_±hªad_˛ónup_p›_ª°‹e
))

631 
	`wók_exã∫
 (
	$BP_SYM
 (
±hªad_£tˇn˚l°©e
))

633 #¥agm®
wók
 
__±hªad_muãx_öô


634 #¥agm®
wók
 
__±hªad_muãx_de°roy


635 #¥agm®
wók
 
__±hªad_muãx_lock


636 #¥agm®
wók
 
__±hªad_muãx_åylock


637 #¥agm®
wók
 
__±hªad_muãx_u∆ock


638 #¥agm®
wók
 
__±hªad_muãx©å_öô


639 #¥agm®
wók
 
__±hªad_muãx©å_de°roy


640 #¥agm®
wók
 
__±hªad_muãx©å_£ây≥


641 #¥agm®
wók
 
__±hªad_rwlock_de°roy


642 #¥agm®
wók
 
__±hªad_rwlock_rdlock


643 #¥agm®
wók
 
__±hªad_rwlock_åyrdlock


644 #¥agm®
wók
 
__±hªad_rwlock_wæock


645 #¥agm®
wók
 
__±hªad_rwlock_åywæock


646 #¥agm®
wók
 
__±hªad_rwlock_u∆ock


647 #¥agm®
wók
 
__±hªad_key_¸óã


648 #¥agm®
wók
 
__±hªad_£t•ecific


649 #¥agm®
wók
 
__±hªad_gë•ecific


650 #¥agm®
wók
 
__±hªad_⁄˚


651 #¥agm®
wók
 
__±hªad_öôülize


652 #¥agm®
wók
 
__±hªad_©f‹k


653 #¥agm®
wók
 
_±hªad_˛ónup_push_de„r


654 #¥agm®
wók
 
_±hªad_˛ónup_p›_ª°‹e


655 #¥agm®
wók
 
±hªad_£tˇn˚l°©e


	@/usr/include/bits/select.h

19 #i‚de‡
_SYS_SELECT_H


23 
	~<bôs/w‹dsize.h
>

26 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

28 #i‡
__WORDSIZE
 == 64

29 
	#__FD_ZERO_STOS
 "°osq"

	)

31 
	#__FD_ZERO_STOS
 "°o¶"

	)

34 
	#__FD_ZERO
(
fd•
) \

36 
__d0
, 
__d1
; \

37 
__asm__
 
	`__vﬁ©ûe__
 ("˛d;Ñï; " 
__FD_ZERO_STOS
 \

38 : "=c" (
__d0
), "=D" (
__d1
) \

39 : "a" (0), "0" ( (
fd_£t
) \

40 /  (
__fd_mask
)), \

41 "1" (&
	`__FDS_BITS
 (
fd•
)[0]) \

43 } 0)

	)

49 
	#__FD_ZERO
(
£t
) \

51 
__i
; \

52 
fd_£t
 *
__¨r
 = (
£t
); \

53 
__i
 = 0; __ò<  (
fd_£t
Ë/  (
__fd_mask
); ++__i) \

54 
	`__FDS_BITS
 (
__¨r
)[
__i
] = 0; \

55 } 0)

	)

59 
	#__FD_SET
(
d
, 
£t
Ë(
	`__FDS_BITS
 (£t)[
	`__FDELT
 (d)] |
	`__FDMASK
 (d))

	)

60 
	#__FD_CLR
(
d
, 
£t
Ë(
	`__FDS_BITS
 (£t)[
	`__FDELT
 (d)] &~
	`__FDMASK
 (d))

	)

61 
	#__FD_ISSET
(
d
, 
£t
) \

62 ((
	`__FDS_BITS
 (
£t
)[
	`__FDELT
 (
d
)] & 
	`__FDMASK
 (d)Ë!0)

	)

	@/usr/include/bits/time.h

24 #i‚de‡
__√ed_timevÆ


25 #i‚de‡
_BITS_TIME_H


26 
	#_BITS_TIME_H
 1

	)

34 
	#CLOCKS_PER_SEC
 1000000l

	)

36 #i‡!
deföed
 
__STRICT_ANSI__
 && !deföed 
__USE_XOPEN2K


39 
	~<bôs/ty≥s.h
>

40 
__sysc⁄f
 ();

41 
	#CLK_TCK
 ((
__˛ock_t
Ë
	`__sysc⁄f
 (2)Ë

	)

44 #ifde‡
__USE_POSIX199309


46 
	#CLOCK_REALTIME
 0

	)

48 
	#CLOCK_MONOTONIC
 1

	)

50 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

52 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

55 
	#TIMER_ABSTIME
 1

	)

61 #ifde‡
__√ed_timevÆ


62 #unde‡
__√ed_timevÆ


63 #i‚de‡
_STRUCT_TIMEVAL


64 
	#_STRUCT_TIMEVAL
 1

	)

65 
	~<bôs/ty≥s.h
>

69 
	stimevÆ


71 
__time_t
 
	mtv_£c
;

72 
__su£c⁄ds_t
 
	mtv_u£c
;

	@/usr/include/gconv.h

23 #i‚de‡
_GCONV_H


24 
	#_GCONV_H
 1

	)

26 
	~<„©uªs.h
>

27 
	#__√ed_mb°©e_t


	)

28 
	#__√ed_wöt_t


	)

29 
	~<wch¨.h
>

30 
	#__√ed_size_t


	)

31 
	#__√ed_wch¨_t


	)

32 
	~<°ddef.h
>

35 
	#__UNKNOWN_10646_CHAR
 ((
wch¨_t
Ë0xfffd)

	)

40 
	m__GCONV_OK
 = 0,

41 
	m__GCONV_NOCONV
,

42 
	m__GCONV_NODB
,

43 
	m__GCONV_NOMEM
,

45 
	m__GCONV_EMPTY_INPUT
,

46 
	m__GCONV_FULL_OUTPUT
,

47 
	m__GCONV_ILLEGAL_INPUT
,

48 
	m__GCONV_INCOMPLETE_INPUT
,

50 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

51 
	m__GCONV_INTERNAL_ERROR


58 
	m__GCONV_IS_LAST
 = 0x0001,

59 
	m__GCONV_IGNORE_ERRORS
 = 0x0002

64 
	g__gc⁄v_°ï
;

65 
	g__gc⁄v_°ï_d©a
;

66 
	g__gc⁄v_lﬂded_obje˘
;

67 
	g__gc⁄v_å™s_d©a
;

71 (*
	t__gc⁄v_f˘
Ë(
	t__gc⁄v_°ï
 *, 
	t__gc⁄v_°ï_d©a
 *,

72 
	t__c⁄°
 **, __const *,

73 **, 
	tsize_t
 *, , );

76 
	$wöt_t
 (*
	t__gc⁄v_btowc_f˘
Ë(
	t__gc⁄v_°ï
 *, );

79 (*
	t__gc⁄v_öô_f˘
Ë(
	t__gc⁄v_°ï
 *);

80 (*
	t__gc⁄v_íd_f˘
Ë(
	t__gc⁄v_°ï
 *);

84 (*
	t__gc⁄v_å™s_f˘
Ë(
	t__gc⁄v_°ï
 *,

85 
	t__gc⁄v_°ï_d©a
 *, *,

86 
	t__c⁄°
 *,

87 
	t__c⁄°
 **,

88 
	t__c⁄°
 *, **,

89 
	tsize_t
 *);

92 (*
	t__gc⁄v_å™s_c⁄ãxt_f˘
Ë(*, 
	t__c⁄°
 *,

93 
	t__c⁄°
 *,

97 (*
	t__gc⁄v_å™s_quîy_f˘
Ë(
	t__c⁄°
 *, __const ***,

98 
	tsize_t
 *);

101 (*
	t__gc⁄v_å™s_öô_f˘
) (**, const *);

102 (*
	t__gc⁄v_å™s_íd_f˘
) (*);

104 
	s__gc⁄v_å™s_d©a


107 
__gc⁄v_å™s_f˘
 
__å™s_f˘
;

108 
__gc⁄v_å™s_c⁄ãxt_f˘
 
__å™s_c⁄ãxt_f˘
;

109 
__gc⁄v_å™s_íd_f˘
 
__å™s_íd_f˘
;

110 *
__d©a
;

111 
__gc⁄v_å™s_d©a
 *
__√xt
;

116 
	s__gc⁄v_°ï


118 
__gc⁄v_lﬂded_obje˘
 *
__shlib_h™dÀ
;

119 
__c⁄°
 *
__mod«me
;

121 
__cou¡î
;

123 *
__‰om_«me
;

124 *
__to_«me
;

126 
__gc⁄v_f˘
 
__f˘
;

127 
__gc⁄v_btowc_f˘
 
__btowc_f˘
;

128 
__gc⁄v_öô_f˘
 
__öô_f˘
;

129 
__gc⁄v_íd_f˘
 
__íd_f˘
;

133 
__mö_√eded_‰om
;

134 
__max_√eded_‰om
;

135 
__mö_√eded_to
;

136 
__max_√eded_to
;

139 
__°©eful
;

141 *
__d©a
;

146 
	s__gc⁄v_°ï_d©a


148 *
__outbuf
;

149 *
__outbu„nd
;

153 
__Êags
;

157 
__övoˇti⁄_cou¡î
;

161 
__öã∫Æ_u£
;

163 
__mb°©e_t
 *
__°©ï
;

164 
__mb°©e_t
 
__°©e
;

168 
__gc⁄v_å™s_d©a
 *
__å™s
;

173 
	s__gc⁄v_öfo


175 
size_t
 
__n°ïs
;

176 
__gc⁄v_°ï
 *
__°ïs
;

177 
__exãnsi⁄__
 
__gc⁄v_°ï_d©a
 
__d©a
 
__Êex¨r
;

178 } *
	t__gc⁄v_t
;

	@/usr/include/gnu/stubs-32.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub___kî√l_co¶


	)

11 
	#__°ub___kî√l_söl


	)

12 
	#__°ub___kî√l_è∆


	)

13 
	#__°ub_chÊags


	)

14 
	#__°ub_Áâach


	)

15 
	#__°ub_fchÊags


	)

16 
	#__°ub_fdëach


	)

17 
	#__°ub_gây


	)

18 
	#__°ub_lchmod


	)

19 
	#__°ub_ªvoke


	)

20 
	#__°ub_£éogö


	)

21 
	#__°ub_sigªtu∫


	)

22 
	#__°ub_s°k


	)

23 
	#__°ub_°ty


	)

	@/usr/include/linux/stddef.h

1 #i‚de‡
_LINUX_STDDEF_H


2 
	#_LINUX_STDDEF_H


	)

6 #unde‡
NULL


7 #i‡
deföed
(
__˝lu•lus
)

8 
	#NULL
 0

	)

10 
	#NULL
 ((*)0)

	)

	@/usr/include/wchar.h

24 #i‚de‡
_WCHAR_H


26 #i‡!
deföed
 
__√ed_mb°©e_t
 && !deföed 
__√ed_wöt_t


27 
	#_WCHAR_H
 1

	)

28 
	~<„©uªs.h
>

31 #ifde‡
_WCHAR_H


33 
	#__√ed___FILE


	)

34 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


35 
	#__√ed_FILE


	)

37 
	~<°dio.h
>

39 
	#__√ed___va_li°


	)

40 
	~<°d¨g.h
>

42 
	~<bôs/wch¨.h
>

45 
	#__√ed_size_t


	)

46 
	#__√ed_wch¨_t


	)

47 
	#__√ed_NULL


	)

49 #i‡
deföed
 
_WCHAR_H
 || deföed 
__√ed_wöt_t
 || !deföed 
__WINT_TYPE__


50 #unde‡
__√ed_wöt_t


51 
	#__√ed_wöt_t


	)

52 
	~<°ddef.h
>

55 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

56 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

61 #i‚de‡
_WINT_T


66 
	#_WINT_T


	)

67 
	twöt_t
;

71 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES
 \

72 && 
deföed
 
__WINT_TYPE__


73 
__BEGIN_NAMESPACE_STD


74 
__WINT_TYPE__
 
	twöt_t
;

75 
	g__END_NAMESPACE_STD


80 #i‡(
deföed
 
_WCHAR_H
 || deföed 
__√ed_mb°©e_t
Ë&& !deföed 
__mb°©e_t_deföed


81 
	#__mb°©e_t_deföed
 1

	)

85 
	m__cou¡
;

88 #ifde‡
__WINT_TYPE__


89 
__WINT_TYPE__
 
	m__wch
;

91 
wöt_t
 
	m__wch
;

93 
	m__wchb
[4];

94 } 
	m__vÆue
;

95 } 
	t__mb°©e_t
;

97 #unde‡
__√ed_mb°©e_t


102 #ifde‡
_WCHAR_H


104 
__BEGIN_NAMESPACE_C99


106 
__mb°©e_t
 
	tmb°©e_t
;

107 
	g__END_NAMESPACE_C99


108 #ifde‡
__USE_GNU


109 
	$__USING_NAMESPACE_C99
(
mb°©e_t
)

112 #i‚de‡
WCHAR_MIN


114 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

115 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

118 #i‚de‡
WEOF


119 
	#WEOF
 (0xffffffffu)

	)

124 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_UNIX98


125 
	~<w˘y≥.h
>

129 
__BEGIN_DECLS


131 
__BEGIN_NAMESPACE_STD


134 
tm
;

135 
__END_NAMESPACE_STD


139 
	$__USING_NAMESPACE_STD
(
tm
)

142 
__BEGIN_NAMESPACE_STD


144 
wch¨_t
 *
	$wcs˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

145 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

147 
wch¨_t
 *
	$wc¢˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

148 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

149 
__THROW
;

152 
wch¨_t
 *
	$wcsˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

153 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

155 
wch¨_t
 *
	$wc¢ˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

156 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

157 
__THROW
;

160 
	$wcscmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
)

161 
__THROW
 
__©åibuã_puª__
;

163 
	$wc¢cmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

164 
__THROW
 
__©åibuã_puª__
;

165 
__END_NAMESPACE_STD


167 #ifde‡
__USE_XOPEN2K8


169 
	$wcsˇ£cmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
Ë
__THROW
;

172 
	$wc¢ˇ£cmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

173 
size_t
 
__n
Ë
__THROW
;

177 
	~<xloˇÀ.h
>

179 
	$wcsˇ£cmp_l
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

180 
__loˇÀ_t
 
__loc
Ë
__THROW
;

182 
	$wc¢ˇ£cmp_l
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

183 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

186 
__BEGIN_NAMESPACE_STD


189 
	$wcscﬁl
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
Ë
__THROW
;

193 
size_t
 
	$wcsx‰m
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

194 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

195 
__END_NAMESPACE_STD


197 #ifde‡
__USE_XOPEN2K8


203 
	$wcscﬁl_l
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

204 
__loˇÀ_t
 
__loc
Ë
__THROW
;

209 
size_t
 
	$wcsx‰m_l
 (
wch¨_t
 *
__s1
, 
__c⁄°
 wch¨_à*
__s2
,

210 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

213 
wch¨_t
 *
	$wcsdup
 (
__c⁄°
 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_mÆloc__
;

216 
__BEGIN_NAMESPACE_STD


218 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


219 "C++" 
wch¨_t
 *
	$wcschr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

220 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

221 "C++" 
__c⁄°
 
wch¨_t
 *
	$wcschr
 (
__c⁄°
 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

222 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

224 
wch¨_t
 *
	$wcschr
 (
__c⁄°
 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

225 
__THROW
 
__©åibuã_puª__
;

228 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


229 "C++" 
wch¨_t
 *
	$wc§chr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

230 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

231 "C++" 
__c⁄°
 
wch¨_t
 *
	$wc§chr
 (
__c⁄°
 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

232 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

234 
wch¨_t
 *
	$wc§chr
 (
__c⁄°
 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

235 
__THROW
 
__©åibuã_puª__
;

237 
__END_NAMESPACE_STD


239 #ifde‡
__USE_GNU


242 
wch¨_t
 *
	$wcsch∫ul
 (
__c⁄°
 
wch¨_t
 *
__s
, wch¨_à
__wc
)

243 
__THROW
 
__©åibuã_puª__
;

246 
__BEGIN_NAMESPACE_STD


249 
size_t
 
	$wcsc•n
 (
__c⁄°
 
wch¨_t
 *
__wcs
, __c⁄° wch¨_à*
__ªje˘
)

250 
__THROW
 
__©åibuã_puª__
;

253 
size_t
 
	$wcs•n
 (
__c⁄°
 
wch¨_t
 *
__wcs
, __c⁄° wch¨_à*
__ac˚±
)

254 
__THROW
 
__©åibuã_puª__
;

256 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


257 "C++" 
wch¨_t
 *
	$wc•brk
 (
wch¨_t
 *
__wcs
, 
__c⁄°
 wch¨_à*
__ac˚±
)

258 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

259 "C++" 
__c⁄°
 
wch¨_t
 *
	$wc•brk
 (
__c⁄°
 
wch¨_t
 *
__wcs
,

260 
__c⁄°
 
wch¨_t
 *
__ac˚±
)

261 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

263 
wch¨_t
 *
	$wc•brk
 (
__c⁄°
 
wch¨_t
 *
__wcs
, __c⁄° wch¨_à*
__ac˚±
)

264 
__THROW
 
__©åibuã_puª__
;

267 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


268 "C++" 
wch¨_t
 *
	$wcs°r
 (
wch¨_t
 *
__hay°ack
, 
__c⁄°
 wch¨_à*
__√edÀ
)

269 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

270 "C++" 
__c⁄°
 
wch¨_t
 *
	$wcs°r
 (
__c⁄°
 
wch¨_t
 *
__hay°ack
,

271 
__c⁄°
 
wch¨_t
 *
__√edÀ
)

272 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

274 
wch¨_t
 *
	$wcs°r
 (
__c⁄°
 
wch¨_t
 *
__hay°ack
, __c⁄° wch¨_à*
__√edÀ
)

275 
__THROW
 
__©åibuã_puª__
;

279 
wch¨_t
 *
	$wc°ok
 (
wch¨_t
 *
__ª°ri˘
 
__s
,

280 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__dñim
,

281 
wch¨_t
 **
__ª°ri˘
 
__±r
Ë
__THROW
;

284 
size_t
 
	$wc¶í
 (
__c⁄°
 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_puª__
;

285 
__END_NAMESPACE_STD


287 #ifde‡
__USE_XOPEN


289 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


290 "C++" 
wch¨_t
 *
	$wcswcs
 (
wch¨_t
 *
__hay°ack
, 
__c⁄°
 wch¨_à*
__√edÀ
)

291 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

292 "C++" 
__c⁄°
 
wch¨_t
 *
	$wcswcs
 (
__c⁄°
 
wch¨_t
 *
__hay°ack
,

293 
__c⁄°
 
wch¨_t
 *
__√edÀ
)

294 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

296 
wch¨_t
 *
	$wcswcs
 (
__c⁄°
 
wch¨_t
 *
__hay°ack
, __c⁄° wch¨_à*
__√edÀ
)

297 
__THROW
 
__©åibuã_puª__
;

301 #ifde‡
__USE_XOPEN2K8


303 
size_t
 
	$wc¢Àn
 (
__c⁄°
 
wch¨_t
 *
__s
, 
size_t
 
__maxÀn
)

304 
__THROW
 
__©åibuã_puª__
;

308 
__BEGIN_NAMESPACE_STD


310 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


311 "C++" 
wch¨_t
 *
	$wmemchr
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

312 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

313 "C++" 
__c⁄°
 
wch¨_t
 *
	$wmemchr
 (
__c⁄°
 
wch¨_t
 *
__s
, wch¨_à
__c
,

314 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

317 
wch¨_t
 *
	$wmemchr
 (
__c⁄°
 
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

318 
__THROW
 
__©åibuã_puª__
;

322 
	$wmemcmp
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s1
,

323 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
)

324 
__THROW
 
__©åibuã_puª__
;

327 
wch¨_t
 *
	$wmem˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

328 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

332 
wch¨_t
 *
	$wmemmove
 (
wch¨_t
 *
__s1
, 
__c⁄°
 wch¨_à*
__s2
, 
size_t
 
__n
)

333 
__THROW
;

336 
wch¨_t
 *
	$wmem£t
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
Ë
__THROW
;

337 
__END_NAMESPACE_STD


339 #ifde‡
__USE_GNU


342 
wch¨_t
 *
	$wmemp˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

343 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
)

344 
__THROW
;

348 
__BEGIN_NAMESPACE_STD


351 
wöt_t
 
	$btowc
 (
__c
Ë
__THROW
;

355 
	$w˘ob
 (
wöt_t
 
__c
Ë
__THROW
;

359 
	$mbsöô
 (
__c⁄°
 
mb°©e_t
 *
__ps
Ë
__THROW
 
__©åibuã_puª__
;

363 
size_t
 
	$mbπowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

364 
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

365 
mb°©e_t
 *
__p
Ë
__THROW
;

368 
size_t
 
	$w¸tomb
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wc
,

369 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

372 
size_t
 
	$__mbæí
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

373 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

374 
size_t
 
	$mbæí
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

375 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

376 
__END_NAMESPACE_STD


378 #ifde‡
__USE_EXTERN_INLINES


384 
wöt_t
 
	$__btowc_Æüs
 (
__c
Ë
	`__asm
 ("btowc");

385 
__exã∫_ölöe
 
wöt_t


386 
	`__NTH
 (
	$btowc
 (
__c
))

387 {  (
	`__buûtö_c⁄°™t_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

388 ? (
wöt_t
Ë
__c
 : 
	`__btowc_Æüs
 (__c)); 
	}
}

390 
	$__w˘ob_Æüs
 (
wöt_t
 
__c
Ë
	`__asm
 ("wctob");

391 
__exã∫_ölöe
 

392 
	`__NTH
 (
	$w˘ob
 (
wöt_t
 
__wc
))

393 {  (
	`__buûtö_c⁄°™t_p
 (
__wc
Ë&& __w¯>
L
'\0' && __wc <= L'\x7f'

394 ? (Ë
__wc
 : 
	`__w˘ob_Æüs
 (__wc)); 
	}
}

396 
__exã∫_ölöe
 
size_t


397 
__NTH
 (
	$mbæí
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

398 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

399 {  (
__ps
 !
NULL


400 ? 
	`mbπowc
 (
NULL
, 
__s
, 
__n
, 
__ps
Ë: 
	`__mbæí
 (__s, __n, NULL)); 
	}
}

403 
__BEGIN_NAMESPACE_STD


406 
size_t
 
	$mb§towcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

407 
__c⁄°
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

408 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

412 
size_t
 
	$wc§tombs
 (*
__ª°ri˘
 
__d°
,

413 
__c⁄°
 
wch¨_t
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

414 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

415 
__END_NAMESPACE_STD


418 #ifdef 
__USE_XOPEN2K8


421 
size_t
 
	$mb¢πowcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

422 
__c⁄°
 **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

423 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

427 
size_t
 
	$wc¢πombs
 (*
__ª°ri˘
 
__d°
,

428 
__c⁄°
 
wch¨_t
 **
__ª°ri˘
 
__§c
,

429 
size_t
 
__nwc
, size_à
__Àn
,

430 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

435 #ifde‡
__USE_XOPEN


437 
	$wcwidth
 (
wch¨_t
 
__c
Ë
__THROW
;

441 
	$wcswidth
 (
__c⁄°
 
wch¨_t
 *
__s
, 
size_t
 
__n
Ë
__THROW
;

445 
__BEGIN_NAMESPACE_STD


448 
	$wc°od
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

449 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

450 
__END_NAMESPACE_STD


452 #ifde‡
__USE_ISOC99


453 
__BEGIN_NAMESPACE_C99


455 
	$wc°of
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

456 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

457 
	$wc°ﬁd
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

458 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

459 
__END_NAMESPACE_C99


463 
__BEGIN_NAMESPACE_STD


466 
	$wc°ﬁ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

467 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

471 
	$wc°oul
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

472 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

473 
__THROW
;

474 
__END_NAMESPACE_STD


476 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GNUC__
 && deföed 
__USE_GNU
)

477 
__BEGIN_NAMESPACE_C99


480 
__exãnsi⁄__


481 
	$wc°ﬁl
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

482 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

483 
__THROW
;

487 
__exãnsi⁄__


488 
	$wc°ouŒ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

489 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

490 
__ba£
Ë
__THROW
;

491 
__END_NAMESPACE_C99


494 #i‡
deföed
 
__GNUC__
 && deföed 
__USE_GNU


497 
__exãnsi⁄__


498 
	$wc°oq
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

499 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

500 
__THROW
;

504 
__exãnsi⁄__


505 
	$wc°ouq
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

506 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

507 
__ba£
Ë
__THROW
;

510 #ifde‡
__USE_GNU


524 
	~<xloˇÀ.h
>

528 
	$wc°ﬁ_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

529 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

530 
__loˇÀ_t
 
__loc
Ë
__THROW
;

532 
	$wc°oul_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

533 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

534 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

536 
__exãnsi⁄__


537 
	$wc°ﬁl_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

538 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

539 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

541 
__exãnsi⁄__


542 
	$wc°ouŒ_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

543 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

544 
__ba£
, 
__loˇÀ_t
 
__loc
)

545 
__THROW
;

547 
	$wc°od_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

548 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

549 
__THROW
;

551 
	$wc°of_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

552 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

553 
__THROW
;

555 
	$wc°ﬁd_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

556 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

557 
__loˇÀ_t
 
__loc
Ë
__THROW
;

561 #ifdef 
__USE_XOPEN2K8


564 
wch¨_t
 *
	$w˝˝y
 (
wch¨_t
 *
__de°
, 
__c⁄°
 wch¨_à*
__§c
Ë
__THROW
;

568 
wch¨_t
 *
	$w˝n˝y
 (
wch¨_t
 *
__de°
, 
__c⁄°
 wch¨_à*
__§c
, 
size_t
 
__n
)

569 
__THROW
;

575 #ifdef 
__USE_XOPEN2K8


578 
__FILE
 *
	$›í_wmem°ªam
 (
wch¨_t
 **
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
;

581 #i‡
deföed
 
__USE_ISOC95
 || deföed 
__USE_UNIX98


582 
__BEGIN_NAMESPACE_STD


585 
	$fwide
 (
__FILE
 *
__Â
, 
__mode
Ë
__THROW
;

592 
	`fw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

593 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

599 
	`w¥ötf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

602 
	$sw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

603 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

604 
__THROW
 ;

610 
	`vfw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__s
,

611 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

612 
__gnuc_va_li°
 
__¨g
)

618 
	`vw¥ötf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

619 
__gnuc_va_li°
 
__¨g
)

623 
	$vsw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

624 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

625 
__gnuc_va_li°
 
__¨g
)

626 
__THROW
 ;

633 
	`fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

634 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

640 
	`wsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

643 
	$swsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

644 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

645 
__THROW
 ;

647 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

648 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

649 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

650 #ifde‡
__REDIRECT


654 
	`__REDIRECT
 (
fwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__°ªam
,

655 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

656 
__isoc99_fwsˇnf
)

658 
	`__REDIRECT
 (
wsˇnf
, (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

659 
__isoc99_wsˇnf
)

661 
	`__REDIRECT
 (
swsˇnf
, (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

662 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

663 
__isoc99_swsˇnf
)

664 
__THROW
 ;

666 
	`__isoc99_fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

667 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

668 
	`__isoc99_wsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

669 
	$__isoc99_swsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

670 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

671 
__THROW
;

672 
	#fwsˇnf
 
__isoc99_fwsˇnf


	)

673 
	#wsˇnf
 
__isoc99_wsˇnf


	)

674 
	#swsˇnf
 
__isoc99_swsˇnf


	)

678 
__END_NAMESPACE_STD


681 #ifde‡
__USE_ISOC99


682 
__BEGIN_NAMESPACE_C99


687 
	`vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

688 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

689 
__gnuc_va_li°
 
__¨g
)

695 
	`vwsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

696 
__gnuc_va_li°
 
__¨g
)

699 
	$vswsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

700 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

701 
__gnuc_va_li°
 
__¨g
)

702 
__THROW
 ;

704 #i‡!
deföed
 
__USE_GNU
 \

705 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

706 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

707 #ifde‡
__REDIRECT


708 
	`__REDIRECT
 (
vfwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__s
,

709 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

710 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vfwsˇnf
)

712 
	`__REDIRECT
 (
vwsˇnf
, (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

713 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vwsˇnf
)

715 
	`__REDIRECT
 (
vswsˇnf
, (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

716 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

717 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vswsˇnf
)

718 
__THROW
 ;

720 
	`__isoc99_vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

721 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

722 
__gnuc_va_li°
 
__¨g
);

723 
	`__isoc99_vwsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

724 
__gnuc_va_li°
 
__¨g
);

725 
	$__isoc99_vswsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

726 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

727 
__gnuc_va_li°
 
__¨g
Ë
__THROW
;

728 
	#vfwsˇnf
 
__isoc99_vfwsˇnf


	)

729 
	#vwsˇnf
 
__isoc99_vwsˇnf


	)

730 
	#vswsˇnf
 
__isoc99_vswsˇnf


	)

734 
__END_NAMESPACE_C99


738 
__BEGIN_NAMESPACE_STD


743 
wöt_t
 
	`fgëwc
 (
__FILE
 *
__°ªam
);

744 
wöt_t
 
	`gëwc
 (
__FILE
 *
__°ªam
);

750 
wöt_t
 
	`gëwch¨
 ();

757 
wöt_t
 
	`Âutwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

758 
wöt_t
 
	`putwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

764 
wöt_t
 
	`putwch¨
 (
wch¨_t
 
__wc
);

772 
wch¨_t
 *
	`fgëws
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

773 
__FILE
 *
__ª°ri˘
 
__°ªam
);

779 
	`Âutws
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__ws
,

780 
__FILE
 *
__ª°ri˘
 
__°ªam
);

787 
wöt_t
 
	`ungëwc
 (wöt_à
__wc
, 
__FILE
 *
__°ªam
);

788 
__END_NAMESPACE_STD


791 #ifde‡
__USE_GNU


799 
wöt_t
 
	`gëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

800 
wöt_t
 
	`gëwch¨_u∆ocked
 ();

808 
wöt_t
 
	`fgëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

816 
wöt_t
 
	`Âutwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

825 
wöt_t
 
	`putwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

826 
wöt_t
 
	`putwch¨_u∆ocked
 (
wch¨_t
 
__wc
);

835 
wch¨_t
 *
	`fgëws_u∆ocked
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

836 
__FILE
 *
__ª°ri˘
 
__°ªam
);

844 
	`Âutws_u∆ocked
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__ws
,

845 
__FILE
 *
__ª°ri˘
 
__°ªam
);

849 
__BEGIN_NAMESPACE_C99


853 
size_t
 
	$wcs·ime
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

854 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

855 
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

856 
__END_NAMESPACE_C99


858 #ifde‡
__USE_GNU


859 
	~<xloˇÀ.h
>

863 
size_t
 
	$wcs·ime_l
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

864 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

865 
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
,

866 
__loˇÀ_t
 
__loc
Ë
__THROW
;

875 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__USE_GNU


876 
	#__√ed_iswxxx


	)

877 
	~<w˘y≥.h
>

881 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


882 
	~<bôs/wch¨2.h
>

885 #ifde‡
__LDBL_COMPAT


886 
	~<bôs/wch¨-ldbl.h
>

889 
__END_DECLS


897 #unde‡
__√ed_mb°©e_t


898 #unde‡
__√ed_wöt_t


	@/usr/include/asm-generic/int-ll64.h

8 #i‚de‡
_ASM_GENERIC_INT_LL64_H


9 
	#_ASM_GENERIC_INT_LL64_H


	)

11 
	~<asm/bô•îl⁄g.h
>

13 #i‚de‡
__ASSEMBLY__


19 
__sig√d__
 
	t__s8
;

20 
	t__u8
;

22 
__sig√d__
 
	t__s16
;

23 
	t__u16
;

25 
__sig√d__
 
	t__s32
;

26 
	t__u32
;

28 #ifde‡
__GNUC__


29 
__exãnsi⁄__
 
__sig√d__
 
	t__s64
;

30 
__exãnsi⁄__
 
	t__u64
;

32 
__sig√d__
 
	t__s64
;

33 
	t__u64
;

	@/usr/include/asm/sockios.h

1 
	~<asm-gíîic/sockios.h
>

	@/usr/include/bits/wchar-ldbl.h

20 #i‚de‡
_WCHAR_H


24 #i‡
deföed
 
__USE_ISOC95
 || deföed 
__USE_UNIX98


25 
__BEGIN_NAMESPACE_C99


26 
__LDBL_REDIR_DECL
 (
fw¥ötf
);

27 
__LDBL_REDIR_DECL
 (
w¥ötf
);

28 
__LDBL_REDIR_DECL
 (
sw¥ötf
);

29 
__LDBL_REDIR_DECL
 (
vfw¥ötf
);

30 
__LDBL_REDIR_DECL
 (
vw¥ötf
);

31 
__LDBL_REDIR_DECL
 (
vsw¥ötf
);

32 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

33 && !
deföed
 
	g__REDIRECT
 \

34 && (
deföed
 
	g__STRICT_ANSI__
 || deföed 
	g__USE_XOPEN2K
)

35 
	$__LDBL_REDIR1_DECL
 (
fwsˇnf
, 
__∆dbl___isoc99_fwsˇnf
)

36 
	$__LDBL_REDIR1_DECL
 (
wsˇnf
, 
__∆dbl___isoc99_wsˇnf
)

37 
	$__LDBL_REDIR1_DECL
 (
swsˇnf
, 
__∆dbl___isoc99_swsˇnf
)

39 
	`__LDBL_REDIR_DECL
 (
fwsˇnf
);

40 
	`__LDBL_REDIR_DECL
 (
wsˇnf
);

41 
	`__LDBL_REDIR_DECL
 (
swsˇnf
);

43 
__END_NAMESPACE_C99


46 #ifde‡
__USE_ISOC99


47 
__BEGIN_NAMESPACE_C99


48 
	`__LDBL_REDIR1_DECL
 (
wc°ﬁd
, 
wc°od
);

49 #i‡!
deföed
 
__USE_GNU
 && !deföed 
__REDIRECT
 \

50 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

51 
	$__LDBL_REDIR1_DECL
 (
vfwsˇnf
, 
__∆dbl___isoc99_vfwsˇnf
)

52 
	$__LDBL_REDIR1_DECL
 (
vwsˇnf
, 
__∆dbl___isoc99_vwsˇnf
)

53 
	$__LDBL_REDIR1_DECL
 (
vswsˇnf
, 
__∆dbl___isoc99_vswsˇnf
)

55 
	`__LDBL_REDIR_DECL
 (
vfwsˇnf
);

56 
	`__LDBL_REDIR_DECL
 (
vwsˇnf
);

57 
	`__LDBL_REDIR_DECL
 (
vswsˇnf
);

59 
__END_NAMESPACE_C99


62 #ifde‡
__USE_GNU


63 
	`__LDBL_REDIR1_DECL
 (
wc°ﬁd_l
, 
wc°od_l
);

66 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


67 
	$__LDBL_REDIR_DECL
 (
__sw¥ötf_chk
)

68 
	$__LDBL_REDIR_DECL
 (
__vsw¥ötf_chk
)

69 #i‡
__USE_FORTIFY_LEVEL
 > 1

70 
	$__LDBL_REDIR_DECL
 (
__fw¥ötf_chk
)

71 
	$__LDBL_REDIR_DECL
 (
__w¥ötf_chk
)

72 
	$__LDBL_REDIR_DECL
 (
__vfw¥ötf_chk
)

73 
	$__LDBL_REDIR_DECL
 (
__vw¥ötf_chk
)

	@/usr/include/bits/wchar.h

20 #i‚de‡
_BITS_WCHAR_H


21 
	#_BITS_WCHAR_H
 1

	)

24 #ifde‡
__WCHAR_MAX__


25 
	#__WCHAR_MAX
 
__WCHAR_MAX__


	)

27 
	#__WCHAR_MAX
 (2147483647)

	)

32 #ifde‡
__WCHAR_UNSIGNED__


33 
	#__WCHAR_MIN
 
L
'\0'

	)

37 #ñi‡
L
'\0' - 1 > 0

38 
	#__WCHAR_MIN
 
L
'\0'

	)

40 
	#__WCHAR_MIN
 (-
__WCHAR_MAX
 - 1)

	)

	@/usr/include/bits/wchar2.h

20 #i‚de‡
_WCHAR_H


25 
wch¨_t
 *
	$__wmem˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

26 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
,

27 
size_t
 
__ns1
Ë
__THROW
;

28 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmem˝y_Æüs
,

29 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

30 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
),

31 
wmem˝y
);

32 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmem˝y_chk_w¨n
,

33 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

34 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
,

35 
size_t
 
__ns1
), 
__wmem˝y_chk
)

36 
	`__w¨«âr
 ("wmemcpy called withÜength biggerÅhan size of destination "

39 
__exã∫_Æways_ölöe
 
wch¨_t
 *

40 
	`__NTH
 (
	$wmem˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
, 
__c⁄°
 wch¨_à*__ª°ri˘ 
__s2
,

41 
size_t
 
__n
))

43 i‡(
	`__bos0
 (
__s1
Ë!(
size_t
) -1)

45 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

46  
	`__wmem˝y_chk
 (
__s1
, 
__s2
, 
__n
,

47 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

49 i‡(
__n
 > 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
))

50  
	`__wmem˝y_chk_w¨n
 (
__s1
, 
__s2
, 
__n
,

51 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

53  
	`__wmem˝y_Æüs
 (
__s1
, 
__s2
, 
__n
);

54 
	}
}

57 
wch¨_t
 *
	$__wmemmove_chk
 (
wch¨_t
 *
__s1
, 
__c⁄°
 wch¨_à*
__s2
,

58 
size_t
 
__n
, size_à
__ns1
Ë
__THROW
;

59 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_Æüs
, (wch¨_à*
__s1
,

60 
__c⁄°
 
wch¨_t
 *
__s2
,

61 
size_t
 
__n
), 
wmemmove
);

62 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_chk_w¨n
,

63 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

64 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
,

65 
size_t
 
__ns1
), 
__wmemmove_chk
)

66 
	`__w¨«âr
 ("wmemmove called withÜength biggerÅhan size of destination "

69 
__exã∫_Æways_ölöe
 
wch¨_t
 *

70 
	`__NTH
 (
	$wmemmove
 (
wch¨_t
 *
__ª°ri˘
 
__s1
, 
__c⁄°
 wch¨_à*__ª°ri˘ 
__s2
,

71 
size_t
 
__n
))

73 i‡(
	`__bos0
 (
__s1
Ë!(
size_t
) -1)

75 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

76  
	`__wmemmove_chk
 (
__s1
, 
__s2
, 
__n
,

77 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

79 i‡(
__n
 > 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
))

80  
	`__wmemmove_chk_w¨n
 (
__s1
, 
__s2
, 
__n
,

81 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

83  
	`__wmemmove_Æüs
 (
__s1
, 
__s2
, 
__n
);

84 
	}
}

87 #ifde‡
__USE_GNU


88 
wch¨_t
 *
	$__wmemp˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

89 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
,

90 
size_t
 
__ns1
Ë
__THROW
;

91 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmemp˝y_Æüs
,

92 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

93 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
,

94 
size_t
 
__n
), 
wmemp˝y
);

95 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmemp˝y_chk_w¨n
,

96 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

97 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
,

98 
size_t
 
__ns1
), 
__wmemp˝y_chk
)

99 
	`__w¨«âr
 ("wmempcpy called withÜength biggerÅhan size of destination "

102 
__exã∫_Æways_ölöe
 
wch¨_t
 *

103 
	`__NTH
 (
	$wmemp˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
, 
__c⁄°
 wch¨_à*__ª°ri˘ 
__s2
,

104 
size_t
 
__n
))

106 i‡(
	`__bos0
 (
__s1
Ë!(
size_t
) -1)

108 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

109  
	`__wmemp˝y_chk
 (
__s1
, 
__s2
, 
__n
,

110 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

112 i‡(
__n
 > 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
))

113  
	`__wmemp˝y_chk_w¨n
 (
__s1
, 
__s2
, 
__n
,

114 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

116  
	`__wmemp˝y_Æüs
 (
__s1
, 
__s2
, 
__n
);

117 
	}
}

121 
wch¨_t
 *
	$__wmem£t_chk
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
,

122 
size_t
 
__ns
Ë
__THROW
;

123 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_Æüs
, (wch¨_à*
__s
, wch¨_à
__c
,

124 
size_t
 
__n
), 
wmem£t
);

125 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_chk_w¨n
,

126 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
,

127 
size_t
 
__ns
), 
__wmem£t_chk
)

128 
	`__w¨«âr
 ("wmemset called withÜength biggerÅhan size of destination "

131 
__exã∫_Æways_ölöe
 
wch¨_t
 *

132 
	`__NTH
 (
	$wmem£t
 (
wch¨_t
 *
__ª°ri˘
 
__s
, wch¨_à
__c
, 
size_t
 
__n
))

134 i‡(
	`__bos0
 (
__s
Ë!(
size_t
) -1)

136 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

137  
	`__wmem£t_chk
 (
__s
, 
__c
, 
__n
, 
	`__bos0
 (__sË/  (
wch¨_t
));

139 i‡(
__n
 > 
	`__bos0
 (
__s
Ë/  (
wch¨_t
))

140  
	`__wmem£t_chk_w¨n
 (
__s
, 
__c
, 
__n
,

141 
	`__bos0
 (
__s
Ë/  (
wch¨_t
));

143  
	`__wmem£t_Æüs
 (
__s
, 
__c
, 
__n
);

144 
	}
}

147 
wch¨_t
 *
	$__wcs˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

148 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
,

149 
size_t
 
__n
Ë
__THROW
;

150 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wcs˝y_Æüs
,

151 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

152 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
), 
wcs˝y
);

154 
__exã∫_Æways_ölöe
 
wch¨_t
 *

155 
	`__NTH
 (
	$wcs˝y
 (
wch¨_t
 *
__de°
, 
__c⁄°
 wch¨_à*
__§c
))

157 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

158  
	`__wcs˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__de°Ë/  (
wch¨_t
));

159  
	`__wcs˝y_Æüs
 (
__de°
, 
__§c
);

160 
	}
}

163 
wch¨_t
 *
	$__w˝˝y_chk
 (
wch¨_t
 *
__de°
, 
__c⁄°
 wch¨_à*
__§c
,

164 
size_t
 
__de°Àn
Ë
__THROW
;

165 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__w˝˝y_Æüs
, (wch¨_à*
__de°
,

166 
__c⁄°
 
wch¨_t
 *
__§c
),

167 
w˝˝y
);

169 
__exã∫_Æways_ölöe
 
wch¨_t
 *

170 
	`__NTH
 (
	$w˝˝y
 (
wch¨_t
 *
__de°
, 
__c⁄°
 wch¨_à*
__§c
))

172 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

173  
	`__w˝˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__de°Ë/  (
wch¨_t
));

174  
	`__w˝˝y_Æüs
 (
__de°
, 
__§c
);

175 
	}
}

178 
wch¨_t
 *
	$__wc¢˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

179 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
,

180 
size_t
 
__de°Àn
Ë
__THROW
;

181 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wc¢˝y_Æüs
,

182 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

183 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
,

184 
size_t
 
__n
), 
wc¢˝y
);

185 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wc¢˝y_chk_w¨n
,

186 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

187 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
,

188 
size_t
 
__n
, size_à
__de°Àn
), 
__wc¢˝y_chk
)

189 
	`__w¨«âr
 ("wcsncpy called withÜength biggerÅhan size of destination "

192 
__exã∫_Æways_ölöe
 
wch¨_t
 *

193 
	`__NTH
 (
	$wc¢˝y
 (
wch¨_t
 *
__de°
, 
__c⁄°
 wch¨_à*
__§c
, 
size_t
 
__n
))

195 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

197 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

198  
	`__wc¢˝y_chk
 (
__de°
, 
__§c
, 
__n
,

199 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

200 i‡(
__n
 > 
	`__bos
 (
__de°
Ë/  (
wch¨_t
))

201  
	`__wc¢˝y_chk_w¨n
 (
__de°
, 
__§c
, 
__n
,

202 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

204  
	`__wc¢˝y_Æüs
 (
__de°
, 
__§c
, 
__n
);

205 
	}
}

208 
wch¨_t
 *
	$__w˝n˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

209 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
,

210 
size_t
 
__de°Àn
Ë
__THROW
;

211 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__w˝n˝y_Æüs
,

212 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

213 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
,

214 
size_t
 
__n
), 
w˝n˝y
);

215 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__w˝n˝y_chk_w¨n
,

216 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

217 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
,

218 
size_t
 
__n
, size_à
__de°Àn
), 
__w˝n˝y_chk
)

219 
	`__w¨«âr
 ("wcpncpy called withÜength biggerÅhan size of destination "

222 
__exã∫_Æways_ölöe
 
wch¨_t
 *

223 
	`__NTH
 (
	$w˝n˝y
 (
wch¨_t
 *
__de°
, 
__c⁄°
 wch¨_à*
__§c
, 
size_t
 
__n
))

225 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

227 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

228  
	`__w˝n˝y_chk
 (
__de°
, 
__§c
, 
__n
,

229 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

230 i‡(
__n
 > 
	`__bos
 (
__de°
Ë/  (
wch¨_t
))

231  
	`__w˝n˝y_chk_w¨n
 (
__de°
, 
__§c
, 
__n
,

232 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

234  
	`__w˝n˝y_Æüs
 (
__de°
, 
__§c
, 
__n
);

235 
	}
}

238 
wch¨_t
 *
	$__wcsˇt_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

239 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
,

240 
size_t
 
__de°Àn
Ë
__THROW
;

241 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wcsˇt_Æüs
,

242 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

243 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
), 
wcsˇt
);

245 
__exã∫_Æways_ölöe
 
wch¨_t
 *

246 
	`__NTH
 (
	$wcsˇt
 (
wch¨_t
 *
__de°
, 
__c⁄°
 wch¨_à*
__§c
))

248 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

249  
	`__wcsˇt_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__de°Ë/  (
wch¨_t
));

250  
	`__wcsˇt_Æüs
 (
__de°
, 
__§c
);

251 
	}
}

254 
wch¨_t
 *
	$__wc¢ˇt_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

255 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
,

256 
size_t
 
__n
, size_à
__de°Àn
Ë
__THROW
;

257 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wc¢ˇt_Æüs
,

258 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

259 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
,

260 
size_t
 
__n
), 
wc¢ˇt
);

262 
__exã∫_Æways_ölöe
 
wch¨_t
 *

263 
	`__NTH
 (
	$wc¢ˇt
 (
wch¨_t
 *
__de°
, 
__c⁄°
 wch¨_à*
__§c
, 
size_t
 
__n
))

265 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

266  
	`__wc¢ˇt_chk
 (
__de°
, 
__§c
, 
__n
,

267 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

268  
	`__wc¢ˇt_Æüs
 (
__de°
, 
__§c
, 
__n
);

269 
	}
}

272 
	$__sw¥ötf_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

273 
__Êag
, 
size_t
 
__s_Àn
,

274 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

275 
__THROW
 ;

277 
	`__REDIRECT_NTH_LDBL
 (
__sw¥ötf_Æüs
,

278 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

279 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__fmt
, ...),

280 
sw¥ötf
);

282 #ifde‡
__va_¨g_∑ck


283 
__exã∫_Æways_ölöe
 

284 
	`__NTH
 (
	$sw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

285 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__fmt
, ...))

287 i‡(
	`__bos
 (
__s
Ë!(
size_t
Ë-1 || 
__USE_FORTIFY_LEVEL
 > 1)

288  
	`__sw¥ötf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

289 
	`__bos
 (
__s
Ë/  (
wch¨_t
),

290 
__fmt
, 
	`__va_¨g_∑ck
 ());

291  
	`__sw¥ötf_Æüs
 (
__s
, 
__n
, 
__fmt
, 
	`__va_¨g_∑ck
 ());

292 
	}
}

293 #ñi‡!
deföed
 
__˝lu•lus


295 
	#sw¥ötf
(
s
, 
n
, ...) \

296 (
	`__bos
 (
s
Ë!(
size_t
Ë-1 || 
__USE_FORTIFY_LEVEL
 > 1 \

297 ? 
	`__sw¥ötf_chk
 (
s
, 
n
, 
__USE_FORTIFY_LEVEL
 - 1, \

298 
	`__bos
 (
s
Ë/  (
wch¨_t
), 
__VA_ARGS__
) \

299 : 
	`sw¥ötf
 (
s
, 
n
, 
__VA_ARGS__
))

	)

302 
	$__vsw¥ötf_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

303 
__Êag
, 
size_t
 
__s_Àn
,

304 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

305 
__gnuc_va_li°
 
__¨g
)

306 
__THROW
 ;

308 
	`__REDIRECT_NTH_LDBL
 (
__vsw¥ötf_Æüs
,

309 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

310 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__fmt
,

311 
__gnuc_va_li°
 
__≠
), 
vsw¥ötf
);

313 
__exã∫_Æways_ölöe
 

314 
	`__NTH
 (
	$vsw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

315 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__fmt
, 
__gnuc_va_li°
 
__≠
))

317 i‡(
	`__bos
 (
__s
Ë!(
size_t
Ë-1 || 
__USE_FORTIFY_LEVEL
 > 1)

318  
	`__vsw¥ötf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

319 
	`__bos
 (
__s
Ë/  (
wch¨_t
), 
__fmt
, 
__≠
);

320  
	`__vsw¥ötf_Æüs
 (
__s
, 
__n
, 
__fmt
, 
__≠
);

321 
	}
}

324 #i‡
__USE_FORTIFY_LEVEL
 > 1

326 
__fw¥ötf_chk
 (
__FILE
 *
__ª°ri˘
 
__°ªam
, 
__Êag
,

327 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

328 
__w¥ötf_chk
 (
__Êag
, 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

330 
__vfw¥ötf_chk
 (
__FILE
 *
__ª°ri˘
 
__°ªam
, 
__Êag
,

331 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

332 
__gnuc_va_li°
 
__≠
);

333 
__vw¥ötf_chk
 (
__Êag
, 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

334 
__gnuc_va_li°
 
__≠
);

336 #ifde‡
__va_¨g_∑ck


337 
__exã∫_Æways_ölöe
 

338 
	$w¥ötf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__fmt
, ...)

340  
	`__w¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¨g_∑ck
 ());

341 
	}
}

343 
__exã∫_Æways_ölöe
 

344 
	$fw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
, 
__c⁄°
 
wch¨_t
 *__ª°ri˘ 
__fmt
, ...)

346  
	`__fw¥ötf_chk
 (
__°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

347 
	`__va_¨g_∑ck
 ());

348 
	}
}

349 #ñi‡!
deföed
 
__˝lu•lus


350 
	#w¥ötf
(...) \

351 
	`__w¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

352 
	#fw¥ötf
(
°ªam
, ...) \

353 
	`__fw¥ötf_chk
 (
°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

356 
__exã∫_Æways_ölöe
 

357 
	$vw¥ötf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__fmt
, 
__gnuc_va_li°
 
__≠
)

359  
	`__vw¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

360 
	}
}

362 
__exã∫_Æways_ölöe
 

363 
	$vfw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

364 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__fmt
, 
__gnuc_va_li°
 
__≠
)

366  
	`__vfw¥ötf_chk
 (
__°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

367 
	}
}

371 
wch¨_t
 *
	$__fgëws_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

372 
__FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

373 
wch¨_t
 *
	`__REDIRECT
 (
__fgëws_Æüs
,

374 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
__n
,

375 
__FILE
 *
__ª°ri˘
 
__°ªam
), 
fgëws
Ë
__wur
;

376 
wch¨_t
 *
	`__REDIRECT
 (
__fgëws_chk_w¨n
,

377 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

378 
__FILE
 *
__ª°ri˘
 
__°ªam
), 
__fgëws_chk
)

379 
__wur
 
	`__w¨«âr
 ("fgetws called with bigger sizeÅhanÜength "

382 
__exã∫_Æways_ölöe
 
__wur
 
wch¨_t
 *

383 
	$fgëws
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
__n
, 
__FILE
 *__ª°ri˘ 
__°ªam
)

385 i‡(
	`__bos
 (
__s
Ë!(
size_t
) -1)

387 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
) || __n <= 0)

388  
	`__fgëws_chk
 (
__s
, 
	`__bos
 (__sË/  (
wch¨_t
),

389 
__n
, 
__°ªam
);

391 i‡((
size_t
Ë
__n
 > 
	`__bos
 (
__s
Ë/  (
wch¨_t
))

392  
	`__fgëws_chk_w¨n
 (
__s
, 
	`__bos
 (__sË/  (
wch¨_t
),

393 
__n
, 
__°ªam
);

395  
	`__fgëws_Æüs
 (
__s
, 
__n
, 
__°ªam
);

396 
	}
}

398 #ifde‡
__USE_GNU


399 
wch¨_t
 *
	$__fgëws_u∆ocked_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__size
,

400 
__n
, 
__FILE
 *
__ª°ri˘
 
__°ªam
)

401 
__wur
;

402 
wch¨_t
 *
	`__REDIRECT
 (
__fgëws_u∆ocked_Æüs
,

403 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
__n
,

404 
__FILE
 *
__ª°ri˘
 
__°ªam
), 
fgëws_u∆ocked
)

405 
__wur
;

406 
wch¨_t
 *
	`__REDIRECT
 (
__fgëws_u∆ocked_chk_w¨n
,

407 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

408 
__FILE
 *
__ª°ri˘
 
__°ªam
),

409 
__fgëws_u∆ocked_chk
)

410 
__wur
 
	`__w¨«âr
 ("fgetws_unlocked called with bigger sizeÅhanÜength "

413 
__exã∫_Æways_ölöe
 
__wur
 
wch¨_t
 *

414 
	$fgëws_u∆ocked
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
__n
, 
__FILE
 *__ª°ri˘ 
__°ªam
)

416 i‡(
	`__bos
 (
__s
Ë!(
size_t
) -1)

418 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
) || __n <= 0)

419  
	`__fgëws_u∆ocked_chk
 (
__s
, 
	`__bos
 (__sË/  (
wch¨_t
),

420 
__n
, 
__°ªam
);

422 i‡((
size_t
Ë
__n
 > 
	`__bos
 (
__s
Ë/  (
wch¨_t
))

423  
	`__fgëws_u∆ocked_chk_w¨n
 (
__s
, 
	`__bos
 (__sË/  (
wch¨_t
),

424 
__n
, 
__°ªam
);

426  
	`__fgëws_u∆ocked_Æüs
 (
__s
, 
__n
, 
__°ªam
);

427 
	}
}

431 
size_t
 
	$__w¸tomb_chk
 (*
__s
, 
wch¨_t
 
__wch¨
, 
mb°©e_t
 *
__p
,

432 
size_t
 
__buÊí
Ë
__THROW
 
__wur
;

433 
size_t
 
	`__REDIRECT_NTH
 (
__w¸tomb_Æüs
,

434 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wch¨
,

435 
mb°©e_t
 *
__ª°ri˘
 
__ps
), 
w¸tomb
Ë
__wur
;

437 
__exã∫_Æways_ölöe
 
__wur
 
size_t


438 
	`__NTH
 (
	$w¸tomb
 (*
__s
, 
wch¨_t
 
__wch¨
, 
mb°©e_t
 *
__ps
))

443 
	#__WCHAR_MB_LEN_MAX
 16

	)

444 #i‡
deföed
 
MB_LEN_MAX
 && MB_LEN_MAX !
__WCHAR_MB_LEN_MAX


447 i‡(
	`__bos
 (
__s
Ë!(
size_t
Ë-1 && 
__WCHAR_MB_LEN_MAX
 > __bos (__s))

448  
	`__w¸tomb_chk
 (
__s
, 
__wch¨
, 
__ps
, 
	`__bos
 (__s));

449  
	`__w¸tomb_Æüs
 (
__s
, 
__wch¨
, 
__ps
);

450 
	}
}

453 
size_t
 
	$__mb§towcs_chk
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

454 
__c⁄°
 **
__ª°ri˘
 
__§c
,

455 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

456 
size_t
 
__d°Àn
Ë
__THROW
;

457 
size_t
 
	`__REDIRECT_NTH
 (
__mb§towcs_Æüs
,

458 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

459 
__c⁄°
 **
__ª°ri˘
 
__§c
,

460 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
),

461 
mb§towcs
);

462 
size_t
 
	`__REDIRECT_NTH
 (
__mb§towcs_chk_w¨n
,

463 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

464 
__c⁄°
 **
__ª°ri˘
 
__§c
,

465 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

466 
size_t
 
__d°Àn
), 
__mb§towcs_chk
)

467 
	`__w¨«âr
 ("mbsrtowcs called with dst buffer smallerÅhanÜen "

470 
__exã∫_Æways_ölöe
 
size_t


471 
	`__NTH
 (
	$mb§towcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
, 
__c⁄°
 **__ª°ri˘ 
__§c
,

472 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

474 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

476 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

477  
	`__mb§towcs_chk
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
,

478 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

480 i‡(
__Àn
 > 
	`__bos
 (
__d°
Ë/  (
wch¨_t
))

481  
	`__mb§towcs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
,

482 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

484  
	`__mb§towcs_Æüs
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
);

485 
	}
}

488 
size_t
 
	$__wc§tombs_chk
 (*
__ª°ri˘
 
__d°
,

489 
__c⁄°
 
wch¨_t
 **
__ª°ri˘
 
__§c
,

490 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

491 
size_t
 
__d°Àn
Ë
__THROW
;

492 
size_t
 
	`__REDIRECT_NTH
 (
__wc§tombs_Æüs
,

493 (*
__ª°ri˘
 
__d°
,

494 
__c⁄°
 
wch¨_t
 **
__ª°ri˘
 
__§c
,

495 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
),

496 
wc§tombs
);

497 
size_t
 
	`__REDIRECT_NTH
 (
__wc§tombs_chk_w¨n
,

498 (*
__ª°ri˘
 
__d°
,

499 
__c⁄°
 
wch¨_t
 **
__ª°ri˘
 
__§c
,

500 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

501 
size_t
 
__d°Àn
), 
__wc§tombs_chk
)

502 
	`__w¨«âr
 ("wcsrtombs called with dst buffer smallerÅhanÜen");

504 
__exã∫_Æways_ölöe
 
size_t


505 
	`__NTH
 (
	$wc§tombs
 (*
__ª°ri˘
 
__d°
, 
__c⁄°
 
wch¨_t
 **__ª°ri˘ 
__§c
,

506 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

508 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

510 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

511  
	`__wc§tombs_chk
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
, 
	`__bos
 (__dst));

513 i‡(
__Àn
 > 
	`__bos
 (
__d°
))

514  
	`__wc§tombs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
, 
	`__bos
 (__dst));

516  
	`__wc§tombs_Æüs
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
);

517 
	}
}

520 #ifde‡
__USE_GNU


521 
size_t
 
	$__mb¢πowcs_chk
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

522 
__c⁄°
 **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

523 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

524 
size_t
 
__d°Àn
Ë
__THROW
;

525 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢πowcs_Æüs
,

526 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

527 
__c⁄°
 **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

528 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
),

529 
mb¢πowcs
);

530 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢πowcs_chk_w¨n
,

531 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

532 
__c⁄°
 **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

533 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

534 
size_t
 
__d°Àn
), 
__mb¢πowcs_chk
)

535 
	`__w¨«âr
 ("mbsnrtowcs called with dst buffer smallerÅhanÜen "

538 
__exã∫_Æways_ölöe
 
size_t


539 
	`__NTH
 (
	$mb¢πowcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
, 
__c⁄°
 **__ª°ri˘ 
__§c
,

540 
size_t
 
__nmc
, size_à
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

542 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

544 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

545  
	`__mb¢πowcs_chk
 (
__d°
, 
__§c
, 
__nmc
, 
__Àn
, 
__ps
,

546 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

548 i‡(
__Àn
 > 
	`__bos
 (
__d°
Ë/  (
wch¨_t
))

549  
	`__mb¢πowcs_chk_w¨n
 (
__d°
, 
__§c
, 
__nmc
, 
__Àn
, 
__ps
,

550 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

552  
	`__mb¢πowcs_Æüs
 (
__d°
, 
__§c
, 
__nmc
, 
__Àn
, 
__ps
);

553 
	}
}

556 
size_t
 
	$__wc¢πombs_chk
 (*
__ª°ri˘
 
__d°
,

557 
__c⁄°
 
wch¨_t
 **
__ª°ri˘
 
__§c
,

558 
size_t
 
__nwc
, size_à
__Àn
,

559 
mb°©e_t
 *
__ª°ri˘
 
__ps
, 
size_t
 
__d°Àn
)

560 
__THROW
;

561 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢πombs_Æüs
,

562 (*
__ª°ri˘
 
__d°
,

563 
__c⁄°
 
wch¨_t
 **
__ª°ri˘
 
__§c
,

564 
size_t
 
__nwc
, size_à
__Àn
,

565 
mb°©e_t
 *
__ª°ri˘
 
__ps
), 
wc¢πombs
);

566 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢πombs_chk_w¨n
,

567 (*
__ª°ri˘
 
__d°
,

568 
__c⁄°
 
wch¨_t
 **
__ª°ri˘
 
__§c
,

569 
size_t
 
__nwc
, size_à
__Àn
,

570 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

571 
size_t
 
__d°Àn
), 
__wc¢πombs_chk
)

572 
	`__w¨«âr
 ("wcsnrtombs called with dst buffer smallerÅhanÜen");

574 
__exã∫_Æways_ölöe
 
size_t


575 
	`__NTH
 (
	$wc¢πombs
 (*
__ª°ri˘
 
__d°
, 
__c⁄°
 
wch¨_t
 **__ª°ri˘ 
__§c
,

576 
size_t
 
__nwc
, size_à
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

578 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

580 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

581  
	`__wc¢πombs_chk
 (
__d°
, 
__§c
, 
__nwc
, 
__Àn
, 
__ps
,

582 
	`__bos
 (
__d°
));

584 i‡(
__Àn
 > 
	`__bos
 (
__d°
))

585  
	`__wc¢πombs_chk_w¨n
 (
__d°
, 
__§c
, 
__nwc
, 
__Àn
, 
__ps
,

586 
	`__bos
 (
__d°
));

588  
	`__wc¢πombs_Æüs
 (
__d°
, 
__§c
, 
__nwc
, 
__Àn
, 
__ps
);

589 
	}
}

	@/usr/include/errno.h

23 #i‚def 
_ERRNO_H


27 #i‚def 
__√ed_Em©h


28 
	#_ERRNO_H
 1

	)

29 
	~<„©uªs.h
>

32 
	g__BEGIN_DECLS


36 
	~<bôs/î∫o.h
>

37 #unde‡
__√ed_Em©h


39 #ifdef 
_ERRNO_H


46 #i‚def 
î∫o


47 
î∫o
;

50 #ifde‡
__USE_GNU


55 *
¥ogøm_övoˇti⁄_«me
, *
¥ogøm_övoˇti⁄_sh‹t_«me
;

59 
	g__END_DECLS


67 #i‡
deföed
 
__USE_GNU
 || deföed 
__√ed_îr‹_t


68 #i‚de‡
__îr‹_t_deföed


69 
	tîr‹_t
;

70 
	#__îr‹_t_deföed
 1

	)

72 #unde‡
__√ed_îr‹_t


	@/usr/include/gnu/option-groups.h

10 #i‚de‡
__GNU_OPTION_GROUPS_H


11 
	#__GNU_OPTION_GROUPS_H


	)

13 
	#__OPTION_EGLIBC_ADVANCED_INET6
 1

	)

14 
	#__OPTION_EGLIBC_BACKTRACE
 1

	)

15 
	#__OPTION_EGLIBC_BIG_MACROS
 1

	)

16 
	#__OPTION_EGLIBC_BSD
 1

	)

17 
	#__OPTION_EGLIBC_CATGETS
 1

	)

18 
	#__OPTION_EGLIBC_CHARSETS
 1

	)

19 
	#__OPTION_EGLIBC_CXX_TESTS
 1

	)

20 
	#__OPTION_EGLIBC_DB_ALIASES
 1

	)

21 
	#__OPTION_EGLIBC_ENVZ
 1

	)

22 
	#__OPTION_EGLIBC_FCVT
 1

	)

23 
	#__OPTION_EGLIBC_FMTMSG
 1

	)

24 
	#__OPTION_EGLIBC_FSTAB
 1

	)

25 
	#__OPTION_EGLIBC_FTRAVERSE
 1

	)

26 
	#__OPTION_EGLIBC_GETLOGIN
 1

	)

27 
	#__OPTION_EGLIBC_INET
 1

	)

28 
	#__OPTION_EGLIBC_LIBM
 1

	)

29 
	#__OPTION_EGLIBC_LOCALES
 1

	)

30 
	#__OPTION_EGLIBC_LOCALE_CODE
 1

	)

31 
	#__OPTION_EGLIBC_MEMUSAGE
 1

	)

32 
	#__OPTION_EGLIBC_NIS
 1

	)

33 
	#__OPTION_EGLIBC_NSSWITCH
 1

	)

34 
	#__OPTION_EGLIBC_RCMD
 1

	)

35 
	#__OPTION_EGLIBC_SPAWN
 1

	)

36 
	#__OPTION_EGLIBC_STREAMS
 1

	)

37 
	#__OPTION_EGLIBC_SUNRPC
 1

	)

38 
	#__OPTION_EGLIBC_UTMP
 1

	)

39 
	#__OPTION_EGLIBC_UTMPX
 1

	)

40 
	#__OPTION_EGLIBC_WORDEXP
 1

	)

41 
	#__OPTION_POSIX_C_LANG_WIDE_CHAR
 1

	)

42 
	#__OPTION_POSIX_REGEXP
 1

	)

43 
	#__OPTION_POSIX_REGEXP_GLIBC
 1

	)

44 
	#__OPTION_POSIX_WIDE_CHAR_DEVICE_IO
 1

	)

	@/usr/include/linux/ioctl.h

1 #i‚de‡
_LINUX_IOCTL_H


2 
	#_LINUX_IOCTL_H


	)

4 
	~<asm/io˘l.h
>

	@/usr/include/pthread.h

20 #i‚de‡
_PTHREAD_H


21 
	#_PTHREAD_H
 1

	)

23 
	~<„©uªs.h
>

24 
	~<ídün.h
>

25 
	~<sched.h
>

26 
	~<time.h
>

28 
	#__√ed_sig£t_t


	)

29 
	~<sig«l.h
>

30 
	~<bôs/±hªadty≥s.h
>

31 
	~<bôs/£tjmp.h
>

32 
	~<bôs/w‹dsize.h
>

38 
	mPTHREAD_CREATE_JOINABLE
,

39 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

40 
	mPTHREAD_CREATE_DETACHED


41 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

48 
	mPTHREAD_MUTEX_TIMED_NP
,

49 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

50 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

51 
	mPTHREAD_MUTEX_ADAPTIVE_NP


52 #ifde‡
__USE_UNIX98


54 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

55 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

56 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

57 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


59 #ifde‡
__USE_GNU


61 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


66 #ifde‡
__USE_XOPEN2K


70 
	mPTHREAD_MUTEX_STALLED
,

71 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

72 
	mPTHREAD_MUTEX_ROBUST
,

73 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


78 #ifde‡
__USE_UNIX98


82 
	mPTHREAD_PRIO_NONE
,

83 
	mPTHREAD_PRIO_INHERIT
,

84 
	mPTHREAD_PRIO_PROTECT


90 #i‡
__WORDSIZE
 == 64

91 
	#PTHREAD_MUTEX_INITIALIZER
 \

92 { { 0, 0, 0, 0, 0, 0, { 0, 0 } } }

	)

93 #ifde‡
__USE_GNU


94 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

95 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 0, 0 } } }

	)

96 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

97 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 0, 0 } } }

	)

98 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

99 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 0, 0 } } }

	)

102 
	#PTHREAD_MUTEX_INITIALIZER
 \

103 { { 0, 0, 0, 0, 0, { 0 } } }

	)

104 #ifde‡
__USE_GNU


105 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

106 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 0 } } }

	)

107 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

108 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 0 } } }

	)

109 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

110 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 0 } } }

	)

116 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


119 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

120 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

121 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

122 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


126 
	#PTHREAD_RWLOCK_INITIALIZER
 \

127 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

128 #ifde‡
__USE_GNU


129 #i‡
__WORDSIZE
 == 64

130 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

132 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

134 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


135 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

136 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

137 0, 0, 0, 0 } }

	)

139 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

140 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

141 0 } }

	)

151 
	mPTHREAD_INHERIT_SCHED
,

152 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

153 
	mPTHREAD_EXPLICIT_SCHED


154 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

161 
	mPTHREAD_SCOPE_SYSTEM
,

162 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

163 
	mPTHREAD_SCOPE_PROCESS


164 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

171 
	mPTHREAD_PROCESS_PRIVATE
,

172 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

173 
	mPTHREAD_PROCESS_SHARED


174 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

180 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*Ë0, 0, 0 } }

	)

184 
	s_±hªad_˛ónup_buf„r


186 (*
	m__routöe
) (*);

187 *
	m__¨g
;

188 
	m__ˇn˚…y≥
;

189 
_±hªad_˛ónup_buf„r
 *
	m__¥ev
;

195 
	mPTHREAD_CANCEL_ENABLE
,

196 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

197 
	mPTHREAD_CANCEL_DISABLE


198 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

202 
	mPTHREAD_CANCEL_DEFERRED
,

203 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

204 
	mPTHREAD_CANCEL_ASYNCHRONOUS


205 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

207 
	#PTHREAD_CANCELED
 ((*Ë-1)

	)

211 
	#PTHREAD_ONCE_INIT
 0

	)

214 #ifde‡
__USE_XOPEN2K


218 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

222 
__BEGIN_DECLS


227 
±hªad_¸óã
 (
±hªad_t
 *
__ª°ri˘
 
__√wthªad
,

228 
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

229 *(*
__°¨t_routöe
) (*),

230 *
__ª°ri˘
 
__¨g
Ë
__THROW
 
__n⁄nuŒ
 ((1, 3));

236 
	$±hªad_exô
 (*
__ªtvÆ
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

244 
	`±hªad_joö
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
);

246 #ifde‡
__USE_GNU


249 
	$±hªad_åyjoö_≈
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
Ë
__THROW
;

257 
	`±hªad_timedjoö_≈
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
,

258 
__c⁄°
 
time•ec
 *
__ab°ime
);

265 
	$±hªad_dëach
 (
±hªad_t
 
__th
Ë
__THROW
;

269 
±hªad_t
 
	$±hªad_£lf
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

272 
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
Ë
__THROW
;

280 
	$±hªad_©å_öô
 (
±hªad_©å_t
 *
__©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

283 
	$±hªad_©å_de°roy
 (
±hªad_©å_t
 *
__©å
)

284 
__THROW
 
	`__n⁄nuŒ
 ((1));

287 
	$±hªad_©å_gëdëach°©e
 (
__c⁄°
 
±hªad_©å_t
 *
__©å
,

288 *
__dëach°©e
)

289 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

292 
	$±hªad_©å_£tdëach°©e
 (
±hªad_©å_t
 *
__©å
,

293 
__dëach°©e
)

294 
__THROW
 
	`__n⁄nuŒ
 ((1));

298 
	$±hªad_©å_gëgu¨dsize
 (
__c⁄°
 
±hªad_©å_t
 *
__©å
,

299 
size_t
 *
__gu¨dsize
)

300 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

303 
	$±hªad_©å_£tgu¨dsize
 (
±hªad_©å_t
 *
__©å
,

304 
size_t
 
__gu¨dsize
)

305 
__THROW
 
	`__n⁄nuŒ
 ((1));

309 
	$±hªad_©å_gësched∑øm
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


310 
__©å
,

311 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

312 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

315 
	$±hªad_©å_£tsched∑øm
 (
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

316 
__c⁄°
 
sched_∑øm
 *
__ª°ri˘


317 
__∑øm
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

320 
	$±hªad_©å_gëschedpﬁicy
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


321 
__©å
, *
__ª°ri˘
 
__pﬁicy
)

322 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

325 
	$±hªad_©å_£tschedpﬁicy
 (
±hªad_©å_t
 *
__©å
, 
__pﬁicy
)

326 
__THROW
 
	`__n⁄nuŒ
 ((1));

329 
	$±hªad_©å_gëöhîôsched
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


330 
__©å
, *
__ª°ri˘
 
__öhîô
)

331 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

334 
	$±hªad_©å_£töhîôsched
 (
±hªad_©å_t
 *
__©å
,

335 
__öhîô
)

336 
__THROW
 
	`__n⁄nuŒ
 ((1));

340 
	$±hªad_©å_gësc›e
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

341 *
__ª°ri˘
 
__sc›e
)

342 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

345 
	$±hªad_©å_£tsc›e
 (
±hªad_©å_t
 *
__©å
, 
__sc›e
)

346 
__THROW
 
	`__n⁄nuŒ
 ((1));

349 
	$±hªad_©å_gë°ackaddr
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


350 
__©å
, **
__ª°ri˘
 
__°ackaddr
)

351 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__©åibuã_dïªˇãd__
;

357 
	$±hªad_©å_£t°ackaddr
 (
±hªad_©å_t
 *
__©å
,

358 *
__°ackaddr
)

359 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
;

362 
	$±hªad_©å_gë°acksize
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


363 
__©å
, 
size_t
 *
__ª°ri˘
 
__°acksize
)

364 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

369 
	$±hªad_©å_£t°acksize
 (
±hªad_©å_t
 *
__©å
,

370 
size_t
 
__°acksize
)

371 
__THROW
 
	`__n⁄nuŒ
 ((1));

373 #ifde‡
__USE_XOPEN2K


375 
	$±hªad_©å_gë°ack
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

376 **
__ª°ri˘
 
__°ackaddr
,

377 
size_t
 *
__ª°ri˘
 
__°acksize
)

378 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

383 
	$±hªad_©å_£t°ack
 (
±hªad_©å_t
 *
__©å
, *
__°ackaddr
,

384 
size_t
 
__°acksize
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

387 #ifde‡
__USE_GNU


390 
	$±hªad_©å_£èfföôy_≈
 (
±hªad_©å_t
 *
__©å
,

391 
size_t
 
__˝u£tsize
,

392 
__c⁄°
 
˝u_£t_t
 *
__˝u£t
)

393 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

397 
	$±hªad_©å_gëafföôy_≈
 (
__c⁄°
 
±hªad_©å_t
 *
__©å
,

398 
size_t
 
__˝u£tsize
,

399 
˝u_£t_t
 *
__˝u£t
)

400 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

406 
	$±hªad_gë©å_≈
 (
±hªad_t
 
__th
, 
±hªad_©å_t
 *
__©å
)

407 
__THROW
 
	`__n⁄nuŒ
 ((2));

415 
	$±hªad_£tsched∑øm
 (
±hªad_t
 
__èrgë_thªad
, 
__pﬁicy
,

416 
__c⁄°
 
sched_∑øm
 *
__∑øm
)

417 
__THROW
 
	`__n⁄nuŒ
 ((3));

420 
	$±hªad_gësched∑øm
 (
±hªad_t
 
__èrgë_thªad
,

421 *
__ª°ri˘
 
__pﬁicy
,

422 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

423 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

426 
	$±hªad_£tsched¥io
 (
±hªad_t
 
__èrgë_thªad
, 
__¥io
)

427 
__THROW
;

430 #ifde‡
__USE_UNIX98


432 
	$±hªad_gëc⁄cuºícy
 (Ë
__THROW
;

435 
	$±hªad_£tc⁄cuºícy
 (
__Àvñ
Ë
__THROW
;

438 #ifde‡
__USE_GNU


443 
	$±hªad_yõld
 (Ë
__THROW
;

448 
	$±hªad_£èfföôy_≈
 (
±hªad_t
 
__th
, 
size_t
 
__˝u£tsize
,

449 
__c⁄°
 
˝u_£t_t
 *
__˝u£t
)

450 
__THROW
 
	`__n⁄nuŒ
 ((3));

453 
	$±hªad_gëafföôy_≈
 (
±hªad_t
 
__th
, 
size_t
 
__˝u£tsize
,

454 
˝u_£t_t
 *
__˝u£t
)

455 
__THROW
 
	`__n⁄nuŒ
 ((3));

468 
	`±hªad_⁄˚
 (
±hªad_⁄˚_t
 *
__⁄˚_c⁄åﬁ
,

469 (*
__öô_routöe
Ë()Ë
	`__n⁄nuŒ
 ((1, 2));

480 
	`±hªad_£tˇn˚l°©e
 (
__°©e
, *
__ﬁd°©e
);

484 
	`±hªad_£tˇn˚…y≥
 (
__ty≥
, *
__ﬁdty≥
);

487 
	`±hªad_ˇn˚l
 (
±hªad_t
 
__th
);

492 
	`±hªad_ã°ˇn˚l
 ();

501 
__jmp_buf
 
__ˇn˚l_jmp_buf
;

502 
__mask_was_ßved
;

503 } 
__ˇn˚l_jmp_buf
[1];

504 *
__∑d
[4];

505 } 
	t__±hªad_unwöd_buf_t
 
	t__©åibuã__
 ((
	t__Æig√d__
));

508 #i‚de‡
__˛ónup_f˘_©åibuã


509 
	#__˛ónup_f˘_©åibuã


	)

514 
	s__±hªad_˛ónup_‰ame


516 (*
__ˇn˚l_routöe
) (*);

517 *
__ˇn˚l_¨g
;

518 
__do_ô
;

519 
__ˇn˚l_ty≥
;

522 #i‡
deföed
 
__GNUC__
 && deföed 
__EXCEPTIONS


523 #ifde‡
__˝lu•lus


525 ˛as†
	c__±hªad_˛ónup_˛ass


527 (*
__ˇn˚l_routöe
) (*);

528 *
__ˇn˚l_¨g
;

529 
__do_ô
;

530 
__ˇn˚l_ty≥
;

532 
public
:

533 
	`__±hªad_˛ónup_˛ass
 ((*
__f˘
Ë(*), *
__¨g
)

534 : 
	`__ˇn˚l_routöe
 (
__f˘
), 
	`__ˇn˚l_¨g
 (
__¨g
), 
	$__do_ô
 (1) { }

535 ~
	$__±hªad_˛ónup_˛ass
 (Ë{ i‡(
__do_ô
Ë
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); 
	}
}

536 
	$__£tdoô
 (
__√wvÆ
Ë{ 
__do_ô
 = __√wvÆ; 
	}
}

537 
	$__de„r
 (Ë{ 
	`±hªad_£tˇn˚…y≥
 (
PTHREAD_CANCEL_DEFERRED
,

538 &
__ˇn˚l_ty≥
); 
	}
}

539 
	$__ª°‹e
 (Ëc⁄° { 
	`±hªad_£tˇn˚…y≥
 (
__ˇn˚l_ty≥
, 0); 
	}
}

549 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

551 
__±hªad_˛ónup_˛ass
 
	`__˛‰ame
 (
routöe
, 
¨g
)

	)

555 
	#±hªad_˛ónup_p›
(
execuã
) \

556 
__˛‰ame
.
	`__£tdoô
 (
execuã
); \

557 } 0)

	)

559 #ifde‡
__USE_GNU


563 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

565 
__±hªad_˛ónup_˛ass
 
	`__˛‰ame
 (
routöe
, 
¨g
); \

566 
__˛‰ame
.
	`__de„r
 ()

	)

571 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

572 
__˛‰ame
.
	`__ª°‹e
 (); \

573 
__˛‰ame
.
	`__£tdoô
 (
execuã
); \

574 } 0)

	)

581 
__exã∫_ölöe
 

582 
	$__±hªad_˛ónup_routöe
 (
__±hªad_˛ónup_‰ame
 *
__‰ame
)

584 i‡(
__‰ame
->
__do_ô
)

585 
__‰ame
->
	`__ˇn˚l_routöe
 (__‰ame->
__ˇn˚l_¨g
);

586 
	}
}

595 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

597 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

598 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__±hªad_˛ónup_routöe
))) \

599 { .
__ˇn˚l_routöe
 = (
routöe
), .
__ˇn˚l_¨g
 = (
¨g
), \

600 .
__do_ô
 = 1 };

	)

604 
	#±hªad_˛ónup_p›
(
execuã
) \

605 
__˛‰ame
.
__do_ô
 = (
execuã
); \

606 } 0)

	)

608 #ifde‡
__USE_GNU


612 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

614 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

615 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__±hªad_˛ónup_routöe
))) \

616 { .
__ˇn˚l_routöe
 = (
routöe
), .
__ˇn˚l_¨g
 = (
¨g
), \

617 .
__do_ô
 = 1 }; \

618 (Ë
	`±hªad_£tˇn˚…y≥
 (
PTHREAD_CANCEL_DEFERRED
, \

619 &
__˛‰ame
.
__ˇn˚l_ty≥
)

	)

624 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

625 (Ë
	`±hªad_£tˇn˚…y≥
 (
__˛‰ame
.
__ˇn˚l_ty≥
, 
NULL
); \

626 
__˛‰ame
.
__do_ô
 = (
execuã
); \

627 } 0)

	)

638 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

640 
__±hªad_unwöd_buf_t
 
__ˇn˚l_buf
; \

641 (*
__ˇn˚l_routöe
Ë(*Ë(
routöe
); \

642 *
__ˇn˚l_¨g
 = (
¨g
); \

643 
nŸ_fú°_ˇŒ
 = 
	`__sig£tjmp
 ((
__jmp_buf_èg
 *) (*) \

644 
__ˇn˚l_buf
.
__ˇn˚l_jmp_buf
, 0); \

645 i‡(
	`__buûtö_ex≥˘
 (
nŸ_fú°_ˇŒ
, 0)) \

647 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

648 
	`__±hªad_unwöd_√xt
 (&
__ˇn˚l_buf
); \

652 
	`__±hªad_ªgi°î_ˇn˚l
 (&
__ˇn˚l_buf
); \

653 dÿ{

	)

654 
__±hªad_ªgi°î_ˇn˚l
 (
__±hªad_unwöd_buf_t
 *
__buf
)

655 
__˛ónup_f˘_©åibuã
;

659 
	#±hªad_˛ónup_p›
(
execuã
) \

662 
	`__±hªad_uƒegi°î_ˇn˚l
 (&
__ˇn˚l_buf
); \

663 i‡(
execuã
) \

664 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

665 } 0)

	)

666 
	$__±hªad_uƒegi°î_ˇn˚l
 (
__±hªad_unwöd_buf_t
 *
__buf
)

667 
__˛ónup_f˘_©åibuã
;

669 #ifde‡
__USE_GNU


673 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

675 
__±hªad_unwöd_buf_t
 
__ˇn˚l_buf
; \

676 (*
__ˇn˚l_routöe
Ë(*Ë(
routöe
); \

677 *
__ˇn˚l_¨g
 = (
¨g
); \

678 
nŸ_fú°_ˇŒ
 = 
	`__sig£tjmp
 ((
__jmp_buf_èg
 *) (*) \

679 
__ˇn˚l_buf
.
__ˇn˚l_jmp_buf
, 0); \

680 i‡(
	`__buûtö_ex≥˘
 (
nŸ_fú°_ˇŒ
, 0)) \

682 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

683 
	`__±hªad_unwöd_√xt
 (&
__ˇn˚l_buf
); \

687 
	`__±hªad_ªgi°î_ˇn˚l_de„r
 (&
__ˇn˚l_buf
); \

688 dÿ{

	)

689 
	`__±hªad_ªgi°î_ˇn˚l_de„r
 (
__±hªad_unwöd_buf_t
 *
__buf
)

690 
__˛ónup_f˘_©åibuã
;

695 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

698 
	`__±hªad_uƒegi°î_ˇn˚l_ª°‹e
 (&
__ˇn˚l_buf
); \

699 i‡(
execuã
) \

700 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

701 
	}
} 0)

	)

702 
	$__±hªad_uƒegi°î_ˇn˚l_ª°‹e
 (
__±hªad_unwöd_buf_t
 *
__buf
)

703 
__˛ónup_f˘_©åibuã
;

707 
	$__±hªad_unwöd_√xt
 (
__±hªad_unwöd_buf_t
 *
__buf
)

708 
__˛ónup_f˘_©åibuã
 
	`__©åibuã__
 ((
__n‹ëu∫__
))

709 #i‚de‡
SHARED


710 
	`__©åibuã__
 ((
__wók__
))

716 
__jmp_buf_èg
;

717 
	$__sig£tjmp
 (
__jmp_buf_èg
 *
__ív
, 
__ßvemask
Ë
__THROW
;

723 
	$±hªad_muãx_öô
 (
±hªad_muãx_t
 *
__muãx
,

724 
__c⁄°
 
±hªad_muãx©å_t
 *
__muãx©å
)

725 
__THROW
 
	`__n⁄nuŒ
 ((1));

728 
	$±hªad_muãx_de°roy
 (
±hªad_muãx_t
 *
__muãx
)

729 
__THROW
 
	`__n⁄nuŒ
 ((1));

732 
	$±hªad_muãx_åylock
 (
±hªad_muãx_t
 *
__muãx
)

733 
__THROW
 
	`__n⁄nuŒ
 ((1));

736 
	$±hªad_muãx_lock
 (
±hªad_muãx_t
 *
__muãx
)

737 
__THROW
 
	`__n⁄nuŒ
 ((1));

739 #ifde‡
__USE_XOPEN2K


741 
	$±hªad_muãx_timedlock
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

742 
__c⁄°
 
time•ec
 *
__ª°ri˘


743 
__ab°ime
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

747 
	$±hªad_muãx_u∆ock
 (
±hªad_muãx_t
 *
__muãx
)

748 
__THROW
 
	`__n⁄nuŒ
 ((1));

751 #ifde‡
__USE_UNIX98


753 
	$±hªad_muãx_gë¥io˚ûög
 (
__c⁄°
 
±hªad_muãx_t
 *

754 
__ª°ri˘
 
__muãx
,

755 *
__ª°ri˘
 
__¥io˚ûög
)

756 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

760 
	$±hªad_muãx_£çrio˚ûög
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

761 
__¥io˚ûög
,

762 *
__ª°ri˘
 
__ﬁd_˚ûög
)

763 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

767 #ifde‡
__USE_XOPEN2K8


769 
	$±hªad_muãx_c⁄si°ít_≈
 (
±hªad_muãx_t
 *
__muãx
)

770 
__THROW
 
	`__n⁄nuŒ
 ((1));

771 #ifde‡
__USE_GNU


772 
	$±hªad_muãx_c⁄si°ít_≈
 (
±hªad_muãx_t
 *
__muãx
)

773 
__THROW
 
	`__n⁄nuŒ
 ((1));

782 
	$±hªad_muãx©å_öô
 (
±hªad_muãx©å_t
 *
__©å
)

783 
__THROW
 
	`__n⁄nuŒ
 ((1));

786 
	$±hªad_muãx©å_de°roy
 (
±hªad_muãx©å_t
 *
__©å
)

787 
__THROW
 
	`__n⁄nuŒ
 ((1));

790 
	$±hªad_muãx©å_gëpsh¨ed
 (
__c⁄°
 
±hªad_muãx©å_t
 *

791 
__ª°ri˘
 
__©å
,

792 *
__ª°ri˘
 
__psh¨ed
)

793 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

796 
	$±hªad_muãx©å_£çsh¨ed
 (
±hªad_muãx©å_t
 *
__©å
,

797 
__psh¨ed
)

798 
__THROW
 
	`__n⁄nuŒ
 ((1));

800 #ifde‡
__USE_UNIX98


802 
	$±hªad_muãx©å_gëty≥
 (
__c⁄°
 
±hªad_muãx©å_t
 *
__ª°ri˘


803 
__©å
, *
__ª°ri˘
 
__köd
)

804 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

809 
	$±hªad_muãx©å_£ây≥
 (
±hªad_muãx©å_t
 *
__©å
, 
__köd
)

810 
__THROW
 
	`__n⁄nuŒ
 ((1));

813 
	$±hªad_muãx©å_gë¥Ÿocﬁ
 (
__c⁄°
 
±hªad_muãx©å_t
 *

814 
__ª°ri˘
 
__©å
,

815 *
__ª°ri˘
 
__¥Ÿocﬁ
)

816 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

820 
	$±hªad_muãx©å_£çrŸocﬁ
 (
±hªad_muãx©å_t
 *
__©å
,

821 
__¥Ÿocﬁ
)

822 
__THROW
 
	`__n⁄nuŒ
 ((1));

825 
	$±hªad_muãx©å_gë¥io˚ûög
 (
__c⁄°
 
±hªad_muãx©å_t
 *

826 
__ª°ri˘
 
__©å
,

827 *
__ª°ri˘
 
__¥io˚ûög
)

828 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

831 
	$±hªad_muãx©å_£çrio˚ûög
 (
±hªad_muãx©å_t
 *
__©å
,

832 
__¥io˚ûög
)

833 
__THROW
 
	`__n⁄nuŒ
 ((1));

836 #ifde‡
__USE_XOPEN2K


838 
	$±hªad_muãx©å_gërobu°
 (
__c⁄°
 
±hªad_muãx©å_t
 *
__©å
,

839 *
__robu°√ss
)

840 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

841 #ifde‡
__USE_GNU


842 
	$±hªad_muãx©å_gërobu°_≈
 (
__c⁄°
 
±hªad_muãx©å_t
 *
__©å
,

843 *
__robu°√ss
)

844 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

848 
	$±hªad_muãx©å_£åobu°
 (
±hªad_muãx©å_t
 *
__©å
,

849 
__robu°√ss
)

850 
__THROW
 
	`__n⁄nuŒ
 ((1));

851 #ifde‡
__USE_GNU


852 
	$±hªad_muãx©å_£åobu°_≈
 (
±hªad_muãx©å_t
 *
__©å
,

853 
__robu°√ss
)

854 
__THROW
 
	`__n⁄nuŒ
 ((1));

859 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


864 
	$±hªad_rwlock_öô
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

865 
__c⁄°
 
±hªad_rwlock©å_t
 *
__ª°ri˘


866 
__©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

869 
	$±hªad_rwlock_de°roy
 (
±hªad_rwlock_t
 *
__rwlock
)

870 
__THROW
 
	`__n⁄nuŒ
 ((1));

873 
	$±hªad_rwlock_rdlock
 (
±hªad_rwlock_t
 *
__rwlock
)

874 
__THROW
 
	`__n⁄nuŒ
 ((1));

877 
	$±hªad_rwlock_åyrdlock
 (
±hªad_rwlock_t
 *
__rwlock
)

878 
__THROW
 
	`__n⁄nuŒ
 ((1));

880 #ifde‡
__USE_XOPEN2K


882 
	$±hªad_rwlock_timedrdlock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

883 
__c⁄°
 
time•ec
 *
__ª°ri˘


884 
__ab°ime
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

888 
	$±hªad_rwlock_wæock
 (
±hªad_rwlock_t
 *
__rwlock
)

889 
__THROW
 
	`__n⁄nuŒ
 ((1));

892 
	$±hªad_rwlock_åywæock
 (
±hªad_rwlock_t
 *
__rwlock
)

893 
__THROW
 
	`__n⁄nuŒ
 ((1));

895 #ifde‡
__USE_XOPEN2K


897 
	$±hªad_rwlock_timedwæock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

898 
__c⁄°
 
time•ec
 *
__ª°ri˘


899 
__ab°ime
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

903 
	$±hªad_rwlock_u∆ock
 (
±hªad_rwlock_t
 *
__rwlock
)

904 
__THROW
 
	`__n⁄nuŒ
 ((1));

910 
	$±hªad_rwlock©å_öô
 (
±hªad_rwlock©å_t
 *
__©å
)

911 
__THROW
 
	`__n⁄nuŒ
 ((1));

914 
	$±hªad_rwlock©å_de°roy
 (
±hªad_rwlock©å_t
 *
__©å
)

915 
__THROW
 
	`__n⁄nuŒ
 ((1));

918 
	$±hªad_rwlock©å_gëpsh¨ed
 (
__c⁄°
 
±hªad_rwlock©å_t
 *

919 
__ª°ri˘
 
__©å
,

920 *
__ª°ri˘
 
__psh¨ed
)

921 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

924 
	$±hªad_rwlock©å_£çsh¨ed
 (
±hªad_rwlock©å_t
 *
__©å
,

925 
__psh¨ed
)

926 
__THROW
 
	`__n⁄nuŒ
 ((1));

929 
	$±hªad_rwlock©å_gëköd_≈
 (
__c⁄°
 
±hªad_rwlock©å_t
 *

930 
__ª°ri˘
 
__©å
,

931 *
__ª°ri˘
 
__¥ef
)

932 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

935 
	$±hªad_rwlock©å_£tköd_≈
 (
±hªad_rwlock©å_t
 *
__©å
,

936 
__¥ef
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

944 
	$±hªad_c⁄d_öô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

945 
__c⁄°
 
±hªad_c⁄d©å_t
 *
__ª°ri˘


946 
__c⁄d_©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

949 
	$±hªad_c⁄d_de°roy
 (
±hªad_c⁄d_t
 *
__c⁄d
)

950 
__THROW
 
	`__n⁄nuŒ
 ((1));

953 
	$±hªad_c⁄d_sig«l
 (
±hªad_c⁄d_t
 *
__c⁄d
)

954 
__THROW
 
	`__n⁄nuŒ
 ((1));

957 
	$±hªad_c⁄d_brﬂdˇ°
 (
±hªad_c⁄d_t
 *
__c⁄d
)

958 
__THROW
 
	`__n⁄nuŒ
 ((1));

965 
	$±hªad_c⁄d_waô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

966 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
)

967 
	`__n⁄nuŒ
 ((1, 2));

976 
	$±hªad_c⁄d_timedwaô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

977 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

978 
__c⁄°
 
time•ec
 *
__ª°ri˘


979 
__ab°ime
Ë
	`__n⁄nuŒ
 ((1, 2, 3));

984 
	$±hªad_c⁄d©å_öô
 (
±hªad_c⁄d©å_t
 *
__©å
)

985 
__THROW
 
	`__n⁄nuŒ
 ((1));

988 
	$±hªad_c⁄d©å_de°roy
 (
±hªad_c⁄d©å_t
 *
__©å
)

989 
__THROW
 
	`__n⁄nuŒ
 ((1));

992 
	$±hªad_c⁄d©å_gëpsh¨ed
 (
__c⁄°
 
±hªad_c⁄d©å_t
 *

993 
__ª°ri˘
 
__©å
,

994 *
__ª°ri˘
 
__psh¨ed
)

995 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

998 
	$±hªad_c⁄d©å_£çsh¨ed
 (
±hªad_c⁄d©å_t
 *
__©å
,

999 
__psh¨ed
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

1001 #ifde‡
__USE_XOPEN2K


1003 
	$±hªad_c⁄d©å_gë˛ock
 (
__c⁄°
 
±hªad_c⁄d©å_t
 *

1004 
__ª°ri˘
 
__©å
,

1005 
__˛ockid_t
 *
__ª°ri˘
 
__˛ock_id
)

1006 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1009 
	$±hªad_c⁄d©å_£t˛ock
 (
±hªad_c⁄d©å_t
 *
__©å
,

1010 
__˛ockid_t
 
__˛ock_id
)

1011 
__THROW
 
	`__n⁄nuŒ
 ((1));

1015 #ifde‡
__USE_XOPEN2K


1020 
	$±hªad_•ö_öô
 (
±hªad_•ölock_t
 *
__lock
, 
__psh¨ed
)

1021 
__THROW
 
	`__n⁄nuŒ
 ((1));

1024 
	$±hªad_•ö_de°roy
 (
±hªad_•ölock_t
 *
__lock
)

1025 
__THROW
 
	`__n⁄nuŒ
 ((1));

1028 
	$±hªad_•ö_lock
 (
±hªad_•ölock_t
 *
__lock
)

1029 
__THROW
 
	`__n⁄nuŒ
 ((1));

1032 
	$±hªad_•ö_åylock
 (
±hªad_•ölock_t
 *
__lock
)

1033 
__THROW
 
	`__n⁄nuŒ
 ((1));

1036 
	$±hªad_•ö_u∆ock
 (
±hªad_•ölock_t
 *
__lock
)

1037 
__THROW
 
	`__n⁄nuŒ
 ((1));

1044 
	$±hªad_b¨rõr_öô
 (
±hªad_b¨rõr_t
 *
__ª°ri˘
 
__b¨rõr
,

1045 
__c⁄°
 
±hªad_b¨rõøâr_t
 *
__ª°ri˘


1046 
__©å
, 
__cou¡
)

1047 
__THROW
 
	`__n⁄nuŒ
 ((1));

1050 
	$±hªad_b¨rõr_de°roy
 (
±hªad_b¨rõr_t
 *
__b¨rõr
)

1051 
__THROW
 
	`__n⁄nuŒ
 ((1));

1054 
	$±hªad_b¨rõr_waô
 (
±hªad_b¨rõr_t
 *
__b¨rõr
)

1055 
__THROW
 
	`__n⁄nuŒ
 ((1));

1059 
	$±hªad_b¨rõøâr_öô
 (
±hªad_b¨rõøâr_t
 *
__©å
)

1060 
__THROW
 
	`__n⁄nuŒ
 ((1));

1063 
	$±hªad_b¨rõøâr_de°roy
 (
±hªad_b¨rõøâr_t
 *
__©å
)

1064 
__THROW
 
	`__n⁄nuŒ
 ((1));

1067 
	$±hªad_b¨rõøâr_gëpsh¨ed
 (
__c⁄°
 
±hªad_b¨rõøâr_t
 *

1068 
__ª°ri˘
 
__©å
,

1069 *
__ª°ri˘
 
__psh¨ed
)

1070 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1073 
	$±hªad_b¨rõøâr_£çsh¨ed
 (
±hªad_b¨rõøâr_t
 *
__©å
,

1074 
__psh¨ed
)

1075 
__THROW
 
	`__n⁄nuŒ
 ((1));

1087 
	`±hªad_key_¸óã
 (
±hªad_key_t
 *
__key
,

1088 (*
__de°r_fun˘i⁄
) (*))

1089 
__THROW
 
	`__n⁄nuŒ
 ((1));

1092 
	$±hªad_key_dñëe
 (
±hªad_key_t
 
__key
Ë
__THROW
;

1095 *
	$±hªad_gë•ecific
 (
±hªad_key_t
 
__key
Ë
__THROW
;

1098 
	$±hªad_£t•ecific
 (
±hªad_key_t
 
__key
,

1099 
__c⁄°
 *
__poöãr
Ë
__THROW
 ;

1102 #ifde‡
__USE_XOPEN2K


1104 
	$±hªad_gë˝u˛ockid
 (
±hªad_t
 
__thªad_id
,

1105 
__˛ockid_t
 *
__˛ock_id
)

1106 
__THROW
 
	`__n⁄nuŒ
 ((2));

1121 
	`±hªad_©f‹k
 ((*
__¥ï¨e
) (),

1122 (*
__∑ª¡
) (),

1123 (*
__chûd
Ë()Ë
__THROW
;

1126 #ifde‡
__USE_EXTERN_INLINES


1128 
__exã∫_ölöe
 

1129 
	`__NTH
 (
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
))

1131  
__thªad1
 =
__thªad2
;

1132 
	}
}

1135 
	g__END_DECLS


	@/usr/include/wctype.h

24 #i‚de‡
_WCTYPE_H


26 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

29 #i‚de‡
__√ed_iswxxx


30 
	#_WCTYPE_H
 1

	)

33 
	#__√ed_wöt_t


	)

34 
	~<°ddef.h
>

38 #i‚de‡
WEOF


39 
	#WEOF
 (0xffffffffu)

	)

42 #unde‡
__√ed_iswxxx


47 #i‚de‡
__iswxxx_deföed


48 
	#__iswxxx_deföed
 1

	)

50 
__BEGIN_NAMESPACE_C99


53 
	tw˘y≥_t
;

54 
	g__END_NAMESPACE_C99


56 #i‚de‡
_ISwbô


61 
	~<ídün.h
>

62 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


63 
	#_ISwbô
(
bô
Ë(1 << (bô))

	)

65 
	#_ISwbô
(
bô
) \

66 ((
bô
) < 8 ? () ((1UL << (bit)) << 24) \

67 : ((
bô
) < 16 ? () ((1UL << (bit)) << 8) \

68 : ((
bô
) < 24 ? () ((1UL << (bit)) >> 8) \

69 : (Ë((1UL << (
bô
)Ë>> 24))))

	)

74 
	m__ISwuµî
 = 0,

75 
	m__ISwlowî
 = 1,

76 
	m__ISwÆpha
 = 2,

77 
	m__ISwdigô
 = 3,

78 
	m__ISwxdigô
 = 4,

79 
	m__ISw•a˚
 = 5,

80 
	m__ISw¥öt
 = 6,

81 
	m__ISwgøph
 = 7,

82 
	m__ISwbœnk
 = 8,

83 
	m__ISw˙ål
 = 9,

84 
	m__ISwpun˘
 = 10,

85 
	m__ISwÆnum
 = 11,

87 
	m_ISwuµî
 = 
_ISwbô
 (
__ISwuµî
),

88 
	m_ISwlowî
 = 
_ISwbô
 (
__ISwlowî
),

89 
	m_ISwÆpha
 = 
_ISwbô
 (
__ISwÆpha
),

90 
	m_ISwdigô
 = 
_ISwbô
 (
__ISwdigô
),

91 
	m_ISwxdigô
 = 
_ISwbô
 (
__ISwxdigô
),

92 
	m_ISw•a˚
 = 
_ISwbô
 (
__ISw•a˚
),

93 
	m_ISw¥öt
 = 
_ISwbô
 (
__ISw¥öt
),

94 
	m_ISwgøph
 = 
_ISwbô
 (
__ISwgøph
),

95 
	m_ISwbœnk
 = 
_ISwbô
 (
__ISwbœnk
),

96 
	m_ISw˙ål
 = 
_ISwbô
 (
__ISw˙ål
),

97 
	m_ISwpun˘
 = 
_ISwbô
 (
__ISwpun˘
),

98 
	m_ISwÆnum
 = 
_ISwbô
 (
__ISwÆnum
)

103 
__BEGIN_DECLS


105 
__BEGIN_NAMESPACE_C99


112 
	$iswÆnum
 (
wöt_t
 
__wc
Ë
__THROW
;

118 
	$iswÆpha
 (
wöt_t
 
__wc
Ë
__THROW
;

121 
	$isw˙ål
 (
wöt_t
 
__wc
Ë
__THROW
;

125 
	$iswdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

129 
	$iswgøph
 (
wöt_t
 
__wc
Ë
__THROW
;

134 
	$iswlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

137 
	$isw¥öt
 (
wöt_t
 
__wc
Ë
__THROW
;

142 
	$iswpun˘
 (
wöt_t
 
__wc
Ë
__THROW
;

147 
	$isw•a˚
 (
wöt_t
 
__wc
Ë
__THROW
;

152 
	$iswuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

157 
	$iswxdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

162 #ifde‡
__USE_ISOC99


163 
	$iswbœnk
 (
wöt_t
 
__wc
Ë
__THROW
;

172 
w˘y≥_t
 
	$w˘y≥
 (
__c⁄°
 *
__¥›îty
Ë
__THROW
;

176 
	$isw˘y≥
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
Ë
__THROW
;

177 
__END_NAMESPACE_C99


184 
__BEGIN_NAMESPACE_C99


187 
__c⁄°
 
	t__öt32_t
 *
	tw˘øns_t
;

188 
__END_NAMESPACE_C99


189 #ifde‡
__USE_GNU


190 
	$__USING_NAMESPACE_C99
(
w˘øns_t
)

193 
__BEGIN_NAMESPACE_C99


195 
wöt_t
 
	$towlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

198 
wöt_t
 
	$towuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

199 
__END_NAMESPACE_C99


201 
__END_DECLS


208 #ifde‡
_WCTYPE_H


214 
__BEGIN_DECLS


216 
__BEGIN_NAMESPACE_C99


219 
w˘øns_t
 
	$w˘øns
 (
__c⁄°
 *
__¥›îty
Ë
__THROW
;

222 
wöt_t
 
	$tow˘øns
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
Ë
__THROW
;

223 
__END_NAMESPACE_C99


225 #ifde‡
__USE_XOPEN2K8


227 
	~<xloˇÀ.h
>

231 
	$iswÆnum_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

237 
	$iswÆpha_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

240 
	$isw˙ål_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

244 
	$iswdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

248 
	$iswgøph_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

253 
	$iswlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

256 
	$isw¥öt_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

261 
	$iswpun˘_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

266 
	$isw•a˚_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

271 
	$iswuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

276 
	$iswxdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

281 
	$iswbœnk_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

285 
w˘y≥_t
 
	$w˘y≥_l
 (
__c⁄°
 *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

286 
__THROW
;

290 
	$isw˘y≥_l
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
, 
__loˇÀ_t
 
__loˇÀ
)

291 
__THROW
;

299 
wöt_t
 
	$towlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

302 
wöt_t
 
	$towuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

306 
w˘øns_t
 
	$w˘øns_l
 (
__c⁄°
 *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

307 
__THROW
;

310 
wöt_t
 
	$tow˘øns_l
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
,

311 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

315 
__END_DECLS


	@/usr/include/asm-generic/sockios.h

1 #i‚de‡
__ASM_GENERIC_SOCKIOS_H


2 
	#__ASM_GENERIC_SOCKIOS_H


	)

5 
	#FIOSETOWN
 0x8901

	)

6 
	#SIOCSPGRP
 0x8902

	)

7 
	#FIOGETOWN
 0x8903

	)

8 
	#SIOCGPGRP
 0x8904

	)

9 
	#SIOCATMARK
 0x8905

	)

10 
	#SIOCGSTAMP
 0x8906

	)

11 
	#SIOCGSTAMPNS
 0x8907

	)

	@/usr/include/asm/bitsperlong.h

1 #i‚de‡
__ASM_X86_BITSPERLONG_H


2 
	#__ASM_X86_BITSPERLONG_H


	)

4 #ifde‡
__x86_64__


5 
	#__BITS_PER_LONG
 64

	)

7 
	#__BITS_PER_LONG
 32

	)

10 
	~<asm-gíîic/bô•îl⁄g.h
>

	@/usr/include/asm/ioctl.h

1 
	~<asm-gíîic/io˘l.h
>

	@/usr/include/bits/errno.h

20 #ifde‡
_ERRNO_H


22 #unde‡
EDOM


23 #unde‡
EILSEQ


24 #unde‡
ERANGE


25 
	~<löux/î∫o.h
>

28 
	#ENOTSUP
 
EOPNOTSUPP


	)

31 #i‚de‡
ECANCELED


32 
	#ECANCELED
 125

	)

36 #i‚de‡
EOWNERDEAD


37 
	#EOWNERDEAD
 130

	)

38 
	#ENOTRECOVERABLE
 131

	)

41 #i‚de‡
__ASSEMBLER__


43 *
	$__î∫o_loˇti⁄
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

45 #i‡!
deföed
 
_LIBC
 || deföed 
_LIBC_REENTRANT


47 
	#î∫o
 (*
	`__î∫o_loˇti⁄
 ())

	)

52 #i‡!
deföed
 
_ERRNO_H
 && deföed 
__√ed_Em©h


56 
	#EDOM
 33

	)

57 
	#EILSEQ
 84

	)

58 
	#ERANGE
 34

	)

	@/usr/include/bits/setjmp.h

20 #i‚de‡
_BITS_SETJMP_H


21 
	#_BITS_SETJMP_H
 1

	)

23 #i‡!
deföed
 
_SETJMP_H
 && !deföed 
_PTHREAD_H


27 
	~<bôs/w‹dsize.h
>

29 #i‚de‡
_ASM


31 #i‡
__WORDSIZE
 == 64

32 
	t__jmp_buf
[8];

34 
	t__jmp_buf
[6];

	@/usr/include/sched.h

20 #i‚def 
_SCHED_H


21 
	#_SCHED_H
 1

	)

23 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 
	#__√ed_size_t


	)

29 
	~<°ddef.h
>

31 
	#__√ed_time•ec


	)

32 
	~<time.h
>

35 
	~<bôs/sched.h
>

37 
	#sched_¥i‹ôy
 
__sched_¥i‹ôy


	)

40 
__BEGIN_DECLS


43 
	$sched_£ç¨am
 (
__pid_t
 
__pid
, 
__c⁄°
 
sched_∑øm
 *
__∑øm
)

44 
__THROW
;

47 
	$sched_gë∑øm
 (
__pid_t
 
__pid
, 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

50 
	$sched_£tscheduÀr
 (
__pid_t
 
__pid
, 
__pﬁicy
,

51 
__c⁄°
 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

54 
	$sched_gëscheduÀr
 (
__pid_t
 
__pid
Ë
__THROW
;

57 
	$sched_yõld
 (Ë
__THROW
;

60 
	$sched_gë_¥i‹ôy_max
 (
__Æg‹ôhm
Ë
__THROW
;

63 
	$sched_gë_¥i‹ôy_mö
 (
__Æg‹ôhm
Ë
__THROW
;

66 
	$sched_º_gë_öãrvÆ
 (
__pid_t
 
__pid
, 
time•ec
 *
__t
Ë
__THROW
;

69 #ifde‡
__USE_GNU


71 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

72 
	#CPU_SET
(
˝u
, 
˝u£ç
Ë
	`__CPU_SET_S
 (˝u,  (
˝u_£t_t
), cpu£ç)

	)

73 
	#CPU_CLR
(
˝u
, 
˝u£ç
Ë
	`__CPU_CLR_S
 (˝u,  (
˝u_£t_t
), cpu£ç)

	)

74 
	#CPU_ISSET
(
˝u
, 
˝u£ç
Ë
	`__CPU_ISSET_S
 (˝u,  (
˝u_£t_t
), \

75 
˝u£ç
)

	)

76 
	#CPU_ZERO
(
˝u£ç
Ë
	`__CPU_ZERO_S
 ( (
˝u_£t_t
), cpu£ç)

	)

77 
	#CPU_COUNT
(
˝u£ç
Ë
	`__CPU_COUNT_S
 ( (
˝u_£t_t
), cpu£ç)

	)

79 
	#CPU_SET_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_SET_S
 (˝u, sësize, cpu£ç)

	)

80 
	#CPU_CLR_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_CLR_S
 (˝u, sësize, cpu£ç)

	)

81 
	#CPU_ISSET_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_ISSET_S
 (cpu, setsize, \

82 
˝u£ç
)

	)

83 
	#CPU_ZERO_S
(
£tsize
, 
˝u£ç
Ë
	`__CPU_ZERO_S
 (£tsize, cpu£ç)

	)

84 
	#CPU_COUNT_S
(
£tsize
, 
˝u£ç
Ë
	`__CPU_COUNT_S
 (£tsize, cpu£ç)

	)

86 
	#CPU_EQUAL
(
˝u£ç1
, 
˝u£ç2
) \

87 
	`__CPU_EQUAL_S
 ( (
˝u_£t_t
), 
˝u£ç1
, 
˝u£ç2
)

	)

88 
	#CPU_EQUAL_S
(
£tsize
, 
˝u£ç1
, 
˝u£ç2
) \

89 
	`__CPU_EQUAL_S
 (
£tsize
, 
˝u£ç1
, 
˝u£ç2
)

	)

91 
	#CPU_AND
(
de°£t
, 
§c£t1
, 
§c£t2
) \

92 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, &)

	)

93 
	#CPU_OR
(
de°£t
, 
§c£t1
, 
§c£t2
) \

94 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, |)

	)

95 
	#CPU_XOR
(
de°£t
, 
§c£t1
, 
§c£t2
) \

96 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, ^)

	)

97 
	#CPU_AND_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

98 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, &)

	)

99 
	#CPU_OR_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

100 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, |)

	)

101 
	#CPU_XOR_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

102 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, ^)

	)

104 
	#CPU_ALLOC_SIZE
(
cou¡
Ë
	`__CPU_ALLOC_SIZE
 (cou¡)

	)

105 
	#CPU_ALLOC
(
cou¡
Ë
	`__CPU_ALLOC
 (cou¡)

	)

106 
	#CPU_FREE
(
˝u£t
Ë
	`__CPU_FREE
 (˝u£t)

	)

110 
	$sched_£èfföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

111 
__c⁄°
 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

114 
	$sched_gëafföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

115 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

118 
__END_DECLS


	@/usr/include/signal.h

23 #i‚def 
_SIGNAL_H


25 #i‡!
deföed
 
__√ed_sig_©omic_t
 && !deföed 
__√ed_sig£t_t


26 
	#_SIGNAL_H


	)

29 
	~<„©uªs.h
>

31 
	g__BEGIN_DECLS


33 
	~<bôs/sig£t.h
>

37 #i‡
deföed
 
__√ed_sig_©omic_t
 || deföed 
_SIGNAL_H


38 #i‚de‡
__sig_©omic_t_deföed


39 
	#__sig_©omic_t_deföed


	)

40 
__BEGIN_NAMESPACE_STD


41 
__sig_©omic_t
 
	tsig_©omic_t
;

42 
	g__END_NAMESPACE_STD


44 #unde‡
__√ed_sig_©omic_t


47 #i‡
deföed
 
__√ed_sig£t_t
 || (deföed 
_SIGNAL_H
 && deföed 
__USE_POSIX
)

48 #i‚de‡
__sig£t_t_deföed


49 
	#__sig£t_t_deföed


	)

50 
__sig£t_t
 
	tsig£t_t
;

52 #unde‡
__√ed_sig£t_t


55 #ifde‡
_SIGNAL_H


57 
	~<bôs/ty≥s.h
>

58 
	~<bôs/signum.h
>

60 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


61 #i‚de‡
__pid_t_deföed


62 
__pid_t
 
	tpid_t
;

63 
	#__pid_t_deföed


	)

65 #ifde‡
__USE_XOPEN


67 #i‚de‡
__uid_t_deföed


68 
__uid_t
 
	tuid_t
;

69 
	#__uid_t_deföed


	)

73 #ifde‡
__USE_POSIX199309


75 
	#__√ed_time•ec


	)

76 
	~<time.h
>

79 
	~<bôs/sigöfo.h
>

84 (*
	t__sigh™dÀr_t
) ();

89 
__sigh™dÀr_t
 
	$__sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

90 
__THROW
;

91 #ifde‡
__USE_GNU


92 
__sigh™dÀr_t
 
	$sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

93 
__THROW
;

99 
__BEGIN_NAMESPACE_STD


100 #ifde‡
__USE_BSD


101 
__sigh™dÀr_t
 
	$sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

102 
__THROW
;

105 #ifde‡
__REDIRECT_NTH


106 
__sigh™dÀr_t
 
	`__REDIRECT_NTH
 (
sig«l
,

107 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
),

108 
__sysv_sig«l
);

110 
	#sig«l
 
__sysv_sig«l


	)

113 
__END_NAMESPACE_STD


115 #ifde‡
__USE_XOPEN


118 
__sigh™dÀr_t
 
	$bsd_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

119 
__THROW
;

125 #ifde‡
__USE_POSIX


126 
	$kûl
 (
__pid_t
 
__pid
, 
__sig
Ë
__THROW
;

129 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


133 
	$kûÕg
 (
__pid_t
 
__pgΩ
, 
__sig
Ë
__THROW
;

136 
__BEGIN_NAMESPACE_STD


138 
	$øi£
 (
__sig
Ë
__THROW
;

139 
__END_NAMESPACE_STD


141 #ifde‡
__USE_SVID


143 
__sigh™dÀr_t
 
	$ssig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

144 
__THROW
;

145 
	$gsig«l
 (
__sig
Ë
__THROW
;

148 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN2K


150 
	`psig«l
 (
__sig
, 
__c⁄°
 *
__s
);

153 #ifde‡
__USE_XOPEN2K


155 
	`psigöfo
 (
__c⁄°
 
sigöfo_t
 *
__pöfo
, __c⁄° *
__s
);

168 
	`__sig∑u£
 (
__sig_‹_mask
, 
__is_sig
);

170 #ifde‡
__FAVOR_BSD


173 
	$sig∑u£
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

175 #ifde‡
__USE_XOPEN


176 #ifde‡
__GNUC__


177 
	$sig∑u£
 (
__sig
Ë
	`__asm__
 ("__xpg_sigpause");

180 
	#sig∑u£
(
sig
Ë
	`__sig∑u£
 ((sig), 1)

	)

186 #ifde‡
__USE_BSD


193 
	#sigmask
(
sig
Ë
	`__sigmask
(sig)

	)

196 
	$sigblock
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

199 
	$sig£tmask
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

202 
	$siggëmask
 (Ë
__THROW
 
__©åibuã_dïªˇãd__
;

206 #ifde‡
__USE_MISC


207 
	#NSIG
 
_NSIG


	)

210 #ifde‡
__USE_GNU


211 
__sigh™dÀr_t
 
	tsigh™dÀr_t
;

215 #ifde‡
__USE_BSD


216 
__sigh™dÀr_t
 
	tsig_t
;

219 #ifde‡
__USE_POSIX


222 
	$sigem±y£t
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

225 
	$sigfûl£t
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

228 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

231 
	$sigdñ£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

234 
	$sigismembî
 (
__c⁄°
 
sig£t_t
 *
__£t
, 
__signo
)

235 
__THROW
 
	`__n⁄nuŒ
 ((1));

237 #ifde‡
__USE_GNU


239 
	$sigi£m±y£t
 (
__c⁄°
 
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

242 
	$sig™d£t
 (
sig£t_t
 *
__£t
, 
__c⁄°
 sig£t_à*
__À·
,

243 
__c⁄°
 
sig£t_t
 *
__right
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

246 
	$sig‹£t
 (
sig£t_t
 *
__£t
, 
__c⁄°
 sig£t_à*
__À·
,

247 
__c⁄°
 
sig£t_t
 *
__right
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

252 
	~<bôs/siga˘i⁄.h
>

255 
	$sig¥ocmask
 (
__how
, 
__c⁄°
 
sig£t_t
 *
__ª°ri˘
 
__£t
,

256 
sig£t_t
 *
__ª°ri˘
 
__o£t
Ë
__THROW
;

263 
	$sigsu•íd
 (
__c⁄°
 
sig£t_t
 *
__£t
Ë
	`__n⁄nuŒ
 ((1));

266 
	$siga˘i⁄
 (
__sig
, 
__c⁄°
 
siga˘i⁄
 *
__ª°ri˘
 
__a˘
,

267 
siga˘i⁄
 *
__ª°ri˘
 
__ﬂ˘
Ë
__THROW
;

270 
	$sig≥ndög
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

277 
	$sigwaô
 (
__c⁄°
 
sig£t_t
 *
__ª°ri˘
 
__£t
, *__ª°ri˘ 
__sig
)

278 
	`__n⁄nuŒ
 ((1, 2));

280 #ifde‡
__USE_POSIX199309


285 
	$sigwaôöfo
 (
__c⁄°
 
sig£t_t
 *
__ª°ri˘
 
__£t
,

286 
sigöfo_t
 *
__ª°ri˘
 
__öfo
Ë
	`__n⁄nuŒ
 ((1));

293 
	$sigtimedwaô
 (
__c⁄°
 
sig£t_t
 *
__ª°ri˘
 
__£t
,

294 
sigöfo_t
 *
__ª°ri˘
 
__öfo
,

295 
__c⁄°
 
time•ec
 *
__ª°ri˘
 
__timeout
)

296 
	`__n⁄nuŒ
 ((1));

300 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, 
__c⁄°
 
sigvÆ
 
__vÆ
)

301 
__THROW
;

306 #ifde‡
__USE_BSD


310 
__c⁄°
 *__c⁄° 
_sys_sigli°
[
_NSIG
];

311 
__c⁄°
 *__c⁄° 
sys_sigli°
[
_NSIG
];

314 
	ssigvec


316 
__sigh™dÀr_t
 
sv_h™dÀr
;

317 
sv_mask
;

319 
sv_Êags
;

320 
	#sv_⁄°ack
 
sv_Êags


	)

324 
	#SV_ONSTACK
 (1 << 0)

	)

325 
	#SV_INTERRUPT
 (1 << 1)

	)

326 
	#SV_RESETHAND
 (1 << 2)

	)

334 
	$sigvec
 (
__sig
, 
__c⁄°
 
sigvec
 *
__vec
,

335 
sigvec
 *
__ovec
Ë
__THROW
;

339 
	~<bôs/sigc⁄ãxt.h
>

342 
	$sigªtu∫
 (
sigc⁄ãxt
 *
__s˝
Ë
__THROW
;

347 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


348 
	#__√ed_size_t


	)

349 
	~<°ddef.h
>

354 
	$sigöãºu±
 (
__sig
, 
__öãºu±
Ë
__THROW
;

356 
	~<bôs/sig°ack.h
>

357 #ifde‡
__USE_XOPEN


359 
	~<sys/uc⁄ãxt.h
>

365 
	$sig°ack
 (
sig°ack
 *
__ss
, sig°ack *
__oss
)

366 
__THROW
 
__©åibuã_dïªˇãd__
;

370 
	$sigÆt°ack
 (
__c⁄°
 
sigÆt°ack
 *
__ª°ri˘
 
__ss
,

371 
sigÆt°ack
 *
__ª°ri˘
 
__oss
Ë
__THROW
;

375 #ifde‡
__USE_XOPEN_EXTENDED


379 
	$sighﬁd
 (
__sig
Ë
__THROW
;

382 
	$sigªl£
 (
__sig
Ë
__THROW
;

385 
	$sigign‹e
 (
__sig
Ë
__THROW
;

388 
__sigh™dÀr_t
 
	$sig£t
 (
__sig
, 
__sigh™dÀr_t
 
__di•
Ë
__THROW
;

391 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


394 
	~<bôs/±hªadty≥s.h
>

395 
	~<bôs/sigthªad.h
>

402 
	$__libc_cuºít_sigπmö
 (Ë
__THROW
;

404 
	$__libc_cuºít_sigπmax
 (Ë
__THROW
;

408 
__END_DECLS


	@/usr/include/asm-generic/bitsperlong.h

1 #i‚de‡
__ASM_GENERIC_BITS_PER_LONG


2 
	#__ASM_GENERIC_BITS_PER_LONG


	)

11 #i‚de‡
__BITS_PER_LONG


12 
	#__BITS_PER_LONG
 32

	)

	@/usr/include/asm-generic/ioctl.h

1 #i‚de‡
_ASM_GENERIC_IOCTL_H


2 
	#_ASM_GENERIC_IOCTL_H


	)

22 
	#_IOC_NRBITS
 8

	)

23 
	#_IOC_TYPEBITS
 8

	)

30 #i‚de‡
_IOC_SIZEBITS


31 
	#_IOC_SIZEBITS
 14

	)

34 #i‚de‡
_IOC_DIRBITS


35 
	#_IOC_DIRBITS
 2

	)

38 
	#_IOC_NRMASK
 ((1 << 
_IOC_NRBITS
)-1)

	)

39 
	#_IOC_TYPEMASK
 ((1 << 
_IOC_TYPEBITS
)-1)

	)

40 
	#_IOC_SIZEMASK
 ((1 << 
_IOC_SIZEBITS
)-1)

	)

41 
	#_IOC_DIRMASK
 ((1 << 
_IOC_DIRBITS
)-1)

	)

43 
	#_IOC_NRSHIFT
 0

	)

44 
	#_IOC_TYPESHIFT
 (
_IOC_NRSHIFT
+
_IOC_NRBITS
)

	)

45 
	#_IOC_SIZESHIFT
 (
_IOC_TYPESHIFT
+
_IOC_TYPEBITS
)

	)

46 
	#_IOC_DIRSHIFT
 (
_IOC_SIZESHIFT
+
_IOC_SIZEBITS
)

	)

53 #i‚de‡
_IOC_NONE


54 
	#_IOC_NONE
 0U

	)

57 #i‚de‡
_IOC_WRITE


58 
	#_IOC_WRITE
 1U

	)

61 #i‚de‡
_IOC_READ


62 
	#_IOC_READ
 2U

	)

65 
	#_IOC
(
dú
,
ty≥
,
ƒ
,
size
) \

66 (((
dú
Ë<< 
_IOC_DIRSHIFT
) | \

67 ((
ty≥
Ë<< 
_IOC_TYPESHIFT
) | \

68 ((
ƒ
Ë<< 
_IOC_NRSHIFT
) | \

69 ((
size
Ë<< 
_IOC_SIZESHIFT
))

	)

71 
	#_IOC_TYPECHECK
(
t
Ë(—))

	)

74 
	#_IO
(
ty≥
,
ƒ
Ë
	`_IOC
(
_IOC_NONE
,—y≥),“r),0)

	)

75 
	#_IOR
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

76 
	#_IOW
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_WRITE
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

77 
	#_IOWR
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

78 
	#_IOR_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
,—y≥),“r),(size))

	)

79 
	#_IOW_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_WRITE
,—y≥),“r),(size))

	)

80 
	#_IOWR_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,—y≥),“r),(size))

	)

83 
	#_IOC_DIR
(
ƒ
Ë((“rË>> 
_IOC_DIRSHIFT
Ë& 
_IOC_DIRMASK
)

	)

84 
	#_IOC_TYPE
(
ƒ
Ë((“rË>> 
_IOC_TYPESHIFT
Ë& 
_IOC_TYPEMASK
)

	)

85 
	#_IOC_NR
(
ƒ
Ë((“rË>> 
_IOC_NRSHIFT
Ë& 
_IOC_NRMASK
)

	)

86 
	#_IOC_SIZE
(
ƒ
Ë((“rË>> 
_IOC_SIZESHIFT
Ë& 
_IOC_SIZEMASK
)

	)

90 
	#IOC_IN
 (
_IOC_WRITE
 << 
_IOC_DIRSHIFT
)

	)

91 
	#IOC_OUT
 (
_IOC_READ
 << 
_IOC_DIRSHIFT
)

	)

92 
	#IOC_INOUT
 ((
_IOC_WRITE
|
_IOC_READ
Ë<< 
_IOC_DIRSHIFT
)

	)

93 
	#IOCSIZE_MASK
 (
_IOC_SIZEMASK
 << 
_IOC_SIZESHIFT
)

	)

94 
	#IOCSIZE_SHIFT
 (
_IOC_SIZESHIFT
)

	)

	@/usr/include/bits/sched.h

22 #i‚de‡
__√ed_sched∑øm


24 #i‚de‡
_SCHED_H


30 
	#SCHED_OTHER
 0

	)

31 
	#SCHED_FIFO
 1

	)

32 
	#SCHED_RR
 2

	)

33 #ifde‡
__USE_GNU


34 
	#SCHED_BATCH
 3

	)

37 #ifde‡
__USE_MISC


39 
	#CSIGNAL
 0x000000f‡

	)

40 
	#CLONE_VM
 0x00000100

	)

41 
	#CLONE_FS
 0x00000200

	)

42 
	#CLONE_FILES
 0x00000400

	)

43 
	#CLONE_SIGHAND
 0x00000800

	)

44 
	#CLONE_PTRACE
 0x00002000

	)

45 
	#CLONE_VFORK
 0x00004000

	)

47 
	#CLONE_PARENT
 0x00008000

	)

49 
	#CLONE_THREAD
 0x00010000

	)

50 
	#CLONE_NEWNS
 0x00020000

	)

51 
	#CLONE_SYSVSEM
 0x00040000

	)

52 
	#CLONE_SETTLS
 0x00080000

	)

53 
	#CLONE_PARENT_SETTID
 0x00100000

	)

55 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

57 
	#CLONE_DETACHED
 0x00400000

	)

58 
	#CLONE_UNTRACED
 0x00800000

	)

60 
	#CLONE_CHILD_SETTID
 0x01000000

	)

62 
	#CLONE_NEWUTS
 0x04000000

	)

63 
	#CLONE_NEWIPC
 0x08000000

	)

64 
	#CLONE_NEWUSER
 0x10000000

	)

65 
	#CLONE_NEWPID
 0x20000000

	)

66 
	#CLONE_NEWNET
 0x40000000

	)

67 
	#CLONE_IO
 0x80000000

	)

71 
	ssched_∑øm


73 
	m__sched_¥i‹ôy
;

76 
	g__BEGIN_DECLS


78 #ifde‡
__USE_MISC


80 
˛⁄e
 ((*
__‚
Ë(*
__¨g
), *
__chûd_°ack
,

81 
__Êags
, *
__¨g
, ...Ë
__THROW
;

84 
	$unsh¨e
 (
__Êags
Ë
__THROW
;

87 
	$sched_gë˝u
 (Ë
__THROW
;

90 
__END_DECLS


94 #i‡!
deföed
 
__deföed_sched∑øm
 \

95 && (
deföed
 
__√ed_sched∑øm
 || deföed 
_SCHED_H
)

96 
	#__deföed_sched∑øm
 1

	)

98 
	s__sched_∑øm


100 
__sched_¥i‹ôy
;

102 #unde‡
__√ed_sched∑øm


106 #i‡
deföed
 
_SCHED_H
 && !deföed 
__˝u_£t_t_deföed


107 
	#__˝u_£t_t_deföed


	)

109 
	#__CPU_SETSIZE
 1024

	)

110 
	#__NCPUBITS
 (8 *  (
__˝u_mask
))

	)

113 
	t__˝u_mask
;

116 
	#__CPUELT
(
˝u
Ë((˝uË/ 
__NCPUBITS
)

	)

117 
	#__CPUMASK
(
˝u
Ë((
__˝u_mask
Ë1 << ((˝uË% 
__NCPUBITS
))

	)

122 
__˝u_mask
 
__bôs
[
__CPU_SETSIZE
 / 
__NCPUBITS
];

123 } 
	t˝u_£t_t
;

126 #i‡
	`__GNUC_PREREQ
 (2, 91)

127 
	#__CPU_ZERO_S
(
£tsize
, 
˝u£ç
) \

128 dÿ
	`__buûtö_mem£t
 (
˝u£ç
, '\0', 
£tsize
); 0)

	)

130 
	#__CPU_ZERO_S
(
£tsize
, 
˝u£ç
) \

132 
size_t
 
__i
; \

133 
size_t
 
__imax
 = (
£tsize
Ë/  (
__˝u_mask
); \

134 
__˝u_mask
 *
__bôs
 = (
˝u£ç
)->__bits; \

135 
__i
 = 0; __ò< 
__imax
; ++__i) \

136 
__bôs
[
__i
] = 0; \

137 
	}
} 0)

	)

139 
	#__CPU_SET_S
(
˝u
, 
£tsize
, 
˝u£ç
) \

140 (
__exãnsi⁄__
 \

141 ({ 
size_t
 
__˝u
 = (
˝u
); \

142 
__˝u
 < 8 * (
£tsize
) \

143 ? (((
__˝u_mask
 *Ë((
˝u£ç
)->
__bôs
))[
	`__CPUELT
 (
__˝u
)] \

144 |
	`__CPUMASK
 (
__˝u
)) \

145 : 0; }))

	)

146 
	#__CPU_CLR_S
(
˝u
, 
£tsize
, 
˝u£ç
) \

147 (
__exãnsi⁄__
 \

148 ({ 
size_t
 
__˝u
 = (
˝u
); \

149 
__˝u
 < 8 * (
£tsize
) \

150 ? (((
__˝u_mask
 *Ë((
˝u£ç
)->
__bôs
))[
	`__CPUELT
 (
__˝u
)] \

151 &~
	`__CPUMASK
 (
__˝u
)) \

152 : 0; }))

	)

153 
	#__CPU_ISSET_S
(
˝u
, 
£tsize
, 
˝u£ç
) \

154 (
__exãnsi⁄__
 \

155 ({ 
size_t
 
__˝u
 = (
˝u
); \

156 
__˝u
 < 8 * (
£tsize
) \

157 ? ((((
__c⁄°
 
__˝u_mask
 *Ë((
˝u£ç
)->
__bôs
))[
	`__CPUELT
 (
__˝u
)] \

158 & 
	`__CPUMASK
 (
__˝u
))) != 0 \

159 : 0; }))

	)

161 
	#__CPU_COUNT_S
(
£tsize
, 
˝u£ç
) \

162 
	`__sched_˝ucou¡
 (
£tsize
, 
˝u£ç
)

	)

164 #i‡
__GNUC_PREREQ
 (2, 91)

165 
	#__CPU_EQUAL_S
(
£tsize
, 
˝u£ç1
, 
˝u£ç2
) \

166 (
	`__buûtö_memcmp
 (
˝u£ç1
, 
˝u£ç2
, 
£tsize
Ë=0)

	)

168 
	#__CPU_EQUAL_S
(
£tsize
, 
˝u£ç1
, 
˝u£ç2
) \

169 (
__exãnsi⁄__
 \

170 ({ 
__c⁄°
 
__˝u_mask
 *
__¨r1
 = (
˝u£ç1
)->
__bôs
; \

171 
__c⁄°
 
__˝u_mask
 *
__¨r2
 = (
˝u£ç2
)->
__bôs
; \

172 
size_t
 
__imax
 = (
£tsize
Ë/  (
__˝u_mask
); \

173 
size_t
 
__i
; \

174 
__i
 = 0; __ò< 
__imax
; ++__i) \

175 i‡(
__bôs
[
__i
] != __bits[__i]) \

177 
__i
 =
__imax
; }))

	)

180 
	#__CPU_OP_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, 
›
) \

181 (
__exãnsi⁄__
 \

182 ({ 
˝u_£t_t
 *
__de°
 = (
de°£t
); \

183 
__c⁄°
 
__˝u_mask
 *
__¨r1
 = (
§c£t1
)->
__bôs
; \

184 
__c⁄°
 
__˝u_mask
 *
__¨r2
 = (
§c£t2
)->
__bôs
; \

185 
size_t
 
__imax
 = (
£tsize
Ë/  (
__˝u_mask
); \

186 
size_t
 
__i
; \

187 
__i
 = 0; __ò< 
__imax
; ++__i) \

188 ((
__˝u_mask
 *Ë
__de°
->
__bôs
)[
__i
] = 
__¨r1
[__i] 
›
 
__¨r2
[__i]; \

189 
__de°
; }))

	)

191 
	#__CPU_ALLOC_SIZE
(
cou¡
) \

192 ((((
cou¡
Ë+ 
__NCPUBITS
 - 1Ë/ __NCPUBITSË*  (
__˝u_mask
))

	)

193 
	#__CPU_ALLOC
(
cou¡
Ë
	`__sched_˝uÆloc
 (cou¡)

	)

194 
	#__CPU_FREE
(
˝u£t
Ë
	`__sched_˝u‰ì
 (˝u£t)

	)

196 
__BEGIN_DECLS


198 
	$__sched_˝ucou¡
 (
size_t
 
__£tsize
, c⁄° 
˝u_£t_t
 *
__£ç
)

199 
__THROW
;

200 
˝u_£t_t
 *
	$__sched_˝uÆloc
 (
size_t
 
__cou¡
Ë
__THROW
 
__wur
;

201 
	$__sched_˝u‰ì
 (
˝u_£t_t
 *
__£t
Ë
__THROW
;

203 
__END_DECLS


	@/usr/include/bits/sigaction.h

20 #i‚de‡
_SIGNAL_H


25 
	ssiga˘i⁄


28 #ifde‡
__USE_POSIX199309


32 
__sigh™dÀr_t
 
	mß_h™dÀr
;

34 (*
	mß_siga˘i⁄
Ë(, 
	msigöfo_t
 *, *);

36 
	m__siga˘i⁄_h™dÀr
;

37 
	#ß_h™dÀr
 
__siga˘i⁄_h™dÀr
.
ß_h™dÀr


	)

38 
	#ß_siga˘i⁄
 
__siga˘i⁄_h™dÀr
.
ß_siga˘i⁄


	)

40 
__sigh™dÀr_t
 
	mß_h™dÀr
;

44 
__sig£t_t
 
	mß_mask
;

47 
	mß_Êags
;

50 (*
	mß_ª°‹î
) ();

54 
	#SA_NOCLDSTOP
 1

	)

55 
	#SA_NOCLDWAIT
 2

	)

56 
	#SA_SIGINFO
 4

	)

58 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_MISC


59 
	#SA_ONSTACK
 0x08000000

	)

60 
	#SA_RESTART
 0x10000000

	)

61 
	#SA_NODEFER
 0x40000000

	)

63 
	#SA_RESETHAND
 0x80000000

	)

65 #ifde‡
__USE_MISC


66 
	#SA_INTERRUPT
 0x20000000

	)

69 
	#SA_NOMASK
 
SA_NODEFER


	)

70 
	#SA_ONESHOT
 
SA_RESETHAND


	)

71 
	#SA_STACK
 
SA_ONSTACK


	)

75 
	#SIG_BLOCK
 0

	)

76 
	#SIG_UNBLOCK
 1

	)

77 
	#SIG_SETMASK
 2

	)

	@/usr/include/bits/sigcontext.h

19 #i‚de‡
_BITS_SIGCONTEXT_H


20 
	#_BITS_SIGCONTEXT_H
 1

	)

22 #i‡!
deföed
 
_SIGNAL_H
 && !deföed 
_SYS_UCONTEXT_H


26 
	~<bôs/w‹dsize.h
>

28 
	s_Âªg


30 
	msignifiˇnd
[4];

31 
	mexp⁄ít
;

34 
	s_Âxªg


36 
	msignifiˇnd
[4];

37 
	mexp⁄ít
;

38 
	m∑ddög
[3];

41 
	s_xmmªg


43 
__uöt32_t
 
	mñemít
[4];

48 #i‡
__WORDSIZE
 == 32

50 
	s_Â°©e


53 
__uöt32_t
 
	mcw
;

54 
__uöt32_t
 
	msw
;

55 
__uöt32_t
 
	mèg
;

56 
__uöt32_t
 
	mùoff
;

57 
__uöt32_t
 
	mcs£l
;

58 
__uöt32_t
 
	md©aoff
;

59 
__uöt32_t
 
	md©a£l
;

60 
_Âªg
 
	m_°
[8];

61 
	m°©us
;

62 
	mmagic
;

65 
__uöt32_t
 
	m_fx§_ív
[6];

66 
__uöt32_t
 
	mmxc§
;

67 
__uöt32_t
 
	mª£rved
;

68 
_Âxªg
 
	m_fx§_°
[8];

69 
_xmmªg
 
	m_xmm
[8];

70 
__uöt32_t
 
	m∑ddög
[56];

73 #i‚de‡
sigc⁄ãxt_°ru˘


78 
	#sigc⁄ãxt_°ru˘
 
sigc⁄ãxt


	)

81 
	ssigc⁄ãxt


83 
	mgs
, 
	m__gsh
;

84 
	mfs
, 
	m__fsh
;

85 
	mes
, 
	m__esh
;

86 
	mds
, 
	m__dsh
;

87 
	medi
;

88 
	mesi
;

89 
	mebp
;

90 
	me•
;

91 
	mebx
;

92 
	medx
;

93 
	mecx
;

94 
	móx
;

95 
	må≠no
;

96 
	mîr
;

97 
	meù
;

98 
	mcs
, 
	m__csh
;

99 
	meÊags
;

100 
	me•_©_sig«l
;

101 
	mss
, 
	m__ssh
;

102 
_Â°©e
 * 
	mÂ°©e
;

103 
	mﬁdmask
;

104 
	m¸2
;

109 
	s_Â°©e


112 
__uöt16_t
 
	mcwd
;

113 
__uöt16_t
 
	mswd
;

114 
__uöt16_t
 
	m·w
;

115 
__uöt16_t
 
	mf›
;

116 
__uöt64_t
 
	mrù
;

117 
__uöt64_t
 
	mrdp
;

118 
__uöt32_t
 
	mmxc§
;

119 
__uöt32_t
 
	mmx¸_mask
;

120 
_Âxªg
 
	m_°
[8];

121 
_xmmªg
 
	m_xmm
[16];

122 
__uöt32_t
 
	m∑ddög
[24];

125 
	ssigc⁄ãxt


127 
	mr8
;

128 
	mr9
;

129 
	mr10
;

130 
	mr11
;

131 
	mr12
;

132 
	mr13
;

133 
	mr14
;

134 
	mr15
;

135 
	mrdi
;

136 
	mrsi
;

137 
	mrbp
;

138 
	mrbx
;

139 
	mrdx
;

140 
	møx
;

141 
	mrcx
;

142 
	mr•
;

143 
	mrù
;

144 
	meÊags
;

145 
	mcs
;

146 
	mgs
;

147 
	mfs
;

148 
	m__∑d0
;

149 
	mîr
;

150 
	må≠no
;

151 
	mﬁdmask
;

152 
	m¸2
;

153 
_Â°©e
 * 
	mÂ°©e
;

154 
	m__ª£rved1
 [8];

	@/usr/include/bits/siginfo.h

20 #i‡!
deföed
 
_SIGNAL_H
 && !deföed 
__√ed_sigöfo_t
 \

21 && !
deföed
 
	g__√ed_sigevít_t


25 
	~<bôs/w‹dsize.h
>

27 #i‡(!
deföed
 
__have_sigvÆ_t
 \

28 && (
deföed
 
	g_SIGNAL_H
 || deföed 
	g__√ed_sigöfo_t
 \

29 || 
deföed
 
	g__√ed_sigevít_t
))

30 
	#__have_sigvÆ_t
 1

	)

33 
	usigvÆ


35 
	msivÆ_öt
;

36 *
	msivÆ_±r
;

37 } 
	tsigvÆ_t
;

40 #i‡(!
deföed
 
__have_sigöfo_t
 \

41 && (
deföed
 
	g_SIGNAL_H
 || deföed 
	g__√ed_sigöfo_t
))

42 
	#__have_sigöfo_t
 1

	)

44 
	#__SI_MAX_SIZE
 128

	)

45 #i‡
__WORDSIZE
 == 64

46 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()Ë- 4)

	)

48 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()Ë- 3)

	)

51 
	ssigöfo


53 
	msi_signo
;

54 
	msi_î∫o
;

56 
	msi_code
;

60 
	m_∑d
[
__SI_PAD_SIZE
];

65 
__pid_t
 
	msi_pid
;

66 
__uid_t
 
	msi_uid
;

67 } 
	m_kûl
;

72 
	msi_tid
;

73 
	msi_ovîrun
;

74 
sigvÆ_t
 
	msi_sigvÆ
;

75 } 
	m_timî
;

80 
__pid_t
 
	msi_pid
;

81 
__uid_t
 
	msi_uid
;

82 
sigvÆ_t
 
	msi_sigvÆ
;

83 } 
	m_π
;

88 
__pid_t
 
	msi_pid
;

89 
__uid_t
 
	msi_uid
;

90 
	msi_°©us
;

91 
__˛ock_t
 
	msi_utime
;

92 
__˛ock_t
 
	msi_°ime
;

93 } 
	m_sigchld
;

98 *
	msi_addr
;

99 } 
	m_sigÁu…
;

104 
	msi_b™d
;

105 
	msi_fd
;

106 } 
	m_sigpﬁl
;

107 } 
	m_sifõlds
;

108 } 
	tsigöfo_t
;

112 
	#si_pid
 
_sifõlds
.
_kûl
.
si_pid


	)

113 
	#si_uid
 
_sifõlds
.
_kûl
.
si_uid


	)

114 
	#si_timîid
 
_sifõlds
.
_timî
.
si_tid


	)

115 
	#si_ovîrun
 
_sifõlds
.
_timî
.
si_ovîrun


	)

116 
	#si_°©us
 
_sifõlds
.
_sigchld
.
si_°©us


	)

117 
	#si_utime
 
_sifõlds
.
_sigchld
.
si_utime


	)

118 
	#si_°ime
 
_sifõlds
.
_sigchld
.
si_°ime


	)

119 
	#si_vÆue
 
_sifõlds
.
_π
.
si_sigvÆ


	)

120 
	#si_öt
 
_sifõlds
.
_π
.
si_sigvÆ
.
sivÆ_öt


	)

121 
	#si_±r
 
_sifõlds
.
_π
.
si_sigvÆ
.
sivÆ_±r


	)

122 
	#si_addr
 
_sifõlds
.
_sigÁu…
.
si_addr


	)

123 
	#si_b™d
 
_sifõlds
.
_sigpﬁl
.
si_b™d


	)

124 
	#si_fd
 
_sifõlds
.
_sigpﬁl
.
si_fd


	)

131 
	mSI_ASYNCNL
 = -60,

132 
	#SI_ASYNCNL
 
SI_ASYNCNL


	)

133 
	mSI_TKILL
 = -6,

134 
	#SI_TKILL
 
SI_TKILL


	)

135 
	mSI_SIGIO
,

136 
	#SI_SIGIO
 
SI_SIGIO


	)

137 
	mSI_ASYNCIO
,

138 
	#SI_ASYNCIO
 
SI_ASYNCIO


	)

139 
	mSI_MESGQ
,

140 
	#SI_MESGQ
 
SI_MESGQ


	)

141 
	mSI_TIMER
,

142 
	#SI_TIMER
 
SI_TIMER


	)

143 
	mSI_QUEUE
,

144 
	#SI_QUEUE
 
SI_QUEUE


	)

145 
	mSI_USER
,

146 
	#SI_USER
 
SI_USER


	)

147 
	mSI_KERNEL
 = 0x80

148 
	#SI_KERNEL
 
SI_KERNEL


	)

155 
	mILL_ILLOPC
 = 1,

156 
	#ILL_ILLOPC
 
ILL_ILLOPC


	)

157 
	mILL_ILLOPN
,

158 
	#ILL_ILLOPN
 
ILL_ILLOPN


	)

159 
	mILL_ILLADR
,

160 
	#ILL_ILLADR
 
ILL_ILLADR


	)

161 
	mILL_ILLTRP
,

162 
	#ILL_ILLTRP
 
ILL_ILLTRP


	)

163 
	mILL_PRVOPC
,

164 
	#ILL_PRVOPC
 
ILL_PRVOPC


	)

165 
	mILL_PRVREG
,

166 
	#ILL_PRVREG
 
ILL_PRVREG


	)

167 
	mILL_COPROC
,

168 
	#ILL_COPROC
 
ILL_COPROC


	)

169 
	mILL_BADSTK


170 
	#ILL_BADSTK
 
ILL_BADSTK


	)

176 
	mFPE_INTDIV
 = 1,

177 
	#FPE_INTDIV
 
FPE_INTDIV


	)

178 
	mFPE_INTOVF
,

179 
	#FPE_INTOVF
 
FPE_INTOVF


	)

180 
	mFPE_FLTDIV
,

181 
	#FPE_FLTDIV
 
FPE_FLTDIV


	)

182 
	mFPE_FLTOVF
,

183 
	#FPE_FLTOVF
 
FPE_FLTOVF


	)

184 
	mFPE_FLTUND
,

185 
	#FPE_FLTUND
 
FPE_FLTUND


	)

186 
	mFPE_FLTRES
,

187 
	#FPE_FLTRES
 
FPE_FLTRES


	)

188 
	mFPE_FLTINV
,

189 
	#FPE_FLTINV
 
FPE_FLTINV


	)

190 
	mFPE_FLTSUB


191 
	#FPE_FLTSUB
 
FPE_FLTSUB


	)

197 
	mSEGV_MAPERR
 = 1,

198 
	#SEGV_MAPERR
 
SEGV_MAPERR


	)

199 
	mSEGV_ACCERR


200 
	#SEGV_ACCERR
 
SEGV_ACCERR


	)

206 
	mBUS_ADRALN
 = 1,

207 
	#BUS_ADRALN
 
BUS_ADRALN


	)

208 
	mBUS_ADRERR
,

209 
	#BUS_ADRERR
 
BUS_ADRERR


	)

210 
	mBUS_OBJERR


211 
	#BUS_OBJERR
 
BUS_OBJERR


	)

217 
	mTRAP_BRKPT
 = 1,

218 
	#TRAP_BRKPT
 
TRAP_BRKPT


	)

219 
	mTRAP_TRACE


220 
	#TRAP_TRACE
 
TRAP_TRACE


	)

226 
	mCLD_EXITED
 = 1,

227 
	#CLD_EXITED
 
CLD_EXITED


	)

228 
	mCLD_KILLED
,

229 
	#CLD_KILLED
 
CLD_KILLED


	)

230 
	mCLD_DUMPED
,

231 
	#CLD_DUMPED
 
CLD_DUMPED


	)

232 
	mCLD_TRAPPED
,

233 
	#CLD_TRAPPED
 
CLD_TRAPPED


	)

234 
	mCLD_STOPPED
,

235 
	#CLD_STOPPED
 
CLD_STOPPED


	)

236 
	mCLD_CONTINUED


237 
	#CLD_CONTINUED
 
CLD_CONTINUED


	)

243 
	mPOLL_IN
 = 1,

244 
	#POLL_IN
 
POLL_IN


	)

245 
	mPOLL_OUT
,

246 
	#POLL_OUT
 
POLL_OUT


	)

247 
	mPOLL_MSG
,

248 
	#POLL_MSG
 
POLL_MSG


	)

249 
	mPOLL_ERR
,

250 
	#POLL_ERR
 
POLL_ERR


	)

251 
	mPOLL_PRI
,

252 
	#POLL_PRI
 
POLL_PRI


	)

253 
	mPOLL_HUP


254 
	#POLL_HUP
 
POLL_HUP


	)

257 #unde‡
__√ed_sigöfo_t


261 #i‡(
deföed
 
_SIGNAL_H
 || deföed 
__√ed_sigevít_t
) \

262 && !
deföed
 
	g__have_sigevít_t


263 
	#__have_sigevít_t
 1

	)

266 
	#__SIGEV_MAX_SIZE
 64

	)

267 #i‡
__WORDSIZE
 == 64

268 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()Ë- 4)

	)

270 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()Ë- 3)

	)

273 
	ssigevít


275 
sigvÆ_t
 
	msigev_vÆue
;

276 
	msigev_signo
;

277 
	msigev_nŸify
;

281 
	m_∑d
[
__SIGEV_PAD_SIZE
];

285 
__pid_t
 
	m_tid
;

289 (*
	m_fun˘i⁄
Ë(
	msigvÆ_t
);

290 *
	m_©åibuã
;

291 } 
	m_sigev_thªad
;

292 } 
	m_sigev_un
;

293 } 
	tsigevít_t
;

296 
	#sigev_nŸify_fun˘i⁄
 
_sigev_un
.
_sigev_thªad
.
_fun˘i⁄


	)

297 
	#sigev_nŸify_©åibuãs
 
_sigev_un
.
_sigev_thªad
.
_©åibuã


	)

302 
	mSIGEV_SIGNAL
 = 0,

303 
	#SIGEV_SIGNAL
 
SIGEV_SIGNAL


	)

304 
	mSIGEV_NONE
,

305 
	#SIGEV_NONE
 
SIGEV_NONE


	)

306 
	mSIGEV_THREAD
,

307 
	#SIGEV_THREAD
 
SIGEV_THREAD


	)

309 
	mSIGEV_THREAD_ID
 = 4

310 
	#SIGEV_THREAD_ID
 
SIGEV_THREAD_ID


	)

	@/usr/include/bits/signum.h

20 #ifdef 
_SIGNAL_H


23 
	#SIG_ERR
 ((
__sigh™dÀr_t
Ë-1Ë

	)

24 
	#SIG_DFL
 ((
__sigh™dÀr_t
Ë0Ë

	)

25 
	#SIG_IGN
 ((
__sigh™dÀr_t
Ë1Ë

	)

27 #ifde‡
__USE_UNIX98


28 
	#SIG_HOLD
 ((
__sigh™dÀr_t
Ë2Ë

	)

33 
	#SIGHUP
 1

	)

34 
	#SIGINT
 2

	)

35 
	#SIGQUIT
 3

	)

36 
	#SIGILL
 4

	)

37 
	#SIGTRAP
 5

	)

38 
	#SIGABRT
 6

	)

39 
	#SIGIOT
 6

	)

40 
	#SIGBUS
 7

	)

41 
	#SIGFPE
 8

	)

42 
	#SIGKILL
 9

	)

43 
	#SIGUSR1
 10

	)

44 
	#SIGSEGV
 11

	)

45 
	#SIGUSR2
 12

	)

46 
	#SIGPIPE
 13

	)

47 
	#SIGALRM
 14

	)

48 
	#SIGTERM
 15

	)

49 
	#SIGSTKFLT
 16

	)

50 
	#SIGCLD
 
SIGCHLD


	)

51 
	#SIGCHLD
 17

	)

52 
	#SIGCONT
 18

	)

53 
	#SIGSTOP
 19

	)

54 
	#SIGTSTP
 20

	)

55 
	#SIGTTIN
 21

	)

56 
	#SIGTTOU
 22

	)

57 
	#SIGURG
 23

	)

58 
	#SIGXCPU
 24

	)

59 
	#SIGXFSZ
 25

	)

60 
	#SIGVTALRM
 26

	)

61 
	#SIGPROF
 27

	)

62 
	#SIGWINCH
 28

	)

63 
	#SIGPOLL
 
SIGIO


	)

64 
	#SIGIO
 29

	)

65 
	#SIGPWR
 30

	)

66 
	#SIGSYS
 31

	)

67 
	#SIGUNUSED
 31

	)

69 
	#_NSIG
 65

	)

72 
	#SIGRTMIN
 (
	`__libc_cuºít_sigπmö
 ())

	)

73 
	#SIGRTMAX
 (
	`__libc_cuºít_sigπmax
 ())

	)

77 
	#__SIGRTMIN
 32

	)

78 
	#__SIGRTMAX
 (
_NSIG
 - 1)

	)

	@/usr/include/bits/sigstack.h

20 #i‚de‡
_SIGNAL_H


26 
	ssig°ack


28 *
	mss_•
;

29 
	mss_⁄°ack
;

36 
	mSS_ONSTACK
 = 1,

37 
	#SS_ONSTACK
 
SS_ONSTACK


	)

38 
	mSS_DISABLE


39 
	#SS_DISABLE
 
SS_DISABLE


	)

43 
	#MINSIGSTKSZ
 2048

	)

46 
	#SIGSTKSZ
 8192

	)

50 
	ssigÆt°ack


52 *
	mss_•
;

53 
	mss_Êags
;

54 
size_t
 
	mss_size
;

55 } 
	t°ack_t
;

	@/usr/include/bits/sigthread.h

20 #i‚de‡
_BITS_SIGTHREAD_H


21 
	#_BITS_SIGTHREAD_H
 1

	)

23 #i‡!
deföed
 
_SIGNAL_H
 && !deföed 
_PTHREAD_H


31 
	$±hªad_sigmask
 (
__how
,

32 
__c⁄°
 
__sig£t_t
 *
__ª°ri˘
 
__√wmask
,

33 
__sig£t_t
 *
__ª°ri˘
 
__ﬁdmask
)
__THROW
;

36 
	$±hªad_kûl
 (
±hªad_t
 
__thªadid
, 
__signo
Ë
__THROW
;

38 #ifde‡
__USE_GNU


40 
	$±hªad_sigqueue
 (
±hªad_t
 
__thªadid
, 
__signo
,

41 c⁄° 
sigvÆ
 
__vÆue
Ë
__THROW
;

	@/usr/include/sys/ucontext.h

19 #i‚de‡
_SYS_UCONTEXT_H


20 
	#_SYS_UCONTEXT_H
 1

	)

22 
	~<„©uªs.h
>

23 
	~<sig«l.h
>

24 
	~<bôs/w‹dsize.h
>

28 
	~<bôs/sigc⁄ãxt.h
>

30 #i‡
__WORDSIZE
 == 64

33 
	tgªg_t
;

36 
	#NGREG
 23

	)

39 
gªg_t
 
	tgªg£t_t
[
NGREG
];

41 #ifde‡
__USE_GNU


45 
	mREG_R8
 = 0,

46 
	#REG_R8
 
REG_R8


	)

47 
	mREG_R9
,

48 
	#REG_R9
 
REG_R9


	)

49 
	mREG_R10
,

50 
	#REG_R10
 
REG_R10


	)

51 
	mREG_R11
,

52 
	#REG_R11
 
REG_R11


	)

53 
	mREG_R12
,

54 
	#REG_R12
 
REG_R12


	)

55 
	mREG_R13
,

56 
	#REG_R13
 
REG_R13


	)

57 
	mREG_R14
,

58 
	#REG_R14
 
REG_R14


	)

59 
	mREG_R15
,

60 
	#REG_R15
 
REG_R15


	)

61 
	mREG_RDI
,

62 
	#REG_RDI
 
REG_RDI


	)

63 
	mREG_RSI
,

64 
	#REG_RSI
 
REG_RSI


	)

65 
	mREG_RBP
,

66 
	#REG_RBP
 
REG_RBP


	)

67 
	mREG_RBX
,

68 
	#REG_RBX
 
REG_RBX


	)

69 
	mREG_RDX
,

70 
	#REG_RDX
 
REG_RDX


	)

71 
	mREG_RAX
,

72 
	#REG_RAX
 
REG_RAX


	)

73 
	mREG_RCX
,

74 
	#REG_RCX
 
REG_RCX


	)

75 
	mREG_RSP
,

76 
	#REG_RSP
 
REG_RSP


	)

77 
	mREG_RIP
,

78 
	#REG_RIP
 
REG_RIP


	)

79 
	mREG_EFL
,

80 
	#REG_EFL
 
REG_EFL


	)

81 
	mREG_CSGSFS
,

82 
	#REG_CSGSFS
 
REG_CSGSFS


	)

83 
	mREG_ERR
,

84 
	#REG_ERR
 
REG_ERR


	)

85 
	mREG_TRAPNO
,

86 
	#REG_TRAPNO
 
REG_TRAPNO


	)

87 
	mREG_OLDMASK
,

88 
	#REG_OLDMASK
 
REG_OLDMASK


	)

89 
	mREG_CR2


90 
	#REG_CR2
 
REG_CR2


	)

94 
	s_libc_Âxªg


96 
	msignifiˇnd
[4];

97 
	mexp⁄ít
;

98 
	m∑ddög
[3];

101 
	s_libc_xmmªg


103 
__uöt32_t
 
	mñemít
[4];

106 
	s_libc_Â°©e


109 
__uöt16_t
 
	mcwd
;

110 
__uöt16_t
 
	mswd
;

111 
__uöt16_t
 
	m·w
;

112 
__uöt16_t
 
	mf›
;

113 
__uöt64_t
 
	mrù
;

114 
__uöt64_t
 
	mrdp
;

115 
__uöt32_t
 
	mmxc§
;

116 
__uöt32_t
 
	mmx¸_mask
;

117 
_libc_Âxªg
 
	m_°
[8];

118 
_libc_xmmªg
 
	m_xmm
[16];

119 
__uöt32_t
 
	m∑ddög
[24];

123 
_libc_Â°©e
 *
	tÂªg£t_t
;

128 
gªg£t_t
 
	mgªgs
;

130 
Âªg£t_t
 
	mÂªgs
;

131 
	m__ª£rved1
 [8];

132 } 
	tmc⁄ãxt_t
;

135 
	suc⁄ãxt


137 
	muc_Êags
;

138 
uc⁄ãxt
 *
	muc_lök
;

139 
°ack_t
 
	muc_°ack
;

140 
mc⁄ãxt_t
 
	muc_mc⁄ãxt
;

141 
__sig£t_t
 
	muc_sigmask
;

142 
_libc_Â°©e
 
	m__Âªgs_mem
;

143 } 
	tuc⁄ãxt_t
;

148 
	tgªg_t
;

151 
	#NGREG
 19

	)

154 
gªg_t
 
	tgªg£t_t
[
NGREG
];

156 #ifde‡
__USE_GNU


160 
	mREG_GS
 = 0,

161 
	#REG_GS
 
REG_GS


	)

162 
	mREG_FS
,

163 
	#REG_FS
 
REG_FS


	)

164 
	mREG_ES
,

165 
	#REG_ES
 
REG_ES


	)

166 
	mREG_DS
,

167 
	#REG_DS
 
REG_DS


	)

168 
	mREG_EDI
,

169 
	#REG_EDI
 
REG_EDI


	)

170 
	mREG_ESI
,

171 
	#REG_ESI
 
REG_ESI


	)

172 
	mREG_EBP
,

173 
	#REG_EBP
 
REG_EBP


	)

174 
	mREG_ESP
,

175 
	#REG_ESP
 
REG_ESP


	)

176 
	mREG_EBX
,

177 
	#REG_EBX
 
REG_EBX


	)

178 
	mREG_EDX
,

179 
	#REG_EDX
 
REG_EDX


	)

180 
	mREG_ECX
,

181 
	#REG_ECX
 
REG_ECX


	)

182 
	mREG_EAX
,

183 
	#REG_EAX
 
REG_EAX


	)

184 
	mREG_TRAPNO
,

185 
	#REG_TRAPNO
 
REG_TRAPNO


	)

186 
	mREG_ERR
,

187 
	#REG_ERR
 
REG_ERR


	)

188 
	mREG_EIP
,

189 
	#REG_EIP
 
REG_EIP


	)

190 
	mREG_CS
,

191 
	#REG_CS
 
REG_CS


	)

192 
	mREG_EFL
,

193 
	#REG_EFL
 
REG_EFL


	)

194 
	mREG_UESP
,

195 
	#REG_UESP
 
REG_UESP


	)

196 
	mREG_SS


197 
	#REG_SS
 
REG_SS


	)

202 
	s_libc_Âªg


204 
	msignifiˇnd
[4];

205 
	mexp⁄ít
;

208 
	s_libc_Â°©e


210 
	mcw
;

211 
	msw
;

212 
	mèg
;

213 
	mùoff
;

214 
	mcs£l
;

215 
	md©aoff
;

216 
	md©a£l
;

217 
_libc_Âªg
 
	m_°
[8];

218 
	m°©us
;

222 
_libc_Â°©e
 *
	tÂªg£t_t
;

227 
gªg£t_t
 
	mgªgs
;

230 
Âªg£t_t
 
	mÂªgs
;

231 
	mﬁdmask
;

232 
	m¸2
;

233 } 
	tmc⁄ãxt_t
;

236 
	suc⁄ãxt


238 
	muc_Êags
;

239 
uc⁄ãxt
 *
	muc_lök
;

240 
°ack_t
 
	muc_°ack
;

241 
mc⁄ãxt_t
 
	muc_mc⁄ãxt
;

242 
__sig£t_t
 
	muc_sigmask
;

243 
_libc_Â°©e
 
	m__Âªgs_mem
;

244 } 
	tuc⁄ãxt_t
;

	@
1
.
1
/usr/include
155
3650
assoc.c
auth.c
auth_rsp.c
connect.c
link_list.h
md5.c
md5.h
mlme.c
mlme.h
mlme_ex.c
mlme_ex.h
mlme_ex_def.h
netif_block.c
netif_block.h
oid.h
rt73.h
rt73.mod.c
rt_config.h
rt_user.c
rtmp.h
rtmp_def.h
rtmp_info.c
rtmp_init.c
rtmp_main.c
rtmp_tkip.c
rtmp_type.h
rtmp_wep.c
rtmp_wext.c
rtmp_wext.h
rtusb_bulk.c
rtusb_data.c
rtusb_io.c
sanity.c
sync.c
wpa.c
wpa.h
/usr/include/linux/errno.h
/usr/include/linux/ethtool.h
/usr/include/linux/if_arp.h
/usr/include/linux/kernel.h
/usr/include/linux/mii.h
/usr/include/linux/netdevice.h
/usr/include/linux/pci.h
/usr/include/linux/sched.h
/usr/include/linux/string.h
/usr/include/linux/unistd.h
/usr/include/linux/version.h
/usr/include/linux/wireless.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/sys/ioctl.h
/usr/include/sys/socket.h
/usr/include/unistd.h
/usr/include/alloca.h
/usr/include/asm/errno.h
/usr/include/asm/unistd.h
/usr/include/bits/confname.h
/usr/include/bits/environments.h
/usr/include/bits/ioctl-types.h
/usr/include/bits/ioctls.h
/usr/include/bits/posix_opt.h
/usr/include/bits/sigset.h
/usr/include/bits/socket.h
/usr/include/bits/socket2.h
/usr/include/bits/stdio-ldbl.h
/usr/include/bits/stdio.h
/usr/include/bits/stdio2.h
/usr/include/bits/stdio_lim.h
/usr/include/bits/stdlib-ldbl.h
/usr/include/bits/stdlib.h
/usr/include/bits/string.h
/usr/include/bits/string2.h
/usr/include/bits/string3.h
/usr/include/bits/sys_errlist.h
/usr/include/bits/types.h
/usr/include/bits/unistd.h
/usr/include/bits/waitflags.h
/usr/include/bits/waitstatus.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/libio.h
/usr/include/linux/if.h
/usr/include/linux/if_ether.h
/usr/include/linux/if_packet.h
/usr/include/linux/pci_regs.h
/usr/include/linux/socket.h
/usr/include/linux/types.h
/usr/include/sys/ttydefaults.h
/usr/include/sys/types.h
/usr/include/sys/uio.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/asm-generic/errno.h
/usr/include/asm/ioctls.h
/usr/include/asm/socket.h
/usr/include/asm/types.h
/usr/include/bits/libio-ldbl.h
/usr/include/bits/predefs.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/sockaddr.h
/usr/include/bits/stdio-lock.h
/usr/include/bits/typesizes.h
/usr/include/bits/uio.h
/usr/include/bits/wordsize.h
/usr/include/ctype.h
/usr/include/endian.h
/usr/include/gnu/stubs.h
/usr/include/linux/hdlc/ioctl.h
/usr/include/linux/posix_types.h
/usr/include/sys/cdefs.h
/usr/include/sys/select.h
/usr/include/sys/sysmacros.h
/usr/include/time.h
/usr/include/asm-generic/errno-base.h
/usr/include/asm-generic/ioctls.h
/usr/include/asm-generic/socket.h
/usr/include/asm-generic/types.h
/usr/include/asm/posix_types.h
/usr/include/bits/byteswap.h
/usr/include/bits/endian.h
/usr/include/bits/libc-lock.h
/usr/include/bits/select.h
/usr/include/bits/time.h
/usr/include/gconv.h
/usr/include/gnu/stubs-32.h
/usr/include/linux/stddef.h
/usr/include/wchar.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm/sockios.h
/usr/include/bits/wchar-ldbl.h
/usr/include/bits/wchar.h
/usr/include/bits/wchar2.h
/usr/include/errno.h
/usr/include/gnu/option-groups.h
/usr/include/linux/ioctl.h
/usr/include/pthread.h
/usr/include/wctype.h
/usr/include/asm-generic/sockios.h
/usr/include/asm/bitsperlong.h
/usr/include/asm/ioctl.h
/usr/include/bits/errno.h
/usr/include/bits/setjmp.h
/usr/include/sched.h
/usr/include/signal.h
/usr/include/asm-generic/bitsperlong.h
/usr/include/asm-generic/ioctl.h
/usr/include/bits/sched.h
/usr/include/bits/sigaction.h
/usr/include/bits/sigcontext.h
/usr/include/bits/siginfo.h
/usr/include/bits/signum.h
/usr/include/bits/sigstack.h
/usr/include/bits/sigthread.h
/usr/include/sys/ucontext.h
